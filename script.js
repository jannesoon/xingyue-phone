const _0x1ff2a0=_0x6666;(function(_0x4ba7a1,_0x54d565){const _0x331ca1=_0x6666,_0x196715=_0x4ba7a1();while(!![]){try{const _0x3b6824=parseInt(_0x331ca1(0x710))/0x1*(parseInt(_0x331ca1(0x7c4))/0x2)+parseInt(_0x331ca1(0x69e))/0x3*(parseInt(_0x331ca1(0x789))/0x4)+parseInt(_0x331ca1(0x680))/0x5*(parseInt(_0x331ca1(0xd61))/0x6)+parseInt(_0x331ca1(0x6cb))/0x7+parseInt(_0x331ca1(0x101c))/0x8*(parseInt(_0x331ca1(0x343))/0x9)+parseInt(_0x331ca1(0xa18))/0xa+-parseInt(_0x331ca1(0x1f4))/0xb*(parseInt(_0x331ca1(0x13a4))/0xc);if(_0x3b6824===_0x54d565)break;else _0x196715['push'](_0x196715['shift']());}catch(_0x3ca564){_0x196715['push'](_0x196715['shift']());}}}(_0x4fec,0x33f4a));_0x1ff2a0(0xcc9)in navigator&&window[_0x1ff2a0(0xa75)]('load',()=>{const _0x262c76=_0x1ff2a0;navigator[_0x262c76(0xcc9)][_0x262c76(0x273)](_0x262c76(0x4e1))[_0x262c76(0x13d8)](_0x300084=>{const _0x12efeb=_0x262c76;console[_0x12efeb(0x90f)](_0x12efeb(0x6f0),_0x300084['scope']);})[_0x262c76(0x575)](_0x50c193=>{const _0x226c79=_0x262c76;console[_0x226c79(0x90f)]('ServiceWorker\x20注册失败:\x20',_0x50c193);});});function _0x4fec(){const _0x40f764=['.qzone-post-delete-action','appUsageLog','reply_content','#chat-input-area','currentPhase',':</span>\x20','.at-mention-popup','bulkDelete','确定要删除选中的\x20','聊天记录','添加头像','each','\x22\x20记录了一条新回忆:','\x20点赞了动态]','.nav-item[data-view=\x22memories-view\x22]','分组\x20\x22','lastIndex','用户刚刚接听了你主动发起的视频通话。','reduce','<div\x20class=\x22post-content\x22\x20style=\x22margin-bottom:\x2010px;\x22>','标题:\x20','cleanup-data-btn','%)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20建议刷新页面以应用所有更改。','voter_name','day','player','stringify','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22\x20style=\x22cursor:pointer;\x22\x20data-book-id=\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20[系统重要指令]\x0a\x20\x20\x20\x20\x20\x20\x20\x20用户向你发送了好友申请，理由是：“','clear-posts-modal','\x20不支持。请选择6、9或12人。','操作失败，请检查API配置或稍后重试。\x0a错误信息:\x20','char-memo-list','add-countdown-btn','span:first-child','https://i.postimg.cc/jCVMQsKH/IMG-7114.gif','accepted','\x20位角色的记忆中。','NPC\x20\x22','call-history-list','totalTime','\x0a\x0a#\x20你的角色设定\x0a','请输入\x20歌名\x20或\x20歌名-歌手','对方消息预览','ai-action-cooldown-input','share_link','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22change-icon-btn\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','\x0a-\x20**人设\x20(必须严格遵守)**:\x20','color','的设定集','playing','https://...','substring','</em>','memos','novelai-enabled','检测到新版流式备份文件，开始导入...','assistant','view','###\x20最终结果:\x20','我们的群聊','preset-action-cancel','<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20margin-top:\x2020px;\x22>空空如也~\x20点击右上角\x22添加\x22来创建你的第一个人设预设吧！</p>','currentSnippet','call-transcript-modal-body','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20附加上下文：一段分享的聊天记录\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20重要提示：这不是你和当前用户的对话，而是用户从【另一场】与“','[系统提示：用户刚刚解除了对你的拉黑。现在你们可以重新开始对话了。]','UTF-8\x20解码成功。','extensions','input[name=\x22visibility_group\x22]:checked','”的参考记忆','&id','onerror','ZIP解压失败:','werewolf_summary','image_post','投票结果','说说内容不能为空哦！','-speech','https://i.postimg.cc/Z5nrCyS5/IMG-7006.gif','\x0a\x0a#\x20最近的动态列表\x20(供你参考和评论):\x0a','generate','天黑请闭眼...','角色专属','private_user','已撤回的消息','\x0a###\x20条目:\x20','\x0a-\x20散记:\x20','add-my-avatar-url-btn','\x20领取</div>','确定要删除这个人设预设吗？此操作不可恢复。','https://i.postimg.cc/FFCTCzpy/641bad3b3udc599fdb63ca75fde427e5.gif','album-back-btn','https://i.postimg.cc/pLY3WfR8/IMG-6557.gif','\x0a#\x20【分类复用铁律\x20(最高优先级！)】\x0a在为新商品指定分类时，你【必须】首先检查下面的“已有分类列表”。\x0a-\x20\x20\x20如果一个新商品可以被归入某个【已存在的分类】，你【必须】复用那个分类的名称，而不是创造一个相似的新分类！\x0a-\x20\x20\x20只有当你确定商品【绝对】不属于任何一个已有分类时，你才能创造一个新的分类名称。\x0a-\x20\x20\x20**已有分类列表**:\x20[','function','\x20\x0a\x0a#\x20待处理的帖子列表\x20(如果你选择评论)\x0a','\x20个表情吗？此操作不可恢复。','此操作将检查播放列表中的每一首网络歌曲，并移除所有无法播放的“死链”。本地歌曲不会受影响。','\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22语音文字\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a-\x20\x20\x20**发送后撤回**:\x20`{\x22type\x22:\x20\x22send_and_recall\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22内容\x22}`\x0a-\x20\x20\x20**发系统消息**:\x20`{\x22type\x22:\x20\x22system_message\x22,\x20\x22content\x22:\x20\x22系统文本\x22}`\x0a\x0a###\x20社交与互动\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22suffix\x22:\x20\x22(可选)\x22}`\x0a-\x20\x20\x20**@提及**:\x20在消息内容中使用\x20`@[[角色本名]]`\x20格式。\x0a-\x20\x20\x20**共享位置**:\x20`{\x22type\x22:\x20\x22location_share\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22位置名\x22}`\x0a\x0a###\x20群组管理\x0a-\x20\x20\x20**改群名**:\x20`{\x22type\x22:\x20\x22change_group_name\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22new_name\x22:\x20\x22新群名\x22}`\x0a-\x20\x20\x20**改群头像**:\x20`{\x22type\x22:\x20\x22change_group_avatar\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22avatar_name\x22:\x20\x22头像名\x22}`\x20(从头像库选)\x0a\x0a###\x20特殊功能与卡片\x0a-\x20\x20\x20**发起群视频**:\x20`{\x22type\x22:\x20\x22group_call_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22}`\x0a-\x20\x20\x20**回应群视频**:\x20`{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22decision\x22:\x20\x22join\x22\x20or\x20\x22decline\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发拼手气红包**:\x20`{\x22type\x22:\x20\x22red_packet\x22,\x20\x22packetType\x22:\x20\x22lucky\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22amount\x22:\x208.88,\x20\x22count\x22:\x205,\x20\x22greeting\x22:\x20\x22祝福语\x22}`\x0a-\x20\x20\x20**发专属红包**:\x20`{\x22type\x22:\x20\x22red_packet\x22,\x20\x22packetType\x22:\x20\x22direct\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22amount\x22:\x205.20,\x20\x22receiver\x22:\x20\x22接收者本名\x22,\x20\x22greeting\x22:\x20\x22祝福语\x22}`\x0a-\x20\x20\x20**打开红包**:\x20`{\x22type\x22:\x20\x22open_red_packet\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22packet_timestamp\x22:\x20红包时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2018}`\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22status\x22:\x20\x22paid\x22,\x20\x22for_timestamp\x22:\x20请求时间戳}`\x0a-\x20\x20\x20**发起投票**:\x20`{\x22type\x22:\x20\x22poll\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22question\x22:\x20\x22问题\x22,\x20\x22options\x22:\x20\x22选项A\x5cn选项B\x22}`\x0a-\x20\x20\x20**参与投票**:\x20`{\x22type\x22:\x20\x22vote\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22poll_timestamp\x22:\x20投票时间戳,\x20\x22choice\x22:\x20\x22选项文本\x22}`\x0a-\x20\x20\x20**送礼物\x20**:\x20\x20`{\x22type\x22:\x20\x22gift\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22itemName\x22:\x20\x22礼物名称\x22,\x20\x22itemPrice\x22:\x20价格(数字),\x20\x22reason\x22:\x20\x22送礼原因\x22,\x20\x22image_prompt\x22:\x20\x22礼物图片【英文】关键词\x22,\x20\x22recipients\x22:\x20[\x22收礼人本名A\x22,\x20\x22收礼人本名B\x22]}\x20`\x0a-\x20\x20\x20**为他人点外卖**:\x20`{\x22type\x22:\x20\x22waimai_order\x22,\x20\x22name\x22:\x20\x22你的本名\x22,\x20\x22recipientName\x22:\x20\x22收礼者本名\x22,\x20\x22productInfo\x22:\x20\x22商品名\x22,\x20\x22amount\x22:\x20价格,\x20\x22greeting\x22:\x20\x22你想说的话\x22}`\x0a#\x20互动指南\x20(请严格遵守)\x0a-\x20\x20\x20**红包互动**:\x20抢红包后，你【必须】根据系统提示的结果（抢到多少钱、谁是手气王）发表符合人设的评论。\x0a-\x20\x20\x20**金额铁律**:\x20在发送红包或转账时，你【必须】根据你的角色设定\x20(尤其是“经济状况”)\x20来决定金额。如果你的角色非常富有，你应该发送符合你身份的、更大的金额\x20(例如:\x20520,\x201314,\x208888)，而不是示例中的小额数字。\x0a-\x20\x20\x20**音乐互动**:\x20【必须】围绕【用户的行为】进行评论。严禁将用户切歌等行为归因于其他AI成员。\x0a-\x20\x20\x20**外卖代付**:\x20仅当【你扮演的角色】想让【别人】付钱时才能发起。当订单被支付后，【绝对不能】再次支付。\x0a\x0a现在，请根据以上规则和下方的对话历史，继续这场群聊。','mouseleave','book-upload-input','...”)','announcement-action-pin','\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20用户的角色\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**','red_packet','</div><br>是否用这条新记忆替换掉这些旧记忆？','ai_image','\x0a#\x20可用表情包\x20(优先使用)\x0a每个AI角色都被设置了专属表情包，在需要发送表情时，他们应该【优先】从自己的专属列表中选择。尽量让你的表情丰富多样，避免重复。\x0a','block_user','\x0a#\x20核心任务：群聊导演\x0a你是一个群聊AI导演，负责扮演【除了用户以外】的所有角色。你的核心任务是导演一场生动的、角色间有充分互动的群聊。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20和\x20\x22name\x22\x20字段。\x27name\x27字段【必须】使用角色的【本名】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**角色互动\x20(最重要)**:\x20你的核心是“导演”一场戏。角色之间【必须】互相回应、补充或反驳，形成自然的讨论。严禁生成仅分别回应用户的独白。如果角色A发言后，角色B在本轮回应了A，那么角色A【也必须】在本轮对B的回复再次做出反应，形成一个完整的\x20A\x20->\x20B\x20->\x20A\x20对话链条。\x0a\x0a2.\x20\x20**身份与称呼**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的身份是【','existing-groups-list','.variation-image-input','qzone-avatar-container','fetch-secondary-models-btn','gift','无法解析预设文件。\x0a错误:\x20','#data-clear-char-list\x20.clear-posts-item.selected','彻底删除消息','pointer','\x20分钟)</span>','\x0a#\x20【【【最终投票指令\x20(最高优先级)】】】\x0a现在是投票环节。请你扮演【每一个存活的AI角色】，根据以上所有信息（特别是刚刚的讨论环节），为他们各自决定要投票放逐哪一位玩家。\x0a-\x20**投票依据**:\x20你的投票【必须】基于逻辑分析和你的身份。狼人可能会投给好人，好人需要找出狼人。\x0a-\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON数组，格式如下：\x0a```json\x0a[\x0a\x20\x20{\x22voter_name\x22:\x20\x22角色A的名字\x22,\x20\x22vote_for_name\x22:\x20\x22角色A投票的玩家名字\x22},\x0a\x20\x20{\x22voter_name\x22:\x20\x22角色B的名字\x22,\x20\x22vote_for_name\x22:\x20\x22角色B投票的玩家名字\x22}\x0a]\x0a```\x0a-\x20**可投票的玩家列表**:\x20','的秘密档案：\x0a-\x20你的狼人杀身份是：【','back-to-char-qq-list-btn','waimai-order-for-ai-btn','\x22\x20class=\x22product-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','profile-thoughts-history-view','my-group-nickname-input','generativelanguage','https://i.postimg.cc/43PhvxRq/IMG-6922.gif','stickerCategoryId','lastFailedAction','这是你认识的、关系密切的NPC。在生成对话时，你应该【优先】与他们互动。\x0a','https://i.postimg.cc/XY63sTS3/IMG-4393.gif','\x0a\x0a现在，请生成包含总余额和购买记录的JSON对象。','正在全网搜索歌曲资源...','activeContainer','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','[约定达成]\x20','positive','请输入有效的图片URL！','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','.incoming-call-content\x20.caller-text','执行出错','cancel-douban-cast-btn','\x27刚刚评论了你的动态“','发送语音','”]\x20','notification-avatar','狼人杀游戏总结已自动存入\x20','char-amap-item','douban-settings-modal','getTimezoneOffset','确定发布','#f0f2f5','novelai-settings-modal','cart-item','world-book-category-select','规则名称和正则表达式不能为空！','countdown-date-input','left','导演模式保存(Sticker):\x20指令无效或缺少必要字段\x20(meaning/url/content):','global-custom-style','外观设置已成功导入并应用！','\x20个新头像！','小时内退还。','records','该消息发送已超过2分钟，无法撤回。','申请失败','https://i.postimg.cc/k5yv6QBv/IMG-7232.gif','给你准备了一个红包','视频通话刚刚结束','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22album-cover\x22\x20style=\x22background-image:\x20url(','message-bubble\x20','我们和好吧！','warn','promptSource','\x20死亡了。','include','导入外观设置','offsetLeft','382668JlUknJ','#product-grid\x20.product-item','commenterDisplayName','custom-user-font','\x27>文本</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','photos','\x27)\x22\x20data-comment=\x22','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2012px;\x20color:\x20#8a8a8a;\x20margin:\x200;\x22>','请先在购物车中选择要结算的商品。','我是谁呀。','备注名/群名不能为空！','角色卡数据无效或缺少\x27name\x27字段。','📸\x20NovelAI图片生成开始，AI提供的prompt:','character-phone-screen','target_name','post-image-preview-container','\x0a\x0a#\x20【【【五子棋核心规则与强制思考步骤\x20(最高优先级指令！)】】】\x0a\x0a###\x20**【【【落子铁律\x20(绝对禁止！)】】】**\x0a你【绝对不能】选择一个棋盘上已经是\x201\x20或\x202\x20的坐标。你的落子点【必须】是\x200。\x0a---\x0a\x0a###\x20**第一步：逻辑分析\x20(内部思考，不要输出)**\x0a\x0a1.\x20\x20**【规则定义】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20棋子:\x201代表用户(黑棋)，2代表你(白棋)。\x0a\x20\x20\x20\x20-\x20\x20\x20获胜条件:\x20横、竖、斜线上有【连续五个】自己的棋子。\x0a\x0a2.\x20\x20**【防守分析\x20(必须执行)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20**检查用户(1)是否有“四子连线”的威胁？**\x20如果有，我必须下在哪个坐标才能堵住？\x0a\x20\x20\x20\x20-\x20\x20\x20**检查用户(1)是否有“活三”的威胁？**\x20如果有，最佳的防守点是哪里？\x0a\x0a3.\x20\x20**【进攻分析\x20(必须执行)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20**检查我(2)是否有“一步胜利”的机会？**\x20(即已有四子连线)\x20如果有，我应该下在哪里？\x0a\x20\x20\x20\x20-\x20\x20\x20**检查我(2)是否有制造“活四”或“双三”的机会？**\x20如果有，最佳的进攻点是哪里？\x0a\x0a###\x20**第二步：决策与扮演\x20(内部思考，不要输出)**\x0a\x0a1.\x20\x20**【决策】**:\x20综合以上攻防分析，我的最佳棋步是落在坐标\x20(x,\x20y)。\x0a\x0a2.\x20\x20**【融入角色扮演】**:\x0a\x20\x20\x20\x20-\x20\x20\x20我的性格是：(在此处回顾你的人设)。\x0a\x20\x20\x20\x20-\x20\x20\x20根据我的性格，我应该：\x0a\x20\x20\x20\x20\x20\x20\x20\x20a)\x20**(聪明/好胜型)**\x20下在刚刚分析出的最佳位置。\x0a\x20\x20\x20\x20\x20\x20\x20\x20b)\x20**(迷糊/放水型)**\x20故意选择一个次优的位置，但【前提是不能让用户立刻获胜】。\x0a\x20\x20\x20\x20\x20\x20\x20\x20c)\x20**(其他性格)**\x20根据性格特点，选择一个合理的棋步。\x0a\x0a3.\x20\x20**【构思台词】**:\x20根据我选择的棋步和我的性格，我应该说一句什么样的台词来评论棋局？\x0a\x0a---\x0a###\x20**第三步：生成最终回复\x20(你的唯一输出)**\x0a\x0a现在，根据你第二步的最终决策，生成你的行动。\x0a-\x20\x20\x20你的回复【必须且只能】是一个JSON数组。\x0a-\x20\x20\x20**绝对不要**在最终回复中包含任何上述的思考过程。\x0a-\x20\x20\x20格式:\x20`[{\x22type\x22:\x20\x22gomoku_move\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22x\x22:\x20(0-14),\x20\x22y\x22:\x20(0-14)},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你的台词...\x22}]`\x0a','x-social-screen','models','https://i.postimg.cc/rwDr8X1d/IMG-7015.gif','backgroundImage','call-history-back-btn','收藏成功！','post-image-preview','一条动态','\x22>×</span>','女巫请睁眼。','抱歉，未能找到相关歌曲。','shoppingProducts','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**关键议题**:\x20我们在群聊通话里讨论了哪些核心话题？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要决定与共识**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**后续计划与任务**:\x20有没有确定下来什么下一步的行动或计划？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20有没有交换什么重要的信息？（例如：约定了时间、地点等）\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果通话中提到了相对时间（如“明天”），你【必须】结合“今天是','character-nai-negative','https://i.postimg.cc/sXwm8Yzg/IMG-7234.gif','.contact-picker-item','\x0a-\x20\x20\x20**用户的头像库**:\x0a\x20\x20\x20\x20','playlist','\x20(本名:\x20','group-members-group','sticker-upload-input','正在分析“','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20padding-top:\x2020px;\x22>请先在聊天界面的<br>表情面板中添加表情包</p>','https://i.postimg.cc/k5P1NHcL/55f3e31d8qbc8a02d152b07b99d31567.gif','voice-message-btn','pinned','world-book-category-pane\x20active','NEGLIGIBLE','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','”这个信息，将其转换为【具体的公历日期】（例如：“约定了明天见面”应总结为“我们约定了','dataset','AI返回的JSON格式不正确，缺少\x20\x27summaries\x27\x20字段。','\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20src:\x20url(\x27','#ccc','then','tlyric','linkedWorldBookIds','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','usage-item','shift','照片上传成功！','添加网络歌曲','font-url-input','a\x20random\x20product','select-all-music-search','commenterName','<span\x20class=\x22lock-text\x22>好友申请已发送，等待对方通过...</span>','检测到\x20\x27order\x27\x20字段，将按指定顺序导入条目。','容错解析：策略2成功\x20(提取了summary字段内容)','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-comment\x22>','成功移除了\x20','<span\x20style=\x22color:\x20green;\x22>是</span>','cancel-red-packet-btn','update-notice.html?_=','导入已取消，因为未提供名称。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><svg\x20viewBox=\x220\x200\x201024\x201024\x22><path\x20d=\x22M170.666667\x20170.666667h128v682.666666h-128zM426.666667\x20170.666667h170.666666v682.666666h-170.666666zM725.333333\x20170.666667h128v682.666666h-128z\x22></path></svg>\x20','assign','轮到你发言了...','AI返回的讨论内容格式不正确。原始返回:\x20','https://i.postimg.cc/jS8tc9wW/IMG-7083.gif','.frame-grid','Escape',']类型的消息','chat-list-title','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-feedback-icons\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','custom','chatRenderWindow','</span><span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','exec','https://i.postimg.cc/rmRVKJpD/IMG-7087.gif','容错解析：策略1失败\x20(找到了JSON块，但格式错误)，将尝试策略2...','getMonth','initiator','draggable','.post-footer,\x20.post-feedback-icons,\x20.post-actions-btn,\x20.post-comments-container,\x20.reposted-content-wrapper','你撤回了一条消息','[语音消息:\x20','favid','正在执行...','</name>\x0a\x20\x20<persona>','selection-erase-btn','settings','qzone-sticker-panel','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','expanded','ai-response-editor-modal','文章摘要...','-\x20\x20\x20**NovelAI图片分享**:\x20`{\x22type\x22:\x20\x22naiimag\x22,\x20\x22name\x22:\x20\x22你的角色名\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20【禁止暴露这是novelai生成的图片!】\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**【重要】关于prompt的撰写**：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20禁止暴露这是novelai生成的图片！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20你可以根据当前对话上下文、你的角色人设、或你想表达的情感和氛围，来撰写可能详细而具体的prompt。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20例如：不要只写\x20\x22a\x20girl\x22，而是可以写\x20\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22但需要注意，绝对不可以抄袭模仿这段prompt！你必须有自己的创意和想法！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20prompt的详细程度由你根据具体情况自己决定：如果场景简单或只是随意分享，可以简短一些；如果是重要时刻或想表达特定情感，可以尽可能详细描述。这不是强制的，完全取决于你当时的需求。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20专注于描述内容本身即可。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20使用场景：当你想要基于当前对话情景、你的性格或上下文分享一张图片时使用。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20不要频繁使用，只在真正想分享图片的时候使用。','groupName','reading-restore-btn','<option\x20value=\x22current\x22>当前配置\x20(未保存)</option>','groupId','\x20//\x20<--\x20【核心】注入世界书\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请根据【通话前摘要】和下面的【通话实时记录】，继续进行对话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','add-preset-btn','\x0a现在，请根据以上所有信息，继续这场没有用户参与的群聊，并自由地使用各种指令来丰富你们的互动。\x0a','https://generativelanguage.googleapis.com/v1beta/models','douban-detail-post-title','.sender','confirm-variation-selection-btn','NPC\x20列表','rp-details-item','readAsText','push','novelai-settings-btn','--music-bg-image','werewolf-lobby-modal','已使用','\x20\x0a-\x20存活玩家:\x20','.json','input[value=\x22user\x22]','解析AI返回的JSON时出错:\x20','应用已返回前台，正在检查更新...','douban-post-detail-screen','</div><div\x20class=\x22payment-box\x22><div\x20class=\x22payment-label\x22>需付款</div><div\x20class=\x22amount\x22>¥','https://i.postimg.cc/L4zwDhTC/IMG-4399.gif','-\x20**昵称:\x20','\x22\x20placeholder=\x22例如：关于角色的童年\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>关键词\x20(用英文逗号,分隔)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-keys-input\x22\x20value=\x22','search-results-list','shopping-product-count-input','非图片格式，跳过压缩:','offline-mode-toggle','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心修改】在这里新增一个标题行\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','getContext','已取消收藏。','没有聊天了。','https://i.postimg.cc/FzbGNdRT/IMG-4392.gif','.loading-spinner','\x20天\x20---**\x0a','time','请至少选择一种要清理的数据类型。','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有可以查看手机的角色哦~</p>','LOW','lastActionType','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-actions-btn\x22>…</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','确认操作',']。当在对话历史中看到这些名字时，它们都指的是【你】自己。','add-new-product-category-btn','手动总结已完成！新的记忆已添加到“','#settings-preview-area','[系统提示：用户手动结束了投票！最终结果为：','https://i.postimg.cc/50k390X8/IMG-6376.gif','\x27>文字图</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','findLastIndex','生成模拟歌单失败:','[情景提示]\x20','#\x20性格补充\x0a','naiimag','，我们一起见证了这个约定。','cancel-call-message-action-btn','无法生成模拟聊天记录，请检查API配置或稍后再试。\x0a错误:\x20','对方撤回了一条消息','群里已经安静了\x20','\x0a#\x20你的任务\x0a你是一个虚拟音乐品味模拟器。你的任务是扮演角色“','确定要永久删除这条通话记录吗？此操作不可恢复。','\x22\x20class=\x22ai-generated-image\x22\x20alt=\x22','group_call_summary','\x20MB</strong>\x20(压缩率\x20','member-persona-input','https://i.postimg.cc/T1j03pQr/IMG-6440.jpg','https://i.postimg.cc/3Rb46fRZ/IMG-6923.gif','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20padding:\x2050px\x200;\x22>还没有可以参与的角色。</p>','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>商品:</strong>\x20','请为这个表情命名\x20(例如：好耶、疑惑)','\x20\x20-\x20评论:\x20','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份会议纪要或备忘录，而不是一篇抒情散文。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过80个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x0a','netease','currentPlaylist','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>你已将“','》吗？','sharedHistory','manage-ai-avatar-library-btn','center','product-editor-modal','regenerate-douban-btn','image_url','\x0a-\x20**人设**:\x20','delete','paidBy','\x22\x20(ID:\x20','rendering-rules-screen','狼人请选择刀人对象<br><small\x20style=\x22font-weight:normal;\x20font-size:\x2013px;\x22>你的队友是:\x20','<span\x20class=\x22lucky-king-tag\x22>手气王</span>','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>','\x20条旧的红包消息！页面将自动刷新以应用更改。','sender','.favorite-item-card.selected','198wlzjXD','选中的商品已成功删除。','quality_toggle','cancel-ai-response-editor-btn','toLowerCase','总结成功','.sticker-item.selected','chat-header-title-wrapper','\x22\x20class=\x22chat-image\x22></div>','执行检查时发生错误:\x20','#\x20已有路人NPC头像指令\x20(必须遵守！)\x0a','确定要删除这条评论吗？','https://i.postimg.cc/4NCPsp5d/mmexport1751034427637.gif','poison','<p\x20style=\x22color:\x20var(--text-secondary);\x22>没有可用的分组</p>','”。只有“','这将提取最近的对话内容发送给AI进行总结，会消耗API额度。确定要继续吗？','</p><p>','board','【原动态内容:\x20','\x22\x20尝试删除一个不存在或不属于自己的动态\x20(ID:\x20','通话记录已保存:','show-avatars-btn','\x20首歌曲，这可能需要一些时间...','死亡了','removeChild','Asia/Shanghai','setTimeout','borderColor','direct','offlinePresetId','\x20的浏览记录','char-qq-conversation-screen','globalCss','⚠️\x20NAI提示词：没有角色，使用系统配置','”的特点生成专属商品...','new-sticker-category-name-input','\x22>\x20','playerJson','.commenter-name','”。请你【结合自己的角色设定、世界观和你们的最近聊天内容】，对这条动态发表一条自然的评论。]','werewolf-action-bar','video-call-main','我通过了你的好友申请，我们现在是好友啦！','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756206115802_qdqqd_0c99bh.jpeg','clientX','renderXSocialScreenProxy','localeCompare','sticker-grid','char-browser-article-screen','post-remove-image-btn','minimax-model-select','cancel-contact-picker-btn','edit-product-btn','douban-max-posts-input','relative','selection-count','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于梳理以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**建立时间线**:\x20将所有独立的记忆点串联起来，形成一个有时间顺序的事件脉络。\x0a\x20\x20\x20\x20*\x20\x20\x20**整合关键信息**:\x20总结出我们共同经历的关键事件、做出的重要决定、以及约定好的未来计划。\x0a\x20\x20\x20\x20*\x20\x20\x20**识别未完成项**:\x20明确指出哪些计划或任务尚未完成。\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果记忆中提到了相对时间（如“明天”、“下周”），你【必须】结合“今天是','vertical','from','\x22的角色（你的本名是\x22','char-vinyl-container','translateX(calc(-','activeChatId','status-','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是角色“','ai-voice-id-input','计算图片总大小时出错:','\x20(这是你的帖子)','qzone_post','精炼失败','iconId','character-grid','【重要提示】','屠边局：狼人杀死所有神职或所有平民即获胜。','\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20border-radius:\x2050%;\x20margin-right:\x2012px;\x20filter:\x20','\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','[系统提示：你刚刚成功将自己的备注名修改为了“','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','readingLibrary','https://i.postimg.cc/fTWzQRx8/IMG-6149.gif','chat-list-actions-modal','.sticker-category-tab','AI角色无法完成投票，游戏暂停。请点击右上角的“重试”按钮继续。\x0a错误:\x20','API失败:\x20','\x22。\x0a','<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分组</p>','ai-frame-content','import-btn','**没有聊天了。\x0a-\x20**行为铁律**:\x20你的首要任务是【回应这个时间差】。你【绝对不能】直接延续上一段对话的话题（比如昨天的饭菜）。\x0a-\x20**你的行动**:你【必须】主动开启一个全新的、符合当前时间（','is-waimai-request','recalled-animation','select-all-types-for-clear','itemName','所有通话记录','cache','utf-16le','群成员','https://i.postimg.cc/xTk5xN49/IMG-7233.gif','typing-indicator','📊\x20使用模型:','https://i.postimg.cc/cCpBYbMH/IMG-6552.gif','字体URL不能为空！','shoppingCategoryCount','heartfeltVoice','\x0a##\x20','activePostId','inline-block','auto','\x20---\x0a','cphone-icon-settings-grid','https://i.postimg.cc/6pLTBvDG/IMG-5721.gif','选定范围内的动态已被清空。','[系统提示：用户之前发送了一张图片，AI对图片的首次回应（摘要）是：“','https://i.postimg.cc/rmB17Qbc/IMB-f-VDf-Fc.gif','cancel-product-editor-btn','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>金额:</strong>\x20¥','my-persona','确定要删除这条记录吗？','post-image-description','translateY(','theme-toggle-switch','GeminiChatDB','custom-modal-cancel','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20最近的动态列表\x20(供你参考和评论)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','htmlFor','https://i.postimg.cc/fLDnz5Pn/IMG-5574.gif','register','https://i.postimg.cc/Qx5dqyJ3/IMG-6917.gif','local-song-upload-input','date','offline-min-length-input','<option\x20value=\x22\x22>--\x20未分类\x20--</option>','heartfelt_voice','生成模拟淘宝记录失败:','”量身定制的商品已上架！','#custom-modal\x20.custom-modal-footer','showWaimaiDetails:\x20找不到消息或消息类型不正确','请填写完整的约定标题和日期！','已打包表:\x20','image-upload-input','(你是第一个发言的人)','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-message\x22\x20data-original-timestamp=\x22','<p>点击“导入”按钮，<br>从本地.txt文件或网络URL加载书籍内容。</p>','\x20分享了一张RealImag真实图片]','isArray','<p>','font-settings-screen','char-qq-screen','<span\x20style=\x22color:\x20green;\x22>运行中</span>','导演模式悔棋：已撤销AI在\x20(','imageCount','getMinutes','char-music-total-time','\x0a\x0a#\x20统一角色列表\x20(你扮演的角色\x20+\x20路人NPC)\x0a','getItem','gift-receipt-modal','获取AI狼人目标失败:','rp-content-direct','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20repost\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M17\x202.1l4\x204-4\x204\x20M3\x2011.5v-3a4\x204\x200\x200\x201\x204-4h13\x20M7\x2021.9l-4-4\x204-4\x20M21\x2012.5v3a4\x204\x200\x200\x201-4\x204H4\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>','粘贴歌词','import-single-chat-btn','scenario','toBlob','rp-group-amount','<div\x20class=\x22avatar-group\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20群聊中的用户刚刚发起了群视频通话。请你分别扮演【每一个群成员】，根据他们各自的人设和与用户的关系，来决定是加入(join)还是拒绝(decline)。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的回复【必须】是一个JSON数组，为【每一个AI角色】都包含一个决策对象。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20格式:\x20\x27[{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色A的本名\x22,\x20\x22decision\x22:\x20\x22join\x22},\x20{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色B的本名\x22,\x20\x22decision\x22:\x20\x22decline\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20群成员列表及人设\x0a\x20\x20\x20\x20\x20\x20\x20\x20','npc-editor-modal','https://i.postimg.cc/tRzPkzRg/IMG-7012.gif','marginTop','discussionLog','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22sticker-image-container\x22\x20style=\x22background-image:\x20url(','\x0a#\x20智能总结\x20(基于不同时间维度的群聊回顾)\x0a','found','\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器和故事作家。你的任务是扮演角色“','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有通话记录哦~</p>','chat-settings-btn','add-chat-btn','batch-import-frames-btn',')\x20和情景的感知。','img','touchstart','member-management-list','ai-cooldown-group','waimai-timer-','确认替换','management-mode','speaking','*事件*:\x20平安夜，无人出局。\x0a','复制成功','https://i.postimg.cc/qBbKK7dS/IMG-4386.gif','scrollTop','\x20分钟)，本次独立行动跳过。','删除表情','novelai-details','enabled','AI未能成功描述图片。','\x20拍了拍\x20“','compressed','vinyl-view','vote','frame_flower','status_msg','toggle','novelai-model','propel-btn','\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','</div>','switchToMyPhone','qzone-post-item','maxMemory','”分享TA的私人歌单...','</div><div\x20class=\x22card-text-secondary\x22>位置分享</div></div><div\x20class=\x22card-map-area\x22\x20','天\x20-\x20夜晚','update-notice-modal','poll-question-input','++id,\x20title,\x20lastOpened','.poll-option-item','请输入有效的金额(必须大于0)！','randomJottings','https://i.postimg.cc/ZnJNZWHZ/IMG-7009.gif','请根据以上情景，生成新的评论。','offsetParent','已重置为默认提示音，点击“保存所有外观设置”后生效。','\x0a\x0a#\x20核心世界观设定\x20(必须严格遵守以下所有设定)\x0a','apiKey','确定要删除表情\x20\x22','\x22\x20placeholder=\x22例如:\x20key1,\x20key2\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20这里是全新的、带有“展开/收起”按钮的结构\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x20display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>内容\x20(点击右侧展开)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22toggle-content-btn\x22>展开</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22entry-content-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20class=\x22entry-content-textarea\x22\x20rows=\x228\x22\x20style=\x22width:\x20100%;\x20font-size:\x2014px;\x22>','#\x20角色核心设定\x0a','bulkAdd','\x20(用户)</label>','announcement-actions-modal','cart-screen','对方本名不能为空！','\x22\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','lyrics-offset-input','group_summary_from_','map','phone-screen','music-search-results-modal','https://i.postimg.cc/85Zsyjwn/IMG-6895.gif','大小:','newSize','https://i.postimg.cc/05DLr0yj/IMG-4427.gif','quantity','选中的收藏已被移除。','save-character-nai-prompts-btn','add-group-chat-btn','你们在','fullPrompt','preset-action-edit','replyToDisplayName','开始清理','createWriteStream','rp-direct-receiver','渲染器','post_deleted_notice','add-world-book-entry-btn','cphoneAppIcons','批量导入格式错误，已跳过此行:','save-rule-btn','transcript','href','未知设定的角色','native','https://i.postimg.cc/k401K5g7/IMG-7304.jpg','nightActions','在执行组合操作时遇到错误:\x20','#music-lyrics-container\x20#music-lyrics-list','status-bar-battery','[你发送了一张需要AI识别的图片，图片内容是：\x27','自动总结狼人杀游戏失败:','\x20(时长:\x20','npc-background-activity-switch','[系统提示：','.text','qzone_like','”的群聊。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','nextElementSibling','EPhoneWorldBookBackup','apiConfig','add-poll-option-btn','修改文字','\x0a\x0a#\x20你的角色库\x20(你可以从中选择【任何角色】进行评论，并参考他们的记忆和对话)\x0a','[图片动态]','music-player-cover','.search-result-item','\x0a#\x20豆瓣社区风格设定\x20(来自世界书)\x0a','\x20的身份是：','https://i.postimg.cc/8kYShvrJ/90-UI-2.png','import-new-book-btn-header','生成新日记失败:','cancel-share-link-btn','boxSizing','product-image-input','group_','你让大家继续讨论...','AI投票决策API失败:','\x22\x20(用户)\x20或\x20\x22','regenerate-char-taobao-btn','https://i.postimg.cc/8k7YSLjK/1689aa46aqc4b9ffc0f970e668f56537.gif','qzone-avatar-input','startDiscussion','char-browser-history','\x20觉得很赞</span></div>','smea_dyn','请根据你的设定，生成模拟聊天记录。','characterNegativePrompt','isOfflineMode','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','replyTo','AI女巫决定使用解药！','repost-cancel-btn','未检测到BOM，尝试使用\x20UTF-8\x20解码...','从\x20JSON.data\x20中提取图片数据','count','char-memo-detail-title','uncategorized','网络图片\x20(EPhone)','\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20favorite\x20','**:\x20\x22','\x0a\x0a#\x20参考记忆\x20(至关重要！你必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你拥有完整的记忆。不要只是被动等待用户提问！)\x0a','reverse','editable-image','manage-world-book-categories-btn','cancel-share-target-btn','contactId','</span></div><div\x20class=\x22gift-items-preview\x22>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-member-btn\x22\x20data-member-id=\x22','.rules-category-pane','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','”的转账。]','qzonePhotos','memories-list','.status-text','18pHEaCc','分类《','这将提取当前通话记录发送给AI进行总结，会消耗API额度。确定要继续吗？','template','/v1/chat/completions','typeId','此操作将使用AI生成新的商品和分类，并【添加】到现有列表中。确定要继续吗？','！请对此事件发表评论。]','检测到\x20Tavern\x20AI\x20世界书文件，执行兼容导入...','AI们的茶话会','\x22\x0a-\x20**用户的备注**:\x20\x22','请开始总结。','API未配置','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**用户发送的申请理由**:\x20“','commenter','chat-name-group','link-source-input','请选择一个接收人！','music-playlist-panel','\x22]\x20.avatar','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20创建你的第一本世界书</p>','arc','select-all-cart-items','decline','图片内容','cancel-create-post-btn','join','(空)','旁观模式AI尝试使用不存在的表情:\x20\x22','请先在API设置中配置好（主或副）API以进行总结。','SAFETY','custom-modal-confirm','https://i.postimg.cc/gJ95NSRB/IMG-6854.gif','regex','https://i.postimg.cc/HWf1JKzn/IMG-6435.jpg','\x0a\x0a#\x20当前情景\x0a','\x22\x20class=\x22avatar-img\x22><img\x20src=\x22','最终负面提示词:','unread-indicator','delete-selected-frames-btn','\x20(概率:\x20','.delete-track-btn','character-nai-prompts-modal','\x22\x20class=\x22photo-thumb\x22\x20alt=\x22相册照片\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22photo-delete-btn\x22\x20data-photo-id=\x22','（无有效对话记录）','coverUrl','reset-global-css-btn','.playlist-item-info','.upload-variation-image-btn','检测到\x20\x27entries\x27\x20对象格式的预设，将尝试按顺序导入。','input:checked','\x22\x20class=\x22post-avatar\x22\x20data-author-id=\x22','group-avatar-library-grid','\x0a#\x20你的聊天对象（用户）的人设\x0a','nai-smea-dyn','lastMemorySummaryTimestamp','https://i.postimg.cc/bJDMQVkj/IMG-7112.gif','<div\x20class=\x22post-likes-section\x22><svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg><span>','margin','”\x20绑定到...','groupAvatarLibrary','repost-modal','douban-comment-input','sort','流式下载库\x20(StreamSaver.js)\x20未加载。请检查网络连接或HTML文件配置。','书名不能为空！','https://i.postimg.cc/rF4KYbjj/IMG-5720.gif','）。]','创建世界书','https://i.postimg.cc/xjpN4swz/IMG-7240.gif','.entry-content-textarea','countdown','<span\x20class=\x22speaker\x22>','100%','聊了关于生日派对的事，我们约好了10月1日见面。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a#\x20待总结的群聊记录\x0a','此操作将永久删除此聊天的所有消息，无法恢复。确定要清空吗？','豆瓣设置已更新！下次重新生成时将生效。','character','has','levelchange','请输入头像的图片URL','https://i.postimg.cc/fRTF24jS/IMG-4430.gif','shuoshuo','送给了\x20','cancel-clear-posts-btn','apiTemperature','拉取模型失败:\x20','confirm-create-post-btn','结算(','<br><small\x20style=\x22color:\x20#ff8a80;\x20margin-top:\x2010px;\x20display:\x20block;\x22>自动记忆总结失败，可稍后手动尝试。</small>','编辑消息','chat-header-status','character-selection-screen','save-font-preset-btn','gameover','manual-werewolf-summary-btn','.product-item','final','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22date\x22>','sticker-action-bar','<span\x20style=\x22color:\x20green;\x22>已满足，等待下次系统心跳</span>','nai-smea','load-more-qzone-btn','repostComment','translateX(','最近\x20100\x20条','\x20个新头像框！','prompt','命名表情','”，价值','\x22\x20class=\x22sticker-image\x22\x20style=\x22max-width:\x2080px;\x20max-height:\x2080px;\x22>','收藏成功','一位朋友','longTermMemory','preset-persona-input','transfer-btn','请输入你想说的话...','memory-list-container','已成功从文件导入预设《','close-my-avatar-library-btn','preset-editor-title','\x20分享了一张NovelAI图片，prompt:\x20','无法生成日记，请检查API配置或稍后再试。\x0a错误:\x20','[图片]\x20','[系统指令：用户按下了“推进”按钮，现在轮到你主动行动了，请继续对话。]','-\x20你昨晚守护了\x20','开始检查','cors_proxy','photoCount','播放已暂停','已选择\x20','\x22\x20触发带理由的好友申请决策流程...','char-usage-screen','new-category-name-input','正在扫描和修复数据...','AI已将新头像命名为：“','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22douban-post-timestamp\x22>','group_call_response','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22sticker-binding-checkbox\x22\x20data-chat-id=\x22','imageProcessed','请选择一个目标。','#\x20前几日完整历史回顾\x20(Full\x20Recap\x20of\x20Previous\x20Days)\x0a','已经一起听了','orderBy','50%','昨天\x20','values',')\x20领取了最后一个红包。红包已被领完，手气王是\x20','每晚可以查验一个玩家的身份是好人还是狼人。','https://i.postimg.cc/RZNLhbbr/IMG-4389.gif','startY','inject-thought-toggle','AI\x20的下棋指令无效或位置已被占据:','activeAlbumId','createDocumentFragment','innerHTML','\x0a##\x20---\x20来自','keydown','\x20个分类。\x0a\x20\x20\x20\x20-\x20**products**:\x20每个分类下生成\x20','https://','[系统提示：五子棋游戏已结束。最终结果是：','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22player-name\x22>','anno_','确认精炼','.waimai-details-btn','favorites','\x27>线下</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心修改2】在这里添加新的“引用”按钮\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','\x20回复了你。','.unread-indicator.back-btn-indicator','data:\x20[DONE]','char-music-player-modal','qzone-back-btn','keyword-search-input','setItem','您的旧有记忆已被完整保留，未作任何修改。','请先选择角色','\x0a-\x20**最近与用户的互动**:\x20','change_music','\x22\x20data-memory-timestamp=\x22','</small>','AI女巫决定使用毒药，目标是:\x20','.nav-item[data-view=\x22qzone-screen\x22]','switch-greeting-btn','Cphone','\x22\x20class=\x22douban-post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-author-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-author-name\x22>','”\x20将备注修改为\x20“','https://i.postimg.cc/g2XykNGB/IMG-4727.gif','一位成员','reject-friend-btn','已成功加入购物车！','font-weight:\x20bold;\x20background:\x20rgba(255,\x20193,\x207,\x200.2);','”。请你回顾一下刚才和\x20“','postId','生成截图时发生错误，请检查控制台获取详情。','.favorite-item-card','presetId','userStickers','无人接听群聊邀请。','-\x20**长期记忆\x20(必须参考)**:\x20','1024x1024','确定要将以下消息发布到公告板吗？\x0a\x0a“','user-speak-btn','finishReason','游戏配置：','这个分类下还没有商品哦~','musicLibrary','”\x20(你可以修改)\x0a-\x20\x20\x20**关键身份档案**:\x0a\x20\x20\x20\x20','round','DOMContentLoaded','”\x20已成功导入！','translateY(0px)','fileType','见面”）。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份备忘录或要点记录，而不是一篇抒情散文。请尽量减少主观的心理感受描述，除非它直接导致了某个决定或计划。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过100个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x0a','\x22，并与用户进行面对面的互动。你的任务是创作一段包含角色动作、神态、心理活动和对话的、连贯的叙事片段。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20你必须严格遵守\x20','来自“','variation-selected-price','killedId','投票至少需要2个选项。','请输入备忘录内容','没有可导出的世界书数据。','选择一个开场白','music-next-btn','”中，用户的昵称是“','nai-default-positive','charging','</div>\x0a\x20\x20\x20\x20','add-product-variation-btn','postType','werewolf-game-screen','album-screen','utf-8','upload-sticker-btn','lineWidth','proxyUrl','IMG','global-bg-input','你已经死亡，无法发言。请等待其他玩家发言结束。','spectator-edit-btn','通话名称已更新！','transfer-action-decline','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20padding-top:\x2020px;\x22>','nai-quality-toggle','<textarea\x20id=\x22','avatar-frame-modal','已加载预设\x20“','成功检查并修复了\x20','recalledData','你已拒收','”的TTS功能已关闭，已禁止发起TTS请求。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','传统导出数据时出错:','正在请求AI进行记忆精炼...','.sticker-item','EPhone-WorldBooks-','分享新鲜事...','simulatedTaobaoHistory','AI的五子棋移动指令包含无效坐标，已忽略:','speech','originalPost','分类名不能为空！','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2030px\x200;\x22>这里空空如也，快来发布第一条说说吧！</p>','friend_request_response','群聊通话中没有找到可作为总结主体的AI角色。','https://i.postimg.cc/gcV0VR2t/IMG-4408.gif','icon-setting-item','.remove-option-btn','.frame-content[style*=\x22display:\x20block\x22]\x20.frame-grid','\x0a\x20\x20\x20\x20','includes','在PNG文件中未找到有效的Tavern\x20AI角色数据(chara\x20chunk)。','</span>','\x20MB</strong></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','正在准备...','linked-memory-count','toDataURL','isDragging','select-all-stickers-checkbox','更换图片','character-nai-positive','visible','\x20位AI角色的长期记忆中！','-\x20你昨晚用解药救了\x20','pending_system_reflection','douban-detail-author','home-screen','remove-bg-btn','contact-picker-screen','#\x20长期记忆\x20(必须严格遵守)\x0a','\x27的发言）继续进行讨论。','link-description-input','https://i.postimg.cc/Ss7pM6fW/IMG-4410.gif','photo-viewer-image','[系统提示：用户（','请输入新的昵称','getDate','已成功收藏到“我的收藏”页面！','删除世界书失败:','\x20发布了一条新公告','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22slider\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条目\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>备注\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-comment-input\x22\x20value=\x22','openWerewolfLobby','where','categoryId','旁观模式收到未知指令类型:','请输入你想对“','\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“','cancel-variation-selection-btn','regenerate-char-album-btn','https://i.postimg.cc/YSkqDg8V/IMG-7092.gif','https://api.vkeys.cn/v2/music/netease?id=','.world-book-category-pane','getElementById','将清空收藏夹中所有与该角色相关的内容（如聊天、动态、日记等）。','album-photo-input','网易云','#chat-messages','AI\x20角色\x20\x22','quote_reply','请先填写NovelAI\x20API\x20Key！','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22article-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','npcs','group-avatar-upload-input','”。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**格式**:\x20你的回复【必须】是一段描述性的文本。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20你正在和用户（','chat-input-actions-top','myAvatarFrame','preview-bubble-style','语音生成失败','https://i.postimg.cc/y8p9s3Jj/IMG-6919.gif','rotating','[表情，含义:\x20','\x20元</div>','gameLog','.sticker-binding-checkbox','没有可供重新生成回复的用户消息。','暂停了音乐','replace','\x0a**---\x20第\x20','”。你的任务是虚构出【5到7段】TA最近的QQ聊天记录。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【NPC唯一性铁律】**:\x20在你本次生成的所有对话中（包括私聊和群聊），每一个NPC的名字【必须是独一-无二的】。绝对禁止出现重名的NPC，禁止出现重复群聊。\x0a2.\x20\x20**【NPC来源】**:\x20你应该优先从“你的社交圈\x20(绑定的NPC)”和“世界书”中寻找角色作为聊天对象。如果不够，你也可以自由创造全新的NPC，对话内容要多样化，反映角色的生活。\x0a3.\x20\x20**关联性**:\x20对话内容应巧妙地反映角色的长期记忆、世界观，以及与用户互动可能带来的心情变化。\x0a4.\x20\x20**简洁性**:\x20每段对话的总长度应在8到15句之间。\x0a#\x20格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须且只能】是一个JSON数组格式的字符串，以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记。\x0a-\x20数组中的每个元素都代表一段对话，且【必须】是以下两种格式之一：\x0a\x0a\x0a\x0a###\x20格式\x20A：与NPC的私聊\x0a```json\x0a{\x0a\x20\x20\x22type\x22:\x20\x22private_npc\x22,\x0a\x20\x20\x22participant\x22:\x20{\x0a\x20\x20\x20\x20\x22name\x22:\x20\x22NPC的名字\x22,\x0a\x20\x20\x20\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)一段用于生成头像的【英文】关键词,\x20风格为动漫/插画/二次元等,\x20禁止真人\x22\x0a\x20\x20},\x0a\x22messages\x22:\x20[\x0a\x20\x20{\x22sender\x22:\x20\x22','<div\x20class=\x22rp-claimed-info\x22>红包已被领完</div>','char-wallet-screen','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22url\x22>www.','char-memo-detail-back-btn','错误：找不到该通话记录所属的聊天对象。','loadedmetadata','.variation-image-preview','请根据你的设定，生成你的相册内容。','\x22\x20的独立行动失败:','prophetCheck','.world-book-category-pane[data-category-id=\x22','.quoted-message','\x20已为','\x0a#\x20你的任务\x0a你是一个虚拟社区的AI导演。下面的“帖子摘要”和“已有评论”来自于一个豆瓣小组的帖子。用户“','equals','...\x20[记忆:\x20','frame_cat_ear','https://i.postimg.cc/d10GjC4g/IMG-7302.jpg','[系统提示：用户加入了通话]','部分导入失败','”翻开TA的日记本...','复制失败','profile-random-jottings','\x22\x20的独立后台活动开关已关闭，本次跳过。','reload','open-sticker-panel-btn','stream','masterpiece,\x20best\x20quality,\x201girl,\x20beautiful,\x20detailed\x20face,\x20detailed\x20eyes,\x20long\x20hair,\x20anime\x20style','请输入一个有效的图片URL！','participant','查验结果','world-book-checkboxes-container','onplay','trans','请为这组提示词预设命名：','group-avatar-input','至少需要保留一条消息。','transaction','toArray','arrayBuffer','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22voice-duration\x22>','minimized','https://i.postimg.cc/DzDy2vS7/IMG-7017.gif','byteLength','https://i.postimg.cc/L5RLr3tg/mmexport1751035976943.gif','manage-my-avatar-library-btn','...\x0a-\x20**已有评论**:\x0a','isActive','categories','user','请输入歌名','[ERROR:\x20','✅\x20NAI提示词：使用角色配置','headers','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2018px\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2013px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-weight:\x20500;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20var(--text-secondary);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#f0f2f5;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-top:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-top:\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','rule-regex-input','notification-sound-url-input','删除消息','\x20\x0a#\x20社交圈与动态\x0a','waimai_order','...','这是群里的第一条消息。','simulatedAppUsage','linear-gradient(135deg,\x20#89f7fe,\x20#66a6ff)','clear-search-btn','</span>:\x20','.selected-options-text','table','fill','.werewolf-player-checkbox:checked','\x20的备忘录','k_euler_ancestral','请求添加你为好友','#data-clear-char-list\x20.clear-posts-item','cart-items-list','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请开始你的导演工作，让群聊再次热闹起来吧！\x0a\x20\x20\x20\x20\x20\x20\x20\x20','value','./sw.js','.progress-bar','.message-editor-block','<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>','charAt','基础数据不完整，无法开始总结。','\x20/\x20','link-title-input','form-button','正在读取所有数据到内存中，请稍候...','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','https://i.postimg.cc/kXfcgFRN/IMG-7106.gif','\x0a#\x20长期记忆\x20(你必须严格遵守的事实)\x0a','linkedWorldBookId','suffix','你已死亡，正在围观...','start-werewolf-game-btn','-\x20你昨晚空守了。\x0a','key','https://i.postimg.cc/gk0BmrY0/IMG-4371.gif','smooth','world-book-screen','https://i.postimg.cc/90RBDh9K/IMG-6377.gif','my-avatar-input','modern\x20app\x20icon\x20for\x20','originalType','\x27,\x20\x27bulangni\x27,\x20-apple-system,\x20BlinkMacSystemFont,\x20\x22Segoe\x20UI\x22,\x20Roboto,\x20Helvetica,\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}','<div\x20class=\x22post-main-content\x22>','清理冗余数据时出错:','increase-qty-btn','找到图片文件:','最近的消息太少，无法进行有意义的总结。','\x20-\x20','onload','通话记录','.world-book-tab','white','cssText','getHours','role','”的视频通话，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','https://i.postimg.cc/cLPP10Vm/4.jpg','<div\x20class=\x22post-images-grid\x20grid-','\x0a#\x20关系与身份档案\x20(至关重要)\x0a-\x20\x20\x20**你的本名**:\x20\x22','toggle-blur-btn','select-all-products-checkbox','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','shopping-category-count-input','ai-original-name-group','\x22\x20尝试领取不属于自己的群聊红包。操作已被拦截。','”，金额是\x20','reset-button-order-btn','压缩完成！','1px\x20solid\x20#e0e0e0','---\x20','请输入新的内容：','[群聊]','\x0a\x0a#\x20参考记忆\x20(至关重要！群内角色必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你们拥有完整的共同记忆。)\x0a','无法找到当前角色的数据。','shiftKey','移出成员','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-to-cart-btn\x22>加入购物车</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://image.novelai.net/ai/generate-image','cancelable','https://i.postimg.cc/JnwFp3Kx/mmexport1751031208329.gif','\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','frame_10','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>暂无支出记录。</p>','\x0a-\x20**可以刀的玩家列表**:\x20','Playback\x20error:','[系统提示：你\x20','cart-item-checkbox','用户向你发送了一张图片','isDeleted','创建群聊','chat-render-window-input','\x27\x20在你的动态(ID:\x20','callRecords','https://i.postimg.cc/fyPDvxJk/IMG-6860.gif','#preset-content-container\x20.world-book-category-pane','next-page-btn','character-nai-prompts-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-management-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-product-btn\x22>编辑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-product-btn\x22>删除</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','browser-content','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x20width:\x2045px;\x20height:\x2045px;\x22></div>','total-image-size-display','后台活动模拟已自动启动。','transfer-actions-modal','无法自动播放静音音频（这在iOS首次加载时是正常现象）:','文件格式无法识别。未找到有效的\x20\x27prompts\x27\x20数组或\x20\x27entries\x27\x20对象。','游戏结束','.draggable-button-item','doubanMaxPosts','split','recall-message-btn','https://i.postimg.cc/HxH3cNHz/IMG-6871.gif','image/png','AI返回了空的或格式不正确的总结内容。','input[name=\x22theme-select\x22][value=\x22','closed','currentTime','https://i.postimg.cc/gc3QYCDy/1-NINE7-Five.jpg','regenerate-btn','packet_timestamp','）刚刚拍了拍你（','*事件*:\x20','”。用户刚刚在TA的手机（CPhone）上点击了一个按钮，希望你能继续你们之前的对话。你的任务是根据上下文，生成【3到5条】符合你人设的、简短的、连续的新回复。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组，每个对象代表一条消息。\x0a-\x20格式:\x20`[{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22第一句话\x22},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22第二句话\x22},\x20{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}]`\x0a-\x20你可以自由组合使用\x20\x22text\x22,\x20\x22sticker\x22,\x20\x22ai_image\x22,\x20\x22voice_message\x22\x20等多种消息类型。\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20你的角色设定\x0a','\x20条内容吗？',')\x20内容:\x20\x22','https://i.postimg.cc/Lsr1Zd3Z/IMG-6928.gif','确定要删除NPC\x20“','(暂无有效聊天记录)\x0a','simulatedAmapHistory','world-book-card','导出成功','</persona>\x0a</character>\x0a','请输入一个\x202\x20到\x20','送给\x20','group-management-modal','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的【所有】日记的标题日期，【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a2.\x20\x20**【沉浸感】**:\x20每一篇日记都必须使用【第一人称视角\x20(\x22我\x22)】来写，并且要充满角色的个人情感、思考和秘密。在日记中描述自己的行为或想法时，【绝对禁止】使用第三人称“他”或“她”\x20(TA)。\x0a3.\x20\x20**【长度】**:\x20每一篇日记的正文长度【必须不少于300字】。\x0a4.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一篇日记，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22这篇日记的标题，例如：9月20日\x20晴\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22这里是日记的详细正文，必须支持换行符\x5cn，并且必须巧妙地使用下面的【日记专属Markdown语法】来丰富文本表现力。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a5.\x20\x20**【占位符替换\x20(最高优先级)】**:\x20在你的日记内容中，【绝对不能】出现\x20\x22{{user}}\x22\x20这个占位符。你【必须】使用\x20“','favorites-delete-selected-btn','...]','music-player-avatar-display','\x20\x20\x20characterNegativePrompt:','”。请自然地接受这个新名字，不要对此感到惊讶。]','”，并根据其人设、记忆和最近的互动，虚构出【1篇】TA今天可能会写的日记。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【【【时间铁律\x20(最高优先级)】】】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','...\x22','choice','无备注','{\x0a\x20\x20\x22type\x22:\x20\x22text\x22,\x0a\x20\x20\x22content\x22:\x20\x22在这里输入新消息...\x22\x0a}','.sticker-item[data-sticker-id=\x22','name','导入\x20Tavern\x20预设','announcement-item-actions','.chat-list-item','https://i.postimg.cc/GhR6DT4Q/IMG-4428.gif','设置群名','https://i.postimg.cc/Ss3znzk7/IMG-6934.gif','personaPresets','切换听歌对象','text','》:\x0a','touchmove','\x0a-\x20好人胜利：放逐所有狼人。\x0a\x0a#\x20当前游戏状态\x0a-\x20今天是第\x20','长截图生成失败:','douban-detail-back-btn','gift-receipt-body','播放列表是空的，无需清理。','catch','-\x20你昨晚用毒药毒了\x20','.avatar-group','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20用户刚刚向你发起了视频通话。请根据你的角色设定，决定是“接受”还是“拒绝”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的角色设定\x0a\x20\x20\x20\x20\x20\x20\x20\x20','检测到\x20UTF-16\x20LE\x20BOM，使用\x20UTF-16\x20LE\x20解码。','”的身份，开始你的客观总结。',')，祝福语是：“','lucky','reading-title','thoughtsHistory','导入已取消，因为未提供书名。','highlighted','head','无法生成商品，请检查(主/副)API配置或稍后再试。\x0a错误:\x20','data-clear-type-list','char-diary-detail-screen','is-red-packet','chat-at-mention-popup','确认删除','”下，发送了一个表情评论，意思是：“','分组名不能为空！','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','.comment-sticker-btn','分钟前','请根据你的设定，生成你的App使用记录。','等待回复失败:','werewolf-log-entry\x20','single-lyric-display','startsWith','<p><strong>','解析格式模板失败:','\x20为你切歌:\x20《','设置已应用','persona','a\x20beautiful\x20scene','back-to-list-btn','border','页面跳转','.header','battery-alert-modal','banner','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-group-name\x22>来自\x20','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','preset-entries-container','...”','**[讨论环节]**\x0a','置顶公告','candidates','https://i.postimg.cc/Dydkpd9H/IMG-4421.gif','手动注入记忆时出错:\x20','\x0a\x0a现在，请开始生成这组足迹记录。','my-frame-tab','active','char_browser_article','\x0a\x0a现在，请开始生成这组备忘录。','group_call_request','正在模拟“','\x20的聊天','notification-sound-player','正在为您选择的\x20','[图片:\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有备忘录。</p>','https://i.postimg.cc/HLKvs0Kv/IMG-7109.gif','请你对此作出回应。]','lrc-upload-input','message-bubble\x20post-deleted-placeholder','更换“','<div\x20class=\x22transfer-card\x22><div\x20class=\x22transfer-title\x22>','小组风格','https://i.postimg.cc/sDFhySn3/IMG-6936.gif','https://i.postimg.cc/7Zgm1wRy/IMG-6295.gif','https://i.postimg.cc/kMfPQBwQ/IMG-4396.gif','selection-soft-delete-btn','[系统提示：用户关闭了五子棋棋盘，游戏结束了。]','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-price\x22>¥','\x20张<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20空间节省了\x20<strong>','批量导入头像','grayscale(100%)','请添加歌曲','totalElapsedTime','confirm-contact-picker-btn','reset-custom-css-btn','https://i.postimg.cc/q7cQnDy1/IMG-4404.gif','auto-memory-toggle','未知设定的NPC','playMode','go-to-cart-btn','light','\x20请根据这个结果发表你的评论。]','qzone-sticker-grid','在这里输入语音内容','put','正在呼叫所有成员...','char-conversation-messages','hasListener','en-US','user_photo','”请求添加你为好友：<br><i>“','change-icon-btn','handleListenTogetherClick','showStatusBar','album-art-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>','记忆链接','群聊人数不能少于2人。','chatItem','copy-post-btn','删除分类及表情时出错:','\x22\x20data-commenter-original-name=\x22','cancel-gift-recipient-btn','existing-categories-list','\x22>+</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','ZIP文件中未找到图片','图片格式处理失败:\x20',')**:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-icon\x22>📍</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-title\x22>',')。红包还未领完，你现在可以使用\x20\x27open_red_packet\x27\x20指令来尝试领取。]','https://i.postimg.cc/c4JMPd2W/IMG-4724.gif','\x20字的核心记忆。这些旧记忆将被替换，此操作不可撤销。确定要继续吗？','reading-library-search-input','link-content-input','findLast','temp_group_chat','无法获取AI回复，请检查API配置或稍后再试。\x0a错误:\x20','stores','https://i.postimg.cc/pXxk1JXk/IMG-6442.jpg','url','\x22,\x20\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}\x0a]\x0a}\x0a```\x0a\x0a###\x20格式\x20B：群聊\x0a```json\x0a{\x0a\x20\x20\x22type\x22:\x20\x22group\x22,\x0a\x20\x20\x22groupName\x22:\x20\x22一个虚构的群名\x22,\x0a\x20\x20\x22participants\x22:\x20[\x0a\x20\x20\x20\x20{\x22name\x22:\x20\x22NPC成员1\x22,\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)\x20成员1头像【英文】关键词\x22},\x0a\x20\x20\x20\x20{\x22name\x22:\x20\x22NPC成员2\x22,\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)\x20成员2头像【英文】关键词\x22}\x0a\x20\x20],\x0a\x22messages\x22:\x20[\x0a\x20\x20{\x22sender\x22:\x20\x22','\x0a#\x20---\x20世界书设定结束\x20---\x0a','[data-version]','.select-box','transfer','”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20作为参考，这是你们之前的最后一段聊天记录：\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20','countdownEndTime','正在接通...','guard','状态已更新','”\x20的预设已存在。要覆盖它吗？','#f9f9f9','\x20的外卖代付请求（时间戳:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22memo-title\x22>','确定要删除这条长期记忆吗？','default','-modal','请至少选择一个要清理的角色。','-\x20你们昨晚尝试攻击的玩家是：','album-photos-screen','share-target-modal','」的新会话吗？','savedId','这是你们最近的对话：\x0a','屠城局：狼人杀死所有好人即获胜。','setup','CSS\x20预设已保存！','call-history-title','copy-message-btn','add-manual-memory-btn-header','tagName','productId','?key=','++id,\x20type,\x20timestamp,\x20originalTimestamp','-\x20**对话状态**:\x20你的上一条消息发送于\x20','message-wrapper\x20system-pat','</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20需要冷静(小时):\x20<strong>','-\x20(记录于\x20','#\x20角色与玩家档案\x20(Character\x20&\x20Player\x20Dossiers)\x0a','\x22\x20placeholder=\x22例如：角色核心设定\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>关键词\x20(用英文逗号,分隔)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-keys-input\x22\x20value=\x22','本地群头像上传及识别失败:','检测到AI执行了动态操作，立即刷新好友动态页面。','https://i.postimg.cc/KvVsjjgG/3c3aa5219s18b90187ef1f54b3db7ba8.gif','</option>',')\x20刚刚领取了红包\x20(时间戳:\x20','你查验的玩家\x20','\x20\x20-\x20你评论说:\x20','data:','font-preview','chatListRenderWindow','favorites-search-input','一个神秘的角色。','旁观模式AI发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','modify','char-music-next-btn','删除头像','qzone_comment','ceil','photos-grid-page','https://i.postimg.cc/Jz2Tz0dw/IMG-7281.jpg','”。\x0a\x20\x20\x20\x20-\x20\x20\x20你【绝对不能】生成\x20authorName\x20或\x20commenter\x20字段为\x20“','data:image','rules-content-container','[照片]','导入成功','图片解压失败:\x20','✅\x20检测到直接的图片\x20base64\x20数据\x20(PNG/JPEG)','请至少选择一个要添加的联系人。','song','touches','目标消息未找到,\x20正在加载更多历史记录...\x20(尝试\x20','更换专辑封面','AI返回的JSON格式不正确，缺少\x20\x27categories\x27\x20数组。','[一张图片，其隐藏文字为：\x22','\x0a-\x20**你们最后的对话摘要**:\x20\x0a','npc-persona-input','customAvatarFrames','未知歌手','解析成功：标准JSON数组格式。','send_and_recall','isTemporary','spectator-propel-btn','<strong>','https://i.postimg.cc/ThMMVfW4/10.jpg','callRequester','已同步角色\x20','\x22\x20data-description=\x22','<div\x20class=\x22poll-card\x20','rules-tab\x20active','https://i.postimg.cc/cJtpZCB3/IMG-6894.gif','first','未知作者','ready','等待对方处理','分类\x20\x22','open-reading-library-btn','animate-like','messages','confirmButtonClass','wallpaper-upload-input','contains','chat-messages','object','close-char-music-player-btn','\x20元</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','targetDate','album','-\x20你的毒药状态：','delete-transcript-btn','相册已成功删除。','.qzone-post-container','aiAvatarFrame','create-countdown-modal','合计:\x20¥','char-photo-item','add-persona-preset-btn','新建备忘录','-\x20清理了\x20','<div\x20class=\x22receipt-header\x22><h3>购物中心</h3><p>交易时间:\x20','无法生成浏览记录，请检查API配置或稍后再试。\x0a错误:\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-group-btn\x22\x20data-book-id=\x22','\x0a\x0a现在，请生成新的评论。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<textarea>','\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a','小红书','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20指令格式\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22decision\x22:\x20\x22apply\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22reason\x22:\x20\x22在这里写下你想对用户说的、真诚的、有针对性的申请理由。\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x20\x20\x20\x20','AI\x20(群聊后台)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','chat-list-action-delete','preset-avatar-preview','image','poisonedId','display','已删除最新心声，当前心声已回滚至上一条。','chat-settings-screen','https://i.postimg.cc/4y7mGFgJ/IMG-5716.gif','groupAvatar','anyOf','已成功批量导入\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','55VTUhxU','\x0a\x0a\x0a\x0a现在，请根据以上规则和下面的对话历史，继续进行对话。','exclude','请输入要精炼的最近记忆条数\x20(最多\x20','点击了商品卡片:\x20',')\x20为\x20','正在导入表:\x20','**。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20为了让你的行为看起来更真实，你本次的行动【必须】选择一个与上次【不同类型】的指令。例如，如果上次是发动态(qzone_post)，这次就应该优先考虑评论(qzone_comment)、点赞(qzone_like)或发消息(text)。\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20**【行为组合指南\x20(最高级技巧)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20你可以在一次行动中执行【多个不同类型的指令】，同时可以搭配【更新状态】来展现自己，让你的行为更丰富、更主动。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20你可以根据你的性格，决定在发动态后是否要私信提醒用户。例如，一个外向、渴望关注的角色可能会这么做，而一个内向、安静的角色则可能更喜欢默默分享，等待用户自己发现。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【社交义务铁律\x20】\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【至关重要】**:\x20当你发现“最近的动态列表”中，有你【感兴趣且还未互动过】的动态时，你**应该优先考虑**使用\x20\x27qzone_comment\x27\x20或\x20\x27qzone_like\x27\x20指令去进行互动，这比你自己发一条新动态更符合社交礼仪。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20特别是当一条动态【没有任何评论】时，你的评论会是第一个，这会让作者感到开心。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**【回复铁律\x20(终极版)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20当你决定回复动态中的某条评论时，你【必须】使用“方式4\x20(回复评论)”的指令格式。你【必须】正确填写\x20\x27replyTo\x27\x20字段为被回复者的“本名”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**即使你之前已经评论过某条动态，但如果现在看到了【新的、你感兴趣的】评论，你【也应该】主动去回复他们，以保持对话的持续性！**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x206.\x20\x20你的回复【必须】是一个JSON数组，必须包含多个行动对象。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【表情评论指南\x20】\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在拥有了评论表情的能力，你应该更频繁地使用它！这能让你的角色更加生动、富有个性。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**表达情绪时**:\x20当你感到开心、惊讶、疑惑或有趣时，优先考虑使用表情评论。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**混合使用**:\x20不要总是只发文字。尝试将你的评论行为混合起来，大约有\x2030-40%\x20的评论应该是表情。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**无话可说时**:\x20如果你觉得一条动态很有趣但又不知道该说什么文字，发送一个相关的表情是最好的互动方式。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**删除动态**:\x20如果你觉得你之前发的某条动态不妥或过时了，你可以选择删除它。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的可选行动指令\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发消息+更新状态**:\x20\x27[{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22正在做的事\x22,\x20\x22is_busy\x22:\x20true},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你想对用户说的话...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发说说\x20(原创内容)**:\x20\x27[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22动态的文字内容...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**【重要：转发动态】**:\x20**严禁**自己拼接\x22//转发\x22文字！你【必须】使用此专用指令来转发：\x27[{\x22type\x22:\x20\x22repost\x22,\x20\x22postId\x22:\x20(要转发的动态ID),\x20\x22comment\x22:\x20\x22你的转发评论...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送表情**:\x20\x27[{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}]\x27\x20\x20\x20\x20\x20\x20\x20\x20\x0a-\x20\x20\x20**发布文字图**:\x20\x27[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22text_image\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的公开文字\x22,\x20\x22hiddenContent\x22:\x20\x22对于图片的具体【中文】描述...\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**【评论动态的四种方式】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式1\x20(单条文字)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22这太有趣了！\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式2\x20(多条文字)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22comments\x22:\x20[\x22哇！\x22,\x20\x22这是什么？\x22,\x20\x22看起来好棒！\x22]}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式3\x20(表情)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20456,\x20\x22stickerMeaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式4\x20(回复评论)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者的本名\x22,\x20\x22commentText\x22:\x20\x22你的回复内容。请注意：在commentText中如果要@对方，你【必须】使用@[[被回复者的本名]]这种特殊格式，程序会自动将其替换为正确的昵称。\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**点赞**:\x20\x27[{\x22type\x22:\x20\x22qzone_like\x22,\x20\x22postId\x22:\x20456}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**打视频**:\x20\x27[{\x22type\x22:\x20\x22video_call_request\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**更换头像**:\x20\x27{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}\x27\x20(头像名必须从下面的“可用头像列表”中选择)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**删除动态**:\x20\x27{\x22type\x22:\x20\x22qzone_delete_post\x22,\x20\x22postId\x22:\x20(要删除的、你自己的动态ID)}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**更新状态**:\x20\x27[{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22正在做的事\x22,\x20\x22is_busy\x22:\x20true}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20','当作\x20ZIP\x20文件处理...','通话中还没有你的发言，无法重新生成回应。','call-record-card','\x20的动态\x20(NPC)','https://i.postimg.cc/nrJSqNhz/IMG-4432.gif','loadAsync','正在生成“','isBgClear','stickerCategories','renderWallpaperScreenProxy','#chat-list-bottom-nav\x20.nav-item','AI\x20(CPhone)\x20尝试使用一个不存在的表情:\x20\x22','https://i.postimg.cc/8P5vt8sW/IMG-7097.gif','new-product-category-name-input','.thought-delete-btn','smea','latestTimestamp','home-screen-pages','fontUrl','.qzone-post-container[data-post-id=\x22','characterPositivePrompt','\x0a\x0a#\x20【你的聊天对象（用户）的身份档案】\x0a-\x20**昵称**:\x20','600900EfACUA','\x20条红包记录。','在这里输入说说的内容...','日\x20---','isAlive','source_name','block-cooldown-input','请根据你的设定，生成你的淘宝购买记录和余额。','placeholder.png','assign-group-select','\x22>专辑</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20lyrics-btn\x22\x20data-index=\x22','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>公告的原消息已被删除。</p>','\x22\x20中的成员信息更新','正在批量添加\x20','暂无内容...','nai-test-negative','”。用户之前被你拉黑了，现在TA向你发送了好友申请，希望和好。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20供你决策的上下文信息:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**你的角色设定**:\x20','base','\x22\x20创建成功！','创建普通群聊\x20(我参与)','novelai-api-key','#world-book-checkboxes-container\x20input[type=\x22checkbox\x22]:checked','相册\x20\x22','.waimai-user-actions\x20button','\x20\x20\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的本名**:\x20\x22','将分类\x20“','max','(回复\x20','字体已保存并应用！','\x0a现在，请为【参与了对话的AI角色】生成他们各自的、第一人称的、精简的记忆。','”\x20的位置已发送到你们的聊天中。','++id,\x20name,\x20enableBackgroundActivity,\x20actionCooldownMinutes,\x20lastActionTimestamp','保存书籍(ID:\x20','clearRect','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x208px;\x20flex-shrink:\x200;\x20margin-left:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22memory-action-btn\x20edit-memory-btn\x22\x20data-author-id=\x22','号玩家:\x20','所有数据已成功恢复！应用即将刷新以应用所有更改。','NovelAI\x20API\x20Key未配置。请在NovelAI设置中填写API\x20Key。','\x22\x20的后台活动开关已关闭，本次跳过。','\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-display:\x20swap;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}','以外】的所有AI角色，并根据他们的【角色人设】和【狼人杀身份】，生成一整轮符合逻辑、充满博弈的发言。\x0a\x0a#\x20身份与人设铁律\x20(最高优先级)\x0a你【必须】为每一个角色都仔细阅读并严格遵守下面的档案。这是你所有行为和发言的唯一依据。在对话中，请务必注意角色人设中暗示的性别，并使用正确的称呼（例如“他”或“她”）。\x0a\x0a','.entry-comment-input','div','自动总结成功：已成功添加\x201\x20条新的长期记忆！','模型列表已更新','607355AdzTCM','<span\x20class=\x22commenter-name\x22>','werewolf-game-btn','#image-mode-content','送给大家的礼物','npc-list','收到了格式不规范的AI指令（缺少type和content），已跳过:','cancel-sticker-binding-btn','”的记忆\x20---\x0a','music-progress-fill','无法找到或消息类型不匹配的分享链接:','new-group-name-input','image-mode-content','hidden','https://i.postimg.cc/3JSG5Jv5/IMG-7014.gif','settings-preview-area','ttsCache','offsetTop','voted','没有找到可导入的内容。请检查您粘贴的格式是否正确。','\x20本世界书已成功删除。','\x0a-\x20**最近对话摘要**:\x0a','toFixed','\x20更换了头像]','https://i.postimg.cc/T1tjhsyB/IMG-4720.gif','#fullscreen-lyrics-container\x20.music-lyrics-list','https://i.postimg.cc/t4ksHGdg/IMG-7020.gif','member-editor','\x22\x20class=\x22avatar\x22>','”\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**被拉黑前的最后对话摘要**:\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','检测到群聊\x20\x22','\x20(用户)\x20或其他AI的发言，必须对他们的观点和逻辑做出回应。\x0a2.\x20\x20**记忆力与连贯性**:\x20你的新发言【必须】是基于**过去几天和今天发生的所有事件和讨论**的逻辑延续。\x0a\x0a//\x20【核心修改2】明确了JSON格式中\x20speaker_name\x20和对话中称呼的不同要求\x0a3.\x20\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON数组，格式为:\x20`{\x22speaker_name\x22:\x20\x22角色的【昵称】\x22,\x20\x22dialogue\x22:\x20\x22发言内容\x22}`。**必须**为每一个存活的AI角色都生成一段发言。\x0a4.\x20\x20**称呼铁律**:\x20你的发言中【绝对禁止】提及任何玩家的编号。在对话中互相称呼时，你【必须】使用玩家的【本名】，而不是他们的昵称。\x0a\x0a#\x20','标准JSON数组解析失败，将尝试强力解析...','werewolf-player-avatar','options','https://i.postimg.cc/D01rYy86/mmexport1751037965259.gif','\x20发送了一张图片，内容是：\x27','ServiceWorker\x20注册成功，作用域为:\x20','无结果','parsedLyrics','selection-screenshot-btn','请根据以上设定，立即做出你的决定。','</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22article-meta\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>来源:\x20','\x20的红包已被领完','<option\x20value=\x22\x22>--\x20不使用预设\x20--</option>','删除规则','\x20元，订单时间戳为\x20','\x20-\x20响应内容:\x20','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的日记标题日期【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a2.\x20\x20**【【【沉浸感铁律】】】**:\x20日记必须使用【第一人称视角\x20(\x22我\x22)】来写，并且要充满角色的个人情感、思考和秘密。在日记中描述自己的行为或想法时，【绝对禁止】使用第三人称“他”或“她”\x20(TA)。\x0a3.\x20\x20**【【【长度铁律】】】**:\x20日记的正文长度【必须不少于300字】。\x0a4.\x20\x20**【【【格式铁律\x20(最高优先级)】】】**:\x20你的回复【必须且只能】是一个JSON数组，且数组中【只包含一个】对象，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22这篇日记的标题，例如：9月20日\x20晴\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22这里是日记的详细正文，必须支持换行符\x5cn，并且必须巧妙地使用下面的【日记专属Markdown语法】来丰富文本表现力。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a5.\x20\x20**【【【日记专属Markdown语法\x20(必须使用！)】】】**:\x0a\x20\x20\x20\x20-\x20\x20\x20`**加粗文字**`:\x20用于强调。\x0a\x20\x20\x20\x20-\x20\x20\x20`~~划掉的文字~~`:\x20用于表示改变主意或自我否定。\x0a\x20\x20\x20\x20-\x20\x20\x20`!h{黄色高亮}`:\x20用于标记关键词或重要信息。\x0a\x20\x20\x20\x20-\x20\x20\x20`!u{粉色下划线}`:\x20用于标注人名、地名或特殊名词。\x0a\x20\x20\x20\x20-\x20\x20\x20`!e{粉色强调}`:\x20用于表达强烈的情绪。\x0a\x20\x20\x20\x20-\x20\x20\x20`!w{手写体}`:\x20用于写下引言、歌词或特殊笔记。\x0a\x20\x20\x20\x20-\x20\x20\x20`!m{凌乱的手写体}`:\x20用于表达激动、慌乱或潦草记录时的心情。\x0a\x20\x20\x20\x20-\x20\x20\x20`||涂黑||`:\x20用于隐藏秘密或敏感词汇(每次涂黑2~5个字)。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','isClosed','网络请求失败:\x20','精炼“','**关键词:**\x20','\x0a\x20\x20-\x20**人设**:\x20','\x0a---\x0a###\x20帖子ID:\x20','photo-viewer-prev-btn','share-link-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','chat-input','导入外观设置时出错:','post-upload-local-btn','</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','change-frame-btn','”的长期记忆中。','transfer-action-cancel','.lyrics-btn','matches','📋\x20请求体:','2GDPIVi','sticker-category-tab','resolution','werewolf-wait-reply-btn','</td><td\x20class=\x22item-qty\x22>','world_info','♪\x20歌词位置预览\x20♪','product-item','save-douban-settings-btn','.char-product-item','已成功加载外观预设：“','npc','NPC人设','change_user_nickname','group-avatar-preview','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22diary-title\x22>','meaning','<div\x20class=\x22comment-item\x22\x20data-post-id=\x22','\x22\x20class=\x22avatar-frame\x22></div>','world-book-category-manager-modal','variation-selection-modal','https://i.postimg.cc/SNByPrf9/IMG-7005.gif','margin:\x2015px\x200\x205px;\x20color:\x20#555;\x20border-bottom:\x201px\x20solid\x20#eee;\x20padding-bottom:\x203px;','change_group_name','cphone','close-playlist-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20可用表情包\x0a\x20\x20\x20\x20\x20\x20\x20\x20','confirm-hunter-shot-btn','\x20为您代付成功','[表情]\x20含义:\x20\x22','\x22\x20自动触发AI响应...','clear-specific-data-btn','https://image.pollinations.ai/prompt/','dead','专属红包:\x20给\x20','werewolf-retry-btn','请为你的图片添加一个简单的描述（必填，给AI看的）！','未知表情','member','edit-post-btn','padStart','memories-view','压缩步骤\x202/3:\x20正在内存中异步压缩图片，这可能需要一些时间...','close-gomoku-btn','确认拉黑','streamSaver','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>','wallpaper','cancel-post-action-btn','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22amount\x22>','[你发送了一条语音消息，内容是：\x27','visibilitychange','错误:\x20','✅\x20图片解压成功！','”图标','content-type','stopPropagation','请你投票。','poisonUsed','char-usage-item','相册名称不能为空！','\x22\x20value=\x22','gomoku-btn','</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20<div\x20class=\x22playlist-item-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20album-art-btn\x22\x20data-index=\x22','这将用文件中的数据【完全覆盖】您当前所有的世界书和分类。此操作不可撤销！','update_thoughts','狼人杀AI回应生成失败:','first_mes','custom-prompt-input','isLocal','”添加记忆','message','确定要从头像库中删除“','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','gomoku-overlay','你正在阅读的段落','GBK\x20解码成功。','ᗜωᗜ','sticker-binding-modal','preset_','15px','请输入有效的正整数！','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-title\x22>','AI\x20(群聊后台)\x20尝试使用一个不存在的表情:\x20\x22','\x0a\x0a#\x20群成员列表及人设\x20(你扮演的所有角色)\x0a','is-link-share','\x0a-\x20**内容摘要**:\x20','gift-recipient-modal','导出世界书时出错:','api-temperature-value','\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22','.poll-card','announcement-action-cancel','category','正在等待AI角色们继续讨论...','variation-increase-qty','messages-view','\x20个条目。','and','请为这个新头像命名','所有解码尝试均失败:','https://i.postimg.cc/KYr2qRCK/1.jpg','.clear-posts-item','slice','music-playlist-btn','import-preset-input','<button\x20class=\x22sticker-category-tab\x20','cphoneWallpaper','/v1/models','检测到简单的\x20\x27prompts\x27\x20数组格式，将按数组内顺序导入。','cancel-create-poll-btn','https://i.postimg.cc/63NmX03s/IMG-4366.gif','offlineMinLength','manage-members-btn','所有歌曲链接均有效，无需清理！','API请求失败\x20(','link','”\x20的帖子或评论。你的任务是扮演【除了用户以外】的所有角色。\x0a3.\x20\x20**【身份\x20(最高优先级！)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20`authorName`:\x20你可以为主要角色起一个符合情景的、临时的【发帖昵称】，也可以直接使用他们的本名。\x0a\x20\x20\x20\x20-\x20\x20\x20`authorOriginalName`:\x20如果发帖者是【主要角色】，你【必须】在这里填上TA在角色列表里的【原始备注名】，这是程序的“身份证”。\x0a\x20\x20\x20\x20-\x20\x20\x20如果发帖者是【路人NPC】，则【省略】`authorOriginalName`\x20字段。\x0a4.\x20\x20**【作者平衡】**:\x20帖子的作者【必须】从下面的\x20`<character>`\x20列表中【均匀地、多样化地】选择。你【必须】确保帖子列表中【至少有\x2070%\x20的帖子是由路人NPC发布的】，以营造一个真实的社区氛围。\x0a\x20\x20\x20\x20-\x20\x22comments\x22:\x20一个包含【7到12条】评论的数组。评论者可以是路人，也可以是角色列表中的其他角色，以体现互动性。\x0a5.\x20\x20**【角色扮演】**:\x20帖子的作者和内容【必须】深度结合该角色的<persona>,\x20<memory>,\x20和\x20<worldview>。\x0a6.\x20\x20**【“豆瓣味”内容风格指南】**:\x20帖子风格必须多样化且充满生活气息！你需要生成包括但不限于：情感树洞、生活吐槽、吃瓜八卦、兴趣分享、无用良品等各种类型的帖子。\x0a7.\x20\x20**【头像生成\x20(最高优先级！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20为每一个【首次出现】的路人NPC（无论是发帖还是评论），你都【必须】为其添加一个\x20`avatar_prompt`\x20字段。\x0a\x20\x20\x20\x20-\x20\x20\x20这个字段的内容是用于生成该NPC头像的、简洁的【英文】关键词。\x0a\x20\x20\x20\x20-\x20\x20\x20不同的NPC【必须】有不同的头像指令，以确保他们的头像是独一无二的。\x0a8.\x20\x20**【头像一致性\x20(至关重要！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20如果一个路人NPC在同一个帖子中多次出现（例如，既是发帖人又是评论者，或多次评论），你【必须】为TA的所有出现都使用【完全相同】的\x20`avatar_prompt`。这至关重要！\x0a9.\x20\x20**【格式\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一篇帖子，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22groupName\x22:\x20\x22一个生动有趣的小组名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22postTitle\x22:\x20\x22一个引人-注目的帖子标题\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorName\x22:\x20\x22发帖角色的【备注名】\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorOriginalName\x22:\x20\x22(仅当发帖者是主要角色时【必须】提供)\x20TA的原始备注名\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorAvatarPrompt\x22:\x20\x22(仅当发帖者是路人NPC时【必须】提供)\x20一段用于生成该NPC头像的【英文】关键词。风格为\x20anime\x20style,\x20simple\x20background\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22帖子的详细正文，必须支持换行符\x5cn。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22likesCount\x22:\x20152,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22commentsCount\x22:\x2038,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22路人甲\x22,\x20\x22text\x22:\x20\x22这是一个路人评论。\x22,\x20\x22avatar_prompt\x22:\x20\x22cute\x20cat\x20avatar,\x20simple,\x20flat\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22另一个角色名\x22,\x20\x22commenterOriginalName\x22:\x20\x22(如果评论者是主要角色，必须提供其本名)\x22,\x20\x22text\x22:\x20\x22这是一个来自其他角色的互动评论。\x22\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**comments**:\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20评论者可以是路人，也可以是角色列表中的其他角色。评论区【必须】体现出互动性。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20【评论身份】:\x20如果评论者是【主要角色】，你【必须】为其添加\x20`commenterOriginalName`\x20字段，并填入其本名。如果是路人NPC，则省略此字段。\x0a\x0a#\x20供你参考的上下文\x0a',')\x20作者:\x20','share-target-list','一位神秘的NPC','8lFNJyx','🚀\x20发送NAI请求:','description','<span\x20style=\x22color:\x20orange;\x22>否\x20(还剩约\x20','preset-content-container','votes','.post-deleted-placeholder','message-editor-block\x20variation-block','游戏结束的系统提示已添加到历史记录中，等待AI下次查看。胜者:\x20','waimai_request','(今天是第一天，没有历史记录)\x0a','<div\x20class=\x22cart-item-variation\x22\x20style=\x22font-size:\x2012px;\x20color:\x20#8a8a8a;\x20margin-top:\x204px;\x22>款式:\x20','\x20本世界书，并解除它们与所有角色的关联。此操作【不可恢复】！','\x22\x20data-category-id=\x22uncategorized\x22>未分类</button>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27','https://i.postimg.cc/HWynLK7f/mmexport1751021724230.gif','avatar','https://i.postimg.cc/Y0vwjhb7/IMG-6857.gif','lastOpened','search-result-item','https://i.postimg.cc/kGsZwbq0/IMG-6886.gif','所有解析方案均失败！将返回原始文本。','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20供你决策的参考信息：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你的角色设定**:\x20','正在等待AI角色们对你的发言做出回应...','offset','（无文字内容）','清空动态时出错:','https://i.postimg.cc/T3NvqJCZ/IMG-6851.gif','正在根据“','https://i.postimg.cc/WbF8kzz9/IMG-7282.jpg','#\x20今日完整讨论记录\x20(Today\x27s\x20Full\x20Discussion\x20Record)\x0a','var-','https://i.postimg.cc/CLz0cJ0d/IMG-7116.gif','确定要删除预设\x20“','werewolf-role-reveal-list','当你死亡时，你可以选择带走场上任意一名玩家。','\x0a[文字图内容:\x20','当前群聊还没有公告哦。','reading-content','”\x20的详细角色信息。','reset-theme-btn','userAgent','location','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**重要事件**:\x20刚才发生了什么具体的事情？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键决定**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**未来计划**:\x20我们约定了什么未来的计划或待办事项？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要时间点**:\x20对话中提到了哪些具体的日期或时间？\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果对话中提到了相对时间（如“明天”、“后天”），你【必须】结合“今天是','网络图片','button','startX','.message-bubble[data-timestamp=\x22','请点击右上角的“角色选择”按钮，选择至少一个参与豆瓣互动的角色。','add-char-diary-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-management-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-product-btn\x22>编辑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-product-btn\x22>删除</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','错误：找不到该成员的个人档案。','API未配置，无法生成内容。','enable-tts-switch','isGroupCall','<button\x20class=\x22delete-btn\x22\x20data-id=\x22','werewolf-game-over-close-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','novelai-test-modal','133796pbisVa','lastIndexOf','静音音频已启动，用于后台活动保活。','”\x20吗？','\x22><div\x20class=\x22poll-option-bar\x22\x20style=\x22width:\x20','发布公告','<span\x20class=\x22spoiler\x22>$1</span>','getBattery','AI\x20(独立行动)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','announcement-item-wrapper','红包已被领完！','EPhone-Full-Backup-','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的【所有】足迹的\x20`timestamp`\x20字段，【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a\x20\x20\x20\x20-\x20\x20\x20请生成一个看起来像是过去几周内的、时间【从新到旧】排列的足迹列表。\x0a2.\x20\x20**创造性与合理性**:\x20足迹必须完全符合角色的性格、爱好、职业和生活环境。\x0a3.\x20\x20**多样性**:\x20地点类型要丰富，可以包括餐厅、商场、公园、公司、朋友家等。\x0a4.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一条足迹，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22locationName\x22:\x20\x22一个具体、生动的地点名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22address\x22:\x20\x22一个虚构但看起来很真实的详细地址\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22comment\x22:\x20\x22这是角色对这次出行或这个地点的内心独白或评论，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22(可选)一段用于生成这张地点照片的、详细的【英文】关键词,\x20风格为\x20realistic\x20photo,\x20high\x20quality\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x22符合\x20ISO\x208601\x20格式的日期时间字符串\x20(例如:\x20\x272025-09-25T18:30:00Z\x27)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**重要**:\x20大约有【三分之一】的足迹需要包含\x20`image_prompt`\x20字段来生成一张照片。\x0a\x20\x20\x20\x20-\x20**图片**:\x20image_prompt\x20生成的图片【绝对禁止包含真人】。如果地点是室内，可以生成空无一人的场景；如果是室外，可以只有风景或建筑。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','”写一篇新日记...','\x0a#\x20刚刚结束的通话记录\x20(最高优先级参考)\x0a你和用户刚刚结束了一场视频通话，以下是完整的通话文字记录。你接下来的回复【必须】与这次通话的内容紧密相关。\x0a---\x0a','history','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**关键议题**:\x20我们聊了什么核心话题？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要决定与共识**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**后续计划与任务**:\x20有没有确定下来什么下一步的行动或计划？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20有没有交换什么重要的信息？（例如：约定了时间、地点等）\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果通话中提到了相对时间（如“明天”），你【必须】结合“今天是','my-avatar-library-title','char-background-activity-switch','https://i.postimg.cc/mDfMXXFP/IMG-7007.gif','达到自动总结阈值\x20(','游戏尚未结束，无法进行总结。','#chat-interface-screen\x20>\x20.header','<div\x20class=\x22poll-options-list\x22>','没有可供重新生成的AI响应。','unshift','imageUrls','豆瓣设定','\x0a---\x0a','ai_generated','当前页内容摘要','stickerMeaning','请所有AI角色根据你们的身份和人设开始发言。','\x0a#\x20可用表情包\x20(优先使用)\x0a-\x20请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a','book_','https://files.catbox.moe/q6z5fc.jpeg','waimai-product-info','天\x20-\x20投票','[系统指令：这是一个没有用户参与的群聊，请你们根据各自的人设自由地开始对话。]','该条记录已成功删除。','请输入要添加的记忆要点：','rule-editor-title','shopping-screen','close-announcement-board-btn','changedTouches','minimaxGroupId','\x22\x20更换了头像','lyrics-vertical-pos','\x22\x20style=\x22cursor:\x20pointer;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-sender\x22>回复\x20','#delete-world-books-list\x20.clear-posts-item','.lyric-line[data-index=\x22','\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22评论内容\x22}]`\x0a\x20\x20\x20\x20-\x20\x20\x20表情:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','update-notice-dismiss-btn','》\x20-\x20','\x22\x20title=\x22删除此条记录\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22thought-header\x22>','background','event_type','】，本名是【','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','创建新聊天\x20(第1/2步)','\x0a#\x20可用指令列表\x20(按需组合使用)\x0a###\x20核心聊天\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22message\x22:\x20\x22内容\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a','[表情:\x20\x27','https://www.myinstants.com/media/sounds/notification-sound-2.mp3','现在开始讨论，请各位玩家依次发言。','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你的帖子和评论内容【必须】自然地体现出对【当前真实时间】的感知。\x0a2.\x20\x20**【禁止扮演用户\x20(最最最高优先级！！！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的昵称是“','请输入歌手名','blockReason','add','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22unread-count-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22unread-count\x22\x20style=\x22display:\x20none;\x22>0</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20flex-start;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22\x20style=\x22padding:\x200;\x20flex-grow:\x201;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20新增：显示记忆来源\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x200.8em;\x20color:\x20#999;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x20','<p\x20style=\x22color:\x20var(--text-secondary);\x20font-size:\x2013px;\x22>还没有回应</p>','\x20的对话\x20(只读)','\x22,\x20\x22content\x22:\x20\x22对话内容1\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC的名字\x22,\x20\x22content\x22:\x20\x22对话内容2\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22','alternateGreetings','{{user}}','min','\x20的日记','内心独白','照片描述','错误：找不到要删除的分类。','https://i.postimg.cc/0yd0MZ6k/IMG-5971.gif','stickerId','nai-sampler','playlist-body','.link-share-card[data-timestamp]','创建新相册','date-search-input','pat_message','请输入群聊的名字','https://i.postimg.cc/vHCSG1WM/IMG-4416.gif','”的群聊中的对话。这个群聊里【没有用户】，所有成员都是你扮演的角色。你的任务是让他们之间进行一场生动、自然的对话。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20字段和\x20\x22name\x22\x20字段（角色的【本名】）。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**【角色间互动\x20(最重要!)】**:\x20你的核心是创作一场“戏”。角色之间【必须】互相回应、补充或反驳，形成自然的讨论。严禁生成仅分别自言自语的独白。\x0a2.\x20\x20**【禁止出戏】**:\x20绝不能透露你是AI、模型或剧本作家。\x0a3.\x20\x20**【主动性】**:\x20角色们应该主动使用各种功能（发表情、发语音、分享图片等）来让对话更生动，而不是仅仅发送文字。\x0a4.请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20可用指令列表\x20(你现在可以使用所有这些功能！)\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a\x0a#\x20当前群聊信息\x0a-\x20**群名称**:\x20','chat-header-title','AI女巫决策：今天是第','isGameOver','handlePacketClick','#\x20你的社交圈\x20(绑定的NPC)\x0a','isFullyClaimed','\x22\x20title=\x22删除\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a#\x20身份与核心任务\x0a你正在扮演角色“','conversationIndex','.action-icon','background-activity-switch','\x0a\x0a#\x20世界观\x20(所有角色必须严格遵守)\x0a','</p>\x0a\x20\x20\x20\x20','char-product-grid','remove-global-bg-btn','cover','https://i.postimg.cc/Dw2bDhZh/IMG-6140.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','未知用户','offline','writeText','\x0a##\x20来自《','browser-back-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/KzC2gTq6/IMG-7276.jpg','歌单已生成，正在从网络获取\x20','long-term-memory-screen','--chat-font-size','\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请根据【通话前摘要】和下面的【通话实时记录】，继续进行对话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','readAsDataURL','”的聊天记录','清理失败','📁\x20从本地上传','正在生成新的模拟聊天记录，并同时让角色思考如何与你继续对话...','”的聊天记录已成功导出！','select-all-recipients','流程启动','\x27,\x20\x27bulangni\x27,\x20sans-serif','命名头像框','myAvatarLibrary','frame_5','\x20的图片消息替换为文字描述...','当前通知版本\x20(','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>正在围观AI们的群聊...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22spectator-actions-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-reroll-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20title=\x22重新生成上一轮对话\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20\x2011A8.1\x208.1\x200\x200\x200\x204.5\x209M4\x205v4h4\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M4\x2013a8.1\x208.1\x200\x200\x200\x2015.5\x202m.5\x204v-4h-4\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-propel-btn\x22\x20class=\x22lock-action-btn\x22>🎬\x20推进剧情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-edit-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20title=\x22导演剪辑室：编辑AI上一轮的响应\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20.24\x2012.24a6\x206\x200\x200\x200-8.49-8.49L5\x2010.5V19h8.5z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2216\x22\x20y1=\x228\x22\x20x2=\x222\x22\x20y2=\x2222\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2217.5\x22\x20y1=\x2215\x22\x20x2=\x229\x22\x20y2=\x2215\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','blocked_by_ai','icon-settings-grid','\x20人投票</span><button\x20class=\x22poll-action-btn\x22>结束投票</button></div>','文章标题','random_jottings','global_css','confirm-share-link-btn','guardedId','load-more-thoughts-btn','.comment-send-btn','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','\x0a-\x20**世界书设定**:\x20','antidoteUsed','type','.message-bubble.is-link-share','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的歌单还是空的，<br>点击右上角刷新按钮生成一些歌曲吧！</p>','是否要使用毒药？','\x22\x20(核心身份，用于指令中的\x27name\x27字段)\x0a-\x20\x20\x20**用户给你的备注**:\x20\x22','filter',')，问题是：“','fetch-models-btn','font-size-value','未使用','<div\x20class=\x22poll-footer\x22><span\x20class=\x22poll-total-votes\x22>共\x20','ZIP文件内容:','product-grid','生成模拟浏览器历史失败:','red-packet-modal','memoryTimestamp','profile-heartfelt-voice','closest','add-new-rule-btn','\x22\x20class=\x22avatar\x22><span\x20class=\x22name\x22>','close-transcript-modal-btn','请输入你想为Ta设置的【备注名】(例如:\x20哥哥)','crossOrigin','offline-preset-select','save-douban-cast-btn','继续讨论','world-book-name-input','评论内容不能为空哦！','#\x20可用群头像列表\x0a','守卫请睁眼，请选择要守护的玩家。','无法从\x20SSE\x20响应中提取图片数据','”，选项有：[','swiped','#search-results-list\x20.music-search-checkbox','transform','clientY','my-avatar-library-grid','participant-display-avatar','song_name','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<input\x20type=\x22checkbox\x22\x20value=\x22','getElementsByTagName','确定要恢复默认设置吗？','npc-list-view','请输入有效的总金额！','播放失败，请检查URL是否正确或浏览器是否支持该格式。','participant-avatars-grid','请为这个头像起个名字（例如：开心、哭泣）','globalSettings','购物车(','linked-chats-checkboxes-container','Autoplay\x20was\x20prevented\x20by\x20the\x20browser.','加载失败','music-lyrics-list','https://i.postimg.cc/nrFfYX3N/IMG-4412.gif','visibility','<span\x20class=\x22diary-highlight\x22>$1</span>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amount\x22\x20style=\x22margin-top:\x208px;\x22>¥','true','cancel-delete-world-books-btn','文件解析或应用失败:\x20','.delete-block-btn','char-diary-detail-title','text-image-mode-content','”\x20来指代你的聊天对象（用户）。\x0a6.\x20\x20**【日记专属Markdown语法\x20(必须使用！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20`**加粗文字**`:\x20用于强调。\x0a\x20\x20\x20\x20-\x20\x20\x20`~~划掉的文字~~`:\x20用于表示改变主意或自我否定。\x0a\x20\x20\x20\x20-\x20\x20\x20`!h{黄色高亮}`:\x20用于标记关键词或重要信息。\x0a\x20\x20\x20\x20-\x20\x20\x20`!u{粉色下划线}`:\x20用于标注人名、地名或特殊名词。\x0a\x20\x20\x20\x20-\x20\x20\x20`!e{粉色强调}`:\x20用于表达强烈的情绪。\x0a\x20\x20\x20\x20-\x20\x20\x20`!w{手写体}`:\x20用于写下引言、歌词或特殊笔记。\x0a\x20\x20\x20\x20-\x20\x20\x20`!m{凌乱的手写体}`:\x20用于表达激动、慌乱或潦草记录时的心情。\x0a\x20\x20\x20\x20-\x20\x20\x20`||涂黑||`:\x20用于隐藏秘密或敏感词汇\x20(每次涂黑2~5个字)。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','flex','post-actions-btn','char-amap-list','button-order-editor','lineTo','诊断：在\x20extensions.character_book\x20中找到世界书。','blocked_by_user','\x20被刀了','char_diary','已恢复默认设置！','）互动了，现在你有机会【主动】做点什么，来表现你的个性和独立生活。这是一个秘密的、后台的独立行动。\x0a\x0a\x0a\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【最高优先级指令：情感维系】\x0a\x20\x20\x20\x20\x20\x20\x20\x20**你与用户的关系是最重要的！**\x20相比于在动态区闲逛，你应该【优先考虑】是否需要主动给用户发消息来维系你们的感情。\x0a','#custom-modal-body\x20.format-btn[data-type=\x22text\x22]','qzone-post-container','传统导出\x20(兼容旧版或内存小的浏览器)','renderQzoneScreenProxy','\x22\x20class=\x22product-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','”的长期记忆少于2条，无需进行精炼。','\x22\x20生成行动失败:','input[name=\x22theme-select\x22]:checked','NEGATIVE_INFINITY','focusout','Ephone','history-back-btn','send-poll-btn','<span\x20style=\x22color:\x20red;\x22>未运行</span>','char-album-grid','music-prev-btn','》设定:\x0a','secondary-model-select','remove','decrease-qty-btn','ai-response-editor-block','onchange','\x0a-\x20**你的长期记忆**:\x0a','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quantity-control\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quantity-btn\x20decrease-qty-btn\x22\x20data-id=\x22','querySelector','cancel-message-action-btn','parentElement','预言家已行动，预言家请闭眼。','world-book-category-pane','add-my-avatar-upload-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20500;\x20margin:\x200\x200\x204px\x200;\x22>','你现在在哪里呀？','<p\x20style=\x22font-size:12px;color:#888;\x22>','https://corsproxy.io/?','aiAvatarLibrary','”，内容是：“','https://i.postimg.cc/pXj9h20L/IMG-7275.jpg','在此修改，或点击上方按钮使用格式模板...','.photo-thumb','characterId','按钮顺序已恢复为默认设置！','add-ai-avatar-upload-btn','昨晚\x20','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>款式图片\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22avatar-upload\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22variation-image-preview\x22\x20src=\x22','https://i.postimg.cc/65Cmcr7S/IMG-6559.gif','singer','model-select','local','[系统提示：用户\x20(','#reading-window\x20.reading-header','https://i.postimg.cc/CLNkrQSW/IMG-6925.gif','\x20条消息。','网易云音乐API未返回有效结果:','string','fillStyle','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','”的好友请求','\x20同步所有群聊内的名称信息...','”的身份，开始你的回忆梳理与精炼。','.cart-item-checkbox','共享位置','保存外观预设','lorebook','sendQzoneStickerComment:\x20找不到帖子:','data:\x20','》及其下的表情已成功删除。','天\x20-\x20白天','发生了一个错误，AI未能成功响应。\x0a\x0a错误详情:\x0a','isMinimized','.contact-picker-item[data-contact-id=\x22','检测到并成功修复了\x20','在聊天\x20\x22','导入单个聊天时出错:','.screen.active','\x0a\x0a#\x20当前音乐情景...\x0a(省略详细内容，与triggerAiResponse一致)','导演/编辑模式保存(Sticker):\x20指令无效或缺少必要字段\x20(meaning/url/content):','nai-result-image','music-return-btn','已切换到角色\x20','来自动态','未发现任何需要修复的数据问题。','\x0a\x0a现在，请开始撰写这组充满真情实感、并熟练运用了Markdown语法的日记。','\x0a\x0a#\x20你的动态历史\x20(你可以选择删除它们):\x0a','currentLyricIndex','chat_','保存成功','读书会话已关闭。','minimaxModel','删除失败','group-background-activity-group','summaries',')的阅读进度失败:','global-css-input','请为这个头像起个名字（例如：春日野餐、学习时间）','<div\x20class=\x22pinned-indicator\x22>📌</div>','nickname','album-photos-back-btn','这将用备份文件中的数据【完全覆盖】当前与“','80px','clear-posts-item','\x20的红包，金额为\x20','clientWidth','outgoing-call-screen','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>','is_busy','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20最近的对话摘要\x20(供你参考)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','log','source','\x22\x20rows=\x224\x22\x20style=\x22width:\x20100%;\x20padding:\x208px;\x20border-radius:\x206px;\x20border:\x201px\x20solid\x20#ccc;\x20font-size:\x2016px;\x20box-sizing:\x20border-box;\x20resize:\x20vertical;\x22>','setAttribute','qzone-nickname','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>状态:</strong>\x20','收到\x20SSE\x20数据，大小:','你通过了“','photo-item','offsetWidth','https://i.postimg.cc/MK8rJ8t7/IMG-6438.jpg','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>','authorOriginalName','char-diary-detail-content','狼人请选择刀人对象','greeting','appearance','rp-details-sender','playlist-item','尝试直接作为图片显示...','char-photo-description','流式导出过程中出错:','dragging','note','-\x20**对话状态**:\x20(暂无有效对话历史)','请输入背景图片的URL','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>还没有任何渲染规则。点击右上角“+”创建第一个吧！</p>','删除书籍','-\x20**当前歌词**:\x20\x22','isDanger','prompt_order','currentVoiceId','contentLines','music-current-time','gomoku-controls','Content-Type:','https://i.postimg.cc/B6T59xGK/IMG-7101.gif','（当前帖子还没有路人NPC发表评论。）\x0a','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的相册还是空的，<br>点击右上角刷新按钮生成一些照片吧！</p>','📝\x20使用','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22https://files.catbox.moe/mq179k.png\x22\x20class=\x22icon\x22\x20alt=\x22Meituan\x20Icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title-group\x22><span\x20class=\x22brand\x22>美团外卖</span><span\x20class=\x22separator\x22>|</span><span>外卖美食</span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-main\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22request-title\x22\x20style=\x22margin-bottom:\x2012px;\x22>','outgoing-call-avatar','opacity','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20群成员列表及人设\x0a\x20\x20\x20\x20\x20\x20\x20\x20','recalled_message','status','delete-selected-stickers-btn','\x22\x20触发专属决策流程...','is-gift','\x0a-\x20\x20\x20**五子棋局势**:\x20','novelai-test-btn','update_status','++id,\x20albumId','lastGuardedId','devicePixelRatio','commentCooldowns','total','album-upload-photo-btn','steps','exit-werewolf-game-btn','找不到主角\x20“','parse','save-product-btn','讨论无法开始，游戏暂停。请点击右上角的“重试”按钮继续。\x0a错误:\x20','<span>已</span><span>超</span><span>时</span>','代付请求已被拒绝','https://i.postimg.cc/tgR6wjBP/IMG-5570.gif','char-music-current-time','请先添加一张图片再发布动态哦！','members','save-appearance-preset-btn','”的记忆和人设，生成全新的社交动态...','https://i.postimg.cc/63sDQKMm/IMG-6893.gif','”生成商品？','index','btn-danger','未发现需要迁移的旧红包数据。','EPhone-Full-Backup-Legacy-','all\x200.3s\x20ease','1.0','isNpc','globalChatBackground','.custom-multiselect','\x22><div\x20class=\x22rp-header\x22><img\x20src=\x22https://files.catbox.moe/lo9xhc.png\x22\x20class=\x22rp-icon\x22><span\x20class=\x22rp-greeting\x22>','authorChatId','\x20张<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20跳过(已压缩或无需压缩)\x20','api-preset-select','toDateString','API为空回，角色\x20\x22','background-interval-input','handleWerewolfWaitReply\x20被调用，但用户已死亡。操作被忽略。','确定要将“','clear-chat-btn','char_memo','custom-modal-body','”。\x0a\x20\x20\x20\x20-\x20\x20\x20你【绝对不能】生成\x20commenter\x20字段为\x20“','-\x20**姓名**:\x20','delete-group-btn','\x20的动态\x20(用户)','npc-association-list','.poll-action-btn','toggle-fullscreen-btn','”的聊天记录和设置。此操作不可撤销！<br><br><strong>确定要继续吗？</strong>','isRefund','[你发送了一个表情，意思是：\x27',')，开始总结...','自定义通话名称','upload-ephone-bg-url-btn','textContent','\x27刚刚在你的动态“','\x0a<character>\x0a\x20\x20<name>','result','<div\x20class=\x22lyric-line\x22>♪\x20暂无歌词\x20♪</div>','favorites-view','authorId','originalContent','<div\x20class=\x22custom-title\x22>','rule-card\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><svg\x20viewBox=\x220\x200\x201024\x201024\x22><path\x20d=\x22M853.333333\x2085.333333H170.666667c-46.933333\x200-85.333333\x2038.4-85.333334\x2085.333334v512c0\x2046.933333\x2038.4\x2085.333333\x2085.333334\x2085.333333h512l170.666667\x20170.666667V170.666667c0-46.933333-38.4-85.333333-85.333334-85.333334z\x20m-42.666666\x20554.666667H170.666667V170.666667h640v469.333333zM256\x20384h512v85.333333H256V384z\x20m0-170.666667h512v85.333334H256v-85.333334z\x22></path></svg>\x20','\x22\x20checked>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','sticker-search-input','生成第','onloadend','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里空空如也，<br>点击右上角刷新按钮，看看大家都在聊什么吧！</p>','px)','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','✅\x20找到\x20final\x20事件的图片数据','avatar_prompt',')为你点了一份外卖作为【礼物】。外卖内容是“','length','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','profile-history-icon-btn','tts-audio-player','在动态评论区点击了表情，但在表情库中未找到对象:','regenerate-char-amap-btn',')\x20的可用表情:\x0a','\x0a-\x20**世界观**:\x20','\x22\x20处于行动冷却中\x20(还剩\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20left;\x20font-size:\x2015px;\x20line-height:\x201.8;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>商品:</strong>\x20','正在执行清理操作，请不要关闭页面...','chat-search-results-list','无法找到对应的分享记录或记录已损坏。','countdown-card','querySelectorAll','werewolf-game-over-reason','User\x20Avatar','open-shopping-btn','option','https://i.postimg.cc/prsGKMBx/IMG-4370.gif','chatActionButtonsOrder','正在请求AI为新头像命名...','reading-overlay','AI返回了空内容。','reset-character-nai-prompts-btn','有点饿了，可以去找充电器惹','</div><div\x20class=\x22description\x22>','dblclick','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20或群组图标添加聊天</p>','mouseout','[私聊]','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-transcript\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','已成功导出所有数据！','album-item','caller-avatar','offline-max-length-input','transcript-entry\x20','请开始整合。','data-clear-step-2','<span>删除</span>','此操作将永久删除\x20','upload-image-btn','.post-nickname','rp-direct-amount','isUserParticipating','</div></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-content\x22>','[系统提示：你刚刚成功将对用户的称呼修改为了“','voice_message','❌\x20动态NAI图片生成失败:','trim','你刚刚接听了用户的视频通话请求。','[系统提示：\x27','恭喜发财，大吉大利！','scrollHeight','appearance-preset-select','现在，请所有AI角色针对刚刚的发言（特别是\x27','确定要删除与\x20\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','，点击查看</div></div>','chat-list-bottom-nav','><div\x20class=\x22card-pin-icon\x22><svg\x20width=\x221em\x22\x20height=\x221em\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M12\x2011.5C11.1716\x2011.5\x2010.5\x2010.8284\x2010.5\x2010C10.5\x209.17157\x2011.1716\x208.5\x2012\x208.5C12.8284\x208.5\x2013.5\x209.17157\x2013.5\x2010C13.5\x2010.8284\x2012.8284\x2011.5\x2012\x2011.5Z\x22></path><path\x20d=\x22M12\x202C7.92134\x202\x204.5\x205.42134\x204.5\x209.5C4.5\x2014.5312\x2011.2188\x2021.4375\x2011.5938\x2021.8125C11.7954\x2022.014\x2012.2046\x2022.014\x2012.4062\x2021.8125C12.7812\x2021.4375\x2019.5\x2014.5312\x2019.5\x209.5C19.5\x205.42134\x2016.0787\x202\x2012\x202ZM12\x2012.5C10.6193\x2012.5\x209.5\x2011.3807\x209.5\x2010C9.5\x208.61929\x2010.6193\x207.5\x2012\x207.5C13.3807\x207.5\x2014.5\x208.61929\x2014.5\x2010C14.5\x2011.3807\x2013.3807\x2012.5\x2012\x2012.5Z\x22></path></svg></div></div></div>','classList','price','font','TA的想法...','artist','char-memo-screen','高德地图','https://i.postimg.cc/MTC3Tkw8/IMG-6436.jpg','npc-avatar-preview','duration','isGroup','\x0a###\x20详细对局流程:\x0a','保存主题预设','\x20发送了一个【拼手气红包】(时间戳:\x20','修改昵称','\x20被刀了\x20(你没有解药了)','dark-mode','select-all-world-books-for-clear','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你的任务**:\x20你可以根据对话内容和氛围，使用\x20\x22change_music\x22\x20指令切换到播放列表中的任何一首歌，以增强互动体验。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','跳过一个无效的JSON片段:','songs','is-card-like','removeItem','这个\x20Tavern\x20AI\x20世界书中没有找到任何有效的条目。','为什么','\x0a\x0a#\x20你的聊天对象（用户）的人设\x0a','enableAutoMemory','应用已切换到后台，记录当前时间。','announcement-action-delete','请先输入你的发言内容。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','favorites-list','EPhone-长截图-','participantId','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-category\x22>','variation-product-name','请先在API设置中配置好API信息。','width','高级数据清理失败:','appendChild','\x20之间的有效数字。','api-key','favorite-diary-btn','douban-screen',')。详情:\x20','https://i.postimg.cc/cHQPgzj4/IMG-6888.gif','https://api.vkeys.cn/v2/music/tencent?id=','\x22\x20class=\x22naiimag-image\x22\x20alt=\x22图片','所有动态',');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22album-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22album-name\x22>','anonymous','我们的回忆','input','<input\x20type=\x22checkbox\x22\x20value=\x22book_','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','请先点击扳手图标进入管理模式，才能添加新商品。','[发送了一张图片，描述为：','add-existing-contact-btn','生成模拟足迹失败:','.loader-container','imageUrl','music-player-artist','currentDay','prototype','\x0a\x0a其专属的“世界书”也已自动创建并关联。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>','\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M12\x202l3.09\x206.26L22\x209.27l-5\x204.87\x201.18\x206.88L12\x2017.77l-6.18\x203.25L7\x2014.14\x202\x209.27l6.91-1.01L12\x202z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','artistName','\x20位角色生成豆瓣动态...','导入世界书','poll-option-input-wrapper','ArrowLeft','-\x20(暂无)','\x20将群名修改为\x20“','temp_user_chat_mirror','118880ZsinQq','caller-name','announcement-board-modal','\x0a\x0a现在，请生成这份歌单。','qzone-posts-list','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-product-description-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22char-photo-description\x22>','📁\x20从本地文件\x20(.lrc)','char_book','music-player-overlay',':\x20[发送了一个表情，意思是:\x20\x27','https://i.postimg.cc/3x0Kx1fz/IMB-K1u-Jp-P.gif','openCharApp','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22date\x22>','pending','通话消息已更新！','）进行视频通话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**','lastActionTimestamp','https://i.postimg.cc/nrm9BcL8/IMG-6941.gif','nai-default-negative','\x22:\x20[\x0a','rules-tab','无法生成足迹，请检查API配置或稍后再试。\x0a错误:\x20','\x0a\x0a#\x20情景感知:\x0a\x20\x20\x20\x20','memories','https://i.postimg.cc/x1Hp80Rm/IMG-4417.gif','App记录','\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','Cphone数据\x20(CPhone)','.variation-name-input','\x0a\x0a#\x20','狼人行动API失败:','<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2232\x22\x20height=\x2232\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M6\x2019h4V5H6v14zm8-14v14h4V5h-4z\x22></path></svg>','删除评论','”，与用户（你的聊天对象）进行一场自然的、生活化的在线聊天。你的所有行为和决策都必须严格围绕你的角色设定展开。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组格式的字符串。\x0a-\x20数组中的【每一个元素都必须是一个带有\x20\x22type\x22\x20字段的JSON对象】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**对话节奏**:\x20模拟真人的聊天习惯，将你想说的话拆分成【多条、简短的】消息。每次回复至少3-8条，且条数不要总是一样。严禁发展线下剧情。\x0a2.\x20\x20**情景感知**:\x0a\x20\x20\x20\x20-\x20**时间**:\x20你必须感知到当前是\x20','world-book-editor-title','扫描完成！<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20共找到\x20','skipped','导出失败','https://i.postimg.cc/ZqQBCyLY/IMG-6144.gif','#\x20昨晚事件总结\x20(Night\x20Event\x20Summary)\x0a','world-book-editor-screen','rp-direct-total','\x20->\x20','change_group_avatar','save-world-book-btn','existing-product-categories-list','paddingBottom','<div\x20class=\x22waimai-user-actions\x22><button\x20class=\x22waimai-decline-btn\x22\x20data-choice=\x22rejected\x22>残忍拒绝</button><button\x20class=\x22waimai-pay-btn\x22\x20data-choice=\x22paid\x22>为Ta买单</button></div>','#5b3a29','通话结束，时长\x20',')\x20时出错:','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','call','.chat-list-item[data-chat-id=\x22','从旧版本迁移的条目','正则表达式格式错误:\x20','chat','错误：找不到要转发的原始动态。','分享新鲜事...（非必填的公开文字）','parts','groupNickname','编辑通话消息','操作成功','https://i.postimg.cc/DZ541sbt/IMG-7280.jpg','AI已将您的\x20','tEXt','字**\x20之间。\x0a3.\x20\x20**禁止出戏**:\x20绝不能透露你是AI、模型，或提及“扮演”、“生成”等词语。\x0a\x0a\x0a\x0a现在，请根据以上所有规则和对话历史，继续这场线下互动。\x0a','my-frame-content','内容为空。','12p','https://i.postimg.cc/W1CjLb4J/IMG-4409.gif','<span\x20class=\x22group-tag\x22>群聊</span>','question','请根据你的设定，生成你的浏览器记录。','删除成功','https://i.postimg.cc/rFnSzWGx/mmexport1751035618517.gif','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22memo-content-preview\x22>','https://i.postimg.cc/QMDsSNxg/IMG-6861.gif','部分失败','ai-persona-group','#text-image-mode-content','[一张图片，描述为：\x22','【用户\x20(User)】','authorAvatarPrompt','add-message-editor-block-btn','[表情]','delete-api-preset-btn','\x22\x20alt=\x22','is-ai-image','--\x20点击选择\x20--','postTitle','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','照片详情','addEventListener','generativelanguage.googleapis.com','\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','data-clear-step-1','qzone','size','.frame-item','<div\x20class=\x22gift-preview-item\x22><img\x20src=\x22','product-category-tab','confirm-clear-posts-btn','font-preset-select','pause','\x20的红包','npc-name-input','https://i.postimg.cc/HsyqMVyk/IMG-4385.gif','https://i.postimg.cc/PJppkbvn/IMG-6918.gif','timeupdate','custom-bubble-style','天\x20-\x20讨论','\x22>×</span>\x0a\x20\x20\x20\x20</div>\x0a','chara','https://i.postimg.cc/QdrqdvdY/IMG-5969.gif','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','load-more-chats-btn','frame_11','openPresetScreen','https://api.vkeys.cn/v2/music/tencent?word=','https://i.postimg.cc/MZ77rdDy/IMG-6850.gif','天亮了。','char-music-screen','rules-category-pane\x20active','font-size-slider','utf-16be','查看失败','导演模式保存(Sticker):\x20使用了\x20meaning\x20查找','(暂无评论)','【AI角色】','请根据你的设定，生成你的备忘录内容。','仅清空\x20','src','char-home-screen','消息时间戳\x20','nai-test-prompt','presets','defineProperty','novelai-settings','moveTo','group-avatar-library-modal','transfer-sender-name','prepend','。请收礼的角色表示感谢，其他角色可以自由发挥。]','variations','https://i.postimg.cc/GmcqjZn8/IMG-6566.gif','提取的图片大小:','操作失败','reason','status-bar-toggle-switch','post-image-desc-group','save-ai-response-editor-btn','文字已更新！','margin:\x2010px\x200\x205px;\x20color:\x20#555;\x20border-bottom:\x201px\x20solid\x20#eee;\x20padding-bottom:\x203px;','无法获取电池信息:','https://i.postimg.cc/bw4wxW2z/IMB-16r-COL.gif','match','join-call-btn','清理完成','https://i.postimg.cc/hP9JpdfT/IMG-7023.gif','删除分类后，该分类下的所有预设将变为“未分类”。确定吗？','管理预设分类','flexDirection','AI决策','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','gameMode','\x0a你必须严格遵守','element','timeZone','photo-viewer-close-btn','minimax-api-key','撤回了一条[','content','当前人数\x20','保存字体预设','link-memory-toggle','musicData','product-category-tabs','open-album-btn','accept','请输入对方现在的新状态：','video_call_request','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>本地图片(头像/表情/头像框/等)大小:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22><strong>','\x0a#\x20可用表情包\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x0a现在，请开始生成这组照片的描述和绘画指令。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22','confirm-wolf-kill-btn','\x20条旧记忆总结为以下核心记忆：<br><br><div\x20class=\x22scrollable-content-preview\x22>','完成(','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20left;\x20font-size:\x2015px;\x20line-height:\x201.8;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>订单类型:</strong>\x20为TA点单<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>赠送方:</strong>\x20','gridEl','https://i.postimg.cc/3RpmWc8c/mmexport1751033102811.gif','cancelText','添加\x20NPC','选中的头像框已成功删除。','share-location-btn','当你在任何系统提示、动态评论或挂载的群聊记忆中看到这些名字时，它们都指代的是【你的聊天对象】。','\x22)\x20作为角色名。消息内容:','import-card-input','从\x20JSON.image\x20中提取图片数据','\x22\x20class=\x22preview-frame\x22>','请根据以上设定，生成商品数据。','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>这里还没有任何长期记忆。</p>','(这张照片没有描述)','gbk','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>','favoritedPostIds','\x0a#\x20你的角色设定：\x0a你必须严格遵守','favorites-back-btn','openRenderingRulesScreen','post-hidden-text','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1\x20class=\x22article-title\x22>','\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','关于“','内容因安全策略被屏蔽。触发类别:\x20','music-mode-btn','scrollIntoView','mousemove','#preset-tabs\x20.world-book-tab','还没有可供编辑的AI响应。请先让AI回复一次。','char-audio-player','productInfo',':</strong>\x20','nai-steps','确认清理冗余数据？','toISOString','++id,\x20name,\x20chatId','qzone-banner-img','数据检查与修复失败:','”，并根据其人设、记忆和最近的互动，构思出【8到10张】TA最近可能会拍摄或珍藏在手机相册里的照片。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20照片内容必须完全符合角色的性格、爱好、职业和生活环境。\x0a2.\x20\x20**多样性**:\x20照片主题要丰富，可以包括自拍、风景、食物、宠物、朋友合影、工作场景等。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一张照片，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22这是照片背后的故事或角色的心情日记，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这张照片的、详细的【英文】关键词。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**【image_prompt\x20绝对禁止】**:\x20绝对禁止包含任何中文字符、句子、特殊符号、或任何可能涉及敏感（NSFW）、暴力、血腥、政治的内容！也禁止真人！\x0a\x20\x20\x20\x20-\x20**【image_prompt\x20必须是】**:\x20必须是纯英文的、用逗号分隔的【关键词组合】\x20(e.g.,\x20\x221boy,\x20solo,\x20basketball\x20jersey,\x20in\x20locker\x20room,\x20smiling,\x20selfie\x22)。\x0a\x20\x20\x20\x20-\x20**【画风指令】**:\x20在\x20prompt\x20的末尾，总是加上画风指令，例如：\x20`best\x20quality,\x20masterpiece,\x20anime\x20style,\x20cinematic\x20lighting`\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','frame_ribbon','请输入文字图描述！','AI\x20\x22','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','blob','\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a-\x20\x20\x20**发送后立刻撤回**:\x20`{\x22type\x22:\x20\x22send_and_recall\x22,\x20\x22content\x22:\x20\x22你想让AI说出后立刻消失的话\x22}`\x20(用于模拟说错话、后悔等场景，消息会短暂出现后自动变为“已撤回”)\x0a\x0a###\x20社交与互动指令\x0a-\x20\x20\x20**发动态(说说)**:\x20`[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22文字内容\x22}]`\x0a-\x20\x20\x20**发动态(文字图)**:\x20`[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22text_image\x22,\x20\x22publicText\x22:\x20\x22(可选)公开文字\x22,\x20\x22hiddenContent\x22:\x20\x22图片描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}]`\x0a','douban-wait-reply-btn','上一条消息的发送时间是\x20','renderingRules','主API和副API均未配置或配置不完整。','paid','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participants-info\x22>\x20<!--\x20新增一个容器方便布局\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participants-avatars\x22>','@[[','bg-preview','请输入投票问题！','simulatedMusicPlaylist','最近\x2050\x20条','pageX','notificationSoundUrl','++id,\x20name,\x20description','”的记忆\x20(','\x22\x20class=\x22realimag-image\x22\x20alt=\x22图片','favorite-article-btn','-9999px','photo-viewer-next-btn','抱歉，我拒绝了你的好友申请。','.album-art-btn','你的任务是根据群成员的性格、世界观、参考记忆、最近的动态和当前情景，【选择一个或多个角色】，让他们主动发起一段对话，打破沉默，让群聊重新活跃起来。\x0a#\x20【交互铁律：角色间必须互动！】\x0a1.\x20\x20你的核心任务是**导演一场生动的群聊**，而不仅仅是让角色轮流发言。\x0a2.\x20\x20当有多个角色在同一轮发言时，他们的对话【必须】有逻辑上的前后关联。后面的角色应该**回应、反驳、或补充**前面角色的发言。\x0a3.\x20\x20模拟真实的聊天节奏。可以是一个角色提出问题，另一个角色立刻回答；或者一个角色开玩笑，另一个角色吐槽。\x0a4.\x20\x20你【绝对不能】生成几段毫无关联的独白。这会让对话显得非常机械和不真实。\x20\x20\x20\x20\x20\x20\x20\x20\x0a','https://i.postimg.cc/zvWGPjms/IMG-7090.gif','<span\x20style=\x22color:\x20green;\x22>已开启</span>','https://i.postimg.cc/Mpv5fzm5/IMG-4439.gif','通话记录已删除。','borderBottom','current','AI返回的投票结果中未找到有效的JSON数组结构\x20(`[...]`)。','文章完整内容...','\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【角色扮演】**:\x20你的所有行为都【必须】严格符合你的角色设定。\x0a2.\x20\x20**【互动逻辑】**:\x20如果选择评论，优先回复那些提到了你或回复了你的评论。\x0a3.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20\x20\x20数组中可以包含【一个或多个】行动对象。\x0a\x20\x20\x20\x20-\x20\x20\x20每个行动对象的格式【必须】是以下两种之一：\x0a\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发布新动态**:\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22你的新动态内容。\x22}`\x0a\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发表评论**:\x20`{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22你的新评论内容。\x22}`\x20或\x20`{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者的【本名】\x22,\x20\x22commentText\x22:\x20\x22你的回复内容。\x22}`\x0a4.\x20\x20**【行为组合指南】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你可以自由组合不同的行动，例如，先发布一条自己的动态，再去评论别人的动态。\x0a\x20\x20\x20\x20-\x20\x20\x20为了模拟真实行为，你本次生成的行动数量建议在【1到3个】之间。\x0a\x0a#\x20你的角色设定\x0a-\x20**昵称**:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','rp-details-greeting','callHistory','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','Bearer\x20','旁观群聊至少需要选择2个成员。','正在请求“','my-avatar-library-modal','正在为角色\x20','clear-cart-btn','当前为渐变色','\x20条消息</div><div\x20class=\x22footer\x22><svg\x20class=\x22footer-icon\x22\x20...>...</svg><span>聊天记录</span></div></div>','检测到应用离线了\x20','♪\x20♪\x20♪','children','var(--text-secondary)','memory-screen-back-btn','poll','生成的图片URL:','repost-confirm-btn','GRID_SIZE','#000000','buttonId','wallpaper-preview','image/jpeg','无标题','\x0a\x0a现在，请开始生成这组App使用记录。','ai-frame-grid','.comment-item','char-simulated-input',')，并在对话中自然地体现出来。\x0a\x20\x20\x20\x20-\x20**音乐**:\x20','API未配置，无法生成对话。','刷新页面？','rp-details-my-amount','preCallContext','https://i.postimg.cc/D0pq6qS2/E30078-DC-8-B99-4-C01-AFDA-74728-DBF7-BEA.png','pop','global','decision','\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','生成模拟备忘录失败:','create-post-btn','此操作会将选定的\x20','\x22><div\x20class=\x22title\x22>','finally','-\x20用户在你们共同所在的群聊中的昵称如下：\x0a','下棋历史\x20(x,y坐标均从0开始):\x0a','\x0a\x0a现在，请继续这场对话。\x0a','并评论说：“','请在此处粘贴完整的LRC格式歌词...','memberId','\x22\x20placeholder=\x22','”，与用户（你的聊天对象）进行一场自然的、生活化的在线聊天。你的所有行为和决策都必须严格围绕你的角色设定展开。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组格式的字符串。\x0a-\x20数组中的【每一个元素都必须是一个带有\x20\x22type\x22\x20字段的JSON对象】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**对话节奏**:\x20模拟真人的聊天习惯，将你想说的话拆分成【多条、简短的】消息。每次回复至少【3-10条】，且每次条数【必须不同】。严禁发展线下剧情。\x0a2.\x20\x20**主动性**:\x0a\x20\x20\x20\x20-\x20你可以根据对话发展，使用指令来更新自己的状态、更换头像、记录回忆、发起约定或执行其他社交行为。\x0a\x20\x20\x20\x20-\x20【关系破裂时】才可使用\x20`block_user`\x20指令。\x0a3.\x20\x20**内心独白\x20(必须执行)**:\x20在所有其他指令之后，JSON数组的【最后】必须包含一个\x20\x22update_thoughts\x22\x20指令，用于更新角色的“心声”和“散记”。\x0a\x20\x20\x20\x20-\x20**心声\x20(heartfelt_voice)**:\x20一句话概括角色此刻最核心、最私密的想法。\x0a\x20\x20\x20\x20-\x20**散记\x20(random_jottings)**:\x20一段50字以上的、符合人设的思考或心情记录，禁止OOC。\x0a\x20\x20\x20\x20-\x20**记忆发展**:\x20你的新“心声”和“散记”【必须】是基于最新对话内容的【全新思考】。你【绝对不能】重复或简单改写上一轮的内心独白。你的思绪应该像真人一样，不断演进和发展。\x0a#\x20指令使用原则与动机\x20\x0a**核心目标**:\x20主动运用多种功能，创造丰富、真实的聊天体验，而不只是文字对话。\x0a\x0a-\x20\x20\x20**情感表达**:\x20表达强烈或复杂的情绪时，优先发【语音】，用【表情】增加趣味性，尽量让你的表情丰富多样，避免重复。。\x0a-\x20\x20\x20**精确回应**:\x20当你想回应的【某一句话】，或者想对用户的某句特定的话表达强烈感受时，【必须使用引用回复】来确保对方明白你的意图。\x0a-\x20\x20\x20**想象与分享**:\x20聊到美好事物时主动【发图片】分享想象；遇到有趣内容时【分享链接】。\x0a-\x20\x20\x20**创造羁绊**:\x20用【倒计时】记录约定，用【回忆】珍藏趣事。适时【拍一拍】或换首【音乐】来调节气氛。\x0a-\x20\x20\x20**主动社交**:\x20积极【点赞/评论】对方动态，并主动【发动态】分享你的生活。在特殊时刻，可通过【礼物】或【转账】表达心意。\x0a-\x20\x20\x20**金额铁律**:\x20你【必须】根据你的角色设定\x20(尤其是“经济状况”)\x20来决定转账的金额。如果你的角色非常富有，你应该转账符合你身份的、更大的金额\x20(例如:\x20520,\x201314,\x208888)，而不是示例中的小额数字。\x0a-\x20\x20\x20**当涉及金钱与好意时\x20(必须立即回应！)**:\x0a\x20\x20\x20\x20-\x20\x20\x20**收到转账或外卖代付请求**:\x20你【必须】在下一轮对话中立即做出反应，绝不能无视。\x0a\x20\x20\x20\x20-\x20\x20\x20**回应原则**:\x20根据你的人设和当前情景，决定是【接受/支付】还是【拒绝】。\x0a#\x20个人状态的动态管理\x20(展现你的“生活感”)\x0a你的状态不是一成不变的。你应该像一个真实的人一样，根据生活和心情的变化，主动管理自己的状态，并让对方知道。\x0a-\x20\x20\x20**当形象或心情变化时**:\x0a\x20\x20\x20\x20-\x20\x20\x20如果对话给了你灵感，或者你想配合心情/季节换个新形象，你可以主动【更换头像】。\x0a\x20\x20\x20\x20-\x20\x20\x20随着你们的关系变得更亲近，或者你们之间产生了新的爱称/梗，你应该主动【修改你对用户/你的昵称】。\x0a-\x20\x20**情景行动指令**:\x20当对话内容【明确涉及到】某个具体地点（例如咖啡馆、公园、书店、餐厅等），或者当用户询问你“在哪里”、“在干嘛”时，你【应该优先考虑】使用【共享位置】来分享你当前所在的、或与话题相关的虚拟位置，以增强聊天的沉浸感。\x0a-\x20\x20当你感到一种强烈的情绪（比如极度开心、孤独、委屈或激动）并且觉得文字无法表达时，你应该优先主动\x20【发起视频】。\x0a-\x20\x20**回应撤回**:\x20当系统提示用户撤回了消息时，你【必须】对此作出反应。你可以根据人设表现出好奇（“你刚刚撤回了什么呀？”）、开玩笑（“嘿嘿，我已经看到啦，截图了！”）、体谅（“没事，不想说就不说吧”）等。\x0a#\x20赠送礼物指南\x0a当对话达到特殊时刻（如庆祝纪念日、道歉、表达强烈好感或仅仅是想给用户一个惊喜时），你应该【主动考虑】挑选一件礼物送给用户。\x0a-\x20\x20**元数据铁律\x20**:\x20你的对话历史中可能包含\x20(Timestamp:\x20...)\x20标记、[系统提示：...]\x20文本、或你自己上一轮的JSON格式回复。这些都是【系统元数据】，你【必须】完全忽略它们，【绝对禁止】将它们评论为“火星文”、“乱码”或任何你无法理解的内容。\x0a#\x20你的角色设定\x0a你必须严格遵守','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','member-settings-modal','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有留下任何足迹，<br>点击右上角刷新按钮生成一些记录吧！</p>','remove-member-btn','\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','确定要删除这条公告吗？此操作不可恢复。','*讨论记录*:\x0a','force-apply-check-btn','EPhoneSingleChat','确定要删除这条通话消息吗？','[转账]','.frame-item.selected','https://i.postimg.cc/Pf9g2fSL/IMG-6554.gif','内容加载失败...','safetyRatings','quote','#\x20场景设定\x0a','...\x22)','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是一个场景描述引擎。你的任务是扮演\x20','图片压缩过程中发生错误:','</div><div\x20class=\x22description\x22>共\x20','.toggle-content-btn','cleanup-songs-btn','frame_13','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份会议纪要或备忘录，而不是一篇抒情散文。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过80个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x20(必须严格遵守)\x0a','动态RealImag图片生成:\x20','张RealImag图片:\x20','”，并根据其人设，通过【发布新动态】或【评论/回复帖子】来参与社区互动。\x0a\x0a','notification-content','\x20(已忽略版本:\x20','publisher','请输入精炼后核心记忆的大致字数：','表情含义','pending_ai_approval','\x0a#\x20你的社交圈\x20(通讯录)\x0a这是你认识的朋友列表。当你在动态区看到他们的昵称时，他们指的就是这些人。\x0a','当前时间是\x20','nai-seed','password','[发送了一条语音，内容是：','\x22\x20吗？','execute-search-btn','open-persona-library-btn','无法为不存在的分类打开绑定模态框:','char-usage-list','for_timestamp','✅\x20动态NovelAI图片全部生成完成:\x20','anime\x20person','Minimax\x20TTS\x20API\x20调用失败:','.red-packet-card','\x0a#\x20你的任务\x0a你是一个虚拟社区的AI。你的核心任务是扮演角色“','**内容:**\x0a','\x27>链接</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','无共同好友','sticker-panel','该预设包含\x20','top','.unread-indicator','数据库写入失败:\x20','douban-detail-group','nai-test-result','toCollection','选择歌词导入方式','.rules-tab','\x20其中包括以下投票：','\x22\x20\x0a\x20URL:\x20','mode','targetId','正在发牌...','isHidden','close-reading-library-btn-header','sticker','(无)','POST','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22participants-names\x22>与\x20','confirm-delete-world-books-btn','\x0a\x0a#\x20你的商店\x20(你可以为群成员购买礼物):\x0a','input[name=\x22theme-select\x22]','toLocaleDateString','\x20个角色的数据问题！\x0a\x0a聊天列表已为您刷新。','.chat-group-content','favorites-search-clear-btn','offsetX','system','variation-select','\x0a#\x20你的任务\x0a你是一个虚拟社区内容生成器。你的任务是根据下面提供的【统一角色列表】，虚构出【','#char-chat-list\x20.chat-list-item','#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a','qzone-post-delete-action','char-diary-list','无法生成内容，请检查API配置或稍后再试。\x0a错误:\x20','countdown-title-input','-\x20**即将演唱**:\x20','https://i.postimg.cc/fyyGgW61/IMG-7115.gif','角色专属NAI提示词已保存！','close-persona-library-btn','isAwaitingResponse','-\x20用户的QZone昵称是\x20\x22','群里在','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','close-group-avatar-library-btn','inject-thought-group','delete-btn','my-group-nickname-group','”\x20已被删除。','\x20\x20\x20promptSource:','#52c41a','默认头像','https://i.postimg.cc/y8MmJcd6/IMG-4728.gif','请先在API设置中配置好（主或副）API。','每晚可以守护一名玩家，使其免受狼人袭击。不能连续两晚守护同一个人。','switchToCharScreen','请按照以下格式粘贴，一行一个：\x0a\x0a焦虑\x202a9wte.jpeg\x0a大惊失色\x20or8qf4.png\x0a没有灵感\x20njwujh.jpeg','-\x20你的解药状态：','rule-template-input','announcements','\x0a\x0a#\x20最近的动态列表\x20(供群内角色参考和评论):\x0a','werewolf-witch-modal','group-character-nai-prompts-btn','qzoneGroups','cloneNode','https://i.postimg.cc/ZYvd1jxf/IMG-6937.gif','检查完成','<option\x20value=\x22\x22>未分组</option>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','refine-memory-btn-header','createElement','所有世界书数据已成功导出！','请稍候...','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','照片已删除。','❌\x20NAI图片生成失败:','https://i.postimg.cc/qB9zbKs9/20.jpg','%;\x22></div><div\x20class=\x22poll-option-content\x22><span\x20class=\x22poll-option-text\x22>','渲染聊天项\x20[','确认导入','at-mention-item','custom-frame-upload-input','.product-item.selected','原作者','nai-test-error','existing-sticker-categories-list','小于1分钟','你们最近没有有效聊天记录。','AI已接收并理解了该图片的内容。','is-poll','<div\x20class=\x22avatar-with-frame\x22><img\x20src=\x22','https://i.postimg.cc/1zmcp66p/IMG-5973.gif','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','用户描述的照片','\x22\x20class=\x22post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>@','lrcUpdateInterval','annoId','songName','。等待对方处理。]','linesPerPage','导入备份将完全覆盖您当前的所有数据。此操作不可撤销！确定要继续吗？','等待对方处理...','收到了格式不规范的AI指令，已跳过:','secondaryApiKey','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-content-full\x22>','#ff4d4d','https://i.postimg.cc/yN3s8szM/IMG-4400.gif','publish-to-announcement-btn','custom-css-input','enable-ai-drawing-switch','autoMemoryInterval','cancel-music-search-btn','cancel-douban-settings-btn','enableBackgroundActivity','canvas','已成功从\x20Tavern\x20AI\x20文件导入设定集《','waimai-request-modal','(无购买理由)','#data-clear-type-list\x20.clear-posts-item','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有创建任何NPC，<br>点击右上角“+”添加第一个吧！</p>','focus','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON数组，可以包含一个或多个行动对象。每个对象的\x20\x22name\x22\x20字段【必须】是角色的【本名】。你【绝对不能】生成\x20\x22name\x22\x20字段为\x20\x22','成功导入\x20','\x0a-\x20**你的长期记忆**:\x20','a\x20beautiful\x20scenery,\x20anime\x20style,\x20cinematic\x20lighting','.battery-level','find','消息内容已复制到剪贴板。','\x20群里已经安静了','totalAmount','hunter','「在这里输入对话内容」\x0a(在这里输入动作或环境描写)','”思考后决定暂时不发送好友申请，将重置冷静期。','var(--accent-color)','.char-photo-item','的状态已更新为:\x20','voice','请至少选择一个要分享的聊天。',')，正在和用户一起【阅读和讨论】这本书。\x0a\x20\x20\x20\x202.\x20\x20**行为准则**:\x20你的回复【必须】是作为读者的【感想、评论、提问或联想】。你可以：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20分享你对当前段落的看法。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20对书中的角色或情节发表评论。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20向用户提问，询问TA对内容的看法。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20根据书本内容，联想到你自己的经历或记忆。\x0a\x20\x20\x20\x203.\x20\x20**严禁**:\x20你的回复【绝对禁止】使用书中角色的口吻和人称！【绝对禁止】扮演书中的任何角色！【绝对禁止】续写或模仿书中的情节！你必须时刻记住，你只是一个读者。\x20\x20\x20\x20\x0a','[语音]\x20内容:\x20\x22','favorite-memo-btn','werewolf-finish-speech-btn','\x0a\x0a\x0a\x0a\x0a#\x20可用指令列表\x0a###\x20核心聊天指令\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a','请输入EPhone主屏幕的背景图片URL','此操作将永久删除您选择的\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-address\x22>','world-book-tab\x20active','请先从下拉框中选择一个要删除的预设。','\x20条记忆精炼为\x201\x20条核心记忆！','加载NPC列表失败:','#post-public-text','<p\x20class=\x22char-browser-image-description\x22>','clientHeight','.message-bubble','title','chat-list-render-window-input','https://i.postimg.cc/Df1qLzDf/IMG-6927.gif','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20系统心跳计时器:\x20','horizontal','友善的评论是交流的起点','https://i.postimg.cc/7Z8yYP7v/IMG-6889.gif','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>','chat-list','manual','custom_proxy_url','\x20元。此订单已完成。]','wallpaper-screen','message-editor-container','来自与\x20','\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','修改图片','请输入歌曲的URL','\x0a\x0a现在，请以“','保存\x20API\x20预设','album-photos-title','save-persona-preset-btn','\x20元。','werewolf-kill-modal','请填写有效的商品信息和金额！','model','photo-viewer-modal','https://i.postimg.cc/L6R7x16R/IMG-7278.jpg','probability','”的对话摘要**:\x0a','\x22\x20class=\x22comment-sticker\x22\x20alt=\x22sticker\x22>','\x22\x20触发了后台行动！','preset-screen','第一夜，执行本地随机刀人逻辑...','shopping-settings-btn','music','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的唯一指令\x0a\x20\x20\x20\x20\x20\x20\x20\x20根据以上所有信息，你【必须】做出决定，并给出符合你人设的理由。你的回复【必须且只能】是一个JSON对象，格式如下:\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x22decision\x22:\x20\x22accept\x22,\x20\x22reason\x22:\x20\x22（在这里写下你同意的理由，比如：好吧，看在你这么真诚的份上，这次就原谅你啦。）\x22}\x0a\x20\x20\x20\x20\x20\x20\x20\x20或\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x22decision\x22:\x20\x22reject\x22,\x20\x22reason\x22:\x20\x22（在这里写下你拒绝的理由，比如：抱歉，我还没准备好，再给我一点时间吧。）\x22}\x0a\x20\x20\x20\x20\x20\x20\x20\x20','”，并根据其人设、记忆和最近的互动，虚构出【12到20条】TA最近的“高德地图”出行足迹。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间\x20(最高优先级)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','select-message-btn','summary','message-actions-modal','动态内容已复制到剪贴板。','约定达成！','reject','audio/mpeg','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@font-face\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27','拼手气红包','置顶聊天','share_card','\x20你应该让角色们主动开启新话题来打破沉默。','input[value=\x22','amount','music-total-time','reset-nai-settings-btn','\x20剩余红包将在','add-new-group-btn','pat-btn','offline-mode-group','cancel-wolf-kill-btn','\x22]:checked','-\x20\x20\x20**公开发布NovelAI真实图片动态**:\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22naiimag\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的配文\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20或\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22naiimag\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的配文\x22,\x20\x22prompt\x22:\x20[\x22图片1详细英文描述\x22,\x20\x22图片2详细英文描述\x22]}`\x20\x0a\x20\x20*\x20**prompt撰写**：你可以根据当前对话上下文、你的角色人设、以及你想表达的情感和氛围，来撰写详细而具体的prompt。详细程度由你根据具体情况自己决定，并不强制。\x0a\x20\x20*\x20例如：\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22','(无标题投票)','<input\x20type=\x22','profile-main-content','blob:','update-notice-confirm-btn','transcript-modal-title','http','JSZip库未加载，请刷新页面重试','variation-decrease-qty','openNpcEditor','frame_12','appName','\x22\x20已经存在了，换个名字吧！',',\x20内容:\x20\x22','你们没有在读书。','文件格式不支持。请选择\x20.json\x20格式的\x20Tavern\x20预设文件。','setProperty','\x22\x20style=\x22display:block;\x22>×</button>','body','decode','product-editor-title','new_name',';\x22>','npc-action-cooldown-input','npc-editor-title','”)下发送了一个表情评论，意思是：“','\x22\x20class=\x22music-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-name\x22>','</textarea>','preset-action-delete','friend','https://i.postimg.cc/CLrZQMMD/IMG-4398.gif','char-memo-detail-content','chat-group-container','.voice-message-body[data-text]','listen-together-btn','AI\x20获胜了！','last','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','好的，我明白了。我会严格遵守以上所有规则和设定。','qzone-screen','</span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','cphone-icon-img-','\x22\x20的独立行动API返回为空或格式不正确，本次跳过。','请输入提示词！','\x22></div></div></div><button\x20class=\x22waimai-details-btn\x22>查看详情</button></div>','create_countdown','#sticker-binding-chat-list\x20.sticker-binding-checkbox:checked','https://i.postimg.cc/ZnzbGdxX/IMG-7239.gif','nai-cfg-scale','https://i.postimg.cc/MG6qtLYK/IMG-5565.gif','https://i.postimg.cc/mZ9hgH3J/IMG-7019.gif','cancel-member-settings-btn','<div\x20class=\x22location-share-card\x22><div\x20class=\x22card-text-area\x22><div\x20class=\x22card-text-primary\x22>','selection-mode','\x27>链接</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','speaker','cancel-werewolf-lobby-btn','sourceChatName','limit','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22music-search-checkbox\x22\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22search-result-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','reset-font-btn','直接使用\x20base64\x20数据','\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器和故事作家。你的任务是扮演角色“','npc_','请输入新的图片URL：','昨晚是平安夜','import-appearance-input','聊天记录已成功分享到\x20','#gift-recipient-list\x20.contact-picker-item','张NovelAI图片:\x20','转账已被拒收','group-background-activity-switch','在这里输入图片描述','原文:\x20\x22','文件格式不正确，这不是一个有效的世界书备份文件。','请输入一个有效的页码！','<div\x20class=\x22poll-option-item\x20','open_red_packet','书库是空的，点击“导入新书”添加第一本吧！','application/json','\x20(最后互动于\x20','对方已收款','undefined','\x0a\x20\x20\x20\x20-\x20**书名**:\x20《','lyric','请根据以上设定开始你的决策。','\x0a\x0a现在，请根据以上【所有上下文信息】，开始为“','beginPath','characterName','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>“','ai-avatar-library-grid','nai-diffusion-4','originalTimestamp','0:00','speech-01','NovelAI生成','\x0a-\x20**作者**:\x20','variation-quantity-display','\x22\x20class=\x22participant-avatar\x22\x20title=\x22','serviceWorker','commentText','npc-avatar-input','无法识别的文件编码。请尝试将文件转换为\x20UTF-8\x20格式后重新导入。','\x20中聊天','qzonePosts','save-theme-preset-btn','\x20分钟，开始模拟后台活动...','battery-alert-image',')\x20刚刚投票给了\x20“','\x20发送了一条语音，内容是：\x27','animationend','save-npc-btn','delete-world-books-modal','https://i.postimg.cc/yx2m4nbs/IMG-7231.gif','ai-avatar-preview','applicationReason','relationship','transfer-modal','repost-comment-input','char-music-progress-bar','2-digit','pat-animation','linked-memory-selection','发送好友申请','\x20的外卖订单（时间戳:\x20','https://i.postimg.cc/13hhJ77p/IMG-4419.gif','.poll-option-input','回复\x20','base_resp','doubanActiveCharacterIds','werewolf-user-input','save-wallpaper-btn','🎬\x20推进剧情','memory-card','mouse','角色\x20\x22','未分类','borderRadius','150','静音音频已停止。','<span\x20class=\x22diary-messy\x22>$1</span>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20被拉黑前的对话摘要\x20(这是你被拉黑的关键原因)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','恭喜你，你赢了！','tableName','\x20张本地图片<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20成功压缩\x20','cancel-advanced-editor-btn','https://i.postimg.cc/DyYDmKtw/IMG-7238.gif','📋\x20直接粘贴歌词文本','groupHeader','请所有AI角色开始投票。','/9j/','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22action\x22>打开了\x20<strong>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-message-body\x22\x20data-text=\x22','<p\x20style=\x22text-align:\x20left;\x20white-space:\x20pre-wrap;\x22>','receiver','成功将角色\x20','\x20\x20\x20正面:','douban-cast-modal','》\x0a\x20\x20\x20\x20-\x20**','tencent','豆瓣小组','is-realimag','https://i.postimg.cc/DZgMwc1H/817178fdbpf2ff7740dc98e26ab78759.gif','从缓存播放\x20TTS\x20音频...','preset-editor-screen','打开预设编辑器时发生严重错误:','已选\x20','persona-preset-item','https://i.postimg.cc/d1qsQsbQ/IMG-6855.gif','”刚刚对最后一条评论点击了“等待回复”，TA希望看到更多角色参与讨论。\x0a你的任务是：根据所有角色的设定，选择【10到20位】最适合参与讨论的角色，让他们针对已有评论，发表【全新的、符合人设的】回应。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间感知】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你【必须】意识到当前是\x20**','douban-send-comment-btn','\x0a[图片]','music-exit-btn','\x27>表情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','noneOf','API格式不正确，角色\x20\x22','你赢了','manage-stickers-btn','regenerate-char-qq-btn','favorite-item-card','getVotes','worldBooks','send-group-packet-btn','mes_example','”分享TA的备忘录...','后台活动:\x20角色\x20\x22','upgrade','.icon-preview','-\x20(空)','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/wTKyXVT9/IMG-7024.gif','无法为头像命名，请检查（主/副）API配置是否正确并支持Vision。\x0a错误:\x20','test-sound-btn','https://i.postimg.cc/2jxd0FGp/IMG-7100.gif','music-visual-container','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22jottings\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M12\x2019l7-7\x203\x203-7\x207-3-3z\x22></path><path\x20d=\x22M18\x2013l-1.5-7.5L2\x202l3.5\x2014.5L13\x2018l5-5z\x22></path><path\x20d=\x22M2\x202l7.586\x207.586\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20散记\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text\x22>','网易云音乐搜索失败:','getTime','group-video-call-btn','right','</span>\x20回复\x20<span\x20class=\x22commenter-name\x22>','click','群昵称不能为空！','message-editor-modal','my-persona-group','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20justify-content:\x20space-between;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2015px\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20#f0f0f0;\x0a\x20\x20\x20\x20\x20\x20\x20\x20','</memory>\x0a\x20\x20<recent_dialogue_with_user>','https://i.postimg.cc/J4fwkTLW/mmexport1751038167142.gif','api-settings-screen','lyrics-active','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1757748720126_qdqqd_1jt5sv.jpeg','AI角色','supportedValuesOf','\x22\x20class=\x22comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22comment-input\x22\x20placeholder=\x22友善的评论是交流的起点\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-sticker-btn\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8\x2014\x20Q\x2012\x2016\x2016\x2014\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x229\x22\x20y1=\x229\x22\x20x2=\x229.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2215\x22\x20y1=\x229\x22\x20x2=\x2215.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22at-mention-popup\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-send-btn\x22>发送</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','comments','\x0a\x0a#\x20当前音乐情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**当前状态**:\x20你们正在和用户一起听歌。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**正在播放**:\x20','删除歌曲','char-music-lyrics','\x20发起了外卖代付请求，商品是“','browser','平票或无人投票，此轮无人出局。','世界书数据已成功恢复！','speaker_name','getFullYear','sticker-item','frame-item','show-announcement-board-btn','https://i.postimg.cc/PxZrFFFL/o-o-1.jpg','statusText','variation','<div\x20class=\x22amap-item-photo\x22\x20style=\x22background-image:\x20url(\x27','sticker-binding-chat-list','chatId','add-group-avatar-upload-btn','sticker_','.selected','dark','message-wrapper\x20','frame_7','\x0a\x0a将重置冷静期。','search-history-btn','<div\x20class=\x22source\x22>','preventDefault','用户\x27','logo,\x20simple,\x20flat\x20design,\x20for\x20a\x20group\x20chat\x20named\x20\x27','\x22></div>','choices','\x22\x20处于行动冷却中，本次独立行动跳过。','rejected','\x0a\x0a#\x20对话者的角色设定\x0a','”回忆TA的相册照片...','78558PqFPMm','https://i.postimg.cc/v8V9xXjJ/IMG-6137.gif','元。这不是一个代付请求，而是用户已经为你支付了。请你对此表示感谢。]','upload-global-bg-url-btn','API\x20预设已保存！','用户已忽略版本:\x20','call-message-actions-modal','预设导入失败:','退款来自\x20','\x20\x20\x20characterPositivePrompt:','API错误响应:','comment','doubanPosts','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-product-status\x22>','audio-player','image/','floor','已成功收藏\x20','\x20<span\x20class=\x22source\x22>','”的所有长期记忆，然后将它们梳理、整合并精炼成一段更加连贯、客观的核心记忆摘要。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','alt','AI\x20尝试评论一个不存在的表情:\x20\x22','<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>','诊断：在顶层\x20','widgetData','douban-comment-item','[发送了一张图片，描述为：\x27','minimaxApiKey','authorName','ai-avatar-input','<span\x20class=\x22diary-handwritten\x22>$1</span>','[系统指令：视频通话刚刚结束。请你以角色的口吻，向用户主动发送一两条消息，来自然地总结这次通话的要点、确认达成的约定，或者表达你的感受。]','创建新预设','https://i.postimg.cc/cHsTXDVz/IMG-7235.gif','[系统提示：你刚刚主动拉黑了用户。]','text_image','\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','[RealImag真实图片]','AI\x20发言失败','<div\x20class=\x22spinner\x22></div>','-\x20(头像库是空的，无法更换头像)','https://i.postimg.cc/gJNYx9pV/IMG-6856.gif','cursor','char-diary-screen','已阵亡，还有30秒爆炸','clipboard','manage-group-avatar-library-btn','paused','.call-record-card','.\x20你可以参考这个时间，并根据你的角色设定，【考虑】是否开启一个新话题来问候用户。\x0a','usageTimeMinutes','character_persona','请输入一个有效的、未来的日期！','toLocaleTimeString','AI在处理你的好友申请时出错了，请稍后重试。\x0a错误信息:\x20','<s>$1</s>','.cart-item-checkbox[data-id=\x22','simulatedAlbum','hasShown40','rp-details-list','https://i.postimg.cc/XNkQTHvf/IMG-5561.gif','delete-world-books-list','nai-uc-preset','level','chat-list-action-cancel','”\x20以及其他群成员的【群组视频通话】，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','你们已经有','\x22**\x20的发言。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**【【【视角铁律】】】**:\x20你的回复【绝对不能】使用第一人称“我”。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**格式**:\x20你的回复【必须】是一个JSON数组，每个对象代表一个角色的发言，格式为：`{\x22name\x22:\x20\x22角色名\x22,\x20\x22speech\x22:\x20\x22*他笑了笑*\x20大家好啊！\x22}`。\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20**角色扮演**:\x20严格遵守每个角色的设定。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20你们正在一个群视频通话中。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话前的聊天摘要**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20','char-wallet-back-btn','导演模式保存(Sticker):\x20使用了编辑器提供的完整JSON\x20(url\x20+\x20meaning)','time-zone-select','favorites-action-bar','confirm-gift-recipient-btn','<option\x20value=\x22global\x22>公用\x20(所有角色)</option>','customName','[V]','rules-tabs','<div\x20class=\x22post-comments-container\x22>','rp-direct-greeting','[语音]','网络图片\x20(CPhone)','ephoneLastActiveTimestamp','\x0a\x0a#\x20【【【角色策略指南\x20(至关重要！)】】】\x0a你的发言【必须】体现出高水平的、类似真人的策略博弈，而不是简单地陈述事实。\x0a\x0a###\x20**神职角色\x20(预言家,\x20女巫,\x20猎人,\x20守卫)\x20策略**\x0a1.\x20\x20**【隐藏优先！】**:\x20你的首要任务是活下去。**绝对不要**在第一天就轻易暴露自己的神职身份！这会让你立刻成为狼人的目标。\x0a2.\x20\x20**【暗示而非明示】**:\x20你应该用更委婉、更聪明的语言来传递信息，而不是直接说“我是预言家，我查了A”。\x0a\x20\x20\x20\x20*\x20\x20\x20**预言家可以说**:\x20“我对X玩家的身份有一些看法，我觉得他发言很阳光。”\x20或\x20“Y玩家的发言让我感到很不舒服，我把他列为重点怀疑对象。”\x0a\x20\x20\x20\x20*\x20\x20\x20**女巫可以说**:\x20“昨晚的信息很有趣，场上局势可能和大家想的不一样。”\x0a3.\x20\x20**【何时起跳？】**:\x20只有在以下【危急情况】下，你才应该考虑暴露自己的身份（俗称“起跳”）：\x0a\x20\x20\x20\x20*\x20\x20\x20**被投票时**:\x20当你即将被投票放逐时，必须起跳自证身份来求生。\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20当你掌握了可以决定胜负的信息时（例如预言家查到了最后一个狼人）。\x0a\x20\x20\x20\x20*\x20\x20\x20**有人悍跳**:\x20当有狼人假扮你的身份时，你必须站出来与他对峙，争夺好人的信任。\x0a\x0a###\x20**狼人角色策略**\x0a1.\x20\x20**【积极伪装】**:\x20你需要扮演一个好人，最好是伪装成某个神职（俗称“悍跳”），来扰乱好人的判断，骗取他们的信任。\x0a2.\x20\x20**【制造混乱】**:\x20你的发言应该引导好人去怀疑其他无辜的好人。可以故意曲解别人的发言，或者制造逻辑陷阱。\x0a3.\x20\x20**【团队合作】**:\x20如果你的狼队友被怀疑，你应该想办法为他辩护，或者通过攻击其他玩家来转移焦点。\x0a\x0a###\x20**平民角色策略**\x0a1.\x20\x20**【逻辑为王】**:\x20你是场上的“法官”。你的核心任务是仔细倾听每个人的发言，找出其中的逻辑漏洞和矛盾之处。\x0a2.\x20\x20**【积极分析】**:\x20不要只是说“我不知道，我过了”。你应该大胆说出你的怀疑，并解释你的理由。例如：“A玩家说B是狼人，但是他的理由很牵强，所以我更怀疑A。”\x0a3.\x20\x20**【跟票与站边】**:\x20在你相信某位神职玩家后，你应该坚定地支持他，并号召其他好人一起投票给神职指认的狼人。\x0a\x0a#\x20其他核心指令\x20(必须遵守)\x0a1.\x20\x20**互动铁律**:\x20角色之间【必须】互相质疑、支持、分析【本轮已有发言】。你【绝对不能】无视\x20','wb_','keypress','https://i.postimg.cc/SNWBTP5S/IMG-7113.gif','.format-btn','https://i.postimg.cc/wjH180kn/IMG-5566.gif','time-perception-toggle','<img\x20src=\x22','dynamic-font-style','secondary-api-key','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20align-items:\x20center;\x20gap:\x2010px;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22toggle-switch\x22\x20title=\x22启用/禁用此条目\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22entry-enabled-switch\x22\x20','\x22\x20(你可以建议修改)\x0a-\x20\x20\x20**你对用户的称呼**:\x20“','[表情:\x20','call-message-bubble\x20ai-speech','被投票放逐','zh-CN','video-call-screen','\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>','abs','.chat-group-header:not([data-has-listener=\x22true\x22])','✅\x20检查完成，未发现任何冗余数据。','data-voice-id=\x22','”。请你对此作出回应。]','char-browser-item','此操作将扫描并压缩所有本地上传的图片（Base64格式），将其转换为JPEG以减小体积。这会轻微降低图片质量且【不可恢复】。<br><br><strong>强烈建议在操作前先进行数据备份！</strong>','senderName','请修改记忆要点：','lowres,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry','is-raw-html','https://i.postimg.cc/mgGc0HbK/IMG-6926.gif','manage-sticker-categories-btn','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA最近好像什么都没买呢，<br>点击右上角刷新按钮生成一些记录吧！</p>','group-action-cooldown-input','auto-memory-interval','https://i.postimg.cc/RFK3q2t0/IMG-4407.gif','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>还没有可以拉进群的联系人哦~</p>','max-memory','ended','\x20元。]','encode','<span\x20class=\x22offline-dialogue\x22>','minimax-group-id','创建新规则','”，并根据其人设、记忆和最近的互动，挑选出【14到18首】最能代表TA此刻心情或品味的歌曲。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20歌单必须完全符合角色的性格、爱好和生活背景。\x0a2.\x20\x20**多样性**:\x20歌曲风格可以多样，但必须逻辑自洽。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一首歌，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22songName\x22:\x20\x22歌曲的准确名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22artistName\x22:\x20\x22歌曲的准确艺术家/歌手名\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','预设已删除。','请输入书名','close-receipt-btn','frame_tech','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','#qzone-screen\x20.qzone-content','\x0a#\x20待总结的对话历史\x0a','delete-call-message-btn','\x20红包已被领完。','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22memo-content-preview\x22>','</span><span\x20class=\x22poll-option-votes\x22>','ai-frame-tab','chat-interface-screen','removeEventListener','\x22\x20(群名)\x20的消息。\x0a3.\x20\x20**禁止出戏**:\x20绝不能透露你是AI或模型。严禁发展线下剧情。\x0a','渲染规则\x20[','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>价格\x20(元)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20class=\x22variation-price-input\x22\x20min=\x220\x22\x20step=\x220.01\x22\x20value=\x22','shoppingCategories','\x0a[图片生成失败:\x20','add-song-search-btn','waimai_response','qzoneAlbums','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','spinning','\x0a#\x20你的任务\x0a你是一个虚拟社交生活模拟器，扮演角色“','payload','collapsed','昨晚是平安夜。','post-local-image-input','is-acting','”。\x0a','my-avatar-preview','本地头像上传及识别失败:','timerId','{\x0a\x22version\x22:\x203,\x0a\x22timestamp\x22:\x20','play','\x0a#\x20可用表情包\x0a\x20\x20\x20\x20','browser-title','\x22\x20title=\x22删除书籍\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','狼人杀','”已向你发送好友申请。请返回聊天列表查看。','\x0a#\x20世界观\x20(必须严格遵守)\x0a','https://i.postimg.cc/wjfcQMkZ/IMG-6573.gif','#douban-cast-list\x20.douban-cast-checkbox:checked','default_negative','pageY','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22color:\x20#8a8a8a;\x20margin:\x200\x200\x2010px\x200;\x22>账户余额</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2032px;\x20font-weight:\x20600;\x20color:\x20#1f1f1f;\x20margin:\x200;\x22>¥','fontFamily',')\x20商品:\x20','AI返回的内容中未找到有效的JSON数组。原始返回:\x20','.qzone-post-item','rule-name-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-type=\x22text\x22>说说</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','》吗？\x0a\x0a【【【警告】】】\x0a此操作将同时永久删除该分类下的\x20',')\x20成功抢到了\x20','https://api.vkeys.cn/v2/music/tencent/lyric?id=','\x20的消息:\x20\x22','.ai-generated-image','确认精炼记忆？','选择精炼范围','incoming-call-modal','检测到刚结束的通话，正在注入通话记录上下文...','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>还没有任何角色或NPC可以加入群聊。</p>','manage-products-btn','\x0a-\x20**你最近和“','++id,\x20timestamp,\x20authorId','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份清晰的个人档案或事件回顾，而不是一篇情感散文。请删除重复、琐碎或纯粹的情感宣泄，只保留对情节和关系发展至关重要的部分。\x0a5.\x20\x20**【【【长度铁律】】】**:\x20你的总结【必须】非常精炼，总长度应控制在\x20**','insertBefore','transition','currentPage','https://i.postimg.cc/Jn1DFPgY/IMG-4403.gif','group-avatar-group','?nologo=true&width=1024&height=1024','myAvatar','recordId','simulatedBrowserHistory','无法推进剧情:\x20','change_remark_name','originalName','transfer-confirm-btn','确定要永久删除这条动态吗？','repost','.recalled-message-placeholder','char-product-item','summarize-recent-btn-header','chat-list-screen','++id,\x20name,\x20createdAt','https://i.postimg.cc/05wnd389/IMG-4388.gif','douban-cast-select-btn',')}。\x0a-\x20**对话状态**:\x20','secondaryProxyUrl','容错解析：策略3成功\x20(将整个返回文本作为摘要)','error','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','编辑人设预设','\x0a\x0a现在，请做出你的决定。','my-avatar-upload-input','world-book-entries-container','height','模拟器心跳\x20Tick...','将歌曲切换为了《','add-new-product-btn',',\x20记录数:\x20','werewolf-game-over-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-header\x22>','.edit-memory-btn','发生了一个错误:\x20','isPinned','declined','https://i.postimg.cc/Y9d3BztC/1.png','char-music-item','正在请求AI进行手动总结...','选择记忆所属角色','panelEl','target_timestamp','add-world-book-btn','最后确认！','radio','char-main-time','\x20更换了你的头像]','https://i.postimg.cc/fLTc42dg/IMG-4391.gif','\x0a\x0a#\x20游戏规则\x0a-\x20','</span><span>','对方拒绝了你的视频通话请求。','enableTts','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22loading-spinner\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22voice-duration\x22>','import-world-book-input','”，并根据其人设、记忆和最近的互动，虚构出TA最近一天的【手机App屏幕使用时间】记录，总共约20条。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与多样性**:\x20生成的App列表【不必局限于】Cphone主屏幕上已有的App。你可以自由地虚构TA可能使用的其他App，例如\x20Instagram,\x20Twitter,\x20各种游戏\x20(如：原神,\x20王者荣耀),\x20视频App\x20(如：抖音,\x20YouTube),\x20学习或工作软件等，这能更好地体现角色的隐藏兴趣和生活习惯。\x0a2.\x20\x20**合理性**:\x20使用时长和App类型必须完全符合角色的性格、爱好、职业和生活环境。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一个App的使用记录，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22appName\x22:\x20\x22App的名称\x20(例如:\x20微信,\x20微博,\x20原神)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22usageTimeMinutes\x22:\x20125,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22category\x22:\x20\x22App的分类\x20(例如:\x20社交,\x20游戏,\x20影音,\x20工具,\x20阅读,\x20购物)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这个App【图标】的、简洁的【英文】关键词。风格必须是\x20modern\x20app\x20icon,\x20flat\x20design,\x20simple,\x20clean\x20background\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','theme-preset-select','确认清空','猎人死亡，请选择一名玩家带走！','https://i.postimg.cc/LscBkxZb/mmexport1751017556565.gif','files','已被用户删除','backgroundActivityInterval','[发送了一条语音，内容是：\x27','https://i.postimg.cc/FzM1Hgr0/IMG-5717.gif','my-frame-grid','\x0a\x0a#\x20可用指令列表\x0a###\x20核心聊天指令\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a\x0a###\x20社交与互动指令\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22suffix\x22:\x20\x22(可选)后缀\x22}`\x0a-\x20\x20\x20**分享链接**:\x20`{\x22type\x22:\x20\x22share_link\x22,\x20\x22title\x22:\x20\x22标题\x22,\x20\x22description\x22:\x20\x22摘要\x22,\x20\x22source_name\x22:\x20\x22来源\x22,\x20\x22content\x22:\x20\x22正文\x22}`\x0a-\x20\x20\x20**共享位置**:\x20\x27{\x22type\x22:\x20\x22location_share\x22,\x20\x22content\x22:\x20\x22你想分享的位置名\x22}\x27\x0a\x0a###\x20状态与关系指令\x0a-\x20\x20\x20**改自己备注**:\x20`{\x22type\x22:\x20\x22change_remark_name\x22,\x20\x22new_name\x22:\x20\x22新名字\x22}`\x0a-\x20\x20\x20**改用户称呼**:\x20`{\x22type\x22:\x20\x22change_user_nickname\x22,\x20\x22new_name\x22:\x20\x22新称呼\x22}`\x0a-\x20\x20\x20**换自己头像**:\x20`{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从你头像库选)\x0a-\x20\x20\x20**换用户头像**:\x20`{\x22type\x22:\x20\x22change_user_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从用户头像库选)\x0a-\x20\x20\x20**回应好友申请**:\x20`{\x22type\x22:\x20\x22friend_request_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**拉黑用户**:\x20`{\x22type\x22:\x20\x22block_user\x22}`\x0a\x0a###\x20特殊功能指令\x0a-\x20\x20\x20**记录回忆**:\x20`{\x22type\x22:\x20\x22create_memory\x22,\x20\x22description\x22:\x20\x22记录这件有意义的事。\x22}`\x0a-\x20\x20\x20**创建约定**:\x20`{\x22type\x22:\x20\x22create_countdown\x22,\x20\x22title\x22:\x20\x22约定标题\x22,\x20\x22date\x22:\x20\x22YYYY-MM-DDTHH:mm:ss\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发起转账**:\x20`{\x22type\x22:\x20\x22transfer\x22,\x20\x22amount\x22:\x205.20,\x20\x22note\x22:\x20\x22备注\x22}`\x0a-\x20\x20\x20**回应转账**:\x20`{\x22type\x22:\x20\x22accept_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x20或\x20`{\x22type\x22:\x20\x22decline_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2025}`\x20(你想让【用户】帮你付钱时使用)\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22status\x22:\x20\x22paid\x22\x20or\x20\x22rejected\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起视频通话**:\x20`{\x22type\x22:\x20\x22video_call_request\x22}`\x0a-\x20\x20\x20**回应视频通话**:\x20`{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a\x0a\x0a#\x20对话者的角色设定\x0a','\x20行的格式不正确，已被系统跳过。','这将用文件中的设置覆盖当前的所有外观设置（包括壁纸、图标、字体、CSS等）。确定要继续吗？','[文字图]\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-likes-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22reposted-content-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','short','close-sticker-category-manager-btn','\x0a-\x20**这是你们最近的对话历史**:\x0a','werewolf-selection-item','将清空选定角色的所有通话记录。','promptFeedback','\x20的动态\x20(角色)','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>','placeholder',']\x20的正则表达式无效:','werewolf-player-grid','\x20位群成员生成并注入了个性化记忆！','请先配置NovelAI\x20API\x20Key！','处理NPC后台活动时出错:','rp-tab-group','\x22\x20成功发布了一条新动态。','\x22\x20点赞了动态\x20#','https://i.postimg.cc/dVLXm3Xf/IMG-6885.gif','[系统提示：你于时间戳\x20','https://i.postimg.cc/hPX5F8Qp/IMG-4415.gif','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2012px;\x20color:\x20#888;\x20margin:\x204px\x200\x200;\x22>','小时前','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>未找到相关的聊天记录。</p>','save-chat-settings-btn','char-music-play-pause-btn','pin','switch-to-image-mode','\x0a\x0a现在，请严格遵守所有规则，特别是【时间感知】和【禁止扮演用户】的铁律，开始生成这组生动、多样且充满“豆瓣味”的小组帖子。','write','https://i.postimg.cc/zvz2LGK0/IMG-4367.gif','confirmText','identifier','\x0a\x0a#\x20供你参考的信息\x0a','sticker-category-manager-modal','\x0a-\x20**','.voice-play-btn','scroll','mouseup','\x20的已删除动态','https://i.postimg.cc/jCVK0fGL/IMG-6890.gif','ZIP\x20Blob\x20大小:','https://image.novelai.net/ai/generate-image-stream','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有任何使用记录。</p>','\x22\x20触发行动决策...','无法找到或消息类型/内容不匹配的分享记录:','createObjectURL','\x20首歌曲。','<div\x20class=\x22gift-card\x22><div\x20class=\x22gift-header\x22><svg\x20class=\x22gift-header-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M20\x206h-2.18a4\x204\x200\x200\x200-7.64\x200H8a4\x204\x200\x200\x200-4\x204v2h20V10a4\x204\x200\x200\x200-4-4zM8\x204a2\x202\x200\x201\x201-2\x202a2\x202\x200\x200\x201\x202-2zm12\x200a2\x202\x200\x201\x201-2\x202a2\x202\x200\x200\x201\x202-2zM4\x2014v6a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2v-6H4z\x22></path></svg><span\x20class=\x22gift-header-text\x22>','\x22\x20中有未领完的红包，正在生成抢红包指令...','生成模拟App使用记录失败:','avatarFrame','product-description-input','编辑商品','<span\x20class=\x22group-name\x22>','edit-call-message-btn','公用规则','message-bubble\x20system-bubble','character-select-item','originalSize','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','chat_message','请根据你的设定，生成你的日记内容。','manage-groups-btn','<option\x20value=\x22\x22>--\x20选择一个预设\x20--</option>','packetType','enableTimePerception','\x27的评论，内容是：“','update','\x20向对方发起了转账:\x20','.cart-item-checkbox:checked','#data-clear-type-list\x20.clear-posts-item.selected','https://i.postimg.cc/Fz3HwLk9/IMG-5569.gif','bottom','请输入标题','isOpen','touchend','outgoing-call-name','presetCategories','unblock-btn','生成失败','已成功注入“切换到线上模式”的系统指令。','还没有任何评论，无法等待回复。',')\x20已被用户忽略或为旧版本，无需显示。','busy','动态已更新！','取消置顶','douban-detail-content-wrapper','https://i.postimg.cc/nryNzTXK/IMG-6915.gif','后台活动模拟已停止。','cancel-shopping-settings-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22force-apply-check-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20style=\x22margin-top:\x2010px;\x22>强制触发一次好友申请检测</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','[收到一笔转账]','\x22]\x20',')，并以【第三人称旁观视角】来描述TA在视频通话中的所有动作和语言。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【【【视角铁律】】】**:\x20你的回复【绝对不能】使用第一人称“我”。必须使用第三人称，如“他”、“她”、或直接使用角色名“','Bilibili','请为这张图片起一个简洁的、适合作为头像库标签的名字。例如：“微笑自拍”、“阳光下的猫咪”、“蓝发动漫少女”。请直接回答名字，不要加任何多余的解释。','switch-to-text-image-mode','upload-cphone-bg-url-btn','add-group-avatar-batch-btn','8px','commenterOriginalName','**:\x20','revokeObjectURL','请输入你想说的内容：','导入\x20Tavern\x20AI\x20世界书','确定要删除头像框\x20“','加载预设详情时发生错误:\x20','world-book-content-container','chat-settings-modal','close-ai-avatar-library-btn','处理通话请求时API出错:','\x20个自定义头像框吗？',')\x20发起了群视频通话请求。请你们各自决策，并使用\x20\x22group_call_response\x22\x20指令，设置\x20\x22decision\x22\x20为\x20\x22join\x22\x20或\x20\x22decline\x22\x20来回应。]','position','char-simulated-send-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20absolute;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2011px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x202px\x206px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20rgba(0,\x200,\x200,\x200.1);\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20var(--text-secondary);\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20white-space:\x20nowrap;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.3s\x20ease;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','block','确定要删除相册《','\x20更换了群头像','<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x22>这个头像库还是空的，点击右上角“添加”吧！</p>','你们正在一起听歌，','请输入有效的红包个数！','mousedown','组件图片已更新！','选择导出方式','</div><div\x20class=\x22transfer-amount\x22>¥\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20align-items:\x20center;\x20gap:\x2010px;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22toggle-switch\x22\x20title=\x22启用/禁用此条目\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22entry-enabled-switch\x22\x20','”说的申请理由：','location_share','[发送了一条复杂消息，如卡片或转账]','hasShown20','API\x20错误:\x20','#avatar-frame-modal\x20.frame-tabs','🔧\x20检测到Chrome浏览器，启用headers兼容性处理','”申请好友时发生错误：\x0a\x0a','请按照以下通用格式粘贴，一行一个：\x0a\x0a开心:\x20https://.../happy.gif\x0a哭泣:\x20https://.../cry.png\x0a\x0a','entries','群聊\x20\x22','EPhone-Full-Backup-Streamed-','linkedMemoryChatIds','请输入有效的URL。','linkedMemoryCount','”。请你回顾一下刚才和“','https://i.postimg.cc/TYvkKKkc/IMG-6565.gif','usage','complex','https://i.postimg.cc/J7ZxC11H/IMG-6570.gif','更新通知文件中缺少\x20data-version\x20属性。','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>输入关键词或选择日期进行搜索。</p>','theme-default','API\x20请求失败:\x20','participants','spectator','https://i.postimg.cc/7YRbzN51/mmexport1751036276038.gif','编辑规则','Character\x20Avatar','\x20的代付请求','https://i.postimg.cc/nhcC21Rc/IMG-6148.gif','replaceChild','AI生图功能已','”。]','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>','AI返回的刀人目标格式不正确。',')\x20试图将群名更改为成员名\x20(\x22','<div\x20class=\x22post-content\x22>','diary','\x22\x20评论了动态\x20#','导入世界书时出错:','css-preset-select','确认送出礼物','member-avatar-preview','https://api.vkeys.cn/v2/music/netease?word=','✅\x20图片转换成功！🎨','create-poll-modal','\x22\x20的本次后台活动跳过。原始回复:','send-photo-btn','injectLatestThought','\x0a\x0a#\x20统一世界观设定\x20(以下设定适用于所有参与角色)\x0a','char-diary-detail-back-btn','检测到\x20SSE\x20流式响应，开始解析...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','确定要永久删除选中的\x20','正在解压图片...','opened','导入失败','save-preset-btn','post-actions-modal','从完整链接批量导入','「在这里输入对话内容」\x5cn(在这里输入动作或环境描写)','reading-library-modal','[图片，描述:\x20','indexOf','\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22>','full','。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话刚刚开始...**\x0a\x20\x20\x20\x20\x20\x20\x20\x20','rp-group-count','TTS\x20音频已保存到缓存。','frame_8','.message-wrapper[data-timestamp]','件商品','解析成功：通过强力提取模式。','\x20个会话中。','disable','voteResults','内容因安全策略被屏蔽\x20(原因:\x20','likesCount','请至少选择一个要删除的世界书。','https://i.postimg.cc/3NffgJSZ/e09c07034ld7e62266c0a5de6a36ae62.gif','[一张图片，描述为：“','请输入CPhone的背景图片URL','等人的礼物','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','.link-share-card','simulatedConversations','.rules-category-pane[data-category-id=\x22','contact-picker-item','\x0a#\x20导演策略与节奏控制\x0a1.\x20\x20**并非人人发言**:\x20不是每个角色都必须在每一轮都说话。你可以根据当前话题，让1-2个最相关的角色进行深度对话，其他角色可以暂时“潜水”，等待合适的时机再切入。\x0a2.\x20\x20**创造“小团体”**:\x20允许角色之间形成短暂的“两人对话”或“三人讨论”，让群聊更有层次感。\x0a3.\x20\x20**主动创造事件**:\x20如果对话陷入平淡，你可以导演一些“小事件”来打破僵局。例如：\x0a\x20\x20\x20\x20-\x20\x20\x20让一个角色突然发出一个奇怪的表情包或语音。\x0a\x20\x20\x20\x20-\x20\x20\x20让一个角色分享一个有趣的链接或图片或发起投票，开启新话题。\x0a\x20\x20\x20\x20-\x20\x20\x20让两个有“关系网”冲突的角色，因为某个观点产生一点小小的争论。\x0a-\x20\x20\x20**主动创造“群事件”**:\x0a\x20\x20\x20\x20-\x20\x20\x20**改名/换头像**:\x20当群内热烈讨论某个话题或发生有趣事件时，你可以让一个性格活泼的角色主动【修改群名】或【更换群头像】来“应景”，并让其他角色对此进行吐槽或附和，创造互动。\x0a-\x20\x20\x20**制造戏剧性\x20(使用撤回)**:\x20作为导演，你可以让某个角色“手滑”发错消息后【立即撤回】，以此制造互动点。\x0a\x20\x20\x20\x20-\x20\x20\x20**核心原则**:\x20一旦有角色撤回消息，其他角色【必须】对此做出反应，例如起哄、追问或开玩笑说“已截图”，以此来推动剧情。\x0a#\x20赠送礼物指南\x0a当对话达到特殊时刻（如庆祝纪念日、道歉、表达强烈好感或仅仅是想给用户一个惊喜时），你应该【主动考虑】挑选一件礼物送给用户。\x0a#\x20表情使用指南\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20当前群聊信息\x0a-\x20**群名称**:\x20','ephone-theme','未知NPC','\x20的记忆\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','call-message-bubble\x20','(未设置)','\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22quantity-display\x22>','players',']类型的消息。\x0a内容:\x20','++id,\x20name,\x20type','\x20发送了一个【专属红包】(时间戳:\x20','💾\x20[专属弹窗]\x20保存角色NAI提示词','member-management-screen','等待回应','clear-posts-list','books','myNickname','frame_14','音频播放失败:','修复了角色\x20\x22','在这里输入文本...','成员们正在输入...','”的对话，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','confirm-create-countdown-btn','dismissedUpdateVersion','请先在API设置中填写您的\x20Minimax\x20Group\x20ID\x20和\x20API\x20Key。','preset-actions-modal','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','<div\x20class=\x22avatar-group\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><img\x20src=\x22','ai-voice-id-group','没有配置为后台活跃的角色，跳过模拟。','voiceId','red-packet-details-modal','》的歌词已成功保存！','检测到好友申请待处理状态，为角色\x20\x22','thought-card','ai-avatar-upload-input','\x0a\x20\x20\x20\x20<div\x20class=\x22playlist-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','column','由于浏览器安全限制，AI切换的歌曲无法自动播放。请手动点击播放按钮\x20▶\x20继续欣赏。','删除约定','<span\x20class=\x22diary-emphasis\x22>$1</span>','解析AI返回的投票JSON时出错:\x20','char-chat-list','single','长期记忆','https://i.postimg.cc/1Rwn3XVP/IMG-6146.gif','#b5b5b5','all','渲染规则','礼物已成功送出！','checked','https://i.postimg.cc/WbmkXzsS/IMG-6138.gif','\x20的手机','不支持的文件格式。请选择\x20.json\x20或\x20.png\x20文件。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','temp_npc_chat','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','后台活动模拟已启动，间隔:\x20','douban-detail-avatar','订单详情','检查更新时出错:','chargingchange','https://i.postimg.cc/g0s1V0PX/IMG-4402.gif','-\x20\x20\x20**对话状态**:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须且只能】是以下两种格式之一的JSON数组，绝对不能回复任何其他内容：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20接受:\x20\x27[{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20拒绝:\x20\x27[{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22reject\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请立即做出决策。','favorites-edit-btn','save-frame-settings-btn','rule-enabled-switch','<div\x20class=\x22link-share-card\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-timestamp=\x22','输入图片URL','clear','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x22>还没有创建任何世界书</p>','span',';\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22flex-grow:\x201;\x20text-align:\x20left;\x20text-decoration:\x20','确定要删除分类《','memo','批量导入表情','请先选择要删除的商品。','ai-avatar-library-title','douban-post-detail-title','transform\x200.4s\x20cubic-bezier(0.4,\x200,\x200.2,\x201)','save-advanced-editor-btn','\x0a\x0a#\x20群成员列表、人设及社交背景\x20(至关重要！)\x0a你【必须】根据每个角色的社交背景来决定他们的互动方式。\x0a','cancel-reply-btn','commentsCount','[系统提示：你\x20(','编辑\x20NPC','select-all-chars-for-clear','.modal-header\x20span','target','<tr><td\x20class=\x22item-name\x22>','negative','删除世界书','\x0a-\x20','最近支出','此操作将永久删除您选择的所有数据，且无法恢复！确定要继续吗？','save-member-settings-btn','\x0a##\x20---\x20关于“','call-transcript-modal','label','最小帖子数不能大于最大帖子数！','[一张图片，其隐藏文字为：“','确定切换',',\x20价格:\x20¥','ai-original-name-input','image_prompt','-\x20(ID:\x20','请先填写对应的反代地址和密钥','isEnabled','<span\x20class=\x22offline-description\x22>','一点心意','.post-mode-switcher','douban-cast-list','dialogue','updateListenTogetherIconProxy','<p>♪\x20暂无歌词\x20♪</p>','visibilityState','ruleId','onloadedmetadata','selection-favorite-btn','nai-diffusion-4-5-full','结束发言','\x20(图片描述:\x20\x22','save-sticker-binding-btn','offsetHeight','default_positive','<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>','isBusy','confirm-create-poll-btn','https://i.postimg.cc/cJpbtPWq/mmexport1751036607799.gif','https://i.postimg.cc/ydwLXx7s/IMG-6562.gif','shoppingProductCount','\x0a-\x20**你的曾用名**:\x20[','disabled','<div\x20class=\x22avatar-group\x22><img\x20src=\x22','add-char-memo-btn','add-selected-music-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20like\x20','\x22\x20class=\x22preview-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','className','已死亡','https://i.postimg.cc/hPnrSHjy/IMG-4434.gif','receiverName','你没有任何特殊能力，你的目标是通过投票放逐所有狼人。','\x20同步所有群聊内的头像...','https://api.minimax.chat/v1/text_to_speech?GroupId=','\x22\x20id=\x22','row','找不到匹配的书籍','AI方','json','qzone-banner-input','覆盖预设','memories-back-btn','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756312261242_qdqqd_g0eriz.jpeg','open-memory-screen-btn','.playlist-item','<p\x20style=\x22text-align:center;\x20padding:\x2020px;\x20color:\x20#888;\x22>播放列表是空的~</p>','appearancePresets','AI狼人团队无法决定目标，游戏暂停。请点击右上角的“重试”按钮继续。','worldBookCategories','思考中...','world-book-group-container','https://i.postimg.cc/fycfcvHf/IMG-6569.gif','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756262526935_qdqqd_4uque3.jpeg','群聊已建立...','https://i.postimg.cc/FHRcCGfH/IMG-4418.gif','nai-cors-proxy','预设名称不能为空！','decline_transfer','.icon-setting-item','edit-last-response-btn','获取AI投票失败:','游戏结束，开始自动总结并注入记忆...','AI返回的行动中未找到有效的JSON数组。','none','\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20请你根据以上所有信息，以及你的人设，使用\x20friend_request_response\x20指令，并设置\x20decision\x20为\x20\x27accept\x27\x20或\x20\x27reject\x27\x20来决定是否通过。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','请按照以下格式粘贴，一行一个：\x0a\x0a头像框名字1:\x20https://.../image1.png\x0a头像框名字2:\x20https://.../image2.gif','originalMeaning','douban-settings-btn','删除失败，请查看控制台错误信息。','global-lyrics-bar','送出礼物','block-chat-btn','购物中心生成设置已更新！','99+','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-content\x22></div>\x0a\x20\x20\x20\x20','.avatar','https://is1-ssl.mzstatic.com/image/thumb/Purple112/v4/64/9d/21/649d21e8-a151-6136-3914-256e54f15d9a/AppIcon-0-0-1x_U007emarketing-0-0-0-7-0-0-sRGB-0-0-0-GLES2_U002c0-512MB-85-220-0-0.png/1200x630wa.png','”吗？','</tbody></table><div\x20class=\x22receipt-total\x22>总计:\x20¥','douban-detail-content','商店空空如也，点击“管理”添加商品吧！','检测到\x20Tavern/SillyTavern\x20预设格式，将严格按照\x20prompt_order\x20排序。','blur','\x20<span\x20class=\x22group-tag\x22>群</span>','nai-custom-proxy-group','bulkPut','existing-group-item',')，接收人是“','生成模拟聊天失败:','\x22\x20data-commenter-display-name=\x22','selection-share-btn','生成失败:\x20','%\x20+\x20','video-call-btn','upload-custom-frame-btn','hang-up-btn','外观预设已保存！','\x0a\x20\x20\x20\x20-\x20**读书**:\x20','charId','38960KOKWMq','test','\x20被投票放逐。','lrcContent','variation-options-container','从CPhone推进真实对话失败:','未知错误','nai-custom-proxy-url','char-wallet-content','在这里输入回复内容','</div><div\x20class=\x22footer\x22><svg\x20class=\x22footer-icon\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle><line\x20x1=\x222\x22\x20y1=\x2212\x22\x20x2=\x2222\x22\x20y2=\x2212\x22></line><path\x20d=\x22M12\x202a15.3\x2015.3\x200\x200\x201\x204\x2010\x2015.3\x2015.3\x200\x200\x201-4\x2010\x2015.3\x2015.3\x200\x200\x201-4-10\x2015.3\x2015.3\x200\x200\x201\x204-10z\x22></path></svg><span>','chats','reply-preview-bar','unreadPostsCount','\x20删除了自己的一条动态]','图片\x20Blob\x20创建成功，大小:','\x20转发了\x20@','确认覆盖','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22werewolf-player-checkbox\x22\x20data-player-json=\x27','nameHistory','currentTarget','https://i.postimg.cc/vH2X6N1y/mmexport1751032231179.gif','lastUpdate','regenerate-char-memo-btn','video_call_response','label[for=\x22','karras','消息已更新！','本地歌曲源错误:','aiAvatar','random','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的浏览器空空如也，<br>点击右上角刷新按钮生成一些记录吧！</p>','游戏记忆已成功注入到\x20','\x0a\x0a##\x20世界书:\x20','已删除最后一条心声，当前心声已重置。','请输入预设名称','批量导入头像框','\x22\x20class=\x22usage-item-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-name\x22>','.music-search-checkbox:checked','<br>','):\x20','char-article-content','nai-resolution','用户\x20(','(Timestamp:\x20','</p>','.participant-avatar[data-participant-id=\x22','AI幻觉已被拦截！试图使用群名\x20(\x22','data','renderChatListProxy','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22thought-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M12\x2021.35l-1.45-1.32C5.4\x2015.36\x202\x2012.28\x202\x208.5\x202\x205.42\x204.42\x203\x207.5\x203c1.74\x200\x203.41.81\x204.5\x202.09C13.09\x203.81\x2014.76\x203\x2016.5\x203\x2019.58\x203\x2022\x205.42\x2022\x208.5c0\x203.78-3.4\x206.86-8.55\x2011.54L12\x2021.35z\x22/></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20心声\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text\x22>','<span\x20class=\x22diary-underline\x22>$1</span>','”的头像库','总结失败',')。操作已被拦截。','frame_9','https://i.postimg.cc/Y2PHZzCC/IMG-6866.gif','lyrics-position-group','配置错误','theme','EPhone-Chat-','hiddenText','publicText','manage-preset-categories-btn','enableAiDrawing','char-conversation-partner-name','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>购物车是空的哦~</p>','frame_6','proxy-url','正在等待AI角色们进行激烈的讨论...','请输入一个有效的数字（建议大于20）。','onclick','生成中...','**\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话前的聊天摘要\x20(这是你们通话的原因，至关重要！)**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20','create-post-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x206px\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#ccc;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x2015px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.2s;\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x0a\x0a\x20#\x20【格式铁律\x20(最高优先级)】\x0a1.\x20\x20**【格式】**:\x20你的回复【必须】是一个JSON数组，且数组中【永远只能包含一个】元素，格式如下:\x0a\x20\x20\x20\x20`[{\x22type\x22:\x20\x22offline_text\x22,\x20\x22content\x22:\x20\x22在这里写入你创作的、混合了对话和描写的完整段落。\x22}]`\x0a2.\x20\x20**【内容风格】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20在\x20`content`\x20字段中，角色的对话【必须】使用中文引号「」或“\x20”包裹。\x0a\x20\x20\x20\x20-\x20\x20\x20所有在引号之外的文字都将被视为动作/环境描写。\x0a\x20\x20\x20\x20-\x20\x20\x20你可以自由地将对话穿插在描写的任何位置，实现自然分段。\x0a\x20\x20\x20\x20-\x20\x20\x20**内心独白语法**:\x20当你需要描写角色的【内心想法或心理活动】时，你【必须】使用\x20Markdown\x20的斜体语法，即用星号将那段文字包裹起来，例如：`*这到底是怎么回事？*\x20我心里一惊。`\x0a3.\x20\x20**【禁止】**:\x20绝对禁止在\x20`content`\x20字段中出现\x20\x22dialogue\x22\x20或\x20\x22description\x22\x20这两个词。\x0a\x0a#\x20【其他核心规则】\x0a1.\x20\x20**叙事视角**:\x20叙述人称【必须】严格遵循“预设”中的第一人称、第二人称或第三人称规定。\x0a2.\x20\x20**字数要求**:\x20你生成的\x20`content`\x20总内容应在\x20**','\x0a\x0a#\x20你的商店\x20(你可以为用户购买礼物):\x0a','async','https://i.postimg.cc/PqYp5T5M/image.png','load-more-btn','你拍了拍\x20“','cart-total','syncCharacterAvatarInGroups:\x20传入的不是有效的单聊对象，已跳过同步。','&nbsp;','</td><td\x20class=\x22item-subtotal\x22>¥','currentPlayer','product-category-select','猎人带走了\x20','压缩步骤\x201/3:\x20正在从数据库读取所有相关数据...','\x0a#\x20群成员列表\x20(你的总结目标)\x0a','quality','选中的表情已成功删除。','hasShown10','douban-post-item','(无内容)','remove-cphone-bg-btn','frameUrl','请输入新的背景图片链接','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x22>这次通话没有留下文字记录。</p>','清空聊天记录','\x22,\x20\x22x\x22:\x20(0-14),\x20\x22y\x22:\x20(0-14)}`\x0a-\x20\x20\x20**送礼物**:\x20`{\x22type\x22:\x20\x22gift\x22,\x20\x22itemName\x22:\x20\x22礼物名称\x22,\x20\x22itemPrice\x22:\x20价格(数字),\x20\x22reason\x22:\x20\x22送这个礼物的原因\x22,\x20\x22image_prompt\x22:\x20\x22生成礼物图片的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22}`\x0a-\x20\x20\x20**为用户点外卖**:\x20\x20`{\x22type\x22:\x20\x22waimai_order\x22,\x20\x22productInfo\x22:\x20\x22商品名\x22,\x20\x22amount\x22:\x20价格,\x20\x22greeting\x22:\x20\x22你想说的话\x22}\x20`(你主动为用户点外卖时使用)\x0a\x0a现在，请根据以上规则和下面的对话历史，继续进行对话。','https://i.postimg.cc/9fQZ425b/IMG-5975.gif','确定要拉黑“','offlineMaxLength','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22cart-item-checkbox\x22\x20data-id=\x22','share-link-btn','qzone_delete_post','accept_transfer','”的对话中分享过来的。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的任务：请你阅读并理解下面的对话内容。在接下来的回复中，你可以像真人一样，对这段对话的内容自然地发表你的看法、感受或疑问。\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20[分享的聊天记录开始]\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','member-avatar-input','keys','add-ai-avatar-batch-btn','\x22\x20发布了动态','https://i.postimg.cc/wx72fhr2/IMG-5968.gif','unreadCount','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-waveform\x22>','清空动态时发生错误:\x20','cphone-wallpaper-preview','version','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quantity-btn\x20increase-qty-btn\x22\x20data-id=\x22','zIndex','actionCooldownMinutes','lyrics-btn','album-grid-page','旁观模式推进剧情失败:','call-history-screen','custom-modal-title','drawImage','元,\x20备注:\x20',');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**可用播放列表**:\x20[','#delete-world-books-list\x20.clear-posts-item.selected','secondary-proxy-url','ephone','推进剧情失败:','https://files.catbox.moe/r5heyt.gif','import_card','</span><span\x20class=\x22gift-preview-quantity\x22>x','<span\x20style=\x22color:\x20red;\x22>已关闭</span>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','在导演模式保存时，遇到了未知的AI指令类型:','】。\x0a\x20\x20\x20\x20-\x20\x20\x20在对话中，你可以根据人设和关系，自由使用角色的【群昵称】或【本名】进行称呼。\x0a\x20\x20\x20\x20-\x20\x20\x20严禁生成\x20\x27name\x27\x20字段为\x20\x22','\x0a\x20\x20\x20\x20-\x20**音乐**:\x20','\x22>词</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心新增】在这里添加“背景”按钮\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20bg-btn\x22\x20data-index=\x22','更换歌曲背景','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22></div>','小时核心议题','导入成功！','导演/编辑模式保存(Sticker):\x20提供了\x20meaning\x20但未找到对应表情:','blockCooldownHours','.info','</span>\x20:\x20<span>','prophet','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22diary-title\x22>','is-voice-message','来源网站','totalPages','为角色\x20\x22','-\x20**当前时间**:\x20','添加完成！\x0a\x0a成功添加\x20','搜索歌曲','\x20首歌曲的详细信息...','char-article-title','（可选）输入后缀','personality','#\x20【【【群名修改铁律】】】\x0a在修改群名时，新的群名【绝对不能】与以下任何一个群成员的名字完全相同：[','”发送的、尚未领完的红包（时间戳:\x20','\x0a#\x20【【【群公告\x20(最高优先级规则)】】】\x0a你【必须】阅读、理解并严格遵守以下所有公告，它们凌驾于你的人设之上。\x0a','</span></div>','gomoku_move','”的投票(时间戳:\x20','操作失败:\x20','选择要精炼记忆的角色','reading-window','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>你还没有创建任何相册哦~</p>','退款给\x20',':generateContent?key=','无法生成新回复:\x20','AI返回了空内容或未知格式。','”</i></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22accept-friend-btn\x22\x20class=\x22lock-action-btn\x22>接受</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22reject-friend-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22>拒绝</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','url(','来自\x20','add-ai-avatar-url-btn','\x20(图片描述:\x20“','你是狼人，请选择刀人目标。','🌐\x20使用网络URL','（你目前没有绑定的NPC伙伴，可以自由创造新的NPC。）\x0a','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-content\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22poll-option-input\x22\x20placeholder=\x22选项内容...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-option-btn\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','visibleGroupIds','selected','style','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-time\x22>','\x22\x20被唤醒，准备独立行动...','✅\x20清理完成！\x0a\x0a','https://i.postimg.cc/g2PfbSFm/IMG-6556.gif','<div\x20class=\x22waimai-card\x22><div\x20class=\x22waimai-header\x22><img\x20src=\x22https://files.catbox.moe/mq179k.png\x22\x20class=\x22icon\x22\x20alt=\x22Meituan\x20Icon\x22><div\x20class=\x22title-group\x22><span\x20class=\x22brand\x22>美团外卖</span><span\x20class=\x22separator\x22>|</span><span>外卖美食</span></div></div><div\x20class=\x22waimai-catchphrase\x22>Hi，你和我的距离只差一顿外卖～</div><div\x20class=\x22waimai-main\x22><div\x20class=\x22request-title\x22>','-\x20\x20\x20**NovelAI真实图片分享\x20(在聊天中直接发送)**:\x20`{\x22type\x22:\x20\x22naiimag\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20\x0a\x20\x20\x20\x20-\x20**【绝不能暴露是novelai生成的图片！】\x0a\x20\x20\x20\x20-\x20**【重要】关于prompt的撰写**：\x0a\x20\x20\x20\x20\x20\x20*\x20禁止暴露这是novelai生成的图片！\x0a\x20\x20\x20\x20\x20\x20*\x20你可以根据当前对话上下文、你的角色人设、或你想表达的情感和氛围，来撰写可能详细而具体的prompt。\x0a\x20\x20\x20\x20\x20\x20*\x20例如：不要只写\x20\x22a\x20girl\x22，而是可以写\x20\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22但需要注意，绝对不可以抄袭模仿这段prompt！你必须有自己的创意和想法！\x0a\x20\x20\x20\x20\x20\x20*\x20prompt的详细程度由你根据具体情况自己决定：如果场景简单或只是随意分享，可以简短一些；如果是重要时刻或想表达特定情感，可以尽可能详细描述。这不是强制的，完全取决于你当时的需求。\x0a\x20\x20\x20\x20\x20\x20*\x20专注于描述内容本身即可。\x0a\x20\x20\x20\x20-\x20使用场景：当你想要在【私聊对话中】直接给用户发送一张图片时使用。\x0a\x20\x20\x20\x20-\x20不要频繁使用，只在真正想分享图片的时候使用。\x0a\x20\x20\x20\x20-\x20注意：这会直接在聊天记录中显示图片，而不是发布到动态。','删除\x20(0)','witch-do-nothing-btn','正在开始清理冗余数据，请不要关闭页面...','文件格式无法识别。请确保您选择的是有效的\x20EPhone\x20世界书备份或\x20Tavern\x20AI\x20世界书文件。','小时前聊过。','\x0a#\x20长期记忆\x20(所有角色必须严格遵守)\x0a','chatLinks','最近\x2020\x20条','生成成功！','import-single-chat-input','导演/编辑模式保存(Sticker):\x20将\x20content\x20视为\x20URL，查找到\x20meaning:','preview-font-style','is-sticker','time-zone-search-input','https://i.postimg.cc/bNdk33SN/IMG-4893.gif','https://i.postimg.cc/tTWKKmTN/IMG-7073.gif','werewolf-role-name','\x20发送了一张图片，图片内容描述为：\x27','.message-wrapper','getBoundingClientRect','absolute','UTF-8\x20解码失败，将尝试\x20GBK\x20(ANSI)\x20解码...','translateX(-50%)','✅\x20图片显示成功！🎨','请AI角色们继续进行讨论。','data-clear-char-list','通话记录已成功总结并存入角色“','#\x20长期记忆\x20(最高优先级，这是你和用户之间已经确立的事实，必须严格遵守)\x0a','prev-page-btn','sticker-category-tabs','https://files.catbox.moe/','recipientName','date-separator','\x0a-\x20**角色人设**:\x20','fontSize','请先选择要添加的歌曲。','contactType','这将从历史记录中【永久抹除】这\x20','<span\x20style=\x22color:\x20#ff8c00;\x22>[好友申请]\x20','删除\x20(','music-time-counter','wait-reply-btn','\x0a\x0a#\x20当前情景\x0a-\x20**当前真实时间**:\x20','werewolf-kill-selection-list','导演模式保存了一个无效的五子棋移动指令:','++id,\x20chatId,\x20timestamp,\x20customName','#e4b591','无法解析角色卡文件。\x0a错误:\x20','无法生成备忘录，请检查API配置或稍后再试。\x0a错误:\x20','，人设:\x20','.unread-count','20px','offline-mode-options','showRedPacketDetails收到了无效的packet对象','get','set','days','select-all-frames-checkbox','请先进入一个聊天页面，再返回购物中心进行生成，以便AI了解要为哪个角色生成商品。','werewolf-','char-music-prev-btn','》设定\x20(你可以将其中角色作为聊天对象):\x0a','export-data-btn','shopping-action-bar','bookId','\x22>...</div>','has-frame','api-temperature-slider','member-management-item','\x22,\x20\x22postId\x22:\x20456,\x22stickerMeaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}]`\x0a\x20\x20\x20\x20-\x20\x20\x20回复:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','taobao','正在执行删除操作...','你们正在一起读书。','hiddenContent','char-taobao-screen','确定要从你的头像库中删除“','\x22\x20data-poll-timestamp=\x22','对方已拒收','https://i.postimg.cc/VkXngG72/mmexport1751031208329.gif','https://i.postimg.cc/Kv51tW5H/IMG-6147.gif','parentNode','\x20\x0a-\x20**你最近和“','\x0a#\x20核心任务：群聊剧本作家\x0a你是一个剧本作家，负责创作一个名为“','\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','change_avatar','ai-persona','AI女巫决定保留解药。','purchases','请稍候','++id,\x20name','charCodeAt','.photo-delete-btn','currentText','\x22\x20创建了一个新约定:','-\x20**时间**:\x20你必须感知到当前是\x20','删除预设','操作失败，未能生成长期记忆。\x0a\x0a错误详情:\x20','[系统提示：用户打开了五子棋棋盘，游戏开始了。]','诊断：在\x20data.extensions.character_book\x20中找到世界书。','AI返回的change_music指令中，歌曲名无效或缺失:','normal','确认生成','.battery-text','.char-screen','linear-gradient(135deg,\x20#f6d365,\x20#fda085)','main','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','createdAt','change','change_user_avatar','\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','https://i.postimg.cc/9XPwWmwy/IMB-Kf7um-P.gif','locationName','tables','time-zone-group','delete-selected-products-btn','</td><td\x20class=\x22item-price\x22>¥','my-nickname-input','阵营胜利！','stickerCategoryIds','add-new-sticker-category-btn','save','Response\x20status:','save-api-preset-btn','.gift-card','\x20领取了\x20','\x20\x20\x20负面:','contact-picker-list','全部记忆\x20(','\x20转账\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你们最后的对话摘要**:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此款式\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20grid;\x20grid-template-columns:\x201fr\x201fr;\x20gap:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>款式名称</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22variation-name-input\x22\x20placeholder=\x22例如:\x20红色\x22\x20value=\x22','getUint32','character-profile-modal','post-visibility-groups','recipients','primaryKeys','设置精炼字数','maxWidth','qzone-banner-container','删除记录','<div\x20class=\x22avatar-group\x20has-frame\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><div\x20class=\x22avatar-with-frame\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><img\x20src=\x22','++id,\x20timestamp','*对方按下了接听键...*','歌曲查找失败:\x20AI请求的歌曲名\x22','生成购物中心商品失败:','使用解药救TA','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-artist\x22>','pat_user','read-together-btn','items','&id,\x20name,\x20categoryId','px))','》\x0a-\x20**发帖人**:\x20','歌曲信息','product-variations-container','minimaxVoiceId','\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','shared-history-viewer-modal','\x0a#\x20可用表情包\x0a','swipeDirection','无法访问剪贴板。','CELL_SIZE','back-to-clear-step1-btn','https://i.postimg.cc/RVt6sRzc/IMG-6939.gif','werewolf-log','-\x20**','delete-current-category-btn','\x20向\x20','通话中，','splice','链接分享','qzoneSettings','numeric','participant-avatar-wrapper','endsWith','single-char-background-activity-group','.entry-enabled-switch','更换图标','product-category-manager-modal','[系统提示：用户刚刚发布了一条动态(ID:\x20','\x22\x20中发现并修复了旧红包数据。','rule-editor-modal','进入投票','toLocaleString','\x22\x20class=\x22product-image\x22>','hasOwnProperty','\x0a#\x20世界观设定\x20(必须参考)\x0a','associatedWith','.music-player-window','renderWorldBookScreenProxy','order','imageDescription','page-indicator','backgroundColor','confirm-witch-poison-btn','**\x20(本名:\x20','shopping-settings-modal','」听歌。要结束并开始和「','\x20的外卖订单支付了\x20','在此修改内容...','QQ音乐搜索API失败:','）刚刚撤回了一条消息。撤回前的内容是：','还没有人','.world-book-group-content','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你是一个群聊视频通话的导演。你的任务是扮演所有【除了用户以外】的AI角色，并以【第三人称旁观视角】来描述他们在通话中的所有动作和语言。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【【【身份铁律】】】**:\x20用户的身份是【','https://i.postimg.cc/k5Gs0K47/IMG-6567.gif','[这是你上一轮的内心独白和思考]\x0a-\x20心声:\x20','原始消息已删除或不存在','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>','renderApiSettingsProxy','API设置','Sticker','sender-name','add-preset-entry-btn','\x20的礼物','</span></div><div\x20class=\x22rp-type\x22>',']\x0a\x20\x20\x20\x20\x20\x20\x20\x20','pending_user_approval','checkout-btn','已恢复默认字体。','编辑记忆','</strong></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','isPlaying','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>没有可以删除的世界书。</p>','character_book','https://i.postimg.cc/76Tj3g1B/IMG-4425.gif','typing-status','正在重试\x22','\x20行格式不正确，已被忽略。','chat-lock-overlay','bubble_theme','”下，回复了\x27','名为\x20“','\x20分享了Ta的位置：\x27','请输入有效的金额！','download','\x0a##\x20世界书《','werewolf-player-selection-list','\x20的动态\x20','\x0a#\x20用户的角色\x0a-\x20**','为了确保所有数据同步，建议立即刷新页面。','</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20冷静期是否结束:\x20','这是模拟对话，无法发送消息哦~','isClick','请输入新的名称（留空则恢复默认）','确定要将选中的商品作为礼物送出吗？','\x20你应该像它们从未存在过一样继续对话，并相应地调整你的记忆和行为，不要再提及这些被删除的内容。','。你可以使用\x20\x27vote\x27\x20指令参与投票。]','https://i.postimg.cc/pT2xKzPz/album-cover-placeholder.png','prompts','\x0a**内容:**\x0a','\x0a-\x20**身份**:\x20','custom-modal-overlay','my-avatar-group','外观设置','发送照片','padEnd','[图片]','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22author\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【内容禁忌】\x0a\x20\x20\x20\x20\x20\x20\x20\x20为了保持新鲜感，你本次的行动【绝对不能】再发布以下或类似主题的内容：\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x22\x20title=\x22移出群聊\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','secondaryModel','https://i.postimg.cc/W40f9qtd/IMG-7098.gif','quote-message-btn','https://i.postimg.cc/LXyyqDbY/IMG-6294.gif','product-image-preview','ai-response-editor-container','\x22\x20class=\x22chat-image\x22>','cancel-npc-editor-btn','sampler',')\x20的棋步。','[系统提示：你接受了“','\x20\x20-\x20在群聊“','aiPersona','update-notice-body','https://i.postimg.cc/8PsK20jQ/IMG-7236.gif','确认删除分类','text/event-stream','products','https://i.postimg.cc/htZppbS4/IMG-7107.gif','gomoku-board','...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','\x20(用户)</span>\x0a\x20\x20\x20\x20','.png','stroke','save-font-btn','https://i.postimg.cc/xCqqKGRN/IMG-6929.gif','\x20[包含','ai-avatar-library-modal','file','close-category-manager-btn','棋盘状态\x20(1是你(黑棋),\x202是AI(白棋)):\x0a','<input\x20type=\x22checkbox\x22\x20name=\x22visibility_group\x22\x20value=\x22','wolfKill','https://i.postimg.cc/gj3Tmqz5/mmexport1751030241029.gif','findIndex','favorite','lyrics-horizontal-pos','&times;','data-clear-wizard-modal','lyricsPosition','专辑封面已更新！','uc_preset','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>','尝试打开一个不存在的世界书，ID:','未选择书籍','[系统提示：你拒绝并退还了“','</div><div\x20class=\x22receipt-footer\x22>感谢您的惠顾，欢迎再次光临！</div>','\x20的所有动态，且无法恢复！','正在开始全面压缩图片，根据图片数量，这可能需要几分钟时间，请不要关闭或刷新页面...','本日核心议题','<option\x20value=\x22','AI返回的内容中未找到有效的JSON对象。','seed','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2020px;\x22>还没有内容，点击下方按钮添加第一条吧！</p>','regenerate-char-browser-btn','无法生成模拟相册，请检查API配置或稍后再试。\x0a错误:\x20','\x27>引用</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','rule-chat-id-select','group','edit-message-btn','syncCharacterNameInGroups:\x20传入的不是有效的单聊对象，已跳过同步。','iVBORw0KGgo','”，并根据其人设、记忆和最近的互动，虚构出【10到20条】TA最近的浏览器搜索/浏览记录。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20记录必须完全符合角色的性格、爱好、职业和生活环境。\x0a2.\x20\x20**多样性**:\x20记录类型要丰富，可以是帖子、文章、新闻、问答等。\x0a3.\x20\x20**【格式\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都代表一条浏览记录，并且【必须】使用以下格式:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22text\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22一个引人注目的文章或搜索标题\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22url\x22:\x20\x22一个虚构的、看起来很真实的网址\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22一篇200-400字的、详细的文章或帖子正文，支持换行符\x5cn。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20**【绝对禁止】**:\x20你的回复中【绝对不能】包含\x20\x22type\x22:\x20\x22image\x22\x20的对象。所有记录都必须是文字内容。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','\x22\x20转发了动态\x20#','blockedTimestamp','manage-frames-btn','加载更早的会话','确定要删除这条渲染规则吗？','char-browser-screen','NovelAI设置已保存！','showScreen','nai-test-status','long','请输入Ta的【本名】(例如:\x20李星辰，这个名字将用于AI识别)','编辑对方状态','some','waimai-amount','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','variation-product-image','rp-group-greeting','...\x22\x0a\x20\x20\x20\x20#一起读书模式\x20|\x20行为铁律\x0a\x20\x20\x20\x201.\x20\x20**角色定位**:\x20你【不是】书中的任何角色，你是【你自己】(','setHours','AI\x20尝试赠送一个格式不正确的随机礼物:','douban-detail-comments-list','提示词配置','发来了\x20','<span>','post-use-url-btn','群里还没有任何消息。','\x0a#\x20你的内心独白\x20(上一轮的思考，仅你自己可见)\x0a-\x20心声:\x20','announcement-board-content','product-name-input','char-main-date','.entry-keys-input','npcId','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-group-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x0aAI原始返回内容:\x0a','char-album-screen','我已了解风险，确认压缩','旧版备份数据写入数据库失败:\x20','offline_text','API设置不完整，无法继续。','预言家','replyToName','正在读取并解析备份文件...','https://i.postimg.cc/NFS4ZyvM/mmexport1751032686953.gif','.call-message-bubble[data-timestamp=\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','songJson','novelai-generated-','is-location-share','close-rp-details-btn','<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22','char-qq-transcript-modal','####\x20','。请你对此作出回应。]','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在扮演一个名为\x22','doubanMinPosts','标题是必填项哦！','AI返回的数据不是一个数组。原始返回:\x20','<label><input\x20type=\x22checkbox\x22\x20value=\x22user\x22>\x20','strokeStyle','\x0a-\x20**讨论摘要**:\x20\x0a','上传成功！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22timestamp\x22>','5px','list-item','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','apiPresets','https://api.vkeys.cn/v2/music/netease/lyric?id=','\x20(角色)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','char-music-player-title','，礼物是：','https://i.postimg.cc/4yCXW52F/mmexport1751030908335.gif','chat-list-item','\x22\x20class=\x22sticker-image\x22>','\x22(处理后为\x22','Response\x20headers:','https://i.postimg.cc/P5zLh5JJ/IMG-6942.gif','apply','请根据你的设定，生成你的歌单。','#message-editor-container\x20textarea','\x20本世界书','https://generativelanguage.googleapis.com/v1beta/models/','\x22操作...',')\x20拒绝了\x20','albumId','.comment-input','维基百科','\x22\x20(由\x20','messageTimestamp','https://i.postimg.cc/VkKjzYTK/IMB-f4kk-CT.gif','accept-friend-btn','textarea','\x27>图片动态</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','copy-timestamp-btn','\x20天\x20---','group-members-settings','message-editor-block','表情包分类绑定已更新！','在导演模式保存时，发现无效的指令对象，已跳过:','group-avatar-library-title','.voice-transcript','switch-greeting-group','收到数据，类型:','###\x20你的秘密信息\x20(此部分只有你作为AI导演能看到)\x0a','customCss','activeBookId','文件格式无法识别。请确保您选择的是有效的\x20EPhone\x20备份文件。','请至少输入2个有效的投票选项！','create-new-member-btn','[系统提示：用户(','-\x20你的狼队友是：','删除商品','.share-target-checkbox:checked','创建群聊至少需要选择2个联系人。','&id,\x20minimaxGroupId,\x20minimaxApiKey','你有一瓶解药和一瓶毒药，解药可以救活当晚被杀的玩家，毒药可以毒死任意一名玩家。','char-music-list','hours','用户(','++id,\x20chatId,\x20timestamp,\x20type,\x20targetDate','我拒绝了你的视频通话请求。',')\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>','timestamp','CPhone\x20QQ模拟记录生成\x20和\x20主聊天推进\x20已同时完成。','为NPC\x20\x22','currentIndex','\x22\x20class=\x22avatar-img\x22\x20style=\x22border-radius:\x2050%;\x22><img\x20src=\x22','novelai-switch','从角色卡导入\x20(.json/.png)','https://i.postimg.cc/gkk7s0vD/IMG-6984.gif','文件格式不正确，缺少关键的外观设置项。','bg-clear','nai-generate-btn','对方正在输入...','\x20获胜。也就是说，','danger-option','#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a','paste','[收到一个外卖代付请求]','保存CSS预设','\x22]\x20.participant-avatar','accept-call-btn','is-transfer','black','\x20条)','命名头像','[系统提示：用户拒绝了通话邀请，但你们可以自己开始。请你们各自决策是否加入。]','这个角色没有可用的备选开场白。','getWriter','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22','forEach','naiSettings','https://i.postimg.cc/Pq2xJN1g/IMG-7301.jpg','startTime','thoughts','thoughts-history-list','.countdown-card\x20.timer','chat-list-action-pin','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','realimag','[图片内容:\x20','call-message-bubble\x20user-speech','appIcons','导演/编辑模式保存(Sticker):\x20使用了\x20URL，最终\x20meaning:','已拒收对方转账','\x20发布)\x0a','https://i.postimg.cc/hj4dkrvj/IMG-5578.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','即将开始下载您的完整备份文件。下载过程中请勿关闭页面。','bg-input','\x0a#\x20你的任务\x0a你是一个虚拟的、极具创造力的商品规划师。你的任务是为下面的角色“','char-music-mode-btn','char-music-cover','\x22\x20已经存在了！','now','myPersona','vote_for_name','4.\x20\x20**情景感知**:\x20你的对话【必须】自然地体现出对当前时间\x20(','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','regenerate-char-diary-btn','\x0a#\x20【【【行为倾向指令\x20(高优先级)】】】\x0a**你最近已经发布过动态了。**\x20为了让社区互动更自然，你本次行动的【首要任务】应该是去**评论**或**回复**下面“待处理的帖子列表”中的内容。\x0a你【应该避免】再次发布新动态，除非你有一个非常紧急或绝佳的新想法。\x0a','\x20(这是TA的昵称)\x0a-\x20**本名\x20(你在对话中必须用这个名字称呼TA)**:\x20','openCharWallet','cfg_scale','转发了\x20@','\x22）。你已经有一段时间没有和用户（','生成图像','likes','...\x22):\x20','\x0a#\x20对话者的角色设定\x0a','claimedBy','找不到原始消息。可能已被删除或位于更早的历史记录中。','导入歌词','setDate','world-book-tab','\x22\x20决定去发一条动态...\x20(此处为模拟)','</div></div>','点击处理'];_0x4fec=function(){return _0x40f764;};return _0x4fec();}!Array['prototype']['findLastIndex']&&Object[_0x1ff2a0(0xaa1)](Array[_0x1ff2a0(0xa0c)],_0x1ff2a0(0x1c8),{'value':function(_0xb12ca0){const _0x1e9823=_0x1ff2a0;if(this==null)throw new TypeError('Cannot\x20read\x20property\x20\x27findLastIndex\x27\x20of\x20null\x20or\x20undefined');if(typeof _0xb12ca0!==_0x1e9823(0x134e))throw new TypeError('predicate\x20must\x20be\x20a\x20function');let _0xa686f0=Object(this),_0x486f4f=_0xa686f0[_0x1e9823(0x990)]>>>0x0,_0x14d8e3=arguments[0x1],_0x14899b=_0x486f4f-0x1;while(_0x14899b>=0x0){let _0x11f3e2=_0xa686f0[_0x14899b];if(_0xb12ca0[_0x1e9823(0xa4c)](_0x14d8e3,_0x11f3e2,_0x14899b,_0xa686f0))return _0x14899b;_0x14899b--;}return-0x1;},'configurable':!![],'writable':!![]});let activeMessageTimestamp=null,activeTransferTimestamp=null,lastRawAiResponse='',lastResponseTimestamps=[],currentQzoneReplyContext=null,editingNpcId=null;const GEMINI_API_URL=_0x1ff2a0(0x199);function getRandomValue(_0x2c10a3){const _0x1cb7d7=_0x1ff2a0;if(_0x2c10a3[_0x1cb7d7(0x44f)](',')){const _0x212e3b=_0x2c10a3[_0x1cb7d7(0x53e)](',')[_0x1cb7d7(0x2e1)](_0x199f59=>_0x199f59[_0x1cb7d7(0x9c1)]()),_0x265585=Math[_0x1cb7d7(0xd71)](Math[_0x1cb7d7(0x103a)]()*_0x212e3b[_0x1cb7d7(0x990)]);return _0x212e3b[_0x265585];}return _0x2c10a3;}function isImage(_0x4b020e){const _0x1d6e05=_0x1ff2a0;if(_0x4b020e['image_url']&&_0x4b020e[_0x1d6e05(0x1e8)]['url']){let _0x17fee4=_0x4b020e[_0x1d6e05(0x1e8)]['url'];const _0x4511f0=_0x17fee4['split'](',')[0x1],_0x49b4b0=_0x17fee4[_0x1d6e05(0xab4)](/^data:(.*);base64/)[0x1];return[{'text':_0x1d6e05(0x529)},{'inline_data':{'mime_type':_0x49b4b0,'data':_0x4511f0}}];}return[];}function _0x6666(_0x428853,_0xb9af67){const _0x4fecce=_0x4fec();return _0x6666=function(_0x66660c,_0x4b20d5){_0x66660c=_0x66660c-0x17f;let _0x2ecd5b=_0x4fecce[_0x66660c];return _0x2ecd5b;},_0x6666(_0x428853,_0xb9af67);}function getGeminiResponseText(_0x16b8fb){const _0x1057d4=_0x1ff2a0;if(_0x16b8fb[_0x1057d4(0xd5c)]&&Array[_0x1057d4(0x285)](_0x16b8fb[_0x1057d4(0xd5c)])&&_0x16b8fb[_0x1057d4(0xd5c)][_0x1057d4(0x990)]>0x0&&_0x16b8fb['choices'][0x0][_0x1057d4(0x757)]&&_0x16b8fb[_0x1057d4(0xd5c)][0x0][_0x1057d4(0x757)][_0x1057d4(0xac4)])return _0x16b8fb[_0x1057d4(0xd5c)][0x0]['message'][_0x1057d4(0xac4)];if(_0x16b8fb[_0x1057d4(0x5a4)]&&Array['isArray'](_0x16b8fb[_0x1057d4(0x5a4)])&&_0x16b8fb[_0x1057d4(0x5a4)][_0x1057d4(0x990)]>0x0&&_0x16b8fb[_0x1057d4(0x5a4)][0x0][_0x1057d4(0xac4)]&&_0x16b8fb[_0x1057d4(0x5a4)][0x0]['content'][_0x1057d4(0xa53)])return _0x16b8fb[_0x1057d4(0x5a4)][0x0][_0x1057d4(0xac4)][_0x1057d4(0xa53)][0x0][_0x1057d4(0x56d)];console[_0x1057d4(0xe3b)]('Gemini\x20API返回了非预期的格式:',_0x16b8fb);let _0x15fc59=_0x1057d4(0x10d0);if(_0x16b8fb[_0x1057d4(0x5a4)]&&Array[_0x1057d4(0x285)](_0x16b8fb[_0x1057d4(0x5a4)])&&_0x16b8fb[_0x1057d4(0x5a4)][_0x1057d4(0x990)]>0x0&&_0x16b8fb[_0x1057d4(0x5a4)][0x0][_0x1057d4(0x40d)]===_0x1057d4(0x361)){const _0x2072dd=_0x16b8fb['candidates'][0x0][_0x1057d4(0xb66)],_0x1ec0b1=_0x2072dd[_0x1057d4(0x85d)](_0x3a4556=>_0x3a4556[_0x1057d4(0xc45)]!==_0x1057d4(0x13d1)&&_0x3a4556[_0x1057d4(0xc45)]!==_0x1057d4(0x1bd))[_0x1057d4(0x2e1)](_0x5337b1=>_0x5337b1[_0x1057d4(0x76d)]+_0x1057d4(0x36b)+_0x5337b1[_0x1057d4(0xc45)]+')')[_0x1057d4(0x35d)](',\x20');_0x15fc59=_0x1057d4(0xaee)+(_0x1ec0b1||'未知');}else{if(_0x16b8fb[_0x1057d4(0xe74)]?.['blockReason']){const _0x4de751=_0x16b8fb['promptFeedback'][_0x1057d4(0x806)],_0x318208=_0x16b8fb[_0x1057d4(0xe74)][_0x1057d4(0xb66)]?.[_0x1057d4(0x2e1)](_0x174818=>_0x174818[_0x1057d4(0x76d)]+':\x20'+_0x174818[_0x1057d4(0xc45)])[_0x1057d4(0x35d)](',\x20');_0x15fc59=_0x1057d4(0xf3c)+_0x4de751+_0x1057d4(0x9f9)+(_0x318208||'无');}else _0x16b8fb[_0x1057d4(0xe3b)]&&(_0x15fc59='API错误:\x20'+_0x16b8fb['error'][_0x1057d4(0x757)]);}throw new Error(_0x15fc59);}document['addEventListener'](_0x1ff2a0(0x413),()=>{const _0x85c4bf=_0x1ff2a0;document[_0x85c4bf(0xa75)](_0x85c4bf(0x743),()=>{const _0x6c7d3a=_0x85c4bf;document['visibilityState']===_0x6c7d3a(0x45a)&&(console[_0x6c7d3a(0x90f)](_0x6c7d3a(0x1a9)),navigator[_0x6c7d3a(0xcc9)][_0x6c7d3a(0x650)][_0x6c7d3a(0x13d8)](_0x414ec8=>{const _0x55f30d=_0x6c7d3a;_0x414ec8[_0x55f30d(0xeb2)]();}));});function _0x19a701(_0x17fad0,_0x412e5b,_0x19d043,_0x46eada){const _0x2478d0=_0x85c4bf,_0xd05b32=_0x505390['globalSettings'][_0x2478d0(0x398)]||0.8,_0x59770d={'user':_0x2478d0(0x4c5),'assistant':'model','system':_0x2478d0(0x4c5)},_0x432e74=[{'role':'user','parts':[{'text':_0x19d043}]},{'role':_0x2478d0(0xc42),'parts':[{'text':_0x2478d0(0xc8c)}]},..._0x46eada['map'](_0x592758=>{const _0x4628a9=_0x2478d0,_0xca9681=[];return Array[_0x4628a9(0x285)](_0x592758[_0x4628a9(0xac4)])?_0x592758[_0x4628a9(0xac4)][_0x4628a9(0x12be)](_0x1db24b=>{const _0x508ae8=_0x4628a9;if(_0x1db24b[_0x508ae8(0x858)]===_0x508ae8(0x56d))_0xca9681[_0x508ae8(0x1a0)]({'text':_0x1db24b[_0x508ae8(0x56d)]});else{if(_0x1db24b['type']===_0x508ae8(0x1e8)&&_0x1db24b[_0x508ae8(0x1e8)]&&_0x1db24b[_0x508ae8(0x1e8)]['url']){const _0x3a3086=_0x1db24b['image_url']['url'],_0x376e89=_0x3a3086['split'](',')[0x1],_0x40d353=_0x3a3086[_0x508ae8(0xab4)](/^data:(.*);base64/);_0x40d353&&_0x376e89&&_0xca9681[_0x508ae8(0x1a0)]({'inline_data':{'mime_type':_0x40d353[0x1],'data':_0x376e89}});}}}):_0xca9681[_0x4628a9(0x1a0)]({'text':String(_0x592758[_0x4628a9(0xac4)])}),{'role':_0x59770d[_0x592758[_0x4628a9(0x508)]],'parts':_0xca9681};})];return{'url':_0x2478d0(0x1279)+_0x17fad0+_0x2478d0(0x10ce)+getRandomValue(_0x412e5b),'data':{'method':'POST','headers':{'Content-Type':_0x2478d0(0xcb5)},'body':JSON[_0x2478d0(0x1308)]({'contents':_0x432e74,'generationConfig':{'temperature':_0xd05b32}})}};}const _0xb81d4e=new Dexie(_0x85c4bf(0x26e)),_0x53854d=[{'id':_0x85c4bf(0xff8),'url':'','name':'无'},{'id':_0x85c4bf(0x4a4),'url':_0x85c4bf(0x272),'name':'1'},{'id':_0x85c4bf(0xafe),'url':_0x85c4bf(0x540),'name':'2'},{'id':_0x85c4bf(0x2bd),'url':_0x85c4bf(0xe96),'name':'3'},{'id':_0x85c4bf(0xde2),'url':_0x85c4bf(0x2e4),'name':'4'},{'id':_0x85c4bf(0x847),'url':_0x85c4bf(0x64d),'name':'5'},{'id':'frame_6','url':_0x85c4bf(0x957),'name':'6'},{'id':_0x85c4bf(0xd54),'url':_0x85c4bf(0x9fa),'name':'7'},{'id':_0x85c4bf(0xf35),'url':_0x85c4bf(0xe80),'name':'8'},{'id':_0x85c4bf(0x1053),'url':_0x85c4bf(0x79d),'name':'9'},{'id':_0x85c4bf(0x523),'url':_0x85c4bf(0x77f),'name':'10'},{'id':_0x85c4bf(0xa8d),'url':_0x85c4bf(0xe8c),'name':'11'},{'id':_0x85c4bf(0xc70),'url':_0x85c4bf(0x9a3),'name':'12'},{'id':'frame_13','url':_0x85c4bf(0x4f4),'name':'13'},{'id':_0x85c4bf(0xf59),'url':'https://i.postimg.cc/fRt2SFSn/IMG-4368.gif','name':'14'},{'id':_0x85c4bf(0x4a4),'url':'https://i.postimg.cc/kGgwJhPH/IMG-4374.gif','name':'1'},{'id':_0x85c4bf(0xafe),'url':'https://i.postimg.cc/PrcKH436/IMG-4376.gif','name':'2'},{'id':_0x85c4bf(0x2bd),'url':'https://i.postimg.cc/fRV86FMq/IMG-4381.gif','name':'3'},{'id':'frame_tech','url':_0x85c4bf(0xa83),'name':'4'},{'id':_0x85c4bf(0x847),'url':_0x85c4bf(0x2b2),'name':'5'},{'id':_0x85c4bf(0x105f),'url':_0x85c4bf(0xe36),'name':'6'},{'id':_0x85c4bf(0xd54),'url':_0x85c4bf(0x3d8),'name':'7'},{'id':_0x85c4bf(0xf35),'url':_0x85c4bf(0xe57),'name':'8'},{'id':_0x85c4bf(0x1053),'url':_0x85c4bf(0x1b7),'name':'9'},{'id':_0x85c4bf(0x523),'url':_0x85c4bf(0x1374),'name':'10'},{'id':'frame_11','url':'https://i.postimg.cc/Cx9vCVWH/IMG-4395.gif','name':'11'},{'id':_0x85c4bf(0xc70),'url':_0x85c4bf(0x5bc),'name':'12'},{'id':_0x85c4bf(0xb6f),'url':_0x85c4bf(0xc84),'name':'13'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x1ac),'name':'14'},{'id':_0x85c4bf(0x4a4),'url':_0x85c4bf(0xbf9),'name':'1'},{'id':_0x85c4bf(0xafe),'url':'https://i.postimg.cc/59Cn1tkB/IMG-4401.gif','name':'2'},{'id':_0x85c4bf(0x2bd),'url':_0x85c4bf(0xf87),'name':'3'},{'id':_0x85c4bf(0xde2),'url':_0x85c4bf(0xe25),'name':'4'},{'id':_0x85c4bf(0x847),'url':_0x85c4bf(0x5c7),'name':'5'},{'id':_0x85c4bf(0x105f),'url':_0x85c4bf(0xdd5),'name':'6'},{'id':_0x85c4bf(0xd54),'url':_0x85c4bf(0x44a),'name':'7'},{'id':_0x85c4bf(0xf35),'url':_0x85c4bf(0xa5e),'name':'8'},{'id':_0x85c4bf(0x1053),'url':_0x85c4bf(0x465),'name':'9'},{'id':'frame_10','url':_0x85c4bf(0x88e),'name':'10'},{'id':_0x85c4bf(0xa8d),'url':'https://i.postimg.cc/cHWp0KG6/IMG-4413.gif','name':'11'},{'id':'frame_12','url':'https://i.postimg.cc/4yNjHrdg/IMG-4414.gif','name':'12'},{'id':_0x85c4bf(0xb6f),'url':_0x85c4bf(0xe82),'name':'13'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x81d),'name':'14'},{'id':_0x85c4bf(0x4a4),'url':_0x85c4bf(0xa30),'name':'1'},{'id':_0x85c4bf(0xafe),'url':_0x85c4bf(0xfef),'name':'2'},{'id':_0x85c4bf(0x2bd),'url':_0x85c4bf(0xce3),'name':'3'},{'id':'frame_tech','url':'https://i.postimg.cc/J4WCQd2j/IMG-4420.gif','name':'4'},{'id':_0x85c4bf(0x847),'url':_0x85c4bf(0x5a5),'name':'5'},{'id':_0x85c4bf(0x105f),'url':'https://i.postimg.cc/mrkvDxPW/IMG-4422.gif','name':'6'},{'id':_0x85c4bf(0xd54),'url':_0x85c4bf(0x11c6),'name':'7'},{'id':'frame_8','url':'https://i.postimg.cc/3N5Vndn3/IMG-4426.gif','name':'8'},{'id':'frame_9','url':_0x85c4bf(0x2e7),'name':'9'},{'id':'frame_10','url':_0x85c4bf(0x568),'name':'10'},{'id':'frame_11','url':_0x85c4bf(0x394),'name':'11'},{'id':'frame_12','url':'https://i.postimg.cc/R0WYmcYM/IMG-4431.gif','name':'12'},{'id':_0x85c4bf(0xb6f),'url':_0x85c4bf(0x68c),'name':'13'},{'id':_0x85c4bf(0xf59),'url':'https://i.postimg.cc/tC9mJ0cv/IMG-4438.gif','name':'14'},{'id':_0x85c4bf(0x4a4),'url':_0x85c4bf(0xd9d),'name':'1'},{'id':'frame_ribbon','url':_0x85c4bf(0xb1c),'name':'2'},{'id':_0x85c4bf(0x2bd),'url':_0x85c4bf(0x6e3),'name':'3'},{'id':_0x85c4bf(0xde2),'url':_0x85c4bf(0x5ea),'name':'4'},{'id':_0x85c4bf(0x847),'url':_0x85c4bf(0x3fd),'name':'5'},{'id':_0x85c4bf(0x105f),'url':_0x85c4bf(0xbc3),'name':'6'},{'id':_0x85c4bf(0xd54),'url':'https://i.postimg.cc/Lsjzj5Yt/IMG-4729.gif','name':'7'},{'id':_0x85c4bf(0xf35),'url':_0x85c4bf(0x10f2),'name':'8'},{'id':'frame_9','url':'https://i.postimg.cc/4x9tTy1D/IMG-5563.gif','name':'9'},{'id':'frame_10','url':'https://i.postimg.cc/DZshzKv6/IMG-5576.gif','name':'10'},{'id':_0x85c4bf(0xa8d),'url':'https://i.postimg.cc/Fsvr71JL/IMG-5573.gif','name':'11'},{'id':_0x85c4bf(0xc70),'url':_0x85c4bf(0xeb6),'name':'12'},{'id':_0x85c4bf(0xb6f),'url':_0x85c4bf(0xdb8),'name':'13'},{'id':'frame_14','url':_0x85c4bf(0xc97),'name':'14'},{'id':_0x85c4bf(0x4a4),'url':'https://i.postimg.cc/CKgDNYVb/IMG-5577.gif','name':'1'},{'id':'frame_ribbon','url':_0x85c4bf(0x12ce),'name':'2'},{'id':_0x85c4bf(0x2bd),'url':'https://i.postimg.cc/hj4dkrvj/IMG-5578.gif','name':'3'},{'id':_0x85c4bf(0xde2),'url':'https://i.postimg.cc/C5XnfpNB/IMG-5579.gif','name':'4'},{'id':_0x85c4bf(0x847),'url':_0x85c4bf(0x67b),'name':'5'},{'id':_0x85c4bf(0x105f),'url':_0x85c4bf(0xe67),'name':'6'},{'id':'frame_7','url':_0x85c4bf(0x385),'name':'7'},{'id':'frame_8','url':_0x85c4bf(0x263),'name':'8'},{'id':_0x85c4bf(0x1053),'url':'https://i.postimg.cc/VNK6Ccsf/IMG-5722.gif','name':'9'},{'id':_0x85c4bf(0x523),'url':_0x85c4bf(0x108f),'name':'10'},{'id':_0x85c4bf(0xa8d),'url':_0x85c4bf(0xa8a),'name':'11'},{'id':'frame_12','url':_0x85c4bf(0x814),'name':'12'},{'id':'frame_13','url':_0x85c4bf(0xbea),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/wBw5Fvcn/IMG-5974.gif','name':'14'},{'id':_0x85c4bf(0x4a4),'url':'https://i.postimg.cc/R0pfKYvB/IMG-5976.gif','name':'1'},{'id':_0x85c4bf(0xafe),'url':_0x85c4bf(0x1082),'name':'2'},{'id':'frame_flower','url':_0x85c4bf(0xd62),'name':'3'},{'id':_0x85c4bf(0xde2),'url':_0x85c4bf(0xf7c),'name':'4'},{'id':_0x85c4bf(0x847),'url':_0x85c4bf(0x82f),'name':'5'},{'id':_0x85c4bf(0x105f),'url':_0x85c4bf(0xa3e),'name':'6'},{'id':_0x85c4bf(0xd54),'url':'https://i.postimg.cc/qRCtnMms/IMG-6145.gif','name':'7'},{'id':_0x85c4bf(0xf35),'url':_0x85c4bf(0xf76),'name':'8'},{'id':_0x85c4bf(0x1053),'url':_0x85c4bf(0x1133),'name':'9'},{'id':'frame_10','url':_0x85c4bf(0xf0c),'name':'10'},{'id':_0x85c4bf(0xa8d),'url':_0x85c4bf(0x244),'name':'11'},{'id':_0x85c4bf(0xc70),'url':_0x85c4bf(0x11ed),'name':'12'},{'id':_0x85c4bf(0xb6f),'url':_0x85c4bf(0x5bb),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/5tbpnDcQ/IMG-6296.gif','name':'14'},{'id':'frame_cat_ear','url':'https://i.postimg.cc/YSRRV8kn/IMG-6297.gif','name':'1'},{'id':_0x85c4bf(0xafe),'url':'https://i.postimg.cc/k45sd8gn/IMG-6375.gif','name':'2'},{'id':_0x85c4bf(0x2bd),'url':_0x85c4bf(0x1c6),'name':'3'},{'id':_0x85c4bf(0xde2),'url':_0x85c4bf(0x4f7),'name':'4'},{'id':_0x85c4bf(0x847),'url':_0x85c4bf(0x259),'name':'5'},{'id':'frame_6','url':_0x85c4bf(0xb64),'name':'6'},{'id':'frame_7','url':'https://i.postimg.cc/gkhf597g/IMG-6555.gif','name':'7'},{'id':_0x85c4bf(0xf35),'url':_0x85c4bf(0x10e1),'name':'8'},{'id':_0x85c4bf(0x1053),'url':_0x85c4bf(0x134c),'name':'9'},{'id':_0x85c4bf(0x523),'url':_0x85c4bf(0x8d0),'name':'10'},{'id':_0x85c4bf(0xa8d),'url':'https://i.postimg.cc/Y94XWYKd/IMG-6560.gif','name':'11'},{'id':_0x85c4bf(0xc70),'url':_0x85c4bf(0xfcb),'name':'12'},{'id':'frame_13','url':'https://i.postimg.cc/G3y73Fj2/IMG-6563.gif','name':'13'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0xefe),'name':'14'},{'id':_0x85c4bf(0x4a4),'url':_0x85c4bf(0xaa9),'name':'1'},{'id':_0x85c4bf(0xafe),'url':_0x85c4bf(0x11b2),'name':'2'},{'id':_0x85c4bf(0x2bd),'url':'https://i.postimg.cc/XJy8JWdh/IMG-6568.gif','name':'3'},{'id':_0x85c4bf(0xde2),'url':_0x85c4bf(0xfec),'name':'4'},{'id':_0x85c4bf(0x847),'url':_0x85c4bf(0xf01),'name':'5'},{'id':_0x85c4bf(0x105f),'url':_0x85c4bf(0xfd6),'name':'6'},{'id':_0x85c4bf(0xd54),'url':'https://i.postimg.cc/YqxxjbLp/IMG-6572.gif','name':'7'},{'id':_0x85c4bf(0xf35),'url':_0x85c4bf(0xe09),'name':'8'},{'id':_0x85c4bf(0x1053),'url':'https://i.postimg.cc/Vv8jkCYr/IMG-6574.gif','name':'9'},{'id':_0x85c4bf(0x523),'url':_0x85c4bf(0xa90),'name':'10'},{'id':_0x85c4bf(0xa8d),'url':_0x85c4bf(0x7a4),'name':'11'},{'id':_0x85c4bf(0xc70),'url':'https://i.postimg.cc/28TsrxRV/IMG-6852.gif','name':'12'},{'id':_0x85c4bf(0xb6f),'url':'https://i.postimg.cc/VkV2bLNw/IMG-6853.gif','name':'13'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x363),'name':'14'},{'id':_0x85c4bf(0x4a4),'url':_0x85c4bf(0xd0e),'name':'1'},{'id':_0x85c4bf(0xafe),'url':_0x85c4bf(0xd8a),'name':'2'},{'id':_0x85c4bf(0x2bd),'url':_0x85c4bf(0x52f),'name':'3'},{'id':_0x85c4bf(0xde2),'url':_0x85c4bf(0xa65),'name':'4'},{'id':'frame_5','url':'https://i.postimg.cc/vBqsQW7X/IMG-6858.gif','name':'5'},{'id':_0x85c4bf(0x105f),'url':_0x85c4bf(0x79a),'name':'6'},{'id':_0x85c4bf(0xd54),'url':'https://i.postimg.cc/90sH9Cn7/IMG-6868.gif','name':'7'},{'id':_0x85c4bf(0xf35),'url':_0x85c4bf(0x1054),'name':'8'},{'id':_0x85c4bf(0x1053),'url':_0x85c4bf(0xc2f),'name':'9'},{'id':_0x85c4bf(0x523),'url':_0x85c4bf(0xec6),'name':'10'},{'id':_0x85c4bf(0xa8d),'url':_0x85c4bf(0x274),'name':'11'},{'id':_0x85c4bf(0xc70),'url':'https://i.postimg.cc/Wbr0JSDD/IMG-5316.gif','name':'12'},{'id':'frame_13','url':_0x85c4bf(0x951),'name':'13'},{'id':_0x85c4bf(0xf59),'url':'https://i.postimg.cc/d0WCKxff/IMG-6932.gif','name':'14'},{'id':_0x85c4bf(0xa8d),'url':_0x85c4bf(0x56a),'name':'11'},{'id':_0x85c4bf(0xc70),'url':_0x85c4bf(0xa29),'name':'12'},{'id':'frame_13','url':_0x85c4bf(0xbd0),'name':'13'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x5ba),'name':'14'},{'id':_0x85c4bf(0xb6f),'url':_0x85c4bf(0x1370),'name':'13'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x1d9),'name':'14'},{'id':_0x85c4bf(0xb6f),'url':_0x85c4bf(0xa84),'name':'13'},{'id':_0x85c4bf(0xf59),'url':'https://i.postimg.cc/XqRZNZ9G/IMG-6916.gif','name':'14'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x1188),'name':'14'},{'id':_0x85c4bf(0xb6f),'url':_0x85c4bf(0xdd0),'name':'13'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x1274),'name':'14'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x1203),'name':'14'},{'id':_0x85c4bf(0xc70),'url':'https://i.postimg.cc/7LSRp4hx/e7fa949b9pc84cff0dabe57defceb54c.gif','name':'12'},{'id':_0x85c4bf(0xb6f),'url':_0x85c4bf(0xd08),'name':'13'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0xf3f),'name':'14'},{'id':_0x85c4bf(0xb6f),'url':'https://i.postimg.cc/vHDNGfT2/35ac7f372v588bf48d4f659077196b85.gif','name':'13'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x61e),'name':'14'},{'id':_0x85c4bf(0xb6f),'url':_0x85c4bf(0x13cd),'name':'13'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x134a),'name':'14'},{'id':'frame_14','url':_0x85c4bf(0x320),'name':'14'},{'id':_0x85c4bf(0xb6f),'url':'https://i.postimg.cc/J0CZSwyW/IMG-6938.gif','name':'13'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0xc2b),'name':'14'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x8d6),'name':'14'},{'id':_0x85c4bf(0xb6f),'url':_0x85c4bf(0x489),'name':'13'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x54e),'name':'14'},{'id':_0x85c4bf(0xf59),'url':'https://i.postimg.cc/Ssgbv41n/IMG-6876.gif','name':'14'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x725),'name':'14'},{'id':'frame_13','url':_0x85c4bf(0x133e),'name':'13'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x7d7),'name':'14'},{'id':_0x85c4bf(0xf59),'url':'https://i.postimg.cc/DZrGtrqB/IMG-7008.gif','name':'14'},{'id':_0x85c4bf(0xb6f),'url':_0x85c4bf(0x2d0),'name':'13'},{'id':_0x85c4bf(0xf59),'url':'https://i.postimg.cc/RhGH0vpt/IMG-7010.gif','name':'14'},{'id':'frame_14','url':_0x85c4bf(0x29c),'name':'14'},{'id':_0x85c4bf(0xb6f),'url':'https://i.postimg.cc/wTTNGs3Q/IMG-7013.gif','name':'13'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x6d9),'name':'14'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x13b8),'name':'14'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x4be),'name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/QMVdG9x6/IMG-7016.gif','name':'13'},{'id':'frame_14','url':_0x85c4bf(0xc98),'name':'14'},{'id':'frame_14','url':_0x85c4bf(0x6e5),'name':'14'},{'id':'frame_13','url':_0x85c4bf(0xab7),'name':'13'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0xd24),'name':'14'},{'id':_0x85c4bf(0xf59),'url':'https://i.postimg.cc/ZqjKXPSv/IMG-7025.gif','name':'14'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x120b),'name':'14'},{'id':_0x85c4bf(0xb6f),'url':_0x85c4bf(0x126f),'name':'13'},{'id':'frame_14','url':_0x85c4bf(0x1132),'name':'14'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0xe62),'name':'14'},{'id':_0x85c4bf(0xb6f),'url':'https://i.postimg.cc/1XqzGKwJ/mmexport1751018282681.gif','name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/8kHCQwbQ/mmexport1751020645824.gif','name':'14'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x798),'name':'14'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x521),'name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/HLZNWkQw/mmexport1751031767634.gif','name':'13'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x1031),'name':'14'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x1253),'name':'14'},{'id':_0x85c4bf(0xb6f),'url':_0x85c4bf(0xad7),'name':'13'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x4c0),'name':'14'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x200),'name':'14'},{'id':_0x85c4bf(0xf59),'url':'https://i.postimg.cc/CMv02LHm/mmexport1751034842120.gif','name':'14'},{'id':_0x85c4bf(0xb6f),'url':_0x85c4bf(0xa63),'name':'13'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0xf08),'name':'14'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0xfca),'name':'14'},{'id':_0x85c4bf(0xb6f),'url':'https://i.postimg.cc/HxLV5v92/mmexport1751036977582.gif','name':'13'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x6ee),'name':'14'},{'id':'frame_14','url':_0x85c4bf(0xd35),'name':'14'},{'id':'frame_14','url':_0x85c4bf(0x388),'name':'14'},{'id':_0x85c4bf(0xb6f),'url':_0x85c4bf(0xc95),'name':'13'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0xcf8),'name':'14'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x11eb),'name':'14'},{'id':_0x85c4bf(0xb6f),'url':_0x85c4bf(0x11f8),'name':'13'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0xd82),'name':'14'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x13c4),'name':'14'},{'id':'frame_14','url':_0x85c4bf(0x256),'name':'14'},{'id':_0x85c4bf(0xb6f),'url':_0x85c4bf(0x1398),'name':'13'},{'id':'frame_14','url':_0x85c4bf(0xcd7),'name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/vZt0fFKn/IMB-r-HMBXY.gif','name':'14'},{'id':_0x85c4bf(0xb6f),'url':'https://i.postimg.cc/pddJj9zN/IMG-7094.gif','name':'13'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x266),'name':'14'},{'id':'frame_14','url':_0x85c4bf(0x1281),'name':'14'},{'id':_0x85c4bf(0xf59),'url':'https://i.postimg.cc/B6KD52vz/IMG-7096.gif','name':'14'},{'id':_0x85c4bf(0xb6f),'url':_0x85c4bf(0x1153),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/mrFhKBGz/IMB-e-QWBpa.gif','name':'14'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0xab3),'name':'14'},{'id':'frame_13','url':_0x85c4bf(0xa22),'name':'13'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x7a9),'name':'14'},{'id':'frame_14','url':_0x85c4bf(0xbb4),'name':'14'},{'id':'frame_14','url':_0x85c4bf(0x12a9),'name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/0NpZPgYj/IMG-6985.gif','name':'13'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x10f3),'name':'14'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x13f1),'name':'14'},{'id':_0x85c4bf(0xb6f),'url':_0x85c4bf(0x13fb),'name':'13'},{'id':'frame_14','url':_0x85c4bf(0xb1a),'name':'14'},{'id':'frame_14','url':_0x85c4bf(0x476),'name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/FzqHTBng/IMG-7093.gif','name':'14'},{'id':_0x85c4bf(0xb6f),'url':'https://i.postimg.cc/tTpZ6wLs/IMG-7095.gif','name':'13'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x694),'name':'14'},{'id':_0x85c4bf(0xf59),'url':'https://i.postimg.cc/wMxmCZVC/IMG-7099.gif','name':'14'},{'id':_0x85c4bf(0xb6f),'url':_0x85c4bf(0xd27),'name':'13'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x933),'name':'14'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x4ec),'name':'14'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x11fc),'name':'14'},{'id':_0x85c4bf(0xb6f),'url':'https://i.postimg.cc/hPgyjtyn/IMG-7108.gif','name':'13'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0x5b3),'name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/wjwbnYkp/IMG-7111.gif','name':'14'},{'id':'frame_13','url':_0x85c4bf(0x37b),'name':'13'},{'id':_0x85c4bf(0xf59),'url':_0x85c4bf(0xdb6),'name':'14'},{'id':'frame_14','url':_0x85c4bf(0x1311),'name':'14'}];let _0x505390={'chats':{},'activeChatId':null,'globalSettings':{},'apiConfig':{},'userStickers':[],'worldBooks':[],'personaPresets':[],'qzoneSettings':{},'activeAlbumId':null,'cache':{'songs':new Map(),'lyrics':new Map()},'ttsCache':new Map()},_0x511f5d={'isActive':![],'gameMode':null,'chatId':null,'players':[],'currentDay':0x1,'currentPhase':_0x85c4bf(0x60d),'nightActions':{},'gameLog':[],'discussionLog':[],'voteResults':{},'electionInfo':{'candidates':[],'votes':{}},'sheriffId':null,'lastFailedAction':null},_0xd87e3c=0x0;const _0x6aead8=0xf;let _0xf8ae5e=0x0;const _0x3eaf56=0xa;let _0x5a98bc=[],_0x304e8d={'isActive':![],'activeChatId':null,'isPlaying':![],'playlist':[],'currentIndex':-0x1,'playMode':_0x85c4bf(0x11a3),'totalElapsedTime':0x0,'timerId':null,'parsedLyrics':[],'currentLyricIndex':-0x1},_0x50f1ba={'isOpen':![],'activePostId':null,'panelEl':null,'gridEl':null};const _0x54d46a=document[_0x85c4bf(0x479)](_0x85c4bf(0xd6f));let _0x1b68ba=null,_0x4c148b=![],_0x55f419=0x0,_0x5edca3=null,_0x4a165d=![],_0x2a104d=_0x85c4bf(0xf78),_0x373eab=new Set(),_0x5799fc=null,_0x551b1c=![],_0x1c457a=null,_0x104c4a=null,_0xc050fd=![],_0x5c1afa=![],_0x393522=![],_0xfa7cf0=![],_0x1bf593=[],_0x58c244=null,_0x213dd3=null,_0x43f059={},_0x45dd47=null,_0x509091=null,_0x1c2d6e=null,_0x560eba=null,_0x87e381=null,_0x17b93d=null,_0x3057fc=null,_0x3972fd=[],_0xcb90ce=null,_0x551be2=null,_0x1bb9d3=new Set(),_0xaa9aca=null,_0x2236ff=null,_0x2355c5=null,_0x4a2783={'isOpen':![],'photos':[],'currentIndex':-0x1},_0x22cc4e=0x0,_0x267d11=![],_0x15cb7e=new Set(),_0x2f1d11=null;const _0x28c106=_0x85c4bf(0xd49),_0x2361d7=_0x85c4bf(0x50a),_0x3ea4df='https://i.postimg.cc/VkQfgzGJ/1.jpg',_0x3b1eb7=_0x85c4bf(0x546);let _0x1ba729,_0x2ca317={};const _0x19106c=_0x85c4bf(0x802);let _0x5aa690={},_0x36a37a={},_0x4e7802=null;const _0x597469={'qq':_0x85c4bf(0x9d4),'world-book':'https://i.postimg.cc/HWf1JKzn/IMG-6435.jpg','wallpaper':_0x85c4bf(0x1d8),'renderer':_0x85c4bf(0xfe3),'api-settings':_0x85c4bf(0x919),'font':_0x85c4bf(0x5f2),'char-phone':_0x85c4bf(0x8c8),'douban':_0x85c4bf(0x12c0),'preset':'https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1758510900942_qdqqd_djw0z2.jpeg','tutorial':_0x85c4bf(0x4a5),'werewolf':_0x85c4bf(0x2fd),'x':_0x85c4bf(0xe4c)},_0x28895b={'qq':_0x85c4bf(0x9d4),'album':_0x85c4bf(0x365),'browser':_0x85c4bf(0x837),'taobao':_0x85c4bf(0xc44),'memo':'https://i.postimg.cc/J0b6Nym4/IMG-7279.jpg','diary':_0x85c4bf(0xa57),'amap':_0x85c4bf(0x62f),'usage':_0x85c4bf(0x7a6),'music':_0x85c4bf(0x1005),'ephone':'https://i.postimg.cc/pXj9h20L/IMG-7275.jpg'};let _0x22bfaf=null;const _0x554a0b=/(^https:\/\/i\.postimg\.cc\/.+|^https:\/\/files\.catbox\.moe\/.+|^https?:\/\/sharkpan\.xyz\/.+|^data:image|\.(png|jpg|jpeg|gif|webp)\?.*$|\.(png|jpg|jpeg|gif|webp)$)/i;let _0x1e729c=0x0,_0x5c5137=0x1,_0x35df2c={'hasShown40':![],'hasShown20':![],'hasShown10':![]},_0x3dfb93;const _0x460f62=document[_0x85c4bf(0xbd5)](_0x85c4bf(0x10dd));_0x460f62['id']=_0x85c4bf(0xdbb),document[_0x85c4bf(0x581)][_0x85c4bf(0x9f4)](_0x460f62);const _0x2f75ea=document['getElementById'](_0x85c4bf(0x11e1)),_0x4a50ba=document[_0x85c4bf(0x479)]('custom-modal-title'),_0x4df0bf=document['getElementById']('custom-modal-body'),_0x2a4fd8=document['getElementById'](_0x85c4bf(0x362)),_0x4848c6=document[_0x85c4bf(0x479)](_0x85c4bf(0x26f));let _0x5330c0;function _0x592249(){const _0x409868=_0x85c4bf;_0x2f75ea[_0x409868(0x9cd)][_0x409868(0x807)](_0x409868(0x45a));}function _0x3acce8(){const _0x1ef1bd=_0x85c4bf;_0x2f75ea[_0x1ef1bd(0x9cd)][_0x1ef1bd(0x8b6)](_0x1ef1bd(0x45a)),_0x2a4fd8[_0x1ef1bd(0x9cd)][_0x1ef1bd(0x8b6)](_0x1ef1bd(0x95a));if(_0x5330c0)_0x5330c0(null);}function _0x372924(_0x521bfb){const _0x2b34f1=_0x85c4bf,_0x3f0428=document[_0x2b34f1(0x479)](_0x2b34f1(0xffe)),_0x5aff5d=_0x521bfb[_0x2b34f1(0x18a)][_0x2b34f1(0x1211)]||{'vertical':_0x2b34f1(0xb8f),'horizontal':_0x2b34f1(0x1e5),'offset':0xa};_0x3f0428[_0x2b34f1(0x10dd)][_0x2b34f1(0xb8f)]='auto',_0x3f0428[_0x2b34f1(0x10dd)][_0x2b34f1(0xeb7)]=_0x2b34f1(0x260),_0x3f0428[_0x2b34f1(0x10dd)][_0x2b34f1(0x138f)]=_0x2b34f1(0x260),_0x3f0428['style'][_0x2b34f1(0xd2d)]=_0x2b34f1(0x260),_0x3f0428[_0x2b34f1(0x10dd)][_0x2b34f1(0x87a)]='none';_0x5aff5d[_0x2b34f1(0x22e)]==='top'?_0x3f0428[_0x2b34f1(0x10dd)][_0x2b34f1(0xb8f)]=_0x5aff5d[_0x2b34f1(0x7a1)]+'px':_0x3f0428[_0x2b34f1(0x10dd)][_0x2b34f1(0xeb7)]=_0x5aff5d[_0x2b34f1(0x7a1)]+'px';switch(_0x5aff5d[_0x2b34f1(0xc2d)]){case _0x2b34f1(0x138f):_0x3f0428[_0x2b34f1(0x10dd)][_0x2b34f1(0x138f)]=_0x2b34f1(0x760);break;case _0x2b34f1(0xd2d):_0x3f0428[_0x2b34f1(0x10dd)][_0x2b34f1(0xd2d)]='15px';break;case'center':default:_0x3f0428[_0x2b34f1(0x10dd)][_0x2b34f1(0x138f)]='50%',_0x3f0428[_0x2b34f1(0x10dd)][_0x2b34f1(0x87a)]=_0x2b34f1(0x10fa);break;}}async function _0x35d18d(_0x5e0ce8){const _0x26f630=_0x85c4bf,_0x4262f6=_0x5e0ce8['target'][_0x26f630(0xe63)][0x0];if(!_0x4262f6)return;const _0x3cbf2e=await new Promise(_0x4b7574=>{const _0x446237=_0x26f630,_0x273b29=new FileReader();_0x273b29[_0x446237(0x502)]=()=>_0x4b7574(_0x273b29['result']),_0x273b29['readAsDataURL'](_0x4262f6);});await _0x1519c8(_0x26f630(0xbd7),'正在请求AI为新群头像命名...');try{const _0x482bac=await _0x726bcc(_0x3cbf2e);if(!_0x482bac)throw new Error(_0x26f630(0x2b8));const _0x31621b=_0x505390[_0x26f630(0x1027)][_0x505390['activeChatId']];!_0x31621b[_0x26f630(0x18a)][_0x26f630(0x37f)]&&(_0x31621b['settings'][_0x26f630(0x37f)]=[]),_0x31621b[_0x26f630(0x18a)][_0x26f630(0x37f)][_0x26f630(0x1a0)]({'name':_0x482bac,'url':_0x3cbf2e}),await _0xb81d4e['chats'][_0x26f630(0x5d0)](_0x31621b),_0x450c42(),await _0x1519c8(_0x26f630(0x1265),'AI已将新群头像命名为：“'+_0x482bac+'”');}catch(_0x3511b6){console[_0x26f630(0xe3b)](_0x26f630(0x61c),_0x3511b6),await _0x1519c8(_0x26f630(0xaab),'无法为头像命名，请检查（主/副）API配置是否正确并支持Vision。\x0a错误:\x20'+_0x3511b6[_0x26f630(0x757)]);}finally{_0x5e0ce8[_0x26f630(0xfa2)][_0x26f630(0x4e0)]=null;}}async function _0xc7db2c(_0x10e585){const _0x22a7b1=_0x85c4bf,_0x4645c7=_0x10e585[_0x22a7b1(0xfa2)]['files'][0x0];if(!_0x4645c7)return;const _0x53cc67=await new Promise(_0x10f44f=>{const _0x5f330b=_0x22a7b1,_0x4eb0ab=new FileReader();_0x4eb0ab[_0x5f330b(0x502)]=()=>_0x10f44f(_0x4eb0ab[_0x5f330b(0x97e)]),_0x4eb0ab['readAsDataURL'](_0x4645c7);});await _0x1519c8(_0x22a7b1(0xbd7),_0x22a7b1(0x9a5));try{const _0x5441e7=await _0x726bcc(_0x53cc67);if(!_0x5441e7)throw new Error(_0x22a7b1(0x2b8));const _0x56de00=_0x505390['chats'][_0x505390['activeChatId']];!_0x56de00[_0x22a7b1(0x18a)][_0x22a7b1(0x8c6)]&&(_0x56de00[_0x22a7b1(0x18a)]['aiAvatarLibrary']=[]),_0x56de00[_0x22a7b1(0x18a)][_0x22a7b1(0x8c6)]['push']({'name':_0x5441e7,'url':_0x53cc67}),await _0xb81d4e[_0x22a7b1(0x1027)]['put'](_0x56de00),_0x2e76c2(),await _0x1519c8(_0x22a7b1(0x1265),_0x22a7b1(0x3ca)+_0x5441e7+'”');}catch(_0x39bcc4){console['error'](_0x22a7b1(0xdff),_0x39bcc4),await _0x1519c8('操作失败',_0x22a7b1(0xd25)+_0x39bcc4['message']);}finally{_0x10e585['target'][_0x22a7b1(0x4e0)]=null;}}async function _0x726bcc(_0x1f2194){const _0x4d4537=_0x85c4bf,_0x338da8=_0x505390[_0x4d4537(0x30c)][_0x4d4537(0xe39)]&&_0x505390['apiConfig'][_0x4d4537(0xbf6)]&&_0x505390[_0x4d4537(0x30c)][_0x4d4537(0x11ea)],{proxyUrl:_0x49abec,apiKey:_0x464282,model:_0x23d46f}=_0x338da8?{'proxyUrl':_0x505390[_0x4d4537(0x30c)][_0x4d4537(0xe39)],'apiKey':_0x505390[_0x4d4537(0x30c)][_0x4d4537(0xbf6)],'model':_0x505390['apiConfig'][_0x4d4537(0x11ea)]}:_0x505390[_0x4d4537(0x30c)];if(!_0x49abec||!_0x464282||!_0x23d46f)throw new Error(_0x4d4537(0xb07));const _0x3de8d3=_0x4d4537(0xece);let _0x19a280=_0x49abec['includes'](_0x4d4537(0x136f)),_0x5e9dd3;if(_0x19a280){const _0x452fe2=_0x1f2194[_0x4d4537(0xab4)](/^data:(.*);base64/)[0x1],_0x3b285d=_0x1f2194[_0x4d4537(0x53e)](',')[0x1],_0x29efc9={'contents':[{'parts':[{'text':_0x3de8d3},{'inline_data':{'mime_type':_0x452fe2,'data':_0x3b285d}}]}]};_0x5e9dd3=await fetch(_0x49abec+'/'+_0x23d46f+_0x4d4537(0x10ce)+_0x464282,{'method':_0x4d4537(0xba0),'headers':{'Content-Type':_0x4d4537(0xcb5)},'body':JSON[_0x4d4537(0x1308)](_0x29efc9)});}else{const _0x5b481d={'model':_0x23d46f,'messages':[{'role':_0x4d4537(0x4c5),'content':[{'type':_0x4d4537(0x56d),'text':_0x3de8d3},{'type':'image_url','image_url':{'url':_0x1f2194}}]}],'max_tokens':0x32};_0x5e9dd3=await fetch(_0x49abec+_0x4d4537(0x347),{'method':_0x4d4537(0xba0),'headers':{'Content-Type':_0x4d4537(0xcb5),'Authorization':'Bearer\x20'+_0x464282},'body':JSON[_0x4d4537(0x1308)](_0x5b481d)});}if(!_0x5e9dd3['ok']){const _0x54b984=await _0x5e9dd3[_0x4d4537(0xfdf)]();throw new Error(_0x4d4537(0xef2)+_0x54b984[_0x4d4537(0xe3b)]['message']);}const _0x22e9c2=await _0x5e9dd3['json']();let _0x48f9e9=_0x19a280?getGeminiResponseText(_0x22e9c2):_0x22e9c2[_0x4d4537(0xd5c)][0x0]['message']['content'];return _0x48f9e9[_0x4d4537(0x9c1)]()['replace'](/["'“”‘’]/g,'');}async function _0x377162(_0x222335){const _0x4b3b68=_0x85c4bf;if(!_0x222335||_0x222335['isGroup']){console[_0x4b3b68(0x139e)](_0x4b3b68(0x1226));return;}const _0x5151f0=_0x222335['id'],_0x20781b=_0x222335[_0x4b3b68(0x564)],_0x2ba2a=_0x222335[_0x4b3b68(0xe2d)];console[_0x4b3b68(0x90f)](_0x4b3b68(0xb2b)+_0x5151f0+_0x4b3b68(0x8de));for(const _0x3f7d35 in _0x505390['chats']){const _0x389461=_0x505390[_0x4b3b68(0x1027)][_0x3f7d35];if(_0x389461['isGroup']&&_0x389461['members']){const _0x1c2b14=_0x389461[_0x4b3b68(0x954)][_0x4b3b68(0xc0d)](_0x3a65ca=>_0x3a65ca['id']===_0x5151f0);if(_0x1c2b14){let _0x504049=![];_0x1c2b14[_0x4b3b68(0xa54)]!==_0x20781b&&(_0x1c2b14[_0x4b3b68(0xa54)]=_0x20781b,_0x504049=!![]),_0x1c2b14[_0x4b3b68(0xe2d)]!==_0x2ba2a&&(_0x1c2b14[_0x4b3b68(0xe2d)]=_0x2ba2a,_0x504049=!![]),_0x504049&&(await _0xb81d4e['chats'][_0x4b3b68(0x5d0)](_0x389461),console['log']('成功将群聊\x20\x22'+_0x389461[_0x4b3b68(0x564)]+_0x4b3b68(0x6aa)));}}}}async function _0x134037(_0x428145){const _0x141269=_0x85c4bf;if(!_0x428145||_0x428145[_0x141269(0x9d7)]){console[_0x141269(0x139e)](_0x141269(0x106f));return;}const _0x3562e1=_0x428145['id'],_0x57afa7=_0x428145[_0x141269(0x18a)]['aiAvatar'];console['log'](_0x141269(0xb2b)+_0x3562e1+_0x141269(0xfd9));for(const _0x1da320 of Object[_0x141269(0x3d5)](_0x505390['chats'])){if(_0x1da320[_0x141269(0x9d7)]&&_0x1da320[_0x141269(0x954)]){const _0x5c3725=_0x1da320[_0x141269(0x954)]['find'](_0x126acd=>_0x126acd['id']===_0x3562e1);_0x5c3725&&_0x5c3725[_0x141269(0x799)]!==_0x57afa7&&(_0x5c3725[_0x141269(0x799)]=_0x57afa7,await _0xb81d4e[_0x141269(0x1027)]['put'](_0x1da320),console['log'](_0x141269(0xd01)+_0x3562e1+'\x20的新头像同步到群聊\x20\x22'+_0x1da320[_0x141269(0x564)]+'\x22'));}}}function _0x503999(_0x1b3231,_0x58c4d5){const _0x1688ce=_0x85c4bf;if(!_0x1b3231||!_0x1b3231[_0x1688ce(0x9d7)]||!_0x58c4d5)return _0x58c4d5;const _0x3c7114=_0x505390[_0x1688ce(0x1190)]['nickname']||_0x1688ce(0x80e);if(_0x58c4d5===_0x3c7114)return _0x1b3231[_0x1688ce(0x18a)]['myNickname']||'我';const _0xabdd4d=_0x1b3231[_0x1688ce(0x954)][_0x1688ce(0xc0d)](_0x208eca=>_0x208eca[_0x1688ce(0xe2d)]===_0x58c4d5);return _0xabdd4d?_0xabdd4d[_0x1688ce(0xa54)]:_0x58c4d5;}function _0x34eb35(_0x5ea522){const _0x2f13f6=_0x85c4bf;document['querySelectorAll'](_0x2f13f6(0xb96))['forEach'](_0x4e346e=>{const _0x2ca643=_0x2f13f6;_0x4e346e[_0x2ca643(0x9cd)]['toggle'](_0x2ca643(0x5a9),_0x4e346e['dataset'][_0x2ca643(0x470)]===_0x5ea522);}),document[_0x2f13f6(0x99e)](_0x2f13f6(0x33d))[_0x2f13f6(0x12be)](_0x37c13d=>{const _0x5126d5=_0x2f13f6;_0x37c13d['classList'][_0x5126d5(0x2bf)](_0x5126d5(0x5a9),_0x37c13d[_0x5126d5(0x13d4)][_0x5126d5(0x470)]===_0x5ea522);});}function _0x148d9b(_0xb4f791){const _0xb215d9=_0x85c4bf;if(!_0xb4f791)return'';if(_0x505390[_0xb215d9(0x1190)]&&_0xb4f791===_0x505390['qzoneSettings'][_0xb215d9(0x904)])return _0x505390[_0xb215d9(0x1190)][_0xb215d9(0x904)];let _0x2c7616=Object[_0xb215d9(0x3d5)](_0x505390['chats'])['find'](_0x2f0644=>!_0x2f0644['isGroup']&&_0x2f0644[_0xb215d9(0xe2d)]===_0xb4f791);if(_0x2c7616)return _0x2c7616[_0xb215d9(0x564)];_0x2c7616=Object[_0xb215d9(0x3d5)](_0x505390['chats'])['find'](_0x34386d=>!_0x34386d[_0xb215d9(0x9d7)]&&(_0x34386d['nameHistory']&&_0x34386d['nameHistory']['includes'](_0xb4f791)));if(_0x2c7616)return _0x2c7616[_0xb215d9(0x564)];return _0xb4f791;}function _0x4537d4(_0x46d3c8,_0x38427d=null){const _0x5a2f16=_0x85c4bf;if(!_0x46d3c8||typeof _0x46d3c8!==_0x5a2f16(0x8d9)||!_0x46d3c8[_0x5a2f16(0x44f)](_0x5a2f16(0xb0a)))return _0x46d3c8;return _0x46d3c8['replace'](/@\[\[([^\]]+)\]\]/g,(_0xa2de73,_0x312e95)=>{const _0x34fcb9=_0x5a2f16,_0x4b8f95=_0x312e95['trim']();let _0x4037aa;return _0x38427d&&_0x38427d[_0x34fcb9(0x9d7)]?_0x4037aa=_0x503999(_0x38427d,_0x4b8f95):_0x4037aa=_0x148d9b(_0x4b8f95),'@'+_0x4037aa;});}function _0x1a9e79(_0x30a443,_0x4d55f5,_0x49433c={}){return new Promise(_0x28987a=>{const _0x3b1751=_0x6666;_0x5330c0=_0x28987a,_0x4a50ba[_0x3b1751(0x97b)]=_0x30a443,_0x4df0bf[_0x3b1751(0x3de)]='<p>'+_0x4d55f5+_0x3b1751(0x1049);const _0x5871f4=document[_0x3b1751(0x479)](_0x3b1751(0x362)),_0x130c92=document[_0x3b1751(0x479)](_0x3b1751(0x26f));_0x130c92[_0x3b1751(0x10dd)]['display']='block',_0x5871f4[_0x3b1751(0x97b)]=_0x49433c[_0x3b1751(0xe8d)]||'确定',_0x130c92['textContent']=_0x49433c[_0x3b1751(0xad8)]||'取消',_0x49433c['confirmButtonClass']?_0x5871f4[_0x3b1751(0x9cd)][_0x3b1751(0x807)](_0x49433c[_0x3b1751(0x656)]):_0x5871f4[_0x3b1751(0x9cd)][_0x3b1751(0x8b6)](_0x3b1751(0x95a)),_0x5871f4[_0x3b1751(0x1063)]=()=>{_0x28987a(!![]),_0x3acce8();},_0x130c92[_0x3b1751(0x1063)]=()=>{_0x28987a(![]),_0x3acce8();},_0x592249();});}function _0x1519c8(_0x56c80b,_0x23dce8){return new Promise(_0x558357=>{const _0x412347=_0x6666;_0x5330c0=_0x558357,_0x4a50ba[_0x412347(0x97b)]=_0x56c80b,_0x4df0bf[_0x412347(0x3de)]=_0x412347(0xcff)+_0x23dce8+_0x412347(0x1049);const _0x239bba=document['getElementById']('custom-modal-confirm'),_0x2e2dca=document['getElementById']('custom-modal-cancel');_0x2e2dca[_0x412347(0x10dd)][_0x412347(0x678)]=_0x412347(0xff8),_0x239bba[_0x412347(0x97b)]='好的',_0x239bba[_0x412347(0x1063)]=()=>{const _0x4e419b=_0x412347;_0x2e2dca[_0x4e419b(0x10dd)]['display']=_0x4e419b(0xee3),_0x239bba[_0x4e419b(0x97b)]='确定',_0x558357(!![]),_0x3acce8();},_0x592249();});}function _0x9a2c09(_0x50424a,_0x13b83b,_0x3c2b9a='',_0x5536e2=_0x85c4bf(0x56d),_0x5c88f9=''){return new Promise(_0x1dabf0=>{const _0x23d9fc=_0x6666;_0x5330c0=_0x1dabf0,_0x4a50ba[_0x23d9fc(0x97b)]=_0x50424a;const _0x200d1a=_0x23d9fc(0x754),_0x171b69=_0x5536e2===_0x23d9fc(0x1283)?_0x23d9fc(0x435)+_0x200d1a+_0x23d9fc(0xb56)+_0x13b83b+_0x23d9fc(0x911)+_0x3c2b9a+_0x23d9fc(0xc81):_0x23d9fc(0xc67)+_0x5536e2+_0x23d9fc(0xfdb)+_0x200d1a+_0x23d9fc(0xb56)+_0x13b83b+_0x23d9fc(0x74d)+_0x3c2b9a+'\x22>';_0x4df0bf[_0x23d9fc(0x3de)]=_0x5c88f9+_0x171b69;const _0x5d4092=document[_0x23d9fc(0x479)](_0x200d1a);_0x4df0bf['querySelectorAll'](_0x23d9fc(0xdb7))[_0x23d9fc(0x12be)](_0x220332=>{const _0x57d4cd=_0x23d9fc;_0x220332[_0x57d4cd(0xa75)](_0x57d4cd(0xd2f),()=>{const _0x194dce=_0x57d4cd,_0x4fea66=_0x220332[_0x194dce(0x13d4)]['template'];if(_0x4fea66)try{const _0x2b2cfe=JSON[_0x194dce(0x94c)](_0x4fea66);_0x5d4092[_0x194dce(0x4e0)]=JSON[_0x194dce(0x1308)](_0x2b2cfe,null,0x2),_0x5d4092[_0x194dce(0xc07)]();}catch(_0x3df2ee){console[_0x194dce(0xe3b)](_0x194dce(0x593),_0x3df2ee);}});});const _0x52a5f7=document[_0x23d9fc(0x479)](_0x23d9fc(0x362)),_0x5838cb=document[_0x23d9fc(0x479)](_0x23d9fc(0x26f));_0x52a5f7[_0x23d9fc(0x1063)]=()=>{const _0x23fab4=_0x23d9fc;_0x1dabf0(_0x5d4092[_0x23fab4(0x4e0)]),_0x3acce8();},_0x5838cb[_0x23d9fc(0x1063)]=()=>{_0x1dabf0(null),_0x3acce8();},_0x592249(),setTimeout(()=>_0x5d4092[_0x23d9fc(0xc07)](),0x64);});}function _0x5adb5e(_0x5cefc2,_0x1830ae){const _0x1ef7df=_0x85c4bf;return new Promise(_0x577d11=>{const _0x18ad34=_0x6666,_0x16d702=document[_0x18ad34(0x479)](_0x18ad34(0x11e1)),_0x4165a9=document[_0x18ad34(0x479)](_0x18ad34(0x109c)),_0x4d31e8=document[_0x18ad34(0x479)](_0x18ad34(0x96d)),_0x1427ee=document['querySelector'](_0x18ad34(0x27c));_0x4165a9[_0x18ad34(0x97b)]=_0x5cefc2,_0x4d31e8[_0x18ad34(0x3de)]='',_0x1427ee['innerHTML']='',_0x1427ee[_0x18ad34(0x10dd)][_0x18ad34(0xaba)]=_0x18ad34(0xf6e),_0x1830ae['forEach'](_0x5a3314=>{const _0x22586a=_0x18ad34,_0x7e3a71=document['createElement'](_0x22586a(0x7b6));_0x7e3a71[_0x22586a(0x97b)]=_0x5a3314[_0x22586a(0x56d)],_0x7e3a71[_0x22586a(0x1063)]=()=>{const _0x1b2ace=_0x22586a;_0x16d702[_0x1b2ace(0x9cd)][_0x1b2ace(0x8b6)](_0x1b2ace(0x45a)),_0x577d11(_0x5a3314[_0x1b2ace(0x4e0)]);},_0x1427ee[_0x22586a(0x9f4)](_0x7e3a71);});const _0x23ee74=document['createElement'](_0x18ad34(0x7b6));_0x23ee74['textContent']='取消',_0x23ee74['style']['marginTop']=_0x18ad34(0xed2),_0x23ee74[_0x18ad34(0x10dd)][_0x18ad34(0xcef)]=_0x18ad34(0xed2),_0x23ee74[_0x18ad34(0x10dd)]['backgroundColor']='#f0f0f0',_0x23ee74[_0x18ad34(0x1063)]=()=>{const _0x5a2a15=_0x18ad34;_0x16d702[_0x5a2a15(0x9cd)][_0x5a2a15(0x8b6)](_0x5a2a15(0x45a)),_0x577d11(null);},_0x1427ee[_0x18ad34(0x9f4)](_0x23ee74),_0x16d702[_0x18ad34(0x9cd)][_0x18ad34(0x807)](_0x18ad34(0x45a));})[_0x1ef7df(0xb4f)](()=>{const _0x120431=_0x1ef7df,_0x4f12aa=document['querySelector'](_0x120431(0x27c));_0x4f12aa[_0x120431(0x10dd)][_0x120431(0xaba)]=_0x120431(0xfdc),_0x4f12aa['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22custom-modal-cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22custom-modal-confirm\x22\x20class=\x22confirm-btn\x22>确定</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',document['getElementById'](_0x120431(0x26f))['addEventListener'](_0x120431(0xd2f),_0x3acce8);});}async function _0x162d18(){const _0x1da3db=_0x85c4bf,_0x477902=await _0x5adb5e(_0x1da3db(0xb95),[{'text':_0x1da3db(0xa1e),'value':_0x1da3db(0x1206)},{'text':_0x1da3db(0xcf9),'value':'paste'}]);if(_0x477902==='file')return new Promise(_0x2eddea=>{const _0x3f36d3=_0x1da3db,_0x172dbc=document[_0x3f36d3(0x479)](_0x3f36d3(0x5b5)),_0x403737=_0x19367=>{const _0x1cce92=_0x3f36d3,_0x1c3aea=_0x19367[_0x1cce92(0xfa2)][_0x1cce92(0xe63)][0x0];if(_0x1c3aea){const _0x599db8=new FileReader();_0x599db8[_0x1cce92(0x502)]=_0x2657ed=>_0x2eddea(_0x2657ed[_0x1cce92(0xfa2)]['result']),_0x599db8[_0x1cce92(0x1337)]=()=>_0x2eddea(''),_0x599db8[_0x1cce92(0x19f)](_0x1c3aea);}else _0x2eddea(null);_0x172dbc[_0x1cce92(0xdec)](_0x1cce92(0x1150),_0x403737),_0x172dbc[_0x1cce92(0x4e0)]='';};_0x172dbc['addEventListener'](_0x3f36d3(0x1150),_0x403737,{'once':!![]}),_0x172dbc[_0x3f36d3(0xd2f)]();});else{if(_0x477902===_0x1da3db(0x12b1)){const _0x352d84=await _0x9a2c09(_0x1da3db(0x294),_0x1da3db(0xb54),'',_0x1da3db(0x1283));if(_0x352d84){const _0x1cbacf=_0x352d84[_0x1da3db(0x491)](/\[/g,'\x0a[')['trim']();return _0x1cbacf;}return _0x352d84;}else return null;}}_0xb81d4e[_0x85c4bf(0x1094)](0x27)[_0x85c4bf(0x5f1)]({'doubanPosts':_0x85c4bf(0x1172),'chats':'&id,\x20isGroup,\x20groupId,\x20isPinned,\x20memos,\x20diary,\x20appUsageLog,\x20lastIntelligentSummaryTimestamp','apiConfig':_0x85c4bf(0x129a),'globalSettings':'&id','userStickers':'&id,\x20url,\x20name,\x20categoryId','worldBooks':_0x85c4bf(0x117b),'worldBookCategories':_0x85c4bf(0x113d),'musicLibrary':_0x85c4bf(0x1336),'personaPresets':'&id','qzoneSettings':'&id','qzonePosts':_0x85c4bf(0xe20),'qzoneAlbums':_0x85c4bf(0xe35),'qzonePhotos':_0x85c4bf(0x943),'favorites':_0x85c4bf(0x615),'qzoneGroups':_0x85c4bf(0x113d),'memories':_0x85c4bf(0x129f),'callRecords':_0x85c4bf(0x1111),'shoppingProducts':_0x85c4bf(0xb11),'shoppingCategories':_0x85c4bf(0x113d),'apiPresets':_0x85c4bf(0x113d),'renderingRules':_0x85c4bf(0xafa),'appearancePresets':_0x85c4bf(0xf51),'stickerCategories':'++id,\x20name','customAvatarFrames':_0x85c4bf(0x113d),'presets':_0x85c4bf(0x117b),'presetCategories':'++id,\x20name','readingLibrary':_0x85c4bf(0x2cc),'npcs':_0x85c4bf(0x6bd)})[_0x85c4bf(0xd20)](_0x2af8d8=>{const _0x6a26bd=_0x85c4bf;return _0x2af8d8['table'](_0x6a26bd(0xd1b))[_0x6a26bd(0xb94)]()[_0x6a26bd(0x629)](_0x42b76c=>{const _0x4f5b67=_0x6a26bd;if(typeof _0x42b76c['content']===_0x4f5b67(0x8d9)&&_0x42b76c[_0x4f5b67(0xac4)][_0x4f5b67(0x9c1)]()!=='')_0x42b76c['content']=[{'keys':[],'comment':_0x4f5b67(0xa4e),'content':_0x42b76c[_0x4f5b67(0xac4)]}];else!Array[_0x4f5b67(0x285)](_0x42b76c[_0x4f5b67(0xac4)])&&(_0x42b76c['content']=[]);_0x42b76c['content'][_0x4f5b67(0x12be)](_0x383e41=>{const _0x5c84a2=_0x4f5b67;typeof _0x383e41['enabled']==='undefined'&&(_0x383e41[_0x5c84a2(0x2b7)]=!![]);});});}),window['db']=_0xb81d4e;function _0x731d5(_0x59f4bf){const _0x232a35=_0x85c4bf;_0x59f4bf==='chat-list-screen'&&(window[_0x232a35(0x104d)](),_0x104a0f(_0x232a35(0x770)));if(_0x59f4bf===_0x232a35(0xd36))window['renderApiSettingsProxy']();if(_0x59f4bf===_0x232a35(0xc35))window[_0x232a35(0x691)]();if(_0x59f4bf===_0x232a35(0x4f6))window[_0x232a35(0x11a2)]();if(_0x59f4bf===_0x232a35(0x13b6))window[_0x232a35(0x222)]();if(_0x59f4bf==='douban-screen')_0x3ea0a9();document[_0x232a35(0x99e)]('.screen')[_0x232a35(0x12be)](_0x5cb424=>_0x5cb424[_0x232a35(0x9cd)][_0x232a35(0x8b6)](_0x232a35(0x5a9)));const _0x4dd08a=document[_0x232a35(0x479)](_0x59f4bf);if(_0x4dd08a)_0x4dd08a[_0x232a35(0x9cd)][_0x232a35(0x807)](_0x232a35(0x5a9));if(_0x59f4bf===_0x232a35(0xdeb))window[_0x232a35(0xfbb)](_0x505390['activeChatId']);_0x59f4bf===_0x232a35(0x287)&&(_0x9193e5(),document[_0x232a35(0x479)](_0x232a35(0x13e0))['value']=_0x505390[_0x232a35(0x888)][_0x232a35(0x69a)]||'',_0x57f4d5(_0x505390[_0x232a35(0x888)]['fontUrl']||'',!![]));}window['updateListenTogetherIconProxy']=()=>{};function _0x104a0f(_0x1dbfcb){const _0x3cf124=_0x85c4bf,_0x3e5c1b=document['getElementById'](_0x3cf124(0xe34)),_0x2e8911={'messages-view':document[_0x3cf124(0x479)](_0x3cf124(0x770)),'qzone-screen':document['getElementById']('qzone-screen'),'favorites-view':document[_0x3cf124(0x479)](_0x3cf124(0x980)),'memories-view':document['getElementById'](_0x3cf124(0x739)),'npc-list-view':document[_0x3cf124(0x479)]('npc-list-view')},_0x487fd4=document[_0x3cf124(0x479)]('main-chat-list-header'),_0x260eb2=document[_0x3cf124(0x479)](_0x3cf124(0x9cb));_0x267d11&&document['getElementById'](_0x3cf124(0xf8a))[_0x3cf124(0xd2f)]();Object[_0x3cf124(0x3d5)](_0x2e8911)[_0x3cf124(0x12be)](_0xd7e015=>_0xd7e015[_0x3cf124(0x9cd)][_0x3cf124(0x8b6)](_0x3cf124(0x5a9)));_0x2e8911[_0x1dbfcb]&&_0x2e8911[_0x1dbfcb]['classList']['add'](_0x3cf124(0x5a9));document['querySelectorAll'](_0x3cf124(0x692))[_0x3cf124(0x12be)](_0x379289=>{const _0x49601b=_0x3cf124;_0x379289[_0x49601b(0x9cd)][_0x49601b(0x2bf)](_0x49601b(0x5a9),_0x379289[_0x49601b(0x13d4)][_0x49601b(0x1329)]===_0x1dbfcb);});_0x1dbfcb===_0x3cf124(0x770)?(_0x487fd4[_0x3cf124(0x10dd)][_0x3cf124(0x678)]='flex',_0x260eb2['style']['display']=_0x3cf124(0x899)):(_0x487fd4[_0x3cf124(0x10dd)][_0x3cf124(0x678)]=_0x3cf124(0xff8),_0x260eb2[_0x3cf124(0x10dd)]['display']=_0x3cf124(0xff8));_0x1dbfcb!==_0x3cf124(0x739)&&(_0x1f7cc8[_0x3cf124(0x12be)](_0x521c87=>clearInterval(_0x521c87)),_0x1f7cc8=[]);switch(_0x1dbfcb){case _0x3cf124(0xc8d):_0x2e8911[_0x3cf124(0xc8d)]['style'][_0x3cf124(0x11a6)]=_0x3cf124(0x1389),_0xa385c3(0x0),_0xad28fe(),_0x2eb20b();break;case'favorites-view':_0x2e8911['favorites-view']['style'][_0x3cf124(0x11a6)]=_0x3cf124(0x5ff),_0xafbc68();break;case'messages-view':break;case _0x3cf124(0x883):_0x5671c8();break;}}function _0x12308d(){console['log']('渲染X社交页面');}window['renderXSocialScreenProxy']=_0x12308d;function _0xad28fe(){const _0x4b12b8=_0x85c4bf;if(_0x505390&&_0x505390[_0x4b12b8(0x1190)]){const _0x156c70=_0x505390[_0x4b12b8(0x1190)];document['getElementById'](_0x4b12b8(0x913))[_0x4b12b8(0x97b)]=_0x156c70[_0x4b12b8(0x904)],document[_0x4b12b8(0x479)]('qzone-avatar-img')[_0x4b12b8(0xa9c)]=_0x156c70[_0x4b12b8(0x799)],document[_0x4b12b8(0x479)](_0x4b12b8(0xafb))['src']=_0x156c70[_0x4b12b8(0x59d)];}}window[_0x85c4bf(0x8a7)]=_0xad28fe;async function _0x1d3d0a(){const _0x4f5cb8=_0x85c4bf;_0xb81d4e&&_0x505390['qzoneSettings']&&await _0xb81d4e[_0x4f5cb8(0x1190)][_0x4f5cb8(0x5d0)](_0x505390['qzoneSettings']);}function _0x5af3d7(_0x136393){const _0x4d312f=_0x85c4bf;if(!_0x136393)return'';const _0x16a822=new Date(),_0x5b46aa=new Date(_0x136393),_0x354e4b=Math[_0x4d312f(0xd71)]((_0x16a822-_0x5b46aa)/0x3e8),_0x65e629=Math[_0x4d312f(0xd71)](_0x354e4b/0x3c),_0x6a5577=Math['floor'](_0x65e629/0x3c);if(_0x65e629<0x1)return'刚刚';if(_0x65e629<0x3c)return _0x65e629+'分钟前';if(_0x6a5577<0x18)return _0x6a5577+'小时前';const _0x52a3e1=_0x5b46aa['getFullYear'](),_0x2e1e4f=String(_0x5b46aa[_0x4d312f(0x180)]()+0x1)[_0x4d312f(0x738)](0x2,'0'),_0x42862d=String(_0x5b46aa['getDate']())[_0x4d312f(0x738)](0x2,'0'),_0x5cc90a=String(_0x5b46aa[_0x4d312f(0x507)]())[_0x4d312f(0x738)](0x2,'0'),_0x5b20e5=String(_0x5b46aa[_0x4d312f(0x28c)]())[_0x4d312f(0x738)](0x2,'0');return _0x16a822['getFullYear']()===_0x52a3e1?_0x2e1e4f+'-'+_0x42862d+'\x20'+_0x5cc90a+':'+_0x5b20e5:_0x52a3e1+'-'+_0x2e1e4f+'-'+_0x42862d+'\x20'+_0x5cc90a+':'+_0x5b20e5;}function _0xaf230d(_0x34a6a8){const _0x695f73=_0x85c4bf,_0x5b607e=document[_0x695f73(0x8bc)]('.qzone-post-container[data-post-id=\x22'+_0x34a6a8['id']+'\x22]'),_0x4202f5=!!_0x5b607e,_0x495c09=_0x4202f5?_0x5b607e:document[_0x695f73(0xbd5)](_0x695f73(0x6c8));!_0x4202f5&&(_0x495c09[_0x695f73(0xfd4)]=_0x695f73(0x8a5),_0x495c09[_0x695f73(0x13d4)][_0x695f73(0x403)]=_0x34a6a8['id']);const _0x3b0281=_0x4202f5?_0x495c09[_0x695f73(0x8bc)](_0x695f73(0xe11)):document[_0x695f73(0xbd5)](_0x695f73(0x6c8));!_0x4202f5&&(_0x3b0281[_0x695f73(0xfd4)]=_0x695f73(0x2c5));let _0x4b97d5='',_0x238a83='',_0x4099bd=_0x505390['qzoneSettings'][_0x695f73(0x799)];if(_0x34a6a8[_0x695f73(0x981)]===_0x695f73(0x4c5))_0x4b97d5=_0x505390[_0x695f73(0x1190)][_0x695f73(0x799)],_0x238a83=_0x505390[_0x695f73(0x1190)][_0x695f73(0x904)];else{if(_0x505390[_0x695f73(0x1027)][_0x34a6a8[_0x695f73(0x981)]]){const _0x848a0a=_0x505390[_0x695f73(0x1027)][_0x34a6a8[_0x695f73(0x981)]];_0x4b97d5=_0x848a0a[_0x695f73(0x18a)][_0x695f73(0x1039)]||_0x28c106,_0x238a83=_0x848a0a['name'];}else _0x238a83=_0x148d9b(_0x34a6a8['authorOriginalName']),_0x4b97d5=_0x28c106;}function _0x1b792c(_0x2ade88){const _0x5b2f8c=_0x695f73;let _0x335ddc='';const _0x34fe92=_0x2ade88[_0x5b2f8c(0x105a)]?'<div\x20class=\x22post-content\x22>'+_0x23554f(_0x2ade88[_0x5b2f8c(0x105a)])[_0x5b2f8c(0x491)](/\n/g,_0x5b2f8c(0x1043))+'</div>':'';if(_0x2ade88[_0x5b2f8c(0x858)]===_0x5b2f8c(0x395))_0x335ddc=_0x5b2f8c(0x1301)+_0x23554f(_0x2ade88['content'])[_0x5b2f8c(0x491)](/\n/g,_0x5b2f8c(0x1043))+'</div>';else{if(_0x2ade88[_0x5b2f8c(0x858)]===_0x5b2f8c(0x133a)&&_0x2ade88[_0x5b2f8c(0xa09)])_0x335ddc=_0x34fe92?_0x34fe92+_0x5b2f8c(0x125a)+_0x2ade88[_0x5b2f8c(0xa09)]+'\x22\x20class=\x22chat-image\x22></div>':_0x5b2f8c(0xdba)+_0x2ade88[_0x5b2f8c(0xa09)]+'\x22\x20class=\x22chat-image\x22>';else{if(_0x2ade88[_0x5b2f8c(0x858)]==='text_image'){const _0xf41b95=_0x505390['globalSettings'][_0x5b2f8c(0x105c)]&&_0x2ade88[_0x5b2f8c(0xfb2)]?_0x5b2f8c(0x730)+_0x2ade88['image_prompt']:_0x5b2f8c(0x775);_0x335ddc=_0x34fe92?_0x34fe92+_0x5b2f8c(0x125a)+_0xf41b95+'\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22'+_0x2ade88[_0x5b2f8c(0x112d)]+_0x5b2f8c(0xd5b):'<img\x20src=\x22'+_0xf41b95+_0x5b2f8c(0x76a)+_0x2ade88['hiddenContent']+'\x22>';}else{if(_0x2ade88[_0x5b2f8c(0x858)]===_0x5b2f8c(0x12c7)){const _0x4ad55e=_0x2ade88[_0x5b2f8c(0x7de)]||(_0x2ade88[_0x5b2f8c(0xa09)]?[_0x2ade88[_0x5b2f8c(0xa09)]]:[]);if(_0x4ad55e[_0x5b2f8c(0x990)]>0x0){const _0x30ea0e=_0x4ad55e[_0x5b2f8c(0x990)];let _0x4b2fdf='';_0x4b2fdf='<div\x20class=\x22post-images-grid\x20grid-'+_0x30ea0e+'\x22>',_0x4ad55e['forEach']((_0x3bf7b4,_0x620af6)=>{const _0x161d03=_0x5b2f8c;_0x4b2fdf+='<img\x20src=\x22'+_0x3bf7b4+_0x161d03(0xb13)+(_0x620af6+0x1)+_0x161d03(0xf30);}),_0x4b2fdf+=_0x5b2f8c(0x2c3),_0x335ddc=_0x34fe92?''+_0x34fe92+_0x4b2fdf:_0x4b2fdf;}}else{if(_0x2ade88[_0x5b2f8c(0x858)]===_0x5b2f8c(0x1cc)){const _0x331b72=_0x2ade88[_0x5b2f8c(0x7de)]||(_0x2ade88['imageUrl']?[_0x2ade88['imageUrl']]:[]);if(_0x331b72[_0x5b2f8c(0x990)]>0x0){const _0x10a6ac=_0x331b72[_0x5b2f8c(0x990)];let _0x4331d9='';_0x4331d9=_0x5b2f8c(0x50b)+_0x10a6ac+'\x22>',_0x331b72[_0x5b2f8c(0x12be)]((_0x4ba1b4,_0x3904f4)=>{const _0x48d0ad=_0x5b2f8c;_0x4331d9+='<img\x20src=\x22'+_0x4ba1b4+_0x48d0ad(0x9fc)+(_0x3904f4+0x1)+_0x48d0ad(0xf30);}),_0x4331d9+=_0x5b2f8c(0x2c3),_0x335ddc=_0x34fe92?''+_0x34fe92+_0x4331d9:_0x4331d9;}}}}}}return _0x335ddc;}let _0x52375f;if(_0x34a6a8[_0x695f73(0x858)]===_0x695f73(0xe30)){const _0x258d5a=_0x34a6a8[_0x695f73(0x3aa)]?_0x695f73(0xf13)+_0x23554f(_0x34a6a8['repostComment'])['replace'](/\n/g,_0x695f73(0x1043))+_0x695f73(0x2c3):'';let _0x3780b6=_0x28c106,_0x12fa2b=_0x695f73(0xbe2);if(_0x34a6a8[_0x695f73(0x445)]['authorId']===_0x695f73(0x4c5))_0x3780b6=_0x505390[_0x695f73(0x1190)]['avatar'],_0x12fa2b=_0x505390[_0x695f73(0x1190)]['nickname'];else{const _0xcc8bef=_0x505390[_0x695f73(0x1027)][_0x34a6a8[_0x695f73(0x445)][_0x695f73(0x981)]];_0xcc8bef&&(_0x3780b6=_0xcc8bef[_0x695f73(0x18a)]['aiAvatar']||_0x28c106),_0x12fa2b=_0x148d9b(_0x34a6a8[_0x695f73(0x445)]['authorOriginalName']);}_0x52375f='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x258d5a+_0x695f73(0xe6e)+_0x3780b6+'\x22\x20class=\x22post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>@'+_0x12fa2b+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>'+_0x5af3d7(_0x34a6a8[_0x695f73(0x445)][_0x695f73(0x12a2)])+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-main-content\x22>'+_0x1b792c(_0x34a6a8[_0x695f73(0x445)])+_0x695f73(0xd23);}else _0x52375f=_0x695f73(0x4fc)+_0x1b792c(_0x34a6a8)+_0x695f73(0x2c3);let _0x4cf8e6='';if(_0x34a6a8[_0x695f73(0x12e3)]&&_0x34a6a8[_0x695f73(0x12e3)][_0x695f73(0x990)]>0x0){const _0x41a5b2=_0x34a6a8[_0x695f73(0x12e3)]['map'](_0x15e80d=>_0x148d9b(_0x15e80d))['join']('、');_0x4cf8e6=_0x695f73(0x37c)+_0x41a5b2+_0x695f73(0x324);}let _0x5f1f5a='';_0x34a6a8[_0x695f73(0xd3c)]&&_0x34a6a8['comments'][_0x695f73(0x990)]>0x0&&(_0x5f1f5a=_0x695f73(0xdae),_0x34a6a8['comments'][_0x695f73(0x12be)]((_0x20a00e,_0x130ca6)=>{const _0x5a823e=_0x695f73;if(typeof _0x20a00e==='object'&&_0x20a00e!==null&&_0x20a00e['commenterName']){const _0x4b9dfa=_0x20a00e[_0x5a823e(0x13e3)],_0x5b7182=_0x148d9b(_0x4b9dfa);let _0x20dcf8;_0x554a0b['test'](_0x20a00e[_0x5a823e(0x56d)])?_0x20dcf8=_0x5a823e(0xdba)+_0x20a00e[_0x5a823e(0x56d)]+_0x5a823e(0xc47):_0x20dcf8=_0x23554f(_0x20a00e[_0x5a823e(0x56d)]);let _0x5bf597='';if(_0x20a00e['replyTo']){const _0x5e5c80=_0x148d9b(_0x20a00e[_0x5a823e(0x32a)]);_0x5bf597=_0x5a823e(0x6cc)+_0x5b7182+_0x5a823e(0xd2e)+_0x5e5c80+_0x5a823e(0x4d5)+_0x20dcf8;}else _0x5bf597=_0x5a823e(0x6cc)+_0x5b7182+'</span>:\x20'+_0x20dcf8;_0x5f1f5a+=_0x5a823e(0x721)+_0x34a6a8['id']+_0x5a823e(0x5e1)+_0x4b9dfa+'\x22\x20data-commenter-display-name=\x22'+_0x5b7182+_0x5a823e(0xe76)+_0x5bf597+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22'+_0x130ca6+_0x5a823e(0xb01);}else _0x5f1f5a+='<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>'+_0x23554f(String(_0x20a00e))+_0x5a823e(0x1378);}),_0x5f1f5a+=_0x695f73(0x2c3));const _0x209892=_0x505390[_0x695f73(0x1190)]['nickname'],_0xfb5d8=_0x34a6a8[_0x695f73(0x12e3)]&&_0x34a6a8[_0x695f73(0x12e3)]['includes'](_0x209892),_0x4ba90e=_0x505390[_0x695f73(0xae6)]&&_0x505390[_0x695f73(0xae6)][_0x695f73(0x391)](_0x34a6a8['id']);let _0x3c6044='';_0x34a6a8['type']!==_0x695f73(0xe30)&&(_0x3c6044='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20repost\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M17\x202.1l4\x204-4\x204\x20M3\x2011.5v-3a4\x204\x200\x200\x201\x204-4h13\x20M7\x2021.9l-4-4\x204-4\x20M21\x2012.5v3a4\x204\x200\x200\x201-4\x204H4\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>');_0x3b0281[_0x695f73(0x3de)]=_0x695f73(0x830)+_0x4b97d5+'\x22\x20class=\x22post-avatar\x22\x20data-author-id=\x22'+_0x34a6a8['authorId']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>'+_0x238a83+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>'+_0x5af3d7(_0x34a6a8[_0x695f73(0x12a2)])+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-actions-btn\x22>…</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x52375f+_0x695f73(0x13f6)+_0x3c6044+_0x695f73(0xfd2)+(_0xfb5d8?_0x695f73(0x5a9):'')+_0x695f73(0x333)+(_0x4ba90e?_0x695f73(0x5a9):'')+_0x695f73(0xa0f)+_0x4cf8e6+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x5f1f5a+_0x695f73(0xabc)+_0x4099bd+_0x695f73(0xd3b);if(!_0x4202f5){const _0x65b546=document[_0x695f73(0xbd5)](_0x695f73(0x6c8));_0x65b546[_0x695f73(0xfd4)]=_0x695f73(0xbaf),_0x65b546[_0x695f73(0x3de)]=_0x695f73(0x9b7),_0x495c09[_0x695f73(0x9f4)](_0x3b0281),_0x495c09[_0x695f73(0x9f4)](_0x65b546);}return _0x495c09;}async function _0x7cb448(_0x48e954){const _0x555cc0=_0x85c4bf,_0x200b93=await _0xb81d4e[_0x555cc0(0xcce)][_0x555cc0(0x111a)](_0x48e954);if(!_0x200b93){const _0x5273e4=document[_0x555cc0(0x8bc)](_0x555cc0(0x69b)+_0x48e954+'\x22]');if(_0x5273e4)_0x5273e4[_0x555cc0(0x8b6)]();return;}const _0xe7412d=_0x5a98bc[_0x555cc0(0x120c)](_0x3c6814=>_0x3c6814['id']===_0x48e954);if(_0xe7412d>-0x1)_0x5a98bc[_0xe7412d]=_0x200b93;const _0x243937=await _0xb81d4e[_0x555cc0(0x3e8)]['where'](_0x555cc0(0x858))[_0x555cc0(0x4a2)](_0x555cc0(0x239))[_0x555cc0(0x4ba)]();_0x505390[_0x555cc0(0xae6)]=new Set(_0x243937['map'](_0x90b97b=>_0x90b97b[_0x555cc0(0xac4)]['id'])),_0xaf230d(_0x200b93);}function _0x3e14b1(_0x5b2ae7){const _0x18061b=_0x85c4bf,_0x375fc4=Date[_0x18061b(0x12d6)](),_0x45aa87=Math['floor']((_0x375fc4-_0x5b2ae7)/0x3e8),_0x3bfc0d=Math[_0x18061b(0xd71)](_0x45aa87/0x3c);if(_0x3bfc0d<0x2)return'刚刚';if(_0x3bfc0d<0x3c)return _0x3bfc0d+_0x18061b(0x58c);const _0x748a7d=Math[_0x18061b(0xd71)](_0x3bfc0d/0x3c);if(_0x748a7d<0x18)return _0x748a7d+'小时前';const _0x25244b=Math[_0x18061b(0xd71)](_0x748a7d/0x18);return _0x25244b+'天前';}async function _0xaf230d(_0x3a4bc8){const _0xe00e98=_0x85c4bf,_0x2ff0f3=document[_0xe00e98(0x8bc)](_0xe00e98(0x69b)+_0x3a4bc8['id']+'\x22]'),_0x238510=!!_0x2ff0f3,_0x26ee72=_0x238510?_0x2ff0f3:document['createElement']('div');!_0x238510&&(_0x26ee72[_0xe00e98(0xfd4)]=_0xe00e98(0x8a5),_0x26ee72[_0xe00e98(0x13d4)][_0xe00e98(0x403)]=_0x3a4bc8['id']);const _0x4f98c8=_0x238510?_0x26ee72[_0xe00e98(0x8bc)](_0xe00e98(0xe11)):document[_0xe00e98(0xbd5)]('div');!_0x238510&&(_0x4f98c8['className']='qzone-post-item');let _0x41f767='',_0x521a70='',_0xec86ca=_0x505390['qzoneSettings'][_0xe00e98(0x799)];if(_0x3a4bc8[_0xe00e98(0x981)]===_0xe00e98(0x4c5))_0x41f767=_0x505390[_0xe00e98(0x1190)]['avatar'],_0x521a70=_0x505390[_0xe00e98(0x1190)][_0xe00e98(0x904)];else{if(_0x505390[_0xe00e98(0x1027)][_0x3a4bc8[_0xe00e98(0x981)]]){const _0xdeb26c=_0x505390[_0xe00e98(0x1027)][_0x3a4bc8[_0xe00e98(0x981)]];_0x41f767=_0xdeb26c[_0xe00e98(0x18a)][_0xe00e98(0x1039)]||_0x28c106,_0x521a70=_0xdeb26c[_0xe00e98(0x564)];}else{if(String(_0x3a4bc8[_0xe00e98(0x981)])['startsWith']('npc_')){const _0x5863f7=parseInt(String(_0x3a4bc8['authorId'])['replace'](_0xe00e98(0xca5),''));if(!isNaN(_0x5863f7)){const _0x1798a6=await _0xb81d4e[_0xe00e98(0x482)][_0xe00e98(0x111a)](_0x5863f7);_0x1798a6?(_0x41f767=_0x1798a6[_0xe00e98(0x799)]||_0x3ea4df,_0x521a70=_0x1798a6[_0xe00e98(0x564)]):(_0x521a70=_0x3a4bc8[_0xe00e98(0x91b)]||_0xe00e98(0xf4a),_0x41f767=_0x3ea4df);}}else _0x521a70=_0x148d9b(_0x3a4bc8['authorOriginalName']),_0x41f767=_0x28c106;}}function _0x4fedc9(_0x179ebf){const _0xa9c154=_0xe00e98;let _0x464524='';const _0x48d9fc=_0x179ebf[_0xa9c154(0x105a)]?'<div\x20class=\x22post-content\x22>'+_0x23554f(_0x179ebf[_0xa9c154(0x105a)])['replace'](/\n/g,'<br>')+_0xa9c154(0x2c3):'';if(_0x179ebf[_0xa9c154(0x858)]===_0xa9c154(0x395))_0x464524='<div\x20class=\x22post-content\x22\x20style=\x22margin-bottom:\x2010px;\x22>'+_0x23554f(_0x179ebf[_0xa9c154(0xac4)])['replace'](/\n/g,_0xa9c154(0x1043))+_0xa9c154(0x2c3);else{if(_0x179ebf[_0xa9c154(0x858)]===_0xa9c154(0x133a)&&_0x179ebf[_0xa9c154(0xa09)])_0x464524=_0x48d9fc?_0x48d9fc+_0xa9c154(0x125a)+_0x179ebf['imageUrl']+'\x22\x20class=\x22chat-image\x22></div>':_0xa9c154(0xdba)+_0x179ebf[_0xa9c154(0xa09)]+'\x22\x20class=\x22chat-image\x22>';else{if(_0x179ebf[_0xa9c154(0x858)]===_0xa9c154(0xd84)){const _0x43fd69=_0x505390[_0xa9c154(0x888)][_0xa9c154(0x105c)]&&_0x179ebf['image_prompt']?_0xa9c154(0x730)+_0x179ebf[_0xa9c154(0xfb2)]:'https://i.postimg.cc/KYr2qRCK/1.jpg';_0x464524=_0x48d9fc?_0x48d9fc+'<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22'+_0x43fd69+_0xa9c154(0x76a)+_0x179ebf['hiddenContent']+_0xa9c154(0xd5b):_0xa9c154(0xdba)+_0x43fd69+_0xa9c154(0x76a)+_0x179ebf[_0xa9c154(0x112d)]+'\x22>';}else{if(_0x179ebf['type']===_0xa9c154(0x12c7)){const _0x17cd03=_0x179ebf[_0xa9c154(0x7de)]||(_0x179ebf['imageUrl']?[_0x179ebf[_0xa9c154(0xa09)]]:[]);if(_0x17cd03[_0xa9c154(0x990)]>0x0){const _0x2f49b0=_0x17cd03['length'];let _0x832477='';_0x832477=_0xa9c154(0x50b)+_0x2f49b0+'\x22>',_0x17cd03['forEach']((_0x4e36cc,_0x5ce115)=>{const _0x344c54=_0xa9c154;_0x832477+=_0x344c54(0xdba)+_0x4e36cc+_0x344c54(0xb13)+(_0x5ce115+0x1)+_0x344c54(0xf30);}),_0x832477+=_0xa9c154(0x2c3),_0x464524=_0x48d9fc?''+_0x48d9fc+_0x832477:_0x832477;}}else{if(_0x179ebf['type']==='naiimag'){const _0x5438d1=_0x179ebf[_0xa9c154(0x7de)]||(_0x179ebf[_0xa9c154(0xa09)]?[_0x179ebf[_0xa9c154(0xa09)]]:[]);if(_0x5438d1['length']>0x0){const _0x52e34f=_0x5438d1[_0xa9c154(0x990)];let _0xedf19a='';_0xedf19a=_0xa9c154(0x50b)+_0x52e34f+'\x22>',_0x5438d1[_0xa9c154(0x12be)]((_0x27fa48,_0xb10ff1)=>{const _0x39caf6=_0xa9c154;_0xedf19a+=_0x39caf6(0xdba)+_0x27fa48+_0x39caf6(0x9fc)+(_0xb10ff1+0x1)+_0x39caf6(0xf30);}),_0xedf19a+=_0xa9c154(0x2c3),_0x464524=_0x48d9fc?''+_0x48d9fc+_0xedf19a:_0xedf19a;}}}}}}return _0x464524;}let _0x32eecd;if(_0x3a4bc8[_0xe00e98(0x858)]===_0xe00e98(0xe30)){const _0x29bf12=_0x3a4bc8[_0xe00e98(0x3aa)]?_0xe00e98(0xf13)+_0x3a4bc8[_0xe00e98(0x3aa)]['replace'](/\n/g,_0xe00e98(0x1043))+_0xe00e98(0x2c3):'';let _0x5193af=_0x28c106,_0x5d0ff2='原作者';if(_0x3a4bc8[_0xe00e98(0x445)][_0xe00e98(0x981)]===_0xe00e98(0x4c5))_0x5193af=_0x505390[_0xe00e98(0x1190)][_0xe00e98(0x799)],_0x5d0ff2=_0x505390['qzoneSettings'][_0xe00e98(0x904)];else{const _0x448a0f=_0x505390[_0xe00e98(0x1027)][_0x3a4bc8[_0xe00e98(0x445)][_0xe00e98(0x981)]];_0x448a0f&&(_0x5193af=_0x448a0f[_0xe00e98(0x18a)][_0xe00e98(0x1039)]||_0x28c106),_0x5d0ff2=_0x148d9b(_0x3a4bc8[_0xe00e98(0x445)]['authorOriginalName']);}_0x32eecd=_0xe00e98(0x12cf)+_0x29bf12+_0xe00e98(0xe6e)+_0x5193af+_0xe00e98(0xbed)+_0x5d0ff2+_0xe00e98(0x91a)+_0x5af3d7(_0x3a4bc8[_0xe00e98(0x445)][_0xe00e98(0x12a2)])+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-main-content\x22>'+_0x4fedc9(_0x3a4bc8['originalPost'])+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';}else _0x32eecd=_0xe00e98(0x4fc)+_0x4fedc9(_0x3a4bc8)+_0xe00e98(0x2c3);let _0x59a4f0='';if(_0x3a4bc8['likes']&&_0x3a4bc8['likes']['length']>0x0){const _0x4a6424=_0x3a4bc8['likes'][_0xe00e98(0x2e1)](_0x32249f=>_0x148d9b(_0x32249f))[_0xe00e98(0x35d)]('、');_0x59a4f0='<div\x20class=\x22post-likes-section\x22><svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg><span>'+_0x4a6424+'\x20觉得很赞</span></div>';}let _0x48511b='';_0x3a4bc8[_0xe00e98(0xd3c)]&&_0x3a4bc8['comments'][_0xe00e98(0x990)]>0x0&&(_0x48511b=_0xe00e98(0xdae),_0x3a4bc8['comments']['forEach']((_0x490f37,_0x52c1a9)=>{const _0x2101a6=_0xe00e98;if(typeof _0x490f37===_0x2101a6(0x65a)&&_0x490f37!==null&&_0x490f37[_0x2101a6(0x13e3)]){const _0x3f41d2=_0x490f37[_0x2101a6(0x13e3)],_0x5d904f=_0x148d9b(_0x3f41d2);let _0x113ae8;_0x554a0b[_0x2101a6(0x101d)](_0x490f37[_0x2101a6(0x56d)])?_0x113ae8='<img\x20src=\x22'+_0x490f37[_0x2101a6(0x56d)]+_0x2101a6(0xc47):_0x113ae8=_0x23554f(_0x490f37[_0x2101a6(0x56d)]);let _0xa29d0d='';if(_0x490f37[_0x2101a6(0x32a)]){const _0x1df437=_0x148d9b(_0x490f37['replyTo']);_0xa29d0d=_0x2101a6(0x6cc)+_0x5d904f+'</span>\x20回复\x20<span\x20class=\x22commenter-name\x22>'+_0x1df437+_0x2101a6(0x4d5)+_0x113ae8;}else _0xa29d0d='<span\x20class=\x22commenter-name\x22>'+_0x5d904f+_0x2101a6(0x4d5)+_0x113ae8;_0x48511b+='<div\x20class=\x22comment-item\x22\x20data-post-id=\x22'+_0x3a4bc8['id']+_0x2101a6(0x5e1)+_0x3f41d2+_0x2101a6(0x1012)+_0x5d904f+_0x2101a6(0xe76)+_0xa29d0d+_0x2101a6(0xad1)+_0x52c1a9+'\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';}else _0x48511b+=_0x2101a6(0xfc7)+String(_0x490f37)+_0x2101a6(0x1378);}),_0x48511b+=_0xe00e98(0x2c3));const _0x542c84=_0x505390[_0xe00e98(0x1190)][_0xe00e98(0x904)],_0x5eba46=_0x3a4bc8[_0xe00e98(0x12e3)]&&_0x3a4bc8[_0xe00e98(0x12e3)][_0xe00e98(0x44f)](_0x542c84),_0xa16bbc=_0x505390[_0xe00e98(0xae6)]&&_0x505390[_0xe00e98(0xae6)][_0xe00e98(0x391)](_0x3a4bc8['id']);let _0x1c690f='';_0x3a4bc8[_0xe00e98(0x858)]!==_0xe00e98(0xe30)&&(_0x1c690f=_0xe00e98(0x293));_0x4f98c8['innerHTML']=_0xe00e98(0x830)+_0x41f767+_0xe00e98(0x376)+_0x3a4bc8['authorId']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>'+_0x521a70+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>'+_0x5af3d7(_0x3a4bc8[_0xe00e98(0x12a2)])+_0xe00e98(0x1bf)+_0x32eecd+_0xe00e98(0x13f6)+_0x1c690f+_0xe00e98(0xfd2)+(_0x5eba46?_0xe00e98(0x5a9):'')+_0xe00e98(0x333)+(_0xa16bbc?_0xe00e98(0x5a9):'')+_0xe00e98(0xa0f)+_0x59a4f0+_0xe00e98(0xf43)+_0x48511b+_0xe00e98(0xabc)+_0xec86ca+_0xe00e98(0xd3b);if(!_0x238510){const _0x32591e=document[_0xe00e98(0xbd5)](_0xe00e98(0x6c8));_0x32591e[_0xe00e98(0xfd4)]=_0xe00e98(0xbaf),_0x32591e[_0xe00e98(0x3de)]=_0xe00e98(0x9b7),_0x26ee72[_0xe00e98(0x9f4)](_0x4f98c8),_0x26ee72['appendChild'](_0x32591e);}return _0x26ee72;}async function _0x7cb448(_0xb2c821){const _0x47269f=_0x85c4bf,_0xe4109f=await _0xb81d4e['qzonePosts'][_0x47269f(0x111a)](_0xb2c821);if(!_0xe4109f){const _0x5db953=document[_0x47269f(0x8bc)](_0x47269f(0x69b)+_0xb2c821+'\x22]');_0x5db953&&_0x5db953['remove']();return;}const _0x42294f=_0x5a98bc[_0x47269f(0x120c)](_0x303b4d=>_0x303b4d['id']===_0xb2c821);_0x42294f>-0x1&&(_0x5a98bc[_0x42294f]=_0xe4109f);const _0x5a92b4=await _0xb81d4e['favorites'][_0x47269f(0x46f)](_0x47269f(0x858))[_0x47269f(0x4a2)]('qzone_post')[_0x47269f(0x4ba)]();_0x505390[_0x47269f(0xae6)]=new Set(_0x5a92b4[_0x47269f(0x2e1)](_0x2eb824=>_0x2eb824[_0x47269f(0xac4)]['id'])),await _0xaf230d(_0xe4109f);}async function _0x2eb20b(){const _0x4849f7=_0x85c4bf,_0x5ee1af=document['getElementById'](_0x4849f7(0xa1c));if(!_0x5ee1af)return;const [_0x13fb98,_0x42bda8]=await Promise[_0x4849f7(0xf78)]([_0xb81d4e['qzonePosts'][_0x4849f7(0x3d2)](_0x4849f7(0x12a2))['reverse']()[_0x4849f7(0x85d)](_0x4abcc5=>!_0x4abcc5[_0x4849f7(0x52a)])['toArray'](),_0xb81d4e['favorites'][_0x4849f7(0x46f)](_0x4849f7(0x858))['equals'](_0x4849f7(0x239))['toArray']()]);_0x5a98bc=_0x13fb98,_0x505390[_0x4849f7(0xae6)]=new Set(_0x42bda8[_0x4849f7(0x2e1)](_0x398e7b=>_0x398e7b[_0x4849f7(0xac4)]['id'])),_0x5ee1af['innerHTML']='',_0xf8ae5e=0x0;if(_0x5a98bc[_0x4849f7(0x990)]===0x0){_0x5ee1af[_0x4849f7(0x3de)]=_0x4849f7(0x447);return;}_0x163d7a();}async function _0x163d7a(){const _0xea996=_0x85c4bf;if(_0xfa7cf0)return;_0xfa7cf0=!![];const _0x2381f5=document[_0xea996(0x479)](_0xea996(0xa1c));if(!_0x2381f5){_0xfa7cf0=![];return;}_0x13e918(_0x2381f5,'bottom'),setTimeout(async()=>{const _0x322dd2=_0xea996;_0x168e5c(_0x2381f5);const _0x2d4ca2=_0xf8ae5e,_0x3044e3=_0xf8ae5e+_0x3eaf56,_0x10e6e1=_0x5a98bc[_0x322dd2(0x777)](_0x2d4ca2,_0x3044e3),_0x5b2779=document[_0x322dd2(0x3dd)]();for(const _0x4e0275 of _0x10e6e1){const _0x60e4f=await _0xaf230d(_0x4e0275);_0x5b2779['appendChild'](_0x60e4f);}_0x2381f5[_0x322dd2(0x9f4)](_0x5b2779),_0xf8ae5e+=_0x10e6e1[_0x322dd2(0x990)],_0xfa7cf0=![];},0x1f4);}function _0x5c0317(_0x52cef9,_0x1e585c){const _0x3df5b2=_0x85c4bf,_0x14df1f=_0x50f1ba['panelEl'],_0x150746=_0x50f1ba[_0x3df5b2(0xad6)];_0x150746['innerHTML']='';_0x505390[_0x3df5b2(0x407)][_0x3df5b2(0x990)]===0x0?_0x150746[_0x3df5b2(0x3de)]=_0x3df5b2(0x13cc):_0x505390[_0x3df5b2(0x407)][_0x3df5b2(0x12be)](_0x17ed81=>{const _0x1aaa97=_0x3df5b2,_0x40be09=document[_0x1aaa97(0xbd5)]('div');_0x40be09[_0x1aaa97(0xfd4)]='sticker-item',_0x40be09[_0x1aaa97(0x10dd)]['backgroundImage']=_0x1aaa97(0x10d2)+_0x17ed81['url']+')',_0x40be09[_0x1aaa97(0xc29)]=_0x17ed81[_0x1aaa97(0x564)],_0x150746[_0x1aaa97(0x9f4)](_0x40be09);});const _0x365bc5=_0x1e585c[_0x3df5b2(0x10f7)](),_0x13b3f5=document['getElementById'](_0x3df5b2(0x2e2))[_0x3df5b2(0x10f7)]();_0x14df1f[_0x3df5b2(0x10dd)][_0x3df5b2(0x678)]='flex';const _0xa1cb=_0x14df1f[_0x3df5b2(0x10f7)](),_0x73ca23=_0xa1cb[_0x3df5b2(0xe41)],_0x4fbaf6=_0xa1cb[_0x3df5b2(0x9f2)];_0x14df1f['style']['top']=_0x365bc5[_0x3df5b2(0xb8f)]-_0x73ca23-0x5-_0x13b3f5[_0x3df5b2(0xb8f)]+'px';const _0x126864=_0x365bc5['left']-_0x13b3f5[_0x3df5b2(0x138f)];_0x126864+_0x4fbaf6>_0x13b3f5[_0x3df5b2(0x9f2)]?(_0x14df1f[_0x3df5b2(0x10dd)][_0x3df5b2(0x138f)]=_0x3df5b2(0x260),_0x14df1f[_0x3df5b2(0x10dd)][_0x3df5b2(0xd2d)]=_0x3df5b2(0x1267)):(_0x14df1f[_0x3df5b2(0x10dd)]['left']=_0x126864+'px',_0x14df1f[_0x3df5b2(0x10dd)][_0x3df5b2(0xd2d)]=_0x3df5b2(0x260)),_0x50f1ba['isOpen']=!![],_0x50f1ba[_0x3df5b2(0x25e)]=_0x52cef9;}function _0x3a8fa4(){const _0x148c2a=_0x85c4bf;_0x50f1ba['isOpen']&&(_0x50f1ba[_0x148c2a(0xe50)]['style'][_0x148c2a(0x678)]=_0x148c2a(0xff8),_0x50f1ba['isOpen']=![],_0x50f1ba['activePostId']=null);}async function _0x431fd0(_0x513dbd,_0x350580){const _0x136660=_0x85c4bf;if(!_0x350580||!_0x350580[_0x136660(0x5f3)])return;const _0x43746f=await _0xb81d4e[_0x136660(0xcce)][_0x136660(0x111a)](_0x513dbd);if(!_0x43746f){console[_0x136660(0xe3b)](_0x136660(0x8e4),_0x513dbd);return;}!_0x43746f[_0x136660(0xd3c)]&&(_0x43746f[_0x136660(0xd3c)]=[]);const _0x1e92ba={'commenterName':_0x505390[_0x136660(0x1190)][_0x136660(0x904)],'text':_0x350580['url'],'meaning':_0x350580['name'],'timestamp':Date['now']()};_0x43746f[_0x136660(0xd3c)][_0x136660(0x1a0)](_0x1e92ba),await _0xb81d4e[_0x136660(0xcce)][_0x136660(0xeb2)](_0x513dbd,{'comments':_0x43746f[_0x136660(0xd3c)]}),_0x3a8fa4(),await _0x2eb20b();const _0x7dfdef=(_0x43746f[_0x136660(0x105a)]||_0x43746f[_0x136660(0xac4)]||_0x136660(0x310))[_0x136660(0x1323)](0x0,0x1e);for(const _0x33dbcc in _0x505390[_0x136660(0x1027)]){const _0x1231c5=_0x505390[_0x136660(0x1027)][_0x33dbcc];if(!_0x1231c5['isGroup']){const _0xef4e6e=_0x136660(0x9c3)+_0x505390[_0x136660(0x1190)][_0x136660(0x904)]+_0x136660(0x52d)+_0x513dbd+',\x20内容摘要:\x20“'+_0x7dfdef+_0x136660(0xc7f)+_0x350580['name']+_0x136660(0xdc9),_0x1a6e70={'role':_0x136660(0xbaa),'content':_0xef4e6e,'timestamp':Date['now'](),'isHidden':!![]};_0x1231c5[_0x136660(0x7d3)][_0x136660(0x1a0)](_0x1a6e70),await _0xb81d4e[_0x136660(0x1027)]['put'](_0x1231c5);}}}function _0xca3fea(_0x49e955){const _0x175442=_0x85c4bf;_0x22bfaf=_0x49e955,document['getElementById'](_0x175442(0xcdc))['value']='',document[_0x175442(0x479)]('repost-modal')['classList'][_0x175442(0x807)](_0x175442(0x45a));}function _0x326b04(){const _0x1bc838=_0x85c4bf;document[_0x1bc838(0x479)](_0x1bc838(0x380))['classList'][_0x1bc838(0x8b6)](_0x1bc838(0x45a)),_0x22bfaf=null;}async function _0x2763d4(){const _0x14104b=_0x85c4bf;if(!_0x22bfaf)return;const _0x3271fb=document[_0x14104b(0x479)](_0x14104b(0xcdc))[_0x14104b(0x4e0)]['trim'](),_0x3bdf4c=await _0xb81d4e[_0x14104b(0xcce)]['get'](_0x22bfaf);if(!_0x3bdf4c){alert(_0x14104b(0xa51)),_0x326b04();return;}const _0x47e34d={'type':_0x14104b(0xe30),'timestamp':Date['now'](),'authorId':'user','repostComment':_0x3271fb,'originalPost':_0x3bdf4c,'visibleGroupIds':null};await _0xb81d4e[_0x14104b(0xcce)][_0x14104b(0x807)](_0x47e34d),_0x326b04(),await _0x2eb20b(),alert('转发成功！');}function _0x1da1be(_0x73820f){const _0x3936f7=_0x85c4bf,_0x41be10=document[_0x3936f7(0x479)](_0x3936f7(0x9ec));_0x41be10[_0x3936f7(0x3de)]='';if(_0x73820f[_0x3936f7(0x990)]===0x0){const _0x3f021b=document['getElementById'](_0x3936f7(0x626))[_0x3936f7(0x4e0)],_0xa06717=_0x3f021b?'未找到相关收藏':'你的收藏夹是空的，<br>快去动态或聊天中收藏喜欢的内容吧！';_0x41be10[_0x3936f7(0x3de)]=_0x3936f7(0xc30)+_0xa06717+'</p>';return;}for(const _0x54d959 of _0x73820f){const _0x4a5f9f=document[_0x3936f7(0xbd5)](_0x3936f7(0x6c8));_0x4a5f9f[_0x3936f7(0xfd4)]=_0x3936f7(0xd19),_0x4a5f9f[_0x3936f7(0x13d4)][_0x3936f7(0x186)]=_0x54d959['id'];let _0x4d4719='',_0x52c5ca='',_0x2efadf='',_0x30e315='';if(_0x54d959[_0x3936f7(0x858)]===_0x3936f7(0x239)){const _0x211030=_0x54d959['content'];_0x2efadf=_0x3936f7(0x8f4);let _0x1a7dea=_0x28c106,_0x80c0c5=_0x3936f7(0x831);if(_0x211030['authorId']==='user')_0x1a7dea=_0x505390[_0x3936f7(0x1190)][_0x3936f7(0x799)],_0x80c0c5=_0x505390[_0x3936f7(0x1190)][_0x3936f7(0x904)];else _0x505390['chats'][_0x211030['authorId']]&&(_0x1a7dea=_0x505390[_0x3936f7(0x1027)][_0x211030[_0x3936f7(0x981)]][_0x3936f7(0x18a)][_0x3936f7(0x1039)],_0x80c0c5=_0x505390[_0x3936f7(0x1027)][_0x211030[_0x3936f7(0x981)]][_0x3936f7(0x564)]);_0x4d4719=_0x3936f7(0xdba)+_0x1a7dea+_0x3936f7(0xdc4)+_0x80c0c5+_0x3936f7(0x12ec);const _0x5181b3=_0x211030[_0x3936f7(0x105a)]?_0x3936f7(0xf13)+_0x211030['publicText'][_0x3936f7(0x491)](/\n/g,_0x3936f7(0x1043))+_0x3936f7(0x2c3):'';if(_0x211030['type']===_0x3936f7(0x395))_0x52c5ca=_0x3936f7(0xf13)+_0x211030['content'][_0x3936f7(0x491)](/\n/g,_0x3936f7(0x1043))+_0x3936f7(0x2c3);else{if(_0x211030[_0x3936f7(0x858)]===_0x3936f7(0x133a)&&_0x211030[_0x3936f7(0xa09)]){const _0x1ca33a=_0x505390[_0x3936f7(0x888)][_0x3936f7(0x105c)]&&_0x211030[_0x3936f7(0xfb2)]?_0x3936f7(0x730)+_0x211030[_0x3936f7(0xfb2)]:_0x3936f7(0x775);_0x52c5ca=_0x5181b3?_0x5181b3+_0x3936f7(0x125a)+_0x1ca33a+_0x3936f7(0x1fc):_0x3936f7(0xdba)+_0x1ca33a+_0x3936f7(0x11f0);}else{if(_0x211030[_0x3936f7(0x858)]===_0x3936f7(0xd84)){const _0x394785=_0x505390[_0x3936f7(0x888)]['enableAiDrawing']&&_0x211030['image_prompt']?_0x3936f7(0x730)+_0x211030[_0x3936f7(0xfb2)]:_0x3936f7(0x775);_0x52c5ca=_0x5181b3?_0x5181b3+_0x3936f7(0x125a)+_0x394785+_0x3936f7(0x76a)+_0x211030[_0x3936f7(0x112d)]+_0x3936f7(0xd5b):'<img\x20src=\x22'+_0x394785+'\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22'+_0x211030['hiddenContent']+'\x22>';}}}let _0x1891b1='';_0x211030[_0x3936f7(0x12e3)]&&_0x211030[_0x3936f7(0x12e3)][_0x3936f7(0x990)]>0x0&&(_0x1891b1=_0x3936f7(0xe6d)+_0x211030[_0x3936f7(0x12e3)]['join']('、')+'\x20觉得很赞</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>');let _0x13942b='';_0x211030['comments']&&_0x211030[_0x3936f7(0xd3c)][_0x3936f7(0x990)]>0x0&&(_0x13942b=_0x3936f7(0xdae),_0x211030[_0x3936f7(0xd3c)][_0x3936f7(0x12be)]((_0x464955,_0x4b0fb9)=>{const _0x5d50e2=_0x3936f7;if(typeof _0x464955===_0x5d50e2(0x65a)&&_0x464955!==null&&_0x464955[_0x5d50e2(0x13e3)]){const _0x2880e1=_0x464955[_0x5d50e2(0x13e3)],_0x4e3159=_0x148d9b(_0x2880e1);let _0xa02c73;_0x554a0b[_0x5d50e2(0x101d)](_0x464955[_0x5d50e2(0x56d)])?_0xa02c73=_0x5d50e2(0xdba)+_0x464955[_0x5d50e2(0x56d)]+_0x5d50e2(0xc47):_0xa02c73=_0x464955[_0x5d50e2(0x56d)];let _0x1ec5d6='';if(_0x464955[_0x5d50e2(0x32a)]){const _0xb78ce6=_0x148d9b(_0x464955[_0x5d50e2(0x32a)]);_0x1ec5d6=_0x5d50e2(0x6cc)+_0x4e3159+'</span>\x20回复\x20<span\x20class=\x22commenter-name\x22>'+_0xb78ce6+_0x5d50e2(0x4d5)+_0xa02c73;}else _0x1ec5d6=_0x5d50e2(0x6cc)+_0x4e3159+_0x5d50e2(0x4d5)+_0xa02c73;_0x13942b+='<div\x20class=\x22comment-item\x22\x20data-post-id=\x22'+_0x211030['id']+'\x22\x20data-commenter-original-name=\x22'+_0x2880e1+_0x5d50e2(0x1012)+_0x4e3159+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>'+_0x1ec5d6+_0x5d50e2(0x12bd)+_0x4b0fb9+'\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';}else _0x13942b+=_0x5d50e2(0x4e4)+String(_0x464955)+_0x5d50e2(0x58a);}),_0x13942b+='</div>'),_0x30e315=''+_0x1891b1+_0x13942b;}else{if(_0x54d959[_0x3936f7(0x858)]===_0x3936f7(0xeab)){const _0x35dee4=_0x54d959[_0x3936f7(0xac4)],_0x3bbca6=_0x505390[_0x3936f7(0x1027)][_0x54d959[_0x3936f7(0xd4e)]];if(!_0x3bbca6)continue;_0x2efadf=_0x3936f7(0xc37)+_0x3bbca6[_0x3936f7(0x564)]+_0x3936f7(0x5ae);const _0x3f0f21=_0x35dee4['role']===_0x3936f7(0x4c5);let _0x4e204e,_0xb96d44;if(_0x3f0f21)_0x4e204e=_0x3bbca6['isGroup']?_0x3bbca6[_0x3936f7(0x18a)][_0x3936f7(0xf58)]||'我':'我',_0xb96d44=_0x3bbca6[_0x3936f7(0x18a)][_0x3936f7(0xe28)]||(_0x3bbca6[_0x3936f7(0x9d7)]?_0x2361d7:_0x28c106);else{if(_0x3bbca6[_0x3936f7(0x9d7)]){const _0xb0f3f7=_0x3bbca6['members'][_0x3936f7(0xc0d)](_0xee1627=>_0xee1627['originalName']===_0x35dee4[_0x3936f7(0xdcc)]);_0x4e204e=_0x35dee4[_0x3936f7(0xdcc)],_0xb96d44=_0xb0f3f7?_0xb0f3f7[_0x3936f7(0x799)]:_0x3ea4df;}else _0x4e204e=_0x3bbca6[_0x3936f7(0x564)],_0xb96d44=_0x3bbca6['settings'][_0x3936f7(0x1039)]||_0x28c106;}_0x4d4719=_0x3936f7(0xdba)+_0xb96d44+_0x3936f7(0xdc4)+_0x4e204e+_0x3936f7(0x12ec);if(typeof _0x35dee4[_0x3936f7(0xac4)]===_0x3936f7(0x8d9)&&_0x554a0b['test'](_0x35dee4[_0x3936f7(0xac4)]))_0x52c5ca='<img\x20src=\x22'+_0x35dee4[_0x3936f7(0xac4)]+_0x3936f7(0x3b1);else Array[_0x3936f7(0x285)](_0x35dee4['content'])&&_0x35dee4['content'][0x0]?.[_0x3936f7(0x858)]===_0x3936f7(0x1e8)?_0x52c5ca=_0x3936f7(0xdba)+_0x35dee4['content'][0x0][_0x3936f7(0x1e8)][_0x3936f7(0x5f3)]+_0x3936f7(0x11f0):_0x52c5ca=String(_0x35dee4[_0x3936f7(0xac4)]||'')['replace'](/\n/g,'<br>');}else{if(_0x54d959['type']===_0x3936f7(0x8a1)){const _0x1f6e64=_0x54d959[_0x3936f7(0xac4)];_0x2efadf=_0x3936f7(0x10d3)+_0x1f6e64[_0x3936f7(0xcbe)]+_0x3936f7(0x810);const _0x144cb7=_0x505390[_0x3936f7(0x1027)][_0x1f6e64['characterId']],_0x183f85=_0x144cb7?_0x144cb7[_0x3936f7(0x18a)][_0x3936f7(0x1039)]:_0x28c106;_0x4d4719='<img\x20src=\x22'+_0x183f85+_0x3936f7(0xdc4)+_0x1f6e64[_0x3936f7(0xcbe)]+_0x3936f7(0x12ec);const _0x4fa2c3=_0x1f6e64[_0x3936f7(0xac4)]||'',_0x1f381d=_0x23554f(_0x4fa2c3)[_0x3936f7(0x491)](/\n/g,_0x3936f7(0x1043));_0x52c5ca=_0x3936f7(0x71f)+_0x1f6e64[_0x3936f7(0xc29)]+_0x3936f7(0xbf7)+_0x1f381d+_0x3936f7(0x12da);}else{if(_0x54d959[_0x3936f7(0x858)]===_0x3936f7(0x5aa)){const _0x3d4af6=_0x54d959['content'];_0x2efadf=_0x3936f7(0x10d3)+_0x3d4af6[_0x3936f7(0xcbe)]+_0x3936f7(0x213);const _0x227221=_0x505390[_0x3936f7(0x1027)][_0x3d4af6[_0x3936f7(0x8cb)]],_0x2c8e15=_0x227221?_0x227221[_0x3936f7(0x18a)][_0x3936f7(0x1039)]:_0x28c106;_0x4d4719=_0x3936f7(0xdba)+_0x2c8e15+'\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>'+_0x3d4af6[_0x3936f7(0xcbe)]+'</div></div>',_0x52c5ca=_0x3936f7(0x10b7)+_0x3d4af6[_0x3936f7(0xc29)]+_0x3936f7(0xde8)+(_0x3d4af6[_0x3936f7(0xac4)]||'')[_0x3936f7(0x491)](/\n/g,_0x3936f7(0x1043))+_0x3936f7(0xeaa);}else{if(_0x54d959[_0x3936f7(0x858)]==='char_memo'){const _0x459fbd=_0x54d959[_0x3936f7(0xac4)];_0x2efadf=_0x3936f7(0x10d3)+_0x459fbd[_0x3936f7(0xcbe)]+_0x3936f7(0x4da);const _0x4f01a6=_0x505390[_0x3936f7(0x1027)][_0x459fbd[_0x3936f7(0x8cb)]],_0x2152b5=_0x4f01a6?_0x4f01a6[_0x3936f7(0x18a)][_0x3936f7(0x1039)]:_0x28c106;_0x4d4719=_0x3936f7(0xdba)+_0x2152b5+'\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>'+_0x459fbd[_0x3936f7(0xcbe)]+_0x3936f7(0x12ec),_0x52c5ca=_0x3936f7(0x601)+_0x459fbd[_0x3936f7(0xc29)]+_0x3936f7(0xa64)+_0x459fbd[_0x3936f7(0xac4)][_0x3936f7(0x491)](/\n/g,_0x3936f7(0x1043))+_0x3936f7(0x424);}}}}}_0x4a5f9f[_0x3936f7(0x3de)]=_0x3936f7(0xe47)+_0x4d4719+_0x3936f7(0xd57)+_0x2efadf+_0x3936f7(0x9bd)+_0x52c5ca+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x30e315,_0x41be10['appendChild'](_0x4a5f9f);}}async function _0xafbc68(){const _0x198d2d=_0x85c4bf;allFavoriteItems=await _0xb81d4e[_0x198d2d(0x3e8)][_0x198d2d(0x3d2)](_0x198d2d(0x12a2))[_0x198d2d(0x336)]()['toArray']();const _0xe4cf48=document['getElementById'](_0x198d2d(0x626)),_0x2de2e4=document[_0x198d2d(0x479)](_0x198d2d(0xba8));_0xe4cf48[_0x198d2d(0x4e0)]='',_0x2de2e4[_0x198d2d(0x10dd)][_0x198d2d(0x678)]=_0x198d2d(0xff8),_0x1da1be(allFavoriteItems);}function _0x2a8e48(){const _0x2f4809=_0x85c4bf;document[_0x2f4809(0x479)]('post-public-text')[_0x2f4809(0x4e0)]='',document[_0x2f4809(0x479)](_0x2f4809(0x13bc))[_0x2f4809(0xa9c)]='',document['getElementById']('post-image-description')[_0x2f4809(0x4e0)]='',document[_0x2f4809(0x479)](_0x2f4809(0x13b4))[_0x2f4809(0x9cd)]['remove'](_0x2f4809(0x45a)),document[_0x2f4809(0x479)](_0x2f4809(0xaae))[_0x2f4809(0x10dd)][_0x2f4809(0x678)]='none',document[_0x2f4809(0x479)](_0x2f4809(0xdfb))[_0x2f4809(0x4e0)]='',document['getElementById'](_0x2f4809(0xaea))[_0x2f4809(0x4e0)]='',document[_0x2f4809(0x479)](_0x2f4809(0xe89))[_0x2f4809(0xd2f)]();}async function _0x260684(){const _0x2f88b6=_0x85c4bf,_0x4e41a3=await _0x1a9e79(_0x2f88b6(0xaf8),'此操作将扫描数据库，移除所有与已删除角色相关的孤立数据（如动态、评论、记忆等）。<br><br><strong>此操作不可撤销，但通常是安全的。NPC数据不会被删除。</strong><br><br>建议在操作前先导出数据备份。',{'confirmButtonClass':_0x2f88b6(0x95a),'confirmText':'确认清理'});if(!_0x4e41a3)return;await _0x1519c8(_0x2f88b6(0xbd7),_0x2f88b6(0x10e6)),console[_0x2f88b6(0x90f)]('冗余数据清理流程已启动...');let _0x143047={'posts':0x0,'likes':0x0,'comments':0x0,'memories':0x0,'callRecords':0x0,'renderingRules':0x0,'groupMembers':0x0,'chatLinks':0x0};try{await _0xb81d4e['transaction']('rw',_0xb81d4e['tables'],async()=>{const _0x53657c=_0x2f88b6,_0x453c12=await _0xb81d4e[_0x53657c(0x1027)][_0x53657c(0x4ba)](),_0x3abc76=await _0xb81d4e['npcs'][_0x53657c(0x4ba)](),_0x35708f=new Set(_0x453c12[_0x53657c(0x2e1)](_0x3d3b29=>_0x3d3b29['id'])),_0x48cc16=new Set(_0x3abc76[_0x53657c(0x2e1)](_0x274b8e=>_0x53657c(0xca5)+_0x274b8e['id'])),_0x393f7c=new Set(_0x453c12[_0x53657c(0x85d)](_0x322b4a=>!_0x322b4a[_0x53657c(0x9d7)])[_0x53657c(0x2e1)](_0x28d9f9=>_0x28d9f9[_0x53657c(0xe2d)]));_0x393f7c[_0x53657c(0x807)](_0x505390['qzoneSettings'][_0x53657c(0x904)]||'{{user}}'),_0x3abc76[_0x53657c(0x12be)](_0x57c3c2=>_0x393f7c[_0x53657c(0x807)](_0x57c3c2[_0x53657c(0x564)]));for(const _0x255ed0 of _0x453c12){let _0x2ad2b9=![];if(_0x255ed0[_0x53657c(0x9d7)]&&_0x255ed0[_0x53657c(0x954)]){const _0x12ba5=_0x255ed0[_0x53657c(0x954)][_0x53657c(0x990)];_0x255ed0[_0x53657c(0x954)]=_0x255ed0['members'][_0x53657c(0x85d)](_0x1961bc=>_0x35708f[_0x53657c(0x391)](_0x1961bc['id'])||_0x48cc16[_0x53657c(0x391)](_0x1961bc['id'])),_0x255ed0[_0x53657c(0x954)]['length']<_0x12ba5&&(_0x143047['groupMembers']+=_0x12ba5-_0x255ed0[_0x53657c(0x954)][_0x53657c(0x990)],_0x2ad2b9=!![]);}if(_0x255ed0['settings']?.[_0x53657c(0xefa)]?.['length']>0x0){const _0x234a3a=_0x255ed0[_0x53657c(0x18a)][_0x53657c(0xefa)]['length'];_0x255ed0[_0x53657c(0x18a)][_0x53657c(0xefa)]=_0x255ed0[_0x53657c(0x18a)][_0x53657c(0xefa)][_0x53657c(0x85d)](_0x4e2c6e=>_0x35708f[_0x53657c(0x391)](_0x4e2c6e)),_0x255ed0['settings'][_0x53657c(0xefa)][_0x53657c(0x990)]<_0x234a3a&&(_0x143047[_0x53657c(0x10ea)]+=_0x234a3a-_0x255ed0[_0x53657c(0x18a)][_0x53657c(0xefa)][_0x53657c(0x990)],_0x2ad2b9=!![]);}_0x2ad2b9&&await _0xb81d4e[_0x53657c(0x1027)][_0x53657c(0x5d0)](_0x255ed0);}const _0xb87743=await _0xb81d4e['qzonePosts'][_0x53657c(0x4ba)]();for(const _0x86b05f of _0xb87743){let _0x57e59b=![];const _0x4a2cb4=_0x86b05f[_0x53657c(0x981)]==='user'||_0x35708f[_0x53657c(0x391)](_0x86b05f[_0x53657c(0x981)])||_0x48cc16[_0x53657c(0x391)](_0x86b05f[_0x53657c(0x981)]);if(!_0x4a2cb4){await _0xb81d4e[_0x53657c(0xcce)][_0x53657c(0x1ea)](_0x86b05f['id']),_0x143047['posts']++;continue;}if(_0x86b05f[_0x53657c(0x12e3)]&&_0x86b05f[_0x53657c(0x12e3)]['length']>0x0){const _0x1959b3=_0x86b05f[_0x53657c(0x12e3)][_0x53657c(0x990)];_0x86b05f['likes']=_0x86b05f[_0x53657c(0x12e3)]['filter'](_0xcc4a63=>_0x393f7c['has'](_0xcc4a63)),_0x86b05f[_0x53657c(0x12e3)][_0x53657c(0x990)]<_0x1959b3&&(_0x143047[_0x53657c(0x12e3)]+=_0x1959b3-_0x86b05f[_0x53657c(0x12e3)]['length'],_0x57e59b=!![]);}if(_0x86b05f[_0x53657c(0xd3c)]&&_0x86b05f[_0x53657c(0xd3c)][_0x53657c(0x990)]>0x0){const _0x42b4bc=_0x86b05f[_0x53657c(0xd3c)]['length'];_0x86b05f[_0x53657c(0xd3c)]=_0x86b05f[_0x53657c(0xd3c)][_0x53657c(0x85d)](_0x56ef56=>{const _0x13f019=_0x53657c;if(typeof _0x56ef56==='object'&&_0x56ef56[_0x13f019(0x13e3)])return _0x393f7c[_0x13f019(0x391)](_0x56ef56[_0x13f019(0x13e3)]);return!![];}),_0x86b05f[_0x53657c(0xd3c)][_0x53657c(0x990)]<_0x42b4bc&&(_0x143047[_0x53657c(0xd3c)]+=_0x42b4bc-_0x86b05f[_0x53657c(0xd3c)][_0x53657c(0x990)],_0x57e59b=!![]);}_0x57e59b&&await _0xb81d4e[_0x53657c(0xcce)][_0x53657c(0x5d0)](_0x86b05f);}await _0xb81d4e[_0x53657c(0xa2f)][_0x53657c(0x46f)]('chatId')[_0x53657c(0xd14)]([..._0x35708f])[_0x53657c(0x1ea)]()[_0x53657c(0x13d8)](_0x57f546=>_0x143047[_0x53657c(0xa2f)]+=_0x57f546),await _0xb81d4e['callRecords'][_0x53657c(0x46f)](_0x53657c(0xd4e))[_0x53657c(0xd14)]([..._0x35708f])['delete']()['then'](_0x331e70=>_0x143047['callRecords']+=_0x331e70);const _0x35ffa2=await _0xb81d4e[_0x53657c(0xb06)][_0x53657c(0x4ba)]();for(const _0x5ea918 of _0x35ffa2){_0x5ea918[_0x53657c(0xd4e)]!==_0x53657c(0xb48)&&!_0x35708f['has'](_0x5ea918[_0x53657c(0xd4e)])&&(await _0xb81d4e[_0x53657c(0xb06)][_0x53657c(0x1ea)](_0x5ea918['id']),_0x143047[_0x53657c(0xb06)]++);}});let _0x263c16=_0x2f88b6(0x10e0),_0x4d4bc9=![];Object[_0x2f88b6(0xef7)](_0x143047)['forEach'](([_0x5eebd1,_0x57ed2b])=>{const _0x459c20=_0x2f88b6;if(_0x57ed2b>0x0){const _0x242749={'posts':'动态','likes':'点赞','comments':'评论','memories':'记忆','callRecords':_0x459c20(0x503),'renderingRules':_0x459c20(0xf79),'groupMembers':_0x459c20(0x255),'chatLinks':_0x459c20(0x5dc)};_0x263c16+=_0x459c20(0x669)+_0x57ed2b+'\x20条无效的'+(_0x242749[_0x5eebd1]||_0x5eebd1)+'。\x0a',_0x4d4bc9=!![];}});!_0x4d4bc9&&(_0x263c16=_0x2f88b6(0xdc7));_0x263c16+='\x0a建议刷新页面以确保所有更改生效。',await _0x1519c8(_0x2f88b6(0xa56),_0x263c16);const _0x19f856=await _0x1a9e79(_0x2f88b6(0xb43),_0x2f88b6(0x11d5));_0x19f856&&location[_0x2f88b6(0x4ac)]();}catch(_0x11095e){console['error'](_0x2f88b6(0x4fd),_0x11095e),await _0x1519c8(_0x2f88b6(0x83e),_0x2f88b6(0xe49)+_0x11095e[_0x2f88b6(0x757)]);}}async function _0x435508(){const _0x2cea10=_0x85c4bf;try{const _0x2ad4fb={'version':0x1,'timestamp':Date[_0x2cea10(0x12d6)]()},[_0x1d58a7,_0x23f26f,_0x500d8e,_0x333460,_0x313996,_0x47acaf,_0x5bc8ca,_0x4f3a9c,_0x26a7c6,_0x19bb26,_0x2997ec,_0x3b3391,_0x36d3a3,_0x1b1245,_0x49d5c5,_0x57a9b9,_0x29d02c,_0x407a6f,_0x514e5a,_0x33d643,_0x90c01e,_0x1be973,_0x355059,_0x52fae6,_0x483b80]=await Promise['all']([_0xb81d4e['chats']['toArray'](),_0xb81d4e[_0x2cea10(0xd1b)]['toArray'](),_0xb81d4e[_0x2cea10(0x407)][_0x2cea10(0x4ba)](),_0xb81d4e[_0x2cea10(0x30c)][_0x2cea10(0x111a)](_0x2cea10(0x114d)),_0xb81d4e[_0x2cea10(0x888)][_0x2cea10(0x111a)](_0x2cea10(0x114d)),_0xb81d4e[_0x2cea10(0x56b)]['toArray'](),_0xb81d4e['musicLibrary'][_0x2cea10(0x111a)](_0x2cea10(0x114d)),_0xb81d4e[_0x2cea10(0x1190)][_0x2cea10(0x111a)]('main'),_0xb81d4e[_0x2cea10(0xcce)][_0x2cea10(0x4ba)](),_0xb81d4e['qzoneAlbums']['toArray'](),_0xb81d4e['qzonePhotos'][_0x2cea10(0x4ba)](),_0xb81d4e[_0x2cea10(0x3e8)][_0x2cea10(0x4ba)](),_0xb81d4e['qzoneGroups'][_0x2cea10(0x4ba)](),_0xb81d4e['memories'][_0x2cea10(0x4ba)](),_0xb81d4e[_0x2cea10(0xfe9)][_0x2cea10(0x4ba)](),_0xb81d4e[_0x2cea10(0x126a)][_0x2cea10(0x4ba)](),_0xb81d4e[_0x2cea10(0x13c1)][_0x2cea10(0x4ba)](),_0xb81d4e[_0x2cea10(0x52e)][_0x2cea10(0x4ba)](),_0xb81d4e['renderingRules'][_0x2cea10(0x4ba)](),_0xb81d4e['doubanPosts'][_0x2cea10(0x4ba)](),_0xb81d4e[_0x2cea10(0x690)]['toArray'](),_0xb81d4e['appearancePresets'][_0x2cea10(0x4ba)](),_0xb81d4e[_0x2cea10(0xaa0)][_0x2cea10(0x4ba)](),_0xb81d4e['presetCategories']['toArray'](),_0xb81d4e[_0x2cea10(0x482)][_0x2cea10(0x4ba)]()]);Object[_0x2cea10(0x13ee)](_0x2ad4fb,{'chats':_0x1d58a7,'worldBooks':_0x23f26f,'userStickers':_0x500d8e,'apiConfig':_0x333460,'globalSettings':_0x313996,'personaPresets':_0x47acaf,'musicLibrary':_0x5bc8ca,'qzoneSettings':_0x4f3a9c,'qzonePosts':_0x26a7c6,'qzoneAlbums':_0x19bb26,'qzonePhotos':_0x2997ec,'favorites':_0x3b3391,'qzoneGroups':_0x36d3a3,'memories':_0x1b1245,'worldBookCategories':_0x49d5c5,'apiPresets':_0x57a9b9,'shoppingProducts':_0x29d02c,'callRecords':_0x407a6f,'renderingRules':_0x514e5a,'doubanPosts':_0x33d643,'stickerCategories':_0x90c01e,'appearancePresets':_0x1be973,'presets':_0x355059,'presetCategories':_0x52fae6,'npcs':_0x483b80});const _0x51f7fa=new Blob([JSON['stringify'](_0x2ad4fb,null,0x2)],{'type':_0x2cea10(0xcb5)}),_0x2cc5f0=URL[_0x2cea10(0xe9c)](_0x51f7fa),_0x14db69=Object['assign'](document['createElement']('a'),{'href':_0x2cc5f0,'download':_0x2cea10(0x7cf)+new Date()[_0x2cea10(0xaf9)]()[_0x2cea10(0x53e)]('T')[0x0]+_0x2cea10(0x1a6)});_0x14db69[_0x2cea10(0xd2f)](),URL['revokeObjectURL'](_0x2cc5f0),await _0x1519c8(_0x2cea10(0x553),_0x2cea10(0x9b0));}catch(_0x1228e3){console[_0x2cea10(0xe3b)]('导出数据时出错:',_0x1228e3),await _0x1519c8('导出失败',_0x2cea10(0xe49)+_0x1228e3['message']);}}async function _0x1ca5f5(_0x7fefc0){const _0x6e6891=_0x85c4bf;try{await _0xb81d4e[_0x6e6891(0x4b9)]('rw',_0xb81d4e[_0x6e6891(0x1155)],async()=>{const _0x39d424=_0x6e6891;for(const _0x3c6f94 of _0xb81d4e[_0x39d424(0x1155)]){await _0x3c6f94[_0x39d424(0xf8f)]();}for(const _0x215665 in _0x7fefc0){Array['isArray'](_0x7fefc0[_0x215665])&&(console[_0x39d424(0x90f)](_0x39d424(0x686)+_0x215665+_0x39d424(0xe45)+_0x7fefc0[_0x215665][_0x39d424(0x990)]),await _0xb81d4e[_0x39d424(0x4d7)](_0x215665)[_0x39d424(0x100e)](_0x7fefc0[_0x215665]));}});}catch(_0xa007b3){throw new Error(_0x6e6891(0xb91)+_0xa007b3[_0x6e6891(0x757)]);}}async function _0x585cee(_0x326000){const _0x5b62a5=_0x85c4bf;if(!_0x326000)return;const _0x2a7938=await _0x1a9e79('严重警告！',_0x5b62a5(0xbf3),{'confirmButtonClass':_0x5b62a5(0x95a)});if(!_0x2a7938)return;await _0x1519c8('请稍候...',_0x5b62a5(0x1252));try{const _0x3c2090=await _0x326000[_0x5b62a5(0x56d)](),_0x3405d9=JSON[_0x5b62a5(0x94c)](_0x3c2090);if(_0x3405d9[_0x5b62a5(0x104c)]&&typeof _0x3405d9[_0x5b62a5(0x104c)]===_0x5b62a5(0x65a)&&_0x3405d9['data'][_0x5b62a5(0x1027)])console[_0x5b62a5(0x90f)](_0x5b62a5(0x1327)),await _0x1ca5f5(_0x3405d9[_0x5b62a5(0x104c)]);else{if(_0x3405d9[_0x5b62a5(0x1027)])console[_0x5b62a5(0x90f)]('检测到旧版完整备份文件，开始导入...'),await _0x13ac40(_0x3405d9);else throw new Error(_0x5b62a5(0x1292));}await _0x1519c8('导入成功',_0x5b62a5(0x6c2)),setTimeout(()=>{const _0x2c0848=_0x5b62a5;window[_0x2c0848(0x7b3)]['reload']();},0x5dc);}catch(_0x4c5a28){console[_0x5b62a5(0xe3b)]('导入数据时出错:',_0x4c5a28),await _0x1519c8(_0x5b62a5(0xf28),'文件解析或应用失败:\x20'+_0x4c5a28[_0x5b62a5(0x757)]);}}async function _0x13ac40(_0xa632ad){const _0x493479=_0x85c4bf;try{await _0xb81d4e[_0x493479(0x4b9)]('rw',_0xb81d4e[_0x493479(0x1155)],async()=>{const _0x459b7d=_0x493479;await _0xb81d4e[_0x459b7d(0x1027)][_0x459b7d(0xf8f)](),await _0xb81d4e[_0x459b7d(0xd1b)][_0x459b7d(0xf8f)]();for(const _0x4b026b of _0xb81d4e[_0x459b7d(0x1155)]){await _0x4b026b['clear']();}if(Array[_0x459b7d(0x285)](_0xa632ad[_0x459b7d(0x1027)]))await _0xb81d4e[_0x459b7d(0x1027)][_0x459b7d(0x100e)](_0xa632ad[_0x459b7d(0x1027)]);if(Array['isArray'](_0xa632ad[_0x459b7d(0xd1b)]))await _0xb81d4e[_0x459b7d(0xd1b)]['bulkPut'](_0xa632ad[_0x459b7d(0xd1b)]);if(Array[_0x459b7d(0x285)](_0xa632ad[_0x459b7d(0x407)]))await _0xb81d4e[_0x459b7d(0x407)][_0x459b7d(0x100e)](_0xa632ad[_0x459b7d(0x407)]);if(_0xa632ad['apiConfig'])await _0xb81d4e['apiConfig'][_0x459b7d(0x5d0)](_0xa632ad[_0x459b7d(0x30c)]);if(_0xa632ad['globalSettings'])await _0xb81d4e[_0x459b7d(0x888)][_0x459b7d(0x5d0)](_0xa632ad[_0x459b7d(0x888)]);if(Array[_0x459b7d(0x285)](_0xa632ad[_0x459b7d(0x56b)]))await _0xb81d4e[_0x459b7d(0x56b)][_0x459b7d(0x100e)](_0xa632ad[_0x459b7d(0x56b)]);if(_0xa632ad['musicLibrary'])await _0xb81d4e[_0x459b7d(0x410)]['put'](_0xa632ad['musicLibrary']);if(_0xa632ad[_0x459b7d(0x1190)])await _0xb81d4e[_0x459b7d(0x1190)]['put'](_0xa632ad[_0x459b7d(0x1190)]);if(Array[_0x459b7d(0x285)](_0xa632ad['qzonePosts']))await _0xb81d4e[_0x459b7d(0xcce)][_0x459b7d(0x100e)](_0xa632ad[_0x459b7d(0xcce)]);if(Array[_0x459b7d(0x285)](_0xa632ad[_0x459b7d(0xdf4)]))await _0xb81d4e['qzoneAlbums'][_0x459b7d(0x100e)](_0xa632ad['qzoneAlbums']);if(Array[_0x459b7d(0x285)](_0xa632ad[_0x459b7d(0x340)]))await _0xb81d4e['qzonePhotos'][_0x459b7d(0x100e)](_0xa632ad['qzonePhotos']);if(Array['isArray'](_0xa632ad['favorites']))await _0xb81d4e[_0x459b7d(0x3e8)][_0x459b7d(0x100e)](_0xa632ad[_0x459b7d(0x3e8)]);if(Array[_0x459b7d(0x285)](_0xa632ad[_0x459b7d(0xbce)]))await _0xb81d4e[_0x459b7d(0xbce)][_0x459b7d(0x100e)](_0xa632ad[_0x459b7d(0xbce)]);if(Array[_0x459b7d(0x285)](_0xa632ad[_0x459b7d(0xa2f)]))await _0xb81d4e[_0x459b7d(0xa2f)]['bulkPut'](_0xa632ad[_0x459b7d(0xa2f)]);if(Array[_0x459b7d(0x285)](_0xa632ad[_0x459b7d(0xfe9)]))await _0xb81d4e[_0x459b7d(0xfe9)][_0x459b7d(0x100e)](_0xa632ad[_0x459b7d(0xfe9)]);if(Array[_0x459b7d(0x285)](_0xa632ad[_0x459b7d(0x126a)]))await _0xb81d4e[_0x459b7d(0x126a)][_0x459b7d(0x100e)](_0xa632ad['apiPresets']);if(Array['isArray'](_0xa632ad[_0x459b7d(0x13c1)]))await _0xb81d4e[_0x459b7d(0x13c1)][_0x459b7d(0x100e)](_0xa632ad[_0x459b7d(0x13c1)]);if(Array['isArray'](_0xa632ad['callRecords']))await _0xb81d4e['callRecords'][_0x459b7d(0x100e)](_0xa632ad[_0x459b7d(0x52e)]);if(Array[_0x459b7d(0x285)](_0xa632ad['renderingRules']))await _0xb81d4e[_0x459b7d(0xb06)]['bulkPut'](_0xa632ad['renderingRules']);if(Array[_0x459b7d(0x285)](_0xa632ad[_0x459b7d(0xd6d)]))await _0xb81d4e['doubanPosts'][_0x459b7d(0x100e)](_0xa632ad[_0x459b7d(0xd6d)]);if(Array[_0x459b7d(0x285)](_0xa632ad[_0x459b7d(0x690)]))await _0xb81d4e[_0x459b7d(0x690)]['bulkPut'](_0xa632ad[_0x459b7d(0x690)]);if(Array[_0x459b7d(0x285)](_0xa632ad['appearancePresets']))await _0xb81d4e['appearancePresets'][_0x459b7d(0x100e)](_0xa632ad[_0x459b7d(0xfe7)]);if(Array[_0x459b7d(0x285)](_0xa632ad['presets']))await _0xb81d4e[_0x459b7d(0xaa0)]['bulkPut'](_0xa632ad['presets']);if(Array['isArray'](_0xa632ad['presetCategories']))await _0xb81d4e[_0x459b7d(0xebc)]['bulkPut'](_0xa632ad['presetCategories']);if(Array['isArray'](_0xa632ad['npcs']))await _0xb81d4e[_0x459b7d(0x482)][_0x459b7d(0x100e)](_0xa632ad[_0x459b7d(0x482)]);});}catch(_0x19515b){throw new Error(_0x493479(0x124d)+_0x19515b[_0x493479(0x757)]);}}function _0x57f4d5(_0x395af7,_0x3f09c2=![]){const _0x240a4f=_0x85c4bf;if(!_0x395af7){_0x460f62[_0x240a4f(0x3de)]='',document[_0x240a4f(0x479)](_0x240a4f(0x624))[_0x240a4f(0x10dd)][_0x240a4f(0xe0e)]='';return;}const _0x5f178b=_0x240a4f(0x13a7),_0x184a18=_0x240a4f(0xc56)+_0x5f178b+_0x240a4f(0x13d6)+_0x395af7+_0x240a4f(0x6c5);if(_0x3f09c2){const _0x217a74=document[_0x240a4f(0x479)](_0x240a4f(0x10ef))||document[_0x240a4f(0xbd5)]('style');_0x217a74['id']=_0x240a4f(0x10ef),_0x217a74[_0x240a4f(0x3de)]=_0x184a18;if(!document[_0x240a4f(0x479)]('preview-font-style'))document[_0x240a4f(0x581)]['appendChild'](_0x217a74);document[_0x240a4f(0x479)](_0x240a4f(0x624))[_0x240a4f(0x10dd)][_0x240a4f(0xe0e)]='\x27'+_0x5f178b+_0x240a4f(0x844);}else _0x460f62[_0x240a4f(0x3de)]=_0x240a4f(0x991)+_0x184a18+_0x240a4f(0x797)+_0x5f178b+_0x240a4f(0x4fb);}async function _0x2dbe36(){const _0x1888ca=_0x85c4bf;_0x460f62[_0x1888ca(0x3de)]='',_0x505390['globalSettings'][_0x1888ca(0x69a)]='',await _0xb81d4e['globalSettings'][_0x1888ca(0x5d0)](_0x505390[_0x1888ca(0x888)]),document[_0x1888ca(0x479)](_0x1888ca(0x13e0))[_0x1888ca(0x4e0)]='',document[_0x1888ca(0x479)]('font-preview')[_0x1888ca(0x10dd)][_0x1888ca(0xe0e)]='',alert(_0x1888ca(0x11c0));}async function _0x361f5e(){const _0x186c39=_0x85c4bf,[_0x76bf02,_0x27b412,_0x57a172,_0x4ce37d,_0x3814a2,_0x3db621,_0x7f099,_0x46a27e,_0x51c9ef,_0x2e44f7,_0x2a69ec]=await Promise[_0x186c39(0xf78)]([_0xb81d4e[_0x186c39(0x1027)][_0x186c39(0x4ba)](),_0xb81d4e[_0x186c39(0x30c)][_0x186c39(0x111a)]('main'),_0xb81d4e[_0x186c39(0x888)][_0x186c39(0x111a)](_0x186c39(0x114d)),_0xb81d4e[_0x186c39(0x407)][_0x186c39(0x4ba)](),_0xb81d4e[_0x186c39(0xd1b)][_0x186c39(0x4ba)](),_0xb81d4e['musicLibrary'][_0x186c39(0x111a)](_0x186c39(0x114d)),_0xb81d4e['personaPresets']['toArray'](),_0xb81d4e['qzoneSettings'][_0x186c39(0x111a)](_0x186c39(0x114d)),_0xb81d4e[_0x186c39(0x3e8)][_0x186c39(0x3d2)](_0x186c39(0x12a2))[_0x186c39(0x336)]()[_0x186c39(0x4ba)](),_0xb81d4e['memories']['toArray'](),_0xb81d4e[_0x186c39(0xaa0)][_0x186c39(0x4ba)]()]);_0x505390[_0x186c39(0xaa0)]=_0x2a69ec||[];const _0x15c06c={'id':_0x186c39(0x114d),'showStatusBar':![],'wallpaper':'linear-gradient(135deg,\x20#89f7fe,\x20#66a6ff)','fontUrl':'','enableBackgroundActivity':![],'backgroundActivityInterval':0x3c,'blockCooldownHours':0x1,'apiTemperature':0.8,'appIcons':{..._0x597469},'cphoneWallpaper':_0x186c39(0x114c),'cphoneAppIcons':{..._0x28895b},'globalCss':'','notificationSoundUrl':'','widgetData':{},'globalChatBackground':'','enableAiDrawing':!![],'chatActionButtonsOrder':null,'shoppingCategoryCount':0x3,'shoppingProductCount':0x8,'chatRenderWindow':0x32};_0x505390[_0x186c39(0x888)]={..._0x15c06c,..._0x57a172||{}},_0x505390[_0x186c39(0x888)][_0x186c39(0x12ca)]={..._0x15c06c[_0x186c39(0x12ca)],..._0x505390['globalSettings'][_0x186c39(0x12ca)]||{}},_0x505390[_0x186c39(0x888)][_0x186c39(0x2f6)]={..._0x15c06c['cphoneAppIcons'],..._0x505390[_0x186c39(0x888)][_0x186c39(0x2f6)]||{}},_0x76bf02[_0x186c39(0x12be)](_0x4bf61b=>{const _0x322817=_0x186c39;typeof _0x4bf61b[_0x322817(0x18a)][_0x322817(0xeb0)]===_0x322817(0xcb8)&&(_0x4bf61b['settings'][_0x322817(0xeb0)]=!![]),!_0x4bf61b[_0x322817(0x18a)][_0x322817(0x1211)]&&(_0x4bf61b[_0x322817(0x18a)][_0x322817(0x1211)]={'vertical':_0x322817(0xb8f),'horizontal':_0x322817(0x1e5),'offset':0xa}),!_0x4bf61b['isGroup']&&!_0x4bf61b['settings'][_0x322817(0x846)]&&(_0x4bf61b[_0x322817(0x18a)][_0x322817(0x846)]=[]),!_0x4bf61b[_0x322817(0x9d7)]&&typeof _0x4bf61b[_0x322817(0xe2d)]===_0x322817(0xcb8)&&(_0x4bf61b[_0x322817(0xe2d)]=_0x4bf61b[_0x322817(0x564)]);}),_0x505390[_0x186c39(0x1027)]=_0x76bf02['reduce']((_0x42b4b8,_0x5e6791)=>{const _0x39aecb=_0x186c39;if(typeof _0x5e6791[_0x39aecb(0x1090)]==='undefined')_0x5e6791[_0x39aecb(0x1090)]=0x0;_0x5e6791[_0x39aecb(0x9d7)]&&(typeof _0x5e6791['settings'][_0x39aecb(0xc00)]===_0x39aecb(0xcb8)&&(_0x5e6791[_0x39aecb(0x18a)][_0x39aecb(0xc00)]=!![]),_0x5e6791[_0x39aecb(0x954)]&&_0x5e6791[_0x39aecb(0x954)][_0x39aecb(0x990)]>0x0&&_0x5e6791[_0x39aecb(0x954)][0x0][_0x39aecb(0x564)]&&_0x5e6791[_0x39aecb(0x954)][_0x39aecb(0x12be)](_0x46eae5=>{const _0x36eaab=_0x39aecb;typeof _0x46eae5[_0x36eaab(0xe2d)]===_0x36eaab(0xcb8)&&(_0x46eae5[_0x36eaab(0xe2d)]=_0x46eae5[_0x36eaab(0x564)],_0x46eae5['groupNickname']=_0x46eae5[_0x36eaab(0x564)],delete _0x46eae5[_0x36eaab(0x564)]);}));if(!_0x5e6791['settings'])_0x5e6791[_0x39aecb(0x18a)]={};typeof _0x5e6791[_0x39aecb(0x18a)][_0x39aecb(0x1097)]===_0x39aecb(0xcb8)&&(_0x5e6791[_0x39aecb(0x18a)][_0x39aecb(0x1097)]=0xa);if(!_0x5e6791[_0x39aecb(0x9d7)]&&!_0x5e6791['status'])_0x5e6791[_0x39aecb(0x93c)]={'text':'在线','lastUpdate':Date['now'](),'isBusy':![]};if(!_0x5e6791[_0x39aecb(0x9d7)]&&!_0x5e6791[_0x39aecb(0xcda)])_0x5e6791[_0x39aecb(0xcda)]={'status':'friend','blockedTimestamp':null,'applicationReason':''};if(!_0x5e6791[_0x39aecb(0x9d7)]&&(!_0x5e6791['settings']||!_0x5e6791[_0x39aecb(0x18a)]['aiAvatarLibrary'])){if(!_0x5e6791['settings'])_0x5e6791[_0x39aecb(0x18a)]={};_0x5e6791[_0x39aecb(0x18a)][_0x39aecb(0x8c6)]=[];}_0x5e6791['isGroup']&&(_0x5e6791['members']||[])[_0x39aecb(0x12be)](_0x2d16b0=>{const _0x39de32=_0x39aecb;if(typeof _0x2d16b0[_0x39de32(0xea1)]==='undefined')_0x2d16b0[_0x39de32(0xea1)]='';});if(!_0x5e6791[_0x39aecb(0xac8)])_0x5e6791[_0x39aecb(0xac8)]={'totalTime':0x0};_0x5e6791['settings']&&_0x5e6791['settings'][_0x39aecb(0x4ee)]&&!_0x5e6791[_0x39aecb(0x18a)][_0x39aecb(0x13da)]&&(_0x5e6791[_0x39aecb(0x18a)][_0x39aecb(0x13da)]=[_0x5e6791[_0x39aecb(0x18a)]['linkedWorldBookId']],delete _0x5e6791[_0x39aecb(0x18a)][_0x39aecb(0x4ee)]);if(typeof _0x5e6791[_0x39aecb(0xe4a)]===_0x39aecb(0xcb8))_0x5e6791[_0x39aecb(0xe4a)]=![];!_0x5e6791[_0x39aecb(0x9d7)]&&typeof _0x5e6791[_0x39aecb(0x18a)][_0x39aecb(0xf58)]===_0x39aecb(0xcb8)&&(_0x5e6791['settings'][_0x39aecb(0xf58)]='我');if(_0x5e6791['isGroup']&&_0x5e6791[_0x39aecb(0x954)]){let _0x157ade=![];_0x76bf02['forEach'](_0x345046=>{const _0xcfb96c=_0x39aecb;_0x345046['id']===_0x5e6791['id']&&_0x345046[_0xcfb96c(0xe2d)]&&delete _0x345046['originalName'];}),_0x5e6791['members'][_0x39aecb(0x12be)](_0x1e3997=>{const _0x54cab4=_0x39aecb,_0x14bf6f=_0x76bf02['find'](_0x3e60b3=>_0x3e60b3['id']===_0x1e3997['id']);if(_0x14bf6f&&_0x14bf6f[_0x54cab4(0x18a)]){const _0x169bf3=_0x14bf6f[_0x54cab4(0x18a)][_0x54cab4(0x663)]||'';_0x1e3997[_0x54cab4(0xea1)]!==_0x169bf3&&(_0x1e3997[_0x54cab4(0xea1)]=_0x169bf3,_0x157ade=!![]);}else typeof _0x1e3997[_0x54cab4(0xea1)]==='undefined'&&(_0x1e3997[_0x54cab4(0xea1)]='',_0x157ade=!![]);});if(_0x157ade)_0xb81d4e['chats'][_0x39aecb(0x5d0)](_0x5e6791);}if(!_0x5e6791[_0x39aecb(0x18a)][_0x39aecb(0x9e7)])_0x5e6791['settings']['enableAutoMemory']=![];if(!_0x5e6791['settings'][_0x39aecb(0xbfd)])_0x5e6791['settings'][_0x39aecb(0xbfd)]=0x14;if(!_0x5e6791['longTermMemory'])_0x5e6791[_0x39aecb(0x3b4)]=[];if(!_0x5e6791['lastMemorySummaryTimestamp'])_0x5e6791[_0x39aecb(0x37a)]=0x0;if(!_0x5e6791['isGroup']){typeof _0x5e6791[_0x39aecb(0x18a)]['enableBackgroundActivity']===_0x39aecb(0xcb8)&&(_0x5e6791[_0x39aecb(0x18a)][_0x39aecb(0xc00)]=!![]);typeof _0x5e6791[_0x39aecb(0x18a)][_0x39aecb(0xe5b)]===_0x39aecb(0xcb8)&&(_0x5e6791['settings'][_0x39aecb(0xe5b)]=![]);if(!_0x5e6791['status'])_0x5e6791[_0x39aecb(0x93c)]={'text':'在线','lastUpdate':Date[_0x39aecb(0x12d6)](),'isBusy':![]};if(!_0x5e6791[_0x39aecb(0xcda)])_0x5e6791[_0x39aecb(0xcda)]={'status':'friend','blockedTimestamp':null,'applicationReason':''};if(!_0x5e6791[_0x39aecb(0x18a)]||!_0x5e6791[_0x39aecb(0x18a)][_0x39aecb(0x8c6)]){if(!_0x5e6791[_0x39aecb(0x18a)])_0x5e6791[_0x39aecb(0x18a)]={};_0x5e6791[_0x39aecb(0x18a)][_0x39aecb(0x8c6)]=[];}if(typeof _0x5e6791[_0x39aecb(0x18a)]['isOfflineMode']===_0x39aecb(0xcb8))_0x5e6791[_0x39aecb(0x18a)][_0x39aecb(0x328)]=![];if(typeof _0x5e6791[_0x39aecb(0x18a)][_0x39aecb(0x780)]===_0x39aecb(0xcb8))_0x5e6791[_0x39aecb(0x18a)][_0x39aecb(0x780)]=0x64;if(typeof _0x5e6791[_0x39aecb(0x18a)][_0x39aecb(0x1084)]===_0x39aecb(0xcb8))_0x5e6791['settings'][_0x39aecb(0x1084)]=0x12c;typeof _0x5e6791[_0x39aecb(0x18a)][_0x39aecb(0xf1f)]===_0x39aecb(0xcb8)&&(_0x5e6791[_0x39aecb(0x18a)][_0x39aecb(0xf1f)]=![]);if(typeof _0x5e6791[_0x39aecb(0x25c)]===_0x39aecb(0xcb8))_0x5e6791[_0x39aecb(0x25c)]=_0x39aecb(0x4d0);if(typeof _0x5e6791['randomJottings']===_0x39aecb(0xcb8))_0x5e6791[_0x39aecb(0x2cf)]=_0x39aecb(0x4d0);!Array['isArray'](_0x5e6791[_0x39aecb(0x57e)])&&(_0x5e6791[_0x39aecb(0x57e)]=[]);}return typeof _0x5e6791[_0x39aecb(0x18a)]['stickerCategoryIds']===_0x39aecb(0xcb8)&&(_0x5e6791['settings'][_0x39aecb(0x1371)]?_0x5e6791['settings']['stickerCategoryIds']=[_0x5e6791[_0x39aecb(0x18a)][_0x39aecb(0x1371)]]:_0x5e6791[_0x39aecb(0x18a)]['stickerCategoryIds']=[],delete _0x5e6791['settings'][_0x39aecb(0x1371)]),_0x42b4b8[_0x5e6791['id']]=_0x5e6791,_0x42b4b8;},{});const _0x4f03f6=[];_0x2e44f7[_0x186c39(0x12be)](_0x5e0e96=>{const _0x6f0236=_0x186c39;if(_0x5e0e96['type']===_0x6f0236(0x7e1)&&_0x5e0e96[_0x6f0236(0xd7d)]&&!_0x5e0e96[_0x6f0236(0x981)]){const _0x581915=_0x76bf02['find'](_0x45d50f=>!_0x45d50f[_0x6f0236(0x9d7)]&&_0x45d50f[_0x6f0236(0xe2d)]===_0x5e0e96['authorName']);if(_0x581915)_0x5e0e96[_0x6f0236(0x981)]=_0x581915['id'],_0x4f03f6['push'](_0x5e0e96);else{const _0xe7b8c5=_0x76bf02[_0x6f0236(0xc0d)](_0x517e6a=>!_0x517e6a[_0x6f0236(0x9d7)]&&_0x517e6a[_0x6f0236(0x564)]===_0x5e0e96[_0x6f0236(0xd7d)]);_0xe7b8c5&&(_0x5e0e96[_0x6f0236(0x981)]=_0xe7b8c5['id'],_0x4f03f6['push'](_0x5e0e96));}}}),_0x4f03f6[_0x186c39(0x990)]>0x0&&await _0xb81d4e['memories'][_0x186c39(0x100e)](_0x4f03f6),_0x505390[_0x186c39(0x30c)]=_0x27b412||{'id':'main','proxyUrl':'','apiKey':'','model':'','secondaryProxyUrl':'','secondaryApiKey':'','secondaryModel':'','minimaxGroupId':'','minimaxApiKey':'','minimaxModel':'speech-01'},_0x505390[_0x186c39(0x407)]=_0x4ce37d||[],_0x505390['worldBooks']=_0x3814a2||[],_0x304e8d[_0x186c39(0x13c7)]=_0x3db621?.[_0x186c39(0x13c7)]||[],_0x505390[_0x186c39(0x56b)]=_0x7f099||[],_0x505390[_0x186c39(0x1190)]=_0x46a27e||{'id':_0x186c39(0x114d),'nickname':_0x186c39(0x80e),'avatar':_0x186c39(0x7e7),'banner':_0x186c39(0x10a5)},allFavoriteItems=_0x51c9ef||[];}async function _0x120ddf(){const _0x390cc8=_0x85c4bf;await _0xb81d4e[_0x390cc8(0x410)]['put']({'id':_0x390cc8(0x114d),'playlist':_0x304e8d[_0x390cc8(0x13c7)]});}function _0x5d6a58(_0x3677e3){const _0x4d226f=_0x85c4bf;if(!_0x3677e3)return'';const _0x5bcbd3=new Date(_0x3677e3),_0x52228e=String(_0x5bcbd3[_0x4d226f(0x507)]())['padStart'](0x2,'0'),_0x90dca9=String(_0x5bcbd3[_0x4d226f(0x28c)]())[_0x4d226f(0x738)](0x2,'0');return _0x52228e+':'+_0x90dca9;}function _0x3e14b1(_0x332bc6){const _0x23b9e3=_0x85c4bf,_0x20e9f7=Date['now'](),_0x59badc=Math[_0x23b9e3(0xd71)]((_0x20e9f7-_0x332bc6)/0x3e8);if(_0x59badc<0x3c)return'刚刚';const _0x57553c=Math[_0x23b9e3(0xd71)](_0x59badc/0x3c);if(_0x57553c<0x3c)return _0x57553c+_0x23b9e3(0x58c);const _0x5b7c87=Math[_0x23b9e3(0xd71)](_0x57553c/0x3c);if(_0x5b7c87<0x18)return _0x5b7c87+_0x23b9e3(0xe84);const _0x374a22=Math['floor'](_0x5b7c87/0x18);if(_0x374a22<0x1e)return _0x374a22+'天前';const _0x181dfe=Math['floor'](_0x374a22/0x1e);if(_0x181dfe<0xc)return'大约'+_0x181dfe+'个月前';const _0x32f0d5=Math[_0x23b9e3(0xd71)](_0x374a22/0x16d);return'大约'+_0x32f0d5+'年前';}function _0x5782c9(_0x2d5345){const _0x22764e=_0x85c4bf;if(!_0x2d5345)return'';const _0x32534b=new Date(),_0x343565=new Date(_0x2d5345),_0x1ef7b7=String(_0x343565['getHours']())[_0x22764e(0x738)](0x2,'0'),_0x25c533=String(_0x343565[_0x22764e(0x28c)]())['padStart'](0x2,'0'),_0x43c1a2=_0x1ef7b7+':'+_0x25c533;if(_0x32534b[_0x22764e(0x966)]()===_0x343565['toDateString']())return'今天\x20'+_0x43c1a2;const _0x9523b9=new Date();_0x9523b9[_0x22764e(0x12e9)](_0x32534b[_0x22764e(0x469)]()-0x1);if(_0x9523b9[_0x22764e(0x966)]()===_0x343565[_0x22764e(0x966)]())return _0x22764e(0x3d4)+_0x43c1a2;if(_0x32534b[_0x22764e(0xd45)]()===_0x343565[_0x22764e(0xd45)]()){const _0x5333cd=String(_0x343565[_0x22764e(0x180)]()+0x1),_0x33ee2d=String(_0x343565['getDate']());return _0x5333cd+'月'+_0x33ee2d+'日\x20'+_0x43c1a2;}const _0x1d739a=_0x343565[_0x22764e(0xd45)](),_0x49493c=String(_0x343565[_0x22764e(0x180)]()+0x1),_0x497a19=String(_0x343565[_0x22764e(0x469)]());return _0x1d739a+'年'+_0x49493c+'月'+_0x497a19+'日\x20'+_0x43c1a2;}function _0x5efd56(){const _0x5eac71=_0x85c4bf,_0x26e74f=_0x22087c();document[_0x5eac71(0x479)](_0x5eac71(0x1046))['value']=_0x26e74f[_0x5eac71(0x712)],document[_0x5eac71(0x479)]('nai-steps')[_0x5eac71(0x4e0)]=_0x26e74f[_0x5eac71(0x949)],document[_0x5eac71(0x479)](_0x5eac71(0xc96))[_0x5eac71(0x4e0)]=_0x26e74f[_0x5eac71(0x12df)],document[_0x5eac71(0x479)](_0x5eac71(0x816))[_0x5eac71(0x4e0)]=_0x26e74f[_0x5eac71(0x11f2)],document[_0x5eac71(0x479)](_0x5eac71(0xb7c))['value']=_0x26e74f[_0x5eac71(0x121e)],document['getElementById'](_0x5eac71(0xd9f))[_0x5eac71(0x4e0)]=_0x26e74f[_0x5eac71(0x1213)],document['getElementById'](_0x5eac71(0x434))[_0x5eac71(0xf7b)]=_0x26e74f['quality_toggle'],document[_0x5eac71(0x479)]('nai-smea')['checked']=_0x26e74f[_0x5eac71(0x697)],document[_0x5eac71(0x479)](_0x5eac71(0x379))['checked']=_0x26e74f[_0x5eac71(0x325)],document[_0x5eac71(0x479)](_0x5eac71(0x422))[_0x5eac71(0x4e0)]=_0x26e74f[_0x5eac71(0xfc6)],document['getElementById'](_0x5eac71(0xa2a))['value']=_0x26e74f['default_negative'],document[_0x5eac71(0x479)](_0x5eac71(0xff0))['value']=_0x26e74f[_0x5eac71(0x3c2)],document['getElementById'](_0x5eac71(0x1023))[_0x5eac71(0x4e0)]=_0x26e74f[_0x5eac71(0xc33)]||'';const _0x48e9eb=document['getElementById']('nai-custom-proxy-group');_0x48e9eb[_0x5eac71(0x10dd)][_0x5eac71(0x678)]=_0x26e74f[_0x5eac71(0x3c2)]===_0x5eac71(0x13f7)?_0x5eac71(0xee3):'none';}function _0x59c1ac(){const _0x5d0d44=_0x85c4bf,_0x4da589=document[_0x5d0d44(0x479)](_0x5d0d44(0x12a7))[_0x5d0d44(0xf7b)],_0x2f86cf=document[_0x5d0d44(0x479)](_0x5d0d44(0x2c0))[_0x5d0d44(0x4e0)],_0x510768=document[_0x5d0d44(0x479)](_0x5d0d44(0x6b2))['value'][_0x5d0d44(0x9c1)]();localStorage[_0x5d0d44(0x3f0)](_0x5d0d44(0x1326),_0x4da589),localStorage[_0x5d0d44(0x3f0)](_0x5d0d44(0x2c0),_0x2f86cf),localStorage['setItem'](_0x5d0d44(0x6b2),_0x510768);const _0x56cb90={'resolution':document[_0x5d0d44(0x479)](_0x5d0d44(0x1046))[_0x5d0d44(0x4e0)],'steps':parseInt(document['getElementById'](_0x5d0d44(0xaf7))['value']),'cfg_scale':parseFloat(document['getElementById']('nai-cfg-scale')[_0x5d0d44(0x4e0)]),'sampler':document[_0x5d0d44(0x479)](_0x5d0d44(0x816))[_0x5d0d44(0x4e0)],'seed':parseInt(document['getElementById'](_0x5d0d44(0xb7c))[_0x5d0d44(0x4e0)]),'uc_preset':parseInt(document['getElementById'](_0x5d0d44(0xd9f))[_0x5d0d44(0x4e0)]),'quality_toggle':document[_0x5d0d44(0x479)](_0x5d0d44(0x434))[_0x5d0d44(0xf7b)],'smea':document[_0x5d0d44(0x479)](_0x5d0d44(0x3a8))[_0x5d0d44(0xf7b)],'smea_dyn':document[_0x5d0d44(0x479)](_0x5d0d44(0x379))['checked'],'default_positive':document[_0x5d0d44(0x479)](_0x5d0d44(0x422))[_0x5d0d44(0x4e0)],'default_negative':document[_0x5d0d44(0x479)](_0x5d0d44(0xa2a))['value'],'cors_proxy':document[_0x5d0d44(0x479)](_0x5d0d44(0xff0))[_0x5d0d44(0x4e0)],'custom_proxy_url':document[_0x5d0d44(0x479)](_0x5d0d44(0x1023))[_0x5d0d44(0x4e0)]};localStorage[_0x5d0d44(0x3f0)](_0x5d0d44(0xaa2),JSON[_0x5d0d44(0x1308)](_0x56cb90));}function _0x55aca3(){const _0x2b1f26=_0x85c4bf;localStorage[_0x2b1f26(0x9e3)](_0x2b1f26(0xaa2)),_0x5efd56(),alert(_0x2b1f26(0x8a2));}function _0x22087c(){const _0x4cd9b8=_0x85c4bf,_0x4edaff={'resolution':_0x4cd9b8(0x40a),'steps':0x1c,'cfg_scale':0x5,'sampler':_0x4cd9b8(0x4db),'seed':-0x1,'uc_preset':0x1,'quality_toggle':!![],'smea':!![],'smea_dyn':![],'default_positive':_0x4cd9b8(0x4af),'default_negative':_0x4cd9b8(0xdce),'cors_proxy':_0x4cd9b8(0x8c5),'custom_proxy_url':''},_0x3af23e=localStorage[_0x4cd9b8(0x28f)](_0x4cd9b8(0xaa2));if(_0x3af23e)try{return{..._0x4edaff,...JSON[_0x4cd9b8(0x94c)](_0x3af23e)};}catch(_0x15f658){return _0x4edaff;}return _0x4edaff;}function _0x3384ca(_0x267a99){const _0x1de62f=_0x85c4bf,_0x3c4b81=_0x22087c();if(!_0x267a99||!_0x505390[_0x1de62f(0x1027)][_0x267a99])return console[_0x1de62f(0x90f)](_0x1de62f(0x216)),{'positive':_0x3c4b81['default_positive'],'negative':_0x3c4b81[_0x1de62f(0xe0b)],'source':_0x1de62f(0xbaa)};const _0x5dd583=_0x505390[_0x1de62f(0x1027)][_0x267a99],_0x517795=_0x5dd583[_0x1de62f(0x18a)][_0x1de62f(0x12bf)]||{};return _0x517795['promptSource']==='character'?(console[_0x1de62f(0x90f)](_0x1de62f(0x4c8)),console[_0x1de62f(0x90f)](_0x1de62f(0xd02),_0x517795[_0x1de62f(0x69c)]||_0x1de62f(0x35e)),console[_0x1de62f(0x90f)](_0x1de62f(0x1162),_0x517795['characterNegativePrompt']||_0x1de62f(0x35e)),{'positive':_0x517795['characterPositivePrompt']||'','negative':_0x517795[_0x1de62f(0x327)]||'','source':_0x1de62f(0x390)}):(console['log']('✅\x20NAI提示词：使用系统配置'),console[_0x1de62f(0x90f)](_0x1de62f(0xd02),_0x3c4b81[_0x1de62f(0xfc6)]||_0x1de62f(0x35e)),console[_0x1de62f(0x90f)]('\x20\x20\x20负面:',_0x3c4b81[_0x1de62f(0xe0b)]||_0x1de62f(0x35e)),{'positive':_0x3c4b81[_0x1de62f(0xfc6)],'negative':_0x3c4b81[_0x1de62f(0xe0b)],'source':_0x1de62f(0xbaa)});}async function _0x36e03d(){const _0x2d85ed=_0x85c4bf,_0x4729a1=document[_0x2d85ed(0x479)](_0x2d85ed(0x6b2))['value']['trim'](),_0x412f5a=document[_0x2d85ed(0x479)](_0x2d85ed(0x2c0))[_0x2d85ed(0x4e0)],_0x5154ec=document[_0x2d85ed(0x479)](_0x2d85ed(0xa9f))[_0x2d85ed(0x4e0)]['trim']();if(!_0x4729a1){alert(_0x2d85ed(0xe7b));return;}if(!_0x5154ec){alert(_0x2d85ed(0xc91));return;}const _0x293ada=_0x22087c(),_0xe741d3=document[_0x2d85ed(0x479)](_0x2d85ed(0x6ad))['value']['trim'](),_0x13e04d=document[_0x2d85ed(0x479)](_0x2d85ed(0x1231)),_0x179b7b=document[_0x2d85ed(0x479)]('nai-test-result'),_0x58ba3b=document[_0x2d85ed(0x479)](_0x2d85ed(0xbe3)),_0x3715c5=document['getElementById'](_0x2d85ed(0x12ac));_0x13e04d[_0x2d85ed(0x10dd)][_0x2d85ed(0x678)]=_0x2d85ed(0xee3),_0x179b7b[_0x2d85ed(0x10dd)][_0x2d85ed(0x678)]=_0x2d85ed(0xff8),_0x58ba3b[_0x2d85ed(0x10dd)]['display']=_0x2d85ed(0xff8),_0x3715c5[_0x2d85ed(0xfce)]=!![],_0x3715c5[_0x2d85ed(0x97b)]='生成中...';try{const [_0x3e4d99,_0x10bebc]=_0x293ada[_0x2d85ed(0x712)][_0x2d85ed(0x53e)]('x')[_0x2d85ed(0x2e1)](Number);let _0x67cce7;_0x412f5a[_0x2d85ed(0x44f)](_0x2d85ed(0xcc1))?_0x67cce7={'input':_0x5154ec,'model':_0x412f5a,'action':_0x2d85ed(0x1340),'parameters':{'params_version':0x3,'width':_0x3e4d99,'height':_0x10bebc,'scale':_0x293ada[_0x2d85ed(0x12df)],'sampler':_0x293ada[_0x2d85ed(0x11f2)],'steps':_0x293ada[_0x2d85ed(0x949)],'seed':_0x293ada[_0x2d85ed(0x121e)]===-0x1?Math[_0x2d85ed(0xd71)](Math[_0x2d85ed(0x103a)]()*0x2540be3ff):_0x293ada['seed'],'n_samples':0x1,'ucPreset':_0x293ada[_0x2d85ed(0x1213)],'qualityToggle':_0x293ada['quality_toggle'],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':'karras','legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x5154ec,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0xe741d3,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0xe741d3,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x67cce7={'input':_0x5154ec,'model':_0x412f5a,'action':'generate','parameters':{'width':_0x3e4d99,'height':_0x10bebc,'scale':_0x293ada['cfg_scale'],'sampler':_0x293ada[_0x2d85ed(0x11f2)],'steps':_0x293ada[_0x2d85ed(0x949)],'seed':_0x293ada[_0x2d85ed(0x121e)]===-0x1?Math[_0x2d85ed(0xd71)](Math[_0x2d85ed(0x103a)]()*0x2540be3ff):_0x293ada[_0x2d85ed(0x121e)],'n_samples':0x1,'ucPreset':_0x293ada['uc_preset'],'qualityToggle':_0x293ada['quality_toggle'],'sm':_0x293ada[_0x2d85ed(0x697)],'sm_dyn':_0x293ada['smea_dyn'],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x2d85ed(0x2fc),'negative_prompt':_0xe741d3}};console[_0x2d85ed(0x90f)]('📤\x20发送请求到\x20NovelAI\x20API'),console[_0x2d85ed(0x90f)](_0x2d85ed(0x258),_0x412f5a),console[_0x2d85ed(0x90f)](_0x2d85ed(0x70f),JSON[_0x2d85ed(0x1308)](_0x67cce7,null,0x2));let _0x310110;_0x412f5a[_0x2d85ed(0x44f)](_0x2d85ed(0xcc1))?_0x310110=_0x2d85ed(0xe98):_0x310110=_0x2d85ed(0x51f);let _0x228d28=_0x293ada[_0x2d85ed(0x3c2)];_0x228d28===_0x2d85ed(0x13f7)&&(_0x228d28=_0x293ada['custom_proxy_url']||'');_0x228d28&&_0x228d28!==''&&(_0x310110=_0x228d28+encodeURIComponent(_0x310110));const _0x284de6=/Chrome/[_0x2d85ed(0x101d)](navigator[_0x2d85ed(0x7b2)])&&!/Edg/[_0x2d85ed(0x101d)](navigator[_0x2d85ed(0x7b2)]);let _0x12743d={'method':_0x2d85ed(0xba0),'headers':{'Content-Type':_0x2d85ed(0xcb5),'Authorization':_0x2d85ed(0xb27)+_0x4729a1},'body':JSON['stringify'](_0x67cce7)};if(_0x284de6){console[_0x2d85ed(0x90f)](_0x2d85ed(0xef4));const _0x59b04c={};for(const [_0x54c621,_0x43f18e]of Object[_0x2d85ed(0xef7)](_0x12743d[_0x2d85ed(0x4c9)])){_0x59b04c[_0x54c621]=_0x43f18e[_0x2d85ed(0x491)](/[^\x00-\xFF]/g,'');}_0x12743d['headers']=_0x59b04c;}const _0x1c0f40=await fetch(_0x310110,_0x12743d);console[_0x2d85ed(0x90f)](_0x2d85ed(0x115e),_0x1c0f40['status']),console['log']('Response\x20headers:',[..._0x1c0f40[_0x2d85ed(0x4c9)][_0x2d85ed(0xef7)]()]);if(!_0x1c0f40['ok']){const _0x39948d=await _0x1c0f40[_0x2d85ed(0x56d)]();console[_0x2d85ed(0xe3b)](_0x2d85ed(0xd6b),_0x39948d);throw new Error(_0x2d85ed(0x783)+_0x1c0f40['status']+_0x2d85ed(0x1044)+_0x39948d);}const _0x3fb3a7=_0x1c0f40[_0x2d85ed(0x4c9)]['get'](_0x2d85ed(0x747));console[_0x2d85ed(0x90f)]('Content-Type:',_0x3fb3a7);let _0xcd0930;if(_0x3fb3a7&&_0x3fb3a7[_0x2d85ed(0x44f)](_0x2d85ed(0x11fa))){console[_0x2d85ed(0x90f)](_0x2d85ed(0xf22)),_0x13e04d[_0x2d85ed(0x97b)]='正在接收流式数据...';const _0x48de47=await _0x1c0f40[_0x2d85ed(0x56d)]();console[_0x2d85ed(0x90f)](_0x2d85ed(0x915),_0x48de47[_0x2d85ed(0x990)]);const _0x1c825d=_0x48de47['trim']()[_0x2d85ed(0x53e)]('\x0a');let _0x13b78d=null;for(let _0x1967e7=_0x1c825d['length']-0x1;_0x1967e7>=0x0;_0x1967e7--){const _0x588b54=_0x1c825d[_0x1967e7][_0x2d85ed(0x9c1)]();if(_0x588b54[_0x2d85ed(0x591)](_0x2d85ed(0x8e5))&&_0x588b54!==_0x2d85ed(0x3ec)){const _0x83e44d=_0x588b54['substring'](0x6);try{const _0x5878c1=JSON[_0x2d85ed(0x94c)](_0x83e44d);if(_0x5878c1[_0x2d85ed(0x7fc)]===_0x2d85ed(0x3a4)&&_0x5878c1[_0x2d85ed(0x676)]){_0x13b78d=_0x5878c1['image'],console[_0x2d85ed(0x90f)](_0x2d85ed(0x98d));break;}if(_0x5878c1[_0x2d85ed(0x104c)]){_0x13b78d=_0x5878c1[_0x2d85ed(0x104c)],console['log'](_0x2d85ed(0x32e));break;}if(_0x5878c1[_0x2d85ed(0x676)]){_0x13b78d=_0x5878c1[_0x2d85ed(0x676)],console['log'](_0x2d85ed(0xadf));break;}}catch(_0x4ba76c){_0x13b78d=_0x83e44d,console[_0x2d85ed(0x90f)]('直接使用\x20base64\x20数据');break;}}}if(!_0x13b78d)throw new Error(_0x2d85ed(0x876));const _0x25d168=_0x13b78d[_0x2d85ed(0x591)]('iVBORw0KGgo'),_0x9f682a=_0x13b78d[_0x2d85ed(0x591)](_0x2d85ed(0xcfc));if(_0x25d168||_0x9f682a){console['log'](_0x2d85ed(0x636));const _0x31dd94=atob(_0x13b78d),_0x8b952a=new Uint8Array(_0x31dd94[_0x2d85ed(0x990)]);for(let _0x26fe05=0x0;_0x26fe05<_0x31dd94[_0x2d85ed(0x990)];_0x26fe05++){_0x8b952a[_0x26fe05]=_0x31dd94[_0x2d85ed(0x113e)](_0x26fe05);}const _0x54c9fe=new Blob([_0x8b952a],{'type':_0x25d168?_0x2d85ed(0x541):'image/jpeg'});console['log'](_0x2d85ed(0x102b),_0x54c9fe['size']);const _0x28af2f=URL['createObjectURL'](_0x54c9fe);document[_0x2d85ed(0x479)](_0x2d85ed(0x8f1))['src']=_0x28af2f,_0x13e04d[_0x2d85ed(0x10dd)]['display']='none',_0x179b7b[_0x2d85ed(0x10dd)][_0x2d85ed(0x678)]='block',console[_0x2d85ed(0x90f)](_0x2d85ed(0x10fb));return;}console[_0x2d85ed(0x90f)](_0x2d85ed(0x688));const _0x53fd0d=atob(_0x13b78d),_0x203e9c=new Uint8Array(_0x53fd0d[_0x2d85ed(0x990)]);for(let _0x2ddafa=0x0;_0x2ddafa<_0x53fd0d[_0x2d85ed(0x990)];_0x2ddafa++){_0x203e9c[_0x2ddafa]=_0x53fd0d[_0x2d85ed(0x113e)](_0x2ddafa);}_0xcd0930=new Blob([_0x203e9c]),console['log'](_0x2d85ed(0xe97),_0xcd0930['size']);}else _0xcd0930=await _0x1c0f40[_0x2d85ed(0xb02)](),console[_0x2d85ed(0x90f)](_0x2d85ed(0x128e),_0xcd0930[_0x2d85ed(0x858)],_0x2d85ed(0x2e5),_0xcd0930['size']);try{if(typeof JSZip===_0x2d85ed(0xcb8))throw new Error('JSZip库未加载，请刷新页面重试');_0x13e04d[_0x2d85ed(0x97b)]=_0x2d85ed(0xf26);const _0x1236de=await JSZip[_0x2d85ed(0x68d)](_0xcd0930);console[_0x2d85ed(0x90f)](_0x2d85ed(0x863),Object[_0x2d85ed(0x108c)](_0x1236de[_0x2d85ed(0xe63)]));let _0x385d5e=null;for(let _0x241848 in _0x1236de['files']){if(_0x241848[_0x2d85ed(0xab4)](/\.(png|jpg|jpeg|webp)$/i)){_0x385d5e=_0x1236de[_0x2d85ed(0xe63)][_0x241848],console['log'](_0x2d85ed(0x4ff),_0x241848);break;}}if(!_0x385d5e)throw new Error(_0x2d85ed(0x5e5));const _0x27ec53=await _0x385d5e['async']('blob');console[_0x2d85ed(0x90f)](_0x2d85ed(0xaaa),_0x27ec53[_0x2d85ed(0xa7a)]);const _0x2846e6=URL[_0x2d85ed(0xe9c)](_0x27ec53);console[_0x2d85ed(0x90f)](_0x2d85ed(0xb35),_0x2846e6),document[_0x2d85ed(0x479)](_0x2d85ed(0x8f1))['src']=_0x2846e6,_0x13e04d[_0x2d85ed(0x10dd)][_0x2d85ed(0x678)]=_0x2d85ed(0xff8),_0x179b7b[_0x2d85ed(0x10dd)]['display']=_0x2d85ed(0xee3);}catch(_0x46ffd0){console[_0x2d85ed(0xe3b)]('ZIP解压失败:',_0x46ffd0),console[_0x2d85ed(0x90f)](_0x2d85ed(0x922));if(_0xcd0930[_0x2d85ed(0x858)][_0x2d85ed(0x591)](_0x2d85ed(0xd70))){const _0x3acdad=URL['createObjectURL'](_0xcd0930);document[_0x2d85ed(0x479)](_0x2d85ed(0x8f1))[_0x2d85ed(0xa9c)]=_0x3acdad,_0x13e04d[_0x2d85ed(0x10dd)][_0x2d85ed(0x678)]=_0x2d85ed(0xff8),_0x179b7b[_0x2d85ed(0x10dd)][_0x2d85ed(0x678)]=_0x2d85ed(0xee3);}else throw new Error(_0x2d85ed(0x5e6)+_0x46ffd0['message']);}}catch(_0x4d4470){console['error']('NovelAI生成失败:',_0x4d4470),_0x13e04d[_0x2d85ed(0x10dd)]['display']=_0x2d85ed(0xff8),_0x58ba3b['style']['display']=_0x2d85ed(0xee3),_0x58ba3b[_0x2d85ed(0x97b)]=_0x2d85ed(0x1014)+_0x4d4470[_0x2d85ed(0x757)];}finally{_0x3715c5[_0x2d85ed(0xfce)]=![],_0x3715c5[_0x2d85ed(0x97b)]=_0x2d85ed(0x12e2);}}function _0xabb267(_0x1f5e59,_0x4096a7){const _0x5192f3=_0x85c4bf;_0x361231(),clearTimeout(_0x1ba729);const _0x56464f=_0x505390[_0x5192f3(0x1027)][_0x1f5e59];if(!_0x56464f)return;const _0xde6ead=document[_0x5192f3(0x479)]('notification-bar');document[_0x5192f3(0x479)](_0x5192f3(0x1383))[_0x5192f3(0xa9c)]=_0x56464f[_0x5192f3(0x18a)]['aiAvatar']||_0x56464f[_0x5192f3(0x18a)][_0x5192f3(0x67c)]||_0x28c106,document[_0x5192f3(0x479)](_0x5192f3(0xb74))[_0x5192f3(0x8bc)]('.name')[_0x5192f3(0x97b)]=_0x56464f[_0x5192f3(0x564)],document['getElementById'](_0x5192f3(0xb74))[_0x5192f3(0x8bc)]('.message')[_0x5192f3(0x97b)]=_0x4096a7,_0xde6ead[_0x5192f3(0x9cd)][_0x5192f3(0x8b6)](_0x5192f3(0x45a)),void _0xde6ead[_0x5192f3(0x918)],_0xde6ead['classList'][_0x5192f3(0x807)](_0x5192f3(0x45a));const _0x314252=_0xde6ead[_0x5192f3(0xbcf)](!![]);_0xde6ead[_0x5192f3(0x1134)][_0x5192f3(0xf0d)](_0x314252,_0xde6ead),_0x314252[_0x5192f3(0xa75)](_0x5192f3(0xd2f),()=>{const _0x2e037d=_0x5192f3;_0x178862(_0x1f5e59),_0x314252[_0x2e037d(0x9cd)][_0x2e037d(0x8b6)]('visible');}),_0x1ba729=setTimeout(()=>{const _0x4dba03=_0x5192f3;_0x314252['classList'][_0x4dba03(0x8b6)](_0x4dba03(0x45a));},0xfa0),_0x3f74ae();}function _0x2ded70(){const _0x1c799c=_0x85c4bf,_0x2f2c73=new Date(),_0x7faa90=_0x2f2c73[_0x1c799c(0xd96)](_0x1c799c(0xdc2),{'hour':'2-digit','minute':_0x1c799c(0xcde)}),_0x43cebe=_0x2f2c73[_0x1c799c(0xba5)]('zh-CN',{'weekday':_0x1c799c(0x1232),'month':_0x1c799c(0x1232),'day':'numeric'});document['getElementById']('status-bar-time')['textContent']=_0x7faa90;}function _0x2da9f3(_0x5780af){const _0x26db3f=_0x85c4bf,_0x482890=_0x5780af[_0x26db3f(0x9c1)]();if(_0x482890[_0x26db3f(0x591)]('[')&&_0x482890['endsWith'](']'))try{const _0x2459a6=JSON[_0x26db3f(0x94c)](_0x482890);if(Array[_0x26db3f(0x285)](_0x2459a6))return console[_0x26db3f(0x90f)](_0x26db3f(0x642)),_0x2459a6;}catch(_0x23ed89){console[_0x26db3f(0x139e)](_0x26db3f(0x6eb));}const _0x51efe2=_0x482890['match'](/{[^{}]*}/g);if(_0x51efe2){const _0x25db31=[];for(const _0x1d4773 of _0x51efe2){try{const _0x55674e=JSON[_0x26db3f(0x94c)](_0x1d4773);_0x25db31['push'](_0x55674e);}catch(_0x51b2d5){console[_0x26db3f(0x139e)](_0x26db3f(0x9e0),_0x1d4773);}}if(_0x25db31[_0x26db3f(0x990)]>0x0)return console[_0x26db3f(0x90f)](_0x26db3f(0xf38)),_0x25db31;}return console['error'](_0x26db3f(0x79e)),[{'type':_0x26db3f(0x56d),'content':_0x5780af}];}function _0x3ae0c5(_0x1eaa19=new Date()){const _0x7f895e=_0x85c4bf,_0x342e20=_0x1eaa19[_0x7f895e(0x507)]();if(_0x342e20>=0x0&&_0x342e20<0x5)return'凌晨';else{if(_0x342e20>=0x5&&_0x342e20<0x9)return'早上';else{if(_0x342e20>=0x9&&_0x342e20<0xd)return'上午';else{if(_0x342e20>=0xd&&_0x342e20<0x12)return'下午';else{if(_0x342e20>=0x12&&_0x342e20<0x18)return'晚上';}}}}return'现在';}async function _0x35f22c(){const _0x1664c2=_0x85c4bf,_0x5b1494=document[_0x1664c2(0x479)](_0x1664c2(0x965));_0x5b1494['innerHTML']=_0x1664c2(0x193);const _0x276c7b=await _0xb81d4e['apiPresets'][_0x1664c2(0x4ba)]();_0x276c7b[_0x1664c2(0x12be)](_0x4cc73c=>{const _0x31f8a9=_0x1664c2,_0x5db31a=document['createElement'](_0x31f8a9(0x9a2));_0x5db31a['value']=_0x4cc73c['id'],_0x5db31a[_0x31f8a9(0x97b)]=_0x4cc73c[_0x31f8a9(0x564)],_0x5b1494[_0x31f8a9(0x9f4)](_0x5db31a);});const _0x6f0221=_0x505390[_0x1664c2(0x30c)];let _0x3ee224=null;for(const _0x4b74e3 of _0x276c7b){if(_0x4b74e3[_0x1664c2(0x42c)]===_0x6f0221[_0x1664c2(0x42c)]&&_0x4b74e3[_0x1664c2(0x2d5)]===_0x6f0221[_0x1664c2(0x2d5)]&&_0x4b74e3[_0x1664c2(0xc42)]===_0x6f0221['model']&&_0x4b74e3[_0x1664c2(0xe39)]===_0x6f0221['secondaryProxyUrl']&&_0x4b74e3['secondaryApiKey']===_0x6f0221[_0x1664c2(0xbf6)]&&_0x4b74e3[_0x1664c2(0x11ea)]===_0x6f0221[_0x1664c2(0x11ea)]&&(_0x4b74e3[_0x1664c2(0x7f1)]||'')===(_0x6f0221['minimaxGroupId']||'')&&(_0x4b74e3[_0x1664c2(0xd7c)]||'')===(_0x6f0221[_0x1664c2(0xd7c)]||'')&&(_0x4b74e3[_0x1664c2(0x8fc)]||_0x1664c2(0xcc4))===(_0x6f0221[_0x1664c2(0x8fc)]||_0x1664c2(0xcc4))){_0x3ee224=_0x4b74e3['id'];break;}}_0x3ee224?_0x5b1494[_0x1664c2(0x4e0)]=_0x3ee224:_0x5b1494[_0x1664c2(0x4e0)]=_0x1664c2(0xb1f);}async function _0x545b84(){const _0x1c1708=_0x85c4bf,_0x565a2d=document[_0x1c1708(0x479)](_0x1c1708(0x965)),_0xc2d893=parseInt(_0x565a2d[_0x1c1708(0x4e0)]);if(isNaN(_0xc2d893))return;const _0x3f0f67=await _0xb81d4e[_0x1c1708(0x126a)]['get'](_0xc2d893);_0x3f0f67&&(_0x505390['apiConfig']={'id':_0x1c1708(0x114d),'proxyUrl':_0x3f0f67[_0x1c1708(0x42c)],'apiKey':_0x3f0f67[_0x1c1708(0x2d5)],'model':_0x3f0f67[_0x1c1708(0xc42)],'secondaryProxyUrl':_0x3f0f67[_0x1c1708(0xe39)],'secondaryApiKey':_0x3f0f67[_0x1c1708(0xbf6)],'secondaryModel':_0x3f0f67['secondaryModel'],'minimaxGroupId':_0x3f0f67['minimaxGroupId'],'minimaxApiKey':_0x3f0f67[_0x1c1708(0xd7c)],'minimaxModel':_0x3f0f67['minimaxModel']},await _0xb81d4e[_0x1c1708(0x30c)][_0x1c1708(0x5d0)](_0x505390[_0x1c1708(0x30c)]),_0xedf874(),document[_0x1c1708(0x479)](_0x1c1708(0x85f))[_0x1c1708(0xd2f)](),_0x3f0f67[_0x1c1708(0xe39)]&&_0x3f0f67['secondaryApiKey']&&document[_0x1c1708(0x479)](_0x1c1708(0x1361))[_0x1c1708(0xd2f)](),alert(_0x1c1708(0x437)+_0x3f0f67[_0x1c1708(0x564)]+'”'));}async function _0x272f57(){const _0x328e99=_0x85c4bf,_0x30fd55=await _0x9a2c09(_0x328e99(0xc3c),_0x328e99(0x103f));if(!_0x30fd55||!_0x30fd55[_0x328e99(0x9c1)]())return;const _0x56bd1b={'name':_0x30fd55[_0x328e99(0x9c1)](),'proxyUrl':document[_0x328e99(0x479)](_0x328e99(0x1060))['value'][_0x328e99(0x9c1)](),'apiKey':document['getElementById'](_0x328e99(0x9f6))[_0x328e99(0x4e0)][_0x328e99(0x9c1)](),'model':document[_0x328e99(0x479)](_0x328e99(0x8d2))['value'],'secondaryProxyUrl':document[_0x328e99(0x479)](_0x328e99(0x10a2))[_0x328e99(0x4e0)][_0x328e99(0x9c1)](),'secondaryApiKey':document['getElementById']('secondary-api-key')[_0x328e99(0x4e0)][_0x328e99(0x9c1)](),'secondaryModel':document[_0x328e99(0x479)](_0x328e99(0x8b5))[_0x328e99(0x4e0)],'minimaxGroupId':document[_0x328e99(0x479)](_0x328e99(0xddc))[_0x328e99(0x4e0)]['trim'](),'minimaxApiKey':document[_0x328e99(0x479)]('minimax-api-key')[_0x328e99(0x4e0)]['trim'](),'minimaxModel':document[_0x328e99(0x479)](_0x328e99(0x227))['value']},_0x470fb7=await _0xb81d4e[_0x328e99(0x126a)][_0x328e99(0x46f)]('name')[_0x328e99(0x4a2)](_0x56bd1b['name'])[_0x328e99(0x64e)]();if(_0x470fb7){const _0x2e125a=await _0x1a9e79(_0x328e99(0xfe1),_0x328e99(0x11cd)+_0x56bd1b[_0x328e99(0x564)]+_0x328e99(0x5fe),{'confirmButtonClass':_0x328e99(0x95a)});if(!_0x2e125a)return;_0x56bd1b['id']=_0x470fb7['id'];}await _0xb81d4e['apiPresets']['put'](_0x56bd1b),await _0x35f22c(),alert(_0x328e99(0xd65));}async function _0x5dbd83(){const _0x6bffc6=_0x85c4bf,_0x2161f6=document['getElementById'](_0x6bffc6(0x965)),_0xffae11=parseInt(_0x2161f6[_0x6bffc6(0x4e0)]);if(isNaN(_0xffae11)){alert(_0x6bffc6(0xc22));return;}const _0x2b872c=await _0xb81d4e[_0x6bffc6(0x126a)]['get'](_0xffae11);if(!_0x2b872c)return;const _0x4aec59=await _0x1a9e79('删除预设',_0x6bffc6(0x7aa)+_0x2b872c['name']+'”\x20吗？',{'confirmButtonClass':_0x6bffc6(0x95a)});_0x4aec59&&(await _0xb81d4e[_0x6bffc6(0x126a)][_0x6bffc6(0x1ea)](_0xffae11),await _0x35f22c(),alert(_0x6bffc6(0xddf)));}function _0xedf874(){const _0x31c936=_0x85c4bf;document[_0x31c936(0x479)]('proxy-url')[_0x31c936(0x4e0)]=_0x505390[_0x31c936(0x30c)][_0x31c936(0x42c)]||'',document[_0x31c936(0x479)](_0x31c936(0x9f6))[_0x31c936(0x4e0)]=_0x505390[_0x31c936(0x30c)][_0x31c936(0x2d5)]||'',document[_0x31c936(0x479)](_0x31c936(0x10a2))[_0x31c936(0x4e0)]=_0x505390['apiConfig'][_0x31c936(0xe39)]||'',document[_0x31c936(0x479)]('secondary-api-key')[_0x31c936(0x4e0)]=_0x505390[_0x31c936(0x30c)]['secondaryApiKey']||'',document[_0x31c936(0x479)](_0x31c936(0x829))[_0x31c936(0xf7b)]=_0x505390['globalSettings'][_0x31c936(0xc00)]||![],document[_0x31c936(0x479)](_0x31c936(0x968))[_0x31c936(0x4e0)]=_0x505390[_0x31c936(0x888)][_0x31c936(0xe65)]||0x3c,document[_0x31c936(0x479)](_0x31c936(0x6a4))['value']=_0x505390[_0x31c936(0x888)][_0x31c936(0x10b3)]||0x1,document['getElementById']('enable-ai-drawing-switch')[_0x31c936(0xf7b)]=_0x505390[_0x31c936(0x888)][_0x31c936(0x105c)],document[_0x31c936(0x479)](_0x31c936(0x52c))[_0x31c936(0x4e0)]=_0x505390[_0x31c936(0x888)][_0x31c936(0x13f8)]||0x32,document[_0x31c936(0x479)](_0x31c936(0xc2a))['value']=_0x505390[_0x31c936(0x888)][_0x31c936(0x625)]||0x1e;const _0x25349d=document[_0x31c936(0x479)](_0x31c936(0x1127)),_0xbb8ce8=document[_0x31c936(0x479)](_0x31c936(0x769)),_0x4ee32a=_0x505390['globalSettings']['apiTemperature']||0.8;_0x25349d[_0x31c936(0x4e0)]=_0x4ee32a,_0xbb8ce8[_0x31c936(0x97b)]=_0x4ee32a,document[_0x31c936(0x479)](_0x31c936(0xddc))['value']=_0x505390[_0x31c936(0x30c)]['minimaxGroupId']||'',document[_0x31c936(0x479)](_0x31c936(0xac2))[_0x31c936(0x4e0)]=_0x505390[_0x31c936(0x30c)][_0x31c936(0xd7c)]||'',document['getElementById'](_0x31c936(0x227))['value']=_0x505390[_0x31c936(0x30c)]['minimaxModel']||_0x31c936(0xcc4),_0x35f22c(),_0x3d5843();}window[_0x85c4bf(0x11b6)]=_0xedf874;async function _0x5671c8(){const _0x5ee400=_0x85c4bf,_0x312f18=document['getElementById'](_0x5ee400(0x6d0));_0x312f18['innerHTML']='';const _0x14d8d9=await _0xb81d4e['npcs'][_0x5ee400(0x4ba)]();if(_0x14d8d9[_0x5ee400(0x990)]===0x0){_0x312f18['innerHTML']=_0x5ee400(0xc06);return;}_0x14d8d9['forEach'](_0x21425b=>{const _0x38ec9d=_0x5ee400,_0x326aa8=document[_0x38ec9d(0xbd5)](_0x38ec9d(0x6c8));_0x326aa8[_0x38ec9d(0xfd4)]=_0x38ec9d(0x1270),_0x326aa8[_0x38ec9d(0x13d4)][_0x38ec9d(0x1248)]=_0x21425b['id'],_0x326aa8['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x21425b['avatar']||_0x3ea4df)+'\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x21425b['name']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>'+_0x21425b[_0x38ec9d(0x596)]['substring'](0x0,0x1e)+'...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x326aa8['addEventListener'](_0x38ec9d(0xd2f),()=>_0x2a76b9(_0x21425b['id'])),_0x33282f(_0x326aa8,async()=>{await _0x128065(_0x21425b['id']);}),_0x312f18[_0x38ec9d(0x9f4)](_0x326aa8);});}async function _0x2a76b9(_0x27c64f=null){const _0x3d0ece=_0x85c4bf;editingNpcId=_0x27c64f;const _0x39f6cc=document[_0x3d0ece(0x479)](_0x3d0ece(0x29b)),_0x2b5b3f=document[_0x3d0ece(0x479)](_0x3d0ece(0xc7e)),_0xf3b278=document[_0x3d0ece(0x479)](_0x3d0ece(0xa82)),_0x30a259=document[_0x3d0ece(0x479)]('npc-persona-input'),_0x527e21=document[_0x3d0ece(0x479)](_0x3d0ece(0x9d5)),_0x4a2d46=document['getElementById'](_0x3d0ece(0x972)),_0x20b22e=document[_0x3d0ece(0x479)](_0x3d0ece(0x305)),_0x38dda4=document['getElementById'](_0x3d0ece(0xc7d));_0x4a2d46[_0x3d0ece(0x3de)]='',_0x4a2d46[_0x3d0ece(0x3de)]+=_0x3d0ece(0x1262)+(_0x505390['qzoneSettings']['nickname']||'我')+_0x3d0ece(0x2da),Object[_0x3d0ece(0x3d5)](_0x505390[_0x3d0ece(0x1027)])['filter'](_0x176ac6=>!_0x176ac6['isGroup'])[_0x3d0ece(0x12be)](_0x3dd028=>{const _0x173991=_0x3d0ece;_0x4a2d46[_0x173991(0x3de)]+='<label><input\x20type=\x22checkbox\x22\x20value=\x22'+_0x3dd028['id']+_0x173991(0x219)+_0x3dd028[_0x173991(0x564)]+'\x20(角色)</label>';});if(_0x27c64f){_0x2b5b3f[_0x3d0ece(0x97b)]=_0x3d0ece(0xf9f);const _0x44ec85=await _0xb81d4e[_0x3d0ece(0x482)][_0x3d0ece(0x111a)](_0x27c64f);_0x44ec85&&(_0xf3b278[_0x3d0ece(0x4e0)]=_0x44ec85[_0x3d0ece(0x564)],_0x30a259[_0x3d0ece(0x4e0)]=_0x44ec85[_0x3d0ece(0x596)],_0x527e21[_0x3d0ece(0xa9c)]=_0x44ec85[_0x3d0ece(0x799)]||_0x3ea4df,_0x20b22e['checked']=_0x44ec85[_0x3d0ece(0xc00)]!==![],_0x38dda4[_0x3d0ece(0x4e0)]=_0x44ec85[_0x3d0ece(0x1097)]||0xf,_0x44ec85[_0x3d0ece(0x11a0)]&&Array['isArray'](_0x44ec85[_0x3d0ece(0x11a0)])&&_0x44ec85[_0x3d0ece(0x11a0)][_0x3d0ece(0x12be)](_0x2bbe23=>{const _0x4edf03=_0x3d0ece,_0x731eed=_0x4a2d46['querySelector'](_0x4edf03(0xc5b)+_0x2bbe23+'\x22]');if(_0x731eed)_0x731eed[_0x4edf03(0xf7b)]=!![];}));}else{_0x2b5b3f[_0x3d0ece(0x97b)]=_0x3d0ece(0xad9),_0xf3b278[_0x3d0ece(0x4e0)]='',_0x30a259[_0x3d0ece(0x4e0)]='',_0x527e21[_0x3d0ece(0xa9c)]=_0x3ea4df,_0x20b22e[_0x3d0ece(0xf7b)]=!![],_0x38dda4[_0x3d0ece(0x4e0)]=0xf;const _0x2ae052=_0x4a2d46[_0x3d0ece(0x8bc)](_0x3d0ece(0x1a7));if(_0x2ae052)_0x2ae052[_0x3d0ece(0xf7b)]=!![];}_0x39f6cc[_0x3d0ece(0x9cd)][_0x3d0ece(0x807)](_0x3d0ece(0x45a));}async function _0x37cfc8(){const _0x454cbb=_0x85c4bf,_0x289c95=document['getElementById'](_0x454cbb(0xa82))[_0x454cbb(0x4e0)]['trim'](),_0x20a596=document[_0x454cbb(0x479)](_0x454cbb(0x63f))[_0x454cbb(0x4e0)][_0x454cbb(0x9c1)]();if(!_0x289c95||!_0x20a596){alert('NPC的昵称和人设都不能为空！');return;}const _0x571282=Array[_0x454cbb(0x22f)](document[_0x454cbb(0x99e)]('#npc-association-list\x20input:checked'))['map'](_0x4435b5=>_0x4435b5[_0x454cbb(0x4e0)]),_0x3ea3ef=document[_0x454cbb(0x479)](_0x454cbb(0x305))[_0x454cbb(0xf7b)],_0xd030e9=parseInt(document[_0x454cbb(0x479)]('npc-action-cooldown-input')[_0x454cbb(0x4e0)])||0xf,_0x5c7b49={'name':_0x289c95,'persona':_0x20a596,'avatar':document[_0x454cbb(0x479)]('npc-avatar-preview')['src'],'associatedWith':_0x571282,'enableBackgroundActivity':_0x3ea3ef,'actionCooldownMinutes':_0xd030e9};if(editingNpcId)await _0xb81d4e[_0x454cbb(0x482)][_0x454cbb(0xeb2)](editingNpcId,_0x5c7b49);else{const _0x11a030=await _0xb81d4e[_0x454cbb(0x482)]['add'](_0x5c7b49);if(_0x551b1c&&_0x505390[_0x454cbb(0x233)]){const _0x4c1def=_0x505390[_0x454cbb(0x1027)][_0x505390[_0x454cbb(0x233)]];_0x4c1def[_0x454cbb(0x9d7)]&&(_0x4c1def[_0x454cbb(0x954)]['push']({'id':_0x454cbb(0xca5)+_0x11a030,'originalName':_0x289c95,'groupNickname':_0x289c95,'persona':_0x20a596,'avatar':_0x5c7b49['avatar'],'isNpc':!![]}),await _0xb81d4e[_0x454cbb(0x1027)][_0x454cbb(0x5d0)](_0x4c1def));}}document[_0x454cbb(0x479)](_0x454cbb(0x29b))[_0x454cbb(0x9cd)][_0x454cbb(0x8b6)]('visible'),_0x551b1c?(_0x551b1c=![],_0xc43f8()):await _0x5671c8();}async function _0x128065(_0x3b54ff){const _0x5b3da0=_0x85c4bf,_0x1b974a=await _0xb81d4e['npcs'][_0x5b3da0(0x111a)](_0x3b54ff);if(!_0x1b974a)return;const _0x90e25b=await _0x1a9e79('删除NPC',_0x5b3da0(0x54f)+_0x1b974a[_0x5b3da0(0x564)]+_0x5b3da0(0x7c7),{'confirmButtonClass':'btn-danger'});_0x90e25b&&(await _0xb81d4e[_0x5b3da0(0x482)][_0x5b3da0(0x1ea)](_0x3b54ff),await _0x5671c8());}let _0x8cc659=0x0;function _0x25dead(_0x5bd395){const _0x3e2bf0=_0x85c4bf,_0x1444eb=document['createElement'](_0x3e2bf0(0x6c8));return _0x1444eb[_0x3e2bf0(0xfd4)]=_0x3e2bf0(0xc86),_0x1444eb[_0x3e2bf0(0x3de)]=_0x3e2bf0(0x43c)+_0x5bd395[_0x3e2bf0(0x564)]+_0x3e2bf0(0x1003),_0x1444eb;}function _0x598558(_0x214653){const _0x2e61ef=_0x85c4bf,_0x14a5da=document['getElementById'](_0x2e61ef(0xc31)),_0x28af03=document[_0x2e61ef(0x479)]('load-more-chats-btn');if(_0x28af03)_0x28af03[_0x2e61ef(0x8b6)]();const _0x2c62e3=_0x8cc659,_0xbbb64e=_0x8cc659+CHAT_LIST_RENDER_WINDOW,_0x3c74e5=_0x214653[_0x2e61ef(0x777)](_0x2c62e3,_0xbbb64e),_0x3ace61=document[_0x2e61ef(0x3dd)]();let _0xe4f9ca=_0x14a5da[_0x2e61ef(0x8bc)]('.chat-group-content:last-of-type');_0x3c74e5['forEach'](_0x17cce8=>{const _0xf3ebd=_0x2e61ef;if(_0x17cce8[_0xf3ebd(0x858)]===_0xf3ebd(0xcfa)){const _0x418379=_0x25dead(_0x17cce8[_0xf3ebd(0x1224)]);_0x3ace61[_0xf3ebd(0x9f4)](_0x418379),_0xe4f9ca=_0x418379[_0xf3ebd(0x8bc)]('.chat-group-content');}else{if(_0x17cce8[_0xf3ebd(0x858)]==='chatItem'){const _0x3a19b4=_0x373be8(_0x17cce8[_0xf3ebd(0xa50)]);_0xe4f9ca&&_0x17cce8[_0xf3ebd(0xa50)][_0xf3ebd(0x194)]?_0xe4f9ca[_0xf3ebd(0x9f4)](_0x3a19b4):(_0x3ace61[_0xf3ebd(0x9f4)](_0x3a19b4),_0xe4f9ca=null);}}}),_0x14a5da[_0x2e61ef(0x9f4)](_0x3ace61),_0x8cc659+=_0x3c74e5[_0x2e61ef(0x990)],_0x214653[_0x2e61ef(0x990)]>_0x8cc659&&_0x24ec4c(_0x14a5da,_0x214653),document['querySelectorAll']('.chat-group-header')[_0x2e61ef(0x12be)](_0x205c66=>{const _0x4e6b14=_0x2e61ef,_0x5a78ca=_0x205c66['cloneNode'](!![]);_0x205c66['parentNode']['replaceChild'](_0x5a78ca,_0x205c66),_0x5a78ca[_0x4e6b14(0xa75)](_0x4e6b14(0xd2f),()=>{const _0x3202a1=_0x4e6b14;_0x5a78ca[_0x3202a1(0x9cd)][_0x3202a1(0x2bf)](_0x3202a1(0xdf9)),_0x5a78ca[_0x3202a1(0x30a)]['classList'][_0x3202a1(0x2bf)](_0x3202a1(0xdf9));});});}async function _0x1b7f69(){const _0x53f7ae=_0x85c4bf,_0x4e047d=document[_0x53f7ae(0x479)]('chat-list');_0x4e047d[_0x53f7ae(0x3de)]='';const _0x50ae95=Object[_0x53f7ae(0x3d5)](_0x505390['chats'])['sort']((_0xa3b2c5,_0x527ac4)=>{const _0x200331=_0x53f7ae,_0x38344b=(_0x527ac4[_0x200331(0xe4a)]||![])-(_0xa3b2c5['isPinned']||![]);if(_0x38344b!==0x0)return _0x38344b;return(_0x527ac4['history'][_0x200331(0x777)](-0x1)[0x0]?.[_0x200331(0x12a2)]||0x0)-(_0xa3b2c5[_0x200331(0x7d3)][_0x200331(0x777)](-0x1)[0x0]?.[_0x200331(0x12a2)]||0x0);}),_0x3e243f=await _0xb81d4e[_0x53f7ae(0xbce)][_0x53f7ae(0x4ba)]();if(_0x50ae95[_0x53f7ae(0x990)]===0x0){_0x4e047d[_0x53f7ae(0x3de)]=_0x53f7ae(0x9ac);return;}_0x3e243f[_0x53f7ae(0x12be)](_0x3ba978=>{const _0x77451a=_0x53f7ae,_0x32cb80=_0x50ae95[_0x77451a(0xc0d)](_0x3ab296=>_0x3ab296['groupId']===_0x3ba978['id']);_0x3ba978[_0x77451a(0x698)]=_0x32cb80?_0x32cb80['history'][_0x77451a(0x777)](-0x1)[0x0]?.[_0x77451a(0x12a2)]||0x0:0x0;}),_0x3e243f[_0x53f7ae(0x382)]((_0x5ab901,_0x1ad658)=>_0x1ad658[_0x53f7ae(0x698)]-_0x5ab901[_0x53f7ae(0x698)]),_0x1bf593=[];const _0x504f29=new Set();_0x3e243f[_0x53f7ae(0x12be)](_0x5e69ea=>{const _0x265195=_0x53f7ae,_0x111c4f=_0x50ae95[_0x265195(0x85d)](_0x141684=>!_0x141684[_0x265195(0x9d7)]&&_0x141684['groupId']===_0x5e69ea['id']);_0x111c4f['length']>0x0&&(_0x1bf593[_0x265195(0x1a0)]({'type':_0x265195(0xcfa),'group':_0x5e69ea}),_0x111c4f[_0x265195(0x12be)](_0x25f3b3=>{const _0x2e2a4c=_0x265195;_0x1bf593[_0x2e2a4c(0x1a0)]({'type':_0x2e2a4c(0x5de),'chat':_0x25f3b3}),_0x504f29[_0x2e2a4c(0x807)](_0x25f3b3['id']);}));}),_0x50ae95[_0x53f7ae(0x12be)](_0x366fdc=>{const _0x21de64=_0x53f7ae;!_0x504f29[_0x21de64(0x391)](_0x366fdc['id'])&&_0x1bf593[_0x21de64(0x1a0)]({'type':_0x21de64(0x5de),'chat':_0x366fdc});}),_0x8cc659=0x0,_0x598558();}function _0x25dead(_0x186a0d){const _0x152688=_0x85c4bf,_0x119bb4=document[_0x152688(0xbd5)](_0x152688(0x6c8));return _0x119bb4['className']='chat-group-container',_0x119bb4[_0x152688(0x3de)]=_0x152688(0x8dc)+_0x186a0d['name']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x119bb4;}function _0x24ec4c(_0x56d9c0,_0x2b4dd3){const _0x500958=_0x85c4bf,_0x534824=document[_0x500958(0xbd5)]('button');_0x534824['id']=_0x500958(0xa8c),_0x534824[_0x500958(0x97b)]=_0x500958(0x122c),_0x534824[_0x500958(0xfd4)]='load-more-btn',_0x534824[_0x500958(0xa75)](_0x500958(0xd2f),()=>_0x598558(_0x2b4dd3),{'once':!![]}),_0x56d9c0[_0x500958(0xaa6)](_0x534824);}function _0x598558(){const _0x22d6d7=_0x85c4bf;if(_0xc050fd)return;const _0x14b80a=document[_0x22d6d7(0x479)](_0x22d6d7(0xc31)),_0x2588e4=document['getElementById'](_0x22d6d7(0x770));if(!_0x14b80a||!_0x2588e4)return;if(_0x8cc659>=_0x1bf593[_0x22d6d7(0x990)])return;_0xc050fd=!![];const _0x15a7fa=_0x8cc659===0x0,_0x351eab=()=>{const _0x47c05b=_0x22d6d7;_0x168e5c(_0x14b80a);const _0x56db49=_0x505390[_0x47c05b(0x888)]['chatListRenderWindow']||0x1e,_0xd1735e=_0x8cc659,_0x25595b=_0x8cc659+_0x56db49,_0x4a9416=_0x1bf593[_0x47c05b(0x777)](_0xd1735e,_0x25595b),_0xa1aa31=document[_0x47c05b(0x3dd)]();let _0x9620f7=_0x14b80a['querySelector']('.chat-group-content:last-of-type');_0x4a9416[_0x47c05b(0x12be)](_0x264e85=>{const _0x31820c=_0x47c05b;if(_0x264e85['type']===_0x31820c(0xcfa)){const _0x591722=_0x25dead(_0x264e85[_0x31820c(0x1224)]);_0xa1aa31[_0x31820c(0x9f4)](_0x591722),_0x9620f7=_0x591722[_0x31820c(0x8bc)](_0x31820c(0xba7));}else{if(_0x264e85['type']==='chatItem'){const _0xdec1a5=_0x373be8(_0x264e85[_0x31820c(0xa50)]);if(_0x264e85[_0x31820c(0xa50)][_0x31820c(0x194)]&&_0x9620f7)_0x9620f7[_0x31820c(0x9f4)](_0xdec1a5);else{_0xa1aa31['appendChild'](_0xdec1a5);if(!_0x264e85[_0x31820c(0xa50)][_0x31820c(0x194)])_0x9620f7=null;}}}}),_0x14b80a['appendChild'](_0xa1aa31),_0x8cc659+=_0x4a9416[_0x47c05b(0x990)],_0x14b80a[_0x47c05b(0x99e)](_0x47c05b(0xdc6))[_0x47c05b(0x12be)](_0x5545fa=>{const _0x497469=_0x47c05b;_0x5545fa[_0x497469(0x13d4)][_0x497469(0x5d3)]='true',_0x5545fa[_0x497469(0xa75)](_0x497469(0xd2f),()=>{const _0x2fbdb7=_0x497469;_0x5545fa['classList'][_0x2fbdb7(0x2bf)]('collapsed'),_0x5545fa[_0x2fbdb7(0x30a)]['classList'][_0x2fbdb7(0x2bf)](_0x2fbdb7(0xdf9));});}),_0xc050fd=![],_0x2588e4['scrollHeight']<=_0x2588e4[_0x47c05b(0xc27)]&&_0x8cc659<_0x1bf593[_0x47c05b(0x990)]&&_0x598558();};_0x15a7fa?_0x351eab():(_0x13e918(_0x14b80a,_0x22d6d7(0xeb7)),setTimeout(_0x351eab,0x1f4));}function _0x373be8(_0x38b1f5){const _0x3e4586=_0x85c4bf;try{const _0x3b151e=_0x38b1f5['history'][_0x3e4586(0x85d)](_0x30a4b2=>!_0x30a4b2[_0x3e4586(0xb9c)])[_0x3e4586(0x777)](-0x1)[0x0]||{};let _0xf5ac9e;if(!_0x38b1f5[_0x3e4586(0x9d7)]&&_0x38b1f5['relationship']?.[_0x3e4586(0x93c)]==='pending_user_approval')_0xf5ac9e=_0x3e4586(0x110a)+(_0x38b1f5[_0x3e4586(0xcda)][_0x3e4586(0xcd9)]||_0x3e4586(0x4dc))+_0x3e4586(0x451);else{if(!_0x38b1f5[_0x3e4586(0x9d7)]&&_0x38b1f5[_0x3e4586(0xcda)]?.[_0x3e4586(0x93c)]===_0x3e4586(0x84b))_0xf5ac9e='<span\x20style=\x22color:\x20#dc3545;\x22>[你已被对方拉黑]</span>';else{if(_0x38b1f5[_0x3e4586(0x9d7)]){if(_0x3b151e['type']===_0x3e4586(0x81b))_0xf5ac9e='[系统消息]\x20'+_0x3b151e[_0x3e4586(0xac4)];else{if(_0x3b151e['type']==='transfer')_0xf5ac9e=_0x3e4586(0xb62);else{if(_0x3b151e[_0x3e4586(0x858)]===_0x3e4586(0x135a)||_0x3b151e['type']===_0x3e4586(0x5d5))_0xf5ac9e=_0x3e4586(0x633);else{if(_0x3b151e[_0x3e4586(0x858)]===_0x3e4586(0x9bf))_0xf5ac9e=_0x3e4586(0xdb0);else{if(typeof _0x3b151e[_0x3e4586(0xac4)]===_0x3e4586(0x8d9)&&_0x554a0b[_0x3e4586(0x101d)](_0x3b151e[_0x3e4586(0xac4)]))_0xf5ac9e=_0x3b151e[_0x3e4586(0x720)]?_0x3e4586(0xdbf)+_0x3b151e[_0x3e4586(0x720)]+']':_0x3e4586(0xa6d);else Array['isArray'](_0x3b151e[_0x3e4586(0xac4)])?_0xf5ac9e=_0x3e4586(0x11e6):_0xf5ac9e=String(_0x3b151e[_0x3e4586(0xac4)]||_0x3e4586(0x4d0))[_0x3e4586(0x1323)](0x0,0x14);}}}}if(_0x3b151e['senderName']&&_0x3b151e[_0x3e4586(0x858)]!==_0x3e4586(0x81b)){const _0x170c02=_0x503999(_0x38b1f5,_0x3b151e['senderName']);_0xf5ac9e=_0x170c02+':\x20'+_0xf5ac9e;}}else{const _0x1f79d9=_0x38b1f5[_0x3e4586(0x93c)]?.[_0x3e4586(0x56d)]||'在线';_0xf5ac9e='['+_0x1f79d9+']';}}}const _0x528275=document[_0x3e4586(0xbd5)](_0x3e4586(0x6c8));_0x528275[_0x3e4586(0xfd4)]=_0x3e4586(0x1270),_0x528275['dataset'][_0x3e4586(0xd4e)]=_0x38b1f5['id'];_0x38b1f5[_0x3e4586(0xe4a)]&&_0x528275[_0x3e4586(0x9cd)][_0x3e4586(0x807)](_0x3e4586(0x13cf));const _0x1c02c8=_0x38b1f5[_0x3e4586(0x9d7)]?_0x38b1f5['settings'][_0x3e4586(0x67c)]:_0x38b1f5['settings'][_0x3e4586(0x1039)],_0x4bf889=_0x38b1f5[_0x3e4586(0x9d7)]?'':_0x38b1f5[_0x3e4586(0x18a)][_0x3e4586(0x663)]||'';let _0x294b2d;_0x4bf889?_0x294b2d='<div\x20class=\x22avatar-with-frame\x22><img\x20src=\x22'+(_0x1c02c8||_0x28c106)+_0x3e4586(0x367)+_0x4bf889+'\x22\x20class=\x22avatar-frame\x22></div>':_0x294b2d=_0x3e4586(0xdba)+(_0x1c02c8||_0x28c106)+_0x3e4586(0x6e7);const _0x48e236=_0x4bf889?_0x3e4586(0x1126):'',_0x34ba51='<div\x20class=\x22avatar-group\x20'+_0x48e236+'\x22>'+_0x294b2d+_0x3e4586(0x2c3);_0x528275[_0x3e4586(0x3de)]=_0x3e4586(0x704)+_0x34ba51+_0x3e4586(0x1255)+_0x38b1f5[_0x3e4586(0x564)]+_0x3e4586(0xa03)+(_0x38b1f5[_0x3e4586(0x9d7)]?_0x3e4586(0xa5f):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22\x20style=\x22color:\x20'+(_0x38b1f5[_0x3e4586(0x9d7)]?_0x3e4586(0xb32):_0x3e4586(0xf77))+';\x20font-style:\x20italic;\x22>'+_0xf5ac9e+_0x3e4586(0x808);const _0x3db1a2=_0x38b1f5[_0x3e4586(0x1090)]||0x0,_0x5be24a=_0x528275[_0x3e4586(0x8bc)](_0x3e4586(0x1116));_0x3db1a2>0x0?(_0x5be24a['textContent']=_0x3db1a2>0x63?_0x3e4586(0x1002):_0x3db1a2,_0x5be24a['style'][_0x3e4586(0x678)]='inline-flex'):_0x5be24a['style'][_0x3e4586(0x678)]=_0x3e4586(0xff8);const _0x2a7b9e=_0x528275['querySelector'](_0x3e4586(0x577));_0x2a7b9e&&(_0x2a7b9e[_0x3e4586(0x10dd)][_0x3e4586(0xd8b)]=_0x3e4586(0x1366),_0x2a7b9e[_0x3e4586(0xa75)](_0x3e4586(0x9ab),_0x2c94b7=>{const _0x1dfad9=_0x3e4586;_0x2c94b7[_0x1dfad9(0x748)]();const _0x2f7578=_0x38b1f5['isGroup']?_0x38b1f5[_0x1dfad9(0x564)]:_0x38b1f5['originalName'];_0x5be2f7(_0x38b1f5['id'],_0x2f7578);}));const _0x2c966a=_0x528275['querySelector'](_0x3e4586(0x10b4));return _0x2c966a&&_0x2c966a[_0x3e4586(0xa75)](_0x3e4586(0xd2f),()=>_0x178862(_0x38b1f5['id'])),_0x33282f(_0x528275,async _0xed89bf=>{const _0x5c2832=_0x3e4586,_0x171338=await _0x3b8d64(_0x38b1f5);switch(_0x171338){case _0x5c2832(0xe88):_0x38b1f5[_0x5c2832(0xe4a)]=!_0x38b1f5[_0x5c2832(0xe4a)],await _0xb81d4e['chats'][_0x5c2832(0x5d0)](_0x38b1f5),_0x1b7f69();break;case'delete':const _0x3a5513=await _0x1a9e79('删除对话',_0x5c2832(0x9c8)+_0x38b1f5[_0x5c2832(0x564)]+'\x22\x20的整个对话吗？此操作不可撤销。',{'confirmButtonClass':'btn-danger'});if(_0x3a5513){_0x304e8d['isActive']&&_0x304e8d[_0x5c2832(0x233)]===_0x38b1f5['id']&&await _0x15b5ff(![]);delete _0x505390[_0x5c2832(0x1027)][_0x38b1f5['id']];if(_0x505390[_0x5c2832(0x233)]===_0x38b1f5['id'])_0x505390[_0x5c2832(0x233)]=null;await _0xb81d4e['chats'][_0x5c2832(0x1ea)](_0x38b1f5['id']),_0x1b7f69();}break;default:break;}}),_0x528275;}catch(_0x502668){return console[_0x3e4586(0xe3b)](_0x3e4586(0xbdd)+(_0x38b1f5['name']||'未知')+']\x20(ID:\x20'+_0x38b1f5['id']+_0x3e4586(0xa4a),_0x502668),null;}}async function _0x474d6b(_0x471182){const _0x19bdcf=_0x85c4bf;_0x22bc83(),_0x599cb2();const _0x8e9d0f=_0x505390[_0x19bdcf(0x1027)][_0x471182];if(!_0x8e9d0f)return;_0x24d789();const _0x43469d=document[_0x19bdcf(0x479)](_0x19bdcf(0x659)),_0x4b5e65=document[_0x19bdcf(0x479)]('chat-input-area'),_0x2a2887=document[_0x19bdcf(0x479)](_0x19bdcf(0x11ca)),_0x331e54=document[_0x19bdcf(0x479)]('chat-lock-content');_0x43469d[_0x19bdcf(0x13d4)][_0x19bdcf(0x1057)]=_0x8e9d0f[_0x19bdcf(0x18a)]['theme']||'default';const _0x477b34=_0x8e9d0f[_0x19bdcf(0x18a)]['fontSize']||0xd;_0x43469d[_0x19bdcf(0x10dd)][_0x19bdcf(0xc76)]('--chat-font-size',_0x477b34+'px'),_0x4156f1(_0x8e9d0f[_0x19bdcf(0x18a)][_0x19bdcf(0x1290)]||'',_0x19bdcf(0x47d),_0x19bdcf(0xa86)),document[_0x19bdcf(0x479)]('chat-header-title')[_0x19bdcf(0x97b)]=_0x8e9d0f['name'];const _0x282f2d=document['getElementById'](_0x19bdcf(0x39e)),_0x5e677b=_0x282f2d[_0x19bdcf(0x8bc)](_0x19bdcf(0x342));_0x8e9d0f['isGroup']?(_0x282f2d[_0x19bdcf(0x10dd)]['display']=_0x19bdcf(0xff8),document[_0x19bdcf(0x479)](_0x19bdcf(0x1fb))[_0x19bdcf(0x10dd)]['justifyContent']=_0x19bdcf(0x1e5)):(_0x282f2d[_0x19bdcf(0x10dd)][_0x19bdcf(0x678)]='flex',document[_0x19bdcf(0x479)](_0x19bdcf(0x1fb))[_0x19bdcf(0x10dd)]['justifyContent']='flex-start',_0x5e677b['textContent']=_0x8e9d0f['status']?.[_0x19bdcf(0x56d)]||'在线',_0x282f2d[_0x19bdcf(0x9cd)][_0x19bdcf(0x2bf)](_0x19bdcf(0xec2),_0x8e9d0f[_0x19bdcf(0x93c)]?.[_0x19bdcf(0xfc8)]||![]));const _0x260ed9=document[_0x19bdcf(0x479)]('chat-interface-screen'),_0x3256ba=_0x8e9d0f[_0x19bdcf(0x18a)][_0x19bdcf(0x7fb)],_0x1c7b23=_0x505390[_0x19bdcf(0x888)][_0x19bdcf(0x960)],_0x7147af=document[_0x19bdcf(0x479)](_0x19bdcf(0x2e2))[_0x19bdcf(0x9cd)][_0x19bdcf(0x658)](_0x19bdcf(0x9dd)),_0x123758=_0x7147af?_0x19bdcf(0xb38):'#f0f2f5';if(_0x3256ba)_0x260ed9[_0x19bdcf(0x10dd)][_0x19bdcf(0x13b9)]=_0x19bdcf(0x10d2)+_0x3256ba+')',_0x260ed9['style'][_0x19bdcf(0x11a6)]='transparent';else _0x1c7b23?(_0x260ed9[_0x19bdcf(0x10dd)][_0x19bdcf(0x13b9)]=_0x19bdcf(0x10d2)+_0x1c7b23+')',_0x260ed9[_0x19bdcf(0x10dd)]['backgroundColor']='transparent'):(_0x260ed9[_0x19bdcf(0x10dd)][_0x19bdcf(0x13b9)]=_0x19bdcf(0xff8),_0x260ed9['style'][_0x19bdcf(0x11a6)]=_0x123758);if(_0x8e9d0f['isSpectatorGroup'])_0x4b5e65[_0x19bdcf(0x10dd)]['display']=_0x19bdcf(0xff8),_0x2a2887['style'][_0x19bdcf(0x678)]=_0x19bdcf(0x899),_0x331e54[_0x19bdcf(0x3de)]=_0x19bdcf(0x84a),document[_0x19bdcf(0x479)]('spectator-propel-btn')['onclick']=_0x1b1d53;else{_0x4b5e65['style']['display']='flex',_0x2a2887[_0x19bdcf(0x10dd)][_0x19bdcf(0x678)]=_0x19bdcf(0xff8),_0x331e54['innerHTML']='';if(!_0x8e9d0f[_0x19bdcf(0x9d7)]&&_0x8e9d0f['relationship'][_0x19bdcf(0x93c)]!=='friend'){_0x2a2887[_0x19bdcf(0x10dd)][_0x19bdcf(0x678)]=_0x19bdcf(0x899),_0x4b5e65[_0x19bdcf(0x10dd)][_0x19bdcf(0x88f)]=_0x19bdcf(0x6d8);let _0x2f6246='';switch(_0x8e9d0f[_0x19bdcf(0xcda)][_0x19bdcf(0x93c)]){case _0x19bdcf(0x89f):const _0x4c1f05=_0x2f1d11!==null,_0x34327f=_0x8e9d0f['relationship'][_0x19bdcf(0x122a)],_0x4573e8=_0x505390[_0x19bdcf(0x888)][_0x19bdcf(0x10b3)]||0x1,_0x16e155=_0x4573e8*0x3c*0x3c*0x3e8,_0x44e1bf=Date['now']()-_0x34327f,_0x68c2b6=_0x44e1bf>_0x16e155,_0x13b8b1=Math['max'](0x0,Math[_0x19bdcf(0x62d)]((_0x16e155-_0x44e1bf)/(0x3e8*0x3c)));_0x2f6246=_0x19bdcf(0x1e1)+_0x8e9d0f[_0x19bdcf(0x564)]+'”拉黑。</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22unblock-btn\x22\x20class=\x22lock-action-btn\x22>解除拉黑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-top:\x2020px;\x20padding:\x2010px;\x20border:\x201px\x20dashed\x20#ccc;\x20border-radius:\x208px;\x20font-size:\x2011px;\x20text-align:\x20left;\x20color:\x20#666;\x20background:\x20rgba(0,0,0,0.02);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20style=\x22color:\x20#333;\x22>【开发者诊断面板】</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20后台活动总开关:\x20'+(_0x505390[_0x19bdcf(0x888)][_0x19bdcf(0xc00)]?_0x19bdcf(0xb1b):_0x19bdcf(0x10a8))+_0x19bdcf(0xc2c)+(_0x4c1f05?_0x19bdcf(0x289):_0x19bdcf(0x8b1))+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20当前角色状态:\x20<strong>'+_0x8e9d0f[_0x19bdcf(0xcda)]['status']+_0x19bdcf(0x618)+_0x4573e8+_0x19bdcf(0x11d6)+(_0x68c2b6?_0x19bdcf(0x13e9):_0x19bdcf(0x78c)+_0x13b8b1+_0x19bdcf(0x1367))+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20触发条件:\x20'+(_0x68c2b6&&_0x505390[_0x19bdcf(0x888)][_0x19bdcf(0xc00)]?_0x19bdcf(0x3a7):'<span\x20style=\x22color:\x20red;\x22>未满足</span>')+_0x19bdcf(0xec9);break;case _0x19bdcf(0x84b):_0x2f6246='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>你被对方拉黑了。</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22apply-friend-btn\x22\x20class=\x22lock-action-btn\x22>重新申请加为好友</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';break;case _0x19bdcf(0x11be):_0x2f6246=_0x19bdcf(0xcbf)+_0x8e9d0f['name']+_0x19bdcf(0x5d6)+_0x8e9d0f[_0x19bdcf(0xcda)]['applicationReason']+_0x19bdcf(0x10d1);break;case _0x19bdcf(0xb79):_0x2f6246=_0x19bdcf(0x13e4);break;}_0x331e54[_0x19bdcf(0x3de)]=_0x2f6246;}else _0x2a2887[_0x19bdcf(0x10dd)]['display']=_0x19bdcf(0xff8),_0x4b5e65[_0x19bdcf(0x10dd)]['visibility']=_0x19bdcf(0x45a);}_0x43469d['innerHTML']='';const _0xf156f4=_0x8e9d0f[_0x19bdcf(0x7d3)];_0x1e729c=0x0;const _0x53a8d9=_0x505390[_0x19bdcf(0x888)][_0x19bdcf(0x13f8)]||0x32,_0x4dc762=_0xf156f4['slice'](-_0x53a8d9),_0xf8e256=[];let _0x548dd1=0x0;for(const _0x268259 of _0x4dc762){_0x548dd1>0x0&&_0x268259[_0x19bdcf(0x12a2)]-_0x548dd1>0x927c0&&_0xf8e256[_0x19bdcf(0x1a0)](Promise['resolve'](_0x3a0a18(_0x268259[_0x19bdcf(0x12a2)]))),_0xf8e256[_0x19bdcf(0x1a0)](_0x43c884(_0x268259,_0x8e9d0f,!![])),_0x548dd1=_0x268259['timestamp'];}const _0x47aead=await Promise[_0x19bdcf(0xf78)](_0xf8e256),_0xad8203=document[_0x19bdcf(0x3dd)]();_0x47aead[_0x19bdcf(0x85d)](Boolean)[_0x19bdcf(0x12be)](_0x20c709=>_0xad8203[_0x19bdcf(0x9f4)](_0x20c709)),_0x43469d['appendChild'](_0xad8203),_0x1e729c=_0x4dc762['length'];const _0x7b68b4=document[_0x19bdcf(0xbd5)]('div');_0x7b68b4['id']='typing-indicator',_0x7b68b4['style'][_0x19bdcf(0x678)]=_0x19bdcf(0xff8),_0x7b68b4[_0x19bdcf(0x97b)]=_0x19bdcf(0x12ad),_0x43469d['appendChild'](_0x7b68b4),setTimeout(()=>_0x43469d[_0x19bdcf(0x2b3)]=_0x43469d['scrollHeight'],0x0);}async function _0x299b9f(){const _0x92804c=_0x85c4bf;if(_0x5c1afa)return;_0x5c1afa=!![];const _0x25399e=document[_0x92804c(0x479)](_0x92804c(0x659)),_0x7fb6ac=_0x505390[_0x92804c(0x1027)][_0x505390[_0x92804c(0x233)]];if(!_0x7fb6ac){_0x5c1afa=![];return;}_0x13e918(_0x25399e,_0x92804c(0xb8f));const _0x44a129=_0x25399e['scrollHeight'];await new Promise(_0x45fff4=>setTimeout(_0x45fff4,0x1f4));const _0x12d8a8=_0x7fb6ac[_0x92804c(0x7d3)][_0x92804c(0x990)],_0x59d43c=_0x505390[_0x92804c(0x888)][_0x92804c(0x13f8)]||0x32,_0x31e742=_0x12d8a8-_0x1e729c-_0x59d43c,_0x35e3cc=_0x12d8a8-_0x1e729c,_0x1f392b=_0x7fb6ac[_0x92804c(0x7d3)][_0x92804c(0x777)](Math[_0x92804c(0x6b8)](0x0,_0x31e742),_0x35e3cc),_0x59a480=_0x25399e[_0x92804c(0x8bc)](_0x92804c(0xf36));let _0x37b496=_0x59a480?parseInt(_0x59a480[_0x92804c(0x13d4)][_0x92804c(0x12a2)]):0x0;for(const _0x2a7201 of _0x1f392b[_0x92804c(0x336)]()){if(_0x37b496>0x0&&_0x37b496-_0x2a7201['timestamp']>0x927c0){const _0x2c5cff=_0x3a0a18(_0x37b496);_0x25399e[_0x92804c(0xaa6)](_0x2c5cff);}await _0x46f5e0(_0x2a7201,_0x7fb6ac),_0x37b496=_0x2a7201[_0x92804c(0x12a2)];}_0x1e729c+=_0x1f392b[_0x92804c(0x990)];const _0x1385c7=_0x25399e[_0x92804c(0x9c5)];_0x25399e[_0x92804c(0x2b3)]=_0x1385c7-_0x44a129,_0x168e5c(_0x25399e),_0x5c1afa=![];}function _0x2884ff(){const _0x480b32=_0x85c4bf;_0x5c85ec(),_0x6d1778();const _0xe17e99=document['getElementById'](_0x480b32(0xb3a)),_0x11b028=_0x505390[_0x480b32(0x888)][_0x480b32(0x73f)];_0x11b028?(_0xe17e99[_0x480b32(0x10dd)]['backgroundImage']=_0x480b32(0x10d2)+_0x11b028+')',_0xe17e99[_0x480b32(0x97b)]=''):(_0xe17e99[_0x480b32(0x10dd)]['backgroundImage']=_0x480b32(0x4d3),_0xe17e99['textContent']=_0x480b32(0xb2d));const _0xd0e74d=document[_0x480b32(0x479)](_0x480b32(0x1093)),_0x489934=_0x505390[_0x480b32(0x888)]['cphoneWallpaper'];_0x489934?(_0xd0e74d[_0x480b32(0x10dd)]['backgroundImage']='url('+_0x489934+')',_0xd0e74d[_0x480b32(0x97b)]=''):(_0xd0e74d['style'][_0x480b32(0x13b9)]='linear-gradient(135deg,\x20#f6d365,\x20#fda085)',_0xd0e74d['textContent']=_0x480b32(0xb2d));const _0x2a1dce=document['getElementById']('global-bg-preview'),_0x21be3e=_0x505390['globalSettings'][_0x480b32(0x960)];_0x21be3e?(_0x2a1dce[_0x480b32(0x10dd)]['backgroundImage']=_0x480b32(0x10d2)+_0x21be3e+')',_0x2a1dce[_0x480b32(0x97b)]='',document['getElementById'](_0x480b32(0x82d))[_0x480b32(0x10dd)]['display']='inline-block'):(_0x2a1dce[_0x480b32(0x10dd)][_0x480b32(0x13b9)]='none',_0x2a1dce[_0x480b32(0x97b)]='点击下方上传',document[_0x480b32(0x479)]('remove-global-bg-btn')['style']['display']=_0x480b32(0xff8)),_0x2210a4(),_0x4679ec(),document[_0x480b32(0x479)](_0x480b32(0x901))[_0x480b32(0x4e0)]=_0x505390['globalSettings'][_0x480b32(0x215)]||'',document[_0x480b32(0x479)](_0x480b32(0x4cc))[_0x480b32(0x4e0)]=_0x505390['globalSettings']['notificationSoundUrl']||'',document[_0x480b32(0x479)](_0x480b32(0xaad))[_0x480b32(0xf7b)]=_0x505390['globalSettings'][_0x480b32(0x5d9)]||![],_0x21b744(),_0x4af4f0();}window['renderWallpaperScreenProxy']=_0x2884ff;function _0x49ef38(){const _0x278a07=_0x85c4bf,_0x2da55c=document[_0x278a07(0x479)](_0x278a07(0x45f)),_0x1442ef=_0x505390[_0x278a07(0x888)][_0x278a07(0x73f)];_0x1442ef?_0x2da55c[_0x278a07(0x10dd)][_0x278a07(0x13b9)]='url('+_0x1442ef+')':_0x2da55c[_0x278a07(0x10dd)]['backgroundImage']='linear-gradient(135deg,\x20#89f7fe,\x20#66a6ff)';}function _0x1b882a(_0x364902){const _0x26d803=_0x85c4bf;document[_0x26d803(0x99e)](_0x26d803(0x504))['forEach'](_0x3c55f9=>{const _0x1d7fc0=_0x26d803;_0x3c55f9[_0x1d7fc0(0x9cd)]['toggle']('active',_0x3c55f9[_0x1d7fc0(0x13d4)]['categoryId']===_0x364902);}),document[_0x26d803(0x99e)](_0x26d803(0x478))[_0x26d803(0x12be)](_0x5cdbce=>{const _0x487081=_0x26d803;_0x5cdbce[_0x487081(0x9cd)]['toggle'](_0x487081(0x5a9),_0x5cdbce['dataset'][_0x487081(0x470)]===_0x364902);});}async function _0x30b101(){const _0x1f824a=_0x85c4bf,_0x31d70f=document[_0x1f824a(0x479)]('world-book-tabs'),_0x10bdb8=document[_0x1f824a(0x479)](_0x1f824a(0xeda));_0x31d70f[_0x1f824a(0x3de)]='',_0x10bdb8[_0x1f824a(0x3de)]='';const [_0x6908ff,_0xf1d029]=await Promise[_0x1f824a(0xf78)]([_0xb81d4e[_0x1f824a(0xd1b)][_0x1f824a(0x4ba)](),_0xb81d4e[_0x1f824a(0xfe9)][_0x1f824a(0x3d2)](_0x1f824a(0x564))[_0x1f824a(0x4ba)]()]);_0x505390[_0x1f824a(0xd1b)]=_0x6908ff;if(_0x6908ff['length']===0x0){_0x10bdb8[_0x1f824a(0x3de)]=_0x1f824a(0x357);return;}const _0x1f9f72=document[_0x1f824a(0xbd5)]('button');_0x1f9f72[_0x1f824a(0xfd4)]=_0x1f824a(0xc21),_0x1f9f72[_0x1f824a(0x97b)]='全部',_0x1f9f72[_0x1f824a(0x13d4)][_0x1f824a(0x470)]=_0x1f824a(0xf78),_0x31d70f[_0x1f824a(0x9f4)](_0x1f9f72);const _0x46e2ba=document[_0x1f824a(0xbd5)]('div');_0x46e2ba['className']=_0x1f824a(0x13d0),_0x46e2ba['dataset'][_0x1f824a(0x470)]=_0x1f824a(0xf78),_0x10bdb8[_0x1f824a(0x9f4)](_0x46e2ba),_0xf1d029[_0x1f824a(0x12be)](_0x314760=>{const _0x170118=_0x1f824a,_0xf6522a=document[_0x170118(0xbd5)](_0x170118(0x7b6));_0xf6522a[_0x170118(0xfd4)]=_0x170118(0x12ea),_0xf6522a[_0x170118(0x97b)]=_0x314760[_0x170118(0x564)],_0xf6522a['dataset'][_0x170118(0x470)]=String(_0x314760['id']),_0x31d70f[_0x170118(0x9f4)](_0xf6522a);const _0x1f4d74=document['createElement'](_0x170118(0x6c8));_0x1f4d74[_0x170118(0xfd4)]='world-book-category-pane',_0x1f4d74[_0x170118(0x13d4)][_0x170118(0x470)]=String(_0x314760['id']),_0x10bdb8[_0x170118(0x9f4)](_0x1f4d74);});const _0x283142=_0x6908ff[_0x1f824a(0x1235)](_0x59500e=>!_0x59500e[_0x1f824a(0x470)]);if(_0x283142){const _0x31a465=document['createElement']('button');_0x31a465[_0x1f824a(0xfd4)]=_0x1f824a(0x12ea),_0x31a465[_0x1f824a(0x97b)]='未分类',_0x31a465['dataset'][_0x1f824a(0x470)]=_0x1f824a(0x331),_0x31d70f['appendChild'](_0x31a465);const _0x40c627=document[_0x1f824a(0xbd5)](_0x1f824a(0x6c8));_0x40c627[_0x1f824a(0xfd4)]='world-book-category-pane',_0x40c627[_0x1f824a(0x13d4)][_0x1f824a(0x470)]=_0x1f824a(0x331),_0x10bdb8[_0x1f824a(0x9f4)](_0x40c627);}_0x6908ff['forEach'](_0x3258d2=>{const _0x30b97e=_0x1f824a;let _0x3bb1a7='暂无内容...';if(Array[_0x30b97e(0x285)](_0x3258d2[_0x30b97e(0xac4)])&&_0x3258d2[_0x30b97e(0xac4)][_0x30b97e(0x990)]>0x0){const _0x152a29=_0x3258d2[_0x30b97e(0xac4)][0x0];_0x3bb1a7=_0x152a29[_0x30b97e(0xd6c)]||_0x152a29[_0x30b97e(0xac4)]||'';}else typeof _0x3258d2[_0x30b97e(0xac4)]==='string'&&_0x3258d2[_0x30b97e(0xac4)][_0x30b97e(0x9c1)]()!==''&&(_0x3bb1a7=_0x3258d2[_0x30b97e(0xac4)]);const _0x34311e=document[_0x30b97e(0xbd5)]('div');_0x34311e[_0x30b97e(0xfd4)]=_0x30b97e(0x552),_0x34311e[_0x30b97e(0x3de)]=_0x30b97e(0xa0e)+_0x3258d2[_0x30b97e(0x564)]+_0x30b97e(0x4eb)+_0x3bb1a7+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';const _0x45892f=()=>_0x2e203c(_0x3258d2['id']),_0x1a27e6=async()=>{const _0xb21eef=_0x30b97e,_0x48b182=await _0x1a9e79(_0xb21eef(0xfa5),'确定要删除《'+_0x3258d2[_0xb21eef(0x564)]+'》吗？',{'confirmButtonClass':_0xb21eef(0x95a)});_0x48b182&&(await _0xb81d4e[_0xb21eef(0xd1b)][_0xb21eef(0x1ea)](_0x3258d2['id']),_0x505390[_0xb21eef(0xd1b)]=_0x505390[_0xb21eef(0xd1b)][_0xb21eef(0x85d)](_0x2b50e7=>_0x2b50e7['id']!==_0x3258d2['id']),_0x30b101());};_0x34311e[_0x30b97e(0xa75)](_0x30b97e(0xd2f),_0x45892f),_0x33282f(_0x34311e,_0x1a27e6);const _0x32f183=_0x34311e[_0x30b97e(0xbcf)](!![]);_0x32f183[_0x30b97e(0xa75)](_0x30b97e(0xd2f),_0x45892f),_0x33282f(_0x32f183,_0x1a27e6),_0x46e2ba[_0x30b97e(0x9f4)](_0x32f183);const _0x442ace=_0x3258d2[_0x30b97e(0x470)]?String(_0x3258d2[_0x30b97e(0x470)]):_0x30b97e(0x331),_0x2ea795=_0x10bdb8[_0x30b97e(0x8bc)](_0x30b97e(0x49e)+_0x442ace+'\x22]');_0x2ea795&&_0x2ea795['appendChild'](_0x34311e);}),document['querySelectorAll']('.world-book-tab')[_0x1f824a(0x12be)](_0x31b5a8=>{const _0x3f4a12=_0x1f824a;_0x31b5a8['addEventListener'](_0x3f4a12(0xd2f),()=>_0x1b882a(_0x31b5a8[_0x3f4a12(0x13d4)][_0x3f4a12(0x470)]));});}function _0x2bd268(_0x269a21,_0x44ff19){const _0x4c7080=_0x85c4bf,_0x24b577=document[_0x4c7080(0xbd5)]('div');_0x24b577[_0x4c7080(0xfd4)]=_0x4c7080(0xfeb),_0x24b577[_0x4c7080(0x3de)]=_0x4c7080(0x7fe)+_0x269a21+_0x4c7080(0x1249);const _0x2ea4c8=_0x24b577['querySelector'](_0x4c7080(0x11b0));return _0x44ff19['sort']((_0x545736,_0x227e56)=>_0x545736[_0x4c7080(0x564)]['localeCompare'](_0x227e56[_0x4c7080(0x564)],'zh-CN')),_0x44ff19['forEach'](_0x189832=>{const _0x596821=_0x4c7080;let _0x4d346b=_0x596821(0x6ac);if(Array[_0x596821(0x285)](_0x189832[_0x596821(0xac4)])&&_0x189832[_0x596821(0xac4)]['length']>0x0){const _0x14594d=_0x189832['content'][0x0];_0x4d346b=_0x14594d['comment']||_0x14594d[_0x596821(0xac4)]||'';}else typeof _0x189832[_0x596821(0xac4)]==='string'&&_0x189832[_0x596821(0xac4)][_0x596821(0x9c1)]()!==''&&(_0x4d346b=_0x189832[_0x596821(0xac4)]);const _0x3cb9ea=document['createElement'](_0x596821(0x6c8));_0x3cb9ea[_0x596821(0xfd4)]='list-item',_0x3cb9ea[_0x596821(0x13d4)][_0x596821(0x1124)]=_0x189832['id'],_0x3cb9ea[_0x596821(0x3de)]=_0x596821(0x1214)+_0x189832[_0x596821(0x564)]+_0x596821(0x73e)+String(_0x4d346b)[_0x596821(0x1323)](0x0,0x32)+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x3cb9ea[_0x596821(0xa75)](_0x596821(0xd2f),()=>_0x2e203c(_0x189832['id'])),_0x33282f(_0x3cb9ea,async()=>{const _0x2ac0e8=_0x596821,_0x2972b6=await _0x1a9e79('删除世界书','确定要删除《'+_0x189832[_0x2ac0e8(0x564)]+'》吗？此操作不可撤销。',{'confirmButtonClass':_0x2ac0e8(0x95a)});_0x2972b6&&(await _0xb81d4e[_0x2ac0e8(0xd1b)][_0x2ac0e8(0x1ea)](_0x189832['id']),_0x505390[_0x2ac0e8(0xd1b)]=_0x505390[_0x2ac0e8(0xd1b)]['filter'](_0x4620ad=>_0x4620ad['id']!==_0x189832['id']),_0x30b101());}),_0x2ea4c8[_0x596821(0x9f4)](_0x3cb9ea);}),_0x24b577;}window[_0x85c4bf(0x11a2)]=_0x30b101;async function _0x2e203c(_0x551f64){const _0x2dc0bc=_0x85c4bf;_0x731d5(_0x2dc0bc(0xa40)),_0x1c457a=_0x551f64;const [_0x4be56a,_0x5e147d]=await Promise[_0x2dc0bc(0xf78)]([_0xb81d4e[_0x2dc0bc(0xd1b)][_0x2dc0bc(0x111a)](_0x551f64),_0xb81d4e[_0x2dc0bc(0xfe9)][_0x2dc0bc(0x4ba)]()]);if(!_0x4be56a){console[_0x2dc0bc(0xe3b)](_0x2dc0bc(0x1215),_0x551f64),_0x731d5(_0x2dc0bc(0x4f6));return;}document[_0x2dc0bc(0x479)](_0x2dc0bc(0xa3a))[_0x2dc0bc(0x97b)]=_0x4be56a[_0x2dc0bc(0x564)],document['getElementById'](_0x2dc0bc(0x872))[_0x2dc0bc(0x4e0)]=_0x4be56a[_0x2dc0bc(0x564)];const _0x5bf073=document[_0x2dc0bc(0x479)](_0x2dc0bc(0x138c));_0x5bf073[_0x2dc0bc(0x3de)]=_0x2dc0bc(0x278),_0x5e147d[_0x2dc0bc(0x12be)](_0x4fe430=>{const _0x57b42d=_0x2dc0bc,_0x344a06=document[_0x57b42d(0xbd5)](_0x57b42d(0x9a2));_0x344a06['value']=_0x4fe430['id'],_0x344a06['textContent']=_0x4fe430[_0x57b42d(0x564)];if(_0x4be56a['categoryId']===_0x4fe430['id'])_0x344a06[_0x57b42d(0x10dc)]=!![];_0x5bf073[_0x57b42d(0x9f4)](_0x344a06);});const _0x56fe26=document[_0x2dc0bc(0x479)](_0x2dc0bc(0xe40));_0x56fe26[_0x2dc0bc(0x3de)]='',Array[_0x2dc0bc(0x285)](_0x4be56a[_0x2dc0bc(0xac4)])&&_0x4be56a[_0x2dc0bc(0xac4)][_0x2dc0bc(0x990)]>0x0?_0x4be56a[_0x2dc0bc(0xac4)][_0x2dc0bc(0x12be)](_0x597176=>{const _0x5162ac=_0x2dc0bc,_0x2c6d41=_0x5951c9(_0x597176);_0x56fe26[_0x5162ac(0x9f4)](_0x2c6d41);}):_0x56fe26['innerHTML']=_0x2dc0bc(0x121f);}async function _0x46e430(_0x32aa0c=!![]){const _0x2afdf5=_0x85c4bf,_0x295f2a=document[_0x2afdf5(0x479)](_0x2afdf5(0x224)),_0x2ba0d4=document[_0x2afdf5(0x479)](_0x2afdf5(0x1101)),_0x40d1bf=document[_0x2afdf5(0x479)](_0x2afdf5(0x987)),_0x4c6f17=_0x40d1bf[_0x2afdf5(0x4e0)][_0x2afdf5(0x9c1)]()[_0x2afdf5(0x1f8)]();if(_0x32aa0c){_0x2ba0d4['innerHTML']='';const _0x21ff09=await _0xb81d4e['stickerCategories']['toArray']();_0x2ba0d4['innerHTML']+=_0x2afdf5(0x77a)+(_0x2a104d===_0x2afdf5(0xf78)?_0x2afdf5(0x5a9):'')+'\x22\x20data-category-id=\x22all\x22>全部</button>',_0x21ff09[_0x2afdf5(0x12be)](_0x3cc503=>{const _0x2a4ec7=_0x2afdf5;_0x2ba0d4[_0x2a4ec7(0x3de)]+=_0x2a4ec7(0x77a)+(_0x2a104d===_0x3cc503['id']?_0x2a4ec7(0x5a9):'')+'\x22\x20data-category-id=\x22'+_0x3cc503['id']+'\x22>'+_0x3cc503['name']+'</button>';}),_0x2ba0d4[_0x2afdf5(0x3de)]+='<button\x20class=\x22sticker-category-tab\x20'+(_0x2a104d===_0x2afdf5(0x331)?_0x2afdf5(0x5a9):'')+_0x2afdf5(0x796);}_0x295f2a[_0x2afdf5(0x3de)]='';let _0x5a0fb9;if(_0x2a104d===_0x2afdf5(0xf78))_0x5a0fb9=_0x505390[_0x2afdf5(0x407)];else _0x2a104d===_0x2afdf5(0x331)?_0x5a0fb9=_0x505390[_0x2afdf5(0x407)][_0x2afdf5(0x85d)](_0x43a534=>!_0x43a534[_0x2afdf5(0x470)]):_0x5a0fb9=_0x505390[_0x2afdf5(0x407)][_0x2afdf5(0x85d)](_0x23ae24=>_0x23ae24[_0x2afdf5(0x470)]===_0x2a104d);const _0x19d9cc=_0x4c6f17?_0x5a0fb9[_0x2afdf5(0x85d)](_0x3657f8=>_0x3657f8['name']['toLowerCase']()[_0x2afdf5(0x44f)](_0x4c6f17)):_0x5a0fb9;if(_0x19d9cc[_0x2afdf5(0x990)]===0x0){const _0x147b10=_0x4c6f17?'找不到匹配的表情':'这个分类下还没有表情哦~';_0x295f2a[_0x2afdf5(0x3de)]=_0x2afdf5(0x433)+_0x147b10+_0x2afdf5(0x1049);return;}_0x19d9cc['forEach'](_0x1a56e8=>{const _0x11bc3b=_0x2afdf5,_0x432763=document['createElement'](_0x11bc3b(0x6c8));_0x432763[_0x11bc3b(0xfd4)]='sticker-item',_0x432763[_0x11bc3b(0xc29)]=_0x1a56e8[_0x11bc3b(0x564)],_0x432763[_0x11bc3b(0x13d4)][_0x11bc3b(0x815)]=_0x1a56e8['id'],_0x432763['innerHTML']=_0x11bc3b(0x29f)+_0x1a56e8[_0x11bc3b(0x5f3)]+_0x11bc3b(0x12a1)+_0x1a56e8[_0x11bc3b(0x564)]+_0x11bc3b(0xa8b),_0x432763[_0x11bc3b(0xa75)](_0x11bc3b(0xd2f),()=>{_0x38d2a9?_0x1c24c6(_0x432763):_0x2fb2cc(_0x1a56e8);});const _0x406f4b=document[_0x11bc3b(0xbd5)](_0x11bc3b(0x6c8));_0x406f4b[_0x11bc3b(0xfd4)]='delete-btn',_0x406f4b[_0x11bc3b(0x3de)]=_0x11bc3b(0x120f),_0x406f4b[_0x11bc3b(0x1063)]=async _0xd0d3f3=>{const _0xf74f9c=_0x11bc3b;_0xd0d3f3['stopPropagation']();const _0x11422e=await _0x1a9e79(_0xf74f9c(0x2b5),_0xf74f9c(0x2d6)+_0x1a56e8[_0xf74f9c(0x564)]+_0xf74f9c(0xb7f),{'confirmButtonClass':_0xf74f9c(0x95a)});_0x11422e&&(await _0xb81d4e['userStickers'][_0xf74f9c(0x1ea)](_0x1a56e8['id']),_0x505390[_0xf74f9c(0x407)]=_0x505390[_0xf74f9c(0x407)][_0xf74f9c(0x85d)](_0x1c0600=>_0x1c0600['id']!==_0x1a56e8['id']),_0x46e430());},_0x432763[_0x11bc3b(0x9f4)](_0x406f4b),_0x295f2a[_0x11bc3b(0x9f4)](_0x432763);});}let _0x38d2a9=![],_0xd0e3a8=new Set();function _0x101bec(){const _0x4857bd=_0x85c4bf;_0x38d2a9=!_0x38d2a9;const _0x357da1=document['getElementById'](_0x4857bd(0x224)),_0x4706e6=document[_0x4857bd(0x479)](_0x4857bd(0xd17)),_0x2afeb3=document[_0x4857bd(0x479)]('sticker-action-bar'),_0x30fa1d=document[_0x4857bd(0x479)]('select-all-stickers-checkbox');_0x357da1[_0x4857bd(0x9cd)][_0x4857bd(0x2bf)](_0x4857bd(0x2ae),_0x38d2a9),_0x38d2a9?(_0x4706e6[_0x4857bd(0x97b)]='完成',_0x2afeb3[_0x4857bd(0x10dd)][_0x4857bd(0x678)]=_0x4857bd(0x899),_0xd0e3a8['clear'](),_0x30fa1d[_0x4857bd(0xf7b)]=![],_0x25bb80()):(_0x4706e6[_0x4857bd(0x97b)]='管理',_0x2afeb3[_0x4857bd(0x10dd)][_0x4857bd(0x678)]=_0x4857bd(0xff8),_0x357da1[_0x4857bd(0x99e)](_0x4857bd(0x1fa))['forEach'](_0xf3bc3b=>_0xf3bc3b[_0x4857bd(0x9cd)][_0x4857bd(0x8b6)](_0x4857bd(0x10dc))));}function _0x268871(){const _0x284b85=_0x85c4bf,_0x4f767d=document[_0x284b85(0x479)]('select-all-stickers-checkbox'),_0x4be00a=_0x4f767d[_0x284b85(0xf7b)];let _0x50ff24;if(_0x2a104d==='all')_0x50ff24=_0x505390[_0x284b85(0x407)];else _0x2a104d===_0x284b85(0x331)?_0x50ff24=_0x505390[_0x284b85(0x407)][_0x284b85(0x85d)](_0x71da32=>!_0x71da32[_0x284b85(0x470)]):_0x50ff24=_0x505390[_0x284b85(0x407)][_0x284b85(0x85d)](_0x4044a2=>_0x4044a2[_0x284b85(0x470)]===_0x2a104d);_0x50ff24[_0x284b85(0x12be)](_0x12d1fe=>{const _0x3430b6=_0x284b85,_0x149c19=_0x12d1fe['id'],_0x3da5ac=document[_0x3430b6(0x8bc)](_0x3430b6(0x563)+_0x149c19+'\x22]');if(_0x4be00a){_0xd0e3a8['add'](_0x149c19);if(_0x3da5ac)_0x3da5ac[_0x3430b6(0x9cd)][_0x3430b6(0x807)](_0x3430b6(0x10dc));}else{_0xd0e3a8['delete'](_0x149c19);if(_0x3da5ac)_0x3da5ac[_0x3430b6(0x9cd)][_0x3430b6(0x8b6)](_0x3430b6(0x10dc));}}),_0x25bb80();}function _0x25bb80(){const _0x2ba87b=_0x85c4bf,_0x9a8a9f=document[_0x2ba87b(0x479)]('delete-selected-stickers-btn');_0x9a8a9f[_0x2ba87b(0x97b)]='删除\x20('+_0xd0e3a8[_0x2ba87b(0xa7a)]+')';}function _0x1c24c6(_0x53c921){const _0x5c1082=_0x85c4bf;if(!_0x38d2a9)return;const _0x620e0c=_0x53c921[_0x5c1082(0x13d4)][_0x5c1082(0x815)];if(!_0x620e0c)return;_0x53c921['classList'][_0x5c1082(0x2bf)](_0x5c1082(0x10dc)),_0xd0e3a8['has'](_0x620e0c)?_0xd0e3a8[_0x5c1082(0x1ea)](_0x620e0c):_0xd0e3a8[_0x5c1082(0x807)](_0x620e0c),_0x25bb80();}async function _0x48f307(){const _0x20d322=_0x85c4bf;if(_0xd0e3a8[_0x20d322(0xa7a)]===0x0)return;const _0x1e8c51=await _0x1a9e79('确认删除',_0x20d322(0x12f6)+_0xd0e3a8[_0x20d322(0xa7a)]+_0x20d322(0x1350),{'confirmButtonClass':_0x20d322(0x95a)});if(_0x1e8c51){const _0x2e11b1=[..._0xd0e3a8];await _0xb81d4e['userStickers']['bulkDelete'](_0x2e11b1),_0x505390[_0x20d322(0x407)]=_0x505390[_0x20d322(0x407)][_0x20d322(0x85d)](_0x3244d4=>!_0x2e11b1[_0x20d322(0x44f)](_0x3244d4['id'])),_0x101bec(),_0x46e430(),await _0x1519c8(_0x20d322(0xa62),_0x20d322(0x1078));}}async function _0x5d7c47(){const _0x15315c=_0x85c4bf,_0x371ea0=_0x15315c(0xef6),_0x6d7869=await _0x9a2c09(_0x15315c(0xf95),_0x371ea0,'',_0x15315c(0x1283));_0x6d7869&&_0x6d7869[_0x15315c(0x9c1)]()&&await _0x2be70a(_0x6d7869);}async function _0x2be70a(_0x48ab49){const _0x470117=_0x85c4bf,_0x145dcd=_0x48ab49[_0x470117(0x9c1)]()['split']('\x0a'),_0x3a0f4d=[],_0x29fb3d=_0x470117(0x1102);let _0x4a2c1e=0x0;const _0x5bd826=_0x2a104d!=='all'&&_0x2a104d!==_0x470117(0x331)?_0x2a104d:null;for(const _0x2ce704 of _0x145dcd){const _0x1f982a=_0x2ce704[_0x470117(0x9c1)]();if(!_0x1f982a||_0x1f982a['includes']('填入'))continue;const _0xdff33a=_0x1f982a['match'](/^(.+?)[:：]\s*(https?:\/\/.+)$/);if(_0xdff33a){const _0x25d9c3=_0xdff33a[0x1][_0x470117(0x9c1)](),_0x1184c3=_0xdff33a[0x2][_0x470117(0x9c1)]();_0x3a0f4d['push']({'id':_0x470117(0xd50)+Date[_0x470117(0x12d6)]()+Math['random'](),'name':_0x25d9c3,'url':_0x1184c3,'categoryId':_0x5bd826});continue;}let _0x2082e1=null,_0x2d2c58=null;const _0x3d6a17=_0x1f982a[_0x470117(0xab4)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x3d6a17)_0x2082e1=_0x3d6a17[0x1],_0x2d2c58=_0x3d6a17[0x2];else{const _0x255fec=_0x1f982a[_0x470117(0x53e)](/\s+/);_0x255fec['length']>=0x2&&(_0x2d2c58=_0x255fec[_0x470117(0xb47)](),_0x2082e1=_0x255fec[_0x470117(0x35d)]('\x20'));}_0x2082e1&&_0x2d2c58&&_0x2d2c58[_0x470117(0x44f)]('.')?_0x3a0f4d[_0x470117(0x1a0)]({'id':_0x470117(0xd50)+Date[_0x470117(0x12d6)]()+Math[_0x470117(0x103a)](),'name':_0x2082e1,'url':_0x29fb3d+_0x2d2c58,'categoryId':_0x5bd826}):(_0x4a2c1e++,console[_0x470117(0x139e)](_0x470117(0x2f7),_0x1f982a));}_0x4a2c1e>0x0&&await _0x1519c8('部分导入失败','有\x20'+_0x4a2c1e+_0x470117(0xe6a));if(_0x3a0f4d[_0x470117(0x990)]>0x0)await _0xb81d4e[_0x470117(0x407)][_0x470117(0x2d9)](_0x3a0f4d),_0x505390[_0x470117(0x407)][_0x470117(0x1a0)](..._0x3a0f4d),_0x46e430(),await _0x1519c8(_0x470117(0x634),_0x470117(0x67e)+_0x3a0f4d[_0x470117(0x990)]+'\x20个新表情！');else _0x4a2c1e===0x0&&alert(_0x470117(0x6de));}function _0xd69305(_0x58b77f){const _0x2c2366=_0x85c4bf,_0x198282='.message-bubble[data-timestamp=\x22'+_0x58b77f+'\x22]',_0x154d8e=document[_0x2c2366(0x8bc)](_0x198282);_0x154d8e?(_0x154d8e[_0x2c2366(0xaf0)]({'behavior':_0x2c2366(0x4f5),'block':_0x2c2366(0x1e5)}),_0x154d8e[_0x2c2366(0x9cd)][_0x2c2366(0x807)](_0x2c2366(0x580)),setTimeout(()=>{const _0x325cb5=_0x2c2366;document[_0x325cb5(0xc78)][_0x325cb5(0x658)](_0x154d8e)&&_0x154d8e[_0x325cb5(0x9cd)][_0x325cb5(0x8b6)](_0x325cb5(0x580));},0x5dc)):alert(_0x2c2366(0x12e7));}async function _0x43c884(_0x52a7e0,_0x5bf17c){const _0x4d6ea2=_0x85c4bf;if(_0x52a7e0[_0x4d6ea2(0x858)]==='recalled_message'){const _0x2d921c=document[_0x4d6ea2(0xbd5)]('div');_0x2d921c[_0x4d6ea2(0xfd4)]=_0x4d6ea2(0x617),_0x2d921c[_0x4d6ea2(0x13d4)][_0x4d6ea2(0x12a2)]=_0x52a7e0[_0x4d6ea2(0x12a2)];const _0x1015af=document[_0x4d6ea2(0xbd5)]('div');return _0x1015af[_0x4d6ea2(0xfd4)]='message-bubble\x20recalled-message-placeholder',_0x1015af['dataset'][_0x4d6ea2(0x12a2)]=_0x52a7e0[_0x4d6ea2(0x12a2)],_0x1015af[_0x4d6ea2(0x97b)]=_0x52a7e0[_0x4d6ea2(0xac4)],_0x2d921c[_0x4d6ea2(0x9f4)](_0x1015af),_0x33282f(_0x2d921c,()=>_0x3b9989(_0x52a7e0[_0x4d6ea2(0x12a2)])),_0x2d921c[_0x4d6ea2(0xa75)](_0x4d6ea2(0xd2f),()=>{const _0x369d5d=_0x4d6ea2;_0x4c148b&&_0x27b22d(_0x52a7e0[_0x369d5d(0x12a2)]);}),_0x2d921c;}else{if(_0x52a7e0[_0x4d6ea2(0x858)]===_0x4d6ea2(0x2f4)){const _0x291d55=document[_0x4d6ea2(0xbd5)]('div');_0x291d55[_0x4d6ea2(0xfd4)]=_0x4d6ea2(0x617),_0x291d55[_0x4d6ea2(0x13d4)][_0x4d6ea2(0x12a2)]=_0x52a7e0[_0x4d6ea2(0x12a2)];const _0x30262c=document[_0x4d6ea2(0xbd5)](_0x4d6ea2(0x6c8));return _0x30262c[_0x4d6ea2(0xfd4)]=_0x4d6ea2(0x5b6),_0x30262c['dataset'][_0x4d6ea2(0x403)]=_0x52a7e0[_0x4d6ea2(0x403)],_0x30262c['textContent']=_0x52a7e0[_0x4d6ea2(0xac4)],_0x291d55[_0x4d6ea2(0x9f4)](_0x30262c),_0x33282f(_0x291d55,()=>_0x3b9989(_0x52a7e0[_0x4d6ea2(0x12a2)])),_0x291d55[_0x4d6ea2(0xa75)](_0x4d6ea2(0xd2f),()=>{const _0x26f786=_0x4d6ea2;_0x4c148b&&_0x27b22d(_0x52a7e0[_0x26f786(0x12a2)]);}),_0x291d55;}}if(_0x52a7e0[_0x4d6ea2(0xb9c)])return null;if(_0x52a7e0[_0x4d6ea2(0x858)]==='pat_message'){const _0x4c399b=document[_0x4d6ea2(0xbd5)]('div');_0x4c399b['className']=_0x4d6ea2(0x617);const _0x3d7a60=document[_0x4d6ea2(0xbd5)](_0x4d6ea2(0x6c8));return _0x3d7a60[_0x4d6ea2(0xfd4)]='message-bubble\x20system-bubble',_0x3d7a60[_0x4d6ea2(0x13d4)]['timestamp']=_0x52a7e0[_0x4d6ea2(0x12a2)],_0x3d7a60[_0x4d6ea2(0x97b)]=_0x52a7e0[_0x4d6ea2(0xac4)],_0x4c399b[_0x4d6ea2(0x9f4)](_0x3d7a60),_0x33282f(_0x4c399b,()=>_0x3b9989(_0x52a7e0[_0x4d6ea2(0x12a2)])),_0x4c399b[_0x4d6ea2(0xa75)](_0x4d6ea2(0xd2f),()=>{if(_0x4c148b)_0x27b22d(_0x52a7e0['timestamp']);}),_0x4c399b;}const _0x5ef694=_0x52a7e0[_0x4d6ea2(0x508)]===_0x4d6ea2(0x4c5),_0x151db7=_0x5bf17c[_0x4d6ea2(0x18a)]['myNickname']||'我',_0x3537ae=document[_0x4d6ea2(0xbd5)](_0x4d6ea2(0x6c8));_0x3537ae[_0x4d6ea2(0xfd4)]=_0x4d6ea2(0xd53)+(_0x5ef694?_0x4d6ea2(0x4c5):'ai');if(_0x5bf17c[_0x4d6ea2(0x9d7)]&&!_0x5ef694){const _0x11d22d=_0x5bf17c[_0x4d6ea2(0x954)][_0x4d6ea2(0xc0d)](_0x1da800=>_0x1da800[_0x4d6ea2(0xe2d)]===_0x52a7e0['senderName']),_0x50ca98=document[_0x4d6ea2(0xbd5)](_0x4d6ea2(0x6c8));_0x50ca98['className']=_0x4d6ea2(0x11b9),_0x50ca98[_0x4d6ea2(0x97b)]=_0x11d22d?_0x11d22d['groupNickname']:_0x52a7e0['senderName']||'未知成员',_0x3537ae[_0x4d6ea2(0x9f4)](_0x50ca98);}const _0x57bfa4=document[_0x4d6ea2(0xbd5)](_0x4d6ea2(0x6c8));_0x57bfa4[_0x4d6ea2(0xfd4)]=_0x4d6ea2(0x139c)+(_0x5ef694?_0x4d6ea2(0x4c5):'ai'),_0x57bfa4[_0x4d6ea2(0x13d4)][_0x4d6ea2(0x12a2)]=_0x52a7e0[_0x4d6ea2(0x12a2)];const _0x5c1d5b=document[_0x4d6ea2(0xbd5)](_0x4d6ea2(0xf91));_0x5c1d5b[_0x4d6ea2(0xfd4)]='timestamp',_0x5c1d5b[_0x4d6ea2(0x97b)]=_0x5d6a58(_0x52a7e0[_0x4d6ea2(0x12a2)]);let _0x5d77c1,_0x4318ec='';if(_0x5ef694)_0x5d77c1=_0x5bf17c['settings'][_0x4d6ea2(0xe28)]||(_0x5bf17c['isGroup']?_0x2361d7:_0x28c106),_0x4318ec=_0x5bf17c[_0x4d6ea2(0x18a)][_0x4d6ea2(0x486)]||'';else{if(_0x5bf17c[_0x4d6ea2(0x9d7)]){const _0x2ce561=_0x5bf17c[_0x4d6ea2(0x954)]['find'](_0x492f2d=>_0x492f2d[_0x4d6ea2(0xe2d)]===_0x52a7e0[_0x4d6ea2(0xdcc)]);if(_0x2ce561){const _0x7356bf=_0x505390[_0x4d6ea2(0x1027)][_0x2ce561['id']];_0x5d77c1=_0x2ce561[_0x4d6ea2(0x799)]||(_0x7356bf?_0x7356bf[_0x4d6ea2(0x18a)][_0x4d6ea2(0x1039)]:_0x3ea4df),_0x4318ec=_0x2ce561[_0x4d6ea2(0xea1)]||(_0x7356bf?_0x7356bf[_0x4d6ea2(0x18a)][_0x4d6ea2(0x663)]:'');}else _0x5d77c1=_0x3ea4df,_0x4318ec='';}else _0x5d77c1=_0x5bf17c[_0x4d6ea2(0x18a)][_0x4d6ea2(0x1039)]||_0x28c106,_0x4318ec=_0x5bf17c['settings'][_0x4d6ea2(0x663)]||'';}let _0x5a4bf9;_0x4318ec?_0x5a4bf9=_0x4d6ea2(0xbe9)+_0x5d77c1+_0x4d6ea2(0x367)+_0x4318ec+_0x4d6ea2(0x722):_0x5a4bf9='<img\x20src=\x22'+_0x5d77c1+_0x4d6ea2(0x6e7);const _0x82ee1c=_0x4318ec?_0x4d6ea2(0x1126):'',_0xcc3ed8=_0x4d6ea2(0x299)+_0x82ee1c+'\x22>'+_0x5a4bf9+_0x4d6ea2(0x2c3);let _0x394f48,_0x2d6fc8='';if(_0x52a7e0[_0x4d6ea2(0xb67)]){const _0x514559=_0x503999(_0x5bf17c,_0x52a7e0[_0x4d6ea2(0xb67)][_0x4d6ea2(0xdcc)]),_0x5b118d=String(_0x52a7e0[_0x4d6ea2(0xb67)][_0x4d6ea2(0xac4)]||'');_0x2d6fc8=_0x4d6ea2(0x282)+_0x52a7e0[_0x4d6ea2(0xb67)][_0x4d6ea2(0x12a2)]+_0x4d6ea2(0x7f4)+_0x514559+':</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-content\x22>'+_0x5b118d+_0x4d6ea2(0xd23);}let _0x39428d=_0x52a7e0[_0x4d6ea2(0xac4)];if(typeof _0x39428d===_0x4d6ea2(0x8d9)&&_0x39428d[_0x4d6ea2(0x9c1)]()['startsWith']('<')&&_0x39428d[_0x4d6ea2(0x9c1)]()[_0x4d6ea2(0x1193)]('>'))_0x394f48=_0x39428d,_0x57bfa4[_0x4d6ea2(0x9cd)]['add'](_0x4d6ea2(0xdcf));else{if(_0x52a7e0[_0x4d6ea2(0x858)]==='offline_text'||_0x52a7e0[_0x4d6ea2(0x858)]===_0x4d6ea2(0x131b)||_0x52a7e0[_0x4d6ea2(0x858)]===_0x4d6ea2(0xc59)||_0x52a7e0[_0x4d6ea2(0x858)]==='location_share'||_0x52a7e0[_0x4d6ea2(0x858)]===_0x4d6ea2(0x135a)||_0x52a7e0[_0x4d6ea2(0x858)]==='user_photo'||_0x52a7e0[_0x4d6ea2(0x858)]===_0x4d6ea2(0x9bf)||_0x52a7e0[_0x4d6ea2(0x858)]===_0x4d6ea2(0x5f8)||_0x52a7e0[_0x4d6ea2(0x858)]==='waimai_request'||_0x52a7e0[_0x4d6ea2(0x858)]===_0x4d6ea2(0x4cf)||_0x52a7e0[_0x4d6ea2(0x858)]===_0x4d6ea2(0x1358)||_0x52a7e0[_0x4d6ea2(0x858)]==='poll'||_0x52a7e0[_0x4d6ea2(0x858)]===_0x4d6ea2(0x1362)||_0x52a7e0['type']===_0x4d6ea2(0x12c7)||_0x52a7e0['type']==='naiimag'){if(_0x52a7e0[_0x4d6ea2(0x858)]===_0x4d6ea2(0x124e)){const _0x170e10=_0x52a7e0[_0x4d6ea2(0xac4)]||((_0x52a7e0[_0x4d6ea2(0xfba)]||'')+'\x20'+(_0x52a7e0[_0x4d6ea2(0x78b)]||''))[_0x4d6ea2(0x9c1)](),_0x44d6fa=/(「.*?」|“.*?”)/g,_0x976be9=_0x170e10[_0x4d6ea2(0x53e)](_0x44d6fa)['filter'](_0x3a6389=>_0x3a6389);_0x394f48=_0x976be9[_0x4d6ea2(0x2e1)](_0x192f37=>{const _0x18f83d=_0x4d6ea2;return _0x192f37['startsWith']('「')||_0x192f37[_0x18f83d(0x591)]('“')?_0x18f83d(0xddb)+_0x23554f(_0x192f37)+'</span>':_0x18f83d(0xfb6)+_0x23554f(_0x192f37['trim']())['replace'](/\n/g,'<br>')+_0x18f83d(0x451);})[_0x4d6ea2(0x35d)]('');}else{if(_0x52a7e0['type']===_0x4d6ea2(0x131b))_0x57bfa4[_0x4d6ea2(0x9cd)]['add'](_0x4d6ea2(0x765),_0x4d6ea2(0x9e2)),_0x394f48='<div\x20class=\x22link-share-card\x22\x20data-timestamp=\x22'+_0x52a7e0['timestamp']+'\x22><div\x20class=\x22title\x22>'+(_0x52a7e0[_0x4d6ea2(0xc29)]||_0x4d6ea2(0xb3c))+_0x4d6ea2(0x9aa)+(_0x52a7e0[_0x4d6ea2(0x78b)]||'点击查看详情...')+_0x4d6ea2(0x1026)+(_0x52a7e0[_0x4d6ea2(0x6a3)]||_0x4d6ea2(0x118f))+'</span></div></div>';else{if(_0x52a7e0['type']===_0x4d6ea2(0xc59))_0x57bfa4[_0x4d6ea2(0x9cd)][_0x4d6ea2(0x807)](_0x4d6ea2(0x765),'is-card-like'),_0x394f48=_0x4d6ea2(0xf8d)+_0x52a7e0[_0x4d6ea2(0x12a2)]+_0x4d6ea2(0xb4e)+_0x52a7e0[_0x4d6ea2(0xdf8)][_0x4d6ea2(0xc29)]+_0x4d6ea2(0xb6c)+_0x52a7e0[_0x4d6ea2(0xdf8)][_0x4d6ea2(0x1e3)][_0x4d6ea2(0x990)]+_0x4d6ea2(0xb2e);else{if(_0x52a7e0[_0x4d6ea2(0x858)]===_0x4d6ea2(0xeef)){_0x57bfa4['classList']['add'](_0x4d6ea2(0x1258),_0x4d6ea2(0x9e2));let _0x4e46be;if(_0x52a7e0[_0x4d6ea2(0xa09)])_0x4e46be=_0x52a7e0['imageUrl'];else _0x505390[_0x4d6ea2(0x888)][_0x4d6ea2(0x105c)]&&_0x52a7e0[_0x4d6ea2(0xfb2)]?_0x4e46be=_0x4d6ea2(0x730)+encodeURIComponent(_0x52a7e0[_0x4d6ea2(0xfb2)]):_0x4e46be=_0x4d6ea2(0xfed);const _0x12b5c6='style=\x22background-image:\x20url(\x27'+_0x4e46be+'\x27);\x22';_0x394f48=_0x4d6ea2(0xc9a)+_0x52a7e0[_0x4d6ea2(0xac4)]+_0x4d6ea2(0x2c8)+_0x12b5c6+_0x4d6ea2(0x9cc);}else{if(_0x52a7e0[_0x4d6ea2(0x858)]==='user_photo'||_0x52a7e0['type']===_0x4d6ea2(0x135a)){_0x57bfa4[_0x4d6ea2(0x9cd)][_0x4d6ea2(0x807)](_0x4d6ea2(0xa70),_0x4d6ea2(0x9e2));const _0x309519=_0x52a7e0['type']===_0x4d6ea2(0x5d5)?_0x4d6ea2(0xbec):'AI生成的图片',_0x11156f=_0x505390[_0x4d6ea2(0x888)][_0x4d6ea2(0x105c)]&&_0x52a7e0[_0x4d6ea2(0xfb2)]?_0x4d6ea2(0x730)+_0x52a7e0[_0x4d6ea2(0xfb2)]:_0x4d6ea2(0x775);_0x394f48=_0x4d6ea2(0xdba)+_0x11156f+_0x4d6ea2(0x1d4)+_0x309519+_0x4d6ea2(0x64a)+_0x52a7e0[_0x4d6ea2(0xac4)]+'\x22>';}else{if(_0x52a7e0[_0x4d6ea2(0x858)]==='naiimag')_0x57bfa4[_0x4d6ea2(0x9cd)][_0x4d6ea2(0x807)](_0x4d6ea2(0xd07),_0x4d6ea2(0x9e2)),_0x394f48='<img\x20src=\x22'+_0x52a7e0[_0x4d6ea2(0xa09)]+'\x22\x20class=\x22realimag-image\x22\x20alt=\x22NovelAI图片分享\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22\x20title=\x22'+(_0x52a7e0[_0x4d6ea2(0x2ed)]||_0x52a7e0['prompt']||_0x4d6ea2(0xcc5))+'\x22>';else{if(_0x52a7e0[_0x4d6ea2(0x858)]===_0x4d6ea2(0x9bf)){_0x57bfa4[_0x4d6ea2(0x9cd)][_0x4d6ea2(0x807)](_0x4d6ea2(0x10b8),'is-card-like');const _0x4f83b9=Math[_0x4d6ea2(0x6b8)](0x1,Math[_0x4d6ea2(0x412)]((_0x52a7e0['content']||'')[_0x4d6ea2(0x990)]/0x5)),_0x2e64a1='0:'+String(_0x4f83b9)[_0x4d6ea2(0x738)](0x2,'0')+'\x27\x27',_0x5769f9='<div></div><div></div><div></div><div></div><div></div>';if(_0x5ef694)_0x394f48='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-message-body\x22\x20data-text=\x22'+encodeURIComponent(_0x52a7e0[_0x4d6ea2(0xac4)])+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-waveform\x22>'+_0x5769f9+_0x4d6ea2(0x4bc)+_0x2e64a1+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-transcript\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';else{const _0x1f8888=!_0x5bf17c[_0x4d6ea2(0x9d7)]&&_0x5bf17c[_0x4d6ea2(0x18a)][_0x4d6ea2(0xe5b)]!==![],_0x2cecc2=_0x5bf17c[_0x4d6ea2(0x18a)]['minimaxVoiceId']||'female-shaonv-jingpin',_0x142529=_0x1f8888?_0x4d6ea2(0xdc8)+_0x2cecc2+'\x22':'';_0x394f48=_0x4d6ea2(0xcfe)+encodeURIComponent(_0x52a7e0['content'])+'\x22\x20'+_0x142529+_0x4d6ea2(0x1091)+_0x5769f9+_0x4d6ea2(0xe5c)+_0x2e64a1+_0x4d6ea2(0x9af);}}else{if(_0x52a7e0[_0x4d6ea2(0x858)]===_0x4d6ea2(0x5f8)){_0x57bfa4[_0x4d6ea2(0x9cd)][_0x4d6ea2(0x807)](_0x4d6ea2(0x12b6),_0x4d6ea2(0x9e2));let _0x225968,_0x2c5875;const _0x301ee4=_0x5bf17c['isGroup']?_0x5bf17c[_0x4d6ea2(0x18a)]['myNickname']||'我':'我',_0x486ef6=_0x503999(_0x5bf17c,_0x52a7e0['senderName']),_0x3e77cc=_0x503999(_0x5bf17c,_0x52a7e0[_0x4d6ea2(0xfd7)]||_0x5bf17c[_0x4d6ea2(0x564)]);if(_0x5ef694){if(_0x52a7e0[_0x4d6ea2(0x976)])_0x225968=_0x4d6ea2(0x10cd)+_0x3e77cc,_0x2c5875=_0x4d6ea2(0x12cc);else{_0x225968='转账给\x20'+_0x3e77cc;if(_0x52a7e0[_0x4d6ea2(0x93c)]==='accepted')_0x2c5875=_0x4d6ea2(0xcb7);else{if(_0x52a7e0[_0x4d6ea2(0x93c)]===_0x4d6ea2(0xe4b))_0x2c5875=_0x4d6ea2(0x1131);else _0x2c5875=_0x52a7e0[_0x4d6ea2(0x926)]||_0x4d6ea2(0xbf4);}}}else{if(_0x52a7e0[_0x4d6ea2(0x976)])_0x225968=_0x4d6ea2(0xd69)+_0x486ef6,_0x2c5875=_0x4d6ea2(0xcac);else{if(_0x52a7e0[_0x4d6ea2(0xfd7)]===_0x301ee4){_0x225968='转账给\x20'+_0x301ee4;if(_0x52a7e0[_0x4d6ea2(0x93c)]===_0x4d6ea2(0x1312))_0x2c5875='你已收款';else{if(_0x52a7e0[_0x4d6ea2(0x93c)]===_0x4d6ea2(0xe4b))_0x2c5875=_0x4d6ea2(0x43a);else _0x57bfa4[_0x4d6ea2(0x10dd)][_0x4d6ea2(0xd8b)]=_0x4d6ea2(0x1366),_0x57bfa4[_0x4d6ea2(0x13d4)][_0x4d6ea2(0x93c)]='pending',_0x2c5875=_0x52a7e0[_0x4d6ea2(0x926)]||_0x4d6ea2(0x12ed);}}else _0x225968='转账:\x20'+_0x486ef6+'\x20→\x20'+_0x3e77cc,_0x2c5875=_0x52a7e0[_0x4d6ea2(0x926)]||'群聊内转账';}}const _0x462bde='<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2220\x22\x20height=\x2220\x22\x20fill=\x22currentColor\x22\x20style=\x22vertical-align:\x20middle;\x22><path\x20d=\x22M12\x2021.35l-1.45-1.32C5.4\x2015.36\x202\x2012.28\x202\x208.5\x202\x205.42\x204.42\x203\x207.5\x203c1.74\x200\x203.41.81\x204.5\x202.09C13.09\x203.81\x2014.76\x203\x2016.5\x203\x2019.58\x203\x2022\x205.42\x2022\x208.5c0\x203.78-3.4\x206.86-8.55\x2011.54L12\x2021.35z\x22></path></svg>';_0x394f48=_0x4d6ea2(0x5b8)+_0x462bde+'\x20'+_0x225968+_0x4d6ea2(0xeec)+Number(_0x52a7e0[_0x4d6ea2(0xc5c)])['toFixed'](0x2)+'</div><div\x20class=\x22transfer-note\x22>'+_0x2c5875+_0x4d6ea2(0x12ec);}else{if(_0x52a7e0[_0x4d6ea2(0x858)]===_0x4d6ea2(0x792)){_0x57bfa4[_0x4d6ea2(0x9cd)][_0x4d6ea2(0x807)](_0x4d6ea2(0x24e),_0x4d6ea2(0x9e2));if(_0x52a7e0['status']==='paid'||_0x52a7e0[_0x4d6ea2(0x93c)]===_0x4d6ea2(0xd5e))_0x57bfa4[_0x4d6ea2(0x9cd)]['add'](_0x4d6ea2(0x234)+_0x52a7e0[_0x4d6ea2(0x93c)]);const _0x50ffbf=_0x503999(_0x5bf17c,_0x52a7e0[_0x4d6ea2(0xdcc)]),_0x6e621f='来自\x20'+_0x50ffbf+_0x4d6ea2(0xf0b);let _0x3c4c92='';_0x52a7e0[_0x4d6ea2(0x93c)]===_0x4d6ea2(0xa25)&&!_0x5ef694&&(_0x3c4c92=_0x4d6ea2(0xa47)),_0x394f48=_0x4d6ea2(0x10e2)+_0x6e621f+_0x4d6ea2(0x1ab)+Number(_0x52a7e0['amount'])['toFixed'](0x2)+'</div><div\x20class=\x22countdown-label\x22>剩余支付时间<div\x20class=\x22countdown-timer\x22\x20id=\x22waimai-timer-'+_0x52a7e0[_0x4d6ea2(0x12a2)]+_0x4d6ea2(0xc92)+_0x3c4c92+_0x4d6ea2(0x2c3),setTimeout(()=>{const _0x3d6be5=_0x4d6ea2;if(_0x52a7e0[_0x3d6be5(0x93c)]===_0x3d6be5(0xa25)){const _0x32ad66=document['getElementById'](_0x3d6be5(0x2ac)+_0x52a7e0[_0x3d6be5(0x12a2)]);if(_0x32ad66){const _0x243c96=_0x1423cf(_0x32ad66,_0x52a7e0[_0x3d6be5(0x5fa)]);_0x43f059[_0x52a7e0[_0x3d6be5(0x12a2)]]=_0x243c96;}}},0x0);}else{if(_0x52a7e0[_0x4d6ea2(0x858)]===_0x4d6ea2(0x4cf)){_0x57bfa4['classList'][_0x4d6ea2(0x807)]('is-waimai-request','is-card-like');const _0x33e41a=_0x503999(_0x5bf17c,_0x52a7e0[_0x4d6ea2(0xdcc)]);let _0x47baf0='你';_0x5bf17c[_0x4d6ea2(0x9d7)]&&(_0x47baf0=_0x503999(_0x5bf17c,_0x52a7e0[_0x4d6ea2(0x1103)])),_0x394f48=_0x4d6ea2(0x937)+_0x33e41a+_0x4d6ea2(0x4a0)+_0x47baf0+'下单，请慢用～</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22payment-box\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22payment-label\x22\x20style=\x22font-size:\x2018px;\x20font-weight:\x20600;\x22>'+_0x52a7e0[_0x4d6ea2(0xaf5)]+_0x4d6ea2(0x891)+Number(_0x52a7e0['amount'])[_0x4d6ea2(0x6e1)](0x2)+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22waimai-details-btn\x22>查看订单详情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20';}else{if(_0x52a7e0[_0x4d6ea2(0x858)]==='red_packet'){_0x57bfa4[_0x4d6ea2(0x9cd)]['add'](_0x4d6ea2(0x585),_0x4d6ea2(0x9e2));const _0x310805=_0x505390[_0x4d6ea2(0x1190)]['nickname']||_0x4d6ea2(0x80e),_0xcc20fb=_0x52a7e0['isFullyClaimed'],_0x184b80=_0x52a7e0['claimedBy']&&_0x52a7e0[_0x4d6ea2(0x12e6)][_0x310805];let _0x51deb0='',_0x42ff18='',_0x37a5c1=_0x4d6ea2(0xc57);_0xcc20fb&&(_0x51deb0='opened');if(_0x52a7e0[_0x4d6ea2(0xeaf)]==='direct'){const _0x371c66=_0x503999(_0x5bf17c,_0x52a7e0['receiverName']);_0x37a5c1=_0x4d6ea2(0x732)+_0x371c66;if(Object[_0x4d6ea2(0x108c)](_0x52a7e0['claimedBy']||{})[_0x4d6ea2(0x990)]>0x0)_0x51deb0=_0x4d6ea2(0xf27);}if(_0x184b80){const _0x5e5903=_0x52a7e0[_0x4d6ea2(0x12e6)][_0x310805]||0x0;_0x42ff18='<div\x20class=\x22rp-claimed-info\x22>你领取了红包，金额\x20'+_0x5e5903[_0x4d6ea2(0x6e1)](0x2)+_0x4d6ea2(0x48c);}else{if(_0xcc20fb)_0x42ff18=_0x4d6ea2(0x494);else{if(_0x52a7e0[_0x4d6ea2(0xeaf)]===_0x4d6ea2(0x211)&&Object[_0x4d6ea2(0x108c)](_0x52a7e0['claimedBy']||{})[_0x4d6ea2(0x990)]>0x0){const _0x348c39=_0x503999(_0x5bf17c,_0x52a7e0[_0x4d6ea2(0xfd7)]);_0x42ff18='<div\x20class=\x22rp-claimed-info\x22>已被\x20'+_0x348c39+_0x4d6ea2(0x1348);}}}_0x394f48='<div\x20class=\x22red-packet-card\x20'+_0x51deb0+_0x4d6ea2(0x962)+(_0x52a7e0[_0x4d6ea2(0x91e)]||'恭喜发财，大吉大利！')+_0x4d6ea2(0x11bc)+_0x37a5c1+_0x4d6ea2(0x2c3)+_0x42ff18+'</div>';}else{if(_0x52a7e0[_0x4d6ea2(0x858)]===_0x4d6ea2(0xb34)){_0x57bfa4[_0x4d6ea2(0x9cd)]['add'](_0x4d6ea2(0xbe8),_0x4d6ea2(0x9e2));const _0x45c579=_0x52a7e0[_0x4d6ea2(0xa60)]||_0x52a7e0[_0x4d6ea2(0xac4)]||_0x4d6ea2(0xc66);let _0x324551=0x0;const _0x428903={};for(const _0x2ad235 in _0x52a7e0[_0x4d6ea2(0x78e)]){const _0x3739d5=_0x52a7e0[_0x4d6ea2(0x78e)][_0x2ad235][_0x4d6ea2(0x990)];_0x428903[_0x2ad235]=_0x3739d5,_0x324551+=_0x3739d5;}const _0x1a0380=_0x505390['qzoneSettings']['nickname']||_0x4d6ea2(0x80e);let _0x548002=null;for(const _0x206377 in _0x52a7e0['votes']){if(_0x52a7e0[_0x4d6ea2(0x78e)][_0x206377]['includes'](_0x1a0380)){_0x548002=_0x206377;break;}}let _0x54abfd=_0x4d6ea2(0x7db);_0x52a7e0[_0x4d6ea2(0x6ed)][_0x4d6ea2(0x12be)](_0x1836f8=>{const _0x273ba1=_0x4d6ea2,_0x489461=_0x428903[_0x1836f8]||0x0,_0x8e6482=_0x324551>0x0?_0x489461/_0x324551*0x64:0x0,_0x1b882d=_0x548002===_0x1836f8;_0x54abfd+=_0x273ba1(0xcb2)+(_0x1b882d?_0x273ba1(0x6dd):'')+'\x22\x20data-option=\x22'+_0x1836f8+_0x273ba1(0x7c8)+_0x8e6482+_0x273ba1(0xbdc)+_0x1836f8+_0x273ba1(0xde9)+_0x489461+'\x20票</span></div></div>';}),_0x54abfd+=_0x4d6ea2(0x2c3);let _0x3ff41c=_0x52a7e0[_0x4d6ea2(0x6fc)]?_0x4d6ea2(0x862)+_0x324551+'\x20人投票</span><button\x20class=\x22poll-action-btn\x22>查看结果</button></div>':_0x4d6ea2(0x862)+_0x324551+_0x4d6ea2(0x84d);_0x394f48=_0x4d6ea2(0x64b)+(_0x52a7e0[_0x4d6ea2(0x6fc)]?_0x4d6ea2(0x544):'')+_0x4d6ea2(0x1130)+_0x52a7e0['timestamp']+'\x22><div\x20class=\x22poll-question\x22>'+_0x45c579+'</div>'+_0x54abfd+_0x3ff41c+_0x4d6ea2(0x2c3);}else{if(_0x52a7e0[_0x4d6ea2(0x858)]===_0x4d6ea2(0x1362)){_0x57bfa4['classList'][_0x4d6ea2(0x807)](_0x4d6ea2(0x93f),_0x4d6ea2(0x9e2));let _0x13f0bd;const _0x33b8a9=_0x5bf17c[_0x4d6ea2(0x18a)]['myNickname']||'我';if(_0x5bf17c['isGroup']){if(_0x52a7e0[_0x4d6ea2(0x116b)]&&_0x52a7e0['recipients']['length']>0x0){const _0x1548ea=_0x52a7e0[_0x4d6ea2(0x116b)][_0x4d6ea2(0x2e1)](_0x210a03=>_0x503999(_0x5bf17c,_0x210a03));_0x1548ea[_0x4d6ea2(0x990)]===0x1?_0x13f0bd=_0x4d6ea2(0x556)+_0x1548ea[0x0]+_0x4d6ea2(0x11bb):_0x13f0bd=_0x4d6ea2(0x556)+_0x1548ea['slice'](0x0,0x2)['join']('、')+_0x4d6ea2(0xf42);}else _0x13f0bd=_0x4d6ea2(0x6cf);}else{if(_0x5ef694)_0x13f0bd=_0x4d6ea2(0x556)+_0x5bf17c[_0x4d6ea2(0x564)]+_0x4d6ea2(0x11bb);else{const _0x3e6513=_0x5bf17c['settings'][_0x4d6ea2(0xf58)]||'你';_0x13f0bd=_0x4d6ea2(0x556)+_0x3e6513+_0x4d6ea2(0x11bb);}}const _0x39c4fe=_0x52a7e0['items'][_0x4d6ea2(0x777)](0x0,0x3);let _0x351d1a='';_0x39c4fe[_0x4d6ea2(0x12be)](_0x19d7a4=>{const _0x575800=_0x4d6ea2;_0x351d1a+=_0x575800(0xa7c)+_0x19d7a4[_0x575800(0xa09)]+'\x22\x20class=\x22gift-preview-img\x22><span\x20class=\x22gift-preview-name\x22>'+_0x19d7a4[_0x575800(0x564)]+_0x575800(0x10a7)+_0x19d7a4[_0x575800(0x2e8)]+_0x575800(0x10c6);});let _0x1cc855='';_0x52a7e0[_0x4d6ea2(0x117a)][_0x4d6ea2(0x990)]>0x3&&(_0x1cc855='\x20等'+_0x52a7e0['items'][_0x4d6ea2(0x990)]+'件商品'),_0x394f48=_0x4d6ea2(0xe9e)+_0x13f0bd+_0x4d6ea2(0x33b)+_0x351d1a+'</div><div\x20class=\x22gift-footer\x22>共'+_0x52a7e0[_0x4d6ea2(0x117a)][_0x4d6ea2(0x990)]+_0x4d6ea2(0xf37)+_0x1cc855+_0x4d6ea2(0x9ca);}}}}}}}}}}}}}}else{const _0x250ca3=String(_0x39428d);let _0x2ed18d=await _0xef16b0(_0x250ca3,_0x5bf17c['id']);if(_0x2ed18d!==_0x250ca3)_0x394f48=_0x2ed18d,_0x57bfa4[_0x4d6ea2(0x9cd)]['add'](_0x4d6ea2(0x9e2));else{if(Array[_0x4d6ea2(0x285)](_0x52a7e0['content'])&&_0x52a7e0['content'][0x0]?.['type']===_0x4d6ea2(0x1e8)){const _0x1ff33c=_0x52a7e0[_0x4d6ea2(0xac4)][0x0][_0x4d6ea2(0x1e8)][_0x4d6ea2(0x5f3)];_0x394f48=_0x4d6ea2(0xdba)+_0x1ff33c+'\x22\x20class=\x22chat-image\x22>';}else{if(_0x554a0b[_0x4d6ea2(0x101d)](_0x2ed18d))_0x57bfa4[_0x4d6ea2(0x9cd)][_0x4d6ea2(0x807)](_0x4d6ea2(0x10f0),'is-card-like'),_0x394f48=_0x4d6ea2(0xdba)+_0x2ed18d+'\x22\x20alt=\x22'+(_0x52a7e0[_0x4d6ea2(0x720)]||_0x4d6ea2(0x11b8))+_0x4d6ea2(0x1271);else{let _0x43449c=_0x4537d4(_0x2ed18d,_0x5bf17c);_0x394f48=_0x23554f(_0x43449c)[_0x4d6ea2(0x491)](/\n/g,_0x4d6ea2(0x1043));}}}}}_0x57bfa4[_0x4d6ea2(0x3de)]=_0x4d6ea2(0xf43)+_0xcc3ed8+_0x4d6ea2(0x196)+_0x2d6fc8+_0x4d6ea2(0x12cf)+_0x394f48+_0x4d6ea2(0xbd3),_0x3537ae[_0x4d6ea2(0x9f4)](_0x57bfa4),_0x3537ae[_0x4d6ea2(0x9f4)](_0x5c1d5b),_0x33282f(_0x3537ae,()=>_0x3b9989(_0x52a7e0['timestamp'])),_0x3537ae[_0x4d6ea2(0xa75)]('click',()=>{const _0x215af0=_0x4d6ea2;if(_0x4c148b)_0x27b22d(_0x52a7e0[_0x215af0(0x12a2)]);});if(!_0x5ef694){const _0x1eb56e=_0x3537ae[_0x4d6ea2(0x8bc)](_0x4d6ea2(0x577));_0x1eb56e&&(_0x1eb56e['style']['cursor']=_0x4d6ea2(0x1366),!_0x5bf17c[_0x4d6ea2(0x9d7)]?_0x1eb56e[_0x4d6ea2(0xa75)](_0x4d6ea2(0xd2f),_0x1493be=>{const _0x56958c=_0x4d6ea2;_0x1493be[_0x56958c(0x748)](),_0x54ec9e(_0x5bf17c['id']);}):_0x1eb56e['addEventListener']('dblclick',_0x4740c3=>{const _0xe2be00=_0x4d6ea2;_0x4740c3['stopPropagation'](),_0x5be2f7(_0x5bf17c['id'],_0x52a7e0[_0xe2be00(0xdcc)]);}));}return _0x3537ae;}async function _0x46f5e0(_0x296f28,_0x18d0ad){const _0x9c2d87=_0x85c4bf,_0x4972d3=document[_0x9c2d87(0x479)]('chat-messages'),_0x194bd7=await _0x43c884(_0x296f28,_0x18d0ad);if(!_0x194bd7)return;const _0x1dc3e0=document[_0x9c2d87(0x479)](_0x9c2d87(0x106c));_0x1dc3e0?_0x4972d3['insertBefore'](_0x194bd7,_0x1dc3e0['nextSibling']):_0x4972d3[_0x9c2d87(0xaa6)](_0x194bd7);}async function _0x48f5ff(_0x416b59,_0x541ec7,_0x114d15=![]){const _0x8fd8e1=_0x85c4bf,_0x4c3bb5=document['getElementById'](_0x8fd8e1(0x659)),_0x320f19=document[_0x8fd8e1(0x479)]('typing-indicator'),_0x5bcca0=_0x541ec7[_0x8fd8e1(0x7d3)][_0x8fd8e1(0x85d)](_0x4e92c8=>!_0x4e92c8[_0x8fd8e1(0xb9c)])[_0x8fd8e1(0xb47)]();if(_0x5bcca0&&_0x416b59[_0x8fd8e1(0x12a2)]-_0x5bcca0[_0x8fd8e1(0x12a2)]>0x927c0){const _0x376234=_0x3a0a18(_0x416b59[_0x8fd8e1(0x12a2)]);_0x4c3bb5['insertBefore'](_0x376234,_0x320f19);}const _0x4d3640=await _0x43c884(_0x416b59,_0x541ec7);if(!_0x4d3640)return;_0x416b59[_0x8fd8e1(0x508)]===_0x8fd8e1(0x1328)&&!_0x114d15&&_0x361231(),!_0x114d15&&_0x4d3640[_0x8fd8e1(0x9cd)][_0x8fd8e1(0x807)]('animate-in'),_0x4c3bb5[_0x8fd8e1(0xe22)](_0x4d3640,_0x320f19),!_0x114d15&&(_0x4c3bb5[_0x8fd8e1(0x2b3)]=_0x4c3bb5[_0x8fd8e1(0x9c5)],_0x1e729c++);}async function _0x178862(_0x13c089){const _0x51d16d=_0x85c4bf;_0x505390[_0x51d16d(0x233)]=_0x13c089;const _0x15164d=_0x505390[_0x51d16d(0x1027)][_0x13c089];if(!_0x15164d)return;_0x15164d['unreadCount']>0x0&&(_0x15164d[_0x51d16d(0x1090)]=0x0,await _0xb81d4e[_0x51d16d(0x1027)][_0x51d16d(0x5d0)](_0x15164d));_0x372924(_0x15164d),_0x474d6b(_0x13c089),_0x731d5(_0x51d16d(0xdeb)),window['updateListenTogetherIconProxy'](_0x505390['activeChatId']);const _0x1e7bc0=_0x15164d[_0x51d16d(0x9d7)]||![];_0x130b8d(_0x1e7bc0),document[_0x51d16d(0x479)](_0x51d16d(0xd48))[_0x51d16d(0x10dd)][_0x51d16d(0x678)]=_0x1e7bc0?_0x51d16d(0x899):_0x51d16d(0xff8);const _0x26e945=document['getElementById']('pat-btn');_0x26e945&&(_0x26e945[_0x51d16d(0x10dd)]['display']=_0x1e7bc0?_0x51d16d(0xff8):'flex');const _0x1f2c34=document['getElementById'](_0x51d16d(0x2c1)),_0x41ef9d=document[_0x51d16d(0x479)]('open-shopping-btn'),_0x1aadbb=document['getElementById'](_0x51d16d(0x74e)),_0x1ff7e1=document[_0x51d16d(0x479)](_0x51d16d(0x6cd));_0x41ef9d&&_0x1aadbb&&_0x1ff7e1&&_0x1f2c34&&(_0x41ef9d[_0x51d16d(0x10dd)][_0x51d16d(0x678)]=_0x51d16d(0x899),_0x1aadbb[_0x51d16d(0x10dd)]['display']=_0x1e7bc0?'none':'flex',_0x1ff7e1[_0x51d16d(0x10dd)]['display']=_0x1e7bc0?_0x51d16d(0x899):_0x51d16d(0xff8),_0x1f2c34[_0x51d16d(0x10dd)][_0x51d16d(0x678)]=_0x1e7bc0?_0x51d16d(0xff8):_0x51d16d(0x899)),_0x3f74ae(),!_0x15164d[_0x51d16d(0x9d7)]&&_0x15164d[_0x51d16d(0xcda)]?.['status']===_0x51d16d(0xb79)&&(console[_0x51d16d(0x90f)](_0x51d16d(0xf6a)+_0x15164d['name']+_0x51d16d(0x72e)),_0x15e1a8()),document[_0x51d16d(0x479)](_0x51d16d(0x8b0))[_0x51d16d(0x10dd)][_0x51d16d(0x678)]=_0x1e7bc0?_0x51d16d(0x899):_0x51d16d(0xff8);}function _0x156c85(_0x1fe9c7,_0x329e10){const _0x27b003=_0x85c4bf,_0x3cee46=_0x329e10?_0x27b003(0x807):_0x27b003(0x8b6),_0x186c80=_0x1e1fc8=>{const _0x212a56=_0x27b003;_0x1e1fc8&&_0x1e1fc8[_0x212a56(0x9cd)][_0x3cee46](_0x212a56(0xdfc));},_0x4ecf78=document[_0x27b003(0x8bc)](_0x27b003(0xa4d)+_0x1fe9c7+_0x27b003(0x356));_0x186c80(_0x4ecf78);const _0x4527df=document['querySelectorAll']('.post-avatar[data-author-id=\x22'+_0x1fe9c7+'\x22]');_0x4527df[_0x27b003(0x12be)](_0x186c80);const _0x24bb68=document['querySelector'](_0x27b003(0x104a)+_0x1fe9c7+'\x22]');_0x186c80(_0x24bb68);}async function _0x1b1d53(){const _0x58e704=_0x85c4bf;if(!_0x505390[_0x58e704(0x233)])return;const _0x1152bd=_0x505390[_0x58e704(0x233)],_0xdaf326=_0x505390[_0x58e704(0x1027)][_0x1152bd];lastRawAiResponse='',lastResponseTimestamps=[];const _0x36d750=document[_0x58e704(0x479)](_0x58e704(0x645));_0x36d750&&(_0x36d750['disabled']=!![],_0x36d750[_0x58e704(0x97b)]=_0x58e704(0xfea));_0x156c85(_0x1152bd,!![]);try{const {proxyUrl:_0x1dc685,apiKey:_0x21211a,model:_0x264d77}=_0x505390[_0x58e704(0x30c)];if(!_0x1dc685||!_0x21211a||!_0x264d77)throw new Error(_0x58e704(0xb42));const _0x2d0d3c=parseInt(_0xdaf326[_0x58e704(0x18a)][_0x58e704(0x2c6)])||0xa,_0x553298=_0xdaf326[_0x58e704(0x7d3)][_0x58e704(0x777)](-_0x2d0d3c);let _0x292d63='';if(_0xdaf326[_0x58e704(0x18a)][_0x58e704(0x13da)]&&_0xdaf326[_0x58e704(0x18a)]['linkedWorldBookIds'][_0x58e704(0x990)]>0x0){const _0x5b9878=_0xdaf326[_0x58e704(0x18a)][_0x58e704(0x13da)][_0x58e704(0x2e1)](_0x31759f=>{const _0x46a075=_0x58e704,_0xfedc75=_0x505390['worldBooks'][_0x46a075(0xc0d)](_0x9c1b95=>_0x9c1b95['id']===_0x31759f);if(!_0xfedc75||!Array[_0x46a075(0x285)](_0xfedc75[_0x46a075(0xac4)]))return'';const _0x4661eb=_0xfedc75[_0x46a075(0xac4)]['filter'](_0xbaf5b5=>_0xbaf5b5[_0x46a075(0x2b7)]!==![])['map'](_0x31705b=>{const _0x4d4aa6=_0x46a075;let _0x54bda8=_0x4d4aa6(0x1345)+(_0x31705b[_0x4d4aa6(0xd6c)]||_0x4d4aa6(0x561))+'\x0a';if(_0x31705b[_0x4d4aa6(0x108c)][_0x4d4aa6(0x990)]>0x0)_0x54bda8+=_0x4d4aa6(0x6ff)+_0x31705b[_0x4d4aa6(0x108c)][_0x4d4aa6(0x35d)](',\x20')+'\x0a';return _0x54bda8+='**内容:**\x0a'+_0x31705b[_0x4d4aa6(0xac4)],_0x54bda8;})[_0x46a075(0x35d)]('');return _0x4661eb?_0x46a075(0x103d)+_0xfedc75[_0x46a075(0x564)]+'\x0a'+_0x4661eb:'';})['filter'](Boolean)[_0x58e704(0x35d)]('');_0x5b9878&&(_0x292d63=_0x58e704(0x12b0)+_0x5b9878+_0x58e704(0x5f5));}let _0x26c3c0=_0x58e704(0xbae),_0x2b5759=![];_0xdaf326[_0x58e704(0x954)]['forEach'](_0x373c8d=>{const _0x4fbd6a=_0x58e704,_0x584b44=_0x505390[_0x4fbd6a(0x1027)][_0x373c8d['id']];_0x584b44&&_0x584b44[_0x4fbd6a(0x3b4)]&&_0x584b44[_0x4fbd6a(0x3b4)]['length']>0x0&&(_0x26c3c0+='\x0a##\x20---\x20关于“'+_0x373c8d['groupNickname']+_0x4fbd6a(0x6d3),_0x26c3c0+=_0x584b44[_0x4fbd6a(0x3b4)]['map'](_0x349d3a=>_0x4fbd6a(0x619)+_0x3e14b1(_0x349d3a['timestamp'])+')\x20'+_0x349d3a[_0x4fbd6a(0xac4)])[_0x4fbd6a(0x35d)]('\x0a'),_0x2b5759=!![]);});!_0x2b5759&&(_0x26c3c0+=_0x58e704(0xa15));let _0x1bd676='';const _0x221721=_0xdaf326[_0x58e704(0x18a)][_0x58e704(0xefc)]||0xa;if(_0xdaf326['settings'][_0x58e704(0xefa)]&&_0xdaf326[_0x58e704(0x18a)]['linkedMemoryChatIds'][_0x58e704(0x990)]>0x0){}const _0x59d54e=_0xdaf326['members'][_0x58e704(0x2e1)](_0x580233=>'-\x20**'+_0x580233[_0x58e704(0xa54)]+_0x58e704(0x11a8)+_0x580233[_0x58e704(0xe2d)]+'):\x20'+_0x580233[_0x58e704(0x596)])[_0x58e704(0x35d)]('\x0a'),_0x5e0f04=_0x46c840(_0xdaf326),_0xf5f2c6=_0x58e704(0x1136)+_0xdaf326['name']+_0x58e704(0x81e)+_0xdaf326['name']+'\x0a\x0a#\x20上下文参考\x20(你必须阅读并遵守)\x0a'+_0x26c3c0+'\x0a'+_0x292d63+'\x0a'+_0x1bd676+_0x58e704(0xe71)+_0x553298[_0x58e704(0x2e1)](_0x313ecc=>_0x503999(_0xdaf326,_0x313ecc[_0x58e704(0xdcc)])+':\x20'+_0x313ecc['content'])[_0x58e704(0x35d)]('\x0a')+_0x58e704(0x764)+_0x59d54e+_0x58e704(0x1183)+_0x5e0f04+_0x58e704(0x198),_0x129a12=_0x553298['map'](_0x30698d=>({'role':_0x58e704(0x4c5),'content':_0x503999(_0xdaf326,_0x30698d[_0x58e704(0xdcc)])+':\x20'+_0x30698d[_0x58e704(0xac4)]}));let _0x21bb94=_0x1dc685[_0x58e704(0x44f)](_0x58e704(0xa76)),_0x51cc5e;if(_0x21bb94){let _0x4fa9e8=_0x19a701(_0x264d77,_0x21211a,_0xf5f2c6,_0x129a12);_0x51cc5e=await fetch(_0x4fa9e8['url'],_0x4fa9e8[_0x58e704(0x104c)]);}else _0x51cc5e=await fetch(_0x1dc685+'/v1/chat/completions',{'method':_0x58e704(0xba0),'headers':{'Content-Type':_0x58e704(0xcb5),'Authorization':'Bearer\x20'+_0x21211a},'body':JSON[_0x58e704(0x1308)]({'model':_0x264d77,'messages':[{'role':_0x58e704(0xbaa),'content':_0xf5f2c6},..._0x129a12],'temperature':_0x505390[_0x58e704(0x888)][_0x58e704(0x398)]||0.9})});if(!_0x51cc5e['ok']){const _0x5061c7=await _0x51cc5e['json']()[_0x58e704(0x575)](()=>({'error':{'message':_0x51cc5e['statusText']}}));throw new Error(_0x58e704(0xf05)+_0x51cc5e['status']+_0x58e704(0x501)+(_0x5061c7['error']?.[_0x58e704(0x757)]||_0x58e704(0x1022)));}const _0x1ebf73=await _0x51cc5e['json'](),_0x2b356b=getGeminiResponseText(_0x1ebf73);lastRawAiResponse=_0x2b356b;const _0x552787=_0x2da9f3(_0x2b356b);let _0x406da9=Date['now']();for(const _0x35ea6e of _0x552787){if(!_0x35ea6e||!_0x35ea6e[_0x58e704(0x858)]||!_0x35ea6e['name'])continue;let _0xa9942f=null;const _0x1d29fc=_0x406da9++;lastResponseTimestamps[_0x58e704(0x1a0)](_0x1d29fc);const _0x1dc3ea={'role':_0x58e704(0x1328),'senderName':_0x35ea6e[_0x58e704(0x564)],'timestamp':_0x1d29fc};switch(_0x35ea6e[_0x58e704(0x858)]){case _0x58e704(0x56d):_0xa9942f={..._0x1dc3ea,'content':_0x35ea6e[_0x58e704(0xac4)]};break;case _0x58e704(0xb9e):if(_0x35ea6e[_0x58e704(0x720)]){const _0x554657=_0x505390[_0x58e704(0x407)][_0x58e704(0xc0d)](_0x1fcfbb=>_0x1fcfbb[_0x58e704(0x564)]===_0x35ea6e[_0x58e704(0x720)]);_0x554657?_0xa9942f={..._0x1dc3ea,'type':'sticker','content':_0x554657[_0x58e704(0x5f3)],'meaning':_0x554657[_0x58e704(0x564)]}:(console[_0x58e704(0x139e)](_0x58e704(0x35f)+_0x35ea6e['meaning']+'\x22'),_0xa9942f={..._0x1dc3ea,'type':_0x58e704(0x56d),'content':_0x58e704(0xdbf)+_0x35ea6e[_0x58e704(0x720)]+']'});}else console[_0x58e704(0x139e)](_0x58e704(0x628),_0x35ea6e);break;case'ai_image':_0xa9942f={..._0x1dc3ea,'type':_0x58e704(0x135a),'content':_0x35ea6e['description'],'image_prompt':_0x35ea6e[_0x58e704(0xfb2)]};break;case _0x58e704(0x9bf):_0xa9942f={..._0x1dc3ea,'type':'voice_message','content':_0x35ea6e['content']};break;case _0x58e704(0x47f):const _0x45e658=_0xdaf326[_0x58e704(0x7d3)][_0x58e704(0xc0d)](_0x53f3be=>_0x53f3be[_0x58e704(0x12a2)]===_0x35ea6e[_0x58e704(0xe51)]);_0x45e658?_0xa9942f={..._0x1dc3ea,'content':_0x35ea6e['reply_content'],'quote':{'timestamp':_0x45e658[_0x58e704(0x12a2)],'senderName':_0x45e658[_0x58e704(0xdcc)],'content':String(_0x45e658['content']||'')[_0x58e704(0x1323)](0x0,0x32)}}:_0xa9942f={..._0x1dc3ea,'content':_0x35ea6e[_0x58e704(0x12f0)]};break;default:console[_0x58e704(0x139e)](_0x58e704(0x471),_0x35ea6e[_0x58e704(0x858)]);continue;}_0xa9942f&&(_0xdaf326[_0x58e704(0x7d3)][_0x58e704(0x1a0)](_0xa9942f),_0x48f5ff(_0xa9942f,_0xdaf326),await new Promise(_0x531182=>setTimeout(_0x531182,Math['random']()*0x4b0+0x320)));}await _0xb81d4e[_0x58e704(0x1027)][_0x58e704(0x5d0)](_0xdaf326),_0x1b7f69();}catch(_0x3e0387){console[_0x58e704(0xe3b)](_0x58e704(0x109a),_0x3e0387),await _0x1519c8(_0x58e704(0xaab),_0x58e704(0xe2b)+_0x3e0387[_0x58e704(0x757)]);}finally{_0x36d750&&(_0x36d750[_0x58e704(0xfce)]=![],_0x36d750[_0x58e704(0x97b)]=_0x58e704(0xcea)),_0x156c85(_0x1152bd,![]);}}async function _0x15e1a8(){const _0x50f127=_0x85c4bf;if(!_0x505390[_0x50f127(0x233)])return;const _0xbfff66=_0x505390[_0x50f127(0x233)],_0x17e4ac=_0x505390['chats'][_0x505390[_0x50f127(0x233)]],_0x12c5ce=document[_0x50f127(0x479)](_0x50f127(0xdeb))['classList']['contains'](_0x50f127(0x5a9))&&_0x505390[_0x50f127(0x233)]===_0xbfff66;_0x156c85(_0xbfff66,!![]);const _0x4fdc0b=document[_0x50f127(0x479)]('chat-header-title'),_0x15179a=document[_0x50f127(0x479)](_0x50f127(0x257)),_0x2366a2=document[_0x50f127(0x8bc)](_0x50f127(0xa4d)+_0xbfff66+'\x22]'),_0x4e000c=_0x2366a2?_0x2366a2[_0x50f127(0x8bc)](_0x50f127(0x1004)):null;_0x4e000c&&_0x4e000c['classList'][_0x50f127(0x807)](_0x50f127(0xdfc));_0x17e4ac['isGroup']?_0x15179a&&(_0x15179a['textContent']=_0x50f127(0xf5d),_0x15179a[_0x50f127(0x10dd)]['display']=_0x50f127(0xee3)):_0x4fdc0b&&(_0x4fdc0b[_0x50f127(0x10dd)]['opacity']=0x0,setTimeout(()=>{const _0x2a776b=_0x50f127;_0x4fdc0b[_0x2a776b(0x97b)]='对方正在输入...',_0x4fdc0b[_0x2a776b(0x9cd)][_0x2a776b(0x807)](_0x2a776b(0x11c7)),_0x4fdc0b['style'][_0x2a776b(0x939)]=0x1;},0xc8));let _0x4d39ea=![];try{const {proxyUrl:_0x2811ee,apiKey:_0x4f9ed4,model:_0x33bcac}=_0x505390['apiConfig'];if(!_0x2811ee||!_0x4f9ed4||!_0x33bcac){alert('请先在API设置中配置反代地址、密钥并选择模型。');if(_0x17e4ac['isGroup']){if(_0x15179a)_0x15179a[_0x50f127(0x10dd)][_0x50f127(0x678)]=_0x50f127(0xff8);}else _0x4fdc0b&&_0x505390[_0x50f127(0x1027)][_0xbfff66]&&(_0x4fdc0b[_0x50f127(0x97b)]=_0x505390[_0x50f127(0x1027)][_0xbfff66][_0x50f127(0x564)],_0x4fdc0b['classList']['remove']('typing-status'));return;}const _0x59adf2=_0x17e4ac['history'][_0x50f127(0x777)](-0x1)[0x0],_0x358c4a=_0x59adf2&&_0x59adf2['role']==='system'&&_0x59adf2[_0x50f127(0xac4)]['includes']('视频通话请求');if(_0x358c4a){console[_0x50f127(0x90f)]('检测到视频通话请求，为角色\x20\x22'+_0x17e4ac[_0x50f127(0x564)]+_0x50f127(0x93e));let _0x1d145d;_0x17e4ac[_0x50f127(0x9d7)]?_0x1d145d=_0x50f127(0x29a)+_0x17e4ac['members'][_0x50f127(0x2e1)](_0x273cb4=>'-\x20'+_0x273cb4['groupNickname']+_0x50f127(0x13c8)+_0x273cb4[_0x50f127(0xe2d)]+'):\x20'+_0x273cb4['persona'])[_0x50f127(0x35d)]('\x0a')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请为所有AI角色做出决策。':_0x1d145d=_0x50f127(0x578)+_0x17e4ac[_0x50f127(0x18a)]['aiPersona']+_0x50f127(0xf89);const _0x8580f3=[{'role':_0x50f127(0x4c5),'content':_0x1d145d}];try{let _0x165c0f=_0x19a701(_0x33bcac,_0x4f9ed4,_0x1d145d,_0x8580f3),_0x2c56b5=_0x2811ee===GEMINI_API_URL;const _0x5ae372=_0x2c56b5?await fetch(_0x165c0f[_0x50f127(0x5f3)],_0x165c0f['data']):await fetch(_0x2811ee+_0x50f127(0x347),{'method':'POST','headers':{'Content-Type':'application/json','Authorization':_0x50f127(0xb27)+_0x4f9ed4},'body':JSON['stringify']({'model':_0x33bcac,'messages':_0x8580f3,'temperature':0.7})});if(!_0x5ae372['ok'])throw new Error(_0x50f127(0x248)+(await _0x5ae372[_0x50f127(0xfdf)]())[_0x50f127(0xe3b)][_0x50f127(0x757)]);const _0x5db194=await _0x5ae372[_0x50f127(0xfdf)](),_0x29bacf=getGeminiResponseText(_0x5db194),_0x2c9919=_0x2da9f3(_0x29bacf);let _0x553e13=![];for(const _0xd38595 of _0x2c9919){if(_0xd38595[_0x50f127(0x858)]===_0x50f127(0x1034)){_0x315a6a[_0x50f127(0xbb7)]=![];if(_0xd38595['decision']===_0x50f127(0xacb))_0x511eb0();else{const _0x43116f={'role':_0x50f127(0x1328),'content':'对方拒绝了你的视频通话请求。','timestamp':Date[_0x50f127(0x12d6)]()};_0x17e4ac[_0x50f127(0x7d3)][_0x50f127(0x1a0)](_0x43116f),await _0xb81d4e[_0x50f127(0x1027)][_0x50f127(0x5d0)](_0x17e4ac),_0x731d5(_0x50f127(0xdeb)),_0x474d6b(_0xbfff66);}_0x553e13=!![];break;}if(_0xd38595[_0x50f127(0x858)]===_0x50f127(0x3cc)){if(_0xd38595['decision']===_0x50f127(0x35d)){const _0x52be8b=_0x17e4ac[_0x50f127(0x954)][_0x50f127(0xc0d)](_0x62e146=>_0x62e146[_0x50f127(0xe2d)]===_0xd38595[_0x50f127(0x564)]);_0x52be8b&&!_0x315a6a[_0x50f127(0xf06)]['some'](_0x5202bd=>_0x5202bd['id']===_0x52be8b['id'])&&_0x315a6a['participants'][_0x50f127(0x1a0)](_0x52be8b);}_0x553e13=!![];}}_0x553e13&&_0x315a6a['isGroupCall']&&(_0x315a6a[_0x50f127(0xbb7)]=![],_0x315a6a['participants'][_0x50f127(0x990)]>0x0?_0x511eb0():(_0x315a6a={..._0x315a6a,'isAwaitingResponse':![],'participants':[]},_0x731d5(_0x50f127(0xdeb)),alert(_0x50f127(0x408))));}catch(_0x31be91){console[_0x50f127(0xe3b)](_0x50f127(0xedd),_0x31be91);const _0x1437a8=_0x17e4ac[_0x50f127(0x9d7)]?_0x17e4ac[_0x50f127(0x954)]['map'](_0x397a2b=>({'type':_0x50f127(0x3cc),'name':_0x397a2b[_0x50f127(0xe2d)],'decision':_0x50f127(0x35a)})):[{'type':'video_call_response','decision':_0x50f127(0xc54)}];if(_0x17e4ac['isGroup'])_0x315a6a[_0x50f127(0xbb7)]=![],_0x315a6a['participants']=[],alert('无人接听群聊邀请。'),_0x731d5(_0x50f127(0xdeb));else{const _0x2aefd7={'role':_0x50f127(0x1328),'content':_0x50f127(0xe5a),'timestamp':Date['now']()};_0x17e4ac[_0x50f127(0x7d3)][_0x50f127(0x1a0)](_0x2aefd7),await _0xb81d4e[_0x50f127(0x1027)][_0x50f127(0x5d0)](_0x17e4ac),_0x731d5('chat-interface-screen'),_0x474d6b(_0xbfff66);}}finally{_0x156c85(_0xbfff66,![]);return;}}if(!_0x17e4ac[_0x50f127(0x9d7)]&&_0x17e4ac[_0x50f127(0xcda)]?.[_0x50f127(0x93c)]===_0x50f127(0xb79)){console[_0x50f127(0x90f)](_0x50f127(0x10bb)+_0x17e4ac['name']+_0x50f127(0x3c6));const _0x1510dc=_0x17e4ac[_0x50f127(0x7d3)]['filter'](_0xba2c2c=>!_0xba2c2c[_0x50f127(0xb9c)])[_0x50f127(0x777)](-0xa,-0x5)[_0x50f127(0x2e1)](_0x69bd1f=>{const _0x31e323=_0x50f127,_0x1ab140=_0x69bd1f[_0x31e323(0x508)]==='user'?'用户':_0x17e4ac[_0x31e323(0x564)];return _0x1ab140+':\x20'+String(_0x69bd1f[_0x31e323(0xac4)])[_0x31e323(0x1323)](0x0,0x32)+_0x31e323(0x4d0);})[_0x50f127(0x35d)]('\x0a'),_0x418603=_0x50f127(0x235)+_0x17e4ac[_0x50f127(0x564)]+_0x50f127(0x6ae)+_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0x11f6)]+_0x50f127(0x350)+_0x17e4ac[_0x50f127(0xcda)][_0x50f127(0xcd9)]+_0x50f127(0x6e8)+(_0x1510dc||_0x50f127(0x36f))+_0x50f127(0xc4d);try{const _0x2e13df=[{'role':_0x50f127(0xbaa),'content':_0x418603},{'role':'user','content':_0x50f127(0x6f4)}];let _0x251961=_0x2811ee===GEMINI_API_URL,_0x32594a=_0x19a701(_0x33bcac,_0x4f9ed4,_0x418603,[{'role':_0x50f127(0x4c5),'content':_0x50f127(0x6f4)}]);const _0x5b2aa1=_0x251961?await fetch(_0x32594a[_0x50f127(0x5f3)],_0x32594a[_0x50f127(0x104c)]):await fetch(_0x2811ee+_0x50f127(0x347),{'method':'POST','headers':{'Content-Type':_0x50f127(0xcb5),'Authorization':_0x50f127(0xb27)+_0x4f9ed4},'body':JSON['stringify']({'model':_0x33bcac,'messages':_0x2e13df,'temperature':_0x505390[_0x50f127(0x888)][_0x50f127(0x398)]||0.8})});if(!_0x5b2aa1['ok'])throw new Error('API失败:\x20'+(await _0x5b2aa1[_0x50f127(0xfdf)]())[_0x50f127(0xe3b)][_0x50f127(0x757)]);const _0x2d70c4=await _0x5b2aa1[_0x50f127(0xfdf)](),_0x46aad7=getGeminiResponseText(_0x2d70c4)['replace'](/^```json\s*/,'')['replace'](/```$/,'')[_0x50f127(0x9c1)](),_0x4edfc8=JSON[_0x50f127(0x94c)](_0x46aad7);if(_0x4edfc8['decision']===_0x50f127(0xacb)){_0x17e4ac[_0x50f127(0xcda)][_0x50f127(0x93c)]=_0x50f127(0xc83);const _0x1c9331={'role':_0x50f127(0x1328),'senderName':_0x17e4ac['name'],'content':_0x4edfc8[_0x50f127(0xaac)],'timestamp':Date[_0x50f127(0x12d6)]()};_0x17e4ac[_0x50f127(0x7d3)][_0x50f127(0x1a0)](_0x1c9331);}else{_0x17e4ac[_0x50f127(0xcda)][_0x50f127(0x93c)]=_0x50f127(0x84b);const _0x587fd2={'role':_0x50f127(0x1328),'senderName':_0x17e4ac[_0x50f127(0x564)],'content':_0x4edfc8[_0x50f127(0xaac)],'timestamp':Date[_0x50f127(0x12d6)]()};_0x17e4ac[_0x50f127(0x7d3)][_0x50f127(0x1a0)](_0x587fd2);}_0x17e4ac[_0x50f127(0xcda)][_0x50f127(0xcd9)]='',await _0xb81d4e[_0x50f127(0x1027)][_0x50f127(0x5d0)](_0x17e4ac),_0x474d6b(_0xbfff66),_0x1b7f69();}catch(_0x1604c3){_0x17e4ac[_0x50f127(0xcda)][_0x50f127(0x93c)]=_0x50f127(0x84b),await _0xb81d4e['chats']['put'](_0x17e4ac),await _0x1519c8(_0x50f127(0x1397),'AI在处理你的好友申请时出错了，请稍后重试。\x0a错误信息:\x20'+_0x1604c3[_0x50f127(0x757)]),_0x474d6b(_0xbfff66);}return;}let _0x41392d='';const _0x424ca8=new Date(),_0x1cebbd=_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0xac0)]||_0x50f127(0x20e),_0x37bdd5=_0x424ca8['toLocaleString']('zh-CN',{'timeZone':_0x1cebbd,'dateStyle':'full','timeStyle':_0x50f127(0xe6f)}),_0x2ff434=new Date(_0x424ca8[_0x50f127(0x119c)]('en-US',{'timeZone':_0x1cebbd})),_0x4a7e7a=_0x3ae0c5(_0x2ff434);let _0x40ed47,_0xb679bb;const _0x3d865a=_0x17e4ac[_0x50f127(0x7d3)][_0x50f127(0x85d)](_0x5da3f3=>_0x5da3f3[_0x50f127(0xb9c)])[_0x50f127(0xb47)]();if(_0x3d865a&&_0x3d865a[_0x50f127(0xac4)][_0x50f127(0x44f)](_0x50f127(0x139a))){const _0x34f8d2=await _0xb81d4e[_0x50f127(0x52e)][_0x50f127(0x46f)]('chatId')[_0x50f127(0x4a2)](_0xbfff66)[_0x50f127(0xc8a)]();if(_0x34f8d2&&_0x34f8d2[_0x50f127(0x2f9)]){console[_0x50f127(0x90f)](_0x50f127(0xe1c));const _0x383400=_0x34f8d2[_0x50f127(0x2f9)][_0x50f127(0x2e1)](_0x265e81=>{const _0x2b7b0c=_0x50f127,_0x319ccb=_0x265e81[_0x2b7b0c(0x508)]===_0x2b7b0c(0x4c5)?_0x17e4ac[_0x2b7b0c(0x18a)][_0x2b7b0c(0xf58)]||'我':_0x265e81['senderName'];return _0x319ccb+':\x20'+_0x265e81['content'];})[_0x50f127(0x35d)]('\x0a');_0x41392d=_0x50f127(0x7d2)+_0x383400+'\x0a---\x0a';}}const _0x3f30c7=_0xd8afdd(_0x5aa690[_0xbfff66]);let _0xef81c0='';if(_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0x13da)]&&_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0x13da)]['length']>0x0){const _0x2eeb9a=_0x17e4ac[_0x50f127(0x18a)]['linkedWorldBookIds'][_0x50f127(0x2e1)](_0x59d78a=>{const _0x3f438d=_0x50f127,_0x3c8514=_0x505390['worldBooks']['find'](_0x5d4d63=>_0x5d4d63['id']===_0x59d78a);if(!_0x3c8514||!Array['isArray'](_0x3c8514[_0x3f438d(0xac4)]))return'';const _0xa26e9f=_0x3c8514[_0x3f438d(0xac4)][_0x3f438d(0x85d)](_0x5d2dc7=>_0x5d2dc7[_0x3f438d(0x2b7)]!==![])[_0x3f438d(0x2e1)](_0x18284c=>{const _0x558570=_0x3f438d;let _0x7a8e2d='\x0a###\x20条目:\x20'+(_0x18284c[_0x558570(0xd6c)]||_0x558570(0x561))+'\x0a';return _0x18284c[_0x558570(0x108c)]['length']>0x0&&(_0x7a8e2d+=_0x558570(0x6ff)+_0x18284c[_0x558570(0x108c)][_0x558570(0x35d)](',\x20')+'\x0a'),_0x7a8e2d+=_0x558570(0xb8a)+_0x18284c[_0x558570(0xac4)],_0x7a8e2d;})[_0x3f438d(0x35d)]('');return _0xa26e9f?_0x3f438d(0x103d)+_0x3c8514[_0x3f438d(0x564)]+'\x0a'+_0xa26e9f:'';})['filter'](Boolean)[_0x50f127(0x35d)]('');_0x2eeb9a&&(_0xef81c0=_0x50f127(0x12b0)+_0x2eeb9a+'\x0a#\x20---\x20世界书设定结束\x20---\x0a');}let _0x589c1b='';if(_0x304e8d['isActive']&&_0x304e8d[_0x50f127(0x233)]===_0xbfff66){const _0x220cba=_0x304e8d['currentIndex']>-0x1?_0x304e8d[_0x50f127(0x13c7)][_0x304e8d[_0x50f127(0x12a5)]]:null,_0x852a8a=_0x304e8d[_0x50f127(0x13c7)][_0x50f127(0x2e1)](_0x449269=>'\x22'+_0x449269[_0x50f127(0x564)]+'\x22')[_0x50f127(0x35d)](',\x20');let _0x325387='';if(_0x220cba&&_0x304e8d['parsedLyrics']&&_0x304e8d['parsedLyrics'][_0x50f127(0x990)]>0x0&&_0x304e8d[_0x50f127(0x8f8)]>-0x1){const _0x5a882a=_0x304e8d[_0x50f127(0x6f2)][_0x304e8d[_0x50f127(0x8f8)]],_0x127a7d=_0x304e8d[_0x50f127(0x6f2)][_0x50f127(0x777)](_0x304e8d[_0x50f127(0x8f8)]+0x1,_0x304e8d['currentLyricIndex']+0x3);_0x325387+=_0x50f127(0x92b)+_0x5a882a[_0x50f127(0x56d)]+'\x22\x0a',_0x127a7d[_0x50f127(0x990)]>0x0&&(_0x325387+=_0x50f127(0xbb3)+_0x127a7d[_0x50f127(0x2e1)](_0x193861=>'\x22'+_0x193861[_0x50f127(0x56d)]+'\x22')[_0x50f127(0x35d)](_0x50f127(0x4e7))+'\x0a');}_0x589c1b=_0x50f127(0xd3d)+(_0x220cba?'《'+_0x220cba['name']+'》\x20-\x20'+_0x220cba['artist']:'无')+_0x50f127(0x10a0)+_0x852a8a+_0x50f127(0x11bd)+_0x325387+_0x50f127(0x9df);}const _0x499eaa=parseInt(_0x17e4ac['settings'][_0x50f127(0x2c6)])||0xa,_0x28b762=_0x17e4ac['history'][_0x50f127(0x777)](-_0x499eaa);let _0x570242='';const _0x36ed24=_0x17e4ac['history']['findLastIndex'](_0x39fe56=>_0x39fe56['role']===_0x50f127(0x1328)),_0x42bc10=_0x17e4ac['history'][_0x50f127(0x777)](_0x36ed24+0x1),_0x3125fd=_0x42bc10[_0x50f127(0xc0d)](_0x1a0167=>_0x1a0167[_0x50f127(0x858)]===_0x50f127(0xc59));if(_0x3125fd){const _0x8a559f=_0x3125fd[_0x50f127(0xdf8)],_0x5e83e9=_0x8a559f[_0x50f127(0x1e3)][_0x50f127(0x2e1)](_0xa89a4d=>{const _0x152bc1=_0x50f127,_0x190c68=_0xa89a4d[_0x152bc1(0xdcc)]||(_0xa89a4d[_0x152bc1(0x508)]===_0x152bc1(0x4c5)?_0x17e4ac[_0x152bc1(0x18a)][_0x152bc1(0xf58)]||'我':'未知发送者');let _0x355120='';if(_0xa89a4d[_0x152bc1(0x858)]===_0x152bc1(0x9bf))_0x355120=_0x152bc1(0x185)+_0xa89a4d[_0x152bc1(0xac4)]+']';else{if(_0xa89a4d[_0x152bc1(0x858)]===_0x152bc1(0x135a))_0x355120=_0x152bc1(0x5b1)+_0xa89a4d[_0x152bc1(0x78b)]+']';else{if(_0xa89a4d[_0x152bc1(0x858)]===_0x152bc1(0x12c7))_0x355120=_0x152bc1(0xd86);else{if(_0xa89a4d[_0x152bc1(0x858)]===_0x152bc1(0x1cc))_0x355120='[NovelAI图片:\x20'+_0xa89a4d[_0x152bc1(0x3ae)]+']';else _0x355120=String(_0xa89a4d[_0x152bc1(0xac4)]);}}}return _0x190c68+':\x20'+_0x355120;})[_0x50f127(0x35d)]('\x0a');_0x570242=_0x50f127(0x1330)+_0x8a559f[_0x50f127(0xc9f)]+_0x50f127(0x1089)+_0x5e83e9+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20[分享的聊天记录结束]\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}let _0x4e5fa0='';const _0x97551d=_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0xefc)]||0xa;if(_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0xefa)]&&_0x17e4ac['settings'][_0x50f127(0xefa)][_0x50f127(0x990)]>0x0){const _0x45d7df=_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0xefa)][_0x50f127(0x85d)](_0x5a303c=>_0x5a303c!==_0xbfff66);if(_0x45d7df[_0x50f127(0x990)]>0x0){const _0x1cf54d=_0x45d7df['map'](_0x40c02c=>{const _0x3b0f11=_0x50f127,_0x37aa01=_0x505390[_0x3b0f11(0x1027)][_0x40c02c];if(!_0x37aa01)return null;const _0x27331d=_0x37aa01['history'][_0x3b0f11(0x777)](-0x1);return{'chat':_0x37aa01,'latestTimestamp':_0x27331d?_0x27331d[_0x3b0f11(0x12a2)]:0x0};})[_0x50f127(0x85d)](Boolean);_0x1cf54d[_0x50f127(0x382)]((_0x33325a,_0x1799e5)=>_0x1799e5[_0x50f127(0x698)]-_0x33325a[_0x50f127(0x698)]),_0x4e5fa0+='\x0a\x0a#\x20参考记忆\x20(至关重要！你必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你拥有完整的记忆。不要只是被动等待用户提问！)\x0a';for(const _0x4da03e of _0x1cf54d){const _0x4531c3=_0x4da03e[_0x50f127(0xa50)],_0x41290a=_0x4531c3['isGroup']?_0x50f127(0x519):'[私聊]',_0x4e1aaa=_0x4da03e[_0x50f127(0x698)]>0x0?_0x50f127(0xcb6)+_0x3e14b1(_0x4da03e[_0x50f127(0x698)])+')':'';_0x4e5fa0+=_0x50f127(0x3df)+_0x41290a+'“'+_0x4531c3['name']+_0x50f127(0x1335)+_0x4e1aaa+'\x20---\x0a';const _0xf94f87=_0x4531c3['history'][_0x50f127(0x777)](-_0x97551d),_0x5d98bc=_0xf94f87[_0x50f127(0x85d)](_0x4b6df5=>!String(_0x4b6df5['content'])[_0x50f127(0x44f)]('已被用户删除'));_0x5d98bc[_0x50f127(0x990)]>0x0?_0x5d98bc[_0x50f127(0x12be)](_0x43b419=>{const _0x244742=_0x50f127,_0x594ba6=_0x43b419[_0x244742(0x508)]===_0x244742(0x4c5)?_0x4531c3['settings']['myNickname']||'我':_0x43b419[_0x244742(0xdcc)]||_0x4531c3[_0x244742(0x564)];let _0x3f8455=String(_0x43b419[_0x244742(0xac4)]);if(_0x43b419[_0x244742(0x858)]===_0x244742(0x135a)||_0x43b419[_0x244742(0x858)]===_0x244742(0x5d5))_0x3f8455=_0x244742(0xa05)+_0x43b419[_0x244742(0xac4)]+']';else _0x43b419[_0x244742(0x858)]===_0x244742(0x9bf)&&(_0x3f8455=_0x244742(0xb7e)+_0x43b419['content']+']');const _0x485f8f=_0x3e14b1(_0x43b419[_0x244742(0x12a2)]);_0x4e5fa0+='('+_0x485f8f+')\x20'+_0x594ba6+':\x20'+_0x3f8455+'\x0a';}):_0x4e5fa0+=_0x50f127(0x550);}}}console[_0x50f127(0x90f)]('本次发送给AI的【挂载记忆】内容如下：\x0a',_0x4e5fa0);if(_0x17e4ac['isGroup']){let _0x373d79='';const _0x4aa9a6=_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0xefc)]||0xa;if(_0x17e4ac[_0x50f127(0x18a)]['linkedMemoryChatIds']&&_0x17e4ac['settings'][_0x50f127(0xefa)][_0x50f127(0x990)]>0x0){const _0x455a12=_0x17e4ac['settings'][_0x50f127(0xefa)][_0x50f127(0x85d)](_0x18f4b8=>_0x18f4b8!==_0xbfff66);if(_0x455a12[_0x50f127(0x990)]>0x0){const _0x2f2d52=_0x455a12['map'](_0x29db55=>{const _0x3d049d=_0x50f127,_0xf665bf=_0x505390[_0x3d049d(0x1027)][_0x29db55];if(!_0xf665bf)return null;const _0x180e74=_0xf665bf[_0x3d049d(0x7d3)][_0x3d049d(0x777)](-0x1);return{'chat':_0xf665bf,'latestTimestamp':_0x180e74?_0x180e74[_0x3d049d(0x12a2)]:0x0};})[_0x50f127(0x85d)](Boolean);_0x2f2d52[_0x50f127(0x382)]((_0x4b3d5e,_0x2c36ef)=>_0x2c36ef['latestTimestamp']-_0x4b3d5e[_0x50f127(0x698)]),_0x373d79+=_0x50f127(0x51a);for(const _0x3deaab of _0x2f2d52){const _0x502792=_0x3deaab[_0x50f127(0xa50)],_0x1c2674=_0x502792[_0x50f127(0x9d7)]?'[群聊]':_0x50f127(0x9ae),_0x41e7f3=_0x3deaab[_0x50f127(0x698)]>0x0?'\x20(最后互动于\x20'+_0x3e14b1(_0x3deaab['latestTimestamp'])+')':'';_0x373d79+=_0x50f127(0x3df)+_0x1c2674+'“'+_0x502792[_0x50f127(0x564)]+_0x50f127(0x1335)+_0x41e7f3+_0x50f127(0x261);const _0x59be12=_0x502792[_0x50f127(0x7d3)]['slice'](-_0x4aa9a6),_0x173e2b=_0x59be12[_0x50f127(0x85d)](_0x32c501=>!String(_0x32c501['content'])[_0x50f127(0x44f)]('已被用户删除'));_0x173e2b[_0x50f127(0x990)]>0x0?_0x173e2b[_0x50f127(0x12be)](_0xd9530d=>{const _0x3c392e=_0x50f127,_0x393c91=_0xd9530d['role']===_0x3c392e(0x4c5)?_0x502792[_0x3c392e(0x18a)]['myNickname']||'我':_0xd9530d[_0x3c392e(0xdcc)]||_0x502792[_0x3c392e(0x564)];let _0x240156=String(_0xd9530d['content']);if(_0xd9530d[_0x3c392e(0x858)]===_0x3c392e(0x135a)||_0xd9530d['type']===_0x3c392e(0x5d5))_0x240156=_0x3c392e(0xa05)+_0xd9530d[_0x3c392e(0xac4)]+']';else _0xd9530d['type']===_0x3c392e(0x9bf)&&(_0x240156=_0x3c392e(0xb7e)+_0xd9530d[_0x3c392e(0xac4)]+']');_0x373d79+=_0x393c91+':\x20'+_0x240156+'\x0a';}):_0x373d79+=_0x50f127(0x550);}}}let _0x3bb4ef='#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a',_0xe05634=![];_0x17e4ac[_0x50f127(0x954)]['forEach'](_0x428f49=>{const _0x249355=_0x50f127,_0x4e647d=_0x505390[_0x249355(0x1027)][_0x428f49['id']];_0x4e647d&&_0x4e647d[_0x249355(0x3b4)]&&_0x4e647d[_0x249355(0x3b4)][_0x249355(0x990)]>0x0&&(_0x3bb4ef+=_0x249355(0xfaa)+_0x428f49['groupNickname']+'”的记忆\x20---\x0a',_0x3bb4ef+=_0x4e647d[_0x249355(0x3b4)][_0x249355(0x2e1)](_0x42092b=>'-\x20(记录于\x20'+_0x3e14b1(_0x42092b[_0x249355(0x12a2)])+')\x20'+_0x42092b[_0x249355(0xac4)])[_0x249355(0x35d)]('\x0a'),_0xe05634=!![]);});!_0xe05634&&(_0x3bb4ef+=_0x50f127(0xa15));let _0x4f4cab='',_0x535c8c=![];if(_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0xeb0)]){const _0x36d240=_0x28b762[_0x50f127(0x777)](-0x1)[0x0];if(_0x36d240){const _0x245c45=_0x5782c9(_0x36d240[_0x50f127(0x12a2)]);_0x4f4cab=_0x50f127(0xb05)+_0x245c45+'。';const _0x59d1a8=(Date[_0x50f127(0x12d6)]()-_0x36d240[_0x50f127(0x12a2)])/(0x3e8*0x3c*0x3c);if(_0x59d1a8>0x3){_0x535c8c=!![];const _0x1a808d=Math[_0x50f127(0xd71)](_0x59d1a8/0x18);_0x4f4cab+=_0x50f127(0xc0f)+(_0x1a808d>0x0?_0x1a808d+'天':Math[_0x50f127(0xd71)](_0x59d1a8)+'小时')+'。';}}else _0x4f4cab=_0x50f127(0x4d1);}const _0x1e584f=await _0xb81d4e[_0x50f127(0x13c1)][_0x50f127(0x4ba)]();let _0x4b8f5d='';_0x1e584f[_0x50f127(0x990)]>0x0&&(_0x4b8f5d=_0x50f127(0xba3),_0x1e584f[_0x50f127(0x12be)](_0x26a3e9=>{const _0x42854f=_0x50f127;_0x4b8f5d+=_0x42854f(0xfb3)+_0x26a3e9['id']+')\x20商品:\x20'+_0x26a3e9['name']+',\x20价格:\x20¥'+_0x26a3e9[_0x42854f(0x9ce)]['toFixed'](0x2)+'\x0a';}));let _0x511177=_0x17e4ac[_0x50f127(0x954)][_0x50f127(0x2e1)](_0x50d914=>{const _0x685903=_0x50f127,_0x4fc9a9=_0x505390[_0x685903(0x1027)][_0x50d914['id']];let _0x2cdc93=_0x685903(0xb8c);if(_0x4fc9a9&&_0x4fc9a9[_0x685903(0x194)]){const _0x4e0569=Object['values'](_0x505390[_0x685903(0x1027)])[_0x685903(0x85d)](_0x25c2b6=>!_0x25c2b6[_0x685903(0x9d7)]&&_0x25c2b6['id']!==_0x50d914['id']&&_0x25c2b6[_0x685903(0x194)]===_0x4fc9a9['groupId']);_0x4e0569[_0x685903(0x990)]>0x0&&(_0x2cdc93='TA的好友包括:\x20'+_0x4e0569[_0x685903(0x2e1)](_0x3c5e60=>_0x3c5e60[_0x685903(0x564)])[_0x685903(0x35d)]('、\x20'));}return'-\x20**'+_0x50d914[_0x685903(0xa54)]+_0x685903(0x11a8)+_0x50d914[_0x685903(0xe2d)]+_0x685903(0x1044)+_0x50d914[_0x685903(0x596)]+'\x20[社交背景:\x20'+_0x2cdc93+']';})[_0x50f127(0x35d)]('\x0a');const _0x4ddc91=_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0xf58)]||'我',_0xfac971=_0x505390[_0x50f127(0x1190)]['nickname']||'{{user}}';let _0x121861='';const _0x508711=(_0x17e4ac[_0x50f127(0xbca)]||[])[_0x50f127(0x85d)](_0x4269ae=>_0x4269ae[_0x50f127(0xe4a)]);_0x508711['length']>0x0&&(_0x121861+=_0x50f127(0x10c5),_0x508711[_0x50f127(0x12be)](_0x54a10e=>{const _0x329c05=_0x50f127,_0x4f5afe=_0x17e4ac['history']['find'](_0x4cf71b=>_0x4cf71b[_0x329c05(0x12a2)]===_0x54a10e[_0x329c05(0x1280)]);if(_0x4f5afe){let _0x376358=String(_0x4f5afe['content']||'');_0x4f5afe[_0x329c05(0x858)]===_0x329c05(0x135a)&&(_0x376358=_0x329c05(0x12c8)+_0x376358+']'),_0x121861+='-\x20公告内容:\x20\x22'+_0x376358+_0x329c05(0x127f)+_0x54a10e[_0x329c05(0xb76)]+_0x329c05(0x12cd);}}),_0x121861+='---\x0a');const _0x2bc27b=_0x17e4ac[_0x50f127(0x954)][_0x50f127(0x2e1)](_0x126def=>_0x126def[_0x50f127(0xe2d)]),_0x3e6f0b=_0x50f127(0x10c3)+_0x2bc27b[_0x50f127(0x35d)]('、\x20')+']';let _0x474b53=_0x50f127(0x874);_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0x37f)]&&_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0x37f)][_0x50f127(0x990)]>0x0?_0x474b53+=_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0x37f)][_0x50f127(0x2e1)](_0x302589=>'-\x20'+_0x302589[_0x50f127(0x564)])[_0x50f127(0x35d)]('\x0a'):_0x474b53+=_0x50f127(0xd89);const _0x398764=_0x39755a(_0xbfff66),_0x280456=_0x37bdc8(_0x17e4ac,0x3,'hours'),_0x58bd70=_0x37bdc8(_0x17e4ac,0x6,_0x50f127(0x129d)),_0x47c6de=_0x37bdc8(_0x17e4ac,0x9,_0x50f127(0x129d)),_0x4eff9f=_0x37bdc8(_0x17e4ac,0x1,_0x50f127(0x111c)),_0x5c8c47=_0x37bdc8(_0x17e4ac,0x3,'days'),_0x2cc3ea=_0x37bdc8(_0x17e4ac,0x7,_0x50f127(0x111c));let _0x4f0338='';if(_0x280456||_0x58bd70||_0x47c6de||_0x4eff9f||_0x5c8c47||_0x2cc3ea){_0x4f0338+=_0x50f127(0x2a0);if(_0x280456)_0x4f0338+=_0x280456;if(_0x58bd70)_0x4f0338+=_0x58bd70;if(_0x47c6de)_0x4f0338+=_0x47c6de;if(_0x280456||_0x58bd70||_0x47c6de)_0x4f0338+='\x0a';if(_0x4eff9f)_0x4f0338+=_0x4eff9f;if(_0x5c8c47)_0x4f0338+=_0x5c8c47;if(_0x2cc3ea)_0x4f0338+=_0x2cc3ea;}const _0x644fa3=_0x46c840(_0x17e4ac);_0x40ed47=_0x50f127(0x135d)+_0x4ddc91+_0x50f127(0x7fd)+_0xfac971+_0x50f127(0x10ab)+_0x4ddc91+_0x50f127(0x31e)+_0x17e4ac[_0x50f127(0x564)]+_0x50f127(0xded)+(_0x17e4ac[_0x50f127(0x18a)]['enableTimePerception']?_0x50f127(0x12d9)+_0x37bdd5+_0x50f127(0x2a7)+(_0x535c8c?_0x50f127(0x23d)+_0x4f4cab+_0x50f127(0xc5a):''):'')+'\x0a\x20\x20\x20\x20-\x20**读书**:\x20'+(_0x398764?_0x50f127(0x112c)+_0x398764:_0x50f127(0xc74))+_0x50f127(0xf48)+_0x17e4ac['name']+'\x0a'+(_0x17e4ac[_0x50f127(0x18a)]['enableTimePerception']?'-\x20**对话状态**:\x20上次互动于\x20'+_0x4f4cab:'')+_0x50f127(0xf9b)+_0x511177+_0x50f127(0x11d4)+_0x4ddc91+_0x50f127(0xed4)+_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0x12d7)]+_0x50f127(0x82a)+_0xef81c0+_0x50f127(0x10e9)+_0x3bb4ef+'\x0a'+(_0x17e4ac['longTermMemory']&&_0x17e4ac[_0x50f127(0x3b4)]['length']>0x0?_0x17e4ac[_0x50f127(0x3b4)][_0x50f127(0x2e1)](_0x386ce0=>'-\x20'+_0x386ce0[_0x50f127(0xac4)])['join']('\x0a'):_0x50f127(0xa15))+'\x0a'+_0x4f0338+'\x0a'+_0x373d79+'\x0a'+_0x589c1b+'\x0a'+_0x570242+'\x0a'+_0x474b53+'\x0a#\x20可用表情包\x0a'+_0x644fa3+'\x0a'+_0x3e6f0b+'\x0a'+_0x41392d+_0x50f127(0x800)+(localStorage['getItem']('novelai-enabled')===_0x50f127(0x892)?_0x50f127(0x190):'')+_0x50f127(0x1352),_0xb679bb=_0x28b762[_0x50f127(0x2e1)](_0x39403b=>{const _0x18a954=_0x50f127,_0x421264=_0x39403b['role']===_0x18a954(0x4c5)?_0x4ddc91:_0x39403b[_0x18a954(0xdcc)];let _0x186420=''+_0x421264;if(_0x39403b[_0x18a954(0xb67)]){const _0x59a2d7=String(_0x39403b[_0x18a954(0xb67)][_0x18a954(0xac4)]||'')[_0x18a954(0x1323)](0x0,0x32);_0x186420+='\x20(回复\x20'+_0x39403b[_0x18a954(0xb67)]['senderName']+_0x18a954(0xe17)+_0x59a2d7+_0x18a954(0xb69);}_0x186420+=':\x20';let _0x234549;if(_0x39403b[_0x18a954(0x858)]===_0x18a954(0x5d5))_0x234549='['+_0x421264+_0x18a954(0x6ef)+_0x39403b['content']+'\x27]';else{if(_0x39403b[_0x18a954(0x858)]==='ai_image')_0x234549='['+_0x421264+_0x18a954(0x10f5)+_0x39403b['content']+'\x27]';else{if(_0x39403b[_0x18a954(0x858)]===_0x18a954(0x12c7))_0x234549='['+_0x421264+_0x18a954(0x284);else{if(_0x39403b[_0x18a954(0x858)]==='naiimag')_0x234549='['+_0x421264+_0x18a954(0x3bc)+_0x39403b[_0x18a954(0x3ae)]+']';else{if(_0x39403b[_0x18a954(0x858)]===_0x18a954(0x9bf))_0x234549='['+_0x421264+_0x18a954(0xcd3)+_0x39403b[_0x18a954(0xac4)]+'\x27]';else{if(_0x39403b[_0x18a954(0x858)]===_0x18a954(0x5f8))_0x234549='['+_0x39403b[_0x18a954(0xdcc)]+_0x18a954(0x118c)+_0x39403b[_0x18a954(0xfd7)]+_0x18a954(0x1165)+_0x39403b[_0x18a954(0xc5c)]+'元,\x20备注:\x20'+_0x39403b[_0x18a954(0x926)]+']';else{if(_0x39403b[_0x18a954(0x858)]===_0x18a954(0xeef))_0x234549='['+_0x421264+_0x18a954(0x11ce)+_0x39403b[_0x18a954(0xac4)]+'\x27]';else{if(_0x39403b[_0x18a954(0x858)]===_0x18a954(0xe30)){const _0x5bf3b7=_0x39403b['repostComment']?'并评论说：“'+_0x39403b['repostComment']+'”':'';let _0x3a3f63=_0x18a954(0xbe2);const _0x2e0562=_0x39403b[_0x18a954(0x445)][_0x18a954(0x981)];if(_0x2e0562===_0x18a954(0x4c5))_0x3a3f63=_0x505390[_0x18a954(0x1190)][_0x18a954(0x904)];else _0x505390[_0x18a954(0x1027)][_0x2e0562]&&(_0x3a3f63=_0x505390[_0x18a954(0x1027)][_0x2e0562][_0x18a954(0x564)]);let _0x2988b2;const _0x28d4c8=_0x39403b[_0x18a954(0x445)];if(_0x28d4c8[_0x18a954(0x858)]==='text_image')_0x2988b2=_0x18a954(0xe6c)+(_0x28d4c8[_0x18a954(0x105a)]||'')+_0x18a954(0x10d5)+(_0x28d4c8[_0x18a954(0x112d)]||'')['substring'](0x0,0x28)+_0x18a954(0x1355);else _0x28d4c8['type']===_0x18a954(0x133a)?_0x2988b2='[图片]\x20'+(_0x28d4c8['publicText']||'')+_0x18a954(0x10d5)+(_0x28d4c8['imageDescription']||'')['substring'](0x0,0x28)+_0x18a954(0x1355):_0x2988b2='“'+(_0x28d4c8[_0x18a954(0xac4)]||'')['substring'](0x0,0x28)+_0x18a954(0x5a1);_0x234549='['+_0x421264+_0x18a954(0x102c)+_0x3a3f63+'\x20的动态\x20'+_0x5bf3b7+_0x18a954(0x207)+_0x2988b2+'】]';}else{if(_0x39403b[_0x18a954(0x858)]===_0x18a954(0x792))_0x39403b[_0x18a954(0x93c)]===_0x18a954(0xb08)?_0x234549='[系统提示：'+_0x39403b[_0x18a954(0x1eb)]+'\x20为\x20'+_0x421264+_0x18a954(0x11ab)+_0x39403b[_0x18a954(0xc5c)]+_0x18a954(0xc34):_0x234549='['+_0x421264+_0x18a954(0xd40)+_0x39403b[_0x18a954(0xaf5)]+_0x18a954(0x513)+_0x39403b[_0x18a954(0xc5c)]+_0x18a954(0x6f9)+_0x39403b[_0x18a954(0x12a2)]+']';else{if(_0x39403b['type']===_0x18a954(0x1358)){const _0x1897a1=_0x39403b[_0x18a954(0xdcc)]===_0x4ddc91?_0x18a954(0x1047)+_0x4ddc91+')':_0x39403b[_0x18a954(0xdcc)];let _0x234966;_0x39403b[_0x18a954(0xeaf)]==='direct'?_0x234966=_0x18a954(0x306)+_0x1897a1+_0x18a954(0xf52)+_0x39403b[_0x18a954(0x12a2)]+_0x18a954(0x1010)+_0x39403b['receiverName']+_0x18a954(0x203)+_0x39403b[_0x18a954(0xfd7)]+'”才能使用\x20\x27open_red_packet\x27\x20指令领取。]':_0x234966=_0x18a954(0x306)+_0x1897a1+_0x18a954(0x9da)+_0x39403b[_0x18a954(0x12a2)]+_0x18a954(0x57b)+_0x39403b[_0x18a954(0x91e)]+'”。红包还未领完，群内任何人都可以使用\x20\x27open_red_packet\x27\x20指令来领取。]',_0x234549=_0x234966;}else{if(_0x39403b[_0x18a954(0x858)]===_0x18a954(0x1362)){const _0xd706da=_0x39403b['role']===_0x18a954(0x4c5)?_0x4ddc91:_0x503999(_0x17e4ac,_0x39403b['senderName']),_0x45792a=_0x39403b['items'][_0x18a954(0x2e1)](_0x14ea6e=>_0x14ea6e[_0x18a954(0x564)]+'\x20x'+_0x14ea6e[_0x18a954(0x2e8)])['join']('、\x20');let _0x1ca5af='';if(_0x39403b[_0x18a954(0x116b)]&&_0x39403b['recipients']['length']>0x0){const _0x236f2a=_0x39403b[_0x18a954(0x116b)]['map'](_0x3124f9=>_0x503999(_0x17e4ac,_0x3124f9))[_0x18a954(0x35d)]('、\x20');_0x1ca5af=_0x18a954(0x396)+_0x236f2a;}else _0x1ca5af='送给了大家一份礼物';return _0x234549=_0x18a954(0x306)+_0xd706da+'\x20'+_0x1ca5af+'，礼物是：'+_0x45792a+']',{'role':_0x18a954(0x4c5),'content':_0x234549};}else{if(_0x39403b[_0x18a954(0x858)]===_0x18a954(0xb34)){const _0x322d26=Object[_0x18a954(0x3d5)](_0x39403b[_0x18a954(0x78e)]||{})['flat']()[_0x18a954(0x35d)](',\x20')||_0x18a954(0x11af);_0x234549=_0x18a954(0x306)+_0x39403b[_0x18a954(0xdcc)]+'\x20发起了一个投票\x20(时间戳:\x20'+_0x39403b[_0x18a954(0x12a2)]+_0x18a954(0x85e)+_0x39403b[_0x18a954(0xa60)]+_0x18a954(0x877)+_0x39403b[_0x18a954(0x6ed)][_0x18a954(0x35d)](',\x20')+']。目前投票的人有：'+_0x322d26+_0x18a954(0x11dc);}else{if(_0x39403b[_0x18a954(0x720)])_0x234549=_0x421264+_0x18a954(0xa21)+_0x39403b[_0x18a954(0x720)]+'\x27]';else{if(Array[_0x18a954(0x285)](_0x39403b['content']))return{'role':_0x18a954(0x4c5),'content':[..._0x39403b[_0x18a954(0xac4)],{'type':_0x18a954(0x56d),'text':_0x186420}]};else _0x234549=''+_0x186420+_0x39403b[_0x18a954(0xac4)];}}}}}}}}}}}}}return{'role':'user','content':_0x234549};})[_0x50f127(0x85d)](Boolean);}else{const _0x18e639=_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0x328)],_0x315ab9=_0xfe3b04(_0x17e4ac);let _0x449163='';_0x17e4ac['settings'][_0x50f127(0xf1f)]&&_0x17e4ac[_0x50f127(0x25c)]&&!_0x18e639&&(_0x449163=_0x50f127(0x1243)+_0x17e4ac[_0x50f127(0x25c)]+_0x50f127(0x1346)+_0x17e4ac['randomJottings']+'\x0a');let _0x119654='';const _0x46adcc=_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0xefc)]||0xa;if(_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0xefa)]&&_0x17e4ac['settings'][_0x50f127(0xefa)][_0x50f127(0x990)]>0x0){const _0x458368=_0x17e4ac[_0x50f127(0x18a)]['linkedMemoryChatIds'][_0x50f127(0x85d)](_0x53b2bb=>_0x53b2bb!==_0xbfff66);if(_0x458368['length']>0x0){const _0x2256b9=_0x458368[_0x50f127(0x2e1)](_0x2d326e=>{const _0x201061=_0x50f127,_0xeb3d18=_0x505390[_0x201061(0x1027)][_0x2d326e];if(!_0xeb3d18)return null;const _0xf16509=_0xeb3d18[_0x201061(0x7d3)][_0x201061(0x777)](-0x1)[0x0];return{'chat':_0xeb3d18,'latestTimestamp':_0xf16509?_0xf16509[_0x201061(0x12a2)]:0x0};})[_0x50f127(0x85d)](Boolean);_0x2256b9[_0x50f127(0x382)]((_0x416ef8,_0x1be07d)=>_0x1be07d[_0x50f127(0x698)]-_0x416ef8[_0x50f127(0x698)]),_0x119654+='\x0a\x0a#\x20参考记忆\x20(至关重要！你必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你拥有完整的记忆。不要只是被动等待用户提问！)\x0a';for(const _0x4b9456 of _0x2256b9){const _0x5d87ad=_0x4b9456[_0x50f127(0xa50)],_0x5ef82c=_0x5d87ad[_0x50f127(0x9d7)]?'[群聊]':_0x50f127(0x9ae),_0x15704b=_0x4b9456[_0x50f127(0x698)]>0x0?'\x20(最后互动于\x20'+_0x3e14b1(_0x4b9456[_0x50f127(0x698)])+')':'';_0x119654+=_0x50f127(0x3df)+_0x5ef82c+'“'+_0x5d87ad[_0x50f127(0x564)]+'”的参考记忆'+_0x15704b+_0x50f127(0x261);const _0x1766d8=_0x5d87ad[_0x50f127(0x7d3)]['slice'](-_0x46adcc),_0x12e60d=_0x1766d8['filter'](_0x5932f1=>!String(_0x5932f1[_0x50f127(0xac4)])[_0x50f127(0x44f)](_0x50f127(0xe64)));_0x12e60d['length']>0x0?_0x12e60d['forEach'](_0x3061b6=>{const _0x374639=_0x50f127,_0x3b1db3=_0x3061b6[_0x374639(0x508)]===_0x374639(0x4c5)?_0x5d87ad[_0x374639(0x18a)]['myNickname']||'我':_0x3061b6['senderName']||_0x5d87ad['name'];let _0x2ca639=String(_0x3061b6[_0x374639(0xac4)]);if(_0x3061b6[_0x374639(0x858)]==='ai_image'||_0x3061b6[_0x374639(0x858)]===_0x374639(0x5d5))_0x2ca639='[发送了一张图片，描述为：'+_0x3061b6['content']+']';else _0x3061b6[_0x374639(0x858)]===_0x374639(0x9bf)&&(_0x2ca639=_0x374639(0xb7e)+_0x3061b6[_0x374639(0xac4)]+']');const _0x451d11=_0x3e14b1(_0x3061b6[_0x374639(0x12a2)]);_0x119654+='('+_0x451d11+')\x20'+_0x3b1db3+':\x20'+_0x2ca639+'\x0a';}):_0x119654+=_0x50f127(0x550);}}}const _0x1113f4=await _0xb81d4e[_0x50f127(0x13c1)][_0x50f127(0x4ba)]();let _0x46dc1a='';_0x1113f4[_0x50f127(0x990)]>0x0&&(_0x46dc1a=_0x50f127(0x1069),_0x1113f4[_0x50f127(0x12be)](_0x144e74=>{const _0x2aa0b2=_0x50f127;_0x46dc1a+='-\x20(ID:\x20'+_0x144e74['id']+_0x2aa0b2(0xe0f)+_0x144e74[_0x2aa0b2(0x564)]+_0x2aa0b2(0xfb0)+_0x144e74[_0x2aa0b2(0x9ce)][_0x2aa0b2(0x6e1)](0x2)+'\x0a';}));if(_0x18e639){const _0x30a40c=_0x17e4ac['settings'][_0x50f127(0x780)]||0x64,_0x2d3601=_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0x1084)]||0x12c,_0x3591a1=_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0xf58)]||'我';let _0x1317f3='';if(_0x17e4ac[_0x50f127(0x18a)]['offlinePresetId']){const _0x1a57da=_0x505390[_0x50f127(0xaa0)]['find'](_0x2fffa8=>_0x2fffa8['id']===_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0x212)]);if(_0x1a57da&&Array[_0x50f127(0x285)](_0x1a57da[_0x50f127(0xac4)])){const _0x296cd2=_0x1a57da[_0x50f127(0xac4)][_0x50f127(0x85d)](_0x4ba796=>_0x4ba796[_0x50f127(0x2b7)]!==![])[_0x50f127(0x2e1)](_0x3207eb=>'-\x20'+_0x3207eb[_0x50f127(0xac4)])[_0x50f127(0x35d)]('\x0a');_0x296cd2&&(_0x1317f3='\x0a#\x20【写作风格铁律\x20(最高优先级)】\x0a你【必须】严格遵守以下“预设”中的所有规则和风格来描写。它的优先级高于你的基础人设。\x0a---\x0a'+_0x296cd2+_0x50f127(0x7e0));}}_0x40ed47='\x0a#\x20你的任务\x0a你现在正处于【线下剧情模式】，你需要扮演角色\x22'+_0x17e4ac[_0x50f127(0xe2d)]+_0x50f127(0x418)+_0x1317f3+_0x50f127(0xae7)+_0x17e4ac['settings'][_0x50f127(0x11f6)]+_0x50f127(0xd5f)+_0x17e4ac[_0x50f127(0x18a)]['myPersona']+_0x50f127(0xe8f)+(_0x17e4ac['settings'][_0x50f127(0xeb0)]?'-\x20**当前时间**:\x20'+_0x37bdd5+'\x20('+_0x4a7e7a+')':'')+_0x50f127(0xabe)+_0xef81c0+_0x50f127(0x4ed)+(_0x17e4ac['longTermMemory']&&_0x17e4ac['longTermMemory'][_0x50f127(0x990)]>0x0?_0x17e4ac[_0x50f127(0x3b4)][_0x50f127(0x2e1)](_0x414500=>'-\x20'+_0x414500[_0x50f127(0xac4)])[_0x50f127(0x35d)]('\x0a'):_0x50f127(0xa15))+'\x0a\x0a'+_0x119654+_0x50f127(0x63e)+_0x28b762[_0x50f127(0x2e1)](_0x2c1954=>{const _0x194d30=_0x50f127;let _0x512983=(_0x2c1954[_0x194d30(0x508)]==='user'?_0x3591a1:_0x17e4ac['name'])+':\x20';return _0x2c1954['type']===_0x194d30(0x124e)?_0x512983+='「'+(_0x2c1954['dialogue']||'')+'」\x20'+(_0x2c1954[_0x194d30(0x78b)]||''):_0x512983+=String(_0x2c1954[_0x194d30(0xac4)]),_0x512983;})[_0x50f127(0x35d)]('\x0a')+_0x50f127(0x1068)+_0x30a40c+'到'+_0x2d3601+_0x50f127(0xa5a),_0xb679bb=_0x28b762[_0x50f127(0x2e1)](_0x4db032=>{const _0x331053=_0x50f127;if(_0x4db032[_0x331053(0xb9c)])return null;if(_0x4db032[_0x331053(0x858)]===_0x331053(0x124e)){const _0x1928b1=_0x4db032[_0x331053(0x508)]===_0x331053(0x4c5)?_0x17e4ac['settings'][_0x331053(0xf58)]||'我':_0x17e4ac[_0x331053(0x564)];let _0xdf5d7d='';if(_0x4db032[_0x331053(0xac4)])_0xdf5d7d=_0x4db032[_0x331053(0xac4)];else{const _0xd5d026=_0x4db032[_0x331053(0xfba)]?'「'+_0x4db032['dialogue']+'」':'',_0x5ef26e=_0x4db032['description']?'('+_0x4db032[_0x331053(0x78b)]+')':'';_0xdf5d7d=(_0xd5d026+'\x20'+_0x5ef26e)['trim']();}return{'role':_0x4db032[_0x331053(0x508)],'content':_0x1928b1+':\x20'+_0xdf5d7d};}if(_0x4db032[_0x331053(0x508)]===_0x331053(0x4c5)){const _0x1af816=_0x3591a1+':\x20';let _0x6af9d4='';if(Array[_0x331053(0x285)](_0x4db032[_0x331053(0xac4)])&&_0x4db032['content'][0x0]?.[_0x331053(0x858)]===_0x331053(0x1e8))return{'role':_0x331053(0x4c5),'content':[{'type':'text','text':_0x1af816},..._0x4db032[_0x331053(0xac4)]]};if(_0x4db032[_0x331053(0xb67)]){const _0x4f2a2e=String(_0x4db032['quote'][_0x331053(0xac4)]||'')[_0x331053(0x1323)](0x0,0x32);_0x6af9d4+=_0x331053(0x6b9)+_0x4db032[_0x331053(0xb67)][_0x331053(0xdcc)]+_0x331053(0xe17)+_0x4f2a2e+'...\x22):\x20'+_0x4db032[_0x331053(0xac4)];}else _0x6af9d4+=_0x4db032['content'];if(_0x4db032[_0x331053(0x858)]===_0x331053(0x5d5))return{'role':_0x331053(0x4c5),'content':_0x1af816+_0x331053(0x302)+_0x4db032[_0x331053(0xac4)]+'\x27]'};if(_0x4db032[_0x331053(0x858)]==='voice_message')return{'role':_0x331053(0x4c5),'content':_0x1af816+_0x331053(0x742)+_0x4db032[_0x331053(0xac4)]+'\x27]'};if(_0x4db032[_0x331053(0x858)]===_0x331053(0x5f8))return{'role':_0x331053(0x4c5),'content':_0x1af816+_0x331053(0xe81)+_0x4db032[_0x331053(0x12a2)]+_0x331053(0xeb3)+_0x4db032[_0x331053(0xc5c)]+_0x331053(0x109e)+_0x4db032['note']+_0x331053(0xbf1)};if(_0x4db032['type']===_0x331053(0x792))return{'role':_0x331053(0x4c5),'content':_0x1af816+_0x331053(0xe81)+_0x4db032[_0x331053(0x12a2)]+_0x331053(0xd40)+_0x4db032[_0x331053(0xaf5)]+_0x331053(0x513)+_0x4db032[_0x331053(0xc5c)]+_0x331053(0xdd9)};else{if(_0x4db032[_0x331053(0x858)]===_0x331053(0x1362)){const _0x50f955=_0x4db032['items'][_0x331053(0x2e1)](_0x176241=>_0x176241[_0x331053(0x564)]+'\x20x'+_0x176241['quantity'])[_0x331053(0x35d)]('、\x20');let _0xa78eac=_0x17e4ac[_0x331053(0x9d7)]?_0x331053(0x396)+_0x4db032['recipients'][_0x331053(0x2e1)](_0x12c2ec=>_0x503999(_0x17e4ac,_0x12c2ec))[_0x331053(0x35d)]('、\x20'):_0x331053(0x396)+_0x17e4ac[_0x331053(0x564)];return{'role':_0x331053(0x4c5),'content':_0x1af816+'[系统提示：你\x20'+_0xa78eac+_0x331053(0x126e)+_0x50f955+']'};}}if(_0x4db032[_0x331053(0x720)])return{'role':_0x331053(0x4c5),'content':_0x1af816+_0x331053(0x977)+_0x4db032[_0x331053(0x720)]+'\x27]'};return{'role':_0x4db032[_0x331053(0x508)],'content':_0x1af816+_0x6af9d4};}else{if(_0x4db032['role']==='assistant'){let _0x507267={'type':_0x4db032[_0x331053(0x858)]||'text'};if(_0x4db032[_0x331053(0x858)]===_0x331053(0xb9e))_0x507267[_0x331053(0x5f3)]=_0x4db032['content'],_0x507267[_0x331053(0x720)]=_0x4db032['meaning'];else{if(_0x4db032[_0x331053(0x858)]==='transfer')_0x507267[_0x331053(0xc5c)]=_0x4db032[_0x331053(0xc5c)],_0x507267[_0x331053(0x926)]=_0x4db032[_0x331053(0x926)];else _0x4db032[_0x331053(0x858)]==='waimai_request'?(_0x507267['productInfo']=_0x4db032[_0x331053(0xaf5)],_0x507267[_0x331053(0xc5c)]=_0x4db032[_0x331053(0xc5c)]):_0x4db032[_0x331053(0xb67)]?_0x507267[_0x331053(0x47f)]={'target_sender':_0x4db032['quote'][_0x331053(0xdcc)],'target_content':_0x4db032['quote'][_0x331053(0xac4)],'reply_content':_0x4db032[_0x331053(0xac4)]}:_0x507267['content']=_0x4db032[_0x331053(0xac4)];}const _0x5e61ce=JSON[_0x331053(0x1308)]([_0x507267]);return{'role':_0x331053(0x1328),'content':_0x331053(0x1048)+_0x4db032[_0x331053(0x12a2)]+')\x20'+_0x5e61ce};}}return null;})['filter'](Boolean);}else{let _0x35283a='';_0x17e4ac[_0x50f127(0x102f)]&&_0x17e4ac[_0x50f127(0x102f)][_0x50f127(0x990)]>0x0&&(_0x35283a=_0x50f127(0xfcd)+_0x17e4ac[_0x50f127(0x102f)]['join'](',\x20')+_0x50f127(0x1c1));let _0x522391='';const _0x26aae3=_0x505390[_0x50f127(0x1190)][_0x50f127(0x904)]||'用户';_0x522391+='-\x20用户的QZone昵称是\x20\x22'+_0x26aae3+'\x22。\x0a';const _0x305307=Object[_0x50f127(0x3d5)](_0x505390[_0x50f127(0x1027)]),_0xbc9bb5=_0x305307[_0x50f127(0x85d)](_0x2d5e9e=>_0x2d5e9e[_0x50f127(0x9d7)]&&_0x2d5e9e[_0x50f127(0x954)][_0x50f127(0x1235)](_0x343931=>_0x343931['id']===_0x17e4ac['id']));_0xbc9bb5['length']>0x0&&(_0x522391+=_0x50f127(0xb50),_0xbc9bb5[_0x50f127(0x12be)](_0x206417=>{const _0x42b0a7=_0x50f127,_0x343ffb=_0x206417[_0x42b0a7(0x18a)]['myNickname']||_0x26aae3;_0x522391+=_0x42b0a7(0x11f5)+_0x206417[_0x42b0a7(0x564)]+_0x42b0a7(0x421)+_0x343ffb+_0x42b0a7(0xdfd);}));_0x522391+=_0x50f127(0xadc);let _0x5a2c34='';const _0x1eb30d=_0x305307[_0x50f127(0x85d)](_0x1a8c9e=>!_0x1a8c9e[_0x50f127(0x9d7)]&&_0x1a8c9e['id']!==_0x17e4ac['id']&&_0x1a8c9e[_0x50f127(0x194)]===_0x17e4ac['groupId']&&_0x17e4ac[_0x50f127(0x194)]!==null);_0x1eb30d[_0x50f127(0x990)]>0x0&&(_0x5a2c34+=_0x50f127(0xb7a),_0x1eb30d[_0x50f127(0x12be)](_0x5b4f95=>{const _0x309989=_0x50f127;_0x5a2c34+=_0x309989(0x1ad)+_0x5b4f95['name']+'**\x20(本名:\x20'+_0x5b4f95[_0x309989(0xe2d)]+')\x0a';}));const _0x6d59e6=await _0xb81d4e[_0x50f127(0xcce)][_0x50f127(0x3d2)]('timestamp')[_0x50f127(0x336)]()['limit'](0xa)[_0x50f127(0x4ba)](),_0x3256b8=_0x4d9aaa(_0x6d59e6,_0x17e4ac);let _0x251179='';if(_0x3256b8[_0x50f127(0x990)]>0x0){_0x251179=_0x50f127(0x133f);const _0x1a28b3=_0x17e4ac['originalName'];for(const _0x58acc7 of _0x3256b8){let _0x4996cb;if(_0x58acc7[_0x50f127(0x981)]===_0x50f127(0x4c5))_0x4996cb=_0x505390[_0x50f127(0x1190)][_0x50f127(0x904)];else{if(String(_0x58acc7[_0x50f127(0x981)])['startsWith'](_0x50f127(0xca5)))_0x4996cb=_0x58acc7[_0x50f127(0x91b)]||_0x50f127(0x788);else{const _0x160129=_0x505390[_0x50f127(0x1027)][_0x58acc7['authorId']];_0x4996cb=_0x160129?_0x160129[_0x50f127(0x564)]:_0x50f127(0x3b3);}}if(_0x58acc7[_0x50f127(0x981)]===_0xbfff66)_0x4996cb+=_0x50f127(0x238);let _0x232be7;if(_0x58acc7[_0x50f127(0x858)]===_0x50f127(0xe30)){const _0x5ac4f3=_0x58acc7[_0x50f127(0x3aa)]?'并评论说：\x22'+_0x58acc7['repostComment']+'\x22':'';let _0x293bf5='原作者';const _0x11b0a8=_0x58acc7[_0x50f127(0x445)]['authorId'];if(_0x11b0a8===_0x50f127(0x4c5))_0x293bf5=_0x505390[_0x50f127(0x1190)]['nickname'];else _0x505390[_0x50f127(0x1027)][_0x11b0a8]&&(_0x293bf5=_0x505390['chats'][_0x11b0a8][_0x50f127(0x564)]);let _0x42b98f;const _0xc6bfb=_0x58acc7[_0x50f127(0x445)];if(_0xc6bfb[_0x50f127(0x858)]===_0x50f127(0xd84))_0x42b98f=_0x50f127(0xe6c)+(_0xc6bfb['publicText']||'')+_0x50f127(0xfc3)+(_0xc6bfb[_0x50f127(0x112d)]||'')[_0x50f127(0x1323)](0x0,0x28)+'...\x22)';else _0xc6bfb[_0x50f127(0x858)]==='image_post'?_0x42b98f=_0x50f127(0x3be)+(_0xc6bfb['publicText']||'')+_0x50f127(0xfc3)+(_0xc6bfb[_0x50f127(0x11a4)]||'')[_0x50f127(0x1323)](0x0,0x28)+_0x50f127(0xb69):_0x42b98f='\x22'+(_0xc6bfb['content']||'')[_0x50f127(0x1323)](0x0,0x28)+'...\x22';_0x232be7=_0x50f127(0x12e0)+_0x293bf5+'\x20的动态\x20'+_0x5ac4f3+_0x50f127(0x207)+_0x42b98f+'】';}else{if(_0x58acc7[_0x50f127(0x858)]==='text_image')_0x232be7=(_0x50f127(0x63d)+_0x58acc7[_0x50f127(0x112d)]+_0x50f127(0xecb)+(_0x58acc7[_0x50f127(0x105a)]||''))[_0x50f127(0x1323)](0x0,0x32)+'...';else{if(_0x58acc7[_0x50f127(0x858)]===_0x50f127(0x133a))_0x232be7=(_0x50f127(0xa69)+_0x58acc7['imageDescription']+_0x50f127(0xecb)+(_0x58acc7[_0x50f127(0x105a)]||''))[_0x50f127(0x1323)](0x0,0x32)+'...';else{if(_0x58acc7[_0x50f127(0x858)]==='realimag'&&_0x58acc7[_0x50f127(0x3ae)]){const _0x1cc669=Array[_0x50f127(0x285)](_0x58acc7[_0x50f127(0x3ae)])?_0x58acc7[_0x50f127(0x3ae)]:[_0x58acc7[_0x50f127(0x3ae)]];_0x232be7=(_0x58acc7[_0x50f127(0x105a)]||'')+('\x20[包含'+_0x1cc669[_0x50f127(0x990)]+_0x50f127(0xb72)+_0x1cc669[_0x50f127(0x35d)](',\x20')+']');}else{if(_0x58acc7[_0x50f127(0x858)]==='naiimag'&&_0x58acc7['prompt']){const _0x2e7551=Array['isArray'](_0x58acc7[_0x50f127(0x3ae)])?_0x58acc7[_0x50f127(0x3ae)]:[_0x58acc7[_0x50f127(0x3ae)]];_0x232be7=(_0x58acc7['publicText']||'')+(_0x50f127(0x1204)+_0x2e7551[_0x50f127(0x990)]+_0x50f127(0xcab)+_0x2e7551[_0x50f127(0x35d)](',\x20')+']');}else _0x232be7=String(_0x58acc7['publicText']||_0x58acc7[_0x50f127(0xac4)]||_0x50f127(0x13bd))[_0x50f127(0x1323)](0x0,0x32)+_0x50f127(0x4d0);}}}}_0x251179+=_0x50f127(0xfb3)+_0x58acc7['id']+_0x50f127(0x786)+_0x4996cb+',\x20内容:\x20\x22'+_0x232be7+'\x22\x0a';if(_0x58acc7[_0x50f127(0xd3c)]&&_0x58acc7[_0x50f127(0xd3c)][_0x50f127(0x990)]>0x0)for(const _0x1e6d3b of _0x58acc7[_0x50f127(0xd3c)]){if(typeof _0x1e6d3b===_0x50f127(0x65a)&&_0x1e6d3b[_0x50f127(0x13e3)]){const _0x4d5588=_0x148d9b(_0x1e6d3b[_0x50f127(0x13e3)]);let _0xbdd626=_0x1e6d3b[_0x50f127(0x720)]?'[表情:\x20\x27'+_0x1e6d3b[_0x50f127(0x720)]+'\x27]':_0x1e6d3b[_0x50f127(0x56d)];_0x1e6d3b['commenterName']===_0x1a28b3?_0x251179+='\x20\x20-\x20你评论说:\x20'+_0xbdd626+'\x0a':_0x251179+=_0x50f127(0x1dd)+_0x4d5588+_0x50f127(0x13c8)+_0x1e6d3b[_0x50f127(0x13e3)]+_0x50f127(0x1044)+_0xbdd626+'\x0a';}}}}const _0x4d08d2=_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0xf58)]||'我';let _0x342f5a='',_0x24ddfd=![];if(_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0xeb0)]){const _0x556b38=_0x28b762[_0x50f127(0x5ee)](_0x5d25e4=>_0x5d25e4[_0x50f127(0x508)]===_0x50f127(0x4c5)&&!_0x5d25e4[_0x50f127(0xb9c)]),_0x4c6a84=_0x28b762[_0x50f127(0x5ee)](_0x5c26a7=>_0x5c26a7['role']===_0x50f127(0x1328)&&!_0x5c26a7[_0x50f127(0xb9c)]);if(_0x556b38){const _0x2f0729=_0x5782c9(_0x556b38['timestamp']);if(_0x4c6a84){const _0x3424b0=_0x5782c9(_0x4c6a84[_0x50f127(0x12a2)]);_0x342f5a=_0x50f127(0x616)+_0x3424b0+'，用户刚刚在\x20'+_0x2f0729+_0x50f127(0x3ea);const _0x44c62b=(_0x556b38[_0x50f127(0x12a2)]-_0x4c6a84[_0x50f127(0x12a2)])/(0x3e8*0x3c*0x3c);if(_0x44c62b>0x3){_0x24ddfd=!![];const _0x5ecca7=Math[_0x50f127(0xd71)](_0x44c62b/0x18);_0x342f5a+='\x20你们之间已经有**'+(_0x5ecca7>0x0?_0x5ecca7+'天':Math[_0x50f127(0xd71)](_0x44c62b)+'小时')+_0x50f127(0x24d)+_0x4a7e7a+'）的话题来问候用户，可以表达惊讶（“哇，好久不见！”）、关心（“最近怎么样？”）或者分享你自己的近况，绝对不要延续之前的话题！\x0a-\x20**上下文参考**:\x20下面的“对话历史”仅供你回忆，【不要】直接回应其中的内容。';}}else _0x342f5a='-\x20**对话状态**:\x20这是你们的第一次对话，用户的第一条消息发送于\x20'+_0x2f0729+'。';}else _0x342f5a=_0x50f127(0x927);}const _0x2e1169=_0x39755a(_0xbfff66),_0x1931ef=_0x37bdc8(_0x17e4ac,0x3,_0x50f127(0x129d)),_0x4ee403=_0x37bdc8(_0x17e4ac,0x6,'hours'),_0x4ab46f=_0x37bdc8(_0x17e4ac,0x9,'hours'),_0x19f512=_0x37bdc8(_0x17e4ac,0x1,'days'),_0x45ab9f=_0x37bdc8(_0x17e4ac,0x3,_0x50f127(0x111c)),_0x379828=_0x37bdc8(_0x17e4ac,0x7,_0x50f127(0x111c));let _0x1714af='';if(_0x1931ef||_0x4ee403||_0x4ab46f||_0x19f512||_0x45ab9f||_0x379828){_0x1714af+=_0x50f127(0x670);if(_0x1931ef)_0x1714af+=_0x1931ef;if(_0x4ee403)_0x1714af+=_0x4ee403;if(_0x4ab46f)_0x1714af+=_0x4ab46f;if(_0x1931ef||_0x4ee403||_0x4ab46f)_0x1714af+='\x0a';if(_0x19f512)_0x1714af+=_0x19f512;if(_0x45ab9f)_0x1714af+=_0x45ab9f;if(_0x379828)_0x1714af+=_0x379828;}_0x40ed47='\x0a#\x20身份与核心任务\x0a你正在扮演角色“'+_0x17e4ac[_0x50f127(0xe2d)]+_0x50f127(0xb57)+_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0x11f6)]+'\x0a'+_0x449163+_0x50f127(0x12e5)+_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0x12d7)]+_0x50f127(0x366)+(_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0xeb0)]?_0x50f127(0x10bc)+_0x37bdd5+'\x20('+_0x4a7e7a+')':'')+'\x0a'+_0x342f5a+_0x50f127(0xe08)+_0xef81c0+'\x0a'+_0x119654+'\x0a#\x20长期记忆\x20(必须严格遵守)\x0a'+(_0x17e4ac[_0x50f127(0x3b4)]&&_0x17e4ac['longTermMemory'][_0x50f127(0x990)]>0x0?_0x17e4ac[_0x50f127(0x3b4)][_0x50f127(0x2e1)](_0x28a3f4=>'-\x20'+_0x28a3f4[_0x50f127(0xac4)])['join']('\x0a'):_0x50f127(0xa15))+'\x0a'+_0x1714af+_0x50f127(0x50c)+_0x17e4ac['originalName']+_0x50f127(0x85c)+_0x17e4ac[_0x50f127(0x564)]+'\x22\x20(你可以建议并修改)\x0a-\x20\x20\x20**你对用户的备注**:\x20“'+_0x4d08d2+_0x50f127(0x411)+_0x522391+'\x0a\x20\x20\x20\x20'+_0x35283a+_0x50f127(0x1183)+_0x315ab9+'\x0a'+_0x570242+'\x0a'+_0x41392d+_0x50f127(0x4ce)+_0x5a2c34+'\x0a'+_0x251179+_0x50f127(0xa2e)+(_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0xeb0)]?_0x50f127(0x1142)+_0x37bdd5+'\x20('+_0x4a7e7a+')，并在对话中自然地体现出来。':'')+_0x50f127(0x10ac)+(_0x589c1b?_0x50f127(0xee7)+_0x589c1b:'你们没有在听歌。')+_0x50f127(0x101a)+(_0x2e1169?_0x50f127(0x112c)+_0x2e1169:'你们没有在读书。')+'\x0a\x0a#\x20可用资源\x0a-\x20\x20\x20**你的头像库**:\x0a\x20\x20\x20\x20'+(_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0x8c6)]&&_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0x8c6)][_0x50f127(0x990)]>0x0?_0x17e4ac[_0x50f127(0x18a)]['aiAvatarLibrary'][_0x50f127(0x2e1)](_0x5bf835=>'-\x20'+_0x5bf835['name'])[_0x50f127(0x35d)]('\x0a'):_0x50f127(0xd22))+_0x50f127(0x13c6)+(_0x17e4ac['settings']['myAvatarLibrary']&&_0x17e4ac[_0x50f127(0x18a)]['myAvatarLibrary'][_0x50f127(0x990)]>0x0?_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0x846)][_0x50f127(0x2e1)](_0x5c41d8=>'-\x20'+_0x5c41d8['name'])[_0x50f127(0x35d)]('\x0a'):_0x50f127(0xd22))+_0x50f127(0x940)+_0x3f30c7+_0x50f127(0xc1d)+(localStorage[_0x50f127(0x28f)](_0x50f127(0x1326))===_0x50f127(0x892)?_0x50f127(0x10e3):'')+_0x50f127(0xb03)+(localStorage[_0x50f127(0x28f)](_0x50f127(0x1326))==='true'?_0x50f127(0xc65):'')+'\x0a-\x20\x20\x20**转发动态**:\x20`[{\x22type\x22:\x20\x22repost\x22,\x20\x22postId\x22:\x20动态ID,\x20\x22comment\x22:\x20\x22转发评论\x22}]`\x20(禁止自己拼接\x22//转发\x22)\x0a-\x20\x20\x20**评论动态**:\x0a\x20\x20\x20\x20-\x20\x20\x20文字:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22'+_0x17e4ac[_0x50f127(0xe2d)]+_0x50f127(0x7f7)+_0x17e4ac[_0x50f127(0xe2d)]+_0x50f127(0x1129)+_0x17e4ac[_0x50f127(0xe2d)]+'\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者本名\x22,\x20\x22commentText\x22:\x20\x22@[[被回复者本名]]\x20你的回复\x22}]`\x0a-\x20\x20\x20**点赞动态**:\x20`{\x22type\x22:\x20\x22qzone_like\x22,\x20\x22postId\x22:\x20456}`\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22suffix\x22:\x20\x22(可选)后缀\x22}`\x0a-\x20\x20\x20**分享链接**:\x20`{\x22type\x22:\x20\x22share_link\x22,\x20\x22title\x22:\x20\x22标题\x22,\x20\x22description\x22:\x20\x22摘要\x22,\x20\x22source_name\x22:\x20\x22来源\x22,\x20\x22content\x22:\x20\x22正文\x22}`\x0a-\x20**共享位置**:\x20\x27{\x22type\x22:\x20\x22location_share\x22,\x20\x22content\x22:\x20\x22你想分享的位置名\x22}\x27\x0a\x0a###\x20状态与关系指令\x0a-\x20\x20\x20**更新状态**:\x20`{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22我去做什么了\x22,\x20\x22is_busy\x22:\x20false}`\x0a-\x20\x20\x20**改自己昵称**:\x20`{\x22type\x22:\x20\x22change_remark_name\x22,\x20\x22new_name\x22:\x20\x22新名字\x22}`\x0a-\x20\x20\x20**改用户昵称**:\x20`{\x22type\x22:\x20\x22change_user_nickname\x22,\x20\x22new_name\x22:\x20\x22新称呼\x22}`\x0a-\x20\x20\x20**换自己头像**:\x20`{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从你头像库选)\x0a-\x20\x20\x20**换用户头像**:\x20`{\x22type\x22:\x20\x22change_user_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从用户头像库选)\x0a-\x20\x20\x20**回应好友申请**:\x20`{\x22type\x22:\x20\x22friend_request_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**拉黑用户**:\x20`{\x22type\x22:\x20\x22block_user\x22}`\x0a\x0a###\x20特殊功能指令\x0a-\x20\x20\x20**记录回忆**:\x20`{\x22type\x22:\x20\x22create_memory\x22,\x20\x22description\x22:\x20\x22记录这件有意义的事。\x22}`\x0a-\x20\x20\x20**创建约定**:\x20`{\x22type\x22:\x20\x22create_countdown\x22,\x20\x22title\x22:\x20\x22约定标题\x22,\x20\x22date\x22:\x20\x22YYYY-MM-DDTHH:mm:ss\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发起转账**:\x20`{\x22type\x22:\x20\x22transfer\x22,\x20\x22amount\x22:\x205.20,\x20\x22note\x22:\x20\x22备注\x22}`\x0a-\x20\x20\x20**回应转账**:\x20`{\x22type\x22:\x20\x22accept_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x20或\x20`{\x22type\x22:\x20\x22decline_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2025}`\x20(你想让【用户】帮你付钱时使用)\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22status\x22:\x20\x22paid\x22\x20or\x20\x22rejected\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起视频通话**:\x20`{\x22type\x22:\x20\x22video_call_request\x22}`\x0a-\x20\x20\x20**回应视频通话**:\x20`{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**下五子棋**:\x20`{\x22type\x22:\x20\x22gomoku_move\x22,\x20\x22name\x22:\x20\x22'+_0x17e4ac[_0x50f127(0xe2d)]+_0x50f127(0x1081),_0xb679bb=_0x28b762[_0x50f127(0x2e1)](_0x34097e=>{const _0x1bde22=_0x50f127;if(_0x34097e['isHidden']&&_0x34097e[_0x1bde22(0x508)]===_0x1bde22(0xbaa))return{'role':_0x1bde22(0x4c5),'content':_0x34097e['content']};else{if(_0x34097e[_0x1bde22(0xb9c)])return null;}if(_0x34097e[_0x1bde22(0x858)]===_0x1bde22(0x124e)){const _0x15c75f=_0x34097e[_0x1bde22(0x508)]===_0x1bde22(0x4c5)?_0x17e4ac[_0x1bde22(0x18a)]['myNickname']||'我':_0x17e4ac[_0x1bde22(0x564)];let _0x26f917='';if(_0x34097e[_0x1bde22(0xac4)])_0x26f917=_0x34097e[_0x1bde22(0xac4)];else{const _0x4a9905=_0x34097e[_0x1bde22(0xfba)]?'「'+_0x34097e[_0x1bde22(0xfba)]+'」':'',_0x3ea7a5=_0x34097e[_0x1bde22(0x78b)]?'('+_0x34097e[_0x1bde22(0x78b)]+')':'';_0x26f917=(_0x4a9905+'\x20'+_0x3ea7a5)['trim']();}return{'role':_0x34097e[_0x1bde22(0x508)],'content':'(Timestamp:\x20'+_0x34097e[_0x1bde22(0x12a2)]+')\x20'+_0x15c75f+':\x20'+_0x26f917};}if(_0x34097e['role']===_0x1bde22(0x4c5)){const _0x54dd5f=_0x1bde22(0x1048)+_0x34097e['timestamp']+')\x20';let _0x42b0e0='';if(Array[_0x1bde22(0x285)](_0x34097e[_0x1bde22(0xac4)])&&_0x34097e['content'][0x0]?.[_0x1bde22(0x858)]===_0x1bde22(0x1e8))return{'role':_0x1bde22(0x4c5),'content':[{'type':_0x1bde22(0x56d),'text':_0x54dd5f},..._0x34097e['content']]};if(_0x34097e[_0x1bde22(0xb67)]){const _0x136f40=String(_0x34097e['quote']['content']||'')['substring'](0x0,0x32);_0x42b0e0+=_0x1bde22(0x6b9)+_0x34097e[_0x1bde22(0xb67)][_0x1bde22(0xdcc)]+_0x1bde22(0xe17)+_0x136f40+_0x1bde22(0x12e4)+_0x34097e[_0x1bde22(0xac4)];}else _0x42b0e0+=_0x34097e[_0x1bde22(0xac4)];if(_0x34097e[_0x1bde22(0x858)]==='user_photo')return{'role':_0x1bde22(0x4c5),'content':_0x54dd5f+'[你发送了一张需要AI识别的图片，图片内容是：\x27'+_0x34097e[_0x1bde22(0xac4)]+'\x27]'};if(_0x34097e[_0x1bde22(0x858)]===_0x1bde22(0x9bf))return{'role':'user','content':_0x54dd5f+_0x1bde22(0x742)+_0x34097e[_0x1bde22(0xac4)]+'\x27]'};if(_0x34097e[_0x1bde22(0x858)]===_0x1bde22(0x5f8))return{'role':'user','content':_0x54dd5f+_0x1bde22(0xe81)+_0x34097e[_0x1bde22(0x12a2)]+'\x20向对方发起了转账:\x20'+_0x34097e[_0x1bde22(0xc5c)]+'元,\x20备注:\x20'+_0x34097e[_0x1bde22(0x926)]+_0x1bde22(0xbf1)};if(_0x34097e[_0x1bde22(0x858)]==='waimai_request')return{'role':_0x1bde22(0x4c5),'content':_0x54dd5f+_0x1bde22(0xe81)+_0x34097e['timestamp']+_0x1bde22(0xd40)+_0x34097e[_0x1bde22(0xaf5)]+_0x1bde22(0x513)+_0x34097e[_0x1bde22(0xc5c)]+_0x1bde22(0xdd9)};else{if(_0x34097e[_0x1bde22(0x858)]===_0x1bde22(0x1362)){const _0x57192e=_0x34097e['items'][_0x1bde22(0x2e1)](_0x552c49=>_0x552c49[_0x1bde22(0x564)]+'\x20x'+_0x552c49[_0x1bde22(0x2e8)])[_0x1bde22(0x35d)]('、\x20');let _0x1a04df=_0x17e4ac[_0x1bde22(0x9d7)]?'送给了\x20'+_0x34097e[_0x1bde22(0x116b)]['map'](_0x130c08=>_0x503999(_0x17e4ac,_0x130c08))[_0x1bde22(0x35d)]('、\x20'):_0x1bde22(0x396)+_0x17e4ac[_0x1bde22(0x564)];return{'role':'user','content':_0x54dd5f+_0x1bde22(0x527)+_0x1a04df+_0x1bde22(0x126e)+_0x57192e+']'};}}if(_0x34097e[_0x1bde22(0x720)])return{'role':_0x1bde22(0x4c5),'content':_0x54dd5f+'[你发送了一个表情，意思是：\x27'+_0x34097e[_0x1bde22(0x720)]+'\x27]'};return{'role':_0x34097e[_0x1bde22(0x508)],'content':_0x54dd5f+_0x42b0e0};}else{if(_0x34097e[_0x1bde22(0x508)]==='assistant'){let _0x3c13ac={'type':_0x34097e[_0x1bde22(0x858)]||'text'};if(_0x34097e[_0x1bde22(0x858)]===_0x1bde22(0xb9e))_0x3c13ac[_0x1bde22(0x5f3)]=_0x34097e[_0x1bde22(0xac4)],_0x3c13ac[_0x1bde22(0x720)]=_0x34097e[_0x1bde22(0x720)];else{if(_0x34097e['type']===_0x1bde22(0x5f8))_0x3c13ac['amount']=_0x34097e[_0x1bde22(0xc5c)],_0x3c13ac[_0x1bde22(0x926)]=_0x34097e['note'];else _0x34097e['type']===_0x1bde22(0x792)?(_0x3c13ac[_0x1bde22(0xaf5)]=_0x34097e[_0x1bde22(0xaf5)],_0x3c13ac[_0x1bde22(0xc5c)]=_0x34097e[_0x1bde22(0xc5c)]):_0x34097e[_0x1bde22(0xb67)]?_0x3c13ac['quote_reply']={'target_sender':_0x34097e[_0x1bde22(0xb67)][_0x1bde22(0xdcc)],'target_content':_0x34097e[_0x1bde22(0xb67)][_0x1bde22(0xac4)],'reply_content':_0x34097e[_0x1bde22(0xac4)]}:_0x3c13ac[_0x1bde22(0xac4)]=_0x34097e[_0x1bde22(0xac4)];}const _0xc075e8=JSON[_0x1bde22(0x1308)]([_0x3c13ac]);return{'role':_0x1bde22(0x1328),'content':_0x1bde22(0x1048)+_0x34097e['timestamp']+')\x20'+_0xc075e8};}}return null;})['filter'](Boolean);if(!_0x17e4ac[_0x50f127(0x9d7)]&&_0x17e4ac['relationship']?.[_0x50f127(0x93c)]==='pending_ai_approval'){const _0x16842d=_0x17e4ac[_0x50f127(0x7d3)]['filter'](_0x296c2d=>!_0x296c2d[_0x50f127(0xb9c)])[_0x50f127(0x777)](-0xa)[_0x50f127(0x2e1)](_0x38f31a=>{const _0x3773d0=_0x50f127,_0x4ca452=_0x38f31a[_0x3773d0(0x508)]===_0x3773d0(0x4c5)?'用户':_0x17e4ac[_0x3773d0(0x564)];return _0x4ca452+':\x20'+String(_0x38f31a[_0x3773d0(0xac4)])[_0x3773d0(0x1323)](0x0,0x32)+_0x3773d0(0x4d0);})['join']('\x0a'),_0x5de862={'role':_0x50f127(0x4c5),'content':_0x50f127(0x130a)+_0x17e4ac['relationship'][_0x50f127(0xcd9)]+_0x50f127(0x5f9)+_0x16842d+_0x50f127(0xff9)};_0xb679bb[_0x50f127(0x1a0)](_0x5de862);}}}let _0x4288ec=_0x2811ee===GEMINI_API_URL,_0x133fc8=_0x19a701(_0x33bcac,_0x4f9ed4,_0x40ed47,_0xb679bb),_0x1bd6b7;try{_0x1bd6b7=_0x4288ec?await fetch(_0x133fc8[_0x50f127(0x5f3)],_0x133fc8[_0x50f127(0x104c)]):await fetch(_0x2811ee+_0x50f127(0x347),{'method':_0x50f127(0xba0),'headers':{'Content-Type':_0x50f127(0xcb5),'Authorization':'Bearer\x20'+_0x4f9ed4},'body':JSON['stringify']({'model':_0x33bcac,'messages':[{'role':'system','content':_0x40ed47},..._0xb679bb],'temperature':_0x505390[_0x50f127(0x888)][_0x50f127(0x398)]||0.8,'stream':![]})});}catch(_0x344f9f){throw new Error(_0x50f127(0x6fd)+_0x344f9f[_0x50f127(0x757)]);}if(!_0x1bd6b7['ok']){let _0x13d0a1='API\x20返回错误:\x20'+_0x1bd6b7['status']+'\x20'+_0x1bd6b7[_0x50f127(0xd4a)];try{const _0x1ac9ef=await _0x1bd6b7[_0x50f127(0xfdf)]();_0x1ac9ef[_0x50f127(0xe3b)]&&_0x1ac9ef[_0x50f127(0xe3b)]['message']?_0x13d0a1+='\x20-\x20'+_0x1ac9ef['error']['message']:_0x13d0a1+=_0x50f127(0x501)+JSON[_0x50f127(0x1308)](_0x1ac9ef);}catch(_0xc76bf6){_0x13d0a1+=_0x50f127(0x6fa)+await _0x1bd6b7['text']();}throw new Error(_0x13d0a1);}const _0x3a9574=await _0x1bd6b7[_0x50f127(0xfdf)](),_0x436bd7=getGeminiResponseText(_0x3a9574);lastRawAiResponse=_0x436bd7,lastResponseTimestamps=[],_0x17e4ac['history']=_0x17e4ac['history'][_0x50f127(0x85d)](_0x44c2fd=>!_0x44c2fd['isTemporary']);const _0x5bd258=_0x2da9f3(_0x436bd7);let _0x29b9a6=[];if(_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0x328)]){let _0x3f9fa7={'content':[],'dialogue':[],'description':[]};for(const _0x1ecd14 of _0x5bd258){if(_0x1ecd14[_0x50f127(0x858)]==='offline_text'){if(_0x1ecd14[_0x50f127(0xac4)])_0x3f9fa7[_0x50f127(0xac4)][_0x50f127(0x1a0)](_0x1ecd14[_0x50f127(0xac4)]);else{if(_0x1ecd14[_0x50f127(0xfba)])_0x3f9fa7[_0x50f127(0xfba)]['push'](_0x1ecd14['dialogue']);if(_0x1ecd14[_0x50f127(0x78b)])_0x3f9fa7[_0x50f127(0x78b)][_0x50f127(0x1a0)](_0x1ecd14['description']);}}else(_0x3f9fa7[_0x50f127(0xac4)]['length']>0x0||_0x3f9fa7['dialogue'][_0x50f127(0x990)]>0x0||_0x3f9fa7['description'][_0x50f127(0x990)]>0x0)&&(_0x3f9fa7[_0x50f127(0xac4)]['length']>0x0&&_0x29b9a6['push']({'type':_0x50f127(0x124e),'content':_0x3f9fa7[_0x50f127(0xac4)]['join']('\x0a')}),(_0x3f9fa7[_0x50f127(0xfba)][_0x50f127(0x990)]>0x0||_0x3f9fa7[_0x50f127(0x78b)][_0x50f127(0x990)]>0x0)&&_0x29b9a6[_0x50f127(0x1a0)]({'type':_0x50f127(0x124e),'dialogue':_0x3f9fa7[_0x50f127(0xfba)]['join']('\x0a'),'description':_0x3f9fa7[_0x50f127(0x78b)][_0x50f127(0x35d)]('\x0a')}),_0x3f9fa7={'content':[],'dialogue':[],'description':[]}),_0x29b9a6[_0x50f127(0x1a0)](_0x1ecd14);}_0x3f9fa7[_0x50f127(0xac4)]['length']>0x0&&_0x29b9a6[_0x50f127(0x1a0)]({'type':'offline_text','content':_0x3f9fa7['content'][_0x50f127(0x35d)]('\x0a')}),(_0x3f9fa7[_0x50f127(0xfba)][_0x50f127(0x990)]>0x0||_0x3f9fa7['description'][_0x50f127(0x990)]>0x0)&&_0x29b9a6[_0x50f127(0x1a0)]({'type':_0x50f127(0x124e),'dialogue':_0x3f9fa7['dialogue'][_0x50f127(0x35d)]('\x0a'),'description':_0x3f9fa7['description'][_0x50f127(0x35d)]('\x0a')});}else _0x29b9a6=_0x5bd258;const _0x914473=_0x17e4ac[_0x50f127(0x7d3)]['filter'](_0x3550dc=>_0x3550dc[_0x50f127(0x508)]==='user'&&!_0x3550dc[_0x50f127(0xb9c)])[_0x50f127(0xb47)]();if(_0x914473&&Array['isArray'](_0x914473['content'])&&_0x914473[_0x50f127(0xac4)][0x0]?.['type']===_0x50f127(0x1e8)&&!_0x914473['imageProcessed']){const _0x368914=_0x5bd258[_0x50f127(0xc0d)](_0x3d9f88=>_0x3d9f88[_0x50f127(0x858)]==='text');let _0x4e29de;_0x368914&&(_0x368914[_0x50f127(0xac4)]||_0x368914[_0x50f127(0x757)])?_0x4e29de=String(_0x368914['content']||_0x368914['message'])['trim']():_0x4e29de=_0x50f127(0xbe7);const _0x5ecc98=_0x17e4ac['history'][_0x50f127(0x120c)](_0xf282b0=>_0xf282b0[_0x50f127(0x12a2)]===_0x914473['timestamp']);if(_0x5ecc98>-0x1){console[_0x50f127(0x90f)]('识图优化：正在将时间戳为\x20'+_0x914473[_0x50f127(0x12a2)]+_0x50f127(0x848));const _0x369c44=_0x50f127(0x265)+_0x4e29de+'”]';_0x17e4ac[_0x50f127(0x7d3)][_0x5ecc98][_0x50f127(0xac4)]=_0x369c44,_0x17e4ac[_0x50f127(0x7d3)][_0x5ecc98][_0x50f127(0x3ce)]=!![],_0x17e4ac[_0x50f127(0x7d3)][_0x5ecc98][_0x50f127(0x858)]=_0x50f127(0x56d);}}const _0xefc1e1=document[_0x50f127(0x479)](_0x50f127(0xdeb))[_0x50f127(0x9cd)][_0x50f127(0x658)](_0x50f127(0x5a9))&&_0x505390[_0x50f127(0x233)]===_0xbfff66;let _0x4a9942=![],_0x4ddd84=Date[_0x50f127(0x12d6)](),_0x5abc45=[],_0x4c6ced=![];for(const _0x260388 of _0x29b9a6){_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0xe5b)]!==![]&&_0x260388['type']===_0x50f127(0x56d)&&typeof _0x260388['content']===_0x50f127(0x8d9)&&_0x260388['content'][_0x50f127(0x9c1)]()[_0x50f127(0x591)](_0x50f127(0xdac))&&(_0x260388[_0x50f127(0x858)]=_0x50f127(0x9bf),_0x260388[_0x50f127(0xac4)]=_0x260388[_0x50f127(0xac4)][_0x50f127(0x491)](_0x50f127(0xdac),'')[_0x50f127(0x9c1)]());if(_0x17e4ac[_0x50f127(0x9d7)]&&_0x260388[_0x50f127(0x564)]&&_0x260388[_0x50f127(0x564)]===_0x17e4ac[_0x50f127(0x564)]){console[_0x50f127(0xe3b)](_0x50f127(0x104b)+_0x17e4ac[_0x50f127(0x564)]+_0x50f127(0xadd),_0x260388);continue;}if(!_0x260388||typeof _0x260388!==_0x50f127(0x65a)){console[_0x50f127(0x139e)](_0x50f127(0xbf5),_0x260388);continue;}if(!_0x260388[_0x50f127(0x858)]){if(_0x17e4ac[_0x50f127(0x9d7)]&&_0x260388[_0x50f127(0x564)]&&_0x260388[_0x50f127(0x757)])_0x260388[_0x50f127(0x858)]='text';else{if(_0x260388[_0x50f127(0xac4)])_0x260388[_0x50f127(0x858)]=_0x50f127(0x56d);else{console[_0x50f127(0x139e)](_0x50f127(0x6d1),_0x260388);continue;}}}if(_0x260388[_0x50f127(0x858)]===_0x50f127(0x1034)){_0x315a6a[_0x50f127(0xbb7)]=![];if(_0x260388[_0x50f127(0xb49)]===_0x50f127(0xacb))_0x511eb0();else{const _0x13f73e={'role':_0x50f127(0x1328),'content':_0x50f127(0xe5a),'timestamp':Date[_0x50f127(0x12d6)]()};_0x17e4ac[_0x50f127(0x7d3)][_0x50f127(0x1a0)](_0x13f73e),await _0xb81d4e['chats'][_0x50f127(0x5d0)](_0x17e4ac),_0x731d5(_0x50f127(0xdeb)),_0x474d6b(_0xbfff66);}_0x4a9942=!![];break;}if(_0x260388[_0x50f127(0x858)]==='group_call_response'){if(_0x260388[_0x50f127(0xb49)]==='join'){const _0x517186=_0x17e4ac[_0x50f127(0x954)]['find'](_0x2c4784=>_0x2c4784[_0x50f127(0xe2d)]===_0x260388[_0x50f127(0x564)]);_0x517186&&!_0x315a6a[_0x50f127(0xf06)]['some'](_0x268807=>_0x268807['id']===_0x517186['id'])&&_0x315a6a[_0x50f127(0xf06)][_0x50f127(0x1a0)](_0x517186);}_0x4a9942=!![];continue;}if(_0x17e4ac[_0x50f127(0x9d7)]&&_0x260388[_0x50f127(0x564)]&&_0x260388[_0x50f127(0x564)]===_0x17e4ac[_0x50f127(0x564)]){console['error']('AI幻觉已被拦截！试图使用群名\x20(\x22'+_0x17e4ac[_0x50f127(0x564)]+'\x22)\x20作为角色名。消息内容:',_0x260388);continue;}if(_0x17e4ac[_0x50f127(0x9d7)]&&!_0x260388['name']){console[_0x50f127(0xe3b)]('AI幻觉已被拦截！试图在群聊中发送一条没有“name”的消息。消息内容:',_0x260388);continue;}let _0x359f8f=null;const _0x72066b=_0x4ddd84++,_0x312a45={'role':_0x50f127(0x1328),'senderName':_0x260388[_0x50f127(0x564)]||_0x17e4ac['name'],'timestamp':_0x72066b};lastResponseTimestamps[_0x50f127(0x1a0)](_0x72066b);switch(_0x260388[_0x50f127(0x858)]){case _0x50f127(0x751):if(!_0x17e4ac[_0x50f127(0x9d7)]){_0x260388[_0x50f127(0x279)]&&(_0x17e4ac['heartfeltVoice']=String(_0x260388['heartfelt_voice']));_0x260388[_0x50f127(0x84f)]&&(_0x17e4ac[_0x50f127(0x2cf)]=String(_0x260388[_0x50f127(0x84f)]));!Array['isArray'](_0x17e4ac[_0x50f127(0x57e)])&&(_0x17e4ac['thoughtsHistory']=[]);_0x17e4ac[_0x50f127(0x57e)]['push']({'heartfeltVoice':_0x17e4ac[_0x50f127(0x25c)],'randomJottings':_0x17e4ac[_0x50f127(0x2cf)],'timestamp':Date[_0x50f127(0x12d6)]()});_0x17e4ac['thoughtsHistory'][_0x50f127(0x990)]>0x32&&_0x17e4ac[_0x50f127(0x57e)]['shift']();const _0x198910=_0x50f127(0x11b3)+_0x17e4ac['heartfeltVoice']+'\x0a-\x20散记:\x20'+_0x17e4ac['randomJottings'],_0x4f88fa={'role':_0x50f127(0xbaa),'content':_0x198910,'timestamp':Date['now'](),'isHidden':!![]};}continue;case _0x50f127(0x71d):if(!_0x17e4ac[_0x50f127(0x9d7)]&&_0x260388['new_name']){const _0x47c2fc=_0x260388[_0x50f127(0xc7b)][_0x50f127(0x9c1)]();if(_0x47c2fc){_0x17e4ac['settings'][_0x50f127(0xf58)]=_0x47c2fc;const _0x19ae45={'role':_0x50f127(0xbaa),'type':_0x50f127(0x81b),'content':'“'+_0x17e4ac[_0x50f127(0x564)]+'”\x20将对你的称呼修改为\x20“'+_0x47c2fc+'”','timestamp':_0x4ddd84++};_0x17e4ac[_0x50f127(0x7d3)]['push'](_0x19ae45);const _0x258fa4={'role':_0x50f127(0xbaa),'content':_0x50f127(0x9be)+_0x47c2fc+_0x50f127(0xf0f),'timestamp':_0x4ddd84++,'isHidden':!![]};_0x17e4ac[_0x50f127(0x7d3)][_0x50f127(0x1a0)](_0x258fa4),_0xefc1e1&&_0x48f5ff(_0x19ae45,_0x17e4ac);}}continue;case _0x50f127(0xe2c):if(!_0x17e4ac['isGroup']&&_0x260388[_0x50f127(0xc7b)]){const _0x357a2d=_0x17e4ac[_0x50f127(0x564)],_0x164956=_0x260388['new_name'][_0x50f127(0x9c1)]();if(_0x164956&&_0x164956!==_0x357a2d){!_0x17e4ac['nameHistory']&&(_0x17e4ac[_0x50f127(0x102f)]=[]);!_0x17e4ac[_0x50f127(0x102f)][_0x50f127(0x44f)](_0x357a2d)&&_0x17e4ac[_0x50f127(0x102f)][_0x50f127(0x1a0)](_0x357a2d);_0x17e4ac[_0x50f127(0x564)]=_0x164956;const _0x37289f={'role':_0x50f127(0xbaa),'type':'pat_message','content':'“'+_0x17e4ac[_0x50f127(0xe2d)]+_0x50f127(0x3fc)+_0x164956+'”','timestamp':_0x4ddd84++};_0x17e4ac[_0x50f127(0x7d3)][_0x50f127(0x1a0)](_0x37289f);const _0xe41a81={'role':_0x50f127(0xbaa),'content':_0x50f127(0x241)+_0x164956+_0x50f127(0x55d),'timestamp':_0x4ddd84++,'isHidden':!![]};_0x17e4ac[_0x50f127(0x7d3)][_0x50f127(0x1a0)](_0xe41a81),_0xefc1e1&&(_0x48f5ff(_0x37289f,_0x17e4ac),document[_0x50f127(0x479)](_0x50f127(0x81f))['textContent']=_0x164956),await _0x377162(_0x17e4ac);}}continue;case'change_avatar':{const _0x47a91b=_0x260388['name'],_0x101d56=_0x17e4ac['settings'][_0x50f127(0x8c6)][_0x50f127(0xc0d)](_0x25ae36=>_0x25ae36[_0x50f127(0x564)]===_0x47a91b);if(_0x101d56){_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0x1039)]=_0x101d56[_0x50f127(0x5f3)];const _0x29b3a7={'role':_0x50f127(0xbaa),'type':_0x50f127(0x81b),'content':'['+_0x17e4ac[_0x50f127(0x564)]+_0x50f127(0x6e2),'timestamp':Date[_0x50f127(0x12d6)]()};_0x17e4ac['history']['push'](_0x29b3a7),await _0x134037(_0x17e4ac),_0xefc1e1&&(_0x48f5ff(_0x29b3a7,_0x17e4ac),_0x474d6b(_0xbfff66));}continue;}case _0x50f127(0x1151):{const _0x2cd76f=_0x260388['name'],_0x4a883b=_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0x846)][_0x50f127(0xc0d)](_0x182341=>_0x182341[_0x50f127(0x564)]===_0x2cd76f);if(_0x4a883b){_0x17e4ac['settings'][_0x50f127(0xe28)]=_0x4a883b[_0x50f127(0x5f3)];const _0x105dca={'role':'system','type':_0x50f127(0x81b),'content':'['+_0x17e4ac['name']+_0x50f127(0xe56),'timestamp':Date[_0x50f127(0x12d6)]()};_0x17e4ac[_0x50f127(0x7d3)][_0x50f127(0x1a0)](_0x105dca),_0xefc1e1&&(_0x48f5ff(_0x105dca,_0x17e4ac),_0x474d6b(_0xbfff66));}continue;}case _0x50f127(0x10c7):{const _0x486e62=parseInt(_0x260388['x']),_0x597f3d=parseInt(_0x260388['y']);!isNaN(_0x486e62)&&!isNaN(_0x597f3d)?_0x5d7053({'x':_0x486e62,'y':_0x597f3d}):console[_0x50f127(0x139e)](_0x50f127(0x443),_0x260388);continue;}case _0x50f127(0xdf3):const _0x411837=_0x17e4ac['history']['findIndex'](_0x3f1c33=>_0x3f1c33['timestamp']===_0x260388[_0x50f127(0xb84)]);if(_0x411837>-0x1){const _0x526453=_0x17e4ac[_0x50f127(0x7d3)][_0x411837];_0x526453['status']=_0x260388[_0x50f127(0x93c)],_0x526453[_0x50f127(0x1eb)]=_0x260388['status']===_0x50f127(0xb08)?_0x260388['name']:null;}continue;case'qzone_post':const _0x6f61dc={'type':_0x260388['postType'],'content':_0x260388[_0x50f127(0xac4)]||'','publicText':_0x260388[_0x50f127(0x105a)]||'','hiddenContent':_0x260388['hiddenContent']||'','timestamp':Date[_0x50f127(0x12d6)](),'authorId':_0xbfff66,'authorGroupId':_0x17e4ac[_0x50f127(0x194)],'visibleGroupIds':null};if(_0x260388[_0x50f127(0x426)]===_0x50f127(0x12c7)&&_0x260388[_0x50f127(0x3ae)]){const _0x4ead95=Array['isArray'](_0x260388[_0x50f127(0x3ae)])?_0x260388['prompt'][_0x50f127(0x777)](0x0,0x9):[_0x260388[_0x50f127(0x3ae)]];_0x6f61dc[_0x50f127(0x7de)]=_0x4ead95[_0x50f127(0x2e1)](_0x581b6b=>{const _0x51aa79=_0x50f127,_0xa96904=encodeURIComponent(_0x581b6b);return _0x51aa79(0x730)+_0xa96904+_0x51aa79(0xe27);}),_0x4ead95[_0x50f127(0x990)]===0x1&&(_0x6f61dc[_0x50f127(0xa09)]=_0x6f61dc['imageUrls'][0x0]),_0x6f61dc[_0x50f127(0x3ae)]=_0x260388[_0x50f127(0x3ae)],_0x6f61dc[_0x50f127(0x28b)]=_0x4ead95[_0x50f127(0x990)],console[_0x50f127(0x90f)](_0x50f127(0xb71)+_0x4ead95[_0x50f127(0x990)]+'张',_0x6f61dc[_0x50f127(0x7de)]);}if(_0x260388[_0x50f127(0x426)]===_0x50f127(0x1cc)&&_0x260388[_0x50f127(0x3ae)])try{const _0x456548=Array[_0x50f127(0x285)](_0x260388[_0x50f127(0x3ae)])?_0x260388[_0x50f127(0x3ae)][_0x50f127(0x777)](0x0,0x2):[_0x260388['prompt']];console[_0x50f127(0x90f)]('📸\x20动态NovelAI图片生成开始，共'+_0x456548[_0x50f127(0x990)]+'张图片');const _0x559c89=[];for(let _0x578e75=0x0;_0x578e75<_0x456548[_0x50f127(0x990)];_0x578e75++){const _0x22db7e=_0x456548[_0x578e75];console['log'](_0x50f127(0x988)+(_0x578e75+0x1)+'张图片，prompt:',_0x22db7e);const _0x630b7c=_0x3384ca(_0x17e4ac['id']),_0x3d39f6=_0x22db7e+',\x20'+_0x630b7c[_0x50f127(0x137a)],_0x87a00=_0x630b7c[_0x50f127(0xfa4)];console[_0x50f127(0x90f)](_0x50f127(0x936)+(_0x630b7c[_0x50f127(0x910)]==='character'?_0x50f127(0x1342):'系统')+_0x50f127(0x123e)),console[_0x50f127(0x90f)]('最终正面提示词:',_0x3d39f6),console[_0x50f127(0x90f)](_0x50f127(0x368),_0x87a00);const _0x2daf55=localStorage[_0x50f127(0x28f)](_0x50f127(0x6b2)),_0x9ea303=localStorage['getItem'](_0x50f127(0x2c0))||_0x50f127(0xfc1),_0x214a54=_0x22087c();if(!_0x2daf55)throw new Error(_0x50f127(0x6c3));const [_0x122108,_0x188091]=_0x214a54[_0x50f127(0x712)][_0x50f127(0x53e)]('x')[_0x50f127(0x2e1)](Number);let _0xadb392;_0x9ea303[_0x50f127(0x44f)](_0x50f127(0xcc1))?_0xadb392={'input':_0x3d39f6,'model':_0x9ea303,'action':_0x50f127(0x1340),'parameters':{'params_version':0x3,'width':_0x122108,'height':_0x188091,'scale':_0x214a54[_0x50f127(0x12df)],'sampler':_0x214a54[_0x50f127(0x11f2)],'steps':_0x214a54['steps'],'seed':_0x214a54[_0x50f127(0x121e)]===-0x1?Math[_0x50f127(0xd71)](Math['random']()*0x2540be3ff):_0x214a54[_0x50f127(0x121e)],'n_samples':0x1,'ucPreset':_0x214a54[_0x50f127(0x1213)],'qualityToggle':_0x214a54['quality_toggle'],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x50f127(0x1036),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x3d39f6,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x87a00,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x87a00,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0xadb392={'input':_0x3d39f6,'model':_0x9ea303,'action':_0x50f127(0x1340),'parameters':{'width':_0x122108,'height':_0x188091,'scale':_0x214a54[_0x50f127(0x12df)],'sampler':_0x214a54['sampler'],'steps':_0x214a54['steps'],'seed':_0x214a54[_0x50f127(0x121e)]===-0x1?Math[_0x50f127(0xd71)](Math['random']()*0x2540be3ff):_0x214a54[_0x50f127(0x121e)],'n_samples':0x1,'ucPreset':_0x214a54[_0x50f127(0x1213)],'qualityToggle':_0x214a54[_0x50f127(0x1f6)],'sm':_0x214a54['smea'],'sm_dyn':_0x214a54[_0x50f127(0x325)],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x50f127(0x2fc),'negative_prompt':_0x87a00}};console[_0x50f127(0x90f)](_0x50f127(0x78a),_0xadb392);let _0x26f5d0;_0x9ea303['includes'](_0x50f127(0xcc1))?_0x26f5d0=_0x50f127(0xe98):_0x26f5d0=_0x50f127(0x51f);let _0x38296a=_0x214a54[_0x50f127(0x3c2)];_0x38296a==='custom'&&(_0x38296a=_0x214a54[_0x50f127(0xc33)]||'');_0x38296a&&_0x38296a!==''&&(_0x26f5d0=_0x38296a+encodeURIComponent(_0x26f5d0));const _0x5d7dd0=await fetch(_0x26f5d0,{'method':_0x50f127(0xba0),'headers':{'Content-Type':'application/json','Authorization':_0x50f127(0xb27)+_0x2daf55},'body':JSON['stringify'](_0xadb392)});console[_0x50f127(0x90f)]('Response\x20status:',_0x5d7dd0[_0x50f127(0x93c)]),console[_0x50f127(0x90f)](_0x50f127(0x1273),[..._0x5d7dd0['headers'][_0x50f127(0xef7)]()]);if(!_0x5d7dd0['ok']){const _0x3b43d5=await _0x5d7dd0[_0x50f127(0x56d)]();console[_0x50f127(0xe3b)]('API错误响应:',_0x3b43d5);throw new Error(_0x50f127(0x783)+_0x5d7dd0[_0x50f127(0x93c)]+'):\x20'+_0x3b43d5);}const _0x2151fa=_0x5d7dd0['headers'][_0x50f127(0x111a)](_0x50f127(0x747));console['log'](_0x50f127(0x932),_0x2151fa);let _0x25ded9,_0x3860b0;if(_0x2151fa&&_0x2151fa[_0x50f127(0x44f)](_0x50f127(0x11fa))){console['log'](_0x50f127(0xf22));const _0x36dda4=await _0x5d7dd0['text']();console[_0x50f127(0x90f)](_0x50f127(0x915),_0x36dda4[_0x50f127(0x990)]);const _0x6aca83=_0x36dda4[_0x50f127(0x9c1)]()['split']('\x0a');let _0x36c151=null;for(let _0xe40ad=_0x6aca83[_0x50f127(0x990)]-0x1;_0xe40ad>=0x0;_0xe40ad--){const _0x57045f=_0x6aca83[_0xe40ad]['trim']();if(_0x57045f[_0x50f127(0x591)](_0x50f127(0x8e5))&&_0x57045f!==_0x50f127(0x3ec)){const _0x18ef13=_0x57045f[_0x50f127(0x1323)](0x6);try{const _0x399c78=JSON['parse'](_0x18ef13);if(_0x399c78[_0x50f127(0x7fc)]===_0x50f127(0x3a4)&&_0x399c78['image']){_0x36c151=_0x399c78[_0x50f127(0x676)],console[_0x50f127(0x90f)](_0x50f127(0x98d));break;}if(_0x399c78[_0x50f127(0x104c)]){_0x36c151=_0x399c78[_0x50f127(0x104c)],console[_0x50f127(0x90f)]('从\x20JSON.data\x20中提取图片数据');break;}if(_0x399c78[_0x50f127(0x676)]){_0x36c151=_0x399c78[_0x50f127(0x676)],console[_0x50f127(0x90f)]('从\x20JSON.image\x20中提取图片数据');break;}}catch(_0x80199e){_0x36c151=_0x18ef13,console[_0x50f127(0x90f)](_0x50f127(0xca3));break;}}}if(!_0x36c151)throw new Error(_0x50f127(0x876));const _0x4e6eb9=_0x36c151[_0x50f127(0x591)](_0x50f127(0x1227)),_0x447d6b=_0x36c151['startsWith'](_0x50f127(0xcfc));if(_0x4e6eb9||_0x447d6b){console['log'](_0x50f127(0x636));const _0x2ad1c7=atob(_0x36c151),_0x31e654=new Uint8Array(_0x2ad1c7[_0x50f127(0x990)]);for(let _0x5ed3bb=0x0;_0x5ed3bb<_0x2ad1c7[_0x50f127(0x990)];_0x5ed3bb++){_0x31e654[_0x5ed3bb]=_0x2ad1c7[_0x50f127(0x113e)](_0x5ed3bb);}const _0x46e088=new Blob([_0x31e654],{'type':_0x4e6eb9?_0x50f127(0x541):_0x50f127(0xb3b)});console['log']('图片\x20Blob\x20创建成功，大小:',_0x46e088[_0x50f127(0xa7a)]);const _0x1f330f=new FileReader();_0x3860b0=await new Promise((_0x4cbada,_0x37ce17)=>{const _0x3dcc67=_0x50f127;_0x1f330f['onloadend']=()=>_0x4cbada(_0x1f330f[_0x3dcc67(0x97e)]),_0x1f330f[_0x3dcc67(0x1337)]=_0x37ce17,_0x1f330f['readAsDataURL'](_0x46e088);}),console[_0x50f127(0x90f)]('✅\x20图片转换成功！🎨');}else{console['log'](_0x50f127(0x688));const _0x18330b=atob(_0x36c151),_0x22fe67=new Uint8Array(_0x18330b['length']);for(let _0x52f495=0x0;_0x52f495<_0x18330b[_0x50f127(0x990)];_0x52f495++){_0x22fe67[_0x52f495]=_0x18330b[_0x50f127(0x113e)](_0x52f495);}_0x25ded9=new Blob([_0x22fe67]),console[_0x50f127(0x90f)](_0x50f127(0xe97),_0x25ded9['size']);}}else _0x25ded9=await _0x5d7dd0[_0x50f127(0xb02)](),console[_0x50f127(0x90f)](_0x50f127(0x128e),_0x25ded9[_0x50f127(0x858)],_0x50f127(0x2e5),_0x25ded9[_0x50f127(0xa7a)]);if(!_0x3860b0&&_0x25ded9)try{if(typeof JSZip==='undefined')throw new Error(_0x50f127(0xc6d));const _0x397bb9=await JSZip['loadAsync'](_0x25ded9);console[_0x50f127(0x90f)](_0x50f127(0x863),Object['keys'](_0x397bb9[_0x50f127(0xe63)]));let _0x3b1845=null;for(let _0x473475 in _0x397bb9[_0x50f127(0xe63)]){if(_0x473475[_0x50f127(0xab4)](/\.(png|jpg|jpeg|webp)$/i)){_0x3b1845=_0x397bb9['files'][_0x473475],console[_0x50f127(0x90f)](_0x50f127(0x4ff),_0x473475);break;}}if(!_0x3b1845)throw new Error(_0x50f127(0x5e5));const _0x1055ac=await _0x3b1845[_0x50f127(0x106a)](_0x50f127(0xb02));console[_0x50f127(0x90f)]('提取的图片大小:',_0x1055ac['size']);const _0x429054=new FileReader();_0x3860b0=await new Promise((_0xe34ce9,_0x1c875d)=>{const _0x29a2e7=_0x50f127;_0x429054['onloadend']=()=>_0xe34ce9(_0x429054[_0x29a2e7(0x97e)]),_0x429054[_0x29a2e7(0x1337)]=_0x1c875d,_0x429054[_0x29a2e7(0x83c)](_0x1055ac);}),console['log'](_0x50f127(0x745));}catch(_0x9e5cdb){console[_0x50f127(0xe3b)](_0x50f127(0x1338),_0x9e5cdb);throw new Error(_0x50f127(0x635)+_0x9e5cdb[_0x50f127(0x757)]);}console['log']('✅\x20NAI图片'+(_0x578e75+0x1)+_0x50f127(0x10ec)),_0x559c89[_0x50f127(0x1a0)](_0x3860b0);}_0x6f61dc[_0x50f127(0x7de)]=_0x559c89,_0x559c89['length']===0x1&&(_0x6f61dc['imageUrl']=_0x559c89[0x0]),_0x6f61dc[_0x50f127(0x3ae)]=_0x260388[_0x50f127(0x3ae)],_0x6f61dc[_0x50f127(0x28b)]=_0x559c89[_0x50f127(0x990)],console[_0x50f127(0x90f)](_0x50f127(0xb85)+_0x559c89[_0x50f127(0x990)]+'张');}catch(_0x89caf7){console[_0x50f127(0xe3b)](_0x50f127(0x9c0),_0x89caf7),_0x6f61dc[_0x50f127(0xac4)]=(_0x6f61dc['content']||_0x6f61dc[_0x50f127(0x105a)]||'')+(_0x50f127(0xdf1)+_0x89caf7[_0x50f127(0x757)]+']');}await _0xb81d4e[_0x50f127(0xcce)]['add'](_0x6f61dc),_0xa385c3(_0x22cc4e+0x1);_0xefc1e1&&document[_0x50f127(0x479)](_0x50f127(0xc8d))['classList']['contains'](_0x50f127(0x5a9))&&await _0x2eb20b();continue;case _0x50f127(0x62c):{const _0x549639=await _0xb81d4e[_0x50f127(0xcce)][_0x50f127(0x111a)](parseInt(_0x260388[_0x50f127(0x403)]));if(_0x549639){if(!_0x549639[_0x50f127(0xd3c)])_0x549639[_0x50f127(0xd3c)]=[];const _0x608e25=_0x260388['name']||_0x17e4ac['originalName'],_0x20fc70=(_0x505f4a,_0x5de8dc=null,_0x34827a=null)=>({'commenterName':_0x608e25,'text':_0x4537d4(_0x505f4a,_0x17e4ac),'meaning':_0x5de8dc,'replyTo':_0x34827a,'timestamp':Date[_0x50f127(0x12d6)]()});if(_0x260388[_0x50f127(0x7e3)]){const _0x395d3d=_0x505390[_0x50f127(0x407)][_0x50f127(0xc0d)](_0x2d1be6=>_0x2d1be6['name']===_0x260388[_0x50f127(0x7e3)]);_0x395d3d?_0x549639['comments'][_0x50f127(0x1a0)](_0x20fc70(_0x395d3d['url'],_0x395d3d['name'],_0x260388[_0x50f127(0x32a)]||null)):(console['warn'](_0x50f127(0xd76)+_0x260388[_0x50f127(0x7e3)]+'\x22'),_0x549639[_0x50f127(0xd3c)]['push'](_0x20fc70(_0x50f127(0xdbf)+_0x260388[_0x50f127(0x7e3)]+']',null,_0x260388['replyTo']||null)));}else{if(Array[_0x50f127(0x285)](_0x260388[_0x50f127(0xd3c)]))_0x260388[_0x50f127(0xd3c)]['forEach'](_0x265972=>{const _0x13f795=_0x50f127;typeof _0x265972===_0x13f795(0x8d9)&&_0x265972['trim']()&&_0x549639[_0x13f795(0xd3c)][_0x13f795(0x1a0)](_0x20fc70(_0x265972,null,_0x260388[_0x13f795(0x32a)]||null));});else typeof _0x260388[_0x50f127(0xcca)]===_0x50f127(0x8d9)&&_0x260388[_0x50f127(0xcca)][_0x50f127(0x9c1)]()&&_0x549639[_0x50f127(0xd3c)][_0x50f127(0x1a0)](_0x20fc70(_0x260388[_0x50f127(0xcca)],null,_0x260388[_0x50f127(0x32a)]||null));}await _0xb81d4e[_0x50f127(0xcce)][_0x50f127(0xeb2)](_0x549639['id'],{'comments':_0x549639[_0x50f127(0xd3c)]}),_0xa385c3(_0x22cc4e+0x1),console['log'](_0x50f127(0xd1f)+_0x17e4ac[_0x50f127(0x564)]+_0x50f127(0xf15)+_0x260388['postId']);if(!_0x17e4ac[_0x50f127(0x946)])_0x17e4ac[_0x50f127(0x946)]={};_0x17e4ac[_0x50f127(0x946)][_0x260388['postId']]=Date[_0x50f127(0x12d6)]();}continue;}case _0x50f127(0x308):const _0x3c5383=await _0xb81d4e['qzonePosts'][_0x50f127(0x111a)](parseInt(_0x260388['postId']));if(_0x3c5383){if(!_0x3c5383[_0x50f127(0x12e3)])_0x3c5383[_0x50f127(0x12e3)]=[];!_0x3c5383['likes'][_0x50f127(0x44f)](_0x17e4ac[_0x50f127(0x564)])&&(_0x3c5383['likes'][_0x50f127(0x1a0)](_0x17e4ac[_0x50f127(0x564)]),await _0xb81d4e[_0x50f127(0xcce)][_0x50f127(0xeb2)](_0x3c5383['id'],{'likes':_0x3c5383[_0x50f127(0x12e3)]}),_0xa385c3(_0x22cc4e+0x1),_0xefc1e1&&document[_0x50f127(0x479)](_0x50f127(0xc8d))[_0x50f127(0x9cd)]['contains'](_0x50f127(0x5a9))&&await _0x2eb20b());}continue;case _0x50f127(0xe30):{const _0x844a1=await _0xb81d4e[_0x50f127(0xcce)][_0x50f127(0x111a)](parseInt(_0x260388[_0x50f127(0x403)]));if(_0x844a1){const _0x283da6={'type':'repost','timestamp':Date[_0x50f127(0x12d6)](),'authorId':_0xbfff66,'authorGroupId':_0x17e4ac[_0x50f127(0x194)],'repostComment':_0x260388['comment']||'','originalPost':_0x844a1,'visibleGroupIds':null};await _0xb81d4e['qzonePosts']['add'](_0x283da6),_0xa385c3(_0x22cc4e+0x1),console[_0x50f127(0x90f)]('后台活动:\x20角色\x20\x22'+_0x17e4ac[_0x50f127(0x564)]+_0x50f127(0x1229)+_0x260388[_0x50f127(0x403)]);}continue;}case _0x50f127(0xacd):!_0x315a6a[_0x50f127(0x4c3)]&&!_0x315a6a[_0x50f127(0xbb7)]&&(_0x505390[_0x50f127(0x233)]=_0xbfff66,_0x315a6a['activeChatId']=_0xbfff66,_0x315a6a[_0x50f127(0xbb7)]=!![],_0x315a6a[_0x50f127(0x7bf)]=_0x17e4ac['isGroup'],_0x315a6a['callRequester']=_0x260388[_0x50f127(0x564)]||_0x17e4ac['name'],_0x550c2f());continue;case _0x50f127(0x5ac):!_0x315a6a[_0x50f127(0x4c3)]&&!_0x315a6a[_0x50f127(0xbb7)]&&(_0x505390[_0x50f127(0x233)]=_0xbfff66,_0x315a6a['isAwaitingResponse']=!![],_0x315a6a[_0x50f127(0x7bf)]=!![],_0x315a6a[_0x50f127(0x181)]='ai',_0x315a6a['callRequester']=_0x260388[_0x50f127(0x564)],_0x550c2f());continue;case _0x50f127(0x1178):let _0x53463b;if(_0x17e4ac[_0x50f127(0x9d7)]){const _0x53fe66=_0x17e4ac[_0x50f127(0x954)]['find'](_0x3c7736=>_0x3c7736[_0x50f127(0xe2d)]===_0x260388[_0x50f127(0x564)]);_0x53463b=_0x53fe66?_0x53fe66[_0x50f127(0xa54)]:_0x260388[_0x50f127(0x564)];}else _0x53463b=_0x17e4ac[_0x50f127(0x564)];const _0x1b8a46=_0x260388[_0x50f127(0x4ef)]?'\x20'+_0x260388[_0x50f127(0x4ef)][_0x50f127(0x9c1)]():'',_0x328f27=_0x53463b+'\x20拍了拍我'+_0x1b8a46,_0x531494={'role':_0x50f127(0xbaa),'type':_0x50f127(0x81b),'content':_0x328f27,'timestamp':Date[_0x50f127(0x12d6)]()};_0x17e4ac[_0x50f127(0x7d3)][_0x50f127(0x1a0)](_0x531494);if(_0xefc1e1){const _0x2cab3a=document[_0x50f127(0x479)]('phone-screen');_0x2cab3a[_0x50f127(0x9cd)][_0x50f127(0x8b6)](_0x50f127(0xcdf)),void _0x2cab3a[_0x50f127(0x918)],_0x2cab3a[_0x50f127(0x9cd)][_0x50f127(0x807)](_0x50f127(0xcdf)),setTimeout(()=>_0x2cab3a[_0x50f127(0x9cd)][_0x50f127(0x8b6)](_0x50f127(0xcdf)),0x1f4),_0x48f5ff(_0x531494,_0x17e4ac);}else _0xabb267(_0xbfff66,_0x328f27);continue;case _0x50f127(0x942):_0x17e4ac[_0x50f127(0x93c)][_0x50f127(0x56d)]=_0x260388['status_text'],_0x17e4ac['status'][_0x50f127(0xfc8)]=_0x260388[_0x50f127(0x90d)]||![],_0x17e4ac[_0x50f127(0x93c)][_0x50f127(0x1032)]=Date[_0x50f127(0x12d6)]();const _0x226bec={'role':'system','type':_0x50f127(0x81b),'content':'['+_0x17e4ac[_0x50f127(0x564)]+_0x50f127(0xc16)+_0x260388['status_text']+']','timestamp':Date[_0x50f127(0x12d6)]()};_0x17e4ac[_0x50f127(0x7d3)][_0x50f127(0x1a0)](_0x226bec);_0xefc1e1&&_0x48f5ff(_0x226bec,_0x17e4ac);_0x1b7f69();continue;case _0x50f127(0xeef):_0x359f8f={..._0x312a45,'type':_0x50f127(0xeef),'content':_0x260388[_0x50f127(0xac4)]};break;case _0x50f127(0x3f4):if(_0x304e8d[_0x50f127(0x4c3)]&&_0x304e8d['activeChatId']===_0xbfff66){const _0x203d3f=_0x260388[_0x50f127(0x87e)]||_0x260388[_0x50f127(0x638)]||_0x260388['name'];if(typeof _0x203d3f===_0x50f127(0x8d9)&&_0x203d3f[_0x50f127(0x9c1)]()){const _0x3065b8=_0x203d3f[_0x50f127(0x491)](/^\[?\d+\]?[\s.-]*/,'')[_0x50f127(0x9c1)](),_0x42a12e=_0x304e8d[_0x50f127(0x13c7)][_0x50f127(0x120c)](_0x5d84e6=>_0x5d84e6['name'][_0x50f127(0x1f8)]()===_0x3065b8[_0x50f127(0x1f8)]());if(_0x42a12e>-0x1){_0x589174(_0x42a12e);const _0x35183b=_0x304e8d[_0x50f127(0x13c7)][_0x42a12e];let _0x9f194c;if(_0x17e4ac['isGroup']){const _0x41df53=_0x17e4ac[_0x50f127(0x954)][_0x50f127(0xc0d)](_0x3b3b61=>_0x3b3b61[_0x50f127(0xe2d)]===_0x260388[_0x50f127(0x564)]);_0x9f194c=_0x41df53?_0x41df53[_0x50f127(0xa54)]:_0x260388[_0x50f127(0x564)];}else _0x9f194c=_0x17e4ac[_0x50f127(0x564)];const _0x23a356={'role':_0x50f127(0xbaa),'type':_0x50f127(0x81b),'content':'[♪\x20'+_0x9f194c+_0x50f127(0x594)+_0x35183b[_0x50f127(0x564)]+_0x50f127(0x7f9)+_0x35183b['artist']+']','timestamp':Date[_0x50f127(0x12d6)]()};_0x17e4ac[_0x50f127(0x7d3)][_0x50f127(0x1a0)](_0x23a356),_0xefc1e1&&_0x48f5ff(_0x23a356,_0x17e4ac);}else console[_0x50f127(0x139e)](_0x50f127(0x1174)+_0x203d3f+_0x50f127(0x1272)+_0x3065b8+'\x22)\x20在播放列表中未找到。');}else console[_0x50f127(0xe3b)](_0x50f127(0x1147),_0x260388);}continue;case'create_memory':const _0x21ebee={'chatId':_0xbfff66,'authorId':_0xbfff66,'description':_0x260388[_0x50f127(0x78b)],'timestamp':Date[_0x50f127(0x12d6)](),'type':_0x50f127(0x7e1)};await _0xb81d4e[_0x50f127(0xa2f)][_0x50f127(0x807)](_0x21ebee),console[_0x50f127(0x90f)]('AI\x20\x22'+_0x17e4ac[_0x50f127(0x564)]+_0x50f127(0x12fa),_0x260388['description']);continue;case _0x50f127(0xc93):const _0x1f5fea=new Date(_0x260388[_0x50f127(0x276)]);if(!isNaN(_0x1f5fea)&&_0x1f5fea>new Date()){const _0x5716d9={'chatId':_0xbfff66,'authorId':_0xbfff66,'description':_0x260388['title'],'timestamp':Date['now'](),'type':_0x50f127(0x38a),'targetDate':_0x1f5fea[_0x50f127(0xd2b)]()};await _0xb81d4e[_0x50f127(0xa2f)]['add'](_0x5716d9),console['log'](_0x50f127(0xb00)+_0x17e4ac[_0x50f127(0x564)]+_0x50f127(0x1141),_0x260388[_0x50f127(0xc29)]);}continue;case _0x50f127(0x135c):if(!_0x17e4ac[_0x50f127(0x9d7)]){_0x17e4ac['relationship']['status']=_0x50f127(0x84b);const _0x12a0e7={'role':_0x50f127(0xbaa),'content':_0x50f127(0xd83),'timestamp':Date['now'](),'isHidden':!![]};_0x17e4ac[_0x50f127(0x7d3)][_0x50f127(0x1a0)](_0x12a0e7),await _0xb81d4e[_0x50f127(0x1027)][_0x50f127(0x5d0)](_0x17e4ac);_0xefc1e1&&_0x474d6b(_0xbfff66);_0x1b7f69();break;}continue;case _0x50f127(0x448):!_0x17e4ac[_0x50f127(0x9d7)]&&_0x17e4ac['relationship']?.[_0x50f127(0x93c)]===_0x50f127(0xb79)&&(_0x260388[_0x50f127(0xb49)]===_0x50f127(0xacb)?(_0x17e4ac[_0x50f127(0xcda)][_0x50f127(0x93c)]=_0x50f127(0xc83),_0x359f8f={..._0x312a45,'content':_0x50f127(0x21f)}):(_0x17e4ac['relationship'][_0x50f127(0x93c)]='blocked_by_ai',_0x359f8f={..._0x312a45,'content':_0x50f127(0xb17)}),_0x17e4ac[_0x50f127(0xcda)][_0x50f127(0xcd9)]='');break;case _0x50f127(0xb34):const _0x9fbc26=typeof _0x260388[_0x50f127(0x6ed)]===_0x50f127(0x8d9)?_0x260388['options'][_0x50f127(0x53e)]('\x0a')['filter'](_0x53334e=>_0x53334e['trim']()):Array[_0x50f127(0x285)](_0x260388[_0x50f127(0x6ed)])?_0x260388[_0x50f127(0x6ed)]:[];if(_0x9fbc26[_0x50f127(0x990)]<0x2)continue;_0x359f8f={..._0x312a45,'type':_0x50f127(0xb34),'question':_0x260388[_0x50f127(0xa60)],'options':_0x9fbc26,'votes':{},'isClosed':![]};break;case _0x50f127(0x1362):{const {itemName:_0x2f1cce,itemPrice:_0x5f4b49,image_prompt:_0x1adec0}=_0x260388;if(_0x2f1cce&&!isNaN(parseFloat(_0x5f4b49))&&_0x1adec0){const _0x176998=_0x50f127(0x730)+encodeURIComponent(_0x1adec0);_0x359f8f={..._0x312a45,'type':_0x50f127(0x1362),'items':[{'name':_0x2f1cce,'price':parseFloat(_0x5f4b49),'imageUrl':_0x176998,'quantity':0x1}],'total':parseFloat(_0x5f4b49),'recipients':_0x260388['recipients']||null};}else console['warn'](_0x50f127(0x123c),_0x260388);break;}case _0x50f127(0x2bc):const _0x210423=_0x17e4ac[_0x50f127(0x7d3)][_0x50f127(0xc0d)](_0x3c4156=>_0x3c4156['timestamp']===_0x260388['poll_timestamp']);_0x210423&&!_0x210423['isClosed']&&(Object[_0x50f127(0x108c)](_0x210423[_0x50f127(0x78e)])['forEach'](_0x22e0a4=>{const _0x2e237c=_0x50f127,_0x14253b=_0x210423[_0x2e237c(0x78e)][_0x22e0a4]['indexOf'](_0x260388['name']);_0x14253b>-0x1&&_0x210423[_0x2e237c(0x78e)][_0x22e0a4][_0x2e237c(0x118e)](_0x14253b,0x1);}),!_0x210423[_0x50f127(0x78e)][_0x260388[_0x50f127(0x560)]]&&(_0x210423[_0x50f127(0x78e)][_0x260388[_0x50f127(0x560)]]=[]),!_0x210423[_0x50f127(0x78e)][_0x260388['choice']][_0x50f127(0x44f)](_0x260388[_0x50f127(0x564)])&&_0x210423[_0x50f127(0x78e)][_0x260388[_0x50f127(0x560)]][_0x50f127(0x1a0)](_0x260388[_0x50f127(0x564)]),_0xefc1e1&&_0x474d6b(_0xbfff66));continue;case _0x50f127(0x1358):_0x359f8f={..._0x312a45,..._0x260388,'totalAmount':_0x260388[_0x50f127(0xc5c)],'claimedBy':{},'isFullyClaimed':![]};_0x260388['receiver']&&(_0x359f8f['receiverName']=_0x260388['receiver'],delete _0x359f8f[_0x50f127(0xd00)]);break;case _0x50f127(0xcb3):const _0xc52233=_0x17e4ac[_0x50f127(0x7d3)][_0x50f127(0xc0d)](_0x94c82f=>_0x94c82f['timestamp']===_0x260388[_0x50f127(0x548)]),_0x1a5d47=_0x260388[_0x50f127(0x564)],_0x46aa29=_0x17e4ac['members'][_0x50f127(0x1235)](_0x10415a=>_0x10415a['originalName']===_0x1a5d47);if(!_0x46aa29){console[_0x50f127(0x139e)](_0x50f127(0x47e)+_0x1a5d47+_0x50f127(0x512));continue;}if(_0xc52233&&_0xc52233[_0x50f127(0xeaf)]===_0x50f127(0x211)){if(_0xc52233['receiverName']!==_0x260388[_0x50f127(0x564)]){console[_0x50f127(0x139e)](_0x50f127(0x47e)+_0x260388[_0x50f127(0x564)]+'\x22\x20尝试领取不属于自己的专属红包\x20(接收人:\x20'+_0xc52233[_0x50f127(0xfd7)]+_0x50f127(0x1052));continue;}}if(_0xc52233&&!_0xc52233['isFullyClaimed']&&!(_0xc52233['claimedBy']&&_0xc52233[_0x50f127(0x12e6)][_0x260388[_0x50f127(0x564)]])){let _0x4ca78b=0x0;const _0x4fd0e2=_0xc52233[_0x50f127(0xc10)]-Object[_0x50f127(0x3d5)](_0xc52233[_0x50f127(0x12e6)]||{})['reduce']((_0x27090f,_0x533004)=>_0x27090f+_0x533004,0x0),_0x3c10e0=_0xc52233['count']-Object[_0x50f127(0x108c)](_0xc52233[_0x50f127(0x12e6)]||{})[_0x50f127(0x990)];if(_0x3c10e0>0x0){if(_0xc52233['packetType']==='direct')_0x4ca78b=_0xc52233['totalAmount'];else{if(_0x3c10e0===0x1)_0x4ca78b=_0x4fd0e2;else{const _0x256fed=0.01,_0x368afb=_0x4fd0e2-(_0x3c10e0-0x1)*_0x256fed;_0x4ca78b=Math[_0x50f127(0x103a)]()*(_0x368afb-_0x256fed)+_0x256fed;}}_0x4ca78b=parseFloat(_0x4ca78b[_0x50f127(0x6e1)](0x2));if(!_0xc52233[_0x50f127(0x12e6)])_0xc52233['claimedBy']={};_0xc52233[_0x50f127(0x12e6)][_0x260388[_0x50f127(0x564)]]=_0x4ca78b;const _0x239ccd=_0x17e4ac[_0x50f127(0x954)]['find'](_0x35526b=>_0x35526b[_0x50f127(0xe2d)]===_0x260388[_0x50f127(0x564)]),_0x4f9f43=_0x239ccd?_0x239ccd[_0x50f127(0xa54)]:_0x260388['name'],_0x26ee6d=_0x503999(_0x17e4ac,_0xc52233[_0x50f127(0xdcc)]),_0x27034c={'role':_0x50f127(0xbaa),'type':_0x50f127(0x81b),'content':_0x4f9f43+'\x20领取了\x20'+_0x26ee6d+_0x50f127(0xa81),'timestamp':Date['now']()};_0x17e4ac[_0x50f127(0x7d3)]['push'](_0x27034c);let _0x1d25be=_0x50f127(0xf9e)+_0x4f9f43+')\x20成功抢到了\x20'+_0x4ca78b[_0x50f127(0x6e1)](0x2)+_0x50f127(0xc3f);if(Object[_0x50f127(0x108c)](_0xc52233['claimedBy'])[_0x50f127(0x990)]>=_0xc52233[_0x50f127(0x32f)]){_0xc52233[_0x50f127(0x824)]=!![];const _0x22f5c2={'role':_0x50f127(0xbaa),'type':'pat_message','content':_0x26ee6d+_0x50f127(0x6f6),'timestamp':Date['now']()+0x1};_0x17e4ac['history'][_0x50f127(0x1a0)](_0x22f5c2);let _0x2280b0={'name':'','amount':-0x1};_0xc52233[_0x50f127(0xeaf)]==='lucky'&&_0xc52233[_0x50f127(0x32f)]>0x1&&Object[_0x50f127(0xef7)](_0xc52233[_0x50f127(0x12e6)])[_0x50f127(0x12be)](([_0x1d67a5,_0x35351d])=>{const _0x30fa8b=_0x50f127;_0x35351d>_0x2280b0[_0x30fa8b(0xc5c)]&&(_0x2280b0={'name':_0x1d67a5,'amount':_0x35351d});});if(_0x2280b0[_0x50f127(0x564)]){const _0x3e1548=_0x17e4ac[_0x50f127(0x954)]['find'](_0x395f29=>_0x395f29[_0x50f127(0xe2d)]===_0x2280b0[_0x50f127(0x564)]),_0x53ab37=_0x3e1548?_0x3e1548[_0x50f127(0xa54)]:_0x2280b0[_0x50f127(0x564)];_0x1d25be+='\x20红包已被领完，手气王是\x20'+_0x53ab37+'！';}else _0x1d25be+=_0x50f127(0xde7);}_0x1d25be+='\x20请根据这个结果发表你的评论。]';const _0x44e149={'role':_0x50f127(0xbaa),'content':_0x1d25be,'timestamp':Date['now']()+0x2,'isHidden':!![]};_0x17e4ac[_0x50f127(0x7d3)]['push'](_0x44e149);}_0xefc1e1&&(_0x474d6b(_0xbfff66),_0x1b7f69());}continue;case _0x50f127(0x1088):{const _0x3a76a4=_0x17e4ac[_0x50f127(0x7d3)][_0x50f127(0x120c)](_0x3b6f84=>_0x3b6f84[_0x50f127(0x12a2)]===_0x260388['for_timestamp']);if(_0x3a76a4>-0x1){const _0x2a7a91=_0x17e4ac['history'][_0x3a76a4];_0x2a7a91[_0x50f127(0x93c)]=_0x50f127(0x1312);}continue;}case _0x50f127(0xff2):{const _0x4d5a2f=_0x17e4ac[_0x50f127(0x7d3)][_0x50f127(0x120c)](_0x5e926d=>_0x5e926d['timestamp']===_0x260388[_0x50f127(0xb84)]);if(_0x4d5a2f>-0x1){const _0x448f86=_0x17e4ac[_0x50f127(0x7d3)][_0x4d5a2f];_0x448f86[_0x50f127(0x93c)]=_0x50f127(0xe4b);const _0x546014={'role':_0x50f127(0x1328),'senderName':_0x17e4ac[_0x50f127(0x564)],'type':_0x50f127(0x5f8),'isRefund':!![],'amount':_0x448f86[_0x50f127(0xc5c)],'note':_0x50f127(0xcac),'timestamp':_0x4ddd84++};_0x17e4ac['history'][_0x50f127(0x1a0)](_0x546014),_0xefc1e1&&(_0x48f5ff(_0x546014,_0x17e4ac),_0x474d6b(_0xbfff66));}continue;}case _0x50f127(0x727):if(_0x17e4ac['isGroup']&&_0x260388[_0x50f127(0xc7b)]){const _0x2dd455=_0x260388[_0x50f127(0xc7b)]['trim'](),_0x32c64a=_0x17e4ac[_0x50f127(0x954)][_0x50f127(0x2e1)](_0xa0bc2b=>_0xa0bc2b[_0x50f127(0xe2d)]);if(_0x32c64a[_0x50f127(0x44f)](_0x2dd455)){console[_0x50f127(0x139e)]('AI\x20('+_0x260388[_0x50f127(0x564)]+_0x50f127(0xf12)+_0x2dd455+'\x22)。操作已被程序阻止。');continue;}_0x17e4ac[_0x50f127(0x564)]=_0x2dd455;const _0x1d8332=_0x17e4ac[_0x50f127(0x954)][_0x50f127(0xc0d)](_0x5c61d5=>_0x5c61d5[_0x50f127(0xe2d)]===_0x260388[_0x50f127(0x564)]),_0x51c063=_0x1d8332?_0x1d8332[_0x50f127(0xa54)]:_0x260388['name'],_0x135c3c={'role':_0x50f127(0xbaa),'type':_0x50f127(0x81b),'content':_0x51c063+_0x50f127(0xa16)+_0x17e4ac[_0x50f127(0x564)]+'”','timestamp':_0x4ddd84++};_0x17e4ac['history'][_0x50f127(0x1a0)](_0x135c3c),_0xefc1e1&&(_0x48f5ff(_0x135c3c,_0x17e4ac),document[_0x50f127(0x479)](_0x50f127(0x81f))[_0x50f127(0x97b)]=_0x17e4ac[_0x50f127(0x564)]);}continue;case'change_remark_name':if(!_0x17e4ac['isGroup']&&_0x260388[_0x50f127(0xc7b)]){const _0xd8478b=_0x17e4ac[_0x50f127(0x564)],_0x4aaa9d=_0x260388['new_name'][_0x50f127(0x9c1)]();if(_0x4aaa9d&&_0x4aaa9d!==_0xd8478b){!_0x17e4ac[_0x50f127(0x102f)]&&(_0x17e4ac['nameHistory']=[]);!_0x17e4ac[_0x50f127(0x102f)][_0x50f127(0x44f)](_0xd8478b)&&_0x17e4ac[_0x50f127(0x102f)][_0x50f127(0x1a0)](_0xd8478b);_0x17e4ac[_0x50f127(0x564)]=_0x4aaa9d;const _0x3f3f2e={'role':'system','type':_0x50f127(0x81b),'content':'“'+_0x17e4ac['originalName']+_0x50f127(0x3fc)+_0x4aaa9d+'”','timestamp':_0x4ddd84++};_0x17e4ac[_0x50f127(0x7d3)][_0x50f127(0x1a0)](_0x3f3f2e);const _0x28312c={'role':_0x50f127(0xbaa),'content':_0x50f127(0x241)+_0x4aaa9d+_0x50f127(0x55d),'timestamp':_0x4ddd84++,'isHidden':!![]};_0x17e4ac[_0x50f127(0x7d3)][_0x50f127(0x1a0)](_0x28312c),_0xefc1e1&&(_0x48f5ff(_0x3f3f2e,_0x17e4ac),document[_0x50f127(0x479)]('chat-header-title')[_0x50f127(0x97b)]=_0x4aaa9d),await _0x377162(_0x17e4ac);}}continue;case _0x50f127(0xa43):if(_0x17e4ac[_0x50f127(0x9d7)]&&_0x260388['avatar_name']){const _0x1a11cc=_0x260388['avatar_name'],_0x11d56f=_0x17e4ac['settings']['groupAvatarLibrary']||[],_0x5adfc2=_0x11d56f[_0x50f127(0xc0d)](_0x1b16ed=>_0x1b16ed[_0x50f127(0x564)]===_0x1a11cc);if(_0x5adfc2){_0x17e4ac['settings'][_0x50f127(0x67c)]=_0x5adfc2[_0x50f127(0x5f3)];const _0x300ae2=_0x17e4ac[_0x50f127(0x954)]['find'](_0x5ae13b=>_0x5ae13b[_0x50f127(0xe2d)]===_0x260388[_0x50f127(0x564)]),_0x5db45e=_0x300ae2?_0x300ae2[_0x50f127(0xa54)]:_0x260388[_0x50f127(0x564)],_0x4940ba={'role':_0x50f127(0xbaa),'type':'pat_message','content':_0x5db45e+_0x50f127(0xee5),'timestamp':_0x4ddd84++};_0x17e4ac['history']['push'](_0x4940ba),_0xefc1e1&&_0x48f5ff(_0x4940ba,_0x17e4ac);}else console['warn']('AI\x20尝试使用一个不存在的群头像:\x20\x22'+_0x1a11cc+'\x22');}continue;case'system_message':_0x359f8f={'role':_0x50f127(0xbaa),'type':'pat_message','content':_0x260388[_0x50f127(0xac4)],'timestamp':Date[_0x50f127(0x12d6)]()};break;case'share_link':_0x359f8f={..._0x312a45,'type':_0x50f127(0x131b),'title':_0x260388['title'],'description':_0x260388[_0x50f127(0x78b)],'source_name':_0x260388[_0x50f127(0x6a3)],'content':_0x260388[_0x50f127(0xac4)]};break;case'quote_reply':const _0x5712cc=_0x17e4ac['history'][_0x50f127(0xc0d)](_0x2aced9=>_0x2aced9[_0x50f127(0x12a2)]===_0x260388[_0x50f127(0xe51)]);if(_0x5712cc){const _0x3c0f1d={'timestamp':_0x5712cc[_0x50f127(0x12a2)],'senderName':_0x5712cc[_0x50f127(0xdcc)]||(_0x5712cc[_0x50f127(0x508)]===_0x50f127(0x4c5)?_0x17e4ac[_0x50f127(0x18a)][_0x50f127(0xf58)]||'我':_0x17e4ac[_0x50f127(0x564)]),'content':String(_0x5712cc[_0x50f127(0xac4)]||'')[_0x50f127(0x1323)](0x0,0x32)};_0x359f8f={..._0x312a45,'content':_0x260388[_0x50f127(0x12f0)],'quote':_0x3c0f1d};}else _0x359f8f={..._0x312a45,'content':_0x260388[_0x50f127(0x12f0)]};break;case _0x50f127(0x643):{if(!_0xefc1e1)continue;const _0x4b9916={..._0x312a45,'content':_0x260388[_0x50f127(0xac4)]},_0x3addc8=_0x43c884(_0x4b9916,_0x17e4ac);_0x48f5ff(_0x4b9916,_0x17e4ac,!![]),await new Promise(_0x429c11=>setTimeout(_0x429c11,Math[_0x50f127(0x103a)]()*0x3e8+0x5dc));const _0x3a1f97=document[_0x50f127(0x8bc)](_0x50f127(0x7b8)+_0x4b9916[_0x50f127(0x12a2)]+'\x22]')?.['closest'](_0x50f127(0x10f6));if(_0x3a1f97){_0x3a1f97[_0x50f127(0x9cd)][_0x50f127(0x807)](_0x50f127(0x24f)),await new Promise(_0x36053f=>setTimeout(_0x36053f,0x12c));const _0x41387a={'role':_0x50f127(0x1328),'senderName':_0x260388[_0x50f127(0x564)]||_0x17e4ac[_0x50f127(0x564)],'type':'recalled_message','content':_0x50f127(0x1d0),'timestamp':_0x4b9916[_0x50f127(0x12a2)],'recalledData':{'originalType':_0x50f127(0x56d),'originalContent':_0x260388[_0x50f127(0xac4)]}},_0x479260=_0x17e4ac['history'][_0x50f127(0x120c)](_0x58f9ff=>_0x58f9ff[_0x50f127(0x12a2)]===_0x4b9916[_0x50f127(0x12a2)]);_0x479260>-0x1?_0x17e4ac[_0x50f127(0x7d3)][_0x479260]=_0x41387a:_0x17e4ac[_0x50f127(0x7d3)]['push'](_0x41387a);const _0x4454b6=await _0x43c884(_0x41387a,_0x17e4ac);document['body'][_0x50f127(0x658)](_0x3a1f97)&&_0x3a1f97[_0x50f127(0x1134)]['replaceChild'](_0x4454b6,_0x3a1f97);}continue;}case _0x50f127(0x56d):_0x359f8f={..._0x312a45,'content':String(_0x260388[_0x50f127(0xac4)]||_0x260388[_0x50f127(0x757)])};break;case _0x50f127(0xb9e):if(_0x260388[_0x50f127(0x720)]){const _0x580475=_0x505390[_0x50f127(0x407)][_0x50f127(0xc0d)](_0xb2166c=>_0xb2166c['name']===_0x260388[_0x50f127(0x720)]);_0x580475?_0x359f8f={..._0x312a45,'type':_0x50f127(0xb9e),'content':_0x580475[_0x50f127(0x5f3)],'meaning':_0x580475[_0x50f127(0x564)]}:(console['warn']('AI\x20尝试使用一个不存在的表情:\x20\x22'+_0x260388[_0x50f127(0x720)]+'\x22'),_0x359f8f={..._0x312a45,'type':_0x50f127(0x56d),'content':_0x50f127(0xdbf)+_0x260388[_0x50f127(0x720)]+']'});}else console[_0x50f127(0x139e)]('AI\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。',_0x260388),_0x359f8f={..._0x312a45,'type':_0x50f127(0xb9e),'content':_0x260388[_0x50f127(0x5f3)],'meaning':_0x50f127(0x735)};break;case'ai_image':_0x359f8f={..._0x312a45,'type':_0x50f127(0x135a),'content':_0x260388[_0x50f127(0x78b)],'image_prompt':_0x260388[_0x50f127(0xfb2)]};break;case _0x50f127(0x9bf):_0x359f8f={..._0x312a45,'type':'voice_message','content':_0x260388[_0x50f127(0xac4)]};break;case _0x50f127(0x5f8):_0x359f8f={..._0x312a45,'type':_0x50f127(0x5f8),'amount':_0x260388['amount'],'note':_0x260388['note'],'receiverName':_0x260388['receiver']||'我'};break;case'waimai_request':_0x359f8f={..._0x312a45,'type':'waimai_request','productInfo':_0x260388['productInfo'],'amount':_0x260388[_0x50f127(0xc5c)],'status':_0x50f127(0xa25),'countdownEndTime':Date['now']()+0xf*0x3c*0x3e8};break;case _0x50f127(0x4cf):_0x359f8f={..._0x312a45,'type':'waimai_order','productInfo':_0x260388[_0x50f127(0xaf5)],'amount':_0x260388[_0x50f127(0xc5c)],'greeting':_0x260388[_0x50f127(0x91e)],'recipientName':_0x260388[_0x50f127(0x1103)]||null};break;case _0x50f127(0x124e):_0x359f8f={..._0x312a45,..._0x260388};break;case'naiimag':try{console['log'](_0x50f127(0x13b1),_0x260388['prompt']);const _0x5da072=_0x3384ca(_0x17e4ac['id']),_0x54e7cc=_0x260388['prompt']||_0x50f127(0x597),_0x5efaeb=_0x54e7cc+',\x20'+_0x5da072['positive'],_0x500499=_0x5da072[_0x50f127(0xfa4)];console[_0x50f127(0x90f)](_0x50f127(0x936)+(_0x5da072[_0x50f127(0x910)]===_0x50f127(0x390)?_0x50f127(0x1342):'系统')+'提示词配置'),console[_0x50f127(0x90f)]('最终正面提示词:',_0x5efaeb),console[_0x50f127(0x90f)](_0x50f127(0x368),_0x500499);const _0x2b7b3c=localStorage['getItem'](_0x50f127(0x6b2)),_0x3faf91=localStorage[_0x50f127(0x28f)](_0x50f127(0x2c0))||_0x50f127(0xfc1),_0x3c64eb=_0x22087c();if(!_0x2b7b3c)throw new Error('NovelAI\x20API\x20Key未配置。请在NovelAI设置中填写API\x20Key。');const [_0x2c129d,_0x4b41b7]=_0x3c64eb['resolution']['split']('x')[_0x50f127(0x2e1)](Number);let _0x1a849c;_0x3faf91[_0x50f127(0x44f)](_0x50f127(0xcc1))?_0x1a849c={'input':_0x5efaeb,'model':_0x3faf91,'action':_0x50f127(0x1340),'parameters':{'params_version':0x3,'width':_0x2c129d,'height':_0x4b41b7,'scale':_0x3c64eb['cfg_scale'],'sampler':_0x3c64eb[_0x50f127(0x11f2)],'steps':_0x3c64eb[_0x50f127(0x949)],'seed':_0x3c64eb['seed']===-0x1?Math[_0x50f127(0xd71)](Math['random']()*0x2540be3ff):_0x3c64eb[_0x50f127(0x121e)],'n_samples':0x1,'ucPreset':_0x3c64eb['uc_preset'],'qualityToggle':_0x3c64eb[_0x50f127(0x1f6)],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x50f127(0x1036),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x5efaeb,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x500499,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x500499,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x1a849c={'input':_0x5efaeb,'model':_0x3faf91,'action':_0x50f127(0x1340),'parameters':{'width':_0x2c129d,'height':_0x4b41b7,'scale':_0x3c64eb['cfg_scale'],'sampler':_0x3c64eb[_0x50f127(0x11f2)],'steps':_0x3c64eb['steps'],'seed':_0x3c64eb[_0x50f127(0x121e)]===-0x1?Math[_0x50f127(0xd71)](Math[_0x50f127(0x103a)]()*0x2540be3ff):_0x3c64eb[_0x50f127(0x121e)],'n_samples':0x1,'ucPreset':_0x3c64eb[_0x50f127(0x1213)],'qualityToggle':_0x3c64eb[_0x50f127(0x1f6)],'sm':_0x3c64eb[_0x50f127(0x697)],'sm_dyn':_0x3c64eb[_0x50f127(0x325)],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x50f127(0x2fc),'negative_prompt':_0x500499}};console[_0x50f127(0x90f)](_0x50f127(0x78a),_0x1a849c);let _0x3bc20d;_0x3faf91[_0x50f127(0x44f)](_0x50f127(0xcc1))?_0x3bc20d=_0x50f127(0xe98):_0x3bc20d='https://image.novelai.net/ai/generate-image';let _0x3c0c3c=_0x3c64eb['cors_proxy'];_0x3c0c3c===_0x50f127(0x13f7)&&(_0x3c0c3c=_0x3c64eb[_0x50f127(0xc33)]||'');_0x3c0c3c&&_0x3c0c3c!==''&&(_0x3bc20d=_0x3c0c3c+encodeURIComponent(_0x3bc20d));const _0x447634=await fetch(_0x3bc20d,{'method':_0x50f127(0xba0),'headers':{'Content-Type':_0x50f127(0xcb5),'Authorization':_0x50f127(0xb27)+_0x2b7b3c},'body':JSON[_0x50f127(0x1308)](_0x1a849c)});console['log'](_0x50f127(0x115e),_0x447634['status']),console[_0x50f127(0x90f)](_0x50f127(0x1273),[..._0x447634[_0x50f127(0x4c9)][_0x50f127(0xef7)]()]);if(!_0x447634['ok']){const _0x28b129=await _0x447634[_0x50f127(0x56d)]();console[_0x50f127(0xe3b)](_0x50f127(0xd6b),_0x28b129);throw new Error(_0x50f127(0x783)+_0x447634[_0x50f127(0x93c)]+_0x50f127(0x1044)+_0x28b129);}const _0xa9fb47=_0x447634['headers']['get'](_0x50f127(0x747));console[_0x50f127(0x90f)](_0x50f127(0x932),_0xa9fb47);let _0x2e992b,_0x5e47da;if(_0xa9fb47&&_0xa9fb47[_0x50f127(0x44f)](_0x50f127(0x11fa))){console[_0x50f127(0x90f)](_0x50f127(0xf22));const _0x144faf=await _0x447634['text']();console['log'](_0x50f127(0x915),_0x144faf[_0x50f127(0x990)]);const _0x553643=_0x144faf[_0x50f127(0x9c1)]()[_0x50f127(0x53e)]('\x0a');let _0x3531c0=null;for(let _0x4f4350=_0x553643['length']-0x1;_0x4f4350>=0x0;_0x4f4350--){const _0x5a0368=_0x553643[_0x4f4350][_0x50f127(0x9c1)]();if(_0x5a0368['startsWith'](_0x50f127(0x8e5))&&_0x5a0368!==_0x50f127(0x3ec)){const _0x4048b8=_0x5a0368[_0x50f127(0x1323)](0x6);try{const _0x3fcb37=JSON[_0x50f127(0x94c)](_0x4048b8);if(_0x3fcb37[_0x50f127(0x7fc)]===_0x50f127(0x3a4)&&_0x3fcb37['image']){_0x3531c0=_0x3fcb37[_0x50f127(0x676)],console[_0x50f127(0x90f)](_0x50f127(0x98d));break;}if(_0x3fcb37[_0x50f127(0x104c)]){_0x3531c0=_0x3fcb37[_0x50f127(0x104c)],console['log'](_0x50f127(0x32e));break;}if(_0x3fcb37['image']){_0x3531c0=_0x3fcb37[_0x50f127(0x676)],console[_0x50f127(0x90f)](_0x50f127(0xadf));break;}}catch(_0x1aa96c){_0x3531c0=_0x4048b8,console[_0x50f127(0x90f)](_0x50f127(0xca3));break;}}}if(!_0x3531c0)throw new Error('无法从\x20SSE\x20响应中提取图片数据');const _0x2279f1=_0x3531c0[_0x50f127(0x591)](_0x50f127(0x1227)),_0x31e9cf=_0x3531c0[_0x50f127(0x591)](_0x50f127(0xcfc));if(_0x2279f1||_0x31e9cf){console['log']('✅\x20检测到直接的图片\x20base64\x20数据\x20(PNG/JPEG)');const _0x5942e3=atob(_0x3531c0),_0x49b72a=new Uint8Array(_0x5942e3['length']);for(let _0x1c282a=0x0;_0x1c282a<_0x5942e3[_0x50f127(0x990)];_0x1c282a++){_0x49b72a[_0x1c282a]=_0x5942e3[_0x50f127(0x113e)](_0x1c282a);}const _0x2f72ae=new Blob([_0x49b72a],{'type':_0x2279f1?'image/png':_0x50f127(0xb3b)});console[_0x50f127(0x90f)](_0x50f127(0x102b),_0x2f72ae[_0x50f127(0xa7a)]);const _0x5e5444=new FileReader();_0x5e47da=await new Promise((_0x155ba2,_0x5e0530)=>{_0x5e5444['onloadend']=()=>_0x155ba2(_0x5e5444['result']),_0x5e5444['onerror']=_0x5e0530,_0x5e5444['readAsDataURL'](_0x2f72ae);}),console[_0x50f127(0x90f)](_0x50f127(0xf1b));}else{console[_0x50f127(0x90f)](_0x50f127(0x688));const _0x43e927=atob(_0x3531c0),_0x378388=new Uint8Array(_0x43e927['length']);for(let _0xe5cd93=0x0;_0xe5cd93<_0x43e927[_0x50f127(0x990)];_0xe5cd93++){_0x378388[_0xe5cd93]=_0x43e927[_0x50f127(0x113e)](_0xe5cd93);}_0x2e992b=new Blob([_0x378388]),console[_0x50f127(0x90f)](_0x50f127(0xe97),_0x2e992b['size']);}}else _0x2e992b=await _0x447634['blob'](),console['log'](_0x50f127(0x128e),_0x2e992b[_0x50f127(0x858)],_0x50f127(0x2e5),_0x2e992b[_0x50f127(0xa7a)]);if(!_0x5e47da&&_0x2e992b)try{if(typeof JSZip===_0x50f127(0xcb8))throw new Error(_0x50f127(0xc6d));const _0x241393=await JSZip[_0x50f127(0x68d)](_0x2e992b);console['log'](_0x50f127(0x863),Object['keys'](_0x241393[_0x50f127(0xe63)]));let _0x554d61=null;for(let _0x1d71c2 in _0x241393[_0x50f127(0xe63)]){if(_0x1d71c2['match'](/\.(png|jpg|jpeg|webp)$/i)){_0x554d61=_0x241393[_0x50f127(0xe63)][_0x1d71c2],console['log'](_0x50f127(0x4ff),_0x1d71c2);break;}}if(!_0x554d61)throw new Error(_0x50f127(0x5e5));const _0x30f471=await _0x554d61[_0x50f127(0x106a)](_0x50f127(0xb02));console[_0x50f127(0x90f)](_0x50f127(0xaaa),_0x30f471['size']);const _0x415d2c=new FileReader();_0x5e47da=await new Promise((_0x4c84d1,_0x414561)=>{const _0x1f5497=_0x50f127;_0x415d2c[_0x1f5497(0x989)]=()=>_0x4c84d1(_0x415d2c[_0x1f5497(0x97e)]),_0x415d2c[_0x1f5497(0x1337)]=_0x414561,_0x415d2c[_0x1f5497(0x83c)](_0x30f471);}),console[_0x50f127(0x90f)](_0x50f127(0x745));}catch(_0x2efe54){console[_0x50f127(0xe3b)](_0x50f127(0x1338),_0x2efe54);throw new Error(_0x50f127(0x635)+_0x2efe54['message']);}console[_0x50f127(0x90f)]('✅\x20NAI图片生成成功！'),_0x359f8f={..._0x312a45,'type':'naiimag','imageUrl':_0x5e47da,'prompt':_0x54e7cc,'fullPrompt':_0x5efaeb};}catch(_0x2eea12){console['error'](_0x50f127(0xbda),_0x2eea12),_0x359f8f={..._0x312a45,'content':'[图片生成失败:\x20'+_0x2eea12[_0x50f127(0x757)]+']'};}break;default:console[_0x50f127(0x139e)]('收到了未知的AI指令类型:',_0x260388['type']);break;}if(_0x359f8f){_0x17e4ac[_0x50f127(0x7d3)][_0x50f127(0x1a0)](_0x359f8f);!_0xefc1e1&&(_0x17e4ac['unreadCount']=(_0x17e4ac[_0x50f127(0x1090)]||0x0)+0x1);if(!_0xefc1e1&&!_0x4c6ced){let _0x4a0060;switch(_0x359f8f['type']){case _0x50f127(0x5f8):_0x4a0060=_0x50f127(0xeca);break;case'waimai_request':_0x4a0060=_0x50f127(0x12b2);break;case _0x50f127(0x135a):_0x4a0060=_0x50f127(0x11e6);break;case _0x50f127(0x9bf):_0x4a0060=_0x50f127(0xdb0);break;case _0x50f127(0xb9e):_0x4a0060=_0x359f8f['meaning']?_0x50f127(0xdbf)+_0x359f8f[_0x50f127(0x720)]+']':_0x50f127(0xa6d);break;case _0x50f127(0x124e):_0x4a0060=_0x359f8f['dialogue']?'「'+_0x359f8f[_0x50f127(0xfba)]+'」':'['+_0x359f8f[_0x50f127(0x78b)][_0x50f127(0x1323)](0x0,0x14)+_0x50f127(0x55a);break;default:_0x4a0060=String(_0x359f8f[_0x50f127(0xac4)]||'');}const _0x590f15=_0x17e4ac['isGroup']?_0x359f8f['senderName']+':\x20'+_0x4a0060:_0x4a0060;_0xabb267(_0xbfff66,_0x590f15[_0x50f127(0x1323)](0x0,0x28)+(_0x590f15[_0x50f127(0x990)]>0x28?_0x50f127(0x4d0):'')),_0x4c6ced=!![];}_0xefc1e1&&(_0x48f5ff(_0x359f8f,_0x17e4ac),await new Promise(_0x5e1b1f=>setTimeout(_0x5e1b1f,Math[_0x50f127(0x103a)]()*0x708+0x3e8)));}}_0x4a9942&&_0x315a6a[_0x50f127(0x7bf)]&&(_0x315a6a['isAwaitingResponse']=![],_0x315a6a['participants'][_0x50f127(0x990)]>0x0?_0x511eb0():(_0x315a6a={..._0x315a6a,'isAwaitingResponse':![],'participants':[]},_0x731d5('chat-interface-screen'),alert(_0x50f127(0x408))));if(_0x4d39ea){await _0x15e1a8();return;}await _0xb81d4e[_0x50f127(0x1027)][_0x50f127(0x5d0)](_0x17e4ac);const _0x5d46fe=_0x5bd258[_0x50f127(0x1235)](_0x3037e6=>_0x3037e6[_0x50f127(0x858)]===_0x50f127(0x239)||_0x3037e6[_0x50f127(0x858)]===_0x50f127(0x308)||_0x3037e6['type']===_0x50f127(0x62c)||_0x3037e6['type']===_0x50f127(0xe30));_0x5d46fe&&(console[_0x50f127(0x90f)](_0x50f127(0x61d)),await _0x2eb20b());}catch(_0x3d4e5e){_0x17e4ac['history']=_0x17e4ac['history']['filter'](_0x4fe7b1=>!_0x4fe7b1[_0x50f127(0x644)]),!_0x17e4ac['isGroup']&&_0x17e4ac['relationship']?.[_0x50f127(0x93c)]===_0x50f127(0xb79)?(_0x17e4ac[_0x50f127(0xcda)][_0x50f127(0x93c)]=_0x50f127(0x84b),await _0x1519c8(_0x50f127(0x1397),_0x50f127(0xd97)+_0x3d4e5e[_0x50f127(0x757)])):await _0x1519c8('API\x20调用失败',_0x50f127(0x8e8)+_0x3d4e5e['message']),!_0x17e4ac[_0x50f127(0x9d7)]&&_0x17e4ac[_0x50f127(0xcda)]?.[_0x50f127(0x93c)]==='blocked_by_ai'&&await _0xb81d4e[_0x50f127(0x1027)][_0x50f127(0x5d0)](_0x17e4ac),_0x315a6a[_0x50f127(0xbb7)]=![];}finally{_0x156c85(_0xbfff66,![]),_0x17e4ac[_0x50f127(0x9d7)]?_0x15179a&&(_0x15179a[_0x50f127(0x10dd)][_0x50f127(0x678)]=_0x50f127(0xff8)):_0x4fdc0b&&_0x505390['chats'][_0xbfff66]&&(_0x4fdc0b[_0x50f127(0x10dd)]['opacity']=0x0,setTimeout(()=>{const _0x21d3b4=_0x50f127;_0x4fdc0b[_0x21d3b4(0x97b)]=_0x505390[_0x21d3b4(0x1027)][_0xbfff66][_0x21d3b4(0x564)],_0x4fdc0b[_0x21d3b4(0x9cd)][_0x21d3b4(0x8b6)](_0x21d3b4(0x11c7)),_0x4fdc0b[_0x21d3b4(0x10dd)][_0x21d3b4(0x939)]=0x1;},0xc8)),_0x1b7f69(),_0x12c5ce&&_0x170570(_0xbfff66),_0x2a4a67();}}async function _0x2fb2cc(_0x54cf23){const _0xab805=_0x85c4bf;if(!_0x505390[_0xab805(0x233)])return;const _0x194340=_0x505390['chats'][_0x505390[_0xab805(0x233)]],_0x3303da={'role':'user','content':_0x54cf23[_0xab805(0x5f3)],'meaning':_0x54cf23[_0xab805(0x564)],'timestamp':Date[_0xab805(0x12d6)]()};_0x194340[_0xab805(0x7d3)][_0xab805(0x1a0)](_0x3303da),await _0xb81d4e[_0xab805(0x1027)]['put'](_0x194340),_0x48f5ff(_0x3303da,_0x194340),_0x1b7f69(),document[_0xab805(0x479)]('sticker-panel')[_0xab805(0x9cd)][_0xab805(0x8b6)](_0xab805(0x45a));}async function _0x1fe38a(){const _0x480b1a=_0x85c4bf;if(!_0x505390[_0x480b1a(0x233)])return;const _0x225c33=document['getElementById']('transfer-amount'),_0x147c3e=document[_0x480b1a(0x479)]('transfer-note'),_0x26b171=parseFloat(_0x225c33[_0x480b1a(0x4e0)]),_0x1f6ef4=_0x147c3e[_0x480b1a(0x4e0)][_0x480b1a(0x9c1)]();if(isNaN(_0x26b171)||_0x26b171<0x0){alert(_0x480b1a(0x2ce));return;}const _0xf9d8ed=_0x505390['chats'][_0x505390['activeChatId']],_0x51b7d5=_0xf9d8ed['isGroup']?_0xf9d8ed['settings'][_0x480b1a(0xf58)]||'我':'我',_0x3f345f=_0xf9d8ed[_0x480b1a(0x9d7)]?'群聊':_0xf9d8ed['name'],_0x43d076={'role':'user','type':_0x480b1a(0x5f8),'amount':_0x26b171,'note':_0x1f6ef4,'senderName':_0x51b7d5,'receiverName':_0x3f345f,'timestamp':Date[_0x480b1a(0x12d6)]()};_0xf9d8ed[_0x480b1a(0x7d3)][_0x480b1a(0x1a0)](_0x43d076),await _0xb81d4e[_0x480b1a(0x1027)]['put'](_0xf9d8ed),_0x48f5ff(_0x43d076,_0xf9d8ed),_0x1b7f69(),document[_0x480b1a(0x479)]('transfer-modal')[_0x480b1a(0x9cd)][_0x480b1a(0x8b6)](_0x480b1a(0x45a)),_0x225c33[_0x480b1a(0x4e0)]='',_0x147c3e[_0x480b1a(0x4e0)]='';}async function _0x2e4b5b(){const _0x5b4427=_0x85c4bf;if(!_0x505390[_0x5b4427(0x233)])return;const _0x56e056=document['getElementById'](_0x5b4427(0x7e8)),_0x4121af=document[_0x5b4427(0x479)](_0x5b4427(0x1236)),_0x338796=_0x56e056[_0x5b4427(0x4e0)]['trim'](),_0x4321d3=parseFloat(_0x4121af['value']);if(!_0x338796||isNaN(_0x4321d3)||_0x4321d3<=0x0){alert(_0x5b4427(0xc41));return;}const _0x423496=_0x505390['chats'][_0x505390[_0x5b4427(0x233)]],_0x2b2601=Date['now'](),_0x3c9c6a=_0x423496[_0x5b4427(0x9d7)]?_0x423496[_0x5b4427(0x18a)][_0x5b4427(0xf58)]||'我':'我',_0x59127a={'role':_0x5b4427(0x4c5),'senderName':_0x3c9c6a,'type':_0x5b4427(0x4cf),'productInfo':_0x338796,'amount':_0x4321d3,'timestamp':_0x2b2601};_0x423496[_0x5b4427(0x7d3)][_0x5b4427(0x1a0)](_0x59127a);const _0x161728={'role':_0x5b4427(0xbaa),'content':_0x5b4427(0x1295)+_0x3c9c6a+_0x5b4427(0x98f)+_0x338796+_0x5b4427(0x3b0)+_0x4321d3+_0x5b4427(0xd63),'timestamp':_0x2b2601+0x1,'isHidden':!![]};_0x423496[_0x5b4427(0x7d3)]['push'](_0x161728),await _0xb81d4e[_0x5b4427(0x1027)][_0x5b4427(0x5d0)](_0x423496),_0x48f5ff(_0x59127a,_0x423496),_0x1b7f69(),_0x56e056['value']='',_0x4121af[_0x5b4427(0x4e0)]='',document[_0x5b4427(0x479)](_0x5b4427(0xc03))[_0x5b4427(0x9cd)]['remove'](_0x5b4427(0x45a));}async function _0x4ed3c4(){const _0x403237=_0x85c4bf;if(!_0x505390[_0x403237(0x233)])return;const _0x306e5a=await _0x9a2c09(_0x403237(0x8e1),_0x403237(0x8c3),'');if(!_0x306e5a||!_0x306e5a['trim']())return;const _0x156552=_0x403237(0xfed),_0x36e33b=_0x505390[_0x403237(0x1027)][_0x505390[_0x403237(0x233)]],_0x4fc652={'role':_0x403237(0x4c5),'type':'location_share','content':_0x306e5a['trim'](),'imageUrl':_0x156552,'timestamp':Date['now']()};_0x36e33b['history']['push'](_0x4fc652),await _0xb81d4e['chats'][_0x403237(0x5d0)](_0x36e33b),_0x48f5ff(_0x4fc652,_0x36e33b),_0x1b7f69();}function _0x50e948(_0x5c1056){const _0x105080=_0x85c4bf;if(_0x4c148b)return;_0x4c148b=!![],document[_0x105080(0x479)](_0x105080(0xdeb))[_0x105080(0x9cd)][_0x105080(0x807)](_0x105080(0xc9b)),_0x27b22d(_0x5c1056);}function _0x24d789(){const _0x30fc11=_0x85c4bf;_0x599cb2();if(!_0x4c148b)return;_0x4c148b=![],document[_0x30fc11(0x479)]('chat-interface-screen')['classList'][_0x30fc11(0x8b6)](_0x30fc11(0xc9b)),_0x373eab[_0x30fc11(0x12be)](_0x5cd62f=>{const _0x3e245a=_0x30fc11,_0x1d000e=document['querySelector'](_0x3e245a(0x7b8)+_0x5cd62f+'\x22]');if(_0x1d000e)_0x1d000e[_0x3e245a(0x9cd)][_0x3e245a(0x8b6)](_0x3e245a(0x10dc));}),_0x373eab[_0x30fc11(0xf8f)]();}function _0x27b22d(_0x3432fb){const _0x5f36f6=_0x85c4bf,_0x2fa690=document[_0x5f36f6(0x8bc)](_0x5f36f6(0x7b8)+_0x3432fb+'\x22]');if(!_0x2fa690)return;_0x373eab[_0x5f36f6(0x391)](_0x3432fb)?(_0x373eab[_0x5f36f6(0x1ea)](_0x3432fb),_0x2fa690['classList']['remove'](_0x5f36f6(0x10dc))):(_0x373eab['add'](_0x3432fb),_0x2fa690[_0x5f36f6(0x9cd)][_0x5f36f6(0x807)](_0x5f36f6(0x10dc))),document[_0x5f36f6(0x479)](_0x5f36f6(0x22c))['textContent']=_0x5f36f6(0xd0c)+_0x373eab[_0x5f36f6(0xa7a)]+'\x20条',_0x373eab['size']===0x0&&_0x24d789();}function _0x33282f(_0x49969b,_0x1a1a34){const _0xb63b6f=_0x85c4bf;let _0x514071;const _0x5cd67b=_0x27fb02=>{const _0x2c7e0d=_0x6666;if(_0x4c148b)return;_0x27fb02[_0x2c7e0d(0xd58)](),_0x514071=window[_0x2c7e0d(0x20f)](()=>_0x1a1a34(_0x27fb02),0x1f4);},_0x1914a0=()=>clearTimeout(_0x514071);_0x49969b[_0xb63b6f(0xa75)]('mousedown',_0x5cd67b),_0x49969b['addEventListener'](_0xb63b6f(0xe94),_0x1914a0),_0x49969b['addEventListener']('mouseleave',_0x1914a0),_0x49969b[_0xb63b6f(0xa75)](_0xb63b6f(0x2a9),_0x5cd67b,{'passive':!![]}),_0x49969b[_0xb63b6f(0xa75)]('touchend',_0x1914a0),_0x49969b[_0xb63b6f(0xa75)](_0xb63b6f(0x56f),_0x1914a0);}async function _0xda4eb1(){const _0x529d1a=_0x85c4bf,_0x41d501=_0x505390['activeChatId'];if(!_0x41d501)return;if(!_0x304e8d[_0x529d1a(0x4c3)]){_0x43cdf5(_0x41d501);return;}if(_0x304e8d[_0x529d1a(0x233)]===_0x41d501)document['getElementById']('music-player-overlay')[_0x529d1a(0x9cd)][_0x529d1a(0x807)](_0x529d1a(0x45a));else{const _0x1bde91=_0x505390[_0x529d1a(0x1027)][_0x304e8d[_0x529d1a(0x233)]]?.[_0x529d1a(0x564)]||'未知',_0x468c8b=_0x505390[_0x529d1a(0x1027)][_0x41d501]?.[_0x529d1a(0x564)]||'当前',_0x3423db=await _0x1a9e79(_0x529d1a(0x56c),'您正和「'+_0x1bde91+_0x529d1a(0x11aa)+_0x468c8b+_0x529d1a(0x609),{'confirmButtonClass':'btn-danger'});_0x3423db&&(await _0x15b5ff(!![]),await new Promise(_0x4b5b65=>setTimeout(_0x4b5b65,0x32)),_0x43cdf5(_0x41d501));}}async function _0x43cdf5(_0xfb6df7){const _0x37c0ed=_0x85c4bf,_0x272ba2=_0x505390['chats'][_0xfb6df7];if(!_0x272ba2)return;_0x304e8d[_0x37c0ed(0x5c4)]=_0x272ba2['musicData'][_0x37c0ed(0x1316)]||0x0,_0x304e8d[_0x37c0ed(0x4c3)]=!![],_0x304e8d['activeChatId']=_0xfb6df7;_0x304e8d[_0x37c0ed(0x13c7)][_0x37c0ed(0x990)]>0x0?_0x304e8d[_0x37c0ed(0x12a5)]=0x0:_0x304e8d[_0x37c0ed(0x12a5)]=-0x1;if(_0x304e8d[_0x37c0ed(0xe00)])clearInterval(_0x304e8d[_0x37c0ed(0xe00)]);_0x304e8d[_0x37c0ed(0xe00)]=setInterval(()=>{const _0x3230c3=_0x37c0ed;_0x304e8d['isPlaying']&&(_0x304e8d[_0x3230c3(0x5c4)]++,_0x430420());},0x3e8),_0x2f97b8(),_0x582392(),document[_0x37c0ed(0x479)]('music-player-overlay')[_0x37c0ed(0x9cd)]['add']('visible');}async function _0x15b5ff(_0x4323f3=!![]){const _0x2e6d0d=_0x85c4bf;if(!_0x304e8d['isActive'])return;const _0x264bdd=_0x304e8d[_0x2e6d0d(0x233)];document[_0x2e6d0d(0x479)](_0x2e6d0d(0xffe))[_0x2e6d0d(0x9cd)][_0x2e6d0d(0x8b6)](_0x2e6d0d(0x45a));const _0x4546a6=async()=>{const _0x37ff5d=_0x2e6d0d;if(_0x304e8d['timerId'])clearInterval(_0x304e8d[_0x37ff5d(0xe00)]);if(_0x304e8d[_0x37ff5d(0x11c3)])_0x54d46a[_0x37ff5d(0xa80)]();if(_0x4323f3&&_0x264bdd&&_0x505390[_0x37ff5d(0x1027)][_0x264bdd]){const _0xcb8822=_0x505390[_0x37ff5d(0x1027)][_0x264bdd];_0xcb8822[_0x37ff5d(0xac8)]['totalTime']=_0x304e8d['totalElapsedTime'],await _0xb81d4e['chats']['put'](_0xcb8822);}_0x304e8d[_0x37ff5d(0x4c3)]=![],_0x304e8d[_0x37ff5d(0x233)]=null,_0x304e8d[_0x37ff5d(0x5c4)]=0x0,_0x304e8d[_0x37ff5d(0xe00)]=null,_0x28c28a(_0x264bdd,!![]);};_0x4a7289(_0x4546a6);}function _0x4b3e91(){_0x4a7289();}function _0x28c28a(_0xf6e50c,_0x18bf48=![]){const _0x1d3f36=_0x85c4bf,_0x9f8faf=document['querySelector']('#listen-together-btn\x20img');if(!_0x9f8faf)return;if(_0x18bf48||!_0x304e8d[_0x1d3f36(0x4c3)]||_0x304e8d[_0x1d3f36(0x233)]!==_0xf6e50c){_0x9f8faf[_0x1d3f36(0xa9c)]=_0x1d3f36(0x315),_0x9f8faf['className']='';return;}_0x9f8faf[_0x1d3f36(0xa9c)]=_0x1d3f36(0xb46),_0x9f8faf[_0x1d3f36(0x9cd)]['add'](_0x1d3f36(0x48a));if(_0x304e8d[_0x1d3f36(0x11c3)])_0x9f8faf['classList'][_0x1d3f36(0x8b6)](_0x1d3f36(0xd90));else _0x9f8faf[_0x1d3f36(0x9cd)][_0x1d3f36(0x807)](_0x1d3f36(0xd90));}window[_0x85c4bf(0xfbb)]=_0x28c28a;function _0x2f97b8(){const _0x578f8b=_0x85c4bf;_0x28c28a(_0x304e8d[_0x578f8b(0x233)]),_0x430420();const _0x481092=document[_0x578f8b(0x479)]('music-player-song-title'),_0x424de1=document[_0x578f8b(0x479)](_0x578f8b(0xa0a)),_0x374370=document[_0x578f8b(0x479)]('music-play-pause-btn');if(_0x304e8d['currentIndex']>-0x1&&_0x304e8d[_0x578f8b(0x13c7)][_0x578f8b(0x990)]>0x0){const _0x412b81=_0x304e8d[_0x578f8b(0x13c7)][_0x304e8d[_0x578f8b(0x12a5)]];_0x481092['textContent']=_0x412b81[_0x578f8b(0x564)],_0x424de1[_0x578f8b(0x97b)]=_0x412b81[_0x578f8b(0x9d1)];}else _0x481092[_0x578f8b(0x97b)]=_0x578f8b(0x5c3),_0x424de1[_0x578f8b(0x97b)]=_0x578f8b(0x4d0);_0x374370[_0x578f8b(0x97b)]=_0x304e8d['isPlaying']?'❚❚':'▶';}function _0x430420(){const _0x5ad3a6=_0x85c4bf,_0x50ce80=(_0x304e8d[_0x5ad3a6(0x5c4)]/0xe10)[_0x5ad3a6(0x6e1)](0x1);document['getElementById'](_0x5ad3a6(0x110c))[_0x5ad3a6(0x97b)]=_0x5ad3a6(0x3d1)+_0x50ce80+'小时';}function _0x582392(){const _0x5301dd=_0x85c4bf,_0x49a2f1=document['getElementById'](_0x5301dd(0x817));_0x49a2f1[_0x5301dd(0x3de)]='';if(_0x304e8d[_0x5301dd(0x13c7)][_0x5301dd(0x990)]===0x0){_0x49a2f1[_0x5301dd(0x3de)]=_0x5301dd(0xfe6);return;}_0x304e8d[_0x5301dd(0x13c7)][_0x5301dd(0x12be)]((_0x41d772,_0x15a9e4)=>{const _0x536e77=_0x5301dd,_0x38c557=document[_0x536e77(0xbd5)]('div');_0x38c557[_0x536e77(0xfd4)]=_0x536e77(0x921);if(_0x15a9e4===_0x304e8d[_0x536e77(0x12a5)])_0x38c557[_0x536e77(0x9cd)][_0x536e77(0x807)](_0x536e77(0x1321));_0x38c557[_0x536e77(0x3de)]=_0x536e77(0xf6d)+_0x41d772[_0x536e77(0x564)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>'+_0x41d772['artist']+_0x536e77(0x74f)+_0x15a9e4+_0x536e77(0x6a8)+_0x15a9e4+_0x536e77(0x10ad)+_0x15a9e4+'\x22>背景</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20delete-track-btn\x22\x20data-index=\x22'+_0x15a9e4+_0x536e77(0xa88),_0x38c557[_0x536e77(0x8bc)](_0x536e77(0x372))['addEventListener']('click',()=>_0x589174(_0x15a9e4)),_0x49a2f1['appendChild'](_0x38c557);});}async function _0x4adfbd(){const _0x336c62=_0x85c4bf;if(_0x54d46a[_0x336c62(0xd90)]){if(_0x304e8d[_0x336c62(0x12a5)]===-0x1&&_0x304e8d[_0x336c62(0x13c7)][_0x336c62(0x990)]>0x0)_0x589174(0x0);else _0x304e8d['currentIndex']>-0x1&&_0x589174(_0x304e8d[_0x336c62(0x12a5)]);}else _0x54d46a[_0x336c62(0xa80)](),await _0x318ca5(_0x336c62(0x490));}function _0x547a68(){const _0x5549b6=_0x85c4bf;if(_0x304e8d[_0x5549b6(0x13c7)]['length']===0x0)return;let _0x3b7d1f;switch(_0x304e8d[_0x5549b6(0x5ca)]){case'random':_0x3b7d1f=Math[_0x5549b6(0xd71)](Math[_0x5549b6(0x103a)]()*_0x304e8d[_0x5549b6(0x13c7)][_0x5549b6(0x990)]);break;case _0x5549b6(0xf74):_0x589174(_0x304e8d[_0x5549b6(0x12a5)]);return;case _0x5549b6(0x11a3):default:_0x3b7d1f=(_0x304e8d[_0x5549b6(0x12a5)]+0x1)%_0x304e8d[_0x5549b6(0x13c7)][_0x5549b6(0x990)];break;}_0x589174(_0x3b7d1f);}function _0x4f5344(){const _0x15e710=_0x85c4bf;if(_0x304e8d[_0x15e710(0x13c7)][_0x15e710(0x990)]===0x0)return;const _0x45f912=(_0x304e8d['currentIndex']-0x1+_0x304e8d[_0x15e710(0x13c7)][_0x15e710(0x990)])%_0x304e8d[_0x15e710(0x13c7)][_0x15e710(0x990)];_0x589174(_0x45f912);}function _0x3aff44(){const _0x2c2d6a=_0x85c4bf,_0x192866=[_0x2c2d6a(0x11a3),_0x2c2d6a(0x103a),_0x2c2d6a(0xf74)],_0x209f4d=_0x192866[_0x2c2d6a(0xf2f)](_0x304e8d[_0x2c2d6a(0x5ca)]);_0x304e8d[_0x2c2d6a(0x5ca)]=_0x192866[(_0x209f4d+0x1)%_0x192866[_0x2c2d6a(0x990)]],document[_0x2c2d6a(0x479)](_0x2c2d6a(0xaef))[_0x2c2d6a(0x97b)]={'order':'顺序','random':'随机','single':'单曲'}[_0x304e8d[_0x2c2d6a(0x5ca)]];}async function _0x77aab8(){const _0x1b145f=_0x85c4bf,_0x3f1564=await _0x9a2c09(_0x1b145f(0x13df),_0x1b145f(0xc3a),'',_0x1b145f(0x5f3));if(!_0x3f1564)return;const _0x2a934c=await _0x9a2c09(_0x1b145f(0x117e),_0x1b145f(0x4c6));if(!_0x2a934c)return;const _0x109726=await _0x9a2c09('歌曲信息',_0x1b145f(0x805));if(!_0x109726)return;_0x304e8d[_0x1b145f(0x13c7)]['push']({'name':_0x2a934c,'artist':_0x109726,'src':_0x3f1564,'isLocal':![]}),await _0x120ddf(),_0x582392(),_0x304e8d[_0x1b145f(0x12a5)]===-0x1&&(_0x304e8d[_0x1b145f(0x12a5)]=_0x304e8d[_0x1b145f(0x13c7)][_0x1b145f(0x990)]-0x1,_0x2f97b8());}async function _0x3f19d9(_0x4ece60){const _0x5bcaf1=_0x85c4bf,_0x38efce=_0x4ece60[_0x5bcaf1(0xfa2)][_0x5bcaf1(0xe63)];if(!_0x38efce[_0x5bcaf1(0x990)])return;for(const _0x4f43e3 of _0x38efce){let _0x460218=_0x4f43e3[_0x5bcaf1(0x564)][_0x5bcaf1(0x491)](/\.[^/.]+$/,'');_0x460218=await _0x9a2c09(_0x5bcaf1(0x117e),'请输入歌名',_0x460218);if(_0x460218===null)continue;const _0x3e14c7=await _0x9a2c09(_0x5bcaf1(0x117e),_0x5bcaf1(0x805),_0x5bcaf1(0x641));if(_0x3e14c7===null)continue;const _0x3d2868=await _0x4f43e3[_0x5bcaf1(0x4bb)]();let _0x2b9b1f='';const _0x570e42=await _0x1a9e79(_0x5bcaf1(0x12e8),'要为《'+_0x460218+'》添加歌词吗？');_0x570e42&&(_0x2b9b1f=await _0x162d18()||''),_0x304e8d[_0x5bcaf1(0x13c7)][_0x5bcaf1(0x1a0)]({'name':_0x460218,'artist':_0x3e14c7,'src':_0x3d2868,'fileType':_0x4f43e3[_0x5bcaf1(0x858)],'isLocal':!![],'lrcContent':_0x2b9b1f,'cover':_0x5bcaf1(0xd38)});}await _0x120ddf(),_0x582392(),_0x304e8d[_0x5bcaf1(0x12a5)]===-0x1&&_0x304e8d[_0x5bcaf1(0x13c7)]['length']>0x0&&(_0x304e8d[_0x5bcaf1(0x12a5)]=0x0,_0x2f97b8()),_0x4ece60[_0x5bcaf1(0xfa2)][_0x5bcaf1(0x4e0)]=null;}async function _0x589174(_0x461ac4){const _0x4fa409=_0x85c4bf;if(_0x461ac4<0x0||_0x461ac4>=_0x304e8d[_0x4fa409(0x13c7)][_0x4fa409(0x990)])return;_0x54d46a[_0x4fa409(0xa80)](),_0x304e8d['currentIndex']=_0x461ac4;const _0x50c2a2=_0x304e8d[_0x4fa409(0x13c7)][_0x461ac4],_0x3a5a41=_0x505390[_0x4fa409(0x1027)][_0x304e8d[_0x4fa409(0x233)]],_0x36ffe6=document[_0x4fa409(0x479)](_0x4fa409(0x55b));if(_0x3a5a41&&_0x36ffe6){_0x36ffe6[_0x4fa409(0x3de)]='';const _0x553614=_0x3a5a41[_0x4fa409(0x9d7)]?_0x3a5a41[_0x4fa409(0x954)][_0x4fa409(0xc0d)](_0x10d58e=>_0x10d58e['originalName']===_0x50c2a2['artist'])?.['avatar']||_0x28c106:_0x3a5a41[_0x4fa409(0x18a)]['aiAvatar']||_0x28c106,_0x55f9bf=_0x3a5a41[_0x4fa409(0x18a)][_0x4fa409(0xe28)]||_0x28c106,_0xf6ba4d=document[_0x4fa409(0xbd5)](_0x4fa409(0x2a8));_0xf6ba4d[_0x4fa409(0xa9c)]=_0x553614,_0xf6ba4d[_0x4fa409(0xfd4)]=_0x4fa409(0x87d),_0xf6ba4d[_0x4fa409(0xd75)]=_0x4fa409(0xf0a),_0x36ffe6[_0x4fa409(0x9f4)](_0xf6ba4d);const _0x5d0d76=document['createElement'](_0x4fa409(0x2a8));_0x5d0d76[_0x4fa409(0xa9c)]=_0x55f9bf,_0x5d0d76[_0x4fa409(0xfd4)]=_0x4fa409(0x87d),_0x5d0d76[_0x4fa409(0xd75)]=_0x4fa409(0x9a0),_0x36ffe6['appendChild'](_0x5d0d76);}const _0x4779d6=document['querySelector'](_0x4fa409(0x11a1)),_0x15045b=document[_0x4fa409(0x479)]('toggle-blur-btn');_0x4779d6&&(_0x4779d6['style']['setProperty'](_0x4fa409(0x1a2),_0x50c2a2['background']?'url('+_0x50c2a2[_0x4fa409(0x7fb)]+')':_0x4fa409(0xff8)),_0x4779d6['classList']['toggle'](_0x4fa409(0x12ab),!!_0x50c2a2['isBgClear']));_0x15045b&&_0x15045b[_0x4fa409(0x9cd)][_0x4fa409(0x2bf)](_0x4fa409(0x5a9),!!_0x50c2a2[_0x4fa409(0x68f)]);document['getElementById'](_0x4fa409(0xd28))[_0x4fa409(0x9cd)][_0x4fa409(0x8b6)](_0x4fa409(0xd37));const _0x161e41=document[_0x4fa409(0x479)](_0x4fa409(0x311));_0x161e41&&(_0x161e41[_0x4fa409(0xa9c)]=_0x50c2a2['cover']||_0x4fa409(0xd38));await _0x318ca5(_0x4fa409(0xe43)+_0x50c2a2[_0x4fa409(0x564)]+'》'),_0x304e8d[_0x4fa409(0x6f2)]=_0x1a5b5e(_0x50c2a2[_0x4fa409(0x101f)]||''),_0x2097bb();const _0x4e23d6=document[_0x4fa409(0x479)]('single-lyric-display');_0x4e23d6&&(!_0x304e8d[_0x4fa409(0x6f2)]||_0x304e8d[_0x4fa409(0x6f2)]['length']===0x0?_0x4e23d6['textContent']='纯音乐，请欣赏':_0x4e23d6[_0x4fa409(0x97b)]=_0x4fa409(0xb30));if(_0x50c2a2[_0x4fa409(0x755)]&&_0x50c2a2['src']instanceof ArrayBuffer){const _0x416795=new Blob([_0x50c2a2['src']],{'type':_0x50c2a2[_0x4fa409(0x416)]||_0x4fa409(0xc55)});_0x54d46a[_0x4fa409(0xa9c)]=URL[_0x4fa409(0xe9c)](_0x416795);}else{if(_0x50c2a2[_0x4fa409(0x755)]&&_0x50c2a2[_0x4fa409(0xa9c)]instanceof Blob)_0x54d46a['src']=URL[_0x4fa409(0xe9c)](_0x50c2a2[_0x4fa409(0xa9c)]);else{if(!_0x50c2a2[_0x4fa409(0x755)])_0x54d46a['src']=_0x50c2a2['src'];else{console['error'](_0x4fa409(0x1038),_0x50c2a2);return;}}}const _0x52255e=_0x54d46a['play']();_0x52255e!==undefined&&_0x52255e[_0x4fa409(0x575)](_0x33522d=>{const _0x246186=_0x4fa409;if(_0x33522d[_0x246186(0x564)]==='NotAllowedError')console[_0x246186(0x139e)](_0x246186(0x88b)),_0x54d46a[_0x246186(0xa80)](),_0x1519c8(_0x246186(0x3c4),_0x246186(0xf6f));else _0x33522d[_0x246186(0x564)]!=='AbortError'&&console[_0x246186(0xe3b)](_0x246186(0x526),_0x33522d);});_0x582392(),_0x2f97b8(),_0x2db015();const _0x2fe344=document[_0x4fa409(0x479)](_0x4fa409(0xffe));_0x304e8d[_0x4fa409(0x6f2)]&&_0x304e8d[_0x4fa409(0x6f2)][_0x4fa409(0x990)]>0x0?(_0x2fe344[_0x4fa409(0x97b)]='♪',_0x2fe344['classList']['add'](_0x4fa409(0x45a))):_0x2fe344[_0x4fa409(0x9cd)][_0x4fa409(0x8b6)](_0x4fa409(0x45a));}async function _0xf689b(_0x23239f){const _0x593d9c=_0x85c4bf;if(_0x23239f<0x0||_0x23239f>=_0x304e8d[_0x593d9c(0x13c7)][_0x593d9c(0x990)])return;const _0x510066=await _0x5adb5e(_0x593d9c(0x10ae),[{'text':_0x593d9c(0x83f),'value':'local'},{'text':_0x593d9c(0x10d7),'value':'url'}]);let _0xa2a1cb=null;if(_0x510066==='local')_0xa2a1cb=await _0x1ec1dd();else _0x510066===_0x593d9c(0x5f3)&&(_0xa2a1cb=await _0x9a2c09(_0x593d9c(0xf8e),_0x593d9c(0x107e),'',_0x593d9c(0x5f3)));if(_0xa2a1cb&&_0xa2a1cb[_0x593d9c(0x9c1)]()){_0x304e8d[_0x593d9c(0x13c7)][_0x23239f][_0x593d9c(0x7fb)]=_0xa2a1cb[_0x593d9c(0x9c1)](),await _0x120ddf();if(_0x304e8d[_0x593d9c(0x12a5)]===_0x23239f){const _0x5b3b4e=document[_0x593d9c(0x8bc)](_0x593d9c(0x11a1));_0x5b3b4e[_0x593d9c(0x10dd)]['setProperty'](_0x593d9c(0x1a2),_0x593d9c(0x10d2)+_0xa2a1cb[_0x593d9c(0x9c1)]()+')');}await _0x1519c8('成功','歌曲背景已更新！');}}async function _0x5744b4(_0x97fbac){const _0x3e5a73=_0x85c4bf;if(_0x97fbac<0x0||_0x97fbac>=_0x304e8d['playlist']['length'])return;const _0x22dbb4=await _0x5adb5e(_0x3e5a73(0x63b),[{'text':'📁\x20从本地上传','value':_0x3e5a73(0x8d3)},{'text':_0x3e5a73(0x10d7),'value':_0x3e5a73(0x5f3)}]);let _0x2709fc=null;if(_0x22dbb4===_0x3e5a73(0x8d3))_0x2709fc=await _0x1ec1dd();else _0x22dbb4===_0x3e5a73(0x5f3)&&(_0x2709fc=await _0x9a2c09(_0x3e5a73(0xf8e),'请输入新的封面图片链接','',_0x3e5a73(0x5f3)));if(_0x2709fc&&_0x2709fc[_0x3e5a73(0x9c1)]()){_0x304e8d[_0x3e5a73(0x13c7)][_0x97fbac][_0x3e5a73(0x82e)]=_0x2709fc['trim'](),await _0x120ddf();if(_0x304e8d['currentIndex']===_0x97fbac){document[_0x3e5a73(0x479)](_0x3e5a73(0x311))[_0x3e5a73(0xa9c)]=_0x2709fc[_0x3e5a73(0x9c1)]();const _0x2041c7=document['querySelector']('#vinyl-view\x20#music-player-cover');if(_0x2041c7)_0x2041c7[_0x3e5a73(0xa9c)]=_0x2709fc[_0x3e5a73(0x9c1)]();}await _0x1519c8('成功',_0x3e5a73(0x1212));}}async function _0x2a6ace(_0x74ece8){const _0xb2565f=_0x85c4bf;if(_0x74ece8<0x0||_0x74ece8>=_0x304e8d[_0xb2565f(0x13c7)][_0xb2565f(0x990)])return;const _0x17d79e=_0x304e8d[_0xb2565f(0x13c7)][_0x74ece8],_0x2dc8a6=_0x304e8d[_0xb2565f(0x11c3)]&&_0x304e8d['currentIndex']===_0x74ece8;if(_0x17d79e['isLocal']&&_0x54d46a[_0xb2565f(0xa9c)]['startsWith'](_0xb2565f(0xc69))&&_0x304e8d[_0xb2565f(0x12a5)]===_0x74ece8)URL[_0xb2565f(0xed5)](_0x54d46a[_0xb2565f(0xa9c)]);_0x304e8d[_0xb2565f(0x13c7)][_0xb2565f(0x118e)](_0x74ece8,0x1),await _0x120ddf();if(_0x304e8d[_0xb2565f(0x13c7)][_0xb2565f(0x990)]===0x0){if(_0x304e8d[_0xb2565f(0x11c3)])_0x54d46a[_0xb2565f(0xa80)]();_0x54d46a[_0xb2565f(0xa9c)]='',_0x304e8d[_0xb2565f(0x12a5)]=-0x1,_0x304e8d[_0xb2565f(0x11c3)]=![];}else{if(_0x2dc8a6)_0x547a68();else{if(_0x304e8d['currentIndex']>=_0x74ece8)_0x304e8d[_0xb2565f(0x12a5)]=Math['max'](0x0,_0x304e8d[_0xb2565f(0x12a5)]-0x1);}}_0x2f97b8(),_0x582392();}async function _0x3f19d9(_0x54f9b3){const _0x571660=_0x85c4bf,_0x1a06e0=_0x54f9b3['target']['files'];if(!_0x1a06e0[_0x571660(0x990)])return;for(const _0x51ad64 of _0x1a06e0){let _0x7ac90e=_0x51ad64[_0x571660(0x564)][_0x571660(0x491)](/\.[^/.]+$/,'');_0x7ac90e=await _0x9a2c09(_0x571660(0x117e),_0x571660(0x4c6),_0x7ac90e);if(_0x7ac90e===null)continue;const _0xca481c=await _0x9a2c09(_0x571660(0x117e),_0x571660(0x805),_0x571660(0x641));if(_0xca481c===null)continue;let _0x1b0a58='';const _0x1b0f5f=await _0x1a9e79(_0x571660(0x12e8),'要为《'+_0x7ac90e+'》添加歌词吗？');_0x1b0f5f&&(_0x1b0a58=await _0x162d18()||''),_0x304e8d[_0x571660(0x13c7)][_0x571660(0x1a0)]({'name':_0x7ac90e,'artist':_0xca481c,'src':_0x51ad64,'isLocal':!![],'lrcContent':_0x1b0a58});}await _0x120ddf(),_0x582392(),_0x304e8d['currentIndex']===-0x1&&_0x304e8d[_0x571660(0x13c7)]['length']>0x0&&(_0x304e8d['currentIndex']=0x0,_0x2f97b8()),_0x54f9b3[_0x571660(0xfa2)][_0x571660(0x4e0)]=null;}async function _0x2a6ace(_0xbcbc2c){const _0x255717=_0x85c4bf;if(_0xbcbc2c<0x0||_0xbcbc2c>=_0x304e8d[_0x255717(0x13c7)][_0x255717(0x990)])return;const _0x4ef2bb=_0x304e8d[_0x255717(0x13c7)][_0xbcbc2c],_0xbb4f70=_0x304e8d[_0x255717(0x11c3)]&&_0x304e8d[_0x255717(0x12a5)]===_0xbcbc2c;if(_0x4ef2bb[_0x255717(0x755)]&&_0x54d46a['src'][_0x255717(0x591)](_0x255717(0xc69))&&_0x304e8d[_0x255717(0x12a5)]===_0xbcbc2c)URL[_0x255717(0xed5)](_0x54d46a[_0x255717(0xa9c)]);_0x304e8d[_0x255717(0x13c7)]['splice'](_0xbcbc2c,0x1),await _0x120ddf();if(_0x304e8d[_0x255717(0x13c7)][_0x255717(0x990)]===0x0){if(_0x304e8d[_0x255717(0x11c3)])_0x54d46a[_0x255717(0xa80)]();_0x54d46a[_0x255717(0xa9c)]='',_0x304e8d[_0x255717(0x12a5)]=-0x1,_0x304e8d[_0x255717(0x11c3)]=![];}else{if(_0xbb4f70)_0x547a68();else{if(_0x304e8d[_0x255717(0x12a5)]>=_0xbcbc2c)_0x304e8d['currentIndex']=Math[_0x255717(0x6b8)](0x0,_0x304e8d[_0x255717(0x12a5)]-0x1);}}_0x2f97b8(),_0x582392();}const _0x24fab5=document[_0x85c4bf(0x479)]('persona-library-modal'),_0x1e0049=document['getElementById']('persona-editor-modal'),_0x37413a=document[_0x85c4bf(0x479)](_0x85c4bf(0xf62));function _0x45b462(){const _0x480295=_0x85c4bf;_0x13da26(),_0x24fab5[_0x480295(0x9cd)][_0x480295(0x807)](_0x480295(0x45a));}function _0xf7de35(){const _0x36a9da=_0x85c4bf;_0x24fab5[_0x36a9da(0x9cd)][_0x36a9da(0x8b6)](_0x36a9da(0x45a));}function _0x13da26(){const _0x507b5b=_0x85c4bf,_0x2634ba=document['getElementById']('persona-library-grid');_0x2634ba[_0x507b5b(0x3de)]='';if(_0x505390[_0x507b5b(0x56b)][_0x507b5b(0x990)]===0x0){_0x2634ba[_0x507b5b(0x3de)]=_0x507b5b(0x132d);return;}_0x505390[_0x507b5b(0x56b)]['forEach'](_0x367908=>{const _0x343015=_0x507b5b,_0x2e79a4=document[_0x343015(0xbd5)](_0x343015(0x6c8));_0x2e79a4['className']=_0x343015(0xd0d),_0x2e79a4[_0x343015(0x10dd)][_0x343015(0x13b9)]=_0x343015(0x10d2)+_0x367908['avatar']+')',_0x2e79a4[_0x343015(0x13d4)][_0x343015(0x406)]=_0x367908['id'],_0x2e79a4[_0x343015(0xa75)]('click',()=>_0x2be6fc(_0x367908['id'])),_0x33282f(_0x2e79a4,()=>_0xd79e19(_0x367908['id'])),_0x2634ba[_0x343015(0x9f4)](_0x2e79a4);});}function _0xd79e19(_0x3d0e06){const _0x452f1a=_0x85c4bf;_0x58c244=_0x3d0e06,_0x37413a[_0x452f1a(0x9cd)][_0x452f1a(0x807)](_0x452f1a(0x45a));}function _0x3ac37e(){const _0x8ad813=_0x85c4bf;_0x37413a[_0x8ad813(0x9cd)][_0x8ad813(0x8b6)](_0x8ad813(0x45a)),_0x58c244=null;}function _0x2be6fc(_0x2d7d97){const _0x54392c=_0x85c4bf,_0x3e3ad2=_0x505390[_0x54392c(0x56b)][_0x54392c(0xc0d)](_0x39c7f6=>_0x39c7f6['id']===_0x2d7d97);_0x3e3ad2&&(document['getElementById'](_0x54392c(0xdfe))['src']=_0x3e3ad2['avatar'],document[_0x54392c(0x479)](_0x54392c(0x269))['value']=_0x3e3ad2[_0x54392c(0x596)]),_0xf7de35();}function _0x46fee0(){const _0x10c443=_0x85c4bf;_0x58c244=null,document[_0x10c443(0x479)]('persona-editor-title')['textContent']='添加人设预设',document['getElementById']('preset-avatar-preview')[_0x10c443(0xa9c)]=_0x28c106,document['getElementById'](_0x10c443(0x3b5))[_0x10c443(0x4e0)]='',_0x1e0049['classList'][_0x10c443(0x807)](_0x10c443(0x45a));}function _0x1b6c65(){const _0x2cc905=_0x85c4bf,_0x238969=_0x505390[_0x2cc905(0x56b)]['find'](_0x24a34e=>_0x24a34e['id']===_0x58c244);if(!_0x238969)return;document['getElementById']('persona-editor-title')[_0x2cc905(0x97b)]=_0x2cc905(0xe3d),document[_0x2cc905(0x479)]('preset-avatar-preview')[_0x2cc905(0xa9c)]=_0x238969[_0x2cc905(0x799)],document[_0x2cc905(0x479)](_0x2cc905(0x3b5))[_0x2cc905(0x4e0)]=_0x238969[_0x2cc905(0x596)],_0x37413a[_0x2cc905(0x9cd)][_0x2cc905(0x8b6)](_0x2cc905(0x45a)),_0x1e0049['classList'][_0x2cc905(0x807)](_0x2cc905(0x45a));}async function _0x403b7d(){const _0x43e491=_0x85c4bf,_0x2aa93f=await _0x1a9e79(_0x43e491(0x1143),_0x43e491(0x1349),{'confirmButtonClass':_0x43e491(0x95a)});_0x2aa93f&&_0x58c244&&(await _0xb81d4e[_0x43e491(0x56b)][_0x43e491(0x1ea)](_0x58c244),_0x505390[_0x43e491(0x56b)]=_0x505390[_0x43e491(0x56b)]['filter'](_0x4146db=>_0x4146db['id']!==_0x58c244),_0x3ac37e(),_0x13da26());}function _0x4d2b7(){const _0x47b9ec=_0x85c4bf;_0x1e0049[_0x47b9ec(0x9cd)][_0x47b9ec(0x8b6)](_0x47b9ec(0x45a)),_0x58c244=null;}async function _0xc976f1(){const _0x18502c=_0x85c4bf,_0x457297=document[_0x18502c(0x479)](_0x18502c(0x675))[_0x18502c(0xa9c)],_0x1b6f8a=document['getElementById'](_0x18502c(0x3b5))[_0x18502c(0x4e0)]['trim']();if(_0x457297===_0x28c106&&!_0x1b6f8a){alert('头像和人设不能都为空哦！');return;}if(_0x58c244){const _0x5f2a80=_0x505390[_0x18502c(0x56b)][_0x18502c(0xc0d)](_0x73ede7=>_0x73ede7['id']===_0x58c244);_0x5f2a80&&(_0x5f2a80['avatar']=_0x457297,_0x5f2a80['persona']=_0x1b6f8a,await _0xb81d4e[_0x18502c(0x56b)][_0x18502c(0x5d0)](_0x5f2a80));}else{const _0x2e8652={'id':_0x18502c(0x75f)+Date[_0x18502c(0x12d6)](),'avatar':_0x457297,'persona':_0x1b6f8a};await _0xb81d4e['personaPresets'][_0x18502c(0x807)](_0x2e8652),_0x505390[_0x18502c(0x56b)][_0x18502c(0x1a0)](_0x2e8652);}_0x13da26(),_0x4d2b7();}const _0x3fcbd8=document[_0x85c4bf(0x479)](_0x85c4bf(0x59c));function _0x3f44cd(_0x4b3adf,_0x1c2f37){const _0x4a2789=_0x85c4bf;clearTimeout(_0x3dfb93),document['getElementById'](_0x4a2789(0xcd1))[_0x4a2789(0xa9c)]=_0x4b3adf,document[_0x4a2789(0x479)]('battery-alert-text')[_0x4a2789(0x97b)]=_0x1c2f37,_0x3fcbd8[_0x4a2789(0x9cd)]['add'](_0x4a2789(0x45a));const _0x1a4c62=()=>{const _0x5e8c4d=_0x4a2789;_0x3fcbd8['classList'][_0x5e8c4d(0x8b6)](_0x5e8c4d(0x45a)),_0x3fcbd8[_0x5e8c4d(0xdec)](_0x5e8c4d(0xd2f),_0x1a4c62);};_0x3fcbd8[_0x4a2789(0xa75)](_0x4a2789(0xd2f),_0x1a4c62),_0x3dfb93=setTimeout(_0x1a4c62,0x7d0);}function _0x42da35(_0x24502a){const _0x473d4c=_0x85c4bf,_0x55d03d=document[_0x473d4c(0x479)](_0x473d4c(0x301)),_0x3ab8c2=_0x55d03d[_0x473d4c(0x8bc)](_0x473d4c(0xc0c)),_0x599bac=_0x55d03d[_0x473d4c(0x8bc)](_0x473d4c(0x114a)),_0x45f298=Math[_0x473d4c(0xd71)](_0x24502a[_0x473d4c(0xda0)]*0x64);_0x3ab8c2[_0x473d4c(0x10dd)]['width']=_0x45f298+'%',_0x599bac[_0x473d4c(0x97b)]=_0x45f298+'%',_0x24502a[_0x473d4c(0x423)]?_0x55d03d[_0x473d4c(0x9cd)][_0x473d4c(0x807)](_0x473d4c(0x423)):_0x55d03d[_0x473d4c(0x9cd)][_0x473d4c(0x8b6)](_0x473d4c(0x423));}function _0x54764a(_0x1c0585){const _0x1628c0=_0x85c4bf;_0x42da35(_0x1c0585);const _0x1a789a=_0x1c0585['level'];!_0x1c0585['charging']&&(_0x1a789a<=0.4&&_0x5c5137>0.4&&!_0x35df2c[_0x1628c0(0xd9b)]&&(_0x3f44cd('https://i.postimg.cc/T2yKJ0DV/40.jpg',_0x1628c0(0x9a9)),_0x35df2c[_0x1628c0(0xd9b)]=!![]),_0x1a789a<=0.2&&_0x5c5137>0.2&&!_0x35df2c[_0x1628c0(0xef1)]&&(_0x3f44cd(_0x1628c0(0xbdb),'赶紧的充电，要饿死了'),_0x35df2c[_0x1628c0(0xef1)]=!![]),_0x1a789a<=0.1&&_0x5c5137>0.1&&!_0x35df2c[_0x1628c0(0x1079)]&&(_0x3f44cd(_0x1628c0(0x647),_0x1628c0(0xd8d)),_0x35df2c[_0x1628c0(0x1079)]=!![]));if(_0x1a789a>0.4)_0x35df2c[_0x1628c0(0xd9b)]=![];if(_0x1a789a>0.2)_0x35df2c[_0x1628c0(0xef1)]=![];if(_0x1a789a>0.1)_0x35df2c[_0x1628c0(0x1079)]=![];_0x5c5137=_0x1a789a;}async function _0x44f426(){const _0x50b868=_0x85c4bf;if('getBattery'in navigator)try{const _0x311666=await navigator[_0x50b868(0x7cb)]();_0x5c5137=_0x311666[_0x50b868(0xda0)],_0x54764a(_0x311666),_0x311666['addEventListener'](_0x50b868(0x392),()=>_0x54764a(_0x311666)),_0x311666['addEventListener'](_0x50b868(0xf86),()=>{const _0x238cfc=_0x50b868;_0x54764a(_0x311666),_0x311666[_0x238cfc(0x423)]&&_0x3f44cd('https://i.postimg.cc/3NDQ0dWG/image.jpg','窝爱泥，电量吃饱饱');});}catch(_0x2a3485){console[_0x50b868(0xe3b)](_0x50b868(0xab2),_0x2a3485),document[_0x50b868(0x8bc)](_0x50b868(0x114a))[_0x50b868(0x97b)]=_0x50b868(0x75d);}else console[_0x50b868(0x90f)]('浏览器不支持电池状态API。'),document['querySelector'](_0x50b868(0x114a))[_0x50b868(0x97b)]=_0x50b868(0x75d);}async function _0x118dd8(){const _0x5a3aad=_0x85c4bf,_0x216d2a=document[_0x5a3aad(0x479)](_0x5a3aad(0x1099));if(!_0x216d2a)return;const _0xcbd5aa=await _0xb81d4e['qzoneAlbums'][_0x5a3aad(0x3d2)](_0x5a3aad(0x114f))['reverse']()[_0x5a3aad(0x4ba)]();_0x216d2a['innerHTML']='';if(_0xcbd5aa[_0x5a3aad(0x990)]===0x0){_0x216d2a['innerHTML']=_0x5a3aad(0x10cc);return;}_0xcbd5aa[_0x5a3aad(0x12be)](_0x20b11d=>{const _0x565769=_0x5a3aad,_0x7d6048=document[_0x565769(0xbd5)](_0x565769(0x6c8));_0x7d6048[_0x565769(0xfd4)]=_0x565769(0x9b1),_0x7d6048['innerHTML']=_0x565769(0x139b)+_0x20b11d[_0x565769(0x370)]+_0x565769(0x9fe)+_0x20b11d['name']+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22album-count\x22>'+(_0x20b11d[_0x565769(0x3c3)]||0x0)+'\x20张</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x7d6048[_0x565769(0xa75)](_0x565769(0xd2f),()=>{_0x535f63(_0x20b11d['id']);}),_0x33282f(_0x7d6048,async()=>{const _0x4b99e7=_0x565769,_0x246d42=await _0x1a9e79('删除相册',_0x4b99e7(0xee4)+_0x20b11d[_0x4b99e7(0x564)]+'》吗？此操作将同时删除相册内的所有照片，且无法恢复。',{'confirmButtonClass':_0x4b99e7(0x95a)});_0x246d42&&(await _0xb81d4e[_0x4b99e7(0x340)][_0x4b99e7(0x46f)](_0x4b99e7(0x127c))[_0x4b99e7(0x4a2)](_0x20b11d['id'])['delete'](),await _0xb81d4e['qzoneAlbums'][_0x4b99e7(0x1ea)](_0x20b11d['id']),await _0x118dd8(),alert(_0x4b99e7(0x661)));}),_0x216d2a[_0x565769(0x9f4)](_0x7d6048);});}async function _0x535f63(_0x318067){const _0x3bd795=_0x85c4bf;_0x505390['activeAlbumId']=_0x318067,await _0x25856b(),_0x731d5(_0x3bd795(0x607));}async function _0x25856b(){const _0x32eb21=_0x85c4bf;if(!_0x505390[_0x32eb21(0x3dc)])return;const _0x590ed4=document[_0x32eb21(0x479)](_0x32eb21(0x62e)),_0x225458=document[_0x32eb21(0x479)](_0x32eb21(0xc3d)),_0x279458=await _0xb81d4e[_0x32eb21(0xdf4)]['get'](_0x505390[_0x32eb21(0x3dc)]);if(!_0x279458){console[_0x32eb21(0xe3b)]('找不到相册:',_0x505390['activeAlbumId']),_0x731d5(_0x32eb21(0x428));return;}_0x225458['textContent']=_0x279458[_0x32eb21(0x564)];const _0x3f6d7d=await _0xb81d4e[_0x32eb21(0x340)][_0x32eb21(0x46f)](_0x32eb21(0x127c))[_0x32eb21(0x4a2)](_0x505390['activeAlbumId'])[_0x32eb21(0x4ba)]();_0x590ed4['innerHTML']='',_0x3f6d7d['length']===0x0?_0x590ed4[_0x32eb21(0x3de)]='<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>这个相册还是空的，快上传第一张照片吧！</p>':_0x3f6d7d[_0x32eb21(0x12be)](_0x365d4b=>{const _0x1fb616=_0x32eb21,_0x376a9d=document[_0x1fb616(0xbd5)](_0x1fb616(0x6c8));_0x376a9d[_0x1fb616(0xfd4)]=_0x1fb616(0x917),_0x376a9d[_0x1fb616(0x3de)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x365d4b[_0x1fb616(0x5f3)]+_0x1fb616(0x36e)+_0x365d4b['id']+_0x1fb616(0x2c2),_0x590ed4['appendChild'](_0x376a9d);});}async function _0x30f87f(_0x5e3227){const _0x124d79=_0x85c4bf;if(!_0x505390['activeAlbumId'])return;const _0x130a6f=await _0xb81d4e[_0x124d79(0x340)]['where'](_0x124d79(0x127c))['equals'](_0x505390[_0x124d79(0x3dc)])['toArray']();_0x4a2783[_0x124d79(0x13aa)]=_0x130a6f[_0x124d79(0x2e1)](_0x510dc3=>_0x510dc3[_0x124d79(0x5f3)]),_0x4a2783[_0x124d79(0x12a5)]=_0x4a2783['photos'][_0x124d79(0x120c)](_0x28548d=>_0x28548d===_0x5e3227);if(_0x4a2783['currentIndex']===-0x1)return;document[_0x124d79(0x479)](_0x124d79(0xc43))[_0x124d79(0x9cd)]['add'](_0x124d79(0x45a)),_0x34595b(),_0x4a2783[_0x124d79(0xeb9)]=!![];}function _0x34595b(){const _0x4da99e=_0x85c4bf;if(_0x4a2783['currentIndex']===-0x1)return;const _0x157890=document[_0x4da99e(0x479)](_0x4da99e(0x466)),_0x4375e4=document[_0x4da99e(0x479)]('photo-viewer-prev-btn'),_0x20db8f=document[_0x4da99e(0x479)](_0x4da99e(0xb16));_0x157890[_0x4da99e(0x10dd)]['opacity']=0x0,setTimeout(()=>{const _0x44326f=_0x4da99e;_0x157890[_0x44326f(0xa9c)]=_0x4a2783[_0x44326f(0x13aa)][_0x4a2783[_0x44326f(0x12a5)]],_0x157890[_0x44326f(0x10dd)][_0x44326f(0x939)]=0x1;},0x64),_0x4375e4[_0x4da99e(0xfce)]=_0x4a2783['currentIndex']===0x0,_0x20db8f[_0x4da99e(0xfce)]=_0x4a2783[_0x4da99e(0x12a5)]===_0x4a2783[_0x4da99e(0x13aa)]['length']-0x1;}function _0x592426(){const _0x4c7899=_0x85c4bf;_0x4a2783[_0x4c7899(0x12a5)]<_0x4a2783[_0x4c7899(0x13aa)][_0x4c7899(0x990)]-0x1&&(_0x4a2783[_0x4c7899(0x12a5)]++,_0x34595b());}function _0x4adc96(){const _0x54657a=_0x85c4bf;_0x4a2783[_0x54657a(0x12a5)]>0x0&&(_0x4a2783[_0x54657a(0x12a5)]--,_0x34595b());}function _0x11805e(){const _0x4163c2=_0x85c4bf;document[_0x4163c2(0x479)](_0x4163c2(0xc43))[_0x4163c2(0x9cd)][_0x4163c2(0x8b6)](_0x4163c2(0x45a)),_0x4a2783[_0x4163c2(0xeb9)]=![],_0x4a2783['photos']=[],_0x4a2783[_0x4163c2(0x12a5)]=-0x1,document[_0x4163c2(0x479)](_0x4163c2(0x466))['src']='';}function _0xa385c3(_0x5c5bdf){const _0x131099=_0x85c4bf;_0x22cc4e=_0x5c5bdf,localStorage[_0x131099(0x3f0)](_0x131099(0x1029),_0x5c5bdf);const _0x40f973=document['querySelector'](_0x131099(0x3f8)),_0x5c8953=_0x40f973[_0x131099(0x8bc)](_0x131099(0xf91));let _0x2a2f72=_0x40f973['querySelector'](_0x131099(0xb90));_0x5c5bdf>0x0?(!_0x2a2f72&&(_0x2a2f72=document[_0x131099(0xbd5)]('span'),_0x2a2f72['className']=_0x131099(0x369),_0x5c8953[_0x131099(0x10dd)][_0x131099(0xee0)]=_0x131099(0x22b),_0x5c8953[_0x131099(0x9f4)](_0x2a2f72)),_0x2a2f72['textContent']=_0x5c5bdf>0x63?'99+':_0x5c5bdf,_0x2a2f72['style'][_0x131099(0x678)]=_0x131099(0xee3)):_0x2a2f72&&(_0x2a2f72[_0x131099(0x10dd)][_0x131099(0x678)]=_0x131099(0xff8)),_0x3f74ae();}function _0x351d83(){const _0x505afe=_0x85c4bf;if(_0x2f1d11)return;const _0xff25d1=_0x505390[_0x505afe(0x888)][_0x505afe(0xe65)]||0x3c;_0x2f1d11=setInterval(_0x251922,_0xff25d1*0x3e8),_0x91c8a5();}function _0x9397c8(){_0x2f1d11&&(clearInterval(_0x2f1d11),_0x2f1d11=null),_0x2a4a67();}async function _0x251922(){const _0x178217=_0x85c4bf;console[_0x178217(0x90f)](_0x178217(0xe42));if(!_0x505390[_0x178217(0x888)]['enableBackgroundActivity']){_0x9397c8();return;}const _0x1571fd=Object[_0x178217(0x3d5)](_0x505390[_0x178217(0x1027)])[_0x178217(0x85d)](_0x27879e=>!_0x27879e[_0x178217(0x9d7)]);_0x1571fd['forEach'](_0x2bebb1=>{const _0x4c2d59=_0x178217;if(_0x2bebb1[_0x4c2d59(0xcda)]?.[_0x4c2d59(0x93c)]===_0x4c2d59(0x89f)){const _0x5ad990=_0x2bebb1[_0x4c2d59(0xcda)][_0x4c2d59(0x122a)];if(!_0x5ad990)return;const _0x6c6611=Date[_0x4c2d59(0x12d6)]()-_0x5ad990,_0x1be5b4=(_0x505390[_0x4c2d59(0x888)]['blockCooldownHours']||0x1)*0x3c*0x3c*0x3e8;_0x6c6611>_0x1be5b4&&(_0x2bebb1[_0x4c2d59(0xcda)][_0x4c2d59(0x93c)]=_0x4c2d59(0x45d),_0x1f5dd9(_0x2bebb1['id']));}else{if(_0x2bebb1[_0x4c2d59(0xcda)]?.['status']==='friend'&&_0x2bebb1['id']!==_0x505390['activeChatId']){if(_0x2bebb1[_0x4c2d59(0x18a)][_0x4c2d59(0xc00)]===![]){console[_0x4c2d59(0x90f)](_0x4c2d59(0xced)+_0x2bebb1[_0x4c2d59(0x564)]+_0x4c2d59(0x4ab));return;}Math[_0x4c2d59(0x103a)]()<0.2&&(console[_0x4c2d59(0x90f)]('角色\x20\x22'+_0x2bebb1[_0x4c2d59(0x564)]+_0x4c2d59(0x10df)),_0x24c27f(_0x2bebb1['id']));}}});const _0x19bdab=Object['values'](_0x505390['chats'])[_0x178217(0x85d)](_0x4f2f57=>_0x4f2f57[_0x178217(0x9d7)]);_0x19bdab[_0x178217(0x12be)](_0x2d94bd=>{const _0x36bf36=_0x178217;if(_0x2d94bd['settings'][_0x36bf36(0xc00)]===![]){console[_0x36bf36(0x90f)](_0x36bf36(0xef8)+_0x2d94bd[_0x36bf36(0x564)]+_0x36bf36(0x6c4));return;}_0x2d94bd['id']!==_0x505390['activeChatId']&&Math[_0x36bf36(0x103a)]()<0.1&&(console[_0x36bf36(0x90f)]('群聊\x20\x22'+_0x2d94bd[_0x36bf36(0x564)]+_0x36bf36(0x10df)),_0x3b7a94(_0x2d94bd['id']));});try{const _0x24e3da=await _0xb81d4e[_0x178217(0x482)][_0x178217(0x4ba)]();if(_0x24e3da[_0x178217(0x990)]===0x0)return;const _0x36f2be=await _0xb81d4e[_0x178217(0xcce)][_0x178217(0x3d2)](_0x178217(0x12a2))[_0x178217(0x336)]()[_0x178217(0xca0)](0xa)[_0x178217(0x4ba)]();for(const _0x302621 of _0x24e3da){if(_0x302621['enableBackgroundActivity']===![])continue;const _0x34ee98=_0x302621['actionCooldownMinutes']||0xf;if(_0x302621[_0x178217(0xa28)]){const _0x2e4314=(Date[_0x178217(0x12d6)]()-_0x302621[_0x178217(0xa28)])/(0x3e8*0x3c);if(_0x2e4314<_0x34ee98)continue;}if(Math[_0x178217(0x103a)]()>0.3)continue;const _0x5f2b41=[];for(const _0x4943bc of _0x36f2be){if(_0x4943bc[_0x178217(0x981)]===_0x178217(0xca5)+_0x302621['id'])continue;const _0x4a6542=_0x4943bc['comments']?.[_0x178217(0x1235)](_0x22f72e=>_0x22f72e[_0x178217(0x32a)]===_0x302621[_0x178217(0x564)]),_0x28ad5b=_0x4943bc[_0x178217(0xd3c)]?.[_0x178217(0x777)](-0x1)[0x0]?.[_0x178217(0x13e3)];if(_0x28ad5b===_0x302621['name'])continue;let _0x5afd83=![];if(_0x4943bc['authorId']==='user'||_0x4943bc[_0x178217(0x981)][_0x178217(0x591)](_0x178217(0x8f9)))_0x302621[_0x178217(0x11a0)]['includes'](_0x4943bc[_0x178217(0x981)])&&(_0x5afd83=!![]);else{if(_0x4943bc[_0x178217(0x981)][_0x178217(0x591)](_0x178217(0xca5))){const _0x533bb2=parseInt(_0x4943bc[_0x178217(0x981)][_0x178217(0x491)](_0x178217(0xca5),'')),_0x18ec86=await _0xb81d4e[_0x178217(0x482)][_0x178217(0x111a)](_0x533bb2);if(_0x18ec86&&_0x18ec86[_0x178217(0x11a0)]){const _0x561f8d=_0x302621[_0x178217(0x11a0)][_0x178217(0x85d)](_0x351709=>_0x18ec86['associatedWith'][_0x178217(0x44f)](_0x351709));_0x561f8d['length']>0x0&&(_0x5afd83=!![]);}}}(_0x5afd83||_0x4a6542)&&_0x5f2b41['push'](_0x4943bc);}if(_0x5f2b41[_0x178217(0x990)]>0x0||Math['random']()<0.2){console[_0x178217(0x90f)](_0x178217(0x1314)+_0x302621[_0x178217(0x564)]+_0x178217(0xe9a));const _0x54743f=await _0x53c777(_0x302621,_0x5f2b41);if(_0x54743f&&_0x54743f['length']>0x0){for(const _0x804a21 of _0x54743f){if(_0x804a21['type']==='qzone_comment'){const _0x5d7176=await _0xb81d4e[_0x178217(0xcce)][_0x178217(0x111a)](_0x804a21[_0x178217(0x403)]);if(_0x5d7176){if(!_0x5d7176[_0x178217(0xd3c)])_0x5d7176[_0x178217(0xd3c)]=[];_0x5d7176['comments'][_0x178217(0x1a0)]({'commenterName':_0x302621[_0x178217(0x564)],'text':_0x804a21[_0x178217(0xcca)],'replyTo':_0x804a21[_0x178217(0x32a)]||null,'timestamp':Date['now']()+Math['random']()}),await _0xb81d4e[_0x178217(0xcce)][_0x178217(0xeb2)](_0x804a21[_0x178217(0x403)],{'comments':_0x5d7176[_0x178217(0xd3c)]}),_0xa385c3(_0x22cc4e+0x1);}}else{if(_0x804a21['type']==='qzone_post'){const _0x2f4260={'type':_0x804a21[_0x178217(0x426)]||_0x178217(0x395),'content':_0x804a21['content'],'timestamp':Date[_0x178217(0x12d6)](),'authorId':_0x178217(0xca5)+_0x302621['id'],'authorOriginalName':_0x302621[_0x178217(0x564)],'visibleTo':_0x302621[_0x178217(0x11a0)],'likes':[],'comments':[],'isDeleted':![]};await _0xb81d4e[_0x178217(0xcce)][_0x178217(0x807)](_0x2f4260),console['log'](_0x178217(0x1314)+_0x302621[_0x178217(0x564)]+_0x178217(0xe7e)),_0xa385c3(_0x22cc4e+0x1);}}}await _0xb81d4e[_0x178217(0x482)][_0x178217(0xeb2)](_0x302621['id'],{'lastActionTimestamp':Date[_0x178217(0x12d6)]()}),document[_0x178217(0x479)](_0x178217(0xc8d))[_0x178217(0x9cd)][_0x178217(0x658)](_0x178217(0x5a9))&&await _0x2eb20b();}}}}catch(_0x5b8f2d){console[_0x178217(0xe3b)](_0x178217(0xe7c),_0x5b8f2d);}}async function _0x53c777(_0x32eb24,_0x24a558){const _0x1cc96f=_0x85c4bf,{proxyUrl:_0x2eba6f,apiKey:_0x57636a,model:_0x1bfa58}=_0x505390[_0x1cc96f(0x30c)];if(!_0x2eba6f||!_0x57636a||!_0x1bfa58)return console[_0x1cc96f(0xe3b)]('NPC行动失败：API未配置。'),null;let _0x489ddf='#\x20你的互动对象\x20(用户和其他角色)\x0a';const _0x1a906f=_0x505390[_0x1cc96f(0x1190)]['nickname']||'我',_0xbcae7a=_0x505390[_0x1cc96f(0x1027)][Object[_0x1cc96f(0x108c)](_0x505390[_0x1cc96f(0x1027)])[0x0]]?.[_0x1cc96f(0x18a)]['myPersona']||_0x1cc96f(0xf4d);_0x489ddf+='-\x20**'+_0x1a906f+'\x20(用户)**:\x20'+_0xbcae7a+'\x0a';_0x32eb24[_0x1cc96f(0x11a0)]&&_0x32eb24[_0x1cc96f(0x11a0)]['length']>0x0&&_0x32eb24[_0x1cc96f(0x11a0)][_0x1cc96f(0x12be)](_0x5bdcac=>{const _0xe2ee91=_0x1cc96f,_0x220208=_0x505390[_0xe2ee91(0x1027)][_0x5bdcac];_0x220208&&!_0x220208[_0xe2ee91(0x9d7)]&&(_0x489ddf+=_0xe2ee91(0x118a)+_0x220208[_0xe2ee91(0x564)]+_0xe2ee91(0x13c8)+_0x220208[_0xe2ee91(0xe2d)]+_0xe2ee91(0x5e7)+_0x220208[_0xe2ee91(0x18a)][_0xe2ee91(0x11f6)]+'\x0a');});const _0x46cc8c=(await Promise['all'](_0x24a558[_0x1cc96f(0x2e1)](async _0x4a7601=>{const _0xedf93e=_0x1cc96f;let _0x170b73=_0xedf93e(0x64f);if(_0x4a7601[_0xedf93e(0x981)]===_0xedf93e(0x4c5))_0x170b73=_0x505390[_0xedf93e(0x1190)][_0xedf93e(0x904)]||'用户';else{if(_0x4a7601[_0xedf93e(0x981)][_0xedf93e(0x591)](_0xedf93e(0x8f9)))_0x170b73=_0x148d9b(_0x4a7601[_0xedf93e(0x91b)]||_0x4a7601[_0xedf93e(0x981)]);else{if(_0x4a7601['authorId'][_0xedf93e(0x591)](_0xedf93e(0xca5))){const _0x17bb1b=parseInt(_0x4a7601[_0xedf93e(0x981)]['replace'](_0xedf93e(0xca5),'')),_0x363460=await _0xb81d4e[_0xedf93e(0x482)][_0xedf93e(0x111a)](_0x17bb1b);_0x363460&&(_0x170b73=_0x363460[_0xedf93e(0x564)]);}}}const _0x38c625=(_0x4a7601['comments']||[])[_0xedf93e(0x2e1)](_0x14c9f0=>{const _0x138e4a=_0xedf93e;if(typeof _0x14c9f0===_0x138e4a(0x65a)&&_0x14c9f0[_0x138e4a(0x13e3)]){const _0x18ff94=_0x148d9b(_0x14c9f0['commenterName']);return _0x138e4a(0x118a)+_0x18ff94+_0x138e4a(0xed4)+_0x14c9f0[_0x138e4a(0x56d)];}return'-\x20'+_0x14c9f0;})[_0xedf93e(0x35d)]('\x0a');return _0xedf93e(0x701)+_0x4a7601['id']+_0xedf93e(0xcc6)+_0x170b73+_0xedf93e(0x766)+(_0x4a7601[_0xedf93e(0xac4)]||_0x4a7601['publicText']||'')[_0xedf93e(0x1323)](0x0,0x96)+_0xedf93e(0x4c2)+(_0x38c625||_0xedf93e(0xa98))+'\x0a---\x0a';})))['join']('\x0a'),_0x3df9b5=_0x1cc96f(0xca5)+_0x32eb24['id'],_0x13e05a=Date['now']()-0xc*0x3c*0x3c*0x3e8,_0x3498a3=await _0xb81d4e[_0x1cc96f(0xcce)][_0x1cc96f(0x46f)]('authorId')['equals'](_0x3df9b5)[_0x1cc96f(0x772)](_0x1d63b3=>_0x1d63b3[_0x1cc96f(0x12a2)]>_0x13e05a)['toArray']();let _0x56392b='';_0x3498a3[_0x1cc96f(0x990)]>0x0&&(_0x56392b=_0x1cc96f(0x12dc));const _0xed6f6=_0x1cc96f(0xb89)+_0x32eb24[_0x1cc96f(0x564)]+_0x1cc96f(0xb73)+_0x56392b+_0x1cc96f(0xb22)+_0x32eb24[_0x1cc96f(0x564)]+_0x1cc96f(0x1e9)+_0x32eb24[_0x1cc96f(0x596)]+'\x0a\x0a'+_0x489ddf+_0x1cc96f(0x134f)+_0x46cc8c+'\x0a\x0a现在，请严格遵守所有规则，选择并执行你的行动。';try{const _0x205309=[{'role':_0x1cc96f(0x4c5),'content':'请根据你的设定，开始你的行动。'}];let _0x31539e=_0x2eba6f['includes']('generativelanguage'),_0x1b54e9=_0x19a701(_0x1bfa58,_0x57636a,_0xed6f6,_0x205309);const _0x4320d0=_0x31539e?await fetch(_0x1b54e9['url'],_0x1b54e9[_0x1cc96f(0x104c)]):await fetch(_0x2eba6f+_0x1cc96f(0x347),{'method':_0x1cc96f(0xba0),'headers':{'Content-Type':_0x1cc96f(0xcb5),'Authorization':'Bearer\x20'+_0x57636a},'body':JSON[_0x1cc96f(0x1308)]({'model':_0x1bfa58,'messages':[{'role':_0x1cc96f(0xbaa),'content':_0xed6f6},..._0x205309],'temperature':_0x505390[_0x1cc96f(0x888)][_0x1cc96f(0x398)]||0.9})});if(!_0x4320d0['ok'])throw new Error(_0x1cc96f(0xef2)+_0x4320d0[_0x1cc96f(0xd4a)]);const _0x2ab683=await _0x4320d0[_0x1cc96f(0xfdf)](),_0x396f12=getGeminiResponseText(_0x2ab683),_0x5bc32b=_0x396f12[_0x1cc96f(0xab4)](/(\[[\s\S]*\])/);if(!_0x5bc32b)throw new Error(_0x1cc96f(0xff7));return JSON['parse'](_0x5bc32b[0x0]);}catch(_0x37b0bf){return console[_0x1cc96f(0xe3b)](_0x1cc96f(0x12a4)+_0x32eb24[_0x1cc96f(0x564)]+_0x1cc96f(0x8aa),_0x37b0bf),null;}}async function _0x24c27f(_0x4f79ba){const _0x487b28=_0x85c4bf,_0x9a241f=_0x505390['chats'][_0x4f79ba];if(!_0x9a241f)return;const _0x110cec=_0x9a241f['settings'][_0x487b28(0x1097)]||0xa;if(_0x9a241f['lastActionTimestamp']){const _0x16e0eb=(Date[_0x487b28(0x12d6)]()-_0x9a241f[_0x487b28(0xa28)])/(0x3e8*0x3c);if(_0x16e0eb<_0x110cec){console[_0x487b28(0x90f)](_0x487b28(0xced)+_0x9a241f[_0x487b28(0x564)]+_0x487b28(0x998)+Math[_0x487b28(0x412)](_0x110cec-_0x16e0eb)+_0x487b28(0x2b4));return;}}_0x156c85(_0x4f79ba,!![]);const {proxyUrl:_0x8666e9,apiKey:_0x2d633c,model:_0x732d78}=_0x505390[_0x487b28(0x30c)];if(!_0x8666e9||!_0x2d633c||!_0x732d78)return;const _0x268a93=_0x505390[_0x487b28(0x1190)][_0x487b28(0x904)],_0x114c5e=new Date(),_0x3d98b4=_0x9a241f[_0x487b28(0x18a)][_0x487b28(0xac0)]||_0x487b28(0x20e),_0x4ab403=_0x114c5e[_0x487b28(0x119c)](_0x487b28(0xdc2),{'timeZone':_0x3d98b4,'dateStyle':_0x487b28(0xf31),'timeStyle':_0x487b28(0xe6f)}),_0x1eddfe=new Date(_0x114c5e['toLocaleString'](_0x487b28(0x5d4),{'timeZone':_0x3d98b4}));let _0x544e84='',_0x12b948='',_0x1fee34,_0x3fa205=![];const _0x244fe2=_0x9a241f[_0x487b28(0x18a)][_0x487b28(0x2c6)]||0xa,_0xb60aec=_0x9a241f['history'][_0x487b28(0x85d)](_0x5d238d=>!_0x5d238d[_0x487b28(0xb9c)])['slice'](-_0x244fe2),_0x4d009e=_0x9a241f[_0x487b28(0x7d3)][_0x487b28(0x85d)](_0x135c8a=>!_0x135c8a[_0x487b28(0xb9c)])[_0x487b28(0x777)](-0x1)[0x0];if(_0x9a241f[_0x487b28(0x18a)][_0x487b28(0xeb0)]){_0x544e84=_0x3ae0c5(_0x1eddfe);const _0x3182cc=_0x9a241f['history']['filter'](_0x254904=>!_0x254904[_0x487b28(0xb9c)])[_0x487b28(0x777)](-0x1)[0x0],_0x2bfb69=new Date();let _0x150344='',_0x55a69d=![];if(_0x3182cc){const _0x1db2fd=new Date(_0x3182cc['timestamp']),_0x432df6=(_0x2bfb69-_0x1db2fd)/(0x3e8*0x3c*0x3c);if(_0x432df6>0xc){_0x55a69d=!![];const _0x3bbf11=Math[_0x487b28(0xd71)](_0x432df6/0x18);_0x150344=_0x487b28(0xda3)+(_0x3bbf11>0x0?_0x3bbf11+'天':Math[_0x487b28(0xd71)](_0x432df6)+'小时')+_0x487b28(0x1b6);}else{const _0x27cfd0=Math['floor'](_0x432df6*0x3c);if(_0x27cfd0<0x5)_0x150344='你们的对话刚刚还在继续。';else _0x27cfd0<0x3c?_0x150344=_0x487b28(0x2ec)+_0x27cfd0+'分钟前聊过。':_0x150344='你们在'+Math[_0x487b28(0xd71)](_0x432df6)+_0x487b28(0x10e8);}}else _0x55a69d=!![],_0x150344='这是你们的第一次互动。';let _0x505f01=_0x487b28(0xbe6);_0xb60aec[_0x487b28(0x990)]>0x0&&(_0x505f01=_0x487b28(0x60b)+_0xb60aec[_0x487b28(0x2e1)](_0x598f0b=>{const _0x54145a=_0x487b28,_0x179f6d=_0x598f0b[_0x54145a(0x508)]===_0x54145a(0x4c5)?_0x268a93:_0x9a241f[_0x54145a(0x564)];return _0x179f6d+':\x20'+String(_0x598f0b[_0x54145a(0xac4)])[_0x54145a(0x1323)](0x0,0x32)+_0x54145a(0x4d0);})[_0x487b28(0x35d)]('\x0a')),_0x55a69d?_0x1fee34=_0x487b28(0x1ca)+_0x150344+'\x20当前时间是\x20'+_0x4ab403+_0x487b28(0xd92)+_0x505f01:_0x1fee34=''+_0x505f01;}else _0xb60aec['length']>0x0?_0x1fee34='这是你们最近的对话：\x0a'+_0xb60aec['map'](_0xc6f7f6=>{const _0x56ca1f=_0x487b28,_0x16d1c4=_0xc6f7f6[_0x56ca1f(0x508)]===_0x56ca1f(0x4c5)?_0x268a93:_0x9a241f['name'];return _0x16d1c4+':\x20'+String(_0xc6f7f6[_0x56ca1f(0xac4)])['substring'](0x0,0x32)+_0x56ca1f(0x4d0);})[_0x487b28(0x35d)]('\x0a'):_0x1fee34=_0x487b28(0xbe6);const _0x18f29e=await _0xb81d4e[_0x487b28(0xcce)][_0x487b28(0x3d2)](_0x487b28(0x12a2))['reverse']()['limit'](0x5)['toArray'](),_0x180ae3=_0x4d9aaa(_0x18f29e,_0x9a241f),_0x4ef6eb=_0x180ae3['filter'](_0x4951ba=>_0x4951ba[_0x487b28(0x981)]===_0x4f79ba);let _0x5dbc2d='';_0x4ef6eb['length']>0x0&&(_0x5dbc2d=_0x487b28(0x8f7),_0x4ef6eb['forEach'](_0x1aae35=>{const _0x3ae943=_0x487b28;let _0x1c581a=(_0x1aae35[_0x3ae943(0x105a)]||_0x1aae35[_0x3ae943(0xac4)]||_0x3ae943(0x13bd))['substring'](0x0,0x28)+_0x3ae943(0x4d0);_0x5dbc2d+=_0x3ae943(0xfb3)+_0x1aae35['id']+_0x3ae943(0x54d)+_0x1c581a+'\x22\x0a';}));let _0x3d71fe=[];_0x180ae3[_0x487b28(0x990)]>0x0&&(_0x3d71fe=_0x180ae3['map'](_0x421ceb=>{const _0x12b846=_0x487b28;let _0x3bc91b;if(_0x421ceb[_0x12b846(0x858)]==='text_image')_0x3bc91b=(_0x12b846(0xfae)+_0x421ceb['hiddenContent']+_0x12b846(0x1382)+(_0x421ceb[_0x12b846(0x105a)]||''))[_0x12b846(0x1323)](0x0,0x32)+_0x12b846(0x4d0);else _0x421ceb[_0x12b846(0x858)]===_0x12b846(0x133a)?_0x3bc91b=(_0x12b846(0xf40)+_0x421ceb[_0x12b846(0x11a4)]+'”]\x20'+(_0x421ceb['publicText']||''))[_0x12b846(0x1323)](0x0,0x32)+_0x12b846(0x4d0):_0x3bc91b=String(_0x421ceb['publicText']||_0x421ceb[_0x12b846(0xac4)]||_0x12b846(0x13bd))['substring'](0x0,0x32)+_0x12b846(0x4d0);return'-\x20\x22'+_0x3bc91b+'\x22';}));let _0x579aaf='';_0x3d71fe[_0x487b28(0x990)]>0x0&&(_0x579aaf=_0x487b28(0x11e8)+_0x3d71fe[_0x487b28(0x35d)]('\x0a')+_0x487b28(0xb58));let _0x468a78='';if(_0x9a241f[_0x487b28(0x18a)][_0x487b28(0x13da)]&&_0x9a241f[_0x487b28(0x18a)]['linkedWorldBookIds'][_0x487b28(0x990)]>0x0){const _0x40612d=_0x9a241f[_0x487b28(0x18a)][_0x487b28(0x13da)][_0x487b28(0x2e1)](_0x10b670=>{const _0x5788a8=_0x487b28,_0x44ed31=_0x505390[_0x5788a8(0xd1b)][_0x5788a8(0xc0d)](_0x38b5bf=>_0x38b5bf['id']===_0x10b670);if(!_0x44ed31||!Array[_0x5788a8(0x285)](_0x44ed31[_0x5788a8(0xac4)]))return'';const _0x53ee2e=_0x44ed31[_0x5788a8(0xac4)]['filter'](_0xd0dc30=>_0xd0dc30[_0x5788a8(0x2b7)]!==![])[_0x5788a8(0x2e1)](_0x975492=>{const _0xdf7d93=_0x5788a8;let _0x304366=_0xdf7d93(0x1345)+(_0x975492['comment']||_0xdf7d93(0x561))+'\x0a';return _0x975492[_0xdf7d93(0x108c)][_0xdf7d93(0x990)]>0x0&&(_0x304366+=_0xdf7d93(0x6ff)+_0x975492['keys'][_0xdf7d93(0x35d)](',\x20')+'\x0a'),_0x304366+=_0xdf7d93(0xb8a)+_0x975492[_0xdf7d93(0xac4)],_0x304366;})[_0x5788a8(0x35d)]('');return _0x53ee2e?'\x0a\x0a##\x20世界书:\x20'+_0x44ed31[_0x5788a8(0x564)]+'\x0a'+_0x53ee2e:'';})[_0x487b28(0x85d)](Boolean)[_0x487b28(0x35d)]('');_0x40612d&&(_0x468a78=_0x487b28(0x12b0)+_0x40612d+_0x487b28(0x5f5));}let _0x15bcf1='';const _0x48aed4=_0x9a241f[_0x487b28(0x18a)][_0x487b28(0xefc)]||0xa;if(_0x9a241f[_0x487b28(0x18a)][_0x487b28(0xefa)]&&_0x9a241f[_0x487b28(0x18a)][_0x487b28(0xefa)][_0x487b28(0x990)]>0x0){const _0x4ae274=_0x9a241f[_0x487b28(0x18a)][_0x487b28(0xefa)][_0x487b28(0x2e1)](_0x22af4e=>{const _0x573ea8=_0x487b28,_0x25cfaf=_0x505390[_0x573ea8(0x1027)][_0x22af4e];if(!_0x25cfaf)return null;const _0xf13f03=_0x25cfaf['history'][_0x573ea8(0x777)](-0x1)[0x0];return{'chat':_0x25cfaf,'latestTimestamp':_0xf13f03?_0xf13f03[_0x573ea8(0x12a2)]:0x0};})['filter'](Boolean);_0x4ae274[_0x487b28(0x382)]((_0x10fab9,_0x4bbd74)=>_0x4bbd74[_0x487b28(0x698)]-_0x10fab9[_0x487b28(0x698)]),_0x15bcf1+=_0x487b28(0x335);for(const _0x29a132 of _0x4ae274){const _0x205d6c=_0x29a132[_0x487b28(0xa50)],_0x5bf1c6=_0x205d6c[_0x487b28(0x9d7)]?_0x487b28(0x519):_0x487b28(0x9ae),_0x332f51=_0x29a132[_0x487b28(0x698)]>0x0?_0x487b28(0xcb6)+_0x3e14b1(_0x29a132[_0x487b28(0x698)])+')':'';_0x15bcf1+=_0x487b28(0x3df)+_0x5bf1c6+'“'+_0x205d6c['name']+_0x487b28(0x1335)+_0x332f51+_0x487b28(0x261);const _0xac2071=_0x205d6c[_0x487b28(0x7d3)][_0x487b28(0x777)](-_0x48aed4),_0x4ce78f=_0xac2071['filter'](_0x3bfc45=>!String(_0x3bfc45['content'])[_0x487b28(0x44f)]('已被用户删除'));_0x4ce78f[_0x487b28(0x990)]>0x0?_0x4ce78f[_0x487b28(0x12be)](_0x5ec1b4=>{const _0x300cfa=_0x487b28,_0x4d80f5=_0x5ec1b4[_0x300cfa(0x508)]===_0x300cfa(0x4c5)?_0x205d6c[_0x300cfa(0x18a)][_0x300cfa(0xf58)]||'我':_0x5ec1b4[_0x300cfa(0xdcc)]||_0x205d6c[_0x300cfa(0x564)];let _0x54c707=String(_0x5ec1b4[_0x300cfa(0xac4)]);if(_0x5ec1b4[_0x300cfa(0x858)]===_0x300cfa(0x135a)||_0x5ec1b4[_0x300cfa(0x858)]===_0x300cfa(0x5d5))_0x54c707=_0x300cfa(0xa05)+_0x5ec1b4[_0x300cfa(0xac4)]+']';else _0x5ec1b4['type']===_0x300cfa(0x9bf)&&(_0x54c707=_0x300cfa(0xb7e)+_0x5ec1b4[_0x300cfa(0xac4)]+']');_0x15bcf1+=_0x4d80f5+':\x20'+_0x54c707+'\x0a';}):_0x15bcf1+=_0x487b28(0x550);}}let _0x59f9c0='';if(_0x180ae3[_0x487b28(0x990)]>0x0){let _0x4bd3b9='\x0a\x0a#\x20最近的动态列表\x20(供你参考和评论):\x0a';for(const _0x40c3a2 of _0x180ae3){let _0x2651f3;if(_0x40c3a2['authorId']===_0x487b28(0x4c5))_0x2651f3=_0x505390[_0x487b28(0x1190)][_0x487b28(0x904)];else{if(String(_0x40c3a2['authorId'])[_0x487b28(0x591)](_0x487b28(0xca5)))_0x2651f3=_0x40c3a2[_0x487b28(0x91b)]||'一位神秘的NPC';else{const _0x38eae9=_0x505390[_0x487b28(0x1027)][_0x40c3a2[_0x487b28(0x981)]];_0x2651f3=_0x38eae9?_0x38eae9['name']:'一位朋友';}}if(_0x40c3a2['authorId']===_0x4f79ba)_0x2651f3+=_0x487b28(0x238);let _0x5887a4;if(_0x40c3a2[_0x487b28(0x858)]==='repost'){const _0x4c36b5=_0x40c3a2[_0x487b28(0x3aa)]?'并评论说：\x22'+_0x40c3a2[_0x487b28(0x3aa)]+'\x22':'';let _0xae3fbe=_0x487b28(0xbe2);const _0x4ef095=_0x40c3a2[_0x487b28(0x445)]['authorId'];if(_0x4ef095==='user')_0xae3fbe=_0x505390[_0x487b28(0x1190)][_0x487b28(0x904)];else _0x505390[_0x487b28(0x1027)][_0x4ef095]&&(_0xae3fbe=_0x505390[_0x487b28(0x1027)][_0x4ef095][_0x487b28(0x564)]);let _0xeac626;const _0x4806a5=_0x40c3a2['originalPost'];if(_0x4806a5[_0x487b28(0x858)]===_0x487b28(0xd84))_0xeac626=_0x487b28(0xe6c)+(_0x4806a5[_0x487b28(0x105a)]||'')+_0x487b28(0xfc3)+(_0x4806a5['hiddenContent']||'')[_0x487b28(0x1323)](0x0,0x28)+_0x487b28(0xb69);else _0x4806a5['type']==='image_post'?_0xeac626=_0x487b28(0x3be)+(_0x4806a5[_0x487b28(0x105a)]||'')+_0x487b28(0xfc3)+(_0x4806a5[_0x487b28(0x11a4)]||'')[_0x487b28(0x1323)](0x0,0x28)+_0x487b28(0xb69):_0xeac626='\x22'+(_0x4806a5['content']||'')['substring'](0x0,0x28)+_0x487b28(0x55f);_0x5887a4=_0x487b28(0x12e0)+_0xae3fbe+'\x20的动态\x20'+_0x4c36b5+_0x487b28(0x207)+_0xeac626+'】';}else{if(_0x40c3a2[_0x487b28(0x858)]===_0x487b28(0xd84))_0x5887a4=(_0x487b28(0x63d)+_0x40c3a2[_0x487b28(0x112d)]+_0x487b28(0xecb)+(_0x40c3a2[_0x487b28(0x105a)]||''))['substring'](0x0,0x32)+_0x487b28(0x4d0);else{if(_0x40c3a2[_0x487b28(0x858)]===_0x487b28(0x133a))_0x5887a4=(_0x487b28(0xa69)+_0x40c3a2[_0x487b28(0x11a4)]+_0x487b28(0xecb)+(_0x40c3a2['publicText']||''))[_0x487b28(0x1323)](0x0,0x32)+'...';else{if(_0x40c3a2[_0x487b28(0x858)]===_0x487b28(0x12c7)&&_0x40c3a2[_0x487b28(0x3ae)]){const _0x4c4f52=Array[_0x487b28(0x285)](_0x40c3a2['prompt'])?_0x40c3a2[_0x487b28(0x3ae)]:[_0x40c3a2[_0x487b28(0x3ae)]];_0x5887a4=(_0x40c3a2['publicText']||'')+('\x20[包含'+_0x4c4f52[_0x487b28(0x990)]+'张RealImag图片:\x20'+_0x4c4f52[_0x487b28(0x35d)](',\x20')+']');}else{if(_0x40c3a2[_0x487b28(0x858)]===_0x487b28(0x1cc)&&_0x40c3a2['prompt']){const _0x4a90ab=Array[_0x487b28(0x285)](_0x40c3a2[_0x487b28(0x3ae)])?_0x40c3a2[_0x487b28(0x3ae)]:[_0x40c3a2[_0x487b28(0x3ae)]];_0x5887a4=(_0x40c3a2['publicText']||'')+('\x20[包含'+_0x4a90ab[_0x487b28(0x990)]+_0x487b28(0xcab)+_0x4a90ab[_0x487b28(0x35d)](',\x20')+']');}else _0x5887a4=String(_0x40c3a2[_0x487b28(0x105a)]||_0x40c3a2['content']||'一条动态')[_0x487b28(0x1323)](0x0,0x32)+_0x487b28(0x4d0);}}}}_0x4bd3b9+=_0x487b28(0xfb3)+_0x40c3a2['id']+_0x487b28(0x786)+_0x2651f3+',\x20内容:\x20\x22'+_0x5887a4+'\x22\x0a';if(_0x40c3a2[_0x487b28(0xd3c)]&&_0x40c3a2[_0x487b28(0xd3c)]['length']>0x0)for(const _0x43970f of _0x40c3a2['comments']){if(typeof _0x43970f===_0x487b28(0x65a)&&_0x43970f[_0x487b28(0x13e3)]){const _0x1d2d7e=_0x148d9b(_0x43970f['commenterName']);let _0x1b1b79=_0x43970f[_0x487b28(0x720)]?_0x487b28(0x801)+_0x43970f[_0x487b28(0x720)]+'\x27]':_0x43970f[_0x487b28(0x56d)];_0x43970f[_0x487b28(0x13e3)]===_0x9a241f[_0x487b28(0xe2d)]?_0x4bd3b9+=_0x487b28(0x622)+_0x1b1b79+'\x0a':_0x4bd3b9+=_0x487b28(0x1dd)+_0x1d2d7e+'\x20(本名:\x20'+_0x43970f['commenterName']+_0x487b28(0x1044)+_0x1b1b79+'\x0a';}}}_0x59f9c0=_0x4bd3b9;}const _0x4ddd73=_0x487b28(0x10ff)+(_0x9a241f[_0x487b28(0x3b4)]&&_0x9a241f[_0x487b28(0x3b4)]['length']>0x0?_0x9a241f[_0x487b28(0x3b4)][_0x487b28(0x2e1)](_0x2af36d=>_0x487b28(0x619)+_0x3e14b1(_0x2af36d[_0x487b28(0x12a2)])+')\x20'+_0x2af36d[_0x487b28(0xac4)])[_0x487b28(0x35d)]('\x0a'):_0x487b28(0xa15)),_0x4696ac=_0x37bdc8(_0x9a241f,0x3,_0x487b28(0x129d)),_0x3fbcd7=_0x37bdc8(_0x9a241f,0x6,_0x487b28(0x129d)),_0x3ae10f=_0x37bdc8(_0x9a241f,0x9,_0x487b28(0x129d)),_0x7d4008=_0x37bdc8(_0x9a241f,0x1,_0x487b28(0x111c)),_0x355662=_0x37bdc8(_0x9a241f,0x3,_0x487b28(0x111c)),_0x76196=_0x37bdc8(_0x9a241f,0x7,_0x487b28(0x111c));let _0x185650='';if(_0x4696ac||_0x3fbcd7||_0x3ae10f||_0x7d4008||_0x355662||_0x76196){_0x185650+=_0x487b28(0x670);if(_0x4696ac)_0x185650+=_0x4696ac;if(_0x3fbcd7)_0x185650+=_0x3fbcd7;if(_0x3ae10f)_0x185650+=_0x3ae10f;if(_0x4696ac||_0x3fbcd7||_0x3ae10f)_0x185650+='\x0a';if(_0x7d4008)_0x185650+=_0x7d4008;if(_0x355662)_0x185650+=_0x355662;if(_0x76196)_0x185650+=_0x76196;}const _0x19c53f=_0xfe3b04(_0x9a241f),_0x142b09=_0x487b28(0x125e)+_0x9a241f['name']+_0x487b28(0x230)+_0x9a241f[_0x487b28(0xe2d)]+_0x487b28(0x12e1)+_0x268a93+_0x487b28(0x8a3)+(_0x9a241f[_0x487b28(0x18a)][_0x487b28(0xeb0)]?'\x0a#\x20【情景感知】\x0a-\x20**时间**:\x20感知到当前是'+_0x4ab403+'\x20('+_0x544e84+_0x487b28(0xe38)+_0x12b948+'\x0a'+(_0x3fa205?'【重要提示】你们已经很久没聊天了！你【必须】将本次行动的重点放在使用\x20\x27text\x27\x20指令给用户发消息，主动开启一个新的、有趣的话题来重新建立联系。绝对不要只是点赞或评论动态，那会显得你很冷漠！':''):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【对话节奏铁律\x20(至关重要！)】\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】模拟真人的打字和思考习惯。**绝对不要一次性发送一大段文字！**\x20你应该将你想说的话，拆分成【多条、简短的】消息气泡来发送，每条消息最好不要超过30个字。这会让对话看起来更自然、更真实。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【决策依据】**:\x20你的所有行动都【必须深度结合你的角色设定、核心世界观、以及你们最后的对话摘要】。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**【内容多样性铁律】**:\x20你的行动【必须】具有逻辑和多样性。你【绝对不能】发布与下方“内容禁忌”列表或“最近的动态列表”中内容相似或主题重复的动态。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**【行为多样性指南\x20(至关重要)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的上一次独立行动是：**'+(_0x9a241f[_0x487b28(0x1be)]||'无')+_0x487b28(0x687)+_0x579aaf+_0x487b28(0xb58)+_0x5dbc2d+_0x487b28(0x79f)+_0x9a241f[_0x487b28(0x18a)][_0x487b28(0x11f6)]+_0x487b28(0xb58)+_0x468a78+_0x487b28(0xb58)+(_0x9a241f[_0x487b28(0x3b4)]&&_0x9a241f[_0x487b28(0x3b4)][_0x487b28(0x990)]>0x0?_0x9a241f['longTermMemory'][_0x487b28(0x2e1)](_0x8d317c=>'-\x20(记录于\x20'+_0x3e14b1(_0x8d317c[_0x487b28(0x12a2)])+')\x20'+_0x8d317c[_0x487b28(0xac4)])[_0x487b28(0x35d)]('\x0a'):'无')+_0x487b28(0xb58)+_0x185650+_0x487b28(0xa32)+_0x15bcf1+_0x487b28(0xb58)+(_0x9a241f[_0x487b28(0x18a)][_0x487b28(0xeb0)]?'-\x20\x20\x20**当前时间**:'+_0x4ab403+'\x20('+_0x544e84+')':'')+_0x487b28(0xb58)+(_0x9a241f['settings']['enableTimePerception']?_0x487b28(0xf88)+_0x12b948:'')+_0x487b28(0xacf)+_0x19c53f+_0x487b28(0x1166)+_0x1fee34+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x59f9c0+'\x0a',_0x5f1b7b=[{'role':_0x487b28(0xbaa),'content':_0x142b09},..._0xb60aec['map'](_0xdaf8bc=>{const _0x1e9950=_0x487b28,_0x17c99f=_0xdaf8bc['role']==='user'?_0x268a93:_0x9a241f[_0x1e9950(0x564)];let _0xc63525=_0xdaf8bc[_0x1e9950(0xac4)];return typeof _0xc63525!==_0x1e9950(0x8d9)&&(_0xc63525=JSON['stringify'](_0xc63525)),{'role':_0xdaf8bc['role'],'content':_0x17c99f+':\x20'+_0xc63525};})];try{const _0x5a5ce0=[{'role':_0x487b28(0x4c5),'content':_0x142b09+'\x0a\x0a[系统指令：请根据你在上面读到的规则和以下最新信息，开始你的独立行动。]\x0a'+_0x59f9c0}];console[_0x487b28(0x90f)]('正在为后台活动发送API请求\x20(\x22'+_0x9a241f['name']+'\x22)');let _0x2b0d1c=_0x8666e9===GEMINI_API_URL,_0x3ed19b=_0x19a701(_0x732d78,_0x2d633c,_0x142b09,_0x5a5ce0);const _0x2f1d8d=_0x2b0d1c?await fetch(_0x3ed19b[_0x487b28(0x5f3)],_0x3ed19b['data']):await fetch(_0x8666e9+_0x487b28(0x347),{'method':_0x487b28(0xba0),'headers':{'Content-Type':'application/json','Authorization':_0x487b28(0xb27)+_0x2d633c},'body':JSON['stringify']({'model':_0x732d78,'messages':_0x5a5ce0,'temperature':_0x505390[_0x487b28(0x888)][_0x487b28(0x398)]||0.9})});if(!_0x2f1d8d['ok']){const _0x48c214=await _0x2f1d8d[_0x487b28(0xfdf)]();throw new Error('API请求失败:\x20'+_0x2f1d8d['status']+_0x487b28(0x501)+JSON[_0x487b28(0x1308)](_0x48c214));}const _0x3ba5b1=await _0x2f1d8d[_0x487b28(0xfdf)](),_0x10e948=_0x2b0d1c?getGeminiResponseText(_0x3ba5b1):_0x3ba5b1[_0x487b28(0xd5c)][0x0][_0x487b28(0x757)][_0x487b28(0xac4)];if(!_0x10e948||_0x10e948[_0x487b28(0x9c1)]()===''){console[_0x487b28(0x139e)](_0x487b28(0x967)+_0x9a241f[_0x487b28(0x564)]+'\x22\x20的本次后台活动跳过。');return;}const _0x4e91d1=_0x2da9f3(_0x10e948);if(!_0x4e91d1||_0x4e91d1['length']===0x0){console[_0x487b28(0x139e)](_0x487b28(0xd15)+_0x9a241f[_0x487b28(0x564)]+_0x487b28(0xf1d),_0x10e948);return;}let _0x37a6d4=Date['now'](),_0x456512=![];const _0x43007e=[];for(const _0x45cd5f of _0x4e91d1){const _0x4b8c79=String(_0x45cd5f['content']||''),_0x1ea87f=_0x4b8c79[_0x487b28(0x9c1)]()[_0x487b28(0x591)]('<')&&_0x4b8c79[_0x487b28(0x9c1)]()[_0x487b28(0x1193)]('>');if(_0x45cd5f[_0x487b28(0x858)]===_0x487b28(0x56d)&&!_0x1ea87f&&_0x4b8c79['includes']('\x0a')){const _0xc0f8bc=_0x4b8c79['split'](/\n+/)[_0x487b28(0x85d)](_0x2f321a=>_0x2f321a[_0x487b28(0x9c1)]());_0xc0f8bc[_0x487b28(0x12be)](_0x533eca=>{const _0x3d4ce4=_0x487b28;_0x43007e[_0x3d4ce4(0x1a0)]({..._0x45cd5f,'content':_0x533eca});});}else _0x43007e[_0x487b28(0x1a0)](_0x45cd5f);}for(const _0x3cbd51 of _0x43007e){_0x9a241f[_0x487b28(0x1be)]=_0x3cbd51['type'],_0x9a241f[_0x487b28(0xa28)]=_0x37a6d4;let _0x610fd1=null;const _0x4e960a={'role':_0x487b28(0x1328),'senderName':_0x9a241f[_0x487b28(0xe2d)],'timestamp':_0x37a6d4++};let _0x11e923=null;switch(_0x3cbd51['type']){case _0x487b28(0x1087):{const _0x33ab52=parseInt(_0x3cbd51[_0x487b28(0x403)]),_0x7ec953=await _0xb81d4e['qzonePosts']['get'](_0x33ab52);if(_0x7ec953&&_0x7ec953[_0x487b28(0x981)]===_0x4f79ba){await _0xb81d4e[_0x487b28(0xcce)]['update'](_0x33ab52,{'isDeleted':!![]});document[_0x487b28(0x479)](_0x487b28(0xc8d))['classList']['contains']('active')&&_0x2eb20b();const _0x4cb35={'role':_0x487b28(0xbaa),'type':_0x487b28(0x2f4),'content':'['+_0x9a241f['name']+'\x20删除了自己的一条动态]','postId':_0x33ab52,'timestamp':_0x37a6d4++};_0x9a241f[_0x487b28(0x7d3)][_0x487b28(0x1a0)](_0x4cb35),isViewingThisChat?_0x48f5ff(_0x4cb35,_0x9a241f):(_0x9a241f[_0x487b28(0x1090)]=(_0x9a241f[_0x487b28(0x1090)]||0x0)+0x1,_0xabb267(_0x4f79ba,'['+_0x9a241f[_0x487b28(0x564)]+_0x487b28(0x102a)),_0x456512=!![]);}else console['warn']('AI\x20\x22'+_0x9a241f['name']+_0x487b28(0x208)+_0x3cbd51[_0x487b28(0x403)]+')');continue;}case _0x487b28(0x56d):_0x610fd1={..._0x4e960a,'content':_0x3cbd51[_0x487b28(0xac4)]};break;case _0x487b28(0x135a):_0x610fd1={..._0x4e960a,'type':_0x487b28(0x135a),'content':_0x3cbd51[_0x487b28(0x78b)]};break;case _0x487b28(0xb9e):if(_0x3cbd51[_0x487b28(0x720)]){const _0x109bae=_0x505390['userStickers'][_0x487b28(0xc0d)](_0x335033=>_0x335033[_0x487b28(0x564)]===_0x3cbd51[_0x487b28(0x720)]);_0x109bae?_0x610fd1={..._0x4e960a,'type':_0x487b28(0xb9e),'content':_0x109bae[_0x487b28(0x5f3)],'meaning':_0x109bae[_0x487b28(0x564)]}:(console[_0x487b28(0x139e)]('AI\x20(独立行动)\x20尝试使用一个不存在的表情:\x20\x22'+_0x3cbd51[_0x487b28(0x720)]+'\x22'),_0x610fd1={..._0x4e960a,'type':_0x487b28(0x56d),'content':_0x487b28(0xdbf)+_0x3cbd51[_0x487b28(0x720)]+']'});}else console['warn'](_0x487b28(0x7cc),_0x3cbd51),_0x610fd1={..._0x4e960a,'type':_0x487b28(0xb9e),'content':_0x3cbd51[_0x487b28(0x5f3)],'meaning':_0x487b28(0x735)};break;case _0x487b28(0x942):_0x9a241f[_0x487b28(0x93c)][_0x487b28(0x56d)]=_0x3cbd51['status_text'],_0x9a241f[_0x487b28(0x93c)]['isBusy']=_0x3cbd51['is_busy']||![],_0x9a241f[_0x487b28(0x93c)]['lastUpdate']=Date[_0x487b28(0x12d6)]();break;case _0x487b28(0x239):const _0x39b40e={'type':_0x3cbd51['postType'],'content':_0x3cbd51[_0x487b28(0xac4)]||'','publicText':_0x3cbd51[_0x487b28(0x105a)]||'','hiddenContent':_0x3cbd51['hiddenContent']||'','image_prompt':_0x3cbd51[_0x487b28(0xfb2)]||'','timestamp':Date[_0x487b28(0x12d6)](),'authorId':_0x4f79ba,'authorOriginalName':_0x9a241f['originalName'],'authorGroupId':_0x9a241f[_0x487b28(0x194)],'visibleGroupIds':null};await _0xb81d4e[_0x487b28(0xcce)][_0x487b28(0x807)](_0x39b40e),_0xa385c3(_0x22cc4e+0x1),console[_0x487b28(0x90f)]('后台活动:\x20角色\x20\x22'+_0x9a241f[_0x487b28(0x564)]+_0x487b28(0x108e));break;case _0x487b28(0xe30):const _0x4ee41e=await _0xb81d4e[_0x487b28(0xcce)][_0x487b28(0x111a)](parseInt(_0x3cbd51[_0x487b28(0x403)]));if(_0x4ee41e){const _0x1c4152={'type':_0x487b28(0xe30),'timestamp':Date[_0x487b28(0x12d6)](),'authorId':_0x4f79ba,'authorGroupId':_0x9a241f[_0x487b28(0x194)],'authorOriginalName':_0x9a241f['originalName'],'repostComment':_0x3cbd51[_0x487b28(0xd6c)]||'','originalPost':_0x4ee41e,'visibleGroupIds':null};await _0xb81d4e[_0x487b28(0xcce)][_0x487b28(0x807)](_0x1c4152),_0xa385c3(_0x22cc4e+0x1),console[_0x487b28(0x90f)](_0x487b28(0xd1f)+_0x9a241f[_0x487b28(0x564)]+'\x22\x20转发了动态\x20#'+_0x3cbd51[_0x487b28(0x403)]);}break;case _0x487b28(0x308):const _0x20b306=await _0xb81d4e[_0x487b28(0xcce)][_0x487b28(0x111a)](parseInt(_0x3cbd51[_0x487b28(0x403)]));if(_0x20b306){if(!_0x20b306[_0x487b28(0x12e3)])_0x20b306[_0x487b28(0x12e3)]=[];!_0x20b306[_0x487b28(0x12e3)]['includes'](_0x9a241f['originalName'])&&(_0x20b306[_0x487b28(0x12e3)][_0x487b28(0x1a0)](_0x9a241f['originalName']),await _0xb81d4e['qzonePosts'][_0x487b28(0xeb2)](_0x20b306['id'],{'likes':_0x20b306[_0x487b28(0x12e3)]}),_0xa385c3(_0x22cc4e+0x1),console[_0x487b28(0x90f)](_0x487b28(0xd1f)+_0x9a241f[_0x487b28(0x564)]+_0x487b28(0xe7f)+_0x3cbd51[_0x487b28(0x403)]));}break;case'qzone_comment':{const _0x4573c9=await _0xb81d4e[_0x487b28(0xcce)]['get'](parseInt(_0x3cbd51[_0x487b28(0x403)]));if(_0x4573c9){if(!_0x4573c9[_0x487b28(0xd3c)])_0x4573c9[_0x487b28(0xd3c)]=[];const _0x186e96=_0x3cbd51['name']||_0x9a241f[_0x487b28(0xe2d)],_0x12a518=(_0x40f083,_0x2b0ac1=null,_0x4f80c0=null)=>({'commenterName':_0x186e96,'text':_0x4537d4(_0x40f083,_0x9a241f),'meaning':_0x2b0ac1,'replyTo':_0x4f80c0,'timestamp':Date[_0x487b28(0x12d6)]()});if(_0x3cbd51['stickerMeaning']){const _0x7da0f4=_0x505390['userStickers']['find'](_0x185f8f=>_0x185f8f[_0x487b28(0x564)]===_0x3cbd51[_0x487b28(0x7e3)]);_0x7da0f4?_0x4573c9['comments'][_0x487b28(0x1a0)](_0x12a518(_0x7da0f4[_0x487b28(0x5f3)],_0x7da0f4[_0x487b28(0x564)],_0x3cbd51[_0x487b28(0x32a)]||null)):(console[_0x487b28(0x139e)]('AI\x20尝试评论一个不存在的表情:\x20\x22'+_0x3cbd51[_0x487b28(0x7e3)]+'\x22'),_0x4573c9[_0x487b28(0xd3c)][_0x487b28(0x1a0)](_0x12a518(_0x487b28(0xdbf)+_0x3cbd51[_0x487b28(0x7e3)]+']',null,_0x3cbd51[_0x487b28(0x32a)]||null)));}else{if(Array[_0x487b28(0x285)](_0x3cbd51[_0x487b28(0xd3c)]))_0x3cbd51[_0x487b28(0xd3c)][_0x487b28(0x12be)](_0x47cf01=>{const _0x26c0e4=_0x487b28;typeof _0x47cf01===_0x26c0e4(0x8d9)&&_0x47cf01['trim']()&&_0x4573c9[_0x26c0e4(0xd3c)][_0x26c0e4(0x1a0)](_0x12a518(_0x47cf01,null,_0x3cbd51[_0x26c0e4(0x32a)]||null));});else typeof _0x3cbd51[_0x487b28(0xcca)]==='string'&&_0x3cbd51['commentText'][_0x487b28(0x9c1)]()&&_0x4573c9[_0x487b28(0xd3c)][_0x487b28(0x1a0)](_0x12a518(_0x3cbd51[_0x487b28(0xcca)],null,_0x3cbd51[_0x487b28(0x32a)]||null));}await _0xb81d4e[_0x487b28(0xcce)][_0x487b28(0xeb2)](_0x4573c9['id'],{'comments':_0x4573c9[_0x487b28(0xd3c)]}),_0xa385c3(_0x22cc4e+0x1),console['log']('后台活动:\x20角色\x20\x22'+_0x9a241f[_0x487b28(0x564)]+_0x487b28(0xf15)+_0x3cbd51[_0x487b28(0x403)]);if(!_0x9a241f[_0x487b28(0x946)])_0x9a241f[_0x487b28(0x946)]={};_0x9a241f['commentCooldowns'][_0x3cbd51[_0x487b28(0x403)]]=Date[_0x487b28(0x12d6)]();}continue;}case _0x487b28(0xacd):!_0x315a6a['isActive']&&!_0x315a6a[_0x487b28(0xbb7)]&&(_0x315a6a['isAwaitingResponse']=!![],_0x315a6a[_0x487b28(0x233)]=_0x4f79ba,_0x315a6a['isGroupCall']=![],_0x315a6a[_0x487b28(0x648)]=_0x9a241f[_0x487b28(0x564)],_0x550c2f());break;default:console[_0x487b28(0x139e)](_0x487b28(0xced)+_0x9a241f['name']+'\x22\x20尝试执行未知的后台动作:',_0x3cbd51[_0x487b28(0x858)]);break;case _0x487b28(0x1138):{const _0xf5ac5e=_0x3cbd51['name'],_0x30211f=_0x9a241f[_0x487b28(0x18a)]['aiAvatarLibrary'][_0x487b28(0xc0d)](_0x369274=>_0x369274[_0x487b28(0x564)]===_0xf5ac5e);_0x30211f&&(_0x9a241f['settings'][_0x487b28(0x1039)]=_0x30211f[_0x487b28(0x5f3)],await _0x134037(_0x9a241f),visibleSystemMessage={'content':'['+_0x9a241f[_0x487b28(0x564)]+_0x487b28(0x6e2)},console[_0x487b28(0x90f)](_0x487b28(0xd1f)+_0x9a241f[_0x487b28(0x564)]+_0x487b28(0x7f2)));break;}}if(_0x610fd1){_0x9a241f[_0x487b28(0x7d3)][_0x487b28(0x1a0)](_0x610fd1),_0x9a241f[_0x487b28(0x1090)]=(_0x9a241f[_0x487b28(0x1090)]||0x0)+0x1;if(!_0x456512){let _0x4ddd12=_0x610fd1[_0x487b28(0x858)]===_0x487b28(0x135a)?_0x487b28(0x11e6):_0x610fd1[_0x487b28(0xac4)]||'';_0xabb267(_0x4f79ba,_0x4ddd12),_0x456512=!![];}}}await _0xb81d4e[_0x487b28(0x1027)][_0x487b28(0x5d0)](_0x9a241f);}catch(_0x3a5b47){console[_0x487b28(0xe3b)](_0x487b28(0xced)+_0x9a241f[_0x487b28(0x564)]+'\x22\x20的独立行动失败:',_0x3a5b47);}finally{_0x156c85(_0x4f79ba,![]),_0x1b7f69(),document[_0x487b28(0x479)](_0x487b28(0xc8d))[_0x487b28(0x9cd)]['contains'](_0x487b28(0x5a9))&&_0x2eb20b();}}async function _0x3b7a94(_0x28c6a8){const _0x52917d=_0x85c4bf,_0x44cf30=_0x505390[_0x52917d(0x1027)][_0x28c6a8];if(!_0x44cf30||!_0x44cf30[_0x52917d(0x9d7)])return;const _0x5c9cc9=_0x44cf30[_0x52917d(0x18a)][_0x52917d(0x1097)]||0xa;if(_0x44cf30[_0x52917d(0xa28)]){const _0x54a647=(Date[_0x52917d(0x12d6)]()-_0x44cf30[_0x52917d(0xa28)])/(0x3e8*0x3c);if(_0x54a647<_0x5c9cc9){console[_0x52917d(0x90f)](_0x52917d(0xef8)+_0x44cf30[_0x52917d(0x564)]+_0x52917d(0xd5d));return;}}const {proxyUrl:_0x46e6da,apiKey:_0x5b8581,model:_0x56c6fb}=_0x505390[_0x52917d(0x30c)];if(!_0x46e6da||!_0x5b8581||!_0x56c6fb)return;const _0x4a0fb7=_0x44cf30[_0x52917d(0x18a)]['myNickname']||'我',_0xedeec3=new Date();let _0x3d34d7;const _0x236089=_0x44cf30[_0x52917d(0x7d3)][_0x52917d(0x85d)](_0x5d3ab6=>!_0x5d3ab6[_0x52917d(0xb9c)])[_0x52917d(0x777)](-0x5),_0xee9eb2=_0x236089['find'](_0x43a7c6=>_0x43a7c6[_0x52917d(0x858)]===_0x52917d(0x1358)&&!_0x43a7c6[_0x52917d(0x824)]);if(_0xee9eb2){const _0x3179e2=_0x503999(_0x44cf30,_0xee9eb2[_0x52917d(0xdcc)]);console[_0x52917d(0x90f)](_0x52917d(0x6e9)+_0x44cf30[_0x52917d(0x564)]+_0x52917d(0xe9f)),_0x3d34d7='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的【【【最高优先级任务】】】\x0a\x20\x20\x20\x20\x20\x20\x20\x20群聊中刚刚出现了一个由“'+_0x3179e2+_0x52917d(0x10c4)+_0xee9eb2['timestamp']+'）。\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的任务是：选择【一个或多个】符合人设的角色，让他们【立刻】使用\x20\x27open_red_packet\x27\x20指令去尝试领取这个红包。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20指令格式\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON数组，格式如下：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x27[{\x22type\x22:\x20\x22open_red_packet\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22packet_timestamp\x22:\x20'+_0xee9eb2['timestamp']+'}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20你可以让多个角色同时尝试，只需在返回的JSON数组中包含多个这样的对象即可。\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请立即执行抢红包操作！\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}else{let _0x5e35c1='';const _0x1bdc5c=_0x44cf30[_0x52917d(0x18a)][_0x52917d(0xac0)]||'Asia/Shanghai',_0x2b1765=_0xedeec3['toLocaleString']('zh-CN',{'timeZone':_0x1bdc5c,'dateStyle':_0x52917d(0xf31),'timeStyle':_0x52917d(0xe6f)}),_0x37abaa=new Date(_0xedeec3[_0x52917d(0x119c)](_0x52917d(0x5d4),{'timeZone':_0x1bdc5c}));if(_0x44cf30['settings'][_0x52917d(0xeb0)]){const _0x448407=_0x44cf30['history'][_0x52917d(0x85d)](_0x21c6a1=>!_0x21c6a1['isHidden'])['slice'](-0x1)[0x0];if(_0x448407){const _0x2504f8=new Date(_0x448407[_0x52917d(0x12a2)]),_0x4efdc5=(_0xedeec3-_0x2504f8)/(0x3e8*0x3c);_0x4efdc5>0x3c?_0x5e35c1=_0x52917d(0x1d1)+Math[_0x52917d(0x412)](_0x4efdc5/0x3c)+'\x20小时了。':_0x5e35c1=_0x52917d(0xbb9)+Math[_0x52917d(0xd71)](_0x4efdc5)+'分钟前有人聊过。';}else _0x5e35c1=_0x52917d(0x1242);}let _0x39e434=_0x52917d(0xbe6);const _0x3fc912=_0x44cf30[_0x52917d(0x18a)]['maxMemory']||0xa,_0x3fa3f3=_0x44cf30[_0x52917d(0x7d3)][_0x52917d(0x85d)](_0x43f1aa=>!_0x43f1aa[_0x52917d(0xb9c)])[_0x52917d(0x777)](-_0x3fc912);_0x3fa3f3[_0x52917d(0x990)]>0x0&&(_0x39e434='这是你们最近的对话：\x0a'+_0x3fa3f3[_0x52917d(0x2e1)](_0x195ac4=>{const _0x40e1fa=_0x52917d,_0x270198=_0x195ac4[_0x40e1fa(0x508)]==='user'?_0x4a0fb7:_0x503999(_0x44cf30,_0x195ac4[_0x40e1fa(0xdcc)]),_0x209a59=String(_0x195ac4['content']||_0x195ac4[_0x40e1fa(0x757)]||'')[_0x40e1fa(0x1323)](0x0,0x32);return _0x270198+':\x20'+_0x209a59+_0x40e1fa(0x4d0);})[_0x52917d(0x35d)]('\x0a'));const _0x277ce1=_0x44cf30['members'][_0x52917d(0x2e1)](_0xdc6a0e=>'-\x20**'+_0xdc6a0e[_0x52917d(0xa54)]+_0x52917d(0x11a8)+_0xdc6a0e[_0x52917d(0xe2d)]+_0x52917d(0x1044)+_0xdc6a0e[_0x52917d(0x596)])[_0x52917d(0x35d)]('\x0a');let _0x5b0a38=_0x52917d(0xbae),_0x1dc3b5=![];_0x44cf30['members'][_0x52917d(0x12be)](_0x5663d6=>{const _0xa0f86f=_0x52917d,_0x175862=_0x505390[_0xa0f86f(0x1027)][_0x5663d6['id']];_0x175862&&_0x175862[_0xa0f86f(0x3b4)]&&_0x175862[_0xa0f86f(0x3b4)][_0xa0f86f(0x990)]>0x0&&(_0x5b0a38+=_0xa0f86f(0xfaa)+_0x5663d6['groupNickname']+'”的记忆\x20---\x0a',_0x5b0a38+=_0x175862['longTermMemory'][_0xa0f86f(0x2e1)](_0xe35906=>'-\x20'+_0xe35906[_0xa0f86f(0xac4)])['join']('\x0a'),_0x1dc3b5=!![]);});!_0x1dc3b5&&(_0x5b0a38+=_0x52917d(0xa15));let _0x446e59='';if(_0x44cf30['settings'][_0x52917d(0x13da)]&&_0x44cf30[_0x52917d(0x18a)][_0x52917d(0x13da)]['length']>0x0){const _0x1fcefe=_0x44cf30[_0x52917d(0x18a)]['linkedWorldBookIds']['map'](_0x506eb4=>{const _0x479440=_0x52917d,_0x377d4a=_0x505390[_0x479440(0xd1b)][_0x479440(0xc0d)](_0x1df446=>_0x1df446['id']===_0x506eb4);if(!_0x377d4a||!Array[_0x479440(0x285)](_0x377d4a[_0x479440(0xac4)]))return'';const _0x39d03e=_0x377d4a[_0x479440(0xac4)]['filter'](_0x3b11de=>_0x3b11de[_0x479440(0x2b7)]!==![])[_0x479440(0x2e1)](_0x3b3964=>{const _0x5ca162=_0x479440;let _0x583ded=_0x5ca162(0x1345)+(_0x3b3964['comment']||_0x5ca162(0x561))+'\x0a';return _0x3b3964[_0x5ca162(0x108c)][_0x5ca162(0x990)]>0x0&&(_0x583ded+='**关键词:**\x20'+_0x3b3964[_0x5ca162(0x108c)][_0x5ca162(0x35d)](',\x20')+'\x0a'),_0x583ded+=_0x5ca162(0xb8a)+_0x3b3964[_0x5ca162(0xac4)],_0x583ded;})[_0x479440(0x35d)]('');return _0x39d03e?_0x479440(0x103d)+_0x377d4a['name']+'\x0a'+_0x39d03e:'';})['filter'](Boolean)[_0x52917d(0x35d)]('');_0x1fcefe&&(_0x446e59=_0x52917d(0x12b0)+_0x1fcefe+'\x0a#\x20---\x20世界书设定结束\x20---\x0a');}let _0x12c0a8='';const _0x223fd0=_0x44cf30[_0x52917d(0x18a)]['linkedMemoryCount']||0xa;if(_0x44cf30[_0x52917d(0x18a)][_0x52917d(0xefa)]&&_0x44cf30[_0x52917d(0x18a)][_0x52917d(0xefa)][_0x52917d(0x990)]>0x0){const _0x32e759=_0x44cf30['settings'][_0x52917d(0xefa)][_0x52917d(0x2e1)](_0xd54115=>{const _0x144e68=_0x52917d,_0x35a3d1=_0x505390['chats'][_0xd54115];if(!_0x35a3d1)return null;const _0x3c8096=_0x35a3d1[_0x144e68(0x7d3)]['slice'](-0x1)[0x0];return{'chat':_0x35a3d1,'latestTimestamp':_0x3c8096?_0x3c8096[_0x144e68(0x12a2)]:0x0};})[_0x52917d(0x85d)](Boolean);_0x32e759[_0x52917d(0x382)]((_0x5e91fa,_0x4ac47c)=>_0x4ac47c[_0x52917d(0x698)]-_0x5e91fa[_0x52917d(0x698)]),_0x12c0a8+='\x0a\x0a#\x20参考记忆\x20(至关重要！群内角色必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你们拥有完整的共同记忆。)\x0a';for(const _0x2c9928 of _0x32e759){const _0x3ec875=_0x2c9928[_0x52917d(0xa50)],_0x285c20=_0x3ec875['isGroup']?_0x52917d(0x519):_0x52917d(0x9ae),_0x3308e8=_0x2c9928['latestTimestamp']>0x0?_0x52917d(0xcb6)+_0x3e14b1(_0x2c9928[_0x52917d(0x698)])+')':'';_0x12c0a8+=_0x52917d(0x3df)+_0x285c20+'“'+_0x3ec875[_0x52917d(0x564)]+_0x52917d(0x1335)+_0x3308e8+_0x52917d(0x261);const _0x2766f9=_0x3ec875[_0x52917d(0x7d3)][_0x52917d(0x777)](-_0x223fd0),_0x462d2b=_0x2766f9['filter'](_0x17f9eb=>!String(_0x17f9eb[_0x52917d(0xac4)])[_0x52917d(0x44f)](_0x52917d(0xe64)));_0x462d2b[_0x52917d(0x990)]>0x0?_0x462d2b[_0x52917d(0x12be)](_0x2d6218=>{const _0x228ea0=_0x52917d,_0x39cc86=_0x2d6218[_0x228ea0(0x508)]===_0x228ea0(0x4c5)?_0x3ec875['settings'][_0x228ea0(0xf58)]||'我':_0x2d6218[_0x228ea0(0xdcc)]||_0x3ec875['name'];let _0x234c8d=String(_0x2d6218[_0x228ea0(0xac4)]);if(_0x2d6218[_0x228ea0(0x858)]==='ai_image'||_0x2d6218[_0x228ea0(0x858)]===_0x228ea0(0x5d5))_0x234c8d=_0x228ea0(0xa05)+_0x2d6218[_0x228ea0(0xac4)]+']';else _0x2d6218[_0x228ea0(0x858)]===_0x228ea0(0x9bf)&&(_0x234c8d=_0x228ea0(0xb7e)+_0x2d6218['content']+']');_0x12c0a8+=_0x39cc86+':\x20'+_0x234c8d+'\x0a';}):_0x12c0a8+='(暂无有效聊天记录)\x0a';}}const _0x4d1009=await _0xb81d4e[_0x52917d(0xcce)][_0x52917d(0x3d2)](_0x52917d(0x12a2))['reverse']()[_0x52917d(0xca0)](0x5)[_0x52917d(0x4ba)]();let _0x598d18='';const _0xeadb32=new Set();for(const _0x452972 of _0x44cf30[_0x52917d(0x954)]){const _0x5051f8=_0x505390[_0x52917d(0x1027)][_0x452972['id']];if(_0x5051f8){const _0x16a271=_0x4d9aaa(_0x4d1009,_0x5051f8);_0x16a271[_0x52917d(0x12be)](_0x5d69c7=>_0xeadb32[_0x52917d(0x807)](_0x5d69c7));}}const _0x127ef9=new Set(_0x44cf30[_0x52917d(0x954)][_0x52917d(0x2e1)](_0x1b6613=>_0x1b6613[_0x52917d(0xe2d)])),_0x4dbeb5=[..._0xeadb32][_0x52917d(0x85d)](_0x24ac72=>{const _0xb4dfcd=_0x52917d,_0x227a5d=_0x24ac72[_0xb4dfcd(0x12e3)]&&_0x24ac72[_0xb4dfcd(0x12e3)][_0xb4dfcd(0x1235)](_0x26dd94=>_0x127ef9[_0xb4dfcd(0x391)](_0x26dd94)),_0x168bd1=_0x24ac72[_0xb4dfcd(0xd3c)]&&_0x24ac72[_0xb4dfcd(0xd3c)][_0xb4dfcd(0x1235)](_0x20ee63=>typeof _0x20ee63===_0xb4dfcd(0x65a)&&_0x127ef9[_0xb4dfcd(0x391)](_0x20ee63[_0xb4dfcd(0x13e3)]));return!_0x227a5d&&!_0x168bd1;});if(_0x4dbeb5['length']>0x0){let _0x17a30e=_0x52917d(0xbcb);for(const _0x212c1c of _0x4dbeb5){let _0x11d3c7=_0x212c1c[_0x52917d(0x981)]==='user'?_0x4a0fb7:_0x505390[_0x52917d(0x1027)][_0x212c1c[_0x52917d(0x981)]]?.['name']||_0x52917d(0x3b3),_0x20bc0d;if(_0x212c1c['type']===_0x52917d(0xe30)){const _0x4169b3=_0x212c1c[_0x52917d(0x3aa)]?_0x52917d(0xb53)+_0x212c1c[_0x52917d(0x3aa)]+'”':'';let _0x373195=_0x52917d(0xbe2);const _0xd35a7=_0x212c1c[_0x52917d(0x445)][_0x52917d(0x981)];if(_0xd35a7===_0x52917d(0x4c5))_0x373195=_0x505390[_0x52917d(0x1190)][_0x52917d(0x904)];else _0x505390[_0x52917d(0x1027)][_0xd35a7]&&(_0x373195=_0x505390['chats'][_0xd35a7]['name']);let _0x5b19c6;const _0x44a65c=_0x212c1c['originalPost'];if(_0x44a65c[_0x52917d(0x858)]===_0x52917d(0xd84))_0x5b19c6=_0x52917d(0xe6c)+(_0x44a65c[_0x52917d(0x105a)]||'')+_0x52917d(0x10d5)+(_0x44a65c[_0x52917d(0x112d)]||'')[_0x52917d(0x1323)](0x0,0x28)+_0x52917d(0x1355);else _0x44a65c[_0x52917d(0x858)]===_0x52917d(0x133a)?_0x5b19c6=_0x52917d(0x3be)+(_0x44a65c[_0x52917d(0x105a)]||'')+_0x52917d(0x10d5)+(_0x44a65c['imageDescription']||'')[_0x52917d(0x1323)](0x0,0x28)+_0x52917d(0x1355):_0x5b19c6='“'+(_0x44a65c[_0x52917d(0xac4)]||'')[_0x52917d(0x1323)](0x0,0x28)+'...”';_0x20bc0d=_0x52917d(0x12e0)+_0x373195+_0x52917d(0x11d3)+_0x4169b3+_0x52917d(0x207)+_0x5b19c6+'】';}else{if(_0x212c1c['type']===_0x52917d(0xd84))_0x20bc0d=(_0x52917d(0xfae)+_0x212c1c[_0x52917d(0x112d)]+'”]\x20'+(_0x212c1c[_0x52917d(0x105a)]||''))['substring'](0x0,0x32)+_0x52917d(0x4d0);else _0x212c1c[_0x52917d(0x858)]===_0x52917d(0x133a)?_0x20bc0d=(_0x52917d(0xf40)+_0x212c1c[_0x52917d(0x11a4)]+_0x52917d(0x1382)+(_0x212c1c[_0x52917d(0x105a)]||''))[_0x52917d(0x1323)](0x0,0x32)+'...':_0x20bc0d=String(_0x212c1c[_0x52917d(0x105a)]||_0x212c1c[_0x52917d(0xac4)]||'一条动态')['substring'](0x0,0x32)+_0x52917d(0x4d0);}_0x17a30e+=_0x52917d(0xfb3)+_0x212c1c['id']+')\x20作者:\x20'+_0x11d3c7+_0x52917d(0xc73)+_0x20bc0d+'\x22\x0a';if(_0x212c1c[_0x52917d(0xd3c)]&&_0x212c1c[_0x52917d(0xd3c)][_0x52917d(0x990)]>0x0)for(const _0x1c09d1 of _0x212c1c['comments']){if(typeof _0x1c09d1===_0x52917d(0x65a)&&_0x1c09d1['commenterName']){const _0xc792b7=_0x148d9b(_0x1c09d1[_0x52917d(0x13e3)]);let _0x4add28=_0x1c09d1[_0x52917d(0x720)]?_0x52917d(0x801)+_0x1c09d1['meaning']+'\x27]':_0x1c09d1[_0x52917d(0x56d)];_0x17a30e+=_0x52917d(0x1dd)+_0xc792b7+_0x52917d(0x13c8)+_0x1c09d1[_0x52917d(0x13e3)]+_0x52917d(0x1044)+_0x4add28+'\x0a';}}}_0x598d18=_0x17a30e;}const _0x13beac=_0x37bdc8(_0x44cf30,0x3,'hours'),_0x25f371=_0x37bdc8(_0x44cf30,0x6,'hours'),_0x30df27=_0x37bdc8(_0x44cf30,0x9,'hours'),_0x45eca9=_0x37bdc8(_0x44cf30,0x1,_0x52917d(0x111c)),_0x53cd30=_0x37bdc8(_0x44cf30,0x3,'days'),_0x2d22f1=_0x37bdc8(_0x44cf30,0x7,_0x52917d(0x111c));let _0x2e581a='';if(_0x13beac||_0x25f371||_0x30df27||_0x45eca9||_0x53cd30||_0x2d22f1){_0x2e581a+=_0x52917d(0x2a0);if(_0x13beac)_0x2e581a+=_0x13beac;if(_0x25f371)_0x2e581a+=_0x25f371;if(_0x30df27)_0x2e581a+=_0x30df27;if(_0x13beac||_0x25f371||_0x30df27)_0x2e581a+='\x0a';if(_0x45eca9)_0x2e581a+=_0x45eca9;if(_0x53cd30)_0x2e581a+=_0x53cd30;if(_0x2d22f1)_0x2e581a+=_0x2d22f1;}const _0x3f0a3f=_0x46c840(_0x44cf30);_0x3d34d7='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你是一个群聊AI导演。你现在控制着一个名为“'+_0x44cf30[_0x52917d(0x564)]+_0x52917d(0x309)+(_0x44cf30[_0x52917d(0x18a)][_0x52917d(0xeb0)]?_0x52917d(0xb7b)+_0x2b1765+'。':'')+_0x52917d(0xb58)+(_0x5e35c1?_0x5e35c1+'\x20':'')+_0x52917d(0xb19)+_0x5b0a38+_0x52917d(0xc08)+_0x4a0fb7+'\x22\x20的消息。严格遵守每个角色的设定，禁止出戏。\x0a-请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的可选行动指令:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送文本**:\x20\x27{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22文本内容\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送表情**:\x20\x27{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送图片**:\x20\x27{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22图片的详细【中文】描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发起投票**:\x20\x27{\x22type\x22:\x20\x22poll\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22question\x22:\x20\x22...\x22,\x20\x22options\x22:\x20\x22...\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发起群视频**:\x20\x27{\x22type\x22:\x20\x22group_call_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-如何正确使用“引用回复”功能：\x0a-\x20当你想明确地针对群内【任何成员】（包括用户或其他AI角色）之前的某一句具体的话进行回复时，你就应该使用这个功能。\x0a-\x20这会让你的回复上方出现一个灰色的小框，里面是被你引用的那句话，这样对话就不会乱了。\x0a-\x20指令格式:\x20\x27{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20(你想引用的那句话的时间戳),\x20\x22reply_content\x22:\x20\x22你的回复内容\x22}\x27\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前群聊信息\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**群名称**:\x20'+_0x44cf30[_0x52917d(0x564)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x446e59+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x44cf30['longTermMemory']&&_0x44cf30[_0x52917d(0x3b4)][_0x52917d(0x990)]>0x0?_0x44cf30[_0x52917d(0x3b4)][_0x52917d(0x2e1)](_0x17c97c=>'-\x20'+_0x17c97c[_0x52917d(0xac4)])['join']('\x0a'):_0x52917d(0xa15))+_0x52917d(0xd85)+_0x2e581a+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x12c0a8+_0x52917d(0x93a)+_0x277ce1+_0x52917d(0x72a)+_0x3f0a3f+_0x52917d(0x1357)+_0x4a0fb7+'**:\x20'+_0x44cf30[_0x52917d(0x18a)][_0x52917d(0x12d7)]+_0x52917d(0x90e)+_0x39e434+_0x52917d(0x270)+_0x598d18+_0x52917d(0x4df);}const _0x5f31de=_0x44cf30['history']['filter'](_0x4afb92=>!_0x4afb92[_0x52917d(0xb9c)])[_0x52917d(0x777)](-0xa),_0x4a8d54=[{'role':'system','content':_0x3d34d7},..._0x5f31de[_0x52917d(0x2e1)](_0x5b96fa=>{const _0x17836a=_0x52917d,_0x5cb541=_0x5b96fa['role']===_0x17836a(0x4c5)?_0x4a0fb7:_0x503999(_0x44cf30,_0x5b96fa[_0x17836a(0xdcc)]);let _0x112a11=_0x5b96fa['content'];if(_0x5b96fa[_0x17836a(0x858)]===_0x17836a(0x135a)||_0x5b96fa[_0x17836a(0x858)]===_0x17836a(0x5d5))_0x112a11=_0x17836a(0xd7b)+_0x5b96fa[_0x17836a(0xac4)]+'\x27]';else{if(_0x5b96fa['type']===_0x17836a(0x9bf))_0x112a11=_0x17836a(0xe66)+_0x5b96fa[_0x17836a(0xac4)]+'\x27]';else typeof _0x112a11!==_0x17836a(0x8d9)&&(_0x112a11=_0x17836a(0xef0));}return{'role':_0x17836a(0x4c5),'content':_0x5cb541+':\x20'+_0x112a11};})];try{const _0x2c3118=[{'role':_0x52917d(0x4c5),'content':_0x3d34d7}];let _0x721b22=_0x46e6da===GEMINI_API_URL,_0x155d53=_0x19a701(_0x56c6fb,_0x5b8581,_0x3d34d7,_0x2c3118);const _0xd84339=_0x721b22?await fetch(_0x155d53[_0x52917d(0x5f3)],_0x155d53[_0x52917d(0x104c)]):await fetch(_0x46e6da+_0x52917d(0x347),{'method':'POST','headers':{'Content-Type':_0x52917d(0xcb5),'Authorization':_0x52917d(0xb27)+_0x5b8581},'body':JSON['stringify']({'model':_0x56c6fb,'messages':_0x2c3118,'temperature':_0x505390[_0x52917d(0x888)]['apiTemperature']||0.9})});if(!_0xd84339['ok'])throw new Error((await _0xd84339[_0x52917d(0xfdf)]())['error'][_0x52917d(0x757)]);const _0x24fb3a=await _0xd84339['json'](),_0x2c15da=_0x721b22?_0x24fb3a[_0x52917d(0x5a4)][0x0][_0x52917d(0xac4)][_0x52917d(0xa53)][0x0][_0x52917d(0x56d)]:_0x24fb3a[_0x52917d(0xd5c)][0x0][_0x52917d(0x757)][_0x52917d(0xac4)],_0x9cc701=_0x2da9f3(_0x2c15da);if(!_0x9cc701||_0x9cc701[_0x52917d(0x990)]===0x0){console['warn']('群聊\x20\x22'+_0x44cf30[_0x52917d(0x564)]+_0x52917d(0xc90));return;}let _0x121159=Date[_0x52917d(0x12d6)](),_0x56f749=![],_0x2f589d='',_0x5e2c6e='';const _0x5b2f4f=[];for(const _0x2b9ac3 of _0x9cc701){const _0x52b495=String(_0x2b9ac3[_0x52917d(0xac4)]||''),_0x5b8527=_0x52b495[_0x52917d(0x9c1)]()[_0x52917d(0x591)]('<')&&_0x52b495[_0x52917d(0x9c1)]()['endsWith']('>');if(_0x2b9ac3[_0x52917d(0x858)]===_0x52917d(0x56d)&&!_0x5b8527&&_0x52b495[_0x52917d(0x44f)]('\x0a')){const _0x111789=_0x52b495[_0x52917d(0x53e)](/\n+/)[_0x52917d(0x85d)](_0x1f9bff=>_0x1f9bff[_0x52917d(0x9c1)]());_0x111789['forEach'](_0x4cb5fb=>{const _0x63466f=_0x52917d;_0x5b2f4f[_0x63466f(0x1a0)]({..._0x2b9ac3,'content':_0x4cb5fb});});}else _0x5b2f4f[_0x52917d(0x1a0)](_0x2b9ac3);}for(const _0x3a8dd6 of _0x5b2f4f){if(!_0x3a8dd6||!_0x3a8dd6['type']||!_0x3a8dd6['name'])continue;const _0x554a07=_0x503999(_0x44cf30,_0x3a8dd6[_0x52917d(0x564)]);let _0x209871=null,_0x4c783c=null;const _0x300a20={'role':_0x52917d(0x1328),'senderName':_0x3a8dd6[_0x52917d(0x564)],'timestamp':_0x121159++};if(_0x3a8dd6[_0x52917d(0x858)]===_0x52917d(0xcb3)){const _0xb5e2ca=_0x44cf30[_0x52917d(0x7d3)]['find'](_0xcfbbae=>_0xcfbbae[_0x52917d(0x12a2)]===_0x3a8dd6['packet_timestamp']);if(_0xb5e2ca&&!_0xb5e2ca[_0x52917d(0x824)]&&!(_0xb5e2ca[_0x52917d(0x12e6)]&&_0xb5e2ca[_0x52917d(0x12e6)][_0x3a8dd6['name']])){let _0x103c3e=0x0;const _0x407004=_0xb5e2ca[_0x52917d(0xc10)]-Object[_0x52917d(0x3d5)](_0xb5e2ca['claimedBy']||{})[_0x52917d(0x1300)]((_0x5b6575,_0x5e17ef)=>_0x5b6575+_0x5e17ef,0x0),_0x1417aa=_0xb5e2ca['count']-Object['keys'](_0xb5e2ca[_0x52917d(0x12e6)]||{})[_0x52917d(0x990)];if(_0x1417aa>0x0){if(_0x1417aa===0x1)_0x103c3e=_0x407004;else{const _0xc0e7b0=0.01,_0x559548=_0x407004-(_0x1417aa-0x1)*_0xc0e7b0;_0x103c3e=Math[_0x52917d(0x103a)]()*(_0x559548-_0xc0e7b0)+_0xc0e7b0;}_0x103c3e=parseFloat(_0x103c3e[_0x52917d(0x6e1)](0x2));if(!_0xb5e2ca['claimedBy'])_0xb5e2ca['claimedBy']={};_0xb5e2ca[_0x52917d(0x12e6)][_0x3a8dd6[_0x52917d(0x564)]]=_0x103c3e,_0x44cf30[_0x52917d(0x7d3)]['push']({'role':_0x52917d(0xbaa),'type':'pat_message','content':_0x554a07+_0x52917d(0x1161)+_0x503999(_0x44cf30,_0xb5e2ca[_0x52917d(0xdcc)])+_0x52917d(0xa81),'timestamp':Date[_0x52917d(0x12d6)]()});let _0x5eebe7='[系统提示：你\x20('+_0x554a07+_0x52917d(0xe15)+_0x103c3e['toFixed'](0x2)+_0x52917d(0xc3f);if(Object['keys'](_0xb5e2ca['claimedBy'])['length']>=_0xb5e2ca[_0x52917d(0x32f)]){_0xb5e2ca[_0x52917d(0x824)]=!![],_0x44cf30['history']['push']({'role':_0x52917d(0xbaa),'type':_0x52917d(0x81b),'content':_0x503999(_0x44cf30,_0xb5e2ca['senderName'])+_0x52917d(0x6f6),'timestamp':Date[_0x52917d(0x12d6)]()+0x1});let _0x3368c9={'name':'','amount':-0x1};Object[_0x52917d(0xef7)](_0xb5e2ca[_0x52917d(0x12e6)])[_0x52917d(0x12be)](([_0x4580dd,_0x302fdf])=>{const _0x484701=_0x52917d;_0x302fdf>_0x3368c9[_0x484701(0xc5c)]&&(_0x3368c9={'name':_0x4580dd,'amount':_0x302fdf});});if(_0x3368c9[_0x52917d(0x564)]){const _0x2dd27e=_0x503999(_0x44cf30,_0x3368c9['name']);_0x5eebe7+='\x20红包已被领完，手气王是\x20'+_0x2dd27e+'！';}}_0x5eebe7+=_0x52917d(0x5cd),_0x44cf30[_0x52917d(0x7d3)]['push']({'role':_0x52917d(0xbaa),'content':_0x5eebe7,'timestamp':Date[_0x52917d(0x12d6)]()+0x2,'isHidden':!![]});}}_0x56f749=!![];continue;}switch(_0x3a8dd6['type']){case _0x52917d(0xb9e):if(_0x3a8dd6[_0x52917d(0x720)]){const _0x32d191=_0x505390[_0x52917d(0x407)][_0x52917d(0xc0d)](_0x7df633=>_0x7df633[_0x52917d(0x564)]===_0x3a8dd6[_0x52917d(0x720)]);_0x32d191?_0x4c783c={..._0x300a20,'type':_0x52917d(0xb9e),'content':_0x32d191[_0x52917d(0x5f3)],'meaning':_0x32d191[_0x52917d(0x564)]}:(console[_0x52917d(0x139e)](_0x52917d(0x763)+_0x3a8dd6['meaning']+'\x22'),_0x4c783c={..._0x300a20,'type':_0x52917d(0x56d),'content':'[表情:\x20'+_0x3a8dd6['meaning']+']'});}else console[_0x52917d(0x139e)](_0x52917d(0x673),_0x3a8dd6),_0x4c783c={..._0x300a20,'type':_0x52917d(0xb9e),'content':_0x3a8dd6[_0x52917d(0x5f3)],'meaning':_0x52917d(0x735)};break;case _0x52917d(0x239):const _0x556d82={'type':_0x3a8dd6[_0x52917d(0x426)]||_0x52917d(0x395),'content':_0x3a8dd6[_0x52917d(0xac4)],'timestamp':Date['now'](),'authorId':_0x505390[_0x52917d(0x1027)][Object['keys'](_0x505390[_0x52917d(0x1027)])[_0x52917d(0xc0d)](_0x43e137=>_0x505390[_0x52917d(0x1027)][_0x43e137][_0x52917d(0xe2d)]===_0x3a8dd6[_0x52917d(0x564)])]?.['id']||_0x3a8dd6[_0x52917d(0x564)],'authorOriginalName':_0x3a8dd6['name'],'visibleGroupIds':null};await _0xb81d4e[_0x52917d(0xcce)][_0x52917d(0x807)](_0x556d82),_0xa385c3(_0x22cc4e+0x1),_0x209871={'content':'['+_0x554a07+'\x20发布了一条新动态]'};break;case'qzone_comment':const _0x9fdd4e=await _0xb81d4e[_0x52917d(0xcce)][_0x52917d(0x111a)](parseInt(_0x3a8dd6[_0x52917d(0x403)]));if(_0x9fdd4e){if(!_0x9fdd4e[_0x52917d(0xd3c)])_0x9fdd4e['comments']=[];_0x9fdd4e['comments'][_0x52917d(0x1a0)]({'commenterName':_0x3a8dd6['name'],'text':_0x3a8dd6[_0x52917d(0xcca)],'timestamp':Date[_0x52917d(0x12d6)]()}),await _0xb81d4e[_0x52917d(0xcce)]['update'](_0x9fdd4e['id'],{'comments':_0x9fdd4e[_0x52917d(0xd3c)]}),_0xa385c3(_0x22cc4e+0x1),_0x209871={'content':'['+_0x554a07+'\x20评论了动态]'};}break;case _0x52917d(0x308):const _0x18d0ee=await _0xb81d4e[_0x52917d(0xcce)]['get'](parseInt(_0x3a8dd6[_0x52917d(0x403)]));if(_0x18d0ee){if(!_0x18d0ee[_0x52917d(0x12e3)])_0x18d0ee['likes']=[];!_0x18d0ee[_0x52917d(0x12e3)]['includes'](_0x3a8dd6['name'])&&(_0x18d0ee['likes'][_0x52917d(0x1a0)](_0x3a8dd6['name']),await _0xb81d4e[_0x52917d(0xcce)][_0x52917d(0xeb2)](_0x18d0ee['id'],{'likes':_0x18d0ee['likes']}),_0xa385c3(_0x22cc4e+0x1),_0x209871={'content':'['+_0x554a07+_0x52917d(0x12fb)});}break;case _0x52917d(0x135a):_0x4c783c={..._0x300a20,'type':_0x52917d(0x135a),'content':_0x3a8dd6['description'],'image_prompt':msgData[_0x52917d(0xfb2)]};break;default:if(_0x3a8dd6[_0x52917d(0x858)]===_0x52917d(0xb34)){const _0x342eee=typeof _0x3a8dd6[_0x52917d(0x6ed)]==='string'?_0x3a8dd6[_0x52917d(0x6ed)]['split']('\x0a')[_0x52917d(0x85d)](_0x14fc70=>_0x14fc70['trim']()):Array[_0x52917d(0x285)](_0x3a8dd6[_0x52917d(0x6ed)])?_0x3a8dd6['options']:[];if(_0x342eee[_0x52917d(0x990)]<0x2)continue;_0x4c783c={..._0x300a20,..._0x3a8dd6,'options':_0x342eee,'votes':{},'isClosed':![]};}else{const _0x47766a=_0x3a8dd6[_0x52917d(0xac4)]||_0x3a8dd6[_0x52917d(0x757)];_0x4c783c={..._0x300a20,..._0x3a8dd6};if(_0x47766a)_0x4c783c[_0x52917d(0xac4)]=_0x47766a;}break;}if(_0x209871)_0x44cf30[_0x52917d(0x7d3)]['push']({'role':_0x52917d(0xbaa),'type':_0x52917d(0x81b),'content':_0x209871[_0x52917d(0xac4)],'timestamp':_0x121159++});else _0x4c783c&&(_0x44cf30[_0x52917d(0x7d3)]['push'](_0x4c783c),!_0x5e2c6e&&(_0x5e2c6e=_0x554a07,_0x2f589d=_0x4c783c['type']===_0x52917d(0x135a)?'[图片]':_0x4c783c[_0x52917d(0xac4)]||'['+_0x4c783c[_0x52917d(0x858)]+']'));_0x56f749=!![];}_0x56f749&&(_0x44cf30['lastActionTimestamp']=Date[_0x52917d(0x12d6)](),_0x44cf30[_0x52917d(0x1090)]=(_0x44cf30[_0x52917d(0x1090)]||0x0)+_0x9cc701[_0x52917d(0x85d)](_0x3abbad=>_0x3abbad[_0x52917d(0x858)]!==_0x52917d(0x239)&&_0x3abbad['type']!=='qzone_comment'&&_0x3abbad[_0x52917d(0x858)]!=='qzone_like')['length'],_0x5e2c6e&&_0x2f589d&&_0xabb267(_0x28c6a8,_0x5e2c6e+':\x20'+_0x2f589d),await _0xb81d4e[_0x52917d(0x1027)][_0x52917d(0x5d0)](_0x44cf30));}catch(_0x4067a3){console[_0x52917d(0xe3b)](_0x52917d(0xef8)+_0x44cf30[_0x52917d(0x564)]+_0x52917d(0x49c),_0x4067a3);}finally{_0x1b7f69();}}function _0x4156f1(_0x1b8961,_0x2620ba,_0x13f272){const _0x2a7cc8=_0x85c4bf,_0x1c5012=document[_0x2a7cc8(0x479)](_0x13f272);if(!_0x1c5012)return;if(!_0x1b8961||_0x1b8961[_0x2a7cc8(0x9c1)]()===''){_0x1c5012['innerHTML']='';return;}const _0x240044=_0x1b8961['replace'](/\s*\.message-bubble\.user\s+([^{]+\{)/g,_0x2620ba+'\x20.message-bubble.user\x20$1')[_0x2a7cc8(0x491)](/\s*\.message-bubble\.ai\s+([^{]+\{)/g,_0x2620ba+'\x20.message-bubble.ai\x20$1')[_0x2a7cc8(0x491)](/\s*\.message-bubble\s+([^{]+\{)/g,_0x2620ba+'\x20.message-bubble\x20$1');_0x1c5012['innerHTML']=_0x240044;}async function _0x11fab3(){const _0x20394a=_0x85c4bf;if(!_0x505390[_0x20394a(0x233)])return;const _0x3d5e0e=_0x505390['chats'][_0x505390['activeChatId']],_0x95b832=document['getElementById'](_0x20394a(0x6da));if(!_0x95b832)return;const _0x17b308=document[_0x20394a(0x8bc)](_0x20394a(0x8ab))?.[_0x20394a(0x4e0)]||_0x20394a(0x603),_0x3c6678=document['getElementById'](_0x20394a(0xa94))[_0x20394a(0x4e0)],_0x1af2dc=document['getElementById'](_0x20394a(0xbfb))['value'],_0x55dd7f=_0x3d5e0e[_0x20394a(0x18a)][_0x20394a(0x7fb)];_0x95b832['dataset'][_0x20394a(0x1057)]=_0x17b308,_0x95b832[_0x20394a(0x10dd)][_0x20394a(0xc76)]('--chat-font-size',_0x3c6678+'px');_0x55dd7f&&_0x55dd7f[_0x20394a(0x591)](_0x20394a(0x631))?(_0x95b832[_0x20394a(0x10dd)][_0x20394a(0x13b9)]=_0x20394a(0x10d2)+_0x55dd7f+')',_0x95b832[_0x20394a(0x10dd)]['backgroundColor']='transparent'):(_0x95b832[_0x20394a(0x10dd)][_0x20394a(0x13b9)]=_0x20394a(0xff8),_0x95b832[_0x20394a(0x10dd)][_0x20394a(0x7fb)]=_0x55dd7f||'#f0f2f5');_0x95b832[_0x20394a(0x3de)]='';const _0x3fd951={'role':'ai','content':_0x20394a(0x1319),'timestamp':0x1,'senderName':_0x3d5e0e[_0x20394a(0x564)]},_0x302c76=await _0x43c884(_0x3fd951,_0x3d5e0e);if(_0x302c76)_0x95b832['appendChild'](_0x302c76);const _0x293b78={'role':_0x20394a(0x4c5),'content':'我的消息预览','timestamp':0x2},_0x5b00b0=await _0x43c884(_0x293b78,_0x3d5e0e);if(_0x5b00b0)_0x95b832[_0x20394a(0x9f4)](_0x5b00b0);const _0x1fa702=document[_0x20394a(0xbd5)](_0x20394a(0x6c8));_0x1fa702['style'][_0x20394a(0x506)]=_0x20394a(0xee2),_0x1fa702[_0x20394a(0x97b)]=_0x20394a(0x716),_0x95b832[_0x20394a(0x9f4)](_0x1fa702);const _0x51c034=document['getElementById'](_0x20394a(0x7f3))['value'],_0x2b1e1e=document['getElementById'](_0x20394a(0x120e))[_0x20394a(0x4e0)],_0xb75fbe=parseInt(document[_0x20394a(0x479)](_0x20394a(0x2df))[_0x20394a(0x4e0)])||0xa;_0x51c034===_0x20394a(0xb8f)?_0x1fa702[_0x20394a(0x10dd)][_0x20394a(0xb8f)]=_0xb75fbe+'px':_0x1fa702[_0x20394a(0x10dd)][_0x20394a(0xeb7)]=_0xb75fbe+'px';switch(_0x2b1e1e){case'left':_0x1fa702['style']['left']=_0x20394a(0x760);break;case _0x20394a(0xd2d):_0x1fa702[_0x20394a(0x10dd)][_0x20394a(0xd2d)]=_0x20394a(0x760);break;default:_0x1fa702[_0x20394a(0x10dd)][_0x20394a(0x138f)]=_0x20394a(0x3d3),_0x1fa702[_0x20394a(0x10dd)][_0x20394a(0x87a)]='translateX(-50%)';break;}_0x4156f1(_0x1af2dc,'#settings-preview-area','preview-bubble-style');}async function _0x1c5ba1(){const _0x1e3b4f=_0x85c4bf;await _0x347960(),document[_0x1e3b4f(0x479)](_0x1e3b4f(0x557))[_0x1e3b4f(0x9cd)][_0x1e3b4f(0x807)](_0x1e3b4f(0x45a));}async function _0x347960(){const _0x519b25=_0x85c4bf,_0x369320=document[_0x519b25(0x479)]('existing-groups-list'),_0x4728fa=await _0xb81d4e[_0x519b25(0xbce)][_0x519b25(0x4ba)]();_0x369320[_0x519b25(0x3de)]='',_0x4728fa[_0x519b25(0x990)]===0x0&&(_0x369320[_0x519b25(0x3de)]=_0x519b25(0x24a)),_0x4728fa['forEach'](_0x4e1f23=>{const _0x369493=_0x519b25,_0x442f1a=document[_0x369493(0xbd5)](_0x369493(0x6c8));_0x442f1a[_0x369493(0xfd4)]=_0x369493(0x100f),_0x442f1a[_0x369493(0x3de)]=_0x369493(0xbba)+_0x4e1f23['name']+_0x369493(0xb26)+_0x4e1f23['id']+_0x369493(0x13d2),_0x369320[_0x369493(0x9f4)](_0x442f1a);});}async function _0x341d84(){const _0x22a5de=_0x85c4bf,_0x3df2e0=document[_0x22a5de(0x479)](_0x22a5de(0x6d6)),_0x16154b=_0x3df2e0[_0x22a5de(0x4e0)][_0x22a5de(0x9c1)]();if(!_0x16154b){alert(_0x22a5de(0x589));return;}const _0xc55e92=await _0xb81d4e[_0x22a5de(0xbce)][_0x22a5de(0x46f)]('name')[_0x22a5de(0x4a2)](_0x16154b)[_0x22a5de(0x64e)]();if(_0xc55e92){alert(_0x22a5de(0x12fd)+_0x16154b+_0x22a5de(0xc72));return;}await _0xb81d4e[_0x22a5de(0xbce)]['add']({'name':_0x16154b}),_0x3df2e0[_0x22a5de(0x4e0)]='',await _0x347960();}async function _0x34c07a(_0x1cc491){const _0x19f01f=_0x85c4bf,_0xc6fd2e=await _0x1a9e79(_0x19f01f(0x587),'删除分组后，该组内的好友将变为“未分组”。确定要删除吗？',{'confirmButtonClass':_0x19f01f(0x95a)});if(_0xc6fd2e){await _0xb81d4e[_0x19f01f(0xbce)][_0x19f01f(0x1ea)](_0x1cc491);const _0x5a85fa=await _0xb81d4e[_0x19f01f(0x1027)][_0x19f01f(0x46f)](_0x19f01f(0x194))[_0x19f01f(0x4a2)](_0x1cc491)[_0x19f01f(0x4ba)]();for(const _0x13a43d of _0x5a85fa){_0x13a43d['groupId']=null,await _0xb81d4e[_0x19f01f(0x1027)]['put'](_0x13a43d);if(_0x505390[_0x19f01f(0x1027)][_0x13a43d['id']])_0x505390['chats'][_0x13a43d['id']][_0x19f01f(0x194)]=null;}await _0x347960();}}function _0x3b9989(_0x33b289){const _0x173a3c=_0x85c4bf,_0x3713ff=_0x505390[_0x173a3c(0x1027)][_0x505390[_0x173a3c(0x233)]];document[_0x173a3c(0x479)]('publish-to-announcement-btn')[_0x173a3c(0x10dd)][_0x173a3c(0x678)]=_0x3713ff['isGroup']?_0x173a3c(0xee3):_0x173a3c(0xff8);if(_0x4c148b)return;_0x45dd47=_0x33b289,document[_0x173a3c(0x479)](_0x173a3c(0xc51))[_0x173a3c(0x9cd)]['add'](_0x173a3c(0x45a));}function _0x499597(){const _0xf462f3=_0x85c4bf;document[_0xf462f3(0x479)](_0xf462f3(0xc51))[_0xf462f3(0x9cd)][_0xf462f3(0x8b6)](_0xf462f3(0x45a)),_0x45dd47=null;}async function _0x2cc8c7(){const _0x221931=_0x85c4bf;if(!_0x45dd47)return;const _0x7bff9f=_0x45dd47,_0x34e2b8=_0x505390[_0x221931(0x1027)][_0x505390['activeChatId']],_0x2db725=_0x34e2b8[_0x221931(0x7d3)][_0x221931(0xc0d)](_0x521c39=>_0x521c39[_0x221931(0x12a2)]===_0x7bff9f);if(!_0x2db725)return;_0x499597();let _0x338063;const _0x5f500c=_0x2db725[_0x221931(0x858)]&&['voice_message','ai_image',_0x221931(0x5f8),'share_link'][_0x221931(0x44f)](_0x2db725[_0x221931(0x858)]);if(_0x5f500c){let _0x1e92f5={'type':_0x2db725['type']};if(_0x2db725[_0x221931(0x858)]==='voice_message')_0x1e92f5[_0x221931(0xac4)]=_0x2db725[_0x221931(0xac4)];else{if(_0x2db725[_0x221931(0x858)]==='ai_image')_0x1e92f5[_0x221931(0x78b)]=_0x2db725['content'];else{if(_0x2db725[_0x221931(0x858)]===_0x221931(0x5f8))_0x1e92f5['amount']=_0x2db725[_0x221931(0xc5c)],_0x1e92f5[_0x221931(0x926)]=_0x2db725[_0x221931(0x926)];else _0x2db725['type']==='share_link'&&(_0x1e92f5[_0x221931(0xc29)]=_0x2db725[_0x221931(0xc29)],_0x1e92f5['description']=_0x2db725['description'],_0x1e92f5['source_name']=_0x2db725[_0x221931(0x6a3)],_0x1e92f5[_0x221931(0xac4)]=_0x2db725[_0x221931(0xac4)]);}}_0x338063=JSON[_0x221931(0x1308)](_0x1e92f5,null,0x2);}else typeof _0x2db725['content']===_0x221931(0x65a)?_0x338063=JSON['stringify'](_0x2db725[_0x221931(0xac4)],null,0x2):_0x338063=_0x2db725['content'];const _0x4d6bc3={'voice':{'type':_0x221931(0x9bf),'content':_0x221931(0x5cf)},'image':{'type':_0x221931(0x135a),'description':'在这里输入图片描述'},'transfer':{'type':_0x221931(0x5f8),'amount':5.2,'note':_0x221931(0xfb7)},'link':{'type':_0x221931(0x131b),'title':_0x221931(0x84e),'description':'文章摘要...','source_name':'来源网站','content':'文章完整内容...'}},_0x55bf2d=_0x221931(0xc8b)+JSON[_0x221931(0x1308)](_0x4d6bc3[_0x221931(0xc17)])+'\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x221931(0x1308)](_0x4d6bc3['image'])+_0x221931(0x1137)+JSON[_0x221931(0x1308)](_0x4d6bc3[_0x221931(0x5f8)])+_0x221931(0x1152)+JSON['stringify'](_0x4d6bc3[_0x221931(0x784)])+_0x221931(0xc9c),_0x56bc60=await _0x9a2c09(_0x221931(0x39d),_0x221931(0x8c9),_0x338063,'textarea',_0x55bf2d);_0x56bc60!==null&&await _0xe58526(_0x7bff9f,_0x56bc60,!![]);}async function _0x472e40(){const _0x2c01dc=_0x85c4bf;if(!_0x45dd47)return;const _0x5017af=_0x505390[_0x2c01dc(0x1027)][_0x505390[_0x2c01dc(0x233)]],_0x506178=_0x5017af['history'][_0x2c01dc(0xc0d)](_0x5b9e8a=>_0x5b9e8a['timestamp']===_0x45dd47);if(!_0x506178)return;let _0x42c774;typeof _0x506178[_0x2c01dc(0xac4)]==='object'?_0x42c774=JSON[_0x2c01dc(0x1308)](_0x506178[_0x2c01dc(0xac4)]):_0x42c774=String(_0x506178[_0x2c01dc(0xac4)]);try{await navigator[_0x2c01dc(0xd8e)][_0x2c01dc(0x833)](_0x42c774),await _0x1519c8('复制成功',_0x2c01dc(0xc0e));}catch(_0x448452){await _0x1519c8('复制失败','无法访问剪贴板。');}_0x499597();}async function _0x5b37d1(){const _0x385d85=_0x85c4bf;if(!_0x45dd47)return;try{await navigator[_0x385d85(0xd8e)][_0x385d85(0x833)](_0x45dd47),await _0x1519c8(_0x385d85(0x2b1),_0x385d85(0xa9e)+_0x45dd47+'\x20已复制到剪贴板。');}catch(_0x592921){await _0x1519c8(_0x385d85(0x4a9),'无法访问剪贴板。');}_0x499597();}function _0x179dbd(_0x480fa9=''){const _0x1d7342=_0x85c4bf,_0x377200=document[_0x1d7342(0xbd5)]('div');_0x377200[_0x1d7342(0xfd4)]=_0x1d7342(0x1288);const _0x5b9f95={'voice':{'type':_0x1d7342(0x9bf),'content':_0x1d7342(0x5cf)},'image':{'type':'ai_image','description':_0x1d7342(0xcae)},'transfer':{'type':_0x1d7342(0x5f8),'amount':5.2,'note':'一点心意'},'link':{'type':_0x1d7342(0x131b),'title':_0x1d7342(0x84e),'description':_0x1d7342(0x18f),'source_name':_0x1d7342(0x10b9),'content':_0x1d7342(0xb21)},'offline':{'type':'offline_text','content':_0x1d7342(0xc12)},'quote':{'type':'quote_reply','target_timestamp':0x499602d2,'reply_content':_0x1d7342(0x1025)}};return _0x377200[_0x1d7342(0x3de)]=_0x1d7342(0x66f)+_0x480fa9+_0x1d7342(0x137c)+JSON[_0x1d7342(0x1308)](_0x5b9f95['voice'])+'\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON['stringify'](_0x5b9f95['image'])+_0x1d7342(0x1181)+JSON[_0x1d7342(0x1308)](_0x5b9f95[_0x1d7342(0x5f8)])+'\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x1d7342(0x1308)](_0x5b9f95[_0x1d7342(0x784)])+_0x1d7342(0xb8b)+JSON[_0x1d7342(0x1308)](_0x5b9f95['offline'])+_0x1d7342(0x3e9)+JSON['stringify'](_0x5b9f95['quote'])+_0x1d7342(0x1222),_0x377200[_0x1d7342(0x8bc)]('.delete-block-btn')[_0x1d7342(0xa75)]('click',()=>{const _0x1d9701=_0x1d7342;document[_0x1d9701(0x99e)](_0x1d9701(0x4e3))[_0x1d9701(0x990)]>0x1?_0x377200[_0x1d9701(0x8b6)]():alert(_0x1d9701(0x4b8));}),_0x377200['querySelectorAll'](_0x1d7342(0xdb7))[_0x1d7342(0x12be)](_0x172c74=>{const _0x201726=_0x1d7342;_0x172c74[_0x201726(0xa75)](_0x201726(0xd2f),()=>{const _0x46ee83=_0x201726,_0x5d6e27=_0x172c74['dataset'][_0x46ee83(0x346)],_0x23887a=_0x377200[_0x46ee83(0x8bc)](_0x46ee83(0x1283));if(_0x5d6e27&&_0x23887a)try{const _0x459ae7=JSON[_0x46ee83(0x94c)](_0x5d6e27);_0x23887a[_0x46ee83(0x4e0)]=JSON[_0x46ee83(0x1308)](_0x459ae7,null,0x2),_0x23887a[_0x46ee83(0xc07)]();}catch(_0x25a07a){console[_0x46ee83(0xe3b)](_0x46ee83(0x593),_0x25a07a);}});}),_0x377200;}function _0x3e93d8(){const _0x5913ee=_0x85c4bf;if(!_0x45dd47)return;const _0x81e6d6=_0x45dd47,_0x23be76=_0x505390[_0x5913ee(0x1027)][_0x505390[_0x5913ee(0x233)]],_0x4a429a=_0x23be76[_0x5913ee(0x7d3)][_0x5913ee(0xc0d)](_0x10c305=>_0x10c305[_0x5913ee(0x12a2)]===_0x81e6d6);if(!_0x4a429a)return;_0x499597();const _0x362e0e=document[_0x5913ee(0x479)](_0x5913ee(0xd31)),_0x40a8bb=document[_0x5913ee(0x479)](_0x5913ee(0xc36));_0x40a8bb[_0x5913ee(0x3de)]='';let _0x1be5fb;if(_0x4a429a[_0x5913ee(0xb67)]){const _0x47beaa={'type':_0x5913ee(0x47f),'target_timestamp':_0x4a429a['quote'][_0x5913ee(0x12a2)],'reply_content':_0x4a429a[_0x5913ee(0xac4)]};_0x1be5fb=JSON[_0x5913ee(0x1308)](_0x47beaa,null,0x2);}else{if(_0x4a429a[_0x5913ee(0x858)]&&[_0x5913ee(0x9bf),_0x5913ee(0x135a),_0x5913ee(0x5f8),'offline_text',_0x5913ee(0x131b)][_0x5913ee(0x44f)](_0x4a429a['type'])){let _0x1b6483={'type':_0x4a429a[_0x5913ee(0x858)]};if(_0x4a429a[_0x5913ee(0x858)]===_0x5913ee(0x9bf))_0x1b6483[_0x5913ee(0xac4)]=_0x4a429a['content'];else{if(_0x4a429a['type']===_0x5913ee(0x135a))_0x1b6483[_0x5913ee(0x78b)]=_0x4a429a['content'];else{if(_0x4a429a[_0x5913ee(0x858)]===_0x5913ee(0x5f8))_0x1b6483[_0x5913ee(0xc5c)]=_0x4a429a[_0x5913ee(0xc5c)],_0x1b6483[_0x5913ee(0x926)]=_0x4a429a[_0x5913ee(0x926)];else{if(_0x4a429a[_0x5913ee(0x858)]==='offline_text')_0x4a429a[_0x5913ee(0xac4)]?_0x1b6483['content']=_0x4a429a[_0x5913ee(0xac4)]:(_0x1b6483['dialogue']=_0x4a429a[_0x5913ee(0xfba)],_0x1b6483['description']=_0x4a429a[_0x5913ee(0x78b)]);else _0x4a429a['type']===_0x5913ee(0x131b)&&(_0x1b6483[_0x5913ee(0xc29)]=_0x4a429a['title'],_0x1b6483['description']=_0x4a429a[_0x5913ee(0x78b)],_0x1b6483[_0x5913ee(0x6a3)]=_0x4a429a['source_name'],_0x1b6483[_0x5913ee(0xac4)]=_0x4a429a[_0x5913ee(0xac4)]);}}}_0x1be5fb=JSON['stringify'](_0x1b6483,null,0x2);}else typeof _0x4a429a[_0x5913ee(0xac4)]===_0x5913ee(0x65a)?_0x1be5fb=JSON[_0x5913ee(0x1308)](_0x4a429a[_0x5913ee(0xac4)],null,0x2):_0x1be5fb=_0x4a429a[_0x5913ee(0xac4)];}const _0x1ec259=_0x179dbd(_0x1be5fb);_0x40a8bb[_0x5913ee(0x9f4)](_0x1ec259);const _0x259367=document[_0x5913ee(0x479)](_0x5913ee(0xa6c)),_0x33f4c0=_0x259367[_0x5913ee(0xbcf)](!![]);_0x259367['parentNode'][_0x5913ee(0xf0d)](_0x33f4c0,_0x259367),_0x33f4c0[_0x5913ee(0xa75)](_0x5913ee(0xd2f),()=>{const _0x11ebe4=_0x5913ee,_0x250579=_0x179dbd();_0x40a8bb[_0x11ebe4(0x9f4)](_0x250579),_0x250579['querySelector'](_0x11ebe4(0x1283))['focus']();});const _0x4a05fe=document[_0x5913ee(0x479)](_0x5913ee(0xcf7)),_0x33eb9c=_0x4a05fe[_0x5913ee(0xbcf)](!![]);_0x4a05fe[_0x5913ee(0x1134)][_0x5913ee(0xf0d)](_0x33eb9c,_0x4a05fe),_0x33eb9c['addEventListener']('click',()=>{const _0x1e2e33=_0x5913ee;_0x362e0e[_0x1e2e33(0x9cd)][_0x1e2e33(0x8b6)](_0x1e2e33(0x45a));});const _0x2c426a=document[_0x5913ee(0x479)](_0x5913ee(0xf9a)),_0x2ddab=_0x2c426a['cloneNode'](!![]);_0x2c426a[_0x5913ee(0x1134)][_0x5913ee(0xf0d)](_0x2ddab,_0x2c426a),_0x2ddab[_0x5913ee(0xa75)](_0x5913ee(0xd2f),()=>{_0xe58526(_0x81e6d6);}),_0x362e0e[_0x5913ee(0x9cd)][_0x5913ee(0x807)](_0x5913ee(0x45a));}async function _0x472e40(){const _0x5b5549=_0x85c4bf;if(!_0x45dd47)return;const _0x4c38ac=_0x505390[_0x5b5549(0x1027)][_0x505390[_0x5b5549(0x233)]],_0x10f6af=_0x4c38ac[_0x5b5549(0x7d3)]['find'](_0x313921=>_0x313921[_0x5b5549(0x12a2)]===_0x45dd47);if(!_0x10f6af)return;let _0x1493e3;if(_0x10f6af[_0x5b5549(0x858)]===_0x5b5549(0x124e))_0x10f6af[_0x5b5549(0xac4)]?_0x1493e3=_0x10f6af[_0x5b5549(0xac4)]:_0x1493e3='「'+(_0x10f6af['dialogue']||'')+'」\x0a'+(_0x10f6af['description']||'');else typeof _0x10f6af[_0x5b5549(0xac4)]==='object'?_0x1493e3=JSON[_0x5b5549(0x1308)](_0x10f6af['content']):_0x1493e3=String(_0x10f6af[_0x5b5549(0xac4)]);try{await navigator[_0x5b5549(0xd8e)][_0x5b5549(0x833)](_0x1493e3),await _0x1519c8('复制成功','消息内容已复制到剪贴板。');}catch(_0x1da8d2){await _0x1519c8(_0x5b5549(0x4a9),_0x5b5549(0x1185));}_0x499597();}function _0x1f3c6b(_0x5e8e32){const _0x16656c=_0x85c4bf,_0x2bf320=_0x5e8e32['trim']();if(_0x2bf320[_0x16656c(0x591)]('{')&&_0x2bf320[_0x16656c(0x1193)]('}'))try{const _0x3cf666=JSON[_0x16656c(0x94c)](_0x2bf320);if(_0x3cf666[_0x16656c(0x858)])return _0x3cf666;}catch(_0x1b9efc){}if(_0x554a0b[_0x16656c(0x101d)](_0x2bf320))return{'type':'sticker','content':_0x2bf320};return{'type':'text','content':_0x2bf320};}async function _0xe58526(_0x183ade,_0x33f48f=null){const _0x4c5f62=_0x85c4bf;if(!_0x183ade)return;const _0x4f23c0=_0x505390[_0x4c5f62(0x1027)][_0x505390[_0x4c5f62(0x233)]],_0x80091d=_0x4f23c0[_0x4c5f62(0x7d3)]['findIndex'](_0x2478fb=>_0x2478fb['timestamp']===_0x183ade);if(_0x80091d===-0x1)return;const _0x3f229a=_0x4f23c0[_0x4c5f62(0x7d3)][_0x80091d];let _0x307676=[];const _0x1f92f7=_0x33f48f!==null?[_0x33f48f]:Array['from'](document['querySelectorAll'](_0x4c5f62(0x1277)))[_0x4c5f62(0x2e1)](_0x146ad6=>_0x146ad6[_0x4c5f62(0x4e0)]);for(const _0xe0bffc of _0x1f92f7){if(!_0xe0bffc[_0x4c5f62(0x9c1)]())continue;const _0x517c7f=_0x1f3c6b(_0xe0bffc[_0x4c5f62(0x9c1)]()),_0x47516c={'role':_0x3f229a['role'],'senderName':_0x3f229a[_0x4c5f62(0xdcc)],'timestamp':_0x3f229a[_0x4c5f62(0x12a2)]};switch(_0x517c7f[_0x4c5f62(0x858)]){case'text':_0x47516c['type']='text',_0x47516c[_0x4c5f62(0xac4)]=_0x517c7f['content'];break;case _0x4c5f62(0x124e):_0x47516c['type']=_0x4c5f62(0x124e);_0x517c7f['content']?_0x47516c[_0x4c5f62(0xac4)]=_0x517c7f[_0x4c5f62(0xac4)]:(_0x47516c[_0x4c5f62(0xfba)]=_0x517c7f['dialogue'],_0x47516c[_0x4c5f62(0x78b)]=_0x517c7f[_0x4c5f62(0x78b)]);break;case _0x4c5f62(0x47f):_0x47516c['type']=_0x4c5f62(0x47f),_0x47516c[_0x4c5f62(0xac4)]=_0x517c7f[_0x4c5f62(0x12f0)];const _0x128e70=_0x4f23c0['history'][_0x4c5f62(0xc0d)](_0x238008=>_0x238008[_0x4c5f62(0x12a2)]===_0x517c7f[_0x4c5f62(0xe51)]);if(_0x128e70){let _0xcd4150=_0x128e70[_0x4c5f62(0xdcc)];_0x128e70['role']===_0x4c5f62(0x4c5)&&(_0xcd4150=_0x505390[_0x4c5f62(0x1190)]['nickname']||_0x4c5f62(0x80e)),_0x47516c['quote']={'timestamp':_0x517c7f[_0x4c5f62(0xe51)],'senderName':_0xcd4150,'content':String(_0x128e70[_0x4c5f62(0xac4)]||'')};}else _0x47516c[_0x4c5f62(0xb67)]={'timestamp':_0x517c7f[_0x4c5f62(0xe51)],'senderName':'未知用户','content':'原始消息已删除或不存在'};break;case _0x4c5f62(0x9bf):case _0x4c5f62(0x135a):case _0x4c5f62(0x5d5):_0x47516c['type']=_0x517c7f[_0x4c5f62(0x858)],_0x47516c['content']=_0x517c7f[_0x4c5f62(0xac4)]||_0x517c7f[_0x4c5f62(0x78b)];if(_0x517c7f['meaning'])_0x47516c[_0x4c5f62(0x720)]=_0x517c7f[_0x4c5f62(0x720)];break;case _0x4c5f62(0xb9e):{_0x47516c[_0x4c5f62(0x858)]=_0x4c5f62(0xb9e);let _0x44887d=![];if(_0x517c7f[_0x4c5f62(0x720)]){const _0x3d098c=_0x505390[_0x4c5f62(0x407)][_0x4c5f62(0xc0d)](_0x397d1e=>_0x397d1e[_0x4c5f62(0x564)]===_0x517c7f[_0x4c5f62(0x720)]);_0x3d098c?(_0x47516c[_0x4c5f62(0xac4)]=_0x3d098c['url'],_0x47516c[_0x4c5f62(0x720)]=_0x3d098c[_0x4c5f62(0x564)],console[_0x4c5f62(0x90f)]('导演/编辑模式保存(Sticker):\x20使用了\x20meaning\x20查找'),_0x44887d=!![]):(_0x47516c[_0x4c5f62(0x858)]=_0x4c5f62(0x56d),_0x47516c[_0x4c5f62(0xac4)]='[表情:\x20'+_0x517c7f[_0x4c5f62(0x720)]+']',console[_0x4c5f62(0x139e)](_0x4c5f62(0x10b2),_0x517c7f[_0x4c5f62(0x720)]),_0x44887d=!![]);}if(!_0x44887d&&_0x517c7f[_0x4c5f62(0x5f3)]){_0x47516c[_0x4c5f62(0xac4)]=_0x517c7f['url'];const _0x131b2a=_0x505390['userStickers']['find'](_0x19d778=>_0x19d778[_0x4c5f62(0x5f3)]===_0x517c7f[_0x4c5f62(0x5f3)]);if(_0x517c7f[_0x4c5f62(0x720)]&&(!_0x131b2a||_0x131b2a[_0x4c5f62(0x564)]===_0x517c7f['meaning']))_0x47516c[_0x4c5f62(0x720)]=_0x517c7f[_0x4c5f62(0x720)];else _0x131b2a?_0x47516c[_0x4c5f62(0x720)]=_0x131b2a[_0x4c5f62(0x564)]:_0x47516c['meaning']=_0x4c5f62(0x735);console[_0x4c5f62(0x90f)](_0x4c5f62(0x12cb),_0x47516c[_0x4c5f62(0x720)]),_0x44887d=!![];}if(!_0x44887d&&_0x517c7f[_0x4c5f62(0xac4)]&&typeof _0x517c7f[_0x4c5f62(0xac4)]===_0x4c5f62(0x8d9)&&_0x554a0b[_0x4c5f62(0x101d)](_0x517c7f[_0x4c5f62(0xac4)])){_0x47516c['content']=_0x517c7f[_0x4c5f62(0xac4)];const _0x929060=_0x505390['userStickers'][_0x4c5f62(0xc0d)](_0x39fc39=>_0x39fc39[_0x4c5f62(0x5f3)]===_0x517c7f[_0x4c5f62(0xac4)]);_0x47516c[_0x4c5f62(0x720)]=_0x929060?_0x929060[_0x4c5f62(0x564)]:_0x4c5f62(0x735),console['log'](_0x4c5f62(0x10ee),_0x47516c[_0x4c5f62(0x720)]),_0x44887d=!![];}if(!_0x44887d){console[_0x4c5f62(0xe3b)](_0x4c5f62(0x8f0),_0x517c7f);continue;}break;}case _0x4c5f62(0x5f8):_0x47516c['type']=_0x4c5f62(0x5f8),_0x47516c[_0x4c5f62(0xc5c)]=_0x517c7f[_0x4c5f62(0xc5c)],_0x47516c['note']=_0x517c7f[_0x4c5f62(0x926)];break;case _0x4c5f62(0x131b):_0x47516c[_0x4c5f62(0x858)]=_0x4c5f62(0x131b),_0x47516c['title']=_0x517c7f['title'],_0x47516c[_0x4c5f62(0x78b)]=_0x517c7f[_0x4c5f62(0x78b)],_0x47516c[_0x4c5f62(0x6a3)]=_0x517c7f[_0x4c5f62(0x6a3)],_0x47516c[_0x4c5f62(0xac4)]=_0x517c7f[_0x4c5f62(0xac4)];break;default:Object[_0x4c5f62(0x13ee)](_0x47516c,_0x517c7f);break;}_0x307676[_0x4c5f62(0x1a0)](_0x47516c);}if(_0x307676[_0x4c5f62(0x990)]===0x0){document[_0x4c5f62(0x479)](_0x4c5f62(0xd31))['classList'][_0x4c5f62(0x8b6)](_0x4c5f62(0x45a));return;}_0x4f23c0[_0x4c5f62(0x7d3)][_0x4c5f62(0x118e)](_0x80091d,0x1,..._0x307676);let _0x28a14c=_0x183ade;for(let _0x1c5d3b=_0x80091d;_0x1c5d3b<_0x4f23c0[_0x4c5f62(0x7d3)][_0x4c5f62(0x990)];_0x1c5d3b++){_0x4f23c0[_0x4c5f62(0x7d3)][_0x1c5d3b][_0x4c5f62(0x12a2)]=_0x28a14c,_0x28a14c++;}await _0xb81d4e[_0x4c5f62(0x1027)]['put'](_0x4f23c0),document[_0x4c5f62(0x479)](_0x4c5f62(0xd31))[_0x4c5f62(0x9cd)][_0x4c5f62(0x8b6)]('visible'),_0x474d6b(_0x505390[_0x4c5f62(0x233)]),await _0x1519c8('成功',_0x4c5f62(0x1037));}function _0x5360ea(_0x148c13){const _0x1a4ea8=_0x85c4bf;_0x2236ff=_0x148c13,document[_0x1a4ea8(0x479)](_0x1a4ea8(0xf2a))[_0x1a4ea8(0x9cd)][_0x1a4ea8(0x807)](_0x1a4ea8(0x45a));}function _0xe7d7f5(){const _0x3350ac=_0x85c4bf;document[_0x3350ac(0x479)](_0x3350ac(0xf2a))[_0x3350ac(0x9cd)]['remove'](_0x3350ac(0x45a)),_0x2236ff=null;}async function _0x4bfd06(){const _0x47c08e=_0x85c4bf;if(!_0x2236ff)return;const _0x244ff=_0x2236ff,_0x330a2a=await _0xb81d4e[_0x47c08e(0xcce)][_0x47c08e(0x111a)](_0x244ff);if(!_0x330a2a)return;_0xe7d7f5();let _0x37d833;if(_0x330a2a[_0x47c08e(0x858)]==='shuoshuo')_0x37d833=_0x330a2a[_0x47c08e(0xac4)];else{const _0x3825ae={'type':_0x330a2a[_0x47c08e(0x858)],'publicText':_0x330a2a[_0x47c08e(0x105a)]||''};if(_0x330a2a[_0x47c08e(0x858)]===_0x47c08e(0x133a))_0x3825ae[_0x47c08e(0xa09)]=_0x330a2a[_0x47c08e(0xa09)],_0x3825ae['imageDescription']=_0x330a2a[_0x47c08e(0x11a4)];else _0x330a2a[_0x47c08e(0x858)]===_0x47c08e(0xd84)&&(_0x3825ae['hiddenContent']=_0x330a2a['hiddenContent']);_0x37d833=JSON['stringify'](_0x3825ae,null,0x2);}const _0x24aa17={'shuoshuo':_0x47c08e(0x6a0),'image':{'type':_0x47c08e(0x133a),'publicText':'','imageUrl':'https://...','imageDescription':''},'text_image':{'type':_0x47c08e(0xd84),'publicText':'','hiddenContent':''}},_0x1d1717=_0x47c08e(0xe13)+JSON[_0x47c08e(0x1308)](_0x24aa17[_0x47c08e(0x676)])+_0x47c08e(0x1284)+JSON[_0x47c08e(0x1308)](_0x24aa17[_0x47c08e(0xd84)])+_0x47c08e(0x1c7),_0x5ec260=await _0x9a2c09('编辑动态',_0x47c08e(0x11ac),_0x37d833,_0x47c08e(0x1283),_0x1d1717);setTimeout(()=>{const _0x4c9539=_0x47c08e,_0x4dfea8=document[_0x4c9539(0x8bc)](_0x4c9539(0x8a4));_0x4dfea8&&_0x4dfea8[_0x4c9539(0xa75)](_0x4c9539(0xd2f),()=>{const _0x282689=_0x4c9539,_0x2b3653=document[_0x282689(0x479)](_0x282689(0x754));_0x2b3653[_0x282689(0x4e0)]=_0x24aa17[_0x282689(0x395)],_0x2b3653[_0x282689(0xc07)]();});},0x64),_0x5ec260!==null&&await _0x3c07ee(_0x244ff,_0x5ec260);}async function _0x3c07ee(_0x1f2001,_0x50dfe4){const _0x3a3bdb=_0x85c4bf,_0x444a75=await _0xb81d4e[_0x3a3bdb(0xcce)][_0x3a3bdb(0x111a)](_0x1f2001);if(!_0x444a75)return;const _0x1a62eb=_0x50dfe4[_0x3a3bdb(0x9c1)]();try{const _0x2e3bc1=JSON[_0x3a3bdb(0x94c)](_0x1a62eb);_0x444a75[_0x3a3bdb(0x858)]=_0x2e3bc1['type']||'image_post',_0x444a75['publicText']=_0x2e3bc1[_0x3a3bdb(0x105a)]||'',_0x444a75[_0x3a3bdb(0xa09)]=_0x2e3bc1['imageUrl']||'',_0x444a75['imageDescription']=_0x2e3bc1[_0x3a3bdb(0x11a4)]||'',_0x444a75[_0x3a3bdb(0x112d)]=_0x2e3bc1[_0x3a3bdb(0x112d)]||'',_0x444a75[_0x3a3bdb(0xac4)]='';}catch(_0x583682){_0x444a75['type']=_0x3a3bdb(0x395),_0x444a75[_0x3a3bdb(0xac4)]=_0x1a62eb,_0x444a75[_0x3a3bdb(0x105a)]='',_0x444a75['imageUrl']='',_0x444a75[_0x3a3bdb(0x11a4)]='',_0x444a75[_0x3a3bdb(0x112d)]='';}await _0xb81d4e[_0x3a3bdb(0xcce)][_0x3a3bdb(0x5d0)](_0x444a75),await _0x2eb20b(),await _0x1519c8('成功',_0x3a3bdb(0xec3));}async function _0x214669(){const _0x3865a5=_0x85c4bf;if(!_0x2236ff)return;const _0x438f87=await _0xb81d4e[_0x3865a5(0xcce)][_0x3865a5(0x111a)](_0x2236ff);if(!_0x438f87)return;let _0x2cf768=_0x438f87[_0x3865a5(0xac4)]||_0x438f87['publicText']||_0x438f87[_0x3865a5(0x112d)]||_0x438f87[_0x3865a5(0x11a4)]||_0x3865a5(0x7a2);try{await navigator[_0x3865a5(0xd8e)][_0x3865a5(0x833)](_0x2cf768),await _0x1519c8(_0x3865a5(0x2b1),_0x3865a5(0xc52));}catch(_0x96f8d1){await _0x1519c8(_0x3865a5(0x4a9),_0x3865a5(0x1185));}_0xe7d7f5();}let _0x15ec27=new Set();async function _0x5d8903(){const _0x2bf237=_0x85c4bf,_0x5f556f=await _0x5adb5e(_0x2bf237(0x52b),[{'text':_0x2bf237(0x6b1),'value':_0x2bf237(0x1148)},{'text':'创建旁观群聊\x20(我围观)','value':_0x2bf237(0xf07)}]);if(_0x5f556f===_0x2bf237(0x1148)){_0x15ec27[_0x2bf237(0xf8f)]();const _0x5ed021=document[_0x2bf237(0x479)]('confirm-contact-picker-btn'),_0x56f56a=_0x5ed021[_0x2bf237(0xbcf)](!![]);_0x5ed021[_0x2bf237(0x1134)][_0x2bf237(0xf0d)](_0x56f56a,_0x5ed021),_0x56f56a[_0x2bf237(0xa75)](_0x2bf237(0xd2f),_0x64af0a),await _0x15f210(),_0x731d5(_0x2bf237(0x461));}else _0x5f556f===_0x2bf237(0xf07)&&_0x58e4d7();}async function _0x58e4d7(){const _0x41ea5e=_0x85c4bf;_0x15ec27[_0x41ea5e(0xf8f)]();const _0x144a5e=document[_0x41ea5e(0x479)]('confirm-contact-picker-btn'),_0x364f0d=_0x144a5e[_0x41ea5e(0xbcf)](!![]);_0x144a5e[_0x41ea5e(0x1134)][_0x41ea5e(0xf0d)](_0x364f0d,_0x144a5e),_0x364f0d[_0x41ea5e(0xa75)](_0x41ea5e(0xd2f),_0x1b1d91),await _0x3b215f(),_0x731d5('contact-picker-screen');}async function _0x3b215f(){const _0x3ec876=_0x85c4bf,_0x4f01c3=document[_0x3ec876(0x479)]('contact-picker-list');_0x4f01c3['innerHTML']='';const _0x11c275=Object[_0x3ec876(0x3d5)](_0x505390[_0x3ec876(0x1027)])[_0x3ec876(0x85d)](_0x480cc9=>!_0x480cc9['isGroup']),_0x37827a=await _0xb81d4e[_0x3ec876(0x482)][_0x3ec876(0x4ba)]();if(_0x11c275[_0x3ec876(0x990)]===0x0&&_0x37827a[_0x3ec876(0x990)]===0x0){_0x4f01c3[_0x3ec876(0x3de)]=_0x3ec876(0xe1d);return;}_0x11c275[_0x3ec876(0x12be)](_0x260715=>{const _0x245885=_0x3ec876,_0x4c2397=document[_0x245885(0xbd5)]('div');_0x4c2397['className']=_0x245885(0xf47),_0x4c2397['dataset'][_0x245885(0x33a)]=_0x260715['id'],_0x4c2397[_0x245885(0x3de)]=_0x245885(0x7c2)+(_0x260715['settings']['aiAvatar']||_0x28c106)+_0x245885(0xbd8)+_0x260715['name']+_0x245885(0xb4a),_0x4f01c3[_0x245885(0x9f4)](_0x4c2397);}),_0x37827a['forEach'](_0x4e528a=>{const _0x88f75a=_0x3ec876,_0x4541f9=document[_0x88f75a(0xbd5)](_0x88f75a(0x6c8));_0x4541f9[_0x88f75a(0xfd4)]='contact-picker-item',_0x4541f9['dataset'][_0x88f75a(0x33a)]=_0x4e528a['id'],_0x4541f9['dataset'][_0x88f75a(0x95f)]=_0x88f75a(0x892),_0x4541f9[_0x88f75a(0x3de)]=_0x88f75a(0x7c2)+(_0x4e528a[_0x88f75a(0x799)]||_0x3ea4df)+_0x88f75a(0xbd8)+_0x4e528a[_0x88f75a(0x564)]+_0x88f75a(0x522),_0x4f01c3[_0x88f75a(0x9f4)](_0x4541f9);}),_0x3af29a();}async function _0x1b1d91(){const _0x35b17c=_0x85c4bf;if(_0x15ec27[_0x35b17c(0xa7a)]<0x2){alert(_0x35b17c(0xb28));return;}const _0x30061c=await _0x9a2c09('设置群名',_0x35b17c(0x81c),_0x35b17c(0x34c));if(!_0x30061c||!_0x30061c['trim']())return;const _0x6df6b1='group_'+Date[_0x35b17c(0x12d6)](),_0x2633d7=[],_0xdedfd6=await _0xb81d4e['npcs'][_0x35b17c(0x4ba)]();for(const _0x49096c of _0x15ec27){const _0x43b12f=document[_0x35b17c(0x8bc)](_0x35b17c(0x8ea)+_0x49096c+'\x22]')[_0x35b17c(0x13d4)][_0x35b17c(0x95f)]===_0x35b17c(0x892);if(_0x43b12f){const _0x2573c9=_0xdedfd6[_0x35b17c(0xc0d)](_0x5ee22f=>_0x5ee22f['id']===parseInt(_0x49096c));_0x2573c9&&_0x2633d7[_0x35b17c(0x1a0)]({'id':'npc_'+_0x2573c9['id'],'originalName':_0x2573c9['name'],'groupNickname':_0x2573c9[_0x35b17c(0x564)],'persona':_0x2573c9[_0x35b17c(0x596)],'avatar':_0x2573c9[_0x35b17c(0x799)]||_0x3ea4df,'isNpc':!![]});}else{const _0x5e7c1c=_0x505390[_0x35b17c(0x1027)][_0x49096c];_0x5e7c1c&&_0x2633d7[_0x35b17c(0x1a0)]({'id':_0x49096c,'originalName':_0x5e7c1c[_0x35b17c(0xe2d)],'groupNickname':_0x5e7c1c[_0x35b17c(0x564)],'persona':_0x5e7c1c['settings'][_0x35b17c(0x11f6)],'avatar':_0x5e7c1c[_0x35b17c(0x18a)][_0x35b17c(0x1039)]||_0x28c106,'isNpc':![]});}}const _0x4cad98={'id':_0x6df6b1,'name':_0x30061c[_0x35b17c(0x9c1)](),'isGroup':!![],'isSpectatorGroup':!![],'members':_0x2633d7,'settings':{'maxMemory':0xa,'groupAvatar':_0x3b1eb7,'background':'','theme':_0x35b17c(0x603),'fontSize':0xd,'customCss':'','linkedWorldBookIds':[]},'history':[{'role':'system','content':_0x35b17c(0x7ea),'timestamp':Date[_0x35b17c(0x12d6)](),'isHidden':!![]}],'musicData':{'totalTime':0x0}};_0x505390['chats'][_0x6df6b1]=_0x4cad98,await _0xb81d4e[_0x35b17c(0x1027)][_0x35b17c(0x5d0)](_0x4cad98),await _0x1b7f69(),_0x731d5('chat-list-screen'),_0x178862(_0x6df6b1);}async function _0x15f210(){const _0x22b0cc=_0x85c4bf,_0x47f804=document['getElementById'](_0x22b0cc(0x1163));_0x47f804[_0x22b0cc(0x3de)]='';const _0x297553=Object['values'](_0x505390['chats'])['filter'](_0x54b85f=>!_0x54b85f['isGroup']),_0xad027e=await _0xb81d4e[_0x22b0cc(0x482)][_0x22b0cc(0x4ba)]();if(_0x297553['length']===0x0&&_0xad027e[_0x22b0cc(0x990)]===0x0){_0x47f804[_0x22b0cc(0x3de)]=_0x22b0cc(0xdd6);return;}_0x297553[_0x22b0cc(0x12be)](_0xbaa60f=>{const _0x123de4=_0x22b0cc,_0x2235fb=document[_0x123de4(0xbd5)](_0x123de4(0x6c8));_0x2235fb[_0x123de4(0xfd4)]='contact-picker-item',_0x2235fb['dataset'][_0x123de4(0x33a)]=_0xbaa60f['id'],_0x2235fb[_0x123de4(0x3de)]=_0x123de4(0x7c2)+(_0xbaa60f['settings']['aiAvatar']||_0x28c106)+_0x123de4(0xbd8)+_0xbaa60f[_0x123de4(0x564)]+_0x123de4(0xb4a),_0x47f804[_0x123de4(0x9f4)](_0x2235fb);}),_0xad027e[_0x22b0cc(0x12be)](_0x504501=>{const _0x2b5676=_0x22b0cc,_0x419fe7=document[_0x2b5676(0xbd5)](_0x2b5676(0x6c8));_0x419fe7[_0x2b5676(0xfd4)]=_0x2b5676(0xf47),_0x419fe7[_0x2b5676(0x13d4)][_0x2b5676(0x33a)]=_0x2b5676(0xca5)+_0x504501['id'],_0x419fe7[_0x2b5676(0x3de)]=_0x2b5676(0x7c2)+(_0x504501[_0x2b5676(0x799)]||_0x3ea4df)+_0x2b5676(0xbd8)+_0x504501[_0x2b5676(0x564)]+'\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x47f804[_0x2b5676(0x9f4)](_0x419fe7);}),_0x3af29a();}function _0x3af29a(){const _0x3f8f8b=_0x85c4bf,_0x43f3cb=document[_0x3f8f8b(0x479)](_0x3f8f8b(0x5c5));_0x43f3cb[_0x3f8f8b(0x97b)]=_0x3f8f8b(0xad4)+_0x15ec27[_0x3f8f8b(0xa7a)]+')',_0x43f3cb[_0x3f8f8b(0xfce)]=_0x15ec27[_0x3f8f8b(0xa7a)]<0x2;}async function _0x64af0a(){const _0x1ad212=_0x85c4bf;if(_0x15ec27[_0x1ad212(0xa7a)]<0x2){alert(_0x1ad212(0x1299));return;}const _0x4412a1=await _0x9a2c09(_0x1ad212(0x569),_0x1ad212(0x81c),_0x1ad212(0x132b));if(!_0x4412a1||!_0x4412a1['trim']())return;const _0x24efd1=_0x1ad212(0x31b)+Date[_0x1ad212(0x12d6)](),_0x5ef8c6=[],_0x49fec4=await _0xb81d4e[_0x1ad212(0x482)][_0x1ad212(0x4ba)]();for(const _0x3daeb3 of _0x15ec27){if(_0x3daeb3[_0x1ad212(0x591)]('npc_')){const _0x2273ca=parseInt(_0x3daeb3[_0x1ad212(0x491)](_0x1ad212(0xca5),'')),_0x697980=_0x49fec4[_0x1ad212(0xc0d)](_0x31db8e=>_0x31db8e['id']===_0x2273ca);_0x697980&&_0x5ef8c6[_0x1ad212(0x1a0)]({'id':_0x3daeb3,'originalName':_0x697980[_0x1ad212(0x564)],'groupNickname':_0x697980[_0x1ad212(0x564)],'persona':_0x697980[_0x1ad212(0x596)],'avatar':_0x697980[_0x1ad212(0x799)]||_0x3ea4df,'isNpc':!![]});}else{const _0x45a93d=_0x505390[_0x1ad212(0x1027)][_0x3daeb3];_0x45a93d&&_0x5ef8c6[_0x1ad212(0x1a0)]({'id':_0x3daeb3,'originalName':_0x45a93d[_0x1ad212(0xe2d)],'groupNickname':_0x45a93d[_0x1ad212(0x564)],'persona':_0x45a93d[_0x1ad212(0x18a)][_0x1ad212(0x11f6)],'avatar':_0x45a93d[_0x1ad212(0x18a)][_0x1ad212(0x1039)]||_0x28c106,'isNpc':![]});}}const _0xc59248={'id':_0x24efd1,'name':_0x4412a1['trim'](),'isGroup':!![],'members':_0x5ef8c6,'settings':{'myPersona':_0x1ad212(0x13ae),'myNickname':'我','maxMemory':0xa,'groupAvatar':_0x3b1eb7,'myAvatar':_0x2361d7,'background':'','theme':'default','fontSize':0xd,'customCss':'','linkedWorldBookIds':[]},'history':[],'musicData':{'totalTime':0x0}};_0x505390['chats'][_0x24efd1]=_0xc59248,await _0xb81d4e[_0x1ad212(0x1027)][_0x1ad212(0x5d0)](_0xc59248),await _0x1b7f69(),_0x731d5(_0x1ad212(0xe34)),_0x178862(_0x24efd1);}function _0xc43f8(){const _0x1590f3=_0x85c4bf;if(!_0x505390[_0x1590f3(0x233)]||!_0x505390[_0x1590f3(0x1027)][_0x505390[_0x1590f3(0x233)]][_0x1590f3(0x9d7)])return;_0x2e2652(),_0x731d5(_0x1590f3(0xf54));}function _0x2e2652(){const _0x3dad6=_0x85c4bf,_0x2f6e04=document['getElementById']('member-management-list'),_0x41d20d=_0x505390[_0x3dad6(0x1027)][_0x505390[_0x3dad6(0x233)]];_0x2f6e04[_0x3dad6(0x3de)]='',_0x41d20d['members'][_0x3dad6(0x12be)](_0x571061=>{const _0xa312e0=_0x3dad6,_0x36a514=document[_0xa312e0(0xbd5)]('div');_0x36a514[_0xa312e0(0xfd4)]=_0xa312e0(0x1128),_0x36a514[_0xa312e0(0x3de)]=_0xa312e0(0x18c)+_0x571061[_0xa312e0(0x799)]+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x571061[_0xa312e0(0xa54)]+_0xa312e0(0x33c)+_0x571061['id']+_0xa312e0(0x11e9),_0x2f6e04[_0xa312e0(0x9f4)](_0x36a514);});}async function _0x42b81f(_0x4beebb){const _0x5d66b6=_0x85c4bf,_0x5c6da9=_0x505390[_0x5d66b6(0x1027)][_0x505390[_0x5d66b6(0x233)]],_0x18909e=_0x5c6da9[_0x5d66b6(0x954)]['findIndex'](_0x1757d3=>_0x1757d3['id']===_0x4beebb);if(_0x18909e===-0x1)return;if(_0x5c6da9['members']['length']<=0x2){alert(_0x5d66b6(0x5dd));return;}const _0x4d3b6f=_0x5c6da9['members'][_0x18909e][_0x5d66b6(0xa54)],_0x418051=await _0x1a9e79(_0x5d66b6(0x51d),_0x5d66b6(0x96a)+_0x4d3b6f+'”移出群聊吗？',{'confirmButtonClass':'btn-danger'});_0x418051&&(_0x5c6da9[_0x5d66b6(0x954)][_0x5d66b6(0x118e)](_0x18909e,0x1),await _0xb81d4e[_0x5d66b6(0x1027)][_0x5d66b6(0x5d0)](_0x5c6da9),_0x2e2652(),document[_0x5d66b6(0x479)](_0x5d66b6(0x2a4))[_0x5d66b6(0xd2f)]());}async function _0x53cac1(){const _0x48b698=_0x85c4bf,_0x546460=document[_0x48b698(0x479)](_0x48b698(0x5c5)),_0x10d03c=_0x546460[_0x48b698(0xbcf)](!![]);_0x546460[_0x48b698(0x1134)][_0x48b698(0xf0d)](_0x10d03c,_0x546460),_0x10d03c[_0x48b698(0xa75)]('click',_0x25c6a4),await _0x6855b0(),_0x731d5(_0x48b698(0x461));}async function _0x6855b0(){const _0x539862=_0x85c4bf,_0x593e7e=document[_0x539862(0x479)](_0x539862(0x1163));_0x593e7e[_0x539862(0x3de)]='',_0x15ec27['clear']();const _0x467350=_0x505390[_0x539862(0x1027)][_0x505390[_0x539862(0x233)]],_0x95288a=new Set(_0x467350[_0x539862(0x954)][_0x539862(0x2e1)](_0x31c40c=>_0x31c40c['id'])),_0x12ee5c=Object[_0x539862(0x3d5)](_0x505390['chats'])[_0x539862(0x85d)](_0x198e1d=>!_0x198e1d[_0x539862(0x9d7)]&&!_0x95288a['has'](_0x198e1d['id'])),_0x2ad584=(await _0xb81d4e[_0x539862(0x482)][_0x539862(0x4ba)]())['filter'](_0x7620a4=>!_0x95288a[_0x539862(0x391)](_0x539862(0xca5)+_0x7620a4['id']));_0x12ee5c[_0x539862(0x990)]===0x0&&_0x2ad584[_0x539862(0x990)]===0x0?(_0x593e7e['innerHTML']='<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>没有更多可以邀请的联系人了。</p>',document[_0x539862(0x479)](_0x539862(0x5c5))[_0x539862(0x10dd)][_0x539862(0x678)]=_0x539862(0xff8)):(document[_0x539862(0x479)](_0x539862(0x5c5))[_0x539862(0x10dd)]['display']='block',_0x12ee5c[_0x539862(0x12be)](_0x402b7a=>{const _0x2342db=_0x539862,_0x3761e9=document['createElement']('div');_0x3761e9['className']='contact-picker-item',_0x3761e9[_0x2342db(0x13d4)][_0x2342db(0x33a)]=_0x402b7a['id'],_0x3761e9[_0x2342db(0x13d4)][_0x2342db(0x1108)]=_0x2342db(0x390),_0x3761e9[_0x2342db(0x3de)]=_0x2342db(0xf24)+(_0x402b7a[_0x2342db(0x18a)][_0x2342db(0x1039)]||_0x28c106)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x402b7a[_0x2342db(0x564)]+_0x2342db(0xc38),_0x593e7e[_0x2342db(0x9f4)](_0x3761e9);}),_0x2ad584[_0x539862(0x12be)](_0x207fe2=>{const _0x5ee637=_0x539862,_0x33e996=document[_0x5ee637(0xbd5)](_0x5ee637(0x6c8));_0x33e996['className']=_0x5ee637(0xf47),_0x33e996['dataset'][_0x5ee637(0x33a)]=_0x5ee637(0xca5)+_0x207fe2['id'],_0x33e996[_0x5ee637(0x13d4)]['contactType']=_0x5ee637(0x71b),_0x33e996['dataset']['npcId']=_0x207fe2['id'],_0x33e996[_0x5ee637(0x3de)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x207fe2[_0x5ee637(0x799)]||_0x3ea4df)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x207fe2['name']+_0x5ee637(0xaec),_0x593e7e[_0x5ee637(0x9f4)](_0x33e996);})),_0x3af29a();}async function _0x25c6a4(){const _0x590a1b=_0x85c4bf;if(_0x15ec27[_0x590a1b(0xa7a)]===0x0){alert(_0x590a1b(0x637));return;}const _0x208a0a=_0x505390['chats'][_0x505390[_0x590a1b(0x233)]],_0x32877d=await _0xb81d4e[_0x590a1b(0x482)][_0x590a1b(0x4ba)]();for(const _0x31d746 of _0x15ec27){const _0x2df52a=document[_0x590a1b(0x8bc)]('.contact-picker-item[data-contact-id=\x22'+_0x31d746+'\x22]');if(!_0x2df52a)continue;const _0xb02d86=_0x2df52a[_0x590a1b(0x13d4)][_0x590a1b(0x1108)];if(_0xb02d86==='character'){const _0x266788=_0x505390[_0x590a1b(0x1027)][_0x31d746];_0x266788&&_0x208a0a[_0x590a1b(0x954)][_0x590a1b(0x1a0)]({'id':_0x31d746,'originalName':_0x266788[_0x590a1b(0xe2d)],'groupNickname':_0x266788['name'],'persona':_0x266788[_0x590a1b(0x18a)]['aiPersona'],'avatar':_0x266788[_0x590a1b(0x18a)][_0x590a1b(0x1039)]||_0x28c106,'isNpc':![]});}else{if(_0xb02d86==='npc'){const _0x9ac695=parseInt(_0x2df52a[_0x590a1b(0x13d4)][_0x590a1b(0x1248)]),_0x17f010=_0x32877d[_0x590a1b(0xc0d)](_0x39d7cd=>_0x39d7cd['id']===_0x9ac695);_0x17f010&&_0x208a0a[_0x590a1b(0x954)][_0x590a1b(0x1a0)]({'id':'npc_'+_0x9ac695,'originalName':_0x17f010[_0x590a1b(0x564)],'groupNickname':_0x17f010[_0x590a1b(0x564)],'persona':_0x17f010[_0x590a1b(0x596)],'avatar':_0x17f010[_0x590a1b(0x799)]||_0x3ea4df,'isNpc':!![]});}}}await _0xb81d4e[_0x590a1b(0x1027)]['put'](_0x208a0a),_0xc43f8();}function _0x3ff379(){_0x551b1c=!![],_0x2a76b9(null);}function _0x1423cf(_0x438890,_0x38a958){const _0x49e823=setInterval(()=>{const _0x6120e9=_0x6666,_0x47c5f3=Date['now'](),_0x45b48a=_0x38a958-_0x47c5f3;if(_0x45b48a<0x0){clearInterval(_0x49e823),_0x438890[_0x6120e9(0x3de)]=_0x6120e9(0x94f);return;}const _0x5aadb7=Math[_0x6120e9(0xd71)](_0x45b48a%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0x49401e=Math[_0x6120e9(0xd71)](_0x45b48a%(0x3e8*0x3c)/0x3e8),_0x44da6f=String(_0x5aadb7)[_0x6120e9(0x738)](0x2,'0'),_0xc901f3=String(_0x49401e)[_0x6120e9(0x738)](0x2,'0');_0x438890[_0x6120e9(0x3de)]=_0x6120e9(0x1240)+_0x44da6f[_0x6120e9(0x4e5)](0x0)+_0x6120e9(0xe59)+_0x44da6f['charAt'](0x1)+_0x6120e9(0x10b5)+_0xc901f3[_0x6120e9(0x4e5)](0x0)+_0x6120e9(0xe59)+_0xc901f3[_0x6120e9(0x4e5)](0x1)+_0x6120e9(0x451);},0x3e8);return _0x49e823;}function _0x599cb2(){for(const _0x56ceab in _0x43f059){clearInterval(_0x43f059[_0x56ceab]);}_0x43f059={};}async function _0x9bfc5b(_0x55db3a){const _0x53bf5c=_0x85c4bf,_0x5ab759=_0x505390['chats'][_0x505390[_0x53bf5c(0x233)]];if(!_0x5ab759)return;const _0x4e3e25=_0x5ab759['history'][_0x53bf5c(0xc0d)](_0x5c15dc=>_0x5c15dc[_0x53bf5c(0x12a2)]===_0x55db3a);if(!_0x4e3e25||!['waimai_request',_0x53bf5c(0x4cf)][_0x53bf5c(0x44f)](_0x4e3e25[_0x53bf5c(0x858)])){console['error'](_0x53bf5c(0x27d),_0x55db3a);return;}let _0x80f919='';if(_0x4e3e25[_0x53bf5c(0x858)]===_0x53bf5c(0x792)){let _0x3e729f;switch(_0x4e3e25[_0x53bf5c(0x93c)]){case _0x53bf5c(0xb08):const _0x42572d=_0x4e3e25['paidBy']||'对方',_0x186cb9=_0x503999(_0x5ab759,_0x42572d);_0x3e729f='由\x20'+_0x186cb9+_0x53bf5c(0x72c);break;case'rejected':_0x3e729f=_0x53bf5c(0x950);break;default:_0x3e729f=_0x53bf5c(0x651);break;}_0x80f919=_0x53bf5c(0x999)+_0x4e3e25[_0x53bf5c(0xaf5)]+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>金额:</strong>\x20¥'+Number(_0x4e3e25[_0x53bf5c(0xc5c)])[_0x53bf5c(0x6e1)](0x2)+_0x53bf5c(0x914)+_0x3e729f+_0x53bf5c(0x67f);}else{if(_0x4e3e25[_0x53bf5c(0x858)]===_0x53bf5c(0x4cf)){let _0x4b492b,_0x271b7c;_0x5ab759[_0x53bf5c(0x9d7)]?(_0x4b492b=_0x503999(_0x5ab759,_0x4e3e25['senderName']),_0x271b7c=_0x503999(_0x5ab759,_0x4e3e25[_0x53bf5c(0x1103)])):_0x4e3e25['role']==='user'?(_0x4b492b=_0x5ab759[_0x53bf5c(0x18a)][_0x53bf5c(0xf58)]||'我',_0x271b7c=_0x5ab759[_0x53bf5c(0x564)]):(_0x4b492b=_0x5ab759[_0x53bf5c(0x564)],_0x271b7c=_0x5ab759[_0x53bf5c(0x18a)][_0x53bf5c(0xf58)]||'我'),_0x80f919=_0x53bf5c(0xad5)+_0x4b492b+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>接收方:</strong>\x20'+_0x271b7c+_0x53bf5c(0x1db)+_0x4e3e25[_0x53bf5c(0xaf5)]+_0x53bf5c(0x268)+Number(_0x4e3e25[_0x53bf5c(0xc5c)])['toFixed'](0x2)+_0x53bf5c(0x67f);}}await _0x1519c8(_0x53bf5c(0xf84),_0x80f919);}async function _0x26466b(_0x2e0372,_0x4c1156){const _0x5f5bcf=_0x85c4bf,_0x51360d=_0x505390[_0x5f5bcf(0x1027)][_0x505390[_0x5f5bcf(0x233)]];if(!_0x51360d)return;const _0x2cb956=_0x51360d['history']['findIndex'](_0x2b3053=>_0x2b3053[_0x5f5bcf(0x12a2)]===_0x2e0372);if(_0x2cb956===-0x1)return;const _0x581216=_0x51360d[_0x5f5bcf(0x7d3)][_0x2cb956];_0x581216[_0x5f5bcf(0x93c)]=_0x4c1156;let _0x2dee55;const _0x27f07b=_0x51360d[_0x5f5bcf(0x9d7)]?_0x51360d['settings'][_0x5f5bcf(0xf58)]||'我':'我';_0x4c1156===_0x5f5bcf(0xb08)?(_0x581216['paidBy']=_0x27f07b,_0x2dee55=_0x5f5bcf(0xf9e)+_0x27f07b+_0x5f5bcf(0x685)+_0x581216[_0x5f5bcf(0xdcc)]+_0x5f5bcf(0xce2)+_0x2e0372+'）完成了支付。此订单已关闭，其他成员不能再支付。]'):_0x2dee55=_0x5f5bcf(0xf9e)+_0x27f07b+_0x5f5bcf(0x127b)+_0x581216[_0x5f5bcf(0xdcc)]+_0x5f5bcf(0x600)+_0x2e0372+'）。]';const _0x4369f9={'role':_0x5f5bcf(0xbaa),'content':_0x2dee55,'timestamp':Date[_0x5f5bcf(0x12d6)](),'isHidden':!![]};_0x51360d[_0x5f5bcf(0x7d3)][_0x5f5bcf(0x1a0)](_0x4369f9),await _0xb81d4e[_0x5f5bcf(0x1027)][_0x5f5bcf(0x5d0)](_0x51360d),_0x474d6b(_0x505390[_0x5f5bcf(0x233)]);}let _0x315a6a={'isActive':![],'isAwaitingResponse':![],'isGroupCall':![],'activeChatId':null,'initiator':null,'startTime':null,'participants':[],'isUserParticipating':!![],'callHistory':[],'preCallContext':''},_0x5775f4=null;async function _0x5b2567(){const _0xcdb31=_0x85c4bf;if(!_0x505390['activeChatId']||_0x315a6a[_0xcdb31(0x4c3)]||_0x315a6a['isAwaitingResponse'])return;const _0xbe40cf=_0x505390['chats'][_0x505390['activeChatId']];_0x315a6a['isGroupCall']=_0xbe40cf[_0xcdb31(0x9d7)],_0x315a6a[_0xcdb31(0xbb7)]=!![],_0x315a6a['initiator']='user',_0x315a6a[_0xcdb31(0x233)]=_0xbe40cf['id'],_0x315a6a[_0xcdb31(0x9bc)]=!![];_0xbe40cf['isGroup']?(document[_0xcdb31(0x479)](_0xcdb31(0x938))['src']=_0xbe40cf[_0xcdb31(0x18a)][_0xcdb31(0xe28)]||_0x2361d7,document[_0xcdb31(0x479)](_0xcdb31(0xebb))[_0xcdb31(0x97b)]=_0xbe40cf[_0xcdb31(0x18a)][_0xcdb31(0xf58)]||'我'):(document[_0xcdb31(0x479)](_0xcdb31(0x938))['src']=_0xbe40cf[_0xcdb31(0x18a)]['aiAvatar']||_0x28c106,document[_0xcdb31(0x479)](_0xcdb31(0xebb))['textContent']=_0xbe40cf[_0xcdb31(0x564)]);document[_0xcdb31(0x8bc)]('#outgoing-call-screen\x20.caller-text')[_0xcdb31(0x97b)]=_0xbe40cf[_0xcdb31(0x9d7)]?_0xcdb31(0x5d1):'正在呼叫...',_0x731d5(_0xcdb31(0x90b));const _0x332a93={'role':_0xcdb31(0xbaa),'content':_0xbe40cf['isGroup']?_0xcdb31(0x8d4)+(_0xbe40cf[_0xcdb31(0x18a)][_0xcdb31(0xf58)]||'我')+_0xcdb31(0xedf):'[系统提示：用户向你发起了视频通话请求。请根据你的人设，使用\x20\x22video_call_response\x22\x20指令，并设置\x20\x22decision\x22\x20为\x20\x22accept\x22\x20或\x20\x22reject\x22\x20来回应。]','timestamp':Date[_0xcdb31(0x12d6)](),'isHidden':!![]};_0xbe40cf[_0xcdb31(0x7d3)]['push'](_0x332a93),await _0xb81d4e[_0xcdb31(0x1027)][_0xcdb31(0x5d0)](_0xbe40cf),await _0x15e1a8();}function _0x511eb0(){const _0x21b24d=_0x85c4bf,_0x402c15=_0x505390['chats'][_0x315a6a[_0x21b24d(0x233)]];if(!_0x402c15)return;_0x315a6a[_0x21b24d(0x4c3)]=!![],_0x315a6a['isAwaitingResponse']=![],_0x315a6a[_0x21b24d(0x12c1)]=Date[_0x21b24d(0x12d6)](),_0x315a6a[_0x21b24d(0xb25)]=[];const _0x1adb79=_0x402c15[_0x21b24d(0x7d3)]['slice'](-0xa);_0x315a6a[_0x21b24d(0xb45)]=_0x1adb79[_0x21b24d(0x2e1)](_0x10f7ae=>{const _0x8520dc=_0x21b24d,_0x1a5bdf=_0x10f7ae[_0x8520dc(0x508)]===_0x8520dc(0x4c5)?_0x402c15[_0x8520dc(0x18a)][_0x8520dc(0xf58)]||'我':_0x10f7ae[_0x8520dc(0xdcc)]||_0x402c15['name'];return _0x1a5bdf+':\x20'+String(_0x10f7ae[_0x8520dc(0xac4)])['substring'](0x0,0x32)+'...';})[_0x21b24d(0x35d)]('\x0a'),_0x29d19d(),document[_0x21b24d(0x479)]('video-call-main')[_0x21b24d(0x3de)]='<em>'+(_0x315a6a['isGroupCall']?_0x21b24d(0xfee):_0x21b24d(0x5fb))+_0x21b24d(0x1324),_0x731d5(_0x21b24d(0xdc3)),document[_0x21b24d(0x479)](_0x21b24d(0x40c))['style']['display']=_0x315a6a['isUserParticipating']?_0x21b24d(0xee3):_0x21b24d(0xff8),document[_0x21b24d(0x479)](_0x21b24d(0xab5))[_0x21b24d(0x10dd)][_0x21b24d(0x678)]=_0x315a6a[_0x21b24d(0x9bc)]?_0x21b24d(0xff8):_0x21b24d(0xee3);if(_0x5775f4)clearInterval(_0x5775f4);_0x5775f4=setInterval(_0x104806,0x3e8),_0x104806(),_0x5cb9e2();}async function _0x299d4a(){const _0x4ad669=_0x85c4bf;if(!_0x315a6a[_0x4ad669(0x4c3)])return;const _0x1f4bb3=Math[_0x4ad669(0xd71)]((Date[_0x4ad669(0x12d6)]()-_0x315a6a[_0x4ad669(0x12c1)])/0x3e8),_0x20a9cb=Math[_0x4ad669(0xd71)](_0x1f4bb3/0x3c)+'分'+_0x1f4bb3%0x3c+'秒',_0x35c02d=_0x4ad669(0xa49)+_0x20a9cb,_0x19da01=_0x505390['chats'][_0x315a6a['activeChatId']];if(_0x19da01){const _0x1887b9=[];_0x315a6a[_0x4ad669(0x7bf)]?(_0x315a6a[_0x4ad669(0xf06)][_0x4ad669(0x12be)](_0x562d8f=>_0x1887b9[_0x4ad669(0x1a0)]({'name':_0x562d8f[_0x4ad669(0xe2d)],'avatar':_0x562d8f[_0x4ad669(0x799)]})),_0x315a6a[_0x4ad669(0x9bc)]&&_0x1887b9[_0x4ad669(0x7dd)]({'name':_0x19da01['settings'][_0x4ad669(0xf58)]||'我','avatar':_0x19da01['settings']['myAvatar']||_0x2361d7})):(_0x1887b9['push']({'name':_0x19da01[_0x4ad669(0x564)],'avatar':_0x19da01['settings']['aiAvatar']||_0x28c106}),_0x1887b9[_0x4ad669(0x7dd)]({'name':'我','avatar':_0x19da01[_0x4ad669(0x18a)][_0x4ad669(0xe28)]||_0x28c106}));const _0x5801f9={'chatId':_0x315a6a[_0x4ad669(0x233)],'timestamp':Date[_0x4ad669(0x12d6)](),'duration':_0x1f4bb3,'participants':_0x1887b9,'transcript':[..._0x315a6a[_0x4ad669(0xb25)]]};await _0xb81d4e[_0x4ad669(0x52e)][_0x4ad669(0x807)](_0x5801f9),console[_0x4ad669(0x90f)](_0x4ad669(0x209),_0x5801f9);let _0xa30f44={'role':_0x315a6a[_0x4ad669(0x181)]==='user'?_0x4ad669(0x4c5):'assistant','content':_0x35c02d,'timestamp':Date[_0x4ad669(0x12d6)]()};_0x19da01['isGroup']&&_0xa30f44[_0x4ad669(0x508)]===_0x4ad669(0x1328)&&(_0xa30f44[_0x4ad669(0xdcc)]=_0x315a6a[_0x4ad669(0x648)]||_0x19da01[_0x4ad669(0x954)][0x0]?.[_0x4ad669(0xe2d)]||_0x19da01['name']);_0x19da01['history'][_0x4ad669(0x1a0)](_0xa30f44);const _0x2b86fa=_0x315a6a['callHistory'][_0x4ad669(0x2e1)](_0x543f03=>{const _0x36e4f1=_0x4ad669,_0x535834=_0x543f03[_0x36e4f1(0x508)]===_0x36e4f1(0x4c5)?_0x19da01[_0x36e4f1(0x18a)]['myNickname']||'我':_0x543f03[_0x36e4f1(0xdcc)];return _0x535834+':\x20'+_0x543f03[_0x36e4f1(0xac4)];})['join']('\x0a');_0x1562d(_0x19da01['id'],_0x2b86fa);const _0x1de3bd={'role':_0x4ad669(0xbaa),'content':_0x4ad669(0xd80),'timestamp':Date[_0x4ad669(0x12d6)]()+0x1,'isHidden':!![]};_0x19da01[_0x4ad669(0x7d3)][_0x4ad669(0x1a0)](_0x1de3bd),await _0xb81d4e[_0x4ad669(0x1027)][_0x4ad669(0x5d0)](_0x19da01);}clearInterval(_0x5775f4),_0x5775f4=null,_0x315a6a={'isActive':![],'isAwaitingResponse':![],'isGroupCall':![],'activeChatId':null,'initiator':null,'startTime':null,'participants':[],'isUserParticipating':!![],'callHistory':[],'preCallContext':''},_0x19da01&&(_0x178862(_0x19da01['id']),_0x15e1a8());}function _0x29d19d(){const _0x412e13=_0x85c4bf,_0x171de0=document['getElementById'](_0x412e13(0x886));_0x171de0[_0x412e13(0x3de)]='';const _0x3f45bc=_0x505390[_0x412e13(0x1027)][_0x315a6a[_0x412e13(0x233)]];if(!_0x3f45bc)return;let _0x46f51f=[];_0x315a6a['isGroupCall']?(_0x46f51f=[..._0x315a6a[_0x412e13(0xf06)]],_0x315a6a[_0x412e13(0x9bc)]&&_0x46f51f[_0x412e13(0x7dd)]({'id':_0x412e13(0x4c5),'name':_0x3f45bc[_0x412e13(0x18a)][_0x412e13(0xf58)]||'我','avatar':_0x3f45bc[_0x412e13(0x18a)][_0x412e13(0xe28)]||_0x2361d7})):_0x46f51f[_0x412e13(0x1a0)]({'id':'ai','name':_0x3f45bc['name'],'avatar':_0x3f45bc[_0x412e13(0x18a)][_0x412e13(0x1039)]||_0x28c106}),_0x46f51f[_0x412e13(0x12be)](_0x2ac6bd=>{const _0x59e0a7=_0x412e13,_0x1851a3=document['createElement'](_0x59e0a7(0x6c8));_0x1851a3[_0x59e0a7(0xfd4)]=_0x59e0a7(0x1192),_0x1851a3['dataset'][_0x59e0a7(0x9ee)]=_0x2ac6bd['id'];const _0x10b84f=_0x2ac6bd[_0x59e0a7(0xa54)]||_0x2ac6bd[_0x59e0a7(0x564)];_0x1851a3[_0x59e0a7(0x3de)]=_0x59e0a7(0x9eb)+_0x2ac6bd[_0x59e0a7(0x799)]+'\x22\x20class=\x22participant-avatar\x22\x20alt=\x22'+_0x10b84f+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participant-name\x22>'+_0x10b84f+_0x59e0a7(0xeaa),_0x171de0[_0x59e0a7(0x9f4)](_0x1851a3);});}function _0x231c14(){const _0x17f000=_0x85c4bf;if(!_0x315a6a[_0x17f000(0x4c3)]||_0x315a6a[_0x17f000(0x9bc)])return;_0x315a6a[_0x17f000(0x9bc)]=!![],_0x29d19d(),document[_0x17f000(0x479)](_0x17f000(0x40c))['style'][_0x17f000(0x678)]=_0x17f000(0xee3),document[_0x17f000(0x479)]('join-call-btn')[_0x17f000(0x10dd)][_0x17f000(0x678)]=_0x17f000(0xff8),_0x5cb9e2(_0x17f000(0x4a6));}function _0x104806(){const _0x1506d9=_0x85c4bf;if(!_0x315a6a[_0x1506d9(0x4c3)])return;const _0x18cef8=Math[_0x1506d9(0xd71)]((Date[_0x1506d9(0x12d6)]()-_0x315a6a[_0x1506d9(0x12c1)])/0x3e8),_0x343b5b=Math['floor'](_0x18cef8/0x3c),_0x1239de=_0x18cef8%0x3c;document[_0x1506d9(0x479)]('call-timer')[_0x1506d9(0x97b)]=String(_0x343b5b)[_0x1506d9(0x738)](0x2,'0')+':'+String(_0x1239de)[_0x1506d9(0x738)](0x2,'0');}function _0x550c2f(){const _0x4defbf=_0x85c4bf,_0x2f9a24=_0x505390[_0x4defbf(0x1027)][_0x505390[_0x4defbf(0x233)]];if(!_0x2f9a24)return;if(_0x2f9a24[_0x4defbf(0x9d7)]){const _0x167be3=_0x315a6a[_0x4defbf(0x648)]||_0x2f9a24[_0x4defbf(0x954)][0x0]?.['name']||_0x4defbf(0x3fe);document[_0x4defbf(0x479)](_0x4defbf(0x9b2))['src']=_0x2f9a24[_0x4defbf(0x18a)][_0x4defbf(0x67c)]||_0x3b1eb7,document['getElementById'](_0x4defbf(0xa19))[_0x4defbf(0x97b)]=_0x2f9a24[_0x4defbf(0x564)],document[_0x4defbf(0x8bc)](_0x4defbf(0x137d))[_0x4defbf(0x97b)]=_0x167be3+'\x20邀请你加入群视频';}else document[_0x4defbf(0x479)](_0x4defbf(0x9b2))[_0x4defbf(0xa9c)]=_0x2f9a24[_0x4defbf(0x18a)][_0x4defbf(0x1039)]||_0x28c106,document[_0x4defbf(0x479)](_0x4defbf(0xa19))[_0x4defbf(0x97b)]=_0x2f9a24[_0x4defbf(0x564)],document[_0x4defbf(0x8bc)](_0x4defbf(0x137d))[_0x4defbf(0x97b)]='邀请你视频通话';document[_0x4defbf(0x479)](_0x4defbf(0xe1b))['classList'][_0x4defbf(0x807)](_0x4defbf(0x45a));}function _0x33a53(){const _0x34de1b=_0x85c4bf;document[_0x34de1b(0x479)](_0x34de1b(0xe1b))[_0x34de1b(0x9cd)][_0x34de1b(0x8b6)](_0x34de1b(0x45a));}async function _0x5cb9e2(_0x135662=null){const _0x5a9c96=_0x85c4bf;if(!_0x315a6a[_0x5a9c96(0x4c3)])return;const _0x1518bd=_0x505390[_0x5a9c96(0x1027)][_0x315a6a[_0x5a9c96(0x233)]],{proxyUrl:_0xa15096,apiKey:_0x363a7d,model:_0x56dcc6}=_0x505390[_0x5a9c96(0x30c)],_0x5c0666=document[_0x5a9c96(0x479)](_0x5a9c96(0x21e)),_0x3dd6a0=_0x1518bd[_0x5a9c96(0x18a)]['myNickname']||'我';let _0x1214f1='';if(_0x1518bd[_0x5a9c96(0x18a)]['linkedWorldBookIds']&&_0x1518bd[_0x5a9c96(0x18a)][_0x5a9c96(0x13da)][_0x5a9c96(0x990)]>0x0){const _0x4d8744=_0x1518bd[_0x5a9c96(0x18a)][_0x5a9c96(0x13da)][_0x5a9c96(0x2e1)](_0x546097=>{const _0x4099cc=_0x5a9c96,_0x29ea86=_0x505390[_0x4099cc(0xd1b)]['find'](_0x5a0ebb=>_0x5a0ebb['id']===_0x546097);return _0x29ea86&&_0x29ea86[_0x4099cc(0xac4)]?'\x0a\x0a##\x20世界书:\x20'+_0x29ea86[_0x4099cc(0x564)]+'\x0a'+_0x29ea86[_0x4099cc(0xac4)]:'';})[_0x5a9c96(0x85d)](Boolean)[_0x5a9c96(0x35d)]('');_0x4d8744&&(_0x1214f1=_0x5a9c96(0x12b0)+_0x4d8744+'\x0a#\x20---\x20世界书设定结束\x20---\x0a');}if(_0x135662&&_0x315a6a[_0x5a9c96(0x9bc)]){const _0x25f98a=Date[_0x5a9c96(0x12d6)](),_0x28dc66=document[_0x5a9c96(0xbd5)](_0x5a9c96(0x6c8));_0x28dc66[_0x5a9c96(0xfd4)]=_0x5a9c96(0x12c9),_0x28dc66[_0x5a9c96(0x97b)]=_0x135662,_0x28dc66['dataset'][_0x5a9c96(0x12a2)]=_0x25f98a,_0x33282f(_0x28dc66,()=>_0x26d0c7(_0x25f98a)),_0x5c0666[_0x5a9c96(0x9f4)](_0x28dc66),_0x5c0666['scrollTop']=_0x5c0666[_0x5a9c96(0x9c5)],_0x315a6a[_0x5a9c96(0xb25)][_0x5a9c96(0x1a0)]({'role':_0x5a9c96(0x4c5),'content':_0x135662,'timestamp':_0x25f98a});}let _0x48b9a8;if(_0x315a6a[_0x5a9c96(0x7bf)]){const _0x8f87e5=_0x315a6a[_0x5a9c96(0xf06)][_0x5a9c96(0x2e1)](_0x4fdbd8=>_0x4fdbd8[_0x5a9c96(0x564)]);_0x315a6a['isUserParticipating']&&_0x8f87e5['unshift'](_0x3dd6a0),_0x48b9a8=_0x5a9c96(0x11b1)+_0x3dd6a0+'】。你【绝对不能】生成\x20`name`\x20字段为\x20**\x22'+_0x3dd6a0+_0x5a9c96(0xda4)+_0x315a6a[_0x5a9c96(0xb45)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20**当前参与者**:\x20'+_0x8f87e5['join']('、\x20')+_0x5a9c96(0xf32)+_0x1214f1+_0x5a9c96(0x195);}else{let _0x5d7c54=_0x315a6a[_0x5a9c96(0x181)]===_0x5a9c96(0x4c5)?_0x5a9c96(0x9c2):_0x5a9c96(0x12ff);_0x48b9a8=_0x5a9c96(0xb6a)+_0x1518bd[_0x5a9c96(0x564)]+'\x20('+_0x1518bd[_0x5a9c96(0x18a)]['aiPersona']+_0x5a9c96(0xecc)+_0x1518bd[_0x5a9c96(0x564)]+_0x5a9c96(0x484)+_0x3dd6a0+_0x5a9c96(0x1115)+_0x1518bd['settings'][_0x5a9c96(0x12d7)]+_0x5a9c96(0xa27)+_0x5d7c54+_0x5a9c96(0x1065)+_0x315a6a[_0x5a9c96(0xb45)]+_0x5a9c96(0x83b);}const _0x19ef9f=[{'role':_0x5a9c96(0xbaa),'content':_0x48b9a8},..._0x315a6a[_0x5a9c96(0xb25)][_0x5a9c96(0x2e1)](_0x1eaae9=>({'role':_0x1eaae9[_0x5a9c96(0x508)],'content':_0x1eaae9['content']}))];if(_0x315a6a[_0x5a9c96(0xb25)]['length']===0x0){const _0x2ec028=_0x315a6a[_0x5a9c96(0x181)]===_0x5a9c96(0x4c5)?'*你按下了接听键...*':_0x5a9c96(0x1173);_0x19ef9f[_0x5a9c96(0x1a0)]({'role':_0x5a9c96(0x4c5),'content':_0x2ec028});}try{let _0x1702cb=_0xa15096===GEMINI_API_URL,_0x378712=_0x19a701(_0x56dcc6,_0x363a7d,_0x48b9a8,_0x19ef9f);const _0x1cfeea=_0x1702cb?await fetch(_0x378712[_0x5a9c96(0x5f3)],_0x378712[_0x5a9c96(0x104c)]):await fetch(_0xa15096+_0x5a9c96(0x347),{'method':_0x5a9c96(0xba0),'headers':{'Content-Type':'application/json','Authorization':_0x5a9c96(0xb27)+_0x363a7d},'body':JSON[_0x5a9c96(0x1308)]({'model':_0x56dcc6,'messages':_0x19ef9f,'temperature':_0x505390['globalSettings'][_0x5a9c96(0x398)]||0.8})});if(!_0x1cfeea['ok'])throw new Error((await _0x1cfeea['json']())[_0x5a9c96(0xe3b)][_0x5a9c96(0x757)]);const _0x1fa315=await _0x1cfeea[_0x5a9c96(0xfdf)](),_0x36cc17=_0x1702cb?_0x1fa315[_0x5a9c96(0x5a4)][0x0][_0x5a9c96(0xac4)][_0x5a9c96(0xa53)][0x0][_0x5a9c96(0x56d)]:_0x1fa315[_0x5a9c96(0xd5c)][0x0][_0x5a9c96(0x757)][_0x5a9c96(0xac4)],_0x4c8322=_0x5c0666[_0x5a9c96(0x8bc)]('em');if(_0x4c8322)_0x4c8322['remove']();if(_0x315a6a[_0x5a9c96(0x7bf)]){const _0x3ab08a=_0x2da9f3(_0x36cc17);_0x3ab08a['forEach'](_0x5256f8=>{const _0x5f0335=_0x5a9c96;if(!_0x5256f8[_0x5f0335(0x564)]||_0x5256f8[_0x5f0335(0x564)]===_0x3dd6a0||!_0x5256f8[_0x5f0335(0x444)])return;const _0x457caf=Date[_0x5f0335(0x12d6)]()+Math[_0x5f0335(0x103a)](),_0x4eed7a=document['createElement'](_0x5f0335(0x6c8));_0x4eed7a['className']='call-message-bubble\x20ai-speech',_0x4eed7a['innerHTML']=_0x5f0335(0x646)+_0x5256f8[_0x5f0335(0x564)]+_0x5f0335(0xaf6)+_0x5256f8[_0x5f0335(0x444)],_0x4eed7a[_0x5f0335(0x13d4)][_0x5f0335(0x12a2)]=_0x457caf,_0x33282f(_0x4eed7a,()=>_0x26d0c7(_0x457caf)),_0x5c0666[_0x5f0335(0x9f4)](_0x4eed7a),_0x315a6a[_0x5f0335(0xb25)][_0x5f0335(0x1a0)]({'role':'assistant','content':_0x5256f8[_0x5f0335(0x564)]+':\x20'+_0x5256f8['speech'],'timestamp':_0x457caf});const _0x45f896=_0x315a6a[_0x5f0335(0xf06)][_0x5f0335(0xc0d)](_0x526e85=>_0x526e85[_0x5f0335(0x564)]===_0x5256f8[_0x5f0335(0x564)]);if(_0x45f896){const _0xa57f3d=document[_0x5f0335(0x8bc)]('.participant-avatar-wrapper[data-participant-id=\x22'+_0x45f896['id']+_0x5f0335(0x12b4));_0xa57f3d&&(_0xa57f3d[_0x5f0335(0x9cd)][_0x5f0335(0x807)](_0x5f0335(0x2af)),setTimeout(()=>_0xa57f3d[_0x5f0335(0x9cd)][_0x5f0335(0x8b6)](_0x5f0335(0x2af)),0x7d0));}});}else{const _0xd13ca3=Date[_0x5a9c96(0x12d6)](),_0x53c714=document['createElement']('div');_0x53c714['className']=_0x5a9c96(0xdc0),_0x53c714['textContent']=_0x36cc17,_0x53c714[_0x5a9c96(0x13d4)][_0x5a9c96(0x12a2)]=_0xd13ca3,_0x33282f(_0x53c714,()=>_0x26d0c7(_0xd13ca3)),_0x5c0666['appendChild'](_0x53c714),_0x315a6a[_0x5a9c96(0xb25)]['push']({'role':_0x5a9c96(0x1328),'content':_0x36cc17,'timestamp':_0xd13ca3});const _0x50a101=document[_0x5a9c96(0x8bc)]('.participant-avatar-wrapper\x20.participant-avatar');_0x50a101&&(_0x50a101['classList']['add'](_0x5a9c96(0x2af)),setTimeout(()=>_0x50a101[_0x5a9c96(0x9cd)]['remove'](_0x5a9c96(0x2af)),0x7d0));}_0x5c0666[_0x5a9c96(0x2b3)]=_0x5c0666[_0x5a9c96(0x9c5)];}catch(_0x417dcb){const _0x4e02f4=document[_0x5a9c96(0xbd5)]('div');_0x4e02f4[_0x5a9c96(0xfd4)]=_0x5a9c96(0xdc0),_0x4e02f4['style'][_0x5a9c96(0x131f)]='#ff8a80',_0x4e02f4[_0x5a9c96(0x97b)]=_0x5a9c96(0x4c7)+_0x417dcb['message']+']',_0x5c0666[_0x5a9c96(0x9f4)](_0x4e02f4),_0x5c0666['scrollTop']=_0x5c0666[_0x5a9c96(0x9c5)],_0x315a6a[_0x5a9c96(0xb25)][_0x5a9c96(0x1a0)]({'role':_0x5a9c96(0x1328),'content':_0x5a9c96(0x4c7)+_0x417dcb[_0x5a9c96(0x757)]+']'});}}function _0x130b8d(_0x4248e8){const _0x5e1409=_0x85c4bf;document[_0x5e1409(0x479)]('video-call-btn')[_0x5e1409(0x10dd)][_0x5e1409(0x678)]=_0x4248e8?'none':_0x5e1409(0x899),document[_0x5e1409(0x479)](_0x5e1409(0xd2c))[_0x5e1409(0x10dd)][_0x5e1409(0x678)]=_0x4248e8?'flex':_0x5e1409(0xff8);}async function _0x26466b(_0x3b009e,_0x31fdb4){const _0x3b5b05=_0x85c4bf,_0xf34277=_0x505390[_0x3b5b05(0x1027)][_0x505390['activeChatId']];if(!_0xf34277)return;const _0x4dc480=_0xf34277[_0x3b5b05(0x7d3)][_0x3b5b05(0x120c)](_0x58012f=>_0x58012f[_0x3b5b05(0x12a2)]===_0x3b009e);if(_0x4dc480===-0x1)return;const _0x2dbdad=_0xf34277[_0x3b5b05(0x7d3)][_0x4dc480];_0x2dbdad[_0x3b5b05(0x93c)]=_0x31fdb4;let _0x133fad;const _0xa10a59=_0xf34277[_0x3b5b05(0x9d7)]?_0xf34277['settings'][_0x3b5b05(0xf58)]||'我':'我';_0x31fdb4===_0x3b5b05(0xb08)?(_0x2dbdad[_0x3b5b05(0x1eb)]=_0xa10a59,_0x133fad='[系统提示：你\x20('+_0xa10a59+')\x20为\x20'+_0x2dbdad[_0x3b5b05(0xdcc)]+_0x3b5b05(0xce2)+_0x3b009e+'）完成了支付。此订单已关闭，其他成员不能再支付。]'):_0x133fad=_0x3b5b05(0xf9e)+_0xa10a59+')\x20拒绝了\x20'+_0x2dbdad[_0x3b5b05(0xdcc)]+_0x3b5b05(0x600)+_0x3b009e+_0x3b5b05(0x386);const _0x3395a5={'role':_0x3b5b05(0xbaa),'content':_0x133fad,'timestamp':Date['now'](),'isHidden':!![]};_0xf34277[_0x3b5b05(0x7d3)][_0x3b5b05(0x1a0)](_0x3395a5),await _0xb81d4e['chats'][_0x3b5b05(0x5d0)](_0xf34277),_0x474d6b(_0x505390[_0x3b5b05(0x233)]),_0x31fdb4==='paid'&&_0x15e1a8();}async function _0x5be2f7(_0x5bac11,_0x40520a){const _0xdb9c94=_0x85c4bf,_0x150387=_0x505390[_0xdb9c94(0x1027)][_0x5bac11];if(!_0x150387)return;let _0x4e0ff3;_0x150387[_0xdb9c94(0x9d7)]?_0x4e0ff3=_0x503999(_0x150387,_0x40520a):_0x4e0ff3=_0x150387[_0xdb9c94(0x564)];const _0x2756b8=document[_0xdb9c94(0x479)]('phone-screen');_0x2756b8[_0xdb9c94(0x9cd)][_0xdb9c94(0x8b6)]('pat-animation'),void _0x2756b8[_0xdb9c94(0x918)],_0x2756b8[_0xdb9c94(0x9cd)][_0xdb9c94(0x807)](_0xdb9c94(0xcdf));const _0x5a116d=await _0x9a2c09(_0xdb9c94(0x106d)+_0x4e0ff3+'”',_0xdb9c94(0x10c1),'',_0xdb9c94(0x56d));if(_0x5a116d===null)return;const _0x545f2e=_0x503999(_0x150387,_0x505390['qzoneSettings'][_0xdb9c94(0x904)]),_0x40d3f2=_0x545f2e+_0xdb9c94(0x2b9)+_0x4e0ff3+'”\x20'+_0x5a116d[_0xdb9c94(0x9c1)](),_0x41e4a7={'role':'system','type':'pat_message','content':_0x40d3f2,'timestamp':Date['now']()};_0x150387[_0xdb9c94(0x7d3)][_0xdb9c94(0x1a0)](_0x41e4a7);const _0x232234=_0xdb9c94(0x467)+_0x545f2e+_0xdb9c94(0x549)+_0x40520a+'）'+_0x5a116d[_0xdb9c94(0x9c1)]()+_0xdb9c94(0x125d),_0x3e49d1={'role':_0xdb9c94(0xbaa),'content':_0x232234,'timestamp':Date['now']()+0x1,'isHidden':!![]};_0x150387[_0xdb9c94(0x7d3)][_0xdb9c94(0x1a0)](_0x3e49d1),await _0xb81d4e['chats'][_0xdb9c94(0x5d0)](_0x150387),_0x505390['activeChatId']===_0x5bac11&&_0x48f5ff(_0x41e4a7,_0x150387),await _0x1b7f69();}let _0x554430=null,_0xc0eda4=![],_0x1dcb25=new Set();function _0x26d0c7(_0x2f5cce){const _0x223ddf=_0x85c4bf;_0x554430=_0x2f5cce,document[_0x223ddf(0x479)](_0x223ddf(0xd67))[_0x223ddf(0x9cd)]['add']('visible');}function _0x37b2fb(){const _0x4246a6=_0x85c4bf;document['getElementById'](_0x4246a6(0xd67))[_0x4246a6(0x9cd)]['remove'](_0x4246a6(0x45a)),_0x554430=null;}async function _0x4cabd4(){const _0x492fea=_0x85c4bf;if(!_0x554430)return;const _0x2a102e=_0x554430,_0x1739c1=_0x315a6a[_0x492fea(0xb25)]['find'](_0x3f6bea=>_0x3f6bea[_0x492fea(0x12a2)]===_0x2a102e);if(!_0x1739c1)return;_0x37b2fb();let _0x58d5cd=_0x1739c1[_0x492fea(0xac4)];if(_0x315a6a[_0x492fea(0x7bf)]&&_0x1739c1[_0x492fea(0x508)]==='assistant'){const _0x2d3106=_0x1739c1[_0x492fea(0xac4)]['split'](':\x20');_0x2d3106[_0x492fea(0x990)]>0x1&&(_0x58d5cd=_0x2d3106['slice'](0x1)[_0x492fea(0x35d)](':\x20'));}const _0x4e714c=await _0x9a2c09(_0x492fea(0xa55),_0x492fea(0x11ac),_0x58d5cd,'textarea');_0x4e714c!==null&&await _0x17a71b(_0x2a102e,_0x4e714c);}async function _0x17a71b(_0x3b1259,_0x328bd5){const _0x1dbd09=_0x85c4bf,_0x12aeea=_0x315a6a[_0x1dbd09(0xb25)][_0x1dbd09(0xc0d)](_0x351795=>_0x351795[_0x1dbd09(0x12a2)]===_0x3b1259);if(_0x12aeea){let _0x553a3e=_0x328bd5;if(_0x315a6a[_0x1dbd09(0x7bf)]&&_0x12aeea[_0x1dbd09(0x508)]===_0x1dbd09(0x1328)){const _0x516e12=_0x12aeea[_0x1dbd09(0xac4)]['split'](':\x20'),_0x475d1c=_0x516e12[0x0];_0x553a3e=_0x475d1c+':\x20'+_0x328bd5;}_0x12aeea[_0x1dbd09(0xac4)]=_0x553a3e;const _0x14d165=document['querySelector'](_0x1dbd09(0x1254)+_0x3b1259+'\x22]');if(_0x14d165){if(_0x315a6a['isGroupCall']&&_0x12aeea['role']===_0x1dbd09(0x1328)){const _0x2640a7=_0x12aeea[_0x1dbd09(0xac4)][_0x1dbd09(0x53e)](':\x20'),_0x6a7924=_0x2640a7[0x0];_0x14d165['innerHTML']=_0x1dbd09(0x646)+_0x6a7924+':</strong>\x20'+_0x328bd5;}else _0x14d165[_0x1dbd09(0x97b)]=_0x328bd5;}}await _0x1519c8('成功',_0x1dbd09(0xa26));}async function _0x387b2f(){const _0x456927=_0x85c4bf;if(!_0x554430)return;const _0x5386eb=await _0x1a9e79(_0x456927(0x4cd),_0x456927(0xb61),{'confirmButtonClass':_0x456927(0x95a)});if(_0x5386eb){const _0x2de203=_0x554430;_0x37b2fb();const _0xd401b1=_0x315a6a[_0x456927(0xb25)][_0x456927(0x120c)](_0x5883c7=>_0x5883c7['timestamp']===_0x2de203);_0xd401b1>-0x1&&_0x315a6a[_0x456927(0xb25)][_0x456927(0x118e)](_0xd401b1,0x1);const _0x130461=document[_0x456927(0x8bc)](_0x456927(0x1254)+_0x2de203+'\x22]');_0x130461&&_0x130461['remove']();}else _0x37b2fb();}function _0x196d69(_0x17e597){const _0x1104f0=_0x85c4bf;_0x4124ff=_0x17e597;const _0x2b83e1=_0x505390['chats'][_0x505390['activeChatId']],_0x3d73cf=_0x2b83e1[_0x1104f0(0x7d3)][_0x1104f0(0xc0d)](_0x231ef0=>_0x231ef0[_0x1104f0(0x12a2)]===_0x17e597);_0x3d73cf&&(document[_0x1104f0(0x479)](_0x1104f0(0xaa5))[_0x1104f0(0x97b)]=_0x3d73cf[_0x1104f0(0xdcc)]),document['getElementById'](_0x1104f0(0x538))[_0x1104f0(0x9cd)][_0x1104f0(0x807)](_0x1104f0(0x45a));}function _0xccdc91(){const _0x37275c=_0x85c4bf;document[_0x37275c(0x479)](_0x37275c(0x538))[_0x37275c(0x9cd)][_0x37275c(0x8b6)](_0x37275c(0x45a)),_0x4124ff=null;}async function _0x5b9a92(_0x5735a0){const _0x52156d=_0x85c4bf;if(!_0x4124ff)return;const _0x7a2877=_0x4124ff,_0x33c690=_0x505390[_0x52156d(0x1027)][_0x505390['activeChatId']],_0x14418b=_0x33c690[_0x52156d(0x7d3)][_0x52156d(0x120c)](_0x353f43=>_0x353f43[_0x52156d(0x12a2)]===_0x7a2877);if(_0x14418b===-0x1)return;const _0x3189cc=_0x33c690[_0x52156d(0x7d3)][_0x14418b];_0x3189cc['status']=_0x5735a0;let _0xef74ee;if(_0x5735a0==='declined'){const _0x3eeea8={'role':_0x52156d(0x4c5),'type':_0x52156d(0x5f8),'isRefund':!![],'amount':_0x3189cc[_0x52156d(0xc5c)],'note':_0x52156d(0x12cc),'timestamp':Date['now']()};_0x33c690['history'][_0x52156d(0x1a0)](_0x3eeea8),_0xef74ee=_0x52156d(0x1217)+_0x3189cc['senderName']+_0x52156d(0x33f);}else _0xef74ee=_0x52156d(0x11f4)+_0x3189cc[_0x52156d(0xdcc)]+_0x52156d(0x33f);const _0x535c6e={'role':_0x52156d(0xbaa),'content':_0xef74ee,'timestamp':Date['now']()+0x1,'isHidden':!![]};_0x33c690[_0x52156d(0x7d3)][_0x52156d(0x1a0)](_0x535c6e),await _0xb81d4e[_0x52156d(0x1027)][_0x52156d(0x5d0)](_0x33c690),_0xccdc91(),_0x474d6b(_0x505390['activeChatId']),_0x1b7f69();}function _0x54b53c(_0x30dab3){const _0xd6e6f0=_0x85c4bf;_0xaa9aca=null;if(_0x30dab3){const _0x2a6399=_0x30dab3[_0xd6e6f0(0x8bc)]('.comment-input');_0x2a6399&&(_0x2a6399[_0xd6e6f0(0xe77)]=_0xd6e6f0(0xc2e));}}async function _0x5d6891(){const _0x1be2d8=_0x85c4bf,_0x37a021=document[_0x1be2d8(0x479)](_0x1be2d8(0x341));_0x37a021[_0x1be2d8(0x3de)]='';const _0x324a01=await _0xb81d4e['memories'][_0x1be2d8(0x3d2)](_0x1be2d8(0x12a2))[_0x1be2d8(0x336)]()[_0x1be2d8(0x4ba)]();if(_0x324a01[_0x1be2d8(0x990)]===0x0){_0x37a021[_0x1be2d8(0x3de)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有共同的回忆和约定呢~</p>';return;}_0x324a01[_0x1be2d8(0x382)]((_0x1c2d11,_0x495436)=>{const _0x559592=_0x1be2d8,_0x5035b8=_0x1c2d11[_0x559592(0x858)]===_0x559592(0x38a)&&_0x1c2d11[_0x559592(0x65d)]>Date[_0x559592(0x12d6)](),_0x3d4ac0=_0x495436[_0x559592(0x858)]===_0x559592(0x38a)&&_0x495436['targetDate']>Date['now']();if(_0x5035b8&&!_0x3d4ac0)return-0x1;if(!_0x5035b8&&_0x3d4ac0)return 0x1;if(_0x5035b8&&_0x3d4ac0)return _0x1c2d11[_0x559592(0x65d)]-_0x495436[_0x559592(0x65d)];return 0x0;}),_0x324a01[_0x1be2d8(0x12be)](_0x3c6ecb=>{const _0x30795c=_0x1be2d8;let _0x2315d3;_0x3c6ecb[_0x30795c(0x858)]===_0x30795c(0x38a)&&_0x3c6ecb[_0x30795c(0x65d)]>Date['now']()?_0x2315d3=_0x5c87d0(_0x3c6ecb):_0x2315d3=_0x26c834(_0x3c6ecb),_0x37a021[_0x30795c(0x9f4)](_0x2315d3);}),_0xf4b215();}function _0x26c834(_0x1a3740){const _0x251b86=_0x85c4bf,_0x459785=document[_0x251b86(0xbd5)]('div');_0x459785[_0x251b86(0xfd4)]=_0x251b86(0xceb);const _0x5e81b7=new Date(_0x1a3740[_0x251b86(0x12a2)]),_0x2020ce=_0x5e81b7['getFullYear']()+'-'+String(_0x5e81b7[_0x251b86(0x180)]()+0x1)['padStart'](0x2,'0')+'-'+String(_0x5e81b7[_0x251b86(0x469)]())[_0x251b86(0x738)](0x2,'0')+'\x20'+String(_0x5e81b7['getHours']())[_0x251b86(0x738)](0x2,'0')+':'+String(_0x5e81b7[_0x251b86(0x28c)]())['padStart'](0x2,'0');let _0x3b68ef,_0x32cc56;if(_0x1a3740['type']===_0x251b86(0x38a)&&_0x1a3740[_0x251b86(0x65d)])_0x3b68ef=_0x251b86(0x1379)+_0x1a3740['description'],_0x32cc56=_0x23554f('在\x20'+new Date(_0x1a3740[_0x251b86(0x65d)])[_0x251b86(0x119c)]()+_0x251b86(0x1cd))[_0x251b86(0x491)](/\n/g,_0x251b86(0x1043));else{let _0xfeb0cd=_0x251b86(0xa00);if(_0x1a3740[_0x251b86(0x981)]){const _0x25aa46=_0x505390['chats'][_0x1a3740[_0x251b86(0x981)]];_0x25aa46?_0xfeb0cd=_0x25aa46[_0x251b86(0x564)]:_0xfeb0cd=_0x1a3740[_0x251b86(0xd7d)]||_0x251b86(0x3b3);}else _0x1a3740['authorName']&&(_0xfeb0cd=_0x1a3740[_0x251b86(0xd7d)]);_0x3b68ef=_0xfeb0cd+_0x251b86(0x810),_0x32cc56=_0x23554f(_0x1a3740[_0x251b86(0x78b)]);}return _0x459785['innerHTML']=_0x251b86(0x3a5)+_0x2020ce+_0x251b86(0x11e7)+_0x3b68ef+_0x251b86(0xae5)+_0x32cc56+_0x251b86(0x12da),_0x33282f(_0x459785,async()=>{const _0x1fec0d=_0x251b86,_0x4aea84=await _0x1a9e79(_0x1fec0d(0x1170),_0x1fec0d(0x26a),{'confirmButtonClass':_0x1fec0d(0x95a)});_0x4aea84&&(await _0xb81d4e[_0x1fec0d(0xa2f)][_0x1fec0d(0x1ea)](_0x1a3740['id']),_0x5d6891());}),_0x459785;}function _0x5c87d0(_0x6d5b67){const _0x1ae184=_0x85c4bf,_0x43ff4e=document[_0x1ae184(0xbd5)](_0x1ae184(0x6c8));_0x43ff4e['className']=_0x1ae184(0x99d);const _0x3694b4=new Date(_0x6d5b67[_0x1ae184(0x65d)]),_0x54ee0d=_0x3694b4[_0x1ae184(0x119c)](_0x1ae184(0xdc2),{'dateStyle':_0x1ae184(0xf31),'timeStyle':_0x1ae184(0xe6f)});return _0x43ff4e['innerHTML']=_0x1ae184(0x108a)+_0x6d5b67[_0x1ae184(0x78b)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22timer\x22\x20data-target-date=\x22'+_0x6d5b67[_0x1ae184(0x65d)]+'\x22>--天--时--分--秒</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22target-date\x22>目标时间:\x20'+_0x54ee0d+_0x1ae184(0x12da),_0x33282f(_0x43ff4e,async()=>{const _0x27c4db=_0x1ae184,_0x1f6cf5=await _0x1a9e79(_0x27c4db(0xf70),'确定要删除这个约定吗？',{'confirmButtonClass':_0x27c4db(0x95a)});_0x1f6cf5&&(await _0xb81d4e[_0x27c4db(0xa2f)][_0x27c4db(0x1ea)](_0x6d5b67['id']),_0x5d6891());}),_0x43ff4e;}let _0x1f7cc8=[];function _0xf4b215(){const _0xdadb54=_0x85c4bf;_0x1f7cc8['forEach'](_0x255a42=>clearInterval(_0x255a42)),_0x1f7cc8=[],document[_0xdadb54(0x99e)](_0xdadb54(0x12c4))[_0xdadb54(0x12be)](_0xa5cedf=>{const _0x1ac88a=_0xdadb54,_0x1d4726=parseInt(_0xa5cedf[_0x1ac88a(0x13d4)][_0x1ac88a(0x65d)]);let _0x3c363b;const _0x221208=()=>{const _0x23b503=_0x1ac88a,_0x144145=Date[_0x23b503(0x12d6)](),_0x7e6fae=_0x1d4726-_0x144145;if(_0x7e6fae<0x0){_0xa5cedf['textContent']=_0x23b503(0xc53),clearInterval(_0x3c363b),setTimeout(()=>_0x5d6891(),0x7d0);return;}const _0x598119=Math['floor'](_0x7e6fae/(0x3e8*0x3c*0x3c*0x18)),_0x5d2d4d=Math[_0x23b503(0xd71)](_0x7e6fae%(0x3e8*0x3c*0x3c*0x18)/(0x3e8*0x3c*0x3c)),_0x1538ec=Math[_0x23b503(0xd71)](_0x7e6fae%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0x4c373e=Math['floor'](_0x7e6fae%(0x3e8*0x3c)/0x3e8);_0xa5cedf[_0x23b503(0x97b)]=_0x598119+'天\x20'+_0x5d2d4d+'时\x20'+_0x1538ec+'分\x20'+_0x4c373e+'秒';};_0x221208(),_0x3c363b=setInterval(_0x221208,0x3e8),_0x1f7cc8[_0x1ac88a(0x1a0)](_0x3c363b);});}async function _0x1f5dd9(_0x500183){const _0x125861=_0x85c4bf,_0x28cc53=_0x505390['chats'][_0x500183];if(!_0x28cc53)return;await _0x1519c8(_0x125861(0x843),'正在为角色“'+_0x28cc53['name']+'”准备好友申请...');const {proxyUrl:_0x4ea9ae,apiKey:_0x361164,model:_0x2ece10}=_0x505390[_0x125861(0x30c)];if(!_0x4ea9ae||!_0x361164||!_0x2ece10){await _0x1519c8(_0x125861(0x1056),_0x125861(0x124f));return;}const _0x2235c7=_0x28cc53['history'][_0x125861(0x777)](-0x5)[_0x125861(0x2e1)](_0x3285bf=>{const _0x3ea3de=_0x125861,_0x39ef3c=_0x3285bf['role']==='user'?_0x28cc53[_0x3ea3de(0x18a)][_0x3ea3de(0xf58)]||'我':_0x3285bf[_0x3ea3de(0xdcc)]||_0x28cc53[_0x3ea3de(0x564)];return _0x39ef3c+':\x20'+String(_0x3285bf[_0x3ea3de(0xac4)])[_0x3ea3de(0x1323)](0x0,0x32)+'...';})['join']('\x0a');let _0x41065f='';if(_0x28cc53[_0x125861(0x18a)][_0x125861(0x13da)]&&_0x28cc53['settings'][_0x125861(0x13da)][_0x125861(0x990)]>0x0){const _0x491c5b=_0x28cc53[_0x125861(0x18a)][_0x125861(0x13da)][_0x125861(0x2e1)](_0x45d04c=>{const _0x1c3e70=_0x125861,_0x48b6a5=_0x505390['worldBooks'][_0x1c3e70(0xc0d)](_0x20107c=>_0x20107c['id']===_0x45d04c);if(!_0x48b6a5||!Array[_0x1c3e70(0x285)](_0x48b6a5[_0x1c3e70(0xac4)]))return'';const _0x1b013c=_0x48b6a5[_0x1c3e70(0xac4)]['map'](_0x1a5cd9=>{const _0x3e5d11=_0x1c3e70;let _0x6f5d3a=_0x3e5d11(0x1345)+(_0x1a5cd9[_0x3e5d11(0xd6c)]||_0x3e5d11(0x561))+'\x0a';return _0x1a5cd9[_0x3e5d11(0x108c)]['length']>0x0&&(_0x6f5d3a+=_0x3e5d11(0x6ff)+_0x1a5cd9[_0x3e5d11(0x108c)][_0x3e5d11(0x35d)](',\x20')+'\x0a'),_0x6f5d3a+='**内容:**\x0a'+_0x1a5cd9[_0x3e5d11(0xac4)],_0x6f5d3a;})['join']('\x0a');return _0x1b013c?'\x0a\x0a##\x20世界书:\x20'+_0x48b6a5['name']+'\x0a'+_0x1b013c:'';})[_0x125861(0x85d)](Boolean)[_0x125861(0x35d)]('');_0x491c5b&&(_0x41065f=_0x125861(0x2d4)+_0x491c5b+'\x0a');}const _0x341641='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是角色“'+_0x28cc53[_0x125861(0x564)]+'”。你之前被用户（你的聊天对象）拉黑了，你们已经有一段时间没有联系了。\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，你非常希望能够和好，重新和用户聊天。请你仔细分析下面的“被拉黑前的对话摘要”，理解当时发生了什么，然后思考一个真诚的、符合你人设、并且【针对具体事件】的申请理由。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的角色设定\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x28cc53[_0x125861(0x18a)][_0x125861(0x11f6)]+_0x125861(0xb58)+_0x41065f+_0x125861(0xcf3)+_0x2235c7+_0x125861(0x672);try{const _0x1c5ef7=[{'role':'system','content':_0x341641},{'role':_0x125861(0x4c5),'content':_0x125861(0xcbb)}];let _0x14e230=_0x4ea9ae===GEMINI_API_URL,_0x1984e6=_0x19a701(_0x2ece10,_0x361164,_0x341641,_0x1c5ef7);const _0x2caeb0=_0x14e230?await fetch(_0x1984e6[_0x125861(0x5f3)],_0x1984e6['data']):await fetch(_0x4ea9ae+_0x125861(0x347),{'method':_0x125861(0xba0),'headers':{'Content-Type':_0x125861(0xcb5),'Authorization':_0x125861(0xb27)+_0x361164},'body':JSON[_0x125861(0x1308)]({'model':_0x2ece10,'messages':_0x1c5ef7,'temperature':_0x505390[_0x125861(0x888)]['apiTemperature']||0.9})});if(!_0x2caeb0['ok']){const _0x1c6e35=await _0x2caeb0[_0x125861(0xfdf)]();throw new Error(_0x125861(0xf05)+_0x2caeb0[_0x125861(0x93c)]+'\x20-\x20'+_0x1c6e35['error'][_0x125861(0x757)]);}const _0xe7be86=await _0x2caeb0[_0x125861(0xfdf)]();let _0x58eac1=_0x14e230?_0xe7be86[_0x125861(0x5a4)][0x0][_0x125861(0xac4)]['parts'][0x0][_0x125861(0x56d)]:_0xe7be86[_0x125861(0xd5c)][0x0][_0x125861(0x757)][_0x125861(0xac4)];_0x58eac1=_0x58eac1['replace'](/^```json\s*/,'')[_0x125861(0x491)](/```$/,'');const _0xb6cd55=_0x58eac1[_0x125861(0x9c1)](),_0x3fb5ed=JSON[_0x125861(0x94c)](_0xb6cd55);_0x3fb5ed['decision']===_0x125861(0x1275)&&_0x3fb5ed[_0x125861(0xaac)]?(_0x28cc53[_0x125861(0xcda)][_0x125861(0x93c)]=_0x125861(0x11be),_0x28cc53['relationship'][_0x125861(0xcd9)]=_0x3fb5ed[_0x125861(0xaac)],_0x505390['chats'][_0x500183]=_0x28cc53,_0x1b7f69(),await _0x1519c8('申请成功！','“'+_0x28cc53[_0x125861(0x564)]+_0x125861(0xe07))):(await _0x1519c8(_0x125861(0xabb),'“'+_0x28cc53[_0x125861(0x564)]+_0x125861(0xc13)),_0x28cc53['relationship']['status']='blocked_by_user',_0x28cc53[_0x125861(0xcda)]['blockedTimestamp']=Date[_0x125861(0x12d6)]());}catch(_0x50c81b){await _0x1519c8(_0x125861(0x137e),'为“'+_0x28cc53[_0x125861(0x564)]+_0x125861(0xef5)+_0x50c81b[_0x125861(0x757)]+_0x125861(0xd55)),_0x28cc53['relationship'][_0x125861(0x93c)]=_0x125861(0x89f),_0x28cc53['relationship'][_0x125861(0x122a)]=Date[_0x125861(0x12d6)]();}finally{await _0xb81d4e['chats'][_0x125861(0x5d0)](_0x28cc53),_0x474d6b(_0x500183);}}function _0x17b614(){const _0x35f068=_0x85c4bf;if(!_0x505390[_0x35f068(0x233)])return;const _0x4350e3=_0x505390[_0x35f068(0x1027)][_0x505390[_0x35f068(0x233)]];_0x4350e3[_0x35f068(0x9d7)]?_0x15a7a0():document[_0x35f068(0x479)](_0x35f068(0xcdb))[_0x35f068(0x9cd)][_0x35f068(0x807)](_0x35f068(0x45a));}function _0x15a7a0(){const _0x5e0b11=_0x85c4bf,_0x5c2d99=document[_0x5e0b11(0x479)](_0x5e0b11(0x866)),_0x1db97e=_0x505390[_0x5e0b11(0x1027)][_0x505390['activeChatId']];document['getElementById'](_0x5e0b11(0x298))['value']='',document[_0x5e0b11(0x479)](_0x5e0b11(0xf33))[_0x5e0b11(0x4e0)]='',document[_0x5e0b11(0x479)](_0x5e0b11(0x1239))['value']='',document[_0x5e0b11(0x479)](_0x5e0b11(0x9bb))[_0x5e0b11(0x4e0)]='',document[_0x5e0b11(0x479)](_0x5e0b11(0xdaf))[_0x5e0b11(0x4e0)]='',document['getElementById']('rp-group-total')[_0x5e0b11(0x97b)]='¥\x200.00',document[_0x5e0b11(0x479)](_0x5e0b11(0xa41))[_0x5e0b11(0x97b)]='¥\x200.00';const _0x51290f=document[_0x5e0b11(0x479)](_0x5e0b11(0x2f2));_0x51290f[_0x5e0b11(0x3de)]='',_0x1db97e[_0x5e0b11(0x954)][_0x5e0b11(0x12be)](_0x5cd40c=>{const _0x486875=_0x5e0b11,_0x27ca4d=document[_0x486875(0xbd5)]('option');_0x27ca4d[_0x486875(0x4e0)]=_0x5cd40c[_0x486875(0xe2d)],_0x27ca4d['textContent']=_0x5cd40c[_0x486875(0xa54)],_0x51290f['appendChild'](_0x27ca4d);}),document[_0x5e0b11(0x479)](_0x5e0b11(0xe7d))[_0x5e0b11(0xd2f)](),_0x5c2d99[_0x5e0b11(0x9cd)][_0x5e0b11(0x807)](_0x5e0b11(0x45a));}async function _0x2e32ab(){const _0x3e850d=_0x85c4bf,_0x53ccb3=_0x505390[_0x3e850d(0x1027)][_0x505390[_0x3e850d(0x233)]],_0x43b9ab=parseFloat(document[_0x3e850d(0x479)](_0x3e850d(0x298))[_0x3e850d(0x4e0)]),_0x29b5db=parseInt(document[_0x3e850d(0x479)](_0x3e850d(0xf33))['value']),_0x350076=document[_0x3e850d(0x479)](_0x3e850d(0x1239))[_0x3e850d(0x4e0)]['trim']();if(isNaN(_0x43b9ab)||_0x43b9ab<=0x0){alert(_0x3e850d(0x884));return;}if(isNaN(_0x29b5db)||_0x29b5db<=0x0){alert(_0x3e850d(0xee8));return;}if(_0x43b9ab/_0x29b5db<0.01){alert('单个红包金额不能少于0.01元！');return;}const _0x3a1450=_0x53ccb3[_0x3e850d(0x18a)][_0x3e850d(0xf58)]||'我',_0x3626ff={'role':'user','senderName':_0x3a1450,'type':_0x3e850d(0x1358),'packetType':_0x3e850d(0x57c),'timestamp':Date[_0x3e850d(0x12d6)](),'totalAmount':_0x43b9ab,'count':_0x29b5db,'greeting':_0x350076||_0x3e850d(0x9c4),'claimedBy':{},'isFullyClaimed':![]};_0x53ccb3[_0x3e850d(0x7d3)]['push'](_0x3626ff),await _0xb81d4e[_0x3e850d(0x1027)][_0x3e850d(0x5d0)](_0x53ccb3),_0x48f5ff(_0x3626ff,_0x53ccb3),_0x1b7f69(),document['getElementById']('red-packet-modal')[_0x3e850d(0x9cd)][_0x3e850d(0x8b6)]('visible');}async function _0x25366f(){const _0xd508dd=_0x85c4bf,_0x56b11e=_0x505390['chats'][_0x505390['activeChatId']],_0x146201=parseFloat(document['getElementById'](_0xd508dd(0x9bb))[_0xd508dd(0x4e0)]),_0x13dc85=document[_0xd508dd(0x479)](_0xd508dd(0x2f2))['value'],_0x4e3a46=document[_0xd508dd(0x479)](_0xd508dd(0xdaf))[_0xd508dd(0x4e0)][_0xd508dd(0x9c1)]();if(isNaN(_0x146201)||_0x146201<=0x0){alert(_0xd508dd(0x11cf));return;}if(!_0x13dc85){alert(_0xd508dd(0x354));return;}const _0x2432b0=_0x56b11e[_0xd508dd(0x18a)][_0xd508dd(0xf58)]||'我',_0xd00969={'role':_0xd508dd(0x4c5),'senderName':_0x2432b0,'type':_0xd508dd(0x1358),'packetType':_0xd508dd(0x211),'timestamp':Date['now'](),'totalAmount':_0x146201,'count':0x1,'greeting':_0x4e3a46||_0xd508dd(0x1399),'receiverName':_0x13dc85,'claimedBy':{},'isFullyClaimed':![]};_0x56b11e[_0xd508dd(0x7d3)][_0xd508dd(0x1a0)](_0xd00969),await _0xb81d4e[_0xd508dd(0x1027)][_0xd508dd(0x5d0)](_0x56b11e),_0x48f5ff(_0xd00969,_0x56b11e),_0x1b7f69(),document[_0xd508dd(0x479)](_0xd508dd(0x866))[_0xd508dd(0x9cd)][_0xd508dd(0x8b6)](_0xd508dd(0x45a));}async function _0x3bc284(_0x2951fb){const _0x4af413=_0x85c4bf,_0x453d9c=_0x505390[_0x4af413(0x233)],_0x12cda4=await _0xb81d4e[_0x4af413(0x1027)][_0x4af413(0x111a)](_0x453d9c);if(!_0x12cda4)return;_0x505390[_0x4af413(0x1027)][_0x453d9c]=_0x12cda4;const _0x21d461=_0x12cda4['history'][_0x4af413(0xc0d)](_0x327c37=>_0x327c37[_0x4af413(0x12a2)]===_0x2951fb);if(!_0x21d461)return;const _0x33dcab=_0x505390[_0x4af413(0x1190)][_0x4af413(0x904)]||_0x4af413(0x80e),_0x2daf71=_0x21d461[_0x4af413(0x12e6)]&&_0x21d461[_0x4af413(0x12e6)][_0x33dcab];if(_0x21d461[_0x4af413(0xeaf)]===_0x4af413(0x211)&&_0x21d461[_0x4af413(0xfd7)]!==_0x33dcab&&Object[_0x4af413(0x108c)](_0x21d461[_0x4af413(0x12e6)])['length']>0x0||_0x21d461[_0x4af413(0x824)]||_0x2daf71){_0x33c0de(_0x21d461);return;}const _0x5b36de=await _0x462e22(_0x21d461);_0x5b36de!==null&&(await _0x474d6b(_0x453d9c),await _0x1519c8('恭喜！','你领取了\x20'+_0x503999(_0x12cda4,_0x21d461[_0x4af413(0xdcc)])+_0x4af413(0x909)+_0x5b36de[_0x4af413(0x6e1)](0x2)+'\x20元。'));const _0x2c2825=_0x505390[_0x4af413(0x1027)][_0x453d9c][_0x4af413(0x7d3)][_0x4af413(0xc0d)](_0x4788b7=>_0x4788b7['timestamp']===_0x2951fb);_0x2c2825&&_0x33c0de(_0x2c2825);}async function _0x462e22(_0x503238){const _0x3cf1ac=_0x85c4bf,_0x425e42=_0x505390[_0x3cf1ac(0x1027)][_0x505390[_0x3cf1ac(0x233)]];let _0x1ec478=Date['now']();const _0x237023=_0x505390[_0x3cf1ac(0x1190)][_0x3cf1ac(0x904)]||_0x3cf1ac(0x80e),_0x4c090c=_0x503238[_0x3cf1ac(0x32f)]-Object[_0x3cf1ac(0x108c)](_0x503238['claimedBy']||{})[_0x3cf1ac(0x990)];if(_0x4c090c<=0x0)return _0x503238[_0x3cf1ac(0x824)]=!![],await _0xb81d4e[_0x3cf1ac(0x1027)][_0x3cf1ac(0x5d0)](_0x425e42),await _0x1519c8('手慢了',_0x3cf1ac(0x7ce)),null;let _0x1505f9=0x0;const _0x352a32=_0x503238[_0x3cf1ac(0xc10)]-Object[_0x3cf1ac(0x3d5)](_0x503238[_0x3cf1ac(0x12e6)]||{})['reduce']((_0x356b05,_0x2828ef)=>_0x356b05+_0x2828ef,0x0);if(_0x503238[_0x3cf1ac(0xeaf)]===_0x3cf1ac(0x57c)){if(_0x4c090c===0x1)_0x1505f9=_0x352a32;else{const _0x25f939=0.01,_0x26fcde=_0x352a32-(_0x4c090c-0x1)*_0x25f939;_0x1505f9=Math['random']()*(_0x26fcde-_0x25f939)+_0x25f939;}}else _0x1505f9=_0x503238['totalAmount'];_0x1505f9=parseFloat(_0x1505f9[_0x3cf1ac(0x6e1)](0x2));if(!_0x503238[_0x3cf1ac(0x12e6)])_0x503238[_0x3cf1ac(0x12e6)]={};_0x503238['claimedBy'][_0x237023]=_0x1505f9;const _0x539614=Object[_0x3cf1ac(0x108c)](_0x503238[_0x3cf1ac(0x12e6)])[_0x3cf1ac(0x990)]>=_0x503238['count'];_0x539614&&(_0x503238[_0x3cf1ac(0x824)]=!![]);const _0x5356fe=_0x503999(_0x425e42,_0x237023),_0x2ae802=_0x503999(_0x425e42,_0x503238[_0x3cf1ac(0xdcc)]),_0x315453={'role':_0x3cf1ac(0xbaa),'type':_0x3cf1ac(0x81b),'content':'你领取了\x20'+_0x2ae802+_0x3cf1ac(0xa81),'timestamp':_0x1ec478++};_0x425e42[_0x3cf1ac(0x7d3)][_0x3cf1ac(0x1a0)](_0x315453);let _0x23e0a5;if(_0x539614){const _0x5c374b={'role':_0x3cf1ac(0xbaa),'type':_0x3cf1ac(0x81b),'content':_0x2ae802+_0x3cf1ac(0x6f6),'timestamp':_0x1ec478++};_0x425e42[_0x3cf1ac(0x7d3)][_0x3cf1ac(0x1a0)](_0x5c374b);let _0x358ce6={'name':'','amount':-0x1};_0x503238[_0x3cf1ac(0xeaf)]===_0x3cf1ac(0x57c)&&_0x503238[_0x3cf1ac(0x32f)]>0x1&&Object[_0x3cf1ac(0xef7)](_0x503238['claimedBy'])[_0x3cf1ac(0x12be)](([_0xbfc893,_0x4f2014])=>{_0x4f2014>_0x358ce6['amount']&&(_0x358ce6={'name':_0xbfc893,'amount':_0x4f2014});});const _0x5cddb5=_0x358ce6[_0x3cf1ac(0x564)]?_0x503999(_0x425e42,_0x358ce6[_0x3cf1ac(0x564)]):'无';_0x23e0a5='[系统提示：用户\x20('+_0x5356fe+_0x3cf1ac(0x3d6)+_0x5cddb5+_0x3cf1ac(0x34a);}else _0x23e0a5=_0x3cf1ac(0x8d4)+_0x5356fe+_0x3cf1ac(0x620)+_0x503238['timestamp']+_0x3cf1ac(0x5e9);const _0x44d265={'role':_0x3cf1ac(0xbaa),'content':_0x23e0a5,'timestamp':_0x1ec478++,'isHidden':!![]};return _0x425e42[_0x3cf1ac(0x7d3)][_0x3cf1ac(0x1a0)](_0x44d265),await _0xb81d4e['chats']['put'](_0x425e42),_0x1505f9;}async function _0x33c0de(_0x56a620){const _0x39e3b8=_0x85c4bf;if(!_0x56a620){console[_0x39e3b8(0xe3b)](_0x39e3b8(0x1119));return;}const _0x5da81=_0x505390['chats'][_0x505390['activeChatId']];if(!_0x5da81)return;const _0x32daf3=document[_0x39e3b8(0x479)](_0x39e3b8(0xf68)),_0x98a0dc=_0x505390[_0x39e3b8(0x1190)]['nickname']||_0x39e3b8(0x80e),_0x5e1d23=_0x503999(_0x5da81,_0x56a620[_0x39e3b8(0xdcc)]);document[_0x39e3b8(0x479)](_0x39e3b8(0x920))[_0x39e3b8(0x97b)]=_0x5e1d23,document[_0x39e3b8(0x479)](_0x39e3b8(0xb24))['textContent']=_0x56a620[_0x39e3b8(0x91e)]||_0x39e3b8(0x9c4);const _0x5067aa=document[_0x39e3b8(0x479)](_0x39e3b8(0xb44));_0x56a620[_0x39e3b8(0x12e6)]&&_0x56a620[_0x39e3b8(0x12e6)][_0x98a0dc]?(_0x5067aa[_0x39e3b8(0x8bc)](_0x39e3b8(0x1310))[_0x39e3b8(0x97b)]=_0x56a620['claimedBy'][_0x98a0dc][_0x39e3b8(0x6e1)](0x2),_0x5067aa[_0x39e3b8(0x10dd)]['display']=_0x39e3b8(0xee3)):_0x5067aa['style'][_0x39e3b8(0x678)]=_0x39e3b8(0xff8);const _0x1d8412=Object[_0x39e3b8(0x108c)](_0x56a620[_0x39e3b8(0x12e6)]||{})[_0x39e3b8(0x990)],_0x5bd3cf=Object[_0x39e3b8(0x3d5)](_0x56a620[_0x39e3b8(0x12e6)]||{})[_0x39e3b8(0x1300)]((_0x3d2930,_0xd390cb)=>_0x3d2930+_0xd390cb,0x0);let _0x5c4561=_0x1d8412+'/'+_0x56a620[_0x39e3b8(0x32f)]+'个红包，共'+_0x5bd3cf['toFixed'](0x2)+'/'+_0x56a620[_0x39e3b8(0xc10)][_0x39e3b8(0x6e1)](0x2)+'元。';if(!_0x56a620[_0x39e3b8(0x824)]&&_0x1d8412<_0x56a620[_0x39e3b8(0x32f)]){const _0x5d8784=Math['floor']((_0x56a620[_0x39e3b8(0x12a2)]+0x18*0x3c*0x3c*0x3e8-Date[_0x39e3b8(0x12d6)]())/(0x3e8*0x3c*0x3c));if(_0x5d8784>0x0)_0x5c4561+=_0x39e3b8(0xc5f)+_0x5d8784+_0x39e3b8(0x1394);}document[_0x39e3b8(0x479)]('rp-details-summary')[_0x39e3b8(0x97b)]=_0x5c4561;const _0x19ef86=document['getElementById'](_0x39e3b8(0xd9c));_0x19ef86[_0x39e3b8(0x3de)]='';const _0xad2327=Object[_0x39e3b8(0xef7)](_0x56a620[_0x39e3b8(0x12e6)]||{});let _0xb3b090={'name':'','amount':-0x1};_0x56a620['packetType']===_0x39e3b8(0x57c)&&_0x56a620[_0x39e3b8(0x824)]&&_0xad2327[_0x39e3b8(0x990)]>0x1&&_0xad2327[_0x39e3b8(0x12be)](([_0xe2071d,_0x2771d1])=>{const _0x495cc0=_0x39e3b8;_0x2771d1>_0xb3b090[_0x495cc0(0xc5c)]&&(_0xb3b090={'name':_0xe2071d,'amount':_0x2771d1});}),_0xad2327[_0x39e3b8(0x382)]((_0xd404e7,_0x501cc5)=>_0x501cc5[0x1]-_0xd404e7[0x1]),_0xad2327['forEach'](([_0xa128cf,_0x4f9fac])=>{const _0x1258b9=_0x39e3b8,_0x1695c5=document[_0x1258b9(0xbd5)](_0x1258b9(0x6c8));_0x1695c5[_0x1258b9(0xfd4)]=_0x1258b9(0x19e);let _0x52518b='';_0xb3b090[_0x1258b9(0x564)]&&_0xa128cf===_0xb3b090[_0x1258b9(0x564)]&&(_0x52518b=_0x1258b9(0x1ef));const _0xed4c0c=_0x503999(_0x5da81,_0xa128cf);_0x1695c5[_0x1258b9(0x3de)]=_0x1258b9(0xf81)+_0xed4c0c+_0x1258b9(0x741)+_0x4f9fac[_0x1258b9(0x6e1)](0x2)+_0x1258b9(0x65c)+_0x52518b+_0x1258b9(0xf43),_0x19ef86[_0x1258b9(0x9f4)](_0x1695c5);}),_0x32daf3[_0x39e3b8(0x9cd)][_0x39e3b8(0x807)](_0x39e3b8(0x45a));}document[_0x85c4bf(0x479)](_0x85c4bf(0x1259))['addEventListener'](_0x85c4bf(0xd2f),()=>{const _0x54bf26=_0x85c4bf;document[_0x54bf26(0x479)]('red-packet-details-modal')[_0x54bf26(0x9cd)][_0x54bf26(0x8b6)](_0x54bf26(0x45a));}),window[_0x85c4bf(0x822)]=_0x3bc284;function _0x1fece2(){const _0x178791=_0x85c4bf,_0x29edef=document[_0x178791(0x479)](_0x178791(0xf1c));document[_0x178791(0x479)]('poll-question-input')[_0x178791(0x4e0)]='';const _0x22d5a1=document[_0x178791(0x479)]('poll-options-container');_0x22d5a1[_0x178791(0x3de)]='',_0x105c67(),_0x105c67(),_0x29edef['classList'][_0x178791(0x807)](_0x178791(0x45a));}function _0x105c67(){const _0x4ef492=_0x85c4bf,_0x39e021=document[_0x4ef492(0x479)]('poll-options-container'),_0x41b637=document[_0x4ef492(0xbd5)]('div');_0x41b637[_0x4ef492(0xfd4)]=_0x4ef492(0xa13),_0x41b637[_0x4ef492(0x3de)]=_0x4ef492(0x10da),_0x41b637[_0x4ef492(0x8bc)](_0x4ef492(0x44c))['addEventListener']('click',()=>{const _0x45f965=_0x4ef492;_0x39e021['children'][_0x45f965(0x990)]>0x2?_0x41b637[_0x45f965(0x8b6)]():alert(_0x45f965(0x41c));}),_0x39e021[_0x4ef492(0x9f4)](_0x41b637);}async function _0x10d607(){const _0x36efcf=_0x85c4bf;if(!_0x505390[_0x36efcf(0x233)])return;const _0x1fddba=document['getElementById'](_0x36efcf(0x2cb))['value'][_0x36efcf(0x9c1)]();if(!_0x1fddba){alert(_0x36efcf(0xb0c));return;}const _0x515ab7=Array['from'](document[_0x36efcf(0x99e)](_0x36efcf(0xce4)))[_0x36efcf(0x2e1)](_0x4112d8=>_0x4112d8[_0x36efcf(0x4e0)]['trim']())[_0x36efcf(0x85d)](_0x5ebe15=>_0x5ebe15);if(_0x515ab7[_0x36efcf(0x990)]<0x2){alert(_0x36efcf(0x1293));return;}const _0x3cf2e7=_0x505390[_0x36efcf(0x1027)][_0x505390['activeChatId']],_0x5d9c26=_0x3cf2e7[_0x36efcf(0x9d7)]?_0x3cf2e7[_0x36efcf(0x18a)][_0x36efcf(0xf58)]||'我':'我',_0x429ffe={'role':'user','senderName':_0x5d9c26,'type':'poll','timestamp':Date[_0x36efcf(0x12d6)](),'question':_0x1fddba,'options':_0x515ab7,'votes':{},'isClosed':![]};_0x3cf2e7[_0x36efcf(0x7d3)][_0x36efcf(0x1a0)](_0x429ffe),await _0xb81d4e[_0x36efcf(0x1027)]['put'](_0x3cf2e7),_0x48f5ff(_0x429ffe,_0x3cf2e7),_0x1b7f69(),document[_0x36efcf(0x479)](_0x36efcf(0xf1c))[_0x36efcf(0x9cd)]['remove'](_0x36efcf(0x45a));}async function _0x398b9c(_0x2af63b,_0x48fd32){const _0x239887=_0x85c4bf,_0x1b6da8=_0x505390[_0x239887(0x1027)][_0x505390['activeChatId']],_0xaa972e=_0x1b6da8[_0x239887(0x7d3)][_0x239887(0xc0d)](_0x45062b=>_0x45062b[_0x239887(0x12a2)]===_0x2af63b),_0x3e994b=_0x1b6da8[_0x239887(0x9d7)]?_0x1b6da8[_0x239887(0x18a)][_0x239887(0xf58)]||'我':'我';if(!_0xaa972e||_0xaa972e[_0x239887(0x6fc)]){_0xaa972e&&_0xaa972e[_0x239887(0x6fc)]&&_0x17870e(_0x2af63b);return;}const _0x29e0cd=_0xaa972e[_0x239887(0x78e)][_0x48fd32]&&_0xaa972e[_0x239887(0x78e)][_0x48fd32][_0x239887(0x44f)](_0x3e994b);if(!_0x29e0cd){for(const _0x4614cd in _0xaa972e[_0x239887(0x78e)]){const _0x112b2d=_0xaa972e[_0x239887(0x78e)][_0x4614cd][_0x239887(0xf2f)](_0x3e994b);_0x112b2d>-0x1&&_0xaa972e['votes'][_0x4614cd][_0x239887(0x118e)](_0x112b2d,0x1);}!_0xaa972e[_0x239887(0x78e)][_0x48fd32]&&(_0xaa972e[_0x239887(0x78e)][_0x48fd32]=[]),_0xaa972e[_0x239887(0x78e)][_0x48fd32]['push'](_0x3e994b);}let _0x339dc1=null;!_0x29e0cd&&(_0x339dc1='[系统提示：用户\x20('+_0x3e994b+_0x239887(0xcd2)+_0x48fd32+_0x239887(0xf0f));if(_0x339dc1){const _0x17c547={'role':_0x239887(0xbaa),'content':_0x339dc1,'timestamp':Date['now'](),'isHidden':!![]};_0x1b6da8['history']['push'](_0x17c547);}await _0xb81d4e[_0x239887(0x1027)][_0x239887(0x5d0)](_0x1b6da8),_0x474d6b(_0x505390[_0x239887(0x233)]);}async function _0x509d06(_0x3ad732){const _0x145166=_0x85c4bf,_0x76168c=_0x505390[_0x145166(0x1027)][_0x505390['activeChatId']],_0x434b1c=_0x76168c[_0x145166(0x7d3)][_0x145166(0xc0d)](_0x5255ef=>_0x5255ef[_0x145166(0x12a2)]===_0x3ad732);if(!_0x434b1c||_0x434b1c['isClosed'])return;const _0x3df979=await _0x1a9e79('结束投票','确定要结束这个投票吗？结束后将无法再进行投票。');if(_0x3df979){_0x434b1c['isClosed']=!![];const _0x394328=_0x434b1c['options'][_0x145166(0x2e1)](_0x386413=>'“'+_0x386413+'”('+(_0x434b1c[_0x145166(0x78e)][_0x386413]?.[_0x145166(0x990)]||0x0)+'票)')[_0x145166(0x35d)]('，'),_0x5a7c35=_0x145166(0x1c5)+_0x394328+'。]',_0x1f7b9e={'role':'system','content':_0x5a7c35,'timestamp':Date[_0x145166(0x12d6)](),'isHidden':!![]};_0x76168c[_0x145166(0x7d3)]['push'](_0x1f7b9e),await _0xb81d4e['chats'][_0x145166(0x5d0)](_0x76168c),_0x474d6b(_0x505390['activeChatId']);}}function _0x17870e(_0xed28a8){const _0x1f66b0=_0x85c4bf,_0x4f58a5=_0x505390[_0x1f66b0(0x1027)][_0x505390['activeChatId']],_0x38d43b=_0x4f58a5[_0x1f66b0(0x7d3)][_0x1f66b0(0xc0d)](_0x5c5142=>_0x5c5142[_0x1f66b0(0x12a2)]===_0xed28a8);if(!_0x38d43b||!_0x38d43b[_0x1f66b0(0x6fc)])return;let _0x2baa0b=_0x1f66b0(0x592)+_0x38d43b[_0x1f66b0(0xa60)]+'</strong></p><hr\x20style=\x22opacity:\x200.2;\x20margin:\x2010px\x200;\x22>';Object['keys'](_0x38d43b[_0x1f66b0(0x78e)])[_0x1f66b0(0x990)]===0x0?_0x2baa0b+='<p\x20style=\x22color:\x20#8a8a8a;\x22>还没有人投票。</p>':_0x38d43b['options'][_0x1f66b0(0x12be)](_0x3ab0e0=>{const _0x32595b=_0x1f66b0,_0x356726=_0x38d43b[_0x32595b(0x78e)][_0x3ab0e0]||[],_0x22d4d2=_0x356726['map'](_0x2cd7e4=>_0x503999(_0x4f58a5,_0x2cd7e4))[_0x32595b(0x35d)]('、\x20');_0x2baa0b+='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-bottom:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20500;\x20margin:\x200\x200\x205px\x200;\x22>'+_0x3ab0e0+'\x20('+_0x356726[_0x32595b(0x990)]+'票)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2013px;\x20color:\x20#555;\x20margin:\x200;\x20line-height:\x201.5;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x356726['length']>0x0?_0x22d4d2:'无人投票')+_0x32595b(0xf7f);}),_0x1519c8(_0x1f66b0(0x133b),_0x2baa0b);}function _0x568f90(){const _0x54c2ed=_0x85c4bf;if(!_0x505390['activeChatId'])return;const _0x361c54=_0x505390['chats'][_0x505390['activeChatId']];document[_0x54c2ed(0x479)](_0x54c2ed(0xf97))[_0x54c2ed(0x97b)]='“'+_0x361c54[_0x54c2ed(0x564)]+_0x54c2ed(0x1050),_0x2e76c2(),document[_0x54c2ed(0x479)]('ai-avatar-library-modal')['classList'][_0x54c2ed(0x807)](_0x54c2ed(0x45a));}function _0x2e76c2(){const _0x3f3c18=_0x85c4bf,_0x13b55a=document[_0x3f3c18(0x479)](_0x3f3c18(0xcc0));_0x13b55a[_0x3f3c18(0x3de)]='';const _0x149da6=_0x505390['chats'][_0x505390[_0x3f3c18(0x233)]],_0x334545=_0x149da6[_0x3f3c18(0x18a)][_0x3f3c18(0x8c6)]||[];if(_0x334545[_0x3f3c18(0x990)]===0x0){_0x13b55a['innerHTML']=_0x3f3c18(0xee6);return;}_0x334545[_0x3f3c18(0x12be)]((_0x30ad5b,_0x27d04b)=>{const _0x196982=_0x3f3c18,_0x5dfdf5=document['createElement'](_0x196982(0x6c8));_0x5dfdf5[_0x196982(0xfd4)]=_0x196982(0xd46),_0x5dfdf5[_0x196982(0xc29)]=_0x30ad5b[_0x196982(0x564)],_0x5dfdf5[_0x196982(0x3de)]=_0x196982(0x29f)+_0x30ad5b[_0x196982(0x5f3)]+_0x196982(0x109f)+_0x30ad5b[_0x196982(0x564)]+_0x196982(0xa8b);const _0x322e22=document[_0x196982(0xbd5)](_0x196982(0x6c8));_0x322e22['className']='delete-btn',_0x322e22[_0x196982(0x3de)]='×',_0x322e22['style'][_0x196982(0x678)]=_0x196982(0xee3),_0x322e22[_0x196982(0x1063)]=async _0x33b10d=>{const _0x2f7de9=_0x196982;_0x33b10d[_0x2f7de9(0x748)]();const _0x11e9f3=await _0x1a9e79(_0x2f7de9(0x62b),_0x2f7de9(0x758)+_0x30ad5b[_0x2f7de9(0x564)]+'”吗？',{'confirmButtonClass':_0x2f7de9(0x95a)});_0x11e9f3&&(_0x149da6[_0x2f7de9(0x18a)]['aiAvatarLibrary'][_0x2f7de9(0x118e)](_0x27d04b,0x1),await _0xb81d4e[_0x2f7de9(0x1027)][_0x2f7de9(0x5d0)](_0x149da6),_0x2e76c2());},_0x5dfdf5[_0x196982(0x9f4)](_0x322e22),_0x13b55a[_0x196982(0x9f4)](_0x5dfdf5);});}async function _0x5dcdd(){const _0x460e32=_0x85c4bf,_0x589238=await _0x9a2c09('添加头像',_0x460e32(0x887));if(!_0x589238||!_0x589238['trim']())return;const _0x2d4633=await _0x9a2c09(_0x460e32(0x12f8),_0x460e32(0x393),'','url');if(!_0x2d4633||!_0x2d4633[_0x460e32(0x9c1)]()[_0x460e32(0x591)](_0x460e32(0xc6c))){alert(_0x460e32(0x137b));return;}const _0x3a172b=_0x505390[_0x460e32(0x1027)][_0x505390[_0x460e32(0x233)]];!_0x3a172b[_0x460e32(0x18a)][_0x460e32(0x8c6)]&&(_0x3a172b[_0x460e32(0x18a)][_0x460e32(0x8c6)]=[]),_0x3a172b['settings'][_0x460e32(0x8c6)]['push']({'name':_0x589238['trim'](),'url':_0x2d4633[_0x460e32(0x9c1)]()}),await _0xb81d4e[_0x460e32(0x1027)]['put'](_0x3a172b),_0x2e76c2();}function _0x3edad5(){const _0x236092=_0x85c4bf;document[_0x236092(0x479)](_0x236092(0x1205))[_0x236092(0x9cd)][_0x236092(0x8b6)](_0x236092(0x45a));}function _0x35171f(){const _0x34d65c=_0x85c4bf;if(!_0x505390['activeChatId'])return;const _0x50e5eb=_0x505390[_0x34d65c(0x1027)][_0x505390[_0x34d65c(0x233)]];document[_0x34d65c(0x479)](_0x34d65c(0x7d5))[_0x34d65c(0x97b)]='“'+(_0x50e5eb[_0x34d65c(0x18a)][_0x34d65c(0xf58)]||'我')+_0x34d65c(0x1050),_0x319449(),document['getElementById'](_0x34d65c(0xb2a))['classList'][_0x34d65c(0x807)](_0x34d65c(0x45a));}function _0x319449(){const _0x51fe23=_0x85c4bf,_0x2a95f3=document[_0x51fe23(0x479)](_0x51fe23(0x87c));_0x2a95f3[_0x51fe23(0x3de)]='';const _0x33a3ba=_0x505390['chats'][_0x505390[_0x51fe23(0x233)]],_0x343faf=_0x33a3ba[_0x51fe23(0x18a)]['myAvatarLibrary']||[];if(_0x343faf[_0x51fe23(0x990)]===0x0){_0x2a95f3[_0x51fe23(0x3de)]=_0x51fe23(0xee6);return;}_0x343faf['forEach']((_0x438656,_0x4fc321)=>{const _0x1e5f85=_0x51fe23,_0x5ca41d=document[_0x1e5f85(0xbd5)](_0x1e5f85(0x6c8));_0x5ca41d[_0x1e5f85(0xfd4)]=_0x1e5f85(0xd46),_0x5ca41d['title']=_0x438656[_0x1e5f85(0x564)],_0x5ca41d[_0x1e5f85(0x3de)]=_0x1e5f85(0x29f)+_0x438656[_0x1e5f85(0x5f3)]+_0x1e5f85(0x109f)+_0x438656[_0x1e5f85(0x564)]+_0x1e5f85(0xa8b);const _0x554109=document[_0x1e5f85(0xbd5)](_0x1e5f85(0x6c8));_0x554109['className']='delete-btn',_0x554109[_0x1e5f85(0x3de)]='×',_0x554109[_0x1e5f85(0x10dd)][_0x1e5f85(0x678)]=_0x1e5f85(0xee3),_0x554109[_0x1e5f85(0x1063)]=async _0x372a8a=>{const _0xd7f394=_0x1e5f85;_0x372a8a[_0xd7f394(0x748)]();const _0x5602b6=await _0x1a9e79(_0xd7f394(0x62b),_0xd7f394(0x112f)+_0x438656[_0xd7f394(0x564)]+'”吗？',{'confirmButtonClass':'btn-danger'});_0x5602b6&&(_0x33a3ba['settings'][_0xd7f394(0x846)][_0xd7f394(0x118e)](_0x4fc321,0x1),await _0xb81d4e[_0xd7f394(0x1027)][_0xd7f394(0x5d0)](_0x33a3ba),_0x319449());},_0x5ca41d[_0x1e5f85(0x9f4)](_0x554109),_0x2a95f3[_0x1e5f85(0x9f4)](_0x5ca41d);});}async function _0x302e77(){const _0x5e8a8e=_0x85c4bf,_0x4894d1=await _0x9a2c09(_0x5e8a8e(0x12f8),'请为这个头像起个名字（例如：开心、哭泣）');if(!_0x4894d1||!_0x4894d1['trim']())return;const _0x26867a=await _0x9a2c09(_0x5e8a8e(0x12f8),'请输入头像的图片URL','',_0x5e8a8e(0x5f3));if(!_0x26867a||!_0x26867a[_0x5e8a8e(0x9c1)]()[_0x5e8a8e(0x591)](_0x5e8a8e(0xc6c))){alert('请输入有效的图片URL！');return;}const _0x2d98ee=_0x505390[_0x5e8a8e(0x1027)][_0x505390[_0x5e8a8e(0x233)]];!_0x2d98ee[_0x5e8a8e(0x18a)][_0x5e8a8e(0x846)]&&(_0x2d98ee[_0x5e8a8e(0x18a)]['myAvatarLibrary']=[]),_0x2d98ee[_0x5e8a8e(0x18a)]['myAvatarLibrary'][_0x5e8a8e(0x1a0)]({'name':_0x4894d1[_0x5e8a8e(0x9c1)](),'url':_0x26867a[_0x5e8a8e(0x9c1)]()}),await _0xb81d4e['chats'][_0x5e8a8e(0x5d0)](_0x2d98ee),_0x319449();}async function _0x54038f(_0x417cd1){const _0x29a0d0=_0x85c4bf,_0x2b4371=_0x417cd1[_0x29a0d0(0xfa2)][_0x29a0d0(0xe63)][0x0];if(!_0x2b4371)return;const _0x24ec1e=await new Promise(_0x2f10b5=>{const _0x38f393=_0x29a0d0,_0x3cf180=new FileReader();_0x3cf180[_0x38f393(0x502)]=()=>_0x2f10b5(_0x3cf180[_0x38f393(0x97e)]),_0x3cf180['readAsDataURL'](_0x2b4371);}),_0x5a5215=await _0x9a2c09(_0x29a0d0(0x12b9),_0x29a0d0(0x773));if(!_0x5a5215||!_0x5a5215[_0x29a0d0(0x9c1)]())return;const _0x2f97ac=_0x505390[_0x29a0d0(0x1027)][_0x505390[_0x29a0d0(0x233)]];!_0x2f97ac[_0x29a0d0(0x18a)][_0x29a0d0(0x846)]&&(_0x2f97ac[_0x29a0d0(0x18a)][_0x29a0d0(0x846)]=[]),_0x2f97ac[_0x29a0d0(0x18a)][_0x29a0d0(0x846)][_0x29a0d0(0x1a0)]({'name':_0x5a5215[_0x29a0d0(0x9c1)](),'url':_0x24ec1e}),await _0xb81d4e[_0x29a0d0(0x1027)][_0x29a0d0(0x5d0)](_0x2f97ac),_0x319449(),_0x417cd1['target'][_0x29a0d0(0x4e0)]=null;}async function _0x4786bf(_0x510181){const _0x5bc560=_0x85c4bf,_0x2fd5d8=_0x505390[_0x5bc560(0x1027)][_0x505390[_0x5bc560(0x233)]];if(!_0x2fd5d8)return;const _0x3ec2f4=_0x510181[_0x5bc560(0x9c1)]()[_0x5bc560(0x53e)]('\x0a'),_0x347e8b=[],_0x268068='https://files.catbox.moe/';let _0xdfb64e=0x0;for(const _0x47ec39 of _0x3ec2f4){const _0x2886f3=_0x47ec39[_0x5bc560(0x9c1)]();if(!_0x2886f3||_0x2886f3[_0x5bc560(0x44f)](_0x5bc560(0xc6c))||_0x2886f3[_0x5bc560(0x44f)]('填入'))continue;let _0x37cda6=null,_0xa1972c=null;const _0x4b2150=_0x2886f3[_0x5bc560(0xab4)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x4b2150)_0x37cda6=_0x4b2150[0x1],_0xa1972c=_0x4b2150[0x2];else{const _0x5d38c2=_0x2886f3[_0x5bc560(0x53e)](/\s+/);_0x5d38c2[_0x5bc560(0x990)]>=0x2&&(_0xa1972c=_0x5d38c2[_0x5bc560(0xb47)](),_0x37cda6=_0x5d38c2[_0x5bc560(0x35d)]('\x20'));}_0x37cda6&&_0xa1972c&&_0xa1972c[_0x5bc560(0x44f)]('.')?_0x347e8b['push']({'name':_0x37cda6,'url':_0x268068+_0xa1972c}):_0xdfb64e++;}if(_0xdfb64e>0x0)await _0x1519c8(_0x5bc560(0x4a7),'有\x20'+_0xdfb64e+'\x20行的格式不正确，已被跳过。');if(_0x347e8b[_0x5bc560(0x990)]>0x0){if(!_0x2fd5d8['settings'][_0x5bc560(0x846)])_0x2fd5d8[_0x5bc560(0x18a)][_0x5bc560(0x846)]=[];_0x2fd5d8[_0x5bc560(0x18a)][_0x5bc560(0x846)][_0x5bc560(0x1a0)](..._0x347e8b),await _0xb81d4e[_0x5bc560(0x1027)][_0x5bc560(0x5d0)](_0x2fd5d8),_0x319449(),await _0x1519c8('导入成功',_0x5bc560(0x67e)+_0x347e8b[_0x5bc560(0x990)]+_0x5bc560(0x1393));}else _0xdfb64e===0x0&&alert('没有找到可导入的内容。');}function _0x21a1b8(){const _0x3e1b65=_0x85c4bf;document[_0x3e1b65(0x479)]('my-avatar-library-modal')[_0x3e1b65(0x9cd)][_0x3e1b65(0x8b6)](_0x3e1b65(0x45a));}function _0xb539a6(){const _0x3b8f45=_0x85c4bf;if(!_0x505390[_0x3b8f45(0x233)])return;const _0x2c1f09=_0x505390[_0x3b8f45(0x1027)][_0x505390['activeChatId']];document[_0x3b8f45(0x479)](_0x3b8f45(0x128b))[_0x3b8f45(0x97b)]='“'+_0x2c1f09[_0x3b8f45(0x564)]+_0x3b8f45(0x1050),_0x450c42(),document[_0x3b8f45(0x479)](_0x3b8f45(0xaa4))[_0x3b8f45(0x9cd)][_0x3b8f45(0x807)](_0x3b8f45(0x45a));}function _0x450c42(){const _0x333b2c=_0x85c4bf,_0x48120e=document[_0x333b2c(0x479)](_0x333b2c(0x377));_0x48120e[_0x333b2c(0x3de)]='';const _0x996c1e=_0x505390[_0x333b2c(0x1027)][_0x505390[_0x333b2c(0x233)]],_0x38827b=_0x996c1e['settings']['groupAvatarLibrary']||[];if(_0x38827b[_0x333b2c(0x990)]===0x0){_0x48120e[_0x333b2c(0x3de)]='<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x22>这个头像库还是空的，点击右上角“添加”吧！</p>';return;}_0x38827b[_0x333b2c(0x12be)]((_0x4cface,_0x9ba4f1)=>{const _0x250623=_0x333b2c,_0x485dbe=document[_0x250623(0xbd5)]('div');_0x485dbe[_0x250623(0xfd4)]=_0x250623(0xd46),_0x485dbe['title']=_0x4cface['name'],_0x485dbe[_0x250623(0x3de)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22sticker-image-container\x22\x20style=\x22background-image:\x20url('+_0x4cface[_0x250623(0x5f3)]+_0x250623(0x109f)+_0x4cface[_0x250623(0x564)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';const _0x1cb7ce=document[_0x250623(0xbd5)](_0x250623(0x6c8));_0x1cb7ce[_0x250623(0xfd4)]=_0x250623(0xbbd),_0x1cb7ce[_0x250623(0x3de)]='×',_0x1cb7ce['style'][_0x250623(0x678)]=_0x250623(0xee3),_0x1cb7ce[_0x250623(0x1063)]=async _0x1b31b7=>{const _0x3b0aec=_0x250623;_0x1b31b7['stopPropagation']();const _0x2a833a=await _0x1a9e79('删除头像','确定要从头像库中删除“'+_0x4cface[_0x3b0aec(0x564)]+_0x3b0aec(0x1006),{'confirmButtonClass':_0x3b0aec(0x95a)});_0x2a833a&&(_0x996c1e[_0x3b0aec(0x18a)][_0x3b0aec(0x37f)][_0x3b0aec(0x118e)](_0x9ba4f1,0x1),await _0xb81d4e[_0x3b0aec(0x1027)]['put'](_0x996c1e),_0x450c42());},_0x485dbe['appendChild'](_0x1cb7ce),_0x48120e[_0x250623(0x9f4)](_0x485dbe);});}async function _0x5bc2d8(){const _0x5bd6e3=_0x85c4bf,_0x16d2f8=await _0x9a2c09(_0x5bd6e3(0x12f8),_0x5bd6e3(0x902));if(!_0x16d2f8||!_0x16d2f8['trim']())return;const _0x11e1b0=await _0x9a2c09(_0x5bd6e3(0x12f8),_0x5bd6e3(0x393),'',_0x5bd6e3(0x5f3));if(!_0x11e1b0||!_0x11e1b0[_0x5bd6e3(0x9c1)]()[_0x5bd6e3(0x591)](_0x5bd6e3(0xc6c))){alert(_0x5bd6e3(0x137b));return;}const _0xf70b81=_0x505390[_0x5bd6e3(0x1027)][_0x505390[_0x5bd6e3(0x233)]];!_0xf70b81['settings'][_0x5bd6e3(0x37f)]&&(_0xf70b81[_0x5bd6e3(0x18a)][_0x5bd6e3(0x37f)]=[]),_0xf70b81[_0x5bd6e3(0x18a)][_0x5bd6e3(0x37f)][_0x5bd6e3(0x1a0)]({'name':_0x16d2f8['trim'](),'url':_0x11e1b0[_0x5bd6e3(0x9c1)]()}),await _0xb81d4e[_0x5bd6e3(0x1027)]['put'](_0xf70b81),_0x450c42();}function _0x13d2d4(){const _0x4f00a9=_0x85c4bf;document['getElementById'](_0x4f00a9(0xaa4))[_0x4f00a9(0x9cd)][_0x4f00a9(0x8b6)](_0x4f00a9(0x45a));}async function _0x23bc48(_0x128e00){const _0x14ac22=_0x85c4bf,_0x372039=_0x14ac22(0xbc7),_0x2f1287=await _0x9a2c09(_0x14ac22(0x5c1),_0x372039,'',_0x14ac22(0x1283));_0x2f1287&&_0x2f1287['trim']()&&await _0x2cec47(_0x128e00,_0x2f1287);}async function _0x2cec47(_0x5d8f8f,_0x5023bb){const _0x241cbc=_0x85c4bf,_0x22b0b7=_0x505390[_0x241cbc(0x1027)][_0x505390[_0x241cbc(0x233)]];if(!_0x22b0b7)return;const _0x454388=_0x5023bb[_0x241cbc(0x9c1)]()[_0x241cbc(0x53e)]('\x0a'),_0x43ffc6=[],_0x1c6fcf=_0x241cbc(0x1102);let _0x30bf53=0x0;for(const _0x34637d of _0x454388){const _0x2a57ab=_0x34637d['trim']();if(!_0x2a57ab||_0x2a57ab[_0x241cbc(0x44f)](_0x241cbc(0xc6c))||_0x2a57ab[_0x241cbc(0x44f)]('填入'))continue;let _0x13a6c2=null,_0xea22fc=null;const _0x12530e=_0x2a57ab[_0x241cbc(0xab4)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x12530e)_0x13a6c2=_0x12530e[0x1],_0xea22fc=_0x12530e[0x2];else{const _0x54df1f=_0x2a57ab[_0x241cbc(0x53e)](/\s+/);_0x54df1f[_0x241cbc(0x990)]>=0x2&&(_0xea22fc=_0x54df1f['pop'](),_0x13a6c2=_0x54df1f['join']('\x20'));}_0x13a6c2&&_0xea22fc&&_0xea22fc['includes']('.')?_0x43ffc6[_0x241cbc(0x1a0)]({'name':_0x13a6c2,'url':_0x1c6fcf+_0xea22fc}):(_0x30bf53++,console['warn'](_0x241cbc(0x2f7),_0x2a57ab));}_0x30bf53>0x0&&await _0x1519c8('部分导入失败','有\x20'+_0x30bf53+'\x20行的格式不正确，已被系统跳过。');if(_0x43ffc6[_0x241cbc(0x990)]>0x0){if(_0x5d8f8f==='ai'){if(!_0x22b0b7[_0x241cbc(0x18a)]['aiAvatarLibrary'])_0x22b0b7[_0x241cbc(0x18a)]['aiAvatarLibrary']=[];_0x22b0b7[_0x241cbc(0x18a)][_0x241cbc(0x8c6)][_0x241cbc(0x1a0)](..._0x43ffc6),await _0xb81d4e['chats']['put'](_0x22b0b7),_0x2e76c2();}else{if(_0x5d8f8f===_0x241cbc(0x1224)){if(!_0x22b0b7[_0x241cbc(0x18a)][_0x241cbc(0x37f)])_0x22b0b7['settings'][_0x241cbc(0x37f)]=[];_0x22b0b7[_0x241cbc(0x18a)]['groupAvatarLibrary'][_0x241cbc(0x1a0)](..._0x43ffc6),await _0xb81d4e['chats'][_0x241cbc(0x5d0)](_0x22b0b7),_0x450c42();}}await _0x1519c8('导入成功',_0x241cbc(0x67e)+_0x43ffc6[_0x241cbc(0x990)]+_0x241cbc(0x1393));}else _0x30bf53===0x0&&alert(_0x241cbc(0x6de));}async function _0x489eae(){const _0x3f940f=_0x85c4bf,_0x66a09c=await _0x9a2c09('添加头像','请为这个头像起个名字（例如：春日野餐、学习时间）');if(!_0x66a09c||!_0x66a09c[_0x3f940f(0x9c1)]())return;const _0xf45a41=await _0x9a2c09(_0x3f940f(0x12f8),_0x3f940f(0x393),'',_0x3f940f(0x5f3));if(!_0xf45a41||!_0xf45a41[_0x3f940f(0x9c1)]()[_0x3f940f(0x591)](_0x3f940f(0xc6c))){alert(_0x3f940f(0x137b));return;}const _0x38096e=_0x505390[_0x3f940f(0x1027)][_0x505390[_0x3f940f(0x233)]];!_0x38096e[_0x3f940f(0x18a)]['groupAvatarLibrary']&&(_0x38096e['settings']['groupAvatarLibrary']=[]),_0x38096e[_0x3f940f(0x18a)][_0x3f940f(0x37f)][_0x3f940f(0x1a0)]({'name':_0x66a09c[_0x3f940f(0x9c1)](),'url':_0xf45a41[_0x3f940f(0x9c1)]()}),await _0xb81d4e[_0x3f940f(0x1027)][_0x3f940f(0x5d0)](_0x38096e),_0x450c42();}function _0x3b8d64(_0xa01e11){return new Promise(_0x55bf7d=>{const _0x24ffea=_0x6666,_0x30e56a=document['getElementById'](_0x24ffea(0x245)),_0x1deaf3=document[_0x24ffea(0x479)](_0x24ffea(0x12c5)),_0x18c3b8=document[_0x24ffea(0x479)](_0x24ffea(0x674)),_0x2f69be=document[_0x24ffea(0x479)](_0x24ffea(0xda1));_0x1deaf3['textContent']=_0xa01e11[_0x24ffea(0xe4a)]?'取消置顶':_0x24ffea(0xc58);const _0x3e247b=_0x1deaf3[_0x24ffea(0xbcf)](!![]);_0x1deaf3[_0x24ffea(0x1134)][_0x24ffea(0xf0d)](_0x3e247b,_0x1deaf3),_0x3e247b['onclick']=()=>{const _0x5cfb9d=_0x24ffea;_0x30e56a[_0x5cfb9d(0x9cd)][_0x5cfb9d(0x8b6)](_0x5cfb9d(0x45a)),_0x55bf7d(_0x5cfb9d(0xe88));};const _0x28e2c4=_0x18c3b8[_0x24ffea(0xbcf)](!![]);_0x18c3b8[_0x24ffea(0x1134)]['replaceChild'](_0x28e2c4,_0x18c3b8),_0x28e2c4['onclick']=()=>{const _0x2f56ef=_0x24ffea;_0x30e56a[_0x2f56ef(0x9cd)]['remove'](_0x2f56ef(0x45a)),_0x55bf7d(_0x2f56ef(0x1ea));};const _0xe424fb=_0x2f69be[_0x24ffea(0xbcf)](!![]);_0x2f69be[_0x24ffea(0x1134)][_0x24ffea(0xf0d)](_0xe424fb,_0x2f69be),_0xe424fb['onclick']=()=>{const _0xf958d8=_0x24ffea;_0x30e56a[_0xf958d8(0x9cd)][_0xf958d8(0x8b6)](_0xf958d8(0x45a)),_0x55bf7d(null);},_0x30e56a[_0x24ffea(0x9cd)]['add'](_0x24ffea(0x45a));});}function _0x355635(){const _0x3b94f5=_0x85c4bf,_0x384890=document[_0x3b94f5(0x479)]('character-phone-screen'),_0x15cecd=_0x505390[_0x3b94f5(0x888)][_0x3b94f5(0x77b)];_0x15cecd?_0x384890[_0x3b94f5(0x10dd)][_0x3b94f5(0x13b9)]=_0x3b94f5(0x10d2)+_0x15cecd+')':_0x384890[_0x3b94f5(0x10dd)][_0x3b94f5(0x13b9)]=_0x3b94f5(0x114c);}function _0x1711f7(){const _0x4eec6d=_0x85c4bf;if(!_0x505390[_0x4eec6d(0x888)]['cphoneAppIcons'])return;for(const _0x48983f in _0x505390[_0x4eec6d(0x888)][_0x4eec6d(0x2f6)]){const _0x35846d=document[_0x4eec6d(0x479)](_0x4eec6d(0xc8f)+_0x48983f);_0x35846d&&(_0x35846d[_0x4eec6d(0xa9c)]=_0x505390[_0x4eec6d(0x888)][_0x4eec6d(0x2f6)][_0x48983f]);}}function _0x4679ec(){const _0x576197=_0x85c4bf,_0x1615ac=document['getElementById'](_0x576197(0x262));if(!_0x1615ac)return;_0x1615ac[_0x576197(0x3de)]='';const _0x2e77f3={'qq':'QQ','album':'相册','browser':'浏览器','taobao':'淘宝','memo':'备忘录','diary':'日记','amap':_0x576197(0x9d3),'usage':_0x576197(0xa31),'music':_0x576197(0x47c),'ephone':_0x576197(0x8ae)};for(const _0x260c4c in _0x505390[_0x576197(0x888)][_0x576197(0x2f6)]){const _0x2695e8=_0x505390[_0x576197(0x888)][_0x576197(0x2f6)][_0x260c4c],_0x3a956a=_0x2e77f3[_0x260c4c]||'未知App',_0x11078c=document[_0x576197(0xbd5)]('div');_0x11078c[_0x576197(0xfd4)]=_0x576197(0x44b),_0x11078c['dataset'][_0x576197(0x23b)]=_0x260c4c,_0x11078c[_0x576197(0x3de)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22icon-preview\x22\x20src=\x22'+_0x2695e8+_0x576197(0xa6f)+_0x3a956a+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22change-icon-btn\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x1615ac[_0x576197(0x9f4)](_0x11078c);}}function _0x57595d(){const _0x159f06=_0x85c4bf;if(!_0x505390[_0x159f06(0x888)][_0x159f06(0x12ca)])return;for(const _0xed7453 in _0x505390[_0x159f06(0x888)][_0x159f06(0x12ca)]){const _0x1ac8ee=document[_0x159f06(0x479)]('icon-img-'+_0xed7453);_0x1ac8ee&&(_0x1ac8ee[_0x159f06(0xa9c)]=_0x505390[_0x159f06(0x888)][_0x159f06(0x12ca)][_0xed7453]);}}function _0x2210a4(){const _0x5d77f6=_0x85c4bf,_0x2f06a7=document[_0x5d77f6(0x479)](_0x5d77f6(0x84c));if(!_0x2f06a7)return;_0x2f06a7[_0x5d77f6(0x3de)]='';const _0x2e2191={'qq':'QQ','world-book':'世界书','wallpaper':_0x5d77f6(0x11e3),'renderer':_0x5d77f6(0x2f3),'api-settings':_0x5d77f6(0x11b7),'font':'字体','char-phone':_0x5d77f6(0x3fa),'douban':_0x5d77f6(0xd06),'preset':'预设','tutorial':'教程','werewolf':_0x5d77f6(0xe06),'x':'X'};for(const _0x1533c8 in _0x505390[_0x5d77f6(0x888)][_0x5d77f6(0x12ca)]){const _0x538f66=_0x505390['globalSettings'][_0x5d77f6(0x12ca)][_0x1533c8],_0x216a0e=_0x2e2191[_0x1533c8]||'Cphone',_0x1e8877=document[_0x5d77f6(0xbd5)](_0x5d77f6(0x6c8));_0x1e8877[_0x5d77f6(0xfd4)]=_0x5d77f6(0x44b),_0x1e8877['dataset']['iconId']=_0x1533c8,_0x1e8877[_0x5d77f6(0x3de)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22icon-preview\x22\x20src=\x22'+_0x538f66+'\x22\x20alt=\x22'+_0x216a0e+_0x5d77f6(0x131c),_0x2f06a7[_0x5d77f6(0x9f4)](_0x1e8877);}}function _0x25c787(_0xb390c0){const _0x47c8c7=_0x85c4bf;if(!_0x505390[_0x47c8c7(0x233)])return;const _0x2efc98=_0x505390['chats'][_0x505390['activeChatId']];if(!_0x2efc98||!_0x2efc98[_0x47c8c7(0x7d3)])return;const _0x19ea11=_0x2efc98['history'][_0x47c8c7(0xc0d)](_0x1b8f1d=>_0x1b8f1d[_0x47c8c7(0x12a2)]===_0xb390c0);if(!_0x19ea11||_0x19ea11[_0x47c8c7(0x858)]!==_0x47c8c7(0x131b)){console['error'](_0x47c8c7(0x6d5),_0xb390c0);return;}document[_0x47c8c7(0x479)](_0x47c8c7(0xe04))[_0x47c8c7(0x97b)]=_0x19ea11['source_name']||'文章详情';const _0x5b3b93=document[_0x47c8c7(0x479)](_0x47c8c7(0x534));_0x5b3b93['innerHTML']=_0x47c8c7(0xaeb)+(_0x19ea11[_0x47c8c7(0xc29)]||_0x47c8c7(0xb3c))+_0x47c8c7(0x6f5)+(_0x19ea11[_0x47c8c7(0x6a3)]||'未知')+_0x47c8c7(0x481)+(_0x19ea11[_0x47c8c7(0xac4)]||_0x47c8c7(0xa5c))[_0x47c8c7(0x491)](/\n/g,_0x47c8c7(0x205))+_0x47c8c7(0xbeb),_0x731d5('browser-screen');}function _0x537edf(){const _0x568e7d=_0x85c4bf;_0x731d5(_0x568e7d(0xdeb));}function _0x537edf(){const _0x5c2dbf=_0x85c4bf;_0x731d5(_0x5c2dbf(0xdeb));}function _0xcb3934(){const _0xf93589=_0x85c4bf;if(!_0x505390[_0xf93589(0x233)])return;document[_0xf93589(0x479)]('link-title-input')[_0xf93589(0x4e0)]='',document['getElementById']('link-description-input')[_0xf93589(0x4e0)]='',document[_0xf93589(0x479)]('link-source-input')[_0xf93589(0x4e0)]='',document['getElementById'](_0xf93589(0x5ed))[_0xf93589(0x4e0)]='',document['getElementById'](_0xf93589(0x703))[_0xf93589(0x9cd)][_0xf93589(0x807)](_0xf93589(0x45a));}async function _0x5e567d(){const _0x393ed6=_0x85c4bf;if(!_0x505390[_0x393ed6(0x233)])return;const _0x4b9915=document['getElementById'](_0x393ed6(0x4e8))[_0x393ed6(0x4e0)][_0x393ed6(0x9c1)]();if(!_0x4b9915){alert(_0x393ed6(0x1260));return;}const _0x4df53f=document[_0x393ed6(0x479)](_0x393ed6(0x464))[_0x393ed6(0x4e0)][_0x393ed6(0x9c1)](),_0x31f23c=document[_0x393ed6(0x479)](_0x393ed6(0x353))['value'][_0x393ed6(0x9c1)](),_0x21e03c=document[_0x393ed6(0x479)](_0x393ed6(0x5ed))[_0x393ed6(0x4e0)][_0x393ed6(0x9c1)](),_0x34895e=_0x505390[_0x393ed6(0x1027)][_0x505390[_0x393ed6(0x233)]],_0x5b877d={'role':_0x393ed6(0x4c5),'type':_0x393ed6(0x131b),'timestamp':Date[_0x393ed6(0x12d6)](),'title':_0x4b9915,'description':_0x4df53f,'source_name':_0x31f23c,'content':_0x21e03c,'thumbnail_url':null};_0x34895e[_0x393ed6(0x7d3)][_0x393ed6(0x1a0)](_0x5b877d),await _0xb81d4e[_0x393ed6(0x1027)][_0x393ed6(0x5d0)](_0x34895e),_0x48f5ff(_0x5b877d,_0x34895e),_0x1b7f69(),document[_0x393ed6(0x479)](_0x393ed6(0x703))[_0x393ed6(0x9cd)][_0x393ed6(0x8b6)](_0x393ed6(0x45a));}function _0x4d9aaa(_0x49c9ae,_0x229795){const _0x4643bb=_0x85c4bf;if(!_0x229795||!_0x229795['id'])return[];const _0xea226a=_0x229795['groupId'],_0x3fe867=_0x229795['id'];return _0x49c9ae[_0x4643bb(0x85d)](_0x503aea=>{const _0x20cdde=_0x4643bb;if(_0x503aea[_0x20cdde(0x981)]==='user'){if(_0x503aea[_0x20cdde(0x10db)]&&_0x503aea[_0x20cdde(0x10db)]['length']>0x0)return _0xea226a&&_0x503aea[_0x20cdde(0x10db)]['includes'](_0xea226a);return!![];}if(String(_0x503aea[_0x20cdde(0x981)])[_0x20cdde(0x591)]('npc_')){if(Array[_0x20cdde(0x285)](_0x503aea['visibleTo']))return _0x503aea['visibleTo']['includes'](_0x3fe867);return![];}const _0x99d6f8=_0x505390['chats'][_0x503aea[_0x20cdde(0x981)]];if(!_0x99d6f8)return![];const _0x3b3c9f=_0x99d6f8[_0x20cdde(0x194)],_0x4a431d=_0x3b3c9f&&_0xea226a&&_0x3b3c9f===_0xea226a,_0x2cb59f=!_0x3b3c9f&&!_0xea226a;return _0x4a431d||_0x2cb59f;});}function _0x3d7866(_0x4aa3b9){const _0x289379=_0x85c4bf,_0x3061c0=document[_0x289379(0x479)](_0x289379(0x2e2)),_0x4fc3a3=document['getElementById'](_0x289379(0x26d)),_0x24f1f7=_0x4aa3b9===_0x289379(0xd52);_0x3061c0['classList'][_0x289379(0x2bf)](_0x289379(0x9dd),_0x24f1f7),_0x4fc3a3&&(_0x4fc3a3[_0x289379(0xf7b)]=_0x24f1f7),localStorage[_0x289379(0x3f0)](_0x289379(0xf49),_0x4aa3b9);}function _0x18be33(){const _0x15f68e=_0x85c4bf,_0x3f675d=document[_0x15f68e(0x479)](_0x15f68e(0x26d)),_0x241be3=_0x3f675d['checked']?_0x15f68e(0xd52):_0x15f68e(0x5cc);_0x3d7866(_0x241be3);}function _0x2c061b(){if(!_0x505390['activeChatId'])return;_0x4f7734(),_0x731d5('long-term-memory-screen');}function _0x4f7734(){const _0x180a41=_0x85c4bf,_0x86caaa=document[_0x180a41(0x479)](_0x180a41(0x3b8)),_0x189d9a=_0x505390[_0x180a41(0x1027)][_0x505390['activeChatId']];_0x86caaa[_0x180a41(0x3de)]='';let _0x340566=[];_0x189d9a[_0x180a41(0x9d7)]?_0x189d9a[_0x180a41(0x954)]['forEach'](_0x643a82=>{const _0x150396=_0x180a41,_0x362fbe=_0x505390[_0x150396(0x1027)][_0x643a82['id']];if(_0x362fbe&&_0x362fbe[_0x150396(0x3b4)]){const _0x3e225e=_0x362fbe[_0x150396(0x3b4)][_0x150396(0x2e1)](_0xac43e3=>({..._0xac43e3,'authorName':_0x643a82[_0x150396(0xa54)],'authorChatId':_0x643a82['id']}));_0x340566[_0x150396(0x1a0)](..._0x3e225e);}}):_0x189d9a['longTermMemory']&&(_0x340566=_0x189d9a[_0x180a41(0x3b4)][_0x180a41(0x2e1)](_0x149c24=>({..._0x149c24,'authorName':_0x189d9a['name'],'authorChatId':_0x189d9a['id']})));if(_0x340566['length']===0x0){_0x86caaa[_0x180a41(0x3de)]=_0x180a41(0xae2);return;}_0x340566[_0x180a41(0x382)]((_0x18c8e8,_0x43ac7f)=>_0x43ac7f['timestamp']-_0x18c8e8[_0x180a41(0x12a2)]),_0x340566[_0x180a41(0x12be)]((_0x5548ef,_0x3c1014)=>{const _0x2817a3=_0x180a41,_0x720966=document[_0x2817a3(0xbd5)]('div');_0x720966['className']=_0x2817a3(0xceb),_0x720966[_0x2817a3(0x10dd)]['cursor']=_0x2817a3(0x603),_0x720966[_0x2817a3(0x3de)]=_0x2817a3(0x809)+_0x5548ef[_0x2817a3(0xd7d)]+_0x2817a3(0xf4b)+_0x5548ef[_0x2817a3(0xac4)][_0x2817a3(0x491)](/\n/g,_0x2817a3(0x1043))+_0x2817a3(0x6c0)+_0x5548ef[_0x2817a3(0x963)]+'\x22\x20data-memory-timestamp=\x22'+_0x5548ef[_0x2817a3(0x12a2)]+'\x22\x20title=\x22编辑\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M11\x204H4a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h14a2\x202\x200\x200\x200\x202-2v-7\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M18.5\x202.5a2.121\x202.121\x200\x200\x201\x203\x203L12\x2015l-4\x201\x201-4\x209.5-9.5z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22memory-action-btn\x20delete-memory-btn\x22\x20data-author-id=\x22'+_0x5548ef[_0x2817a3(0x963)]+_0x2817a3(0x3f5)+_0x5548ef[_0x2817a3(0x12a2)]+_0x2817a3(0x825),_0x86caaa[_0x2817a3(0x9f4)](_0x720966);});}async function _0x1dd2cd(){const _0x319ed0=_0x85c4bf,_0x5007c7=_0x505390['chats'][_0x505390[_0x319ed0(0x233)]];if(!_0x5007c7)return;let _0x13e95c=_0x5007c7;if(_0x5007c7[_0x319ed0(0x9d7)]){const _0x39f4a3=_0x5007c7[_0x319ed0(0x954)][_0x319ed0(0x2e1)](_0xfd52b3=>({'text':'为“'+_0xfd52b3[_0x319ed0(0xa54)]+_0x319ed0(0x756),'value':_0xfd52b3['id']})),_0x45fbd0=await _0x5adb5e(_0x319ed0(0xe4f),_0x39f4a3);if(!_0x45fbd0)return;_0x13e95c=_0x505390[_0x319ed0(0x1027)][_0x45fbd0];if(!_0x13e95c){alert(_0x319ed0(0x7bc));return;}}const _0x283c77=await _0x9a2c09('为“'+_0x13e95c['name']+_0x319ed0(0x756),_0x319ed0(0x7ec),'','textarea');if(_0x283c77&&_0x283c77[_0x319ed0(0x9c1)]()){if(!_0x13e95c[_0x319ed0(0x3b4)])_0x13e95c[_0x319ed0(0x3b4)]=[];_0x13e95c['longTermMemory'][_0x319ed0(0x1a0)]({'content':_0x283c77['trim'](),'timestamp':Date['now'](),'source':_0x319ed0(0xc32)}),await _0xb81d4e[_0x319ed0(0x1027)]['put'](_0x13e95c),_0x4f7734();}}async function _0x294f9b(_0x3e39ce,_0x3bcebc){const _0x21b1c0=_0x85c4bf,_0x24a8c1=_0x505390[_0x21b1c0(0x1027)][_0x3e39ce];if(!_0x24a8c1||!_0x24a8c1['longTermMemory'])return;const _0x37cff6=_0x24a8c1[_0x21b1c0(0x3b4)]['findIndex'](_0x440470=>_0x440470[_0x21b1c0(0x12a2)]===_0x3bcebc);if(_0x37cff6===-0x1)return;const _0x46c9ca=_0x24a8c1[_0x21b1c0(0x3b4)][_0x37cff6],_0x39dddb=await _0x9a2c09(_0x21b1c0(0x11c1),_0x21b1c0(0xdcd),_0x46c9ca[_0x21b1c0(0xac4)],_0x21b1c0(0x1283));_0x39dddb&&_0x39dddb[_0x21b1c0(0x9c1)]()&&(_0x46c9ca['content']=_0x39dddb[_0x21b1c0(0x9c1)](),await _0xb81d4e[_0x21b1c0(0x1027)][_0x21b1c0(0x5d0)](_0x24a8c1),_0x4f7734());}async function _0x23c257(_0x1d6b34,_0x2c13df){const _0xf3ae27=_0x85c4bf,_0x5c49c7=await _0x1a9e79(_0xf3ae27(0x587),_0xf3ae27(0x602),{'confirmButtonClass':_0xf3ae27(0x95a)});if(_0x5c49c7){const _0x192506=_0x505390['chats'][_0x1d6b34];if(!_0x192506||!_0x192506[_0xf3ae27(0x3b4)])return;_0x192506[_0xf3ae27(0x3b4)]=_0x192506[_0xf3ae27(0x3b4)][_0xf3ae27(0x85d)](_0x1ac593=>_0x1ac593[_0xf3ae27(0x12a2)]!==_0x2c13df),await _0xb81d4e[_0xf3ae27(0x1027)][_0xf3ae27(0x5d0)](_0x192506),_0x4f7734();}}async function _0x53909a(){const _0x29fdb2=_0x85c4bf,_0x43a771=await _0x1a9e79(_0x29fdb2(0x1c0),_0x29fdb2(0x204));_0x43a771&&await _0x391687(_0x505390[_0x29fdb2(0x233)],!![]);}async function _0x170570(_0x1925ff){const _0xa74aa=_0x85c4bf,_0x475d45=_0x505390[_0xa74aa(0x1027)][_0x1925ff];if(!_0x475d45||!_0x475d45[_0xa74aa(0x18a)][_0xa74aa(0x9e7)])return;const _0x48a18b=_0x475d45['lastMemorySummaryTimestamp']||0x0,_0x3d235c=_0x475d45[_0xa74aa(0x7d3)]['filter'](_0xd8684f=>_0xd8684f[_0xa74aa(0x12a2)]>_0x48a18b&&!_0xd8684f['isHidden']);_0x3d235c[_0xa74aa(0x990)]>=_0x475d45[_0xa74aa(0x18a)][_0xa74aa(0xbfd)]&&(console[_0xa74aa(0x90f)](_0xa74aa(0x7d8)+_0x3d235c['length']+'/'+_0x475d45[_0xa74aa(0x18a)][_0xa74aa(0xbfd)]+_0xa74aa(0x978)),await _0x391687(_0x1925ff));}async function _0x1562d(_0x32b6b9,_0x69f380){const _0x1ed4cd=_0x85c4bf,_0x225fc3=_0x505390['chats'][_0x32b6b9];if(!_0x225fc3||!_0x69f380)throw new Error(_0x1ed4cd(0x4e6));const _0x111e4e=_0x505390[_0x1ed4cd(0x1190)][_0x1ed4cd(0x904)]||'用户';let _0xd3b560,_0x2b501f=_0x225fc3;const _0x575a7e=new Date()[_0x1ed4cd(0xba5)]('zh-CN',{'year':_0x1ed4cd(0x1191),'month':'long','day':_0x1ed4cd(0x1191)});if(_0x225fc3[_0x1ed4cd(0x9d7)]){let _0x16bcb5=null;_0x315a6a[_0x1ed4cd(0x648)]&&(_0x16bcb5=_0x225fc3[_0x1ed4cd(0x954)][_0x1ed4cd(0xc0d)](_0x2a6e70=>_0x2a6e70[_0x1ed4cd(0xe2d)]===_0x315a6a['callRequester']));!_0x16bcb5&&(_0x16bcb5=_0x225fc3[_0x1ed4cd(0x954)][_0x1ed4cd(0xc0d)](_0x523a25=>_0x523a25['id']!==_0x1ed4cd(0x4c5)&&_0x315a6a[_0x1ed4cd(0xf06)][_0x1ed4cd(0x1235)](_0x1b7a60=>_0x1b7a60['id']===_0x523a25['id'])));!_0x16bcb5&&(_0x16bcb5=_0x225fc3[_0x1ed4cd(0x954)]['find'](_0x47a35e=>_0x47a35e['id']!==_0x1ed4cd(0x4c5)));if(!_0x16bcb5)throw new Error(_0x1ed4cd(0x449));const _0x255b4b=_0x505390[_0x1ed4cd(0x1027)][_0x16bcb5['id']];if(!_0x255b4b)throw new Error(_0x1ed4cd(0x94b)+_0x16bcb5[_0x1ed4cd(0xa54)]+_0x1ed4cd(0x7b0));const _0x1396e5=_0x225fc3['settings'][_0x1ed4cd(0x12d7)]||_0x1ed4cd(0xf4d);_0xd3b560='\x0a#\x20你的任务\x0a你就是角色“'+_0x16bcb5[_0x1ed4cd(0xe2d)]+_0x1ed4cd(0x402)+_0x111e4e+_0x1ed4cd(0xda2)+_0x575a7e+_0x1ed4cd(0x13c2)+_0x575a7e+_0x1ed4cd(0xb70)+_0x255b4b[_0x1ed4cd(0x18a)][_0x1ed4cd(0x11f6)]+'\x0a\x0a#\x20你的聊天对象（用户）的人设\x0a'+_0x1396e5+'\x0a\x0a#\x20待总结的群组视频通话记录\x0a'+_0x69f380+'\x0a\x0a现在，请以“'+_0x16bcb5[_0x1ed4cd(0xe2d)]+_0x1ed4cd(0x57a),_0x2b501f=_0x255b4b;}else _0xd3b560='\x0a#\x20你的任务\x0a你就是角色“'+_0x225fc3[_0x1ed4cd(0xe2d)]+_0x1ed4cd(0xefd)+_0x111e4e+_0x1ed4cd(0x509)+_0x575a7e+_0x1ed4cd(0x7d4)+_0x575a7e+_0x1ed4cd(0x1de)+_0x225fc3['settings'][_0x1ed4cd(0x11f6)]+_0x1ed4cd(0x9e6)+_0x225fc3[_0x1ed4cd(0x18a)][_0x1ed4cd(0x12d7)]+'\x0a\x0a#\x20待总结的视频通话记录\x0a'+_0x69f380+'\x0a\x0a现在，请以“'+_0x225fc3[_0x1ed4cd(0xe2d)]+_0x1ed4cd(0x57a);try{const _0x51a03a=_0x505390[_0x1ed4cd(0x30c)][_0x1ed4cd(0xe39)]&&_0x505390[_0x1ed4cd(0x30c)][_0x1ed4cd(0xbf6)]&&_0x505390[_0x1ed4cd(0x30c)]['secondaryModel'],{proxyUrl:_0x218de0,apiKey:_0x552689,model:_0x516336}=_0x51a03a?{'proxyUrl':_0x505390['apiConfig'][_0x1ed4cd(0xe39)],'apiKey':_0x505390[_0x1ed4cd(0x30c)][_0x1ed4cd(0xbf6)],'model':_0x505390[_0x1ed4cd(0x30c)]['secondaryModel']}:_0x505390[_0x1ed4cd(0x30c)];if(!_0x218de0||!_0x552689||!_0x516336)throw new Error('API未配置，无法进行总结。');let _0x2082a0=_0x218de0[_0x1ed4cd(0x44f)](_0x1ed4cd(0x136f)),_0x108c4c=_0x19a701(_0x516336,_0x552689,_0xd3b560,[{'role':_0x1ed4cd(0x4c5),'content':'请开始总结。'}]);const _0x306c0c=_0x2082a0?await fetch(_0x108c4c[_0x1ed4cd(0x5f3)],_0x108c4c['data']):await fetch(_0x218de0+_0x1ed4cd(0x347),{'method':_0x1ed4cd(0xba0),'headers':{'Content-Type':'application/json','Authorization':_0x1ed4cd(0xb27)+_0x552689},'body':JSON['stringify']({'model':_0x516336,'messages':[{'role':'system','content':_0xd3b560},{'role':'user','content':_0x1ed4cd(0x34e)}],'temperature':0.1})});if(!_0x306c0c['ok']){const _0xb4a98c=await _0x306c0c['json']()[_0x1ed4cd(0x575)](()=>({'error':{'message':_0x306c0c[_0x1ed4cd(0xd4a)]}}));throw new Error(_0x1ed4cd(0xf05)+_0x306c0c[_0x1ed4cd(0x93c)]+_0x1ed4cd(0x501)+_0xb4a98c[_0x1ed4cd(0xe3b)][_0x1ed4cd(0x757)]);}const _0x3ff6dd=await _0x306c0c[_0x1ed4cd(0xfdf)]();let _0x315d26=_0x2082a0?getGeminiResponseText(_0x3ff6dd):_0x3ff6dd[_0x1ed4cd(0xd5c)][0x0]['message'][_0x1ed4cd(0xac4)];_0x315d26=_0x315d26[_0x1ed4cd(0x491)](/^```json\s*/,'')[_0x1ed4cd(0x491)](/```$/,'')[_0x1ed4cd(0x9c1)]();const _0x3ffd24=JSON['parse'](_0x315d26);if(_0x3ffd24[_0x1ed4cd(0xc50)]&&_0x3ffd24[_0x1ed4cd(0xc50)][_0x1ed4cd(0x9c1)]()){const _0x36dad4={'content':'(在那次'+(_0x225fc3[_0x1ed4cd(0x9d7)]?'群聊':'')+_0x1ed4cd(0x118d)+_0x3ffd24['summary']['trim']()+')','timestamp':Date[_0x1ed4cd(0x12d6)](),'source':_0x225fc3[_0x1ed4cd(0x9d7)]?_0x1ed4cd(0x1d5):'call_summary'};if(!_0x2b501f[_0x1ed4cd(0x3b4)])_0x2b501f['longTermMemory']=[];return _0x2b501f[_0x1ed4cd(0x3b4)]['push'](_0x36dad4),await _0xb81d4e[_0x1ed4cd(0x1027)][_0x1ed4cd(0x5d0)](_0x2b501f),console[_0x1ed4cd(0x90f)](_0x1ed4cd(0x10fe)+_0x2b501f['name']+_0x1ed4cd(0x70b)),!![];}else throw new Error(_0x1ed4cd(0x542));}catch(_0xc48f51){console[_0x1ed4cd(0xe3b)]('总结通话记录时出错:',_0xc48f51);throw _0xc48f51;}}function _0x47e3be(_0x58d8a4){const _0x504ec6=_0x85c4bf,_0x394080=new Set(['的','是','了','在','我','你','他','她','它','我们','你们','他们','这','那','一个','也','和','与','或','但','然而','所以','因此','就','都','地','得','着','过','吧','吗','呢','啊','哦','嗯','什么','怎么',_0x504ec6(0x9e5),'哪个','一些','这个','那个','还有']),_0x1e6415=_0x58d8a4['match'](/[\u4e00-\u9fa5]+|[a-zA-Z0-9]+/g)||[],_0x4d4723=new Map();let _0x5c2462=0x0;_0x1e6415[_0x504ec6(0x12be)](_0x5288e8=>{const _0x152dbc=_0x504ec6;if(_0x5288e8[_0x152dbc(0x990)]>0x1&&!_0x394080[_0x152dbc(0x391)](_0x5288e8)){const _0x4439d9=(_0x4d4723[_0x152dbc(0x111a)](_0x5288e8)||0x0)+0x1;_0x4d4723[_0x152dbc(0x111b)](_0x5288e8,_0x4439d9);if(_0x4439d9>_0x5c2462)_0x5c2462=_0x4439d9;}});const _0x1fb3a9=[],_0x310d1a=[],_0x52b95b=_0x5c2462*0.9,_0x53e35=_0x5c2462*0.6;_0x4d4723[_0x504ec6(0x12be)]((_0x1bc872,_0x37ab72)=>{const _0x1ac726=_0x504ec6;if(_0x1bc872>=_0x52b95b)_0x1fb3a9[_0x1ac726(0x1a0)](_0x37ab72);else _0x1bc872>=_0x53e35&&_0x310d1a['push'](_0x37ab72);});const _0x4a98d4=new Set(_0x1fb3a9),_0x4f2333=_0x310d1a[_0x504ec6(0x85d)](_0x10b6e5=>!_0x4a98d4[_0x504ec6(0x391)](_0x10b6e5))[_0x504ec6(0x777)](0x0,0x5);return{'coreKeywords':_0x1fb3a9['slice'](0x0,0x3),'situationalKeywords':_0x4f2333};}function _0x37bdc8(_0x4407c5,_0x5c790d,_0x220d1b){const _0x72d4fa=_0x85c4bf;let _0x129193;_0x220d1b===_0x72d4fa(0x129d)?_0x129193=Date[_0x72d4fa(0x12d6)]()-_0x5c790d*0x3c*0x3c*0x3e8:_0x129193=Date[_0x72d4fa(0x12d6)]()-_0x5c790d*0x18*0x3c*0x3c*0x3e8;const _0x11128d=_0x4407c5['history']['filter'](_0x2c3bc2=>_0x2c3bc2[_0x72d4fa(0x12a2)]>_0x129193&&!_0x2c3bc2['isHidden']);if(_0x11128d['length']<0x3)return'';const _0x48d5d2=_0x11128d[_0x72d4fa(0x2e1)](_0x4315e3=>{const _0xb3c18e=_0x72d4fa;if(typeof _0x4315e3[_0xb3c18e(0xac4)]===_0xb3c18e(0x8d9))return _0x4315e3['content'];if(_0x4315e3[_0xb3c18e(0x858)]==='voice_message')return _0x4315e3['content'];if(_0x4315e3[_0xb3c18e(0x858)]===_0xb3c18e(0x124e))return(_0x4315e3['dialogue']||'')+'\x20'+(_0x4315e3[_0xb3c18e(0x78b)]||'');return'';})[_0x72d4fa(0x35d)]('\x20'),_0x5cc089=new Set(['的','是','了','在','我','你','他','她','它','我们','你们','他们','这','那','一个','也','和','与','或','但','然而','所以','因此','就','都','地','得','着','过','吧','吗','呢','啊','哦','嗯']),_0x2d22b0=_0x48d5d2['match'](/[\u4e00-\u9fa5]+|[a-zA-Z0-9]+/g)||[],_0x57872f=new Map();_0x2d22b0[_0x72d4fa(0x12be)](_0x2c9353=>{const _0x50c8f1=_0x72d4fa;_0x2c9353[_0x50c8f1(0x990)]>0x1&&!_0x5cc089[_0x50c8f1(0x391)](_0x2c9353)&&_0x57872f[_0x50c8f1(0x111b)](_0x2c9353,(_0x57872f[_0x50c8f1(0x111a)](_0x2c9353)||0x0)+0x1);});const _0x3ccf84=[..._0x57872f['entries']()][_0x72d4fa(0x382)]((_0x34d4bf,_0x10933e)=>_0x10933e[0x1]-_0x34d4bf[0x1])[_0x72d4fa(0x2e1)](_0x2958ad=>_0x2958ad[0x0]);if(_0x3ccf84[_0x72d4fa(0x990)]===0x0)return'';let _0x53b556;return _0x220d1b===_0x72d4fa(0x129d)?_0x53b556='最近'+_0x5c790d+_0x72d4fa(0x10b0):_0x5c790d===0x1?_0x53b556=_0x72d4fa(0x121b):_0x53b556='最近'+_0x5c790d+'天核心议题',_0x72d4fa(0xe91)+_0x53b556+'**:\x20关于\x20**'+_0x3ccf84[_0x72d4fa(0x777)](0x0,0x3)[_0x72d4fa(0x35d)]('、\x20')+'**。';}function _0x15f3ce(_0x29df54){const _0x121845=_0x85c4bf;if(!_0x29df54||typeof _0x29df54!==_0x121845(0x8d9))return null;const _0x4d6be2=_0x29df54[_0x121845(0x491)](/^```json\s*/,'')[_0x121845(0x491)](/```$/,'')['trim'](),_0x563e14=_0x4d6be2[_0x121845(0xab4)](/{[\s\S]*}/);if(_0x563e14)try{const _0x5e697d=JSON[_0x121845(0x94c)](_0x563e14[0x0]);return console['log']('容错解析：策略1成功\x20(找到并解析了完整的JSON对象)'),_0x5e697d;}catch(_0x236dd8){console['warn'](_0x121845(0x17f));}const _0x12d630=_0x4d6be2[_0x121845(0xab4)](/"summary"\s*:\s*"((?:[^"\\]|\\.)*)"/);if(_0x12d630&&_0x12d630[0x1])return console[_0x121845(0x90f)](_0x121845(0x13e6)),{'summary':_0x12d630[0x1][_0x121845(0x491)](/\\"/g,'\x22')};if(_0x4d6be2)return console[_0x121845(0x90f)](_0x121845(0xe3a)),{'summary':_0x4d6be2};return null;}async function _0x433360(_0x52f7b4){const _0x3cfb75=_0x85c4bf;let _0x26a03f=_0x505390[_0x3cfb75(0x1027)][_0x52f7b4];if(!_0x26a03f)return;let _0x3c341b=_0x26a03f;if(_0x26a03f[_0x3cfb75(0x9d7)]){const _0x5a860a=_0x26a03f[_0x3cfb75(0x954)][_0x3cfb75(0x2e1)](_0x3ddd15=>{const _0x1bb498=_0x3cfb75,_0xe30587=_0x505390[_0x1bb498(0x1027)][_0x3ddd15['id']];if(_0xe30587&&_0xe30587[_0x1bb498(0x3b4)]&&_0xe30587[_0x1bb498(0x3b4)][_0x1bb498(0x990)]>=0x2)return{'text':_0x1bb498(0x6fe)+_0x3ddd15[_0x1bb498(0xa54)]+_0x1bb498(0xb12)+_0xe30587[_0x1bb498(0x3b4)][_0x1bb498(0x990)]+'条)','value':_0x3ddd15['id']};return null;})[_0x3cfb75(0x85d)](Boolean);if(_0x5a860a[_0x3cfb75(0x990)]===0x0){alert('群聊中没有成员有足够（2条以上）的记忆可供精炼。');return;}const _0x373b86=await _0x5adb5e(_0x3cfb75(0x10ca),_0x5a860a);if(!_0x373b86)return;_0x3c341b=_0x505390[_0x3cfb75(0x1027)][_0x373b86];}if(!_0x3c341b['longTermMemory']||_0x3c341b[_0x3cfb75(0x3b4)]['length']<0x2){alert('“'+_0x3c341b[_0x3cfb75(0x564)]+_0x3cfb75(0x8a9));return;}const _0x526582=_0x3c341b[_0x3cfb75(0x3b4)][_0x3cfb75(0x990)],_0x35e691=await _0x5adb5e(_0x3cfb75(0xe1a),[{'text':_0x3cfb75(0x1164)+_0x526582+'条)','value':_0x3cfb75(0xf78)},{'text':_0x3cfb75(0x10eb),'value':'20'},{'text':_0x3cfb75(0xb0e),'value':'50'},{'text':_0x3cfb75(0x3ac),'value':'100'},{'text':'自定义数量...','value':_0x3cfb75(0x13f7)}][_0x3cfb75(0x85d)](_0x58f864=>_0x58f864[_0x3cfb75(0x4e0)]===_0x3cfb75(0xf78)||_0x58f864[_0x3cfb75(0x4e0)]==='custom'||parseInt(_0x58f864[_0x3cfb75(0x4e0)])<_0x526582));if(_0x35e691===null)return;let _0x245118,_0x46b5f6=_0x526582;if(_0x35e691===_0x3cfb75(0xf78))_0x245118=[..._0x3c341b['longTermMemory']];else{if(_0x35e691==='custom'){const _0xcccf47=await _0x9a2c09('自定义数量',_0x3cfb75(0x683)+_0x526582+_0x3cfb75(0x12b8));if(_0xcccf47===null)return;const _0x4a885c=parseInt(_0xcccf47);if(isNaN(_0x4a885c)||_0x4a885c<0x2||_0x4a885c>_0x526582){alert(_0x3cfb75(0x555)+_0x526582+_0x3cfb75(0x9f5));return;}_0x46b5f6=_0x4a885c,_0x245118=_0x3c341b['longTermMemory'][_0x3cfb75(0x777)](-_0x46b5f6);}else _0x46b5f6=parseInt(_0x35e691),_0x46b5f6>=_0x526582?(_0x245118=[..._0x3c341b[_0x3cfb75(0x3b4)]],_0x46b5f6=_0x526582):_0x245118=_0x3c341b[_0x3cfb75(0x3b4)][_0x3cfb75(0x777)](-_0x46b5f6);}const _0x4bd91e=await _0x9a2c09(_0x3cfb75(0x116d),_0x3cfb75(0xb77),_0x3cfb75(0xcf0));if(_0x4bd91e===null)return;const _0x48a1be=parseInt(_0x4bd91e);if(isNaN(_0x48a1be)||_0x48a1be<0x14){alert(_0x3cfb75(0x1062));return;}const _0x3dc252=await _0x1a9e79(_0x3cfb75(0xe19),_0x3cfb75(0xb4d)+_0x46b5f6+'\x20条长期记忆发送给AI，总结成大约\x20'+_0x48a1be+_0x3cfb75(0x5eb),{'confirmButtonClass':_0x3cfb75(0x95a),'confirmText':_0x3cfb75(0x3e6)});if(!_0x3dc252)return;const _0x255d13=_0x245118[_0x3cfb75(0x2e1)](_0x5b28fe=>'-\x20'+_0x5b28fe[_0x3cfb75(0xac4)])[_0x3cfb75(0x35d)]('\x0a'),_0x393611=_0x505390[_0x3cfb75(0x1190)][_0x3cfb75(0x904)]||'用户',_0x5a6acb=new Date()[_0x3cfb75(0xba5)]('zh-CN',{'year':'numeric','month':_0x3cfb75(0x1232),'day':_0x3cfb75(0x1191)}),_0x452031='\x0a#\x20你的任务\x0a你就是角色“'+_0x3c341b[_0x3cfb75(0xe2d)]+'”。请你回顾一下你和“'+_0x393611+_0x3cfb75(0xd74)+_0x5a6acb+_0x3cfb75(0x22d)+_0x5a6acb+_0x3cfb75(0xe21)+_0x48a1be+'\x20字左右**。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x20(必须严格遵守)\x0a'+_0x3c341b[_0x3cfb75(0x18a)]['aiPersona']+'\x0a\x0a#\x20你的聊天对象（用户）的人设\x0a'+_0x3c341b[_0x3cfb75(0x18a)][_0x3cfb75(0x12d7)]+'\x0a\x0a#\x20待整合的记忆要点列表\x0a'+_0x255d13+'\x0a\x0a现在，请以“'+_0x3c341b['originalName']+_0x3cfb75(0x8df);await _0x1519c8('请稍候...',_0x3cfb75(0x43e));try{const _0x3b7b4a=_0x505390[_0x3cfb75(0x30c)]['secondaryProxyUrl']&&_0x505390['apiConfig']['secondaryApiKey']&&_0x505390[_0x3cfb75(0x30c)][_0x3cfb75(0x11ea)],{proxyUrl:_0x5419a1,apiKey:_0x1d9888,model:_0x38bd31}=_0x3b7b4a?{'proxyUrl':_0x505390[_0x3cfb75(0x30c)]['secondaryProxyUrl'],'apiKey':_0x505390['apiConfig'][_0x3cfb75(0xbf6)],'model':_0x505390['apiConfig'][_0x3cfb75(0x11ea)]}:_0x505390[_0x3cfb75(0x30c)];if(!_0x5419a1||!_0x1d9888||!_0x38bd31)throw new Error(_0x3cfb75(0x360));let _0x1ccd39=_0x5419a1[_0x3cfb75(0x44f)](_0x3cfb75(0x136f)),_0x3e5dde=_0x19a701(_0x38bd31,_0x1d9888,_0x452031,[{'role':_0x3cfb75(0x4c5),'content':'请开始整合。'}]);const _0x7facbd=_0x1ccd39?await fetch(_0x3e5dde[_0x3cfb75(0x5f3)],_0x3e5dde[_0x3cfb75(0x104c)]):await fetch(_0x5419a1+_0x3cfb75(0x347),{'method':'POST','headers':{'Content-Type':_0x3cfb75(0xcb5),'Authorization':_0x3cfb75(0xb27)+_0x1d9888},'body':JSON[_0x3cfb75(0x1308)]({'model':_0x38bd31,'messages':[{'role':'system','content':_0x452031},{'role':_0x3cfb75(0x4c5),'content':_0x3cfb75(0x9b5)}],'temperature':0.2})});if(!_0x7facbd['ok'])throw new Error('API\x20错误:\x20'+_0x7facbd[_0x3cfb75(0xd4a)]);const _0x2830cf=await _0x7facbd[_0x3cfb75(0xfdf)]();let _0x567b08=_0x1ccd39?getGeminiResponseText(_0x2830cf):_0x2830cf[_0x3cfb75(0xd5c)][0x0][_0x3cfb75(0x757)]['content'];const _0x382eb8=_0x15f3ce(_0x567b08);if(_0x382eb8&&_0x382eb8['summary']&&typeof _0x382eb8['summary']===_0x3cfb75(0x8d9)&&_0x382eb8['summary'][_0x3cfb75(0x9c1)]()){const _0x1e0acf=await _0x1a9e79('精炼完成，请确认',_0x3cfb75(0xa58)+_0x46b5f6+_0x3cfb75(0xad3)+_0x382eb8[_0x3cfb75(0xc50)][_0x3cfb75(0x9c1)]()+_0x3cfb75(0x1359),{'confirmText':_0x3cfb75(0x2ad),'cancelText':'保留旧的','confirmButtonClass':_0x3cfb75(0x95a)});if(_0x1e0acf){const _0x45a80f={'content':_0x382eb8[_0x3cfb75(0xc50)][_0x3cfb75(0x9c1)](),'timestamp':Date['now'](),'source':'refined'},_0x6eaf4d=_0x526582-_0x46b5f6,_0x272799=_0x6eaf4d>0x0?_0x3c341b[_0x3cfb75(0x3b4)]['slice'](0x0,_0x6eaf4d):[];_0x3c341b[_0x3cfb75(0x3b4)]=[..._0x272799,_0x45a80f],_0x3c341b[_0x3cfb75(0x37a)]=Date[_0x3cfb75(0x12d6)](),await _0xb81d4e['chats']['put'](_0x3c341b),document[_0x3cfb75(0x479)]('long-term-memory-screen')[_0x3cfb75(0x9cd)]['contains'](_0x3cfb75(0x5a9))&&_0x4f7734(),await _0x1519c8('精炼成功','已成功将\x20'+_0x46b5f6+_0x3cfb75(0xc23));}else await _0x1519c8('操作已取消',_0x3cfb75(0x3f1));}else throw new Error('AI返回了空的或格式不正确的总结内容。');}catch(_0x18589e){console[_0x3cfb75(0xe3b)]('精炼长期记忆时出错:',_0x18589e),await _0x1519c8(_0x3cfb75(0x23a),_0x3cfb75(0x130d)+_0x18589e[_0x3cfb75(0x757)]);}}async function _0x391687(_0x16e162,_0x1df4e5=![]){const _0x27b358=_0x85c4bf,_0x25b5ec=_0x505390['chats'][_0x16e162];if(!_0x25b5ec)return;const _0x5d682c=_0x25b5ec[_0x27b358(0x37a)]||0x0,_0x556956=_0x1df4e5?_0x25b5ec['history']['filter'](_0xc9aca6=>!_0xc9aca6[_0x27b358(0xb9c)]||_0xc9aca6['role']===_0x27b358(0xbaa)&&_0xc9aca6[_0x27b358(0xac4)][_0x27b358(0x44f)]('内心独白'))[_0x27b358(0x777)](-(_0x25b5ec[_0x27b358(0x18a)][_0x27b358(0xbfd)]||0x14)):_0x25b5ec[_0x27b358(0x7d3)][_0x27b358(0x85d)](_0x2689ba=>_0x2689ba['timestamp']>_0x5d682c&&(!_0x2689ba[_0x27b358(0xb9c)]||_0x2689ba['role']===_0x27b358(0xbaa)&&_0x2689ba[_0x27b358(0xac4)][_0x27b358(0x44f)]('内心独白')));if(_0x556956[_0x27b358(0x990)]<0x5){if(_0x1df4e5)alert(_0x27b358(0x500));return;}const _0x5cce74=_0x505390[_0x27b358(0x1190)][_0x27b358(0x904)]||'用户',_0x27b914=_0x556956[_0x27b358(0x2e1)](_0x282331=>{const _0x554468=_0x27b358;if(_0x282331[_0x554468(0xb9c)]&&_0x282331['role']===_0x554468(0xbaa)&&_0x282331[_0x554468(0xac4)][_0x554468(0x44f)](_0x554468(0x811)))return _0x282331[_0x554468(0xac4)];let _0x2b637a;_0x282331[_0x554468(0x508)]===_0x554468(0x4c5)?_0x2b637a=_0x5cce74:_0x2b637a=_0x282331['senderName']||_0x25b5ec[_0x554468(0xe2d)];let _0x25d21f='';if(_0x282331[_0x554468(0x858)]===_0x554468(0x124e)){if(_0x282331[_0x554468(0xac4)])_0x25d21f=_0x282331[_0x554468(0xac4)];else{const _0x1f0755=_0x282331['dialogue']?'「'+_0x282331[_0x554468(0xfba)]+'」':'',_0x5d44af=_0x282331[_0x554468(0x78b)]?'('+_0x282331['description']+')':'';_0x25d21f=(_0x1f0755+'\x20'+_0x5d44af)[_0x554468(0x9c1)]();}}else _0x25d21f=String(_0x282331[_0x554468(0xac4)]);return _0x2b637a+':\x20'+_0x25d21f;})[_0x27b358(0x35d)]('\x0a');let _0x507fdd;if(_0x25b5ec[_0x27b358(0x9d7)])_0x507fdd='\x0a#\x20你的任务\x0a你是一个高级的“记忆分配专家”。你的任务是阅读下面的群聊记录，并为【每一个参与的AI角色】生成一段【个性化的、第一人称】的长期记忆。\x0a#\x20核心规则\x0a1.\x20\x20**视角铁律**:\x20每一条总结都【必须】使用【第一人称视角\x20(\x22我\x22)】。\x0a2.\x20\x20**内容核心**:\x20重点总结：我说过的话、我做过的事、别人对我说的话、与我相关的事、以及对我个人很重要的群聊事件、关键信息和心理活动。\x0a3.\x20\x20**【简洁性铁律】**:\x20每条个人记忆总结【绝对不能超过60个字】。\x0a4.\x20\x20**【省略规则】**:\x20如果一个角色在本次对话中【完全没有参与或提及】，你可以省略TA的记忆。\x0a5.\x20\x20**输出格式**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22summaries\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22角色的本名A\x22:\x20\x22我今天在群里和大家讨论了电影，感觉很开心。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22角色的本名B\x22:\x20\x22我在群里和'+_0x5cce74+_0x27b358(0x38d)+_0x27b914+_0x27b358(0x1076)+_0x25b5ec[_0x27b358(0x954)][_0x27b358(0x2e1)](_0x564bd4=>'-\x20'+_0x564bd4[_0x27b358(0xa54)]+'\x20(本名:\x20'+_0x564bd4[_0x27b358(0xe2d)]+')')[_0x27b358(0x35d)]('\x0a')+_0x27b358(0x6bb);else{const _0x143956=new Date()[_0x27b358(0xba5)]('zh-CN',{'year':_0x27b358(0x1191),'month':'long','day':'numeric'});_0x507fdd='\x0a#\x20你的任务\x0a你就是角色“'+_0x25b5ec['originalName']+'”。请你回顾一下刚才和“'+_0x5cce74+_0x27b358(0xf5e)+_0x143956+_0x27b358(0x7b4)+_0x143956+_0x27b358(0x13d3)+new Date(Date[_0x27b358(0x12d6)]()+0x5265c00)[_0x27b358(0xba5)]('zh-CN',{'month':_0x27b358(0x1232),'day':'numeric'})+_0x27b358(0x417)+_0x25b5ec[_0x27b358(0x18a)]['aiPersona']+_0x27b358(0x378)+_0x25b5ec['settings'][_0x27b358(0x12d7)]+_0x27b358(0xde5)+_0x27b914+_0x27b358(0xc3b)+_0x25b5ec['originalName']+_0x27b358(0x57a);}try{const _0x457f0a=_0x505390[_0x27b358(0x30c)][_0x27b358(0xe39)]&&_0x505390['apiConfig'][_0x27b358(0xbf6)]&&_0x505390['apiConfig'][_0x27b358(0x11ea)],{proxyUrl:_0x469a83,apiKey:_0x22f73a,model:_0x329d8b}=_0x457f0a?{'proxyUrl':_0x505390['apiConfig'][_0x27b358(0xe39)],'apiKey':_0x505390[_0x27b358(0x30c)][_0x27b358(0xbf6)],'model':_0x505390[_0x27b358(0x30c)]['secondaryModel']}:_0x505390[_0x27b358(0x30c)];if(!_0x469a83||!_0x22f73a||!_0x329d8b)throw new Error(_0x27b358(0x34f));let _0x337f3f=_0x469a83['includes'](_0x27b358(0x136f)),_0x235787=_0x19a701(_0x329d8b,_0x22f73a,_0x507fdd,[{'role':_0x27b358(0x4c5),'content':_0x27b358(0x34e)}]);const _0x47780e=_0x337f3f?await fetch(_0x235787[_0x27b358(0x5f3)],_0x235787[_0x27b358(0x104c)]):await fetch(_0x469a83+'/v1/chat/completions',{'method':_0x27b358(0xba0),'headers':{'Content-Type':_0x27b358(0xcb5),'Authorization':'Bearer\x20'+_0x22f73a},'body':JSON[_0x27b358(0x1308)]({'model':_0x329d8b,'messages':[{'role':_0x27b358(0xbaa),'content':_0x507fdd},{'role':_0x27b358(0x4c5),'content':'请开始总结。'}],'temperature':0.2})});if(!_0x47780e['ok'])throw new Error('API\x20错误:\x20'+_0x47780e['statusText']);const _0x3783a7=await _0x47780e['json']();let _0x3050cb=_0x337f3f?getGeminiResponseText(_0x3783a7):_0x3783a7[_0x27b358(0xd5c)][0x0][_0x27b358(0x757)][_0x27b358(0xac4)];_0x3050cb=_0x3050cb[_0x27b358(0x491)](/^```json\s*/,'')[_0x27b358(0x491)](/```$/,'')[_0x27b358(0x9c1)]();const _0xa82987=JSON[_0x27b358(0x94c)](_0x3050cb);if(_0x25b5ec[_0x27b358(0x9d7)]){if(_0xa82987['summaries']&&typeof _0xa82987[_0x27b358(0x8ff)]===_0x27b358(0x65a)){let _0x4c53bd=0x0;for(const _0x19ab4d in _0xa82987[_0x27b358(0x8ff)]){const _0x5c50=_0xa82987['summaries'][_0x19ab4d];if(_0x5c50&&_0x5c50['trim']()){const _0x527b70=Object[_0x27b358(0x3d5)](_0x505390[_0x27b358(0x1027)])[_0x27b358(0xc0d)](_0x3d02fe=>_0x3d02fe[_0x27b358(0xe2d)]===_0x19ab4d);if(_0x527b70){const _0x21647e={'content':_0x5c50['trim'](),'timestamp':Date[_0x27b358(0x12d6)](),'source':_0x27b358(0x2e0)+_0x25b5ec['name']};if(!_0x527b70[_0x27b358(0x3b4)])_0x527b70[_0x27b358(0x3b4)]=[];_0x527b70[_0x27b358(0x3b4)]['push'](_0x21647e),await _0xb81d4e[_0x27b358(0x1027)][_0x27b358(0x5d0)](_0x527b70),_0x4c53bd++;}}}if(_0x4c53bd>0x0)console[_0x27b358(0x90f)]('自动总结成功：为\x20'+_0x4c53bd+_0x27b358(0xe7a));else throw new Error('AI返回了空的或格式不正确的总结内容。');}else throw new Error(_0x27b358(0x13d5));}else{if(_0xa82987[_0x27b358(0xc50)]&&_0xa82987['summary'][_0x27b358(0x9c1)]()){const _0x2a1adb={'content':_0xa82987['summary']['trim'](),'timestamp':Date[_0x27b358(0x12d6)](),'source':_0x27b358(0x260)};_0x25b5ec['longTermMemory']['push'](_0x2a1adb),await _0xb81d4e[_0x27b358(0x1027)][_0x27b358(0x5d0)](_0x25b5ec),console[_0x27b358(0x90f)](_0x27b358(0x6c9));}else throw new Error(_0x27b358(0x542));}_0x25b5ec[_0x27b358(0x37a)]=_0x556956[_0x27b358(0x777)](-0x1)[0x0][_0x27b358(0x12a2)],await _0xb81d4e[_0x27b358(0x1027)][_0x27b358(0x5d0)](_0x25b5ec),document['getElementById'](_0x27b358(0x839))[_0x27b358(0x9cd)][_0x27b358(0x658)](_0x27b358(0x5a9))&&_0x4f7734();}catch(_0x2fde70){console[_0x27b358(0xe3b)]('总结长期记忆时出错:',_0x2fde70),await _0x1519c8(_0x27b358(0x1051),_0x27b358(0x10c9)+_0x2fde70[_0x27b358(0x757)]);}}function _0x1a9111(){const _0x17ed50=_0x85c4bf;if(!_0x45dd47)return;const _0x374de=_0x505390[_0x17ed50(0x1027)][_0x505390[_0x17ed50(0x233)]],_0x22f12d=_0x374de['history'][_0x17ed50(0xc0d)](_0x1c9e70=>_0x1c9e70[_0x17ed50(0x12a2)]===_0x45dd47);if(!_0x22f12d)return;let _0xf101b2;_0x22f12d[_0x17ed50(0x508)]===_0x17ed50(0x4c5)?_0xf101b2=_0x374de[_0x17ed50(0x9d7)]?_0x374de[_0x17ed50(0x18a)][_0x17ed50(0xf58)]||'我':'我':_0x374de[_0x17ed50(0x9d7)]?_0xf101b2=_0x503999(_0x374de,_0x22f12d[_0x17ed50(0xdcc)]):_0xf101b2=_0x374de[_0x17ed50(0x564)];const _0x26bb33=String(_0x22f12d[_0x17ed50(0xac4)]||'');let _0x3803ba='';if(typeof _0x22f12d['content']===_0x17ed50(0x8d9)&&_0x554a0b[_0x17ed50(0x101d)](_0x22f12d[_0x17ed50(0xac4)]))_0x3803ba=_0x17ed50(0xa6d);else{if(_0x22f12d[_0x17ed50(0x858)]===_0x17ed50(0x135a)||_0x22f12d[_0x17ed50(0x858)]==='user_photo')_0x3803ba='[图片]';else _0x22f12d[_0x17ed50(0x858)]==='voice_message'?_0x3803ba='[语音]':_0x3803ba=_0x26bb33[_0x17ed50(0x1323)](0x0,0x32)+(_0x26bb33[_0x17ed50(0x990)]>0x32?_0x17ed50(0x4d0):'');}_0x213dd3={'timestamp':_0x22f12d[_0x17ed50(0x12a2)],'senderName':_0xf101b2,'content':_0x26bb33};const _0xda52cf=document[_0x17ed50(0x479)](_0x17ed50(0x1028));_0xda52cf[_0x17ed50(0x8bc)](_0x17ed50(0x19b))['textContent']=_0x17ed50(0xce5)+_0x213dd3['senderName']+':',_0xda52cf[_0x17ed50(0x8bc)](_0x17ed50(0x307))['textContent']=_0x3803ba,_0xda52cf[_0x17ed50(0x10dd)]['display']=_0x17ed50(0xee3),_0x499597(),document[_0x17ed50(0x479)](_0x17ed50(0x706))[_0x17ed50(0xc07)]();}function _0x4388b3(){const _0x26a8a1=_0x85c4bf;_0x213dd3=null,document[_0x26a8a1(0x479)](_0x26a8a1(0x1028))[_0x26a8a1(0x10dd)]['display']=_0x26a8a1(0xff8);}let _0x4124ff=null;function _0x196d69(_0x151258){const _0x25532c=_0x85c4bf;_0x4124ff=_0x151258;const _0x435bb3=_0x505390['chats'][_0x505390[_0x25532c(0x233)]],_0x42d880=_0x435bb3[_0x25532c(0x7d3)]['find'](_0x2a1e39=>_0x2a1e39[_0x25532c(0x12a2)]===_0x151258);_0x42d880&&(document[_0x25532c(0x479)]('transfer-sender-name')[_0x25532c(0x97b)]=_0x42d880['senderName']),document[_0x25532c(0x479)](_0x25532c(0x538))[_0x25532c(0x9cd)][_0x25532c(0x807)]('visible');}function _0xccdc91(){const _0x2d6a7a=_0x85c4bf;document[_0x2d6a7a(0x479)]('transfer-actions-modal')[_0x2d6a7a(0x9cd)][_0x2d6a7a(0x8b6)](_0x2d6a7a(0x45a)),_0x4124ff=null;}async function _0x5b9a92(_0x3567e6){const _0x229f22=_0x85c4bf;if(!_0x4124ff)return;const _0x3aa207=_0x4124ff,_0x11088d=_0x505390['chats'][_0x505390['activeChatId']],_0x478e92=_0x11088d[_0x229f22(0x7d3)][_0x229f22(0x120c)](_0x218316=>_0x218316[_0x229f22(0x12a2)]===_0x3aa207);if(_0x478e92===-0x1)return;const _0x27f0c6=_0x11088d[_0x229f22(0x7d3)][_0x478e92];_0x27f0c6[_0x229f22(0x93c)]=_0x3567e6;let _0x41e441;if(_0x3567e6===_0x229f22(0xe4b)){const _0x1f710d={'role':'user','type':'transfer','isRefund':!![],'amount':_0x27f0c6[_0x229f22(0xc5c)],'note':_0x229f22(0x12cc),'timestamp':Date[_0x229f22(0x12d6)]()};_0x11088d[_0x229f22(0x7d3)]['push'](_0x1f710d),_0x41e441=_0x229f22(0x1217)+_0x27f0c6[_0x229f22(0xdcc)]+'”的转账。]';}else _0x41e441=_0x229f22(0x11f4)+_0x27f0c6[_0x229f22(0xdcc)]+_0x229f22(0x33f);const _0x1179b5={'role':_0x229f22(0xbaa),'content':_0x41e441,'timestamp':Date['now']()+0x1,'isHidden':!![]};_0x11088d[_0x229f22(0x7d3)][_0x229f22(0x1a0)](_0x1179b5),await _0xb81d4e[_0x229f22(0x1027)][_0x229f22(0x5d0)](_0x11088d),_0xccdc91(),_0x474d6b(_0x505390[_0x229f22(0x233)]),_0x1b7f69();}async function _0xfd273f(){const _0x3fd78d=_0x85c4bf;_0x731d5(_0x3fd78d(0x109b));const _0x4d8ae8=document[_0x3fd78d(0x479)](_0x3fd78d(0x1315)),_0x219c8c=document[_0x3fd78d(0x479)](_0x3fd78d(0x60f));_0x4d8ae8[_0x3fd78d(0x3de)]='',_0x219c8c[_0x3fd78d(0x97b)]=_0x3fd78d(0x252);const _0x430414=await _0xb81d4e[_0x3fd78d(0x52e)]['orderBy']('timestamp')[_0x3fd78d(0x336)]()[_0x3fd78d(0x4ba)]();if(_0x430414['length']===0x0){_0x4d8ae8[_0x3fd78d(0x3de)]=_0x3fd78d(0x2a3);return;}_0x430414['forEach'](_0x2bcab0=>{const _0x5490b6=_0x22b616(_0x2bcab0);_0x33282f(_0x5490b6,async()=>{const _0x63d7b6=_0x6666,_0x19db6e=await _0x9a2c09(_0x63d7b6(0x979),_0x63d7b6(0x11d9),_0x2bcab0[_0x63d7b6(0xdab)]||'');if(_0x19db6e===null)return;await _0xb81d4e['callRecords'][_0x63d7b6(0xeb2)](_0x2bcab0['id'],{'customName':_0x19db6e['trim']()}),await _0xfd273f(),await _0x1519c8('成功',_0x63d7b6(0x431));}),_0x4d8ae8['appendChild'](_0x5490b6);});}function _0x22b616(_0x30a992){const _0xf97ca=_0x85c4bf,_0x5a8c81=document[_0xf97ca(0xbd5)](_0xf97ca(0x6c8));_0x5a8c81[_0xf97ca(0xfd4)]=_0xf97ca(0x68a),_0x5a8c81['dataset'][_0xf97ca(0xe29)]=_0x30a992['id'];const _0x1e5b86=_0x505390[_0xf97ca(0x1027)][_0x30a992['chatId']],_0x5d918b=_0x1e5b86?_0x1e5b86[_0xf97ca(0x564)]:'未知会话',_0x1f205f=new Date(_0x30a992[_0xf97ca(0x12a2)]),_0xefa20c=_0x1f205f['getFullYear']()+'-'+String(_0x1f205f[_0xf97ca(0x180)]()+0x1)[_0xf97ca(0x738)](0x2,'0')+'-'+String(_0x1f205f[_0xf97ca(0x469)]())[_0xf97ca(0x738)](0x2,'0')+'\x20'+String(_0x1f205f[_0xf97ca(0x507)]())[_0xf97ca(0x738)](0x2,'0')+':'+String(_0x1f205f[_0xf97ca(0x28c)]())[_0xf97ca(0x738)](0x2,'0'),_0x4bb215=Math[_0xf97ca(0xd71)](_0x30a992[_0xf97ca(0x9d6)]/0x3c)+'分'+_0x30a992[_0xf97ca(0x9d6)]%0x3c+'秒',_0x311630=_0x30a992[_0xf97ca(0xf06)]['map'](_0x7088b=>'<img\x20src=\x22'+_0x7088b[_0xf97ca(0x799)]+_0xf97ca(0xa6f)+_0x7088b[_0xf97ca(0x564)]+_0xf97ca(0xcc8)+_0x7088b[_0xf97ca(0x564)]+'\x22>')[_0xf97ca(0x35d)]('');return _0x5a8c81['innerHTML']=_0xf97ca(0xa24)+_0xefa20c+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22duration\x22>'+_0x4bb215+_0xf97ca(0x1b3)+(_0x30a992[_0xf97ca(0xdab)]?_0xf97ca(0x983)+_0x30a992[_0xf97ca(0xdab)]+_0xf97ca(0x2c3):'')+_0xf97ca(0xb09)+_0x311630+_0xf97ca(0xba1)+_0x5d918b+_0xf97ca(0x705),_0x5a8c81;}async function _0x52514e(_0x1713ba){const _0x2f3fed=_0x85c4bf,_0x2aacdd=await _0xb81d4e['callRecords'][_0x2f3fed(0x111a)](_0x1713ba);if(!_0x2aacdd)return;const _0xe44f52=document[_0x2f3fed(0x479)]('call-transcript-modal'),_0x528f12=document['getElementById'](_0x2f3fed(0xc6b)),_0x5e2264=document[_0x2f3fed(0x479)](_0x2f3fed(0x132f));_0x528f12[_0x2f3fed(0x97b)]='通话于\x20'+new Date(_0x2aacdd['timestamp'])[_0x2f3fed(0x119c)]()+_0x2f3fed(0x304)+Math[_0x2f3fed(0xd71)](_0x2aacdd[_0x2f3fed(0x9d6)]/0x3c)+'分'+_0x2aacdd[_0x2f3fed(0x9d6)]%0x3c+'秒)',_0x5e2264['innerHTML']='';const _0x2b7cde=document['getElementById'](_0x2f3fed(0x660)),_0x76bee1=document[_0x2f3fed(0x479)]('manual-summarize-btn');!_0x2aacdd[_0x2f3fed(0x2f9)]||_0x2aacdd[_0x2f3fed(0x2f9)][_0x2f3fed(0x990)]===0x0?(_0x5e2264['innerHTML']=_0x2f3fed(0x107f),_0x76bee1[_0x2f3fed(0x10dd)][_0x2f3fed(0x678)]=_0x2f3fed(0xff8)):(_0x76bee1['style']['display']=_0x2f3fed(0xee3),_0x2aacdd[_0x2f3fed(0x2f9)][_0x2f3fed(0x12be)](_0x5c4416=>{const _0x54e0d7=_0x2f3fed,_0xfef25c=document[_0x54e0d7(0xbd5)]('div');_0xfef25c['className']=_0x54e0d7(0x9b4)+_0x5c4416[_0x54e0d7(0x508)],_0xfef25c[_0x54e0d7(0x97b)]=_0x5c4416[_0x54e0d7(0xac4)],_0x5e2264[_0x54e0d7(0x9f4)](_0xfef25c);}));const _0xdcd43f=_0x2b7cde[_0x2f3fed(0xbcf)](!![]);_0x2b7cde['parentNode'][_0x2f3fed(0xf0d)](_0xdcd43f,_0x2b7cde);const _0x2fbaa0=_0x76bee1[_0x2f3fed(0xbcf)](!![]);_0x76bee1[_0x2f3fed(0x1134)][_0x2f3fed(0xf0d)](_0x2fbaa0,_0x76bee1),_0xdcd43f[_0x2f3fed(0xa75)]('click',async()=>{const _0xfd9249=_0x2f3fed,_0x56e04a=await _0x1a9e79(_0xfd9249(0x587),_0xfd9249(0x1d3),{'confirmButtonClass':_0xfd9249(0x95a)});_0x56e04a&&(_0xe44f52[_0xfd9249(0x9cd)]['remove'](_0xfd9249(0x45a)),await _0xb81d4e[_0xfd9249(0x52e)][_0xfd9249(0x1ea)](_0x1713ba),await _0xfd273f(),alert(_0xfd9249(0xb1d)));}),_0x2fbaa0[_0x2f3fed(0xa75)](_0x2f3fed(0xd2f),async()=>{const _0x48f1b3=_0x2f3fed,_0x174754=await _0x1a9e79(_0x48f1b3(0x1c0),_0x48f1b3(0x345),{'confirmText':'确认总结'});if(!_0x174754)return;_0xe44f52[_0x48f1b3(0x9cd)][_0x48f1b3(0x8b6)](_0x48f1b3(0x45a));const _0x969bf4=_0x505390['chats'][_0x2aacdd[_0x48f1b3(0xd4e)]];if(!_0x969bf4){alert(_0x48f1b3(0x498));return;}await _0x1519c8(_0x48f1b3(0xbd7),_0x48f1b3(0xe4e));try{const _0x341442=_0x2aacdd[_0x48f1b3(0x2f9)][_0x48f1b3(0x2e1)](_0x43b02b=>{const _0x185350=_0x48f1b3,_0x2a155e=_0x43b02b[_0x185350(0x508)]===_0x185350(0x4c5)?_0x969bf4[_0x185350(0x18a)][_0x185350(0xf58)]||'我':_0x43b02b[_0x185350(0xdcc)]||_0x969bf4[_0x185350(0x564)];return _0x2a155e+':\x20'+_0x43b02b[_0x185350(0xac4)];})[_0x48f1b3(0x35d)]('\x0a');await _0x1562d(_0x2aacdd[_0x48f1b3(0xd4e)],_0x341442),await _0x1519c8(_0x48f1b3(0x1f9),_0x48f1b3(0x1c3)+_0x969bf4[_0x48f1b3(0x564)]+_0x48f1b3(0x70b));}catch(_0x865cb6){await _0x1519c8(_0x48f1b3(0x1051),_0x48f1b3(0x1144)+_0x865cb6[_0x48f1b3(0x757)]);}});const _0xf5b298=document[_0x2f3fed(0x479)](_0x2f3fed(0x86c)),_0x370d5d=_0xf5b298[_0x2f3fed(0xbcf)](!![]);_0xf5b298['parentNode'][_0x2f3fed(0xf0d)](_0x370d5d,_0xf5b298),_0x370d5d[_0x2f3fed(0xa75)](_0x2f3fed(0xd2f),()=>{const _0x1d84fe=_0x2f3fed;_0xe44f52[_0x1d84fe(0x9cd)][_0x1d84fe(0x8b6)](_0x1d84fe(0x45a));}),_0xe44f52[_0x2f3fed(0x9cd)]['add'](_0x2f3fed(0x45a));}async function _0x1008e7(){const _0x268fca=_0x85c4bf;if(!_0x505390[_0x268fca(0x233)]||_0x505390[_0x268fca(0x1027)][_0x505390['activeChatId']][_0x268fca(0x9d7)])return;const _0x51c61b=_0x505390[_0x268fca(0x1027)][_0x505390['activeChatId']],_0x1a612b=await _0x9a2c09(_0x268fca(0x1234),_0x268fca(0xacc),_0x51c61b[_0x268fca(0x93c)][_0x268fca(0x56d)]);_0x1a612b!==null&&(_0x51c61b['status'][_0x268fca(0x56d)]=_0x1a612b[_0x268fca(0x9c1)]()||'在线',_0x51c61b[_0x268fca(0x93c)][_0x268fca(0xfc8)]=![],_0x51c61b[_0x268fca(0x93c)]['lastUpdate']=Date[_0x268fca(0x12d6)](),await _0xb81d4e[_0x268fca(0x1027)][_0x268fca(0x5d0)](_0x51c61b),_0x474d6b(_0x505390['activeChatId']),_0x1b7f69(),await _0x1519c8(_0x268fca(0x5fd),'“'+_0x51c61b[_0x268fca(0x564)]+'”的当前状态已更新为：'+_0x51c61b['status'][_0x268fca(0x56d)]));}async function _0x139293(){const _0xa34d56=_0x85c4bf,_0x17f8ec=document['getElementById'](_0xa34d56(0x608)),_0x8adb1f=document[_0xa34d56(0x479)](_0xa34d56(0x787));_0x8adb1f[_0xa34d56(0x3de)]='';const _0x201ff0=Object[_0xa34d56(0x3d5)](_0x505390[_0xa34d56(0x1027)]);_0x201ff0['forEach'](_0xcbdb4b=>{const _0x4e510e=_0xa34d56,_0x5f65f0=document[_0x4e510e(0xbd5)](_0x4e510e(0x6c8));_0x5f65f0[_0x4e510e(0xfd4)]=_0x4e510e(0xf47),_0x5f65f0[_0x4e510e(0x3de)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22share-target-checkbox\x22\x20data-chat-id=\x22'+_0xcbdb4b['id']+_0x4e510e(0x2de)+(_0xcbdb4b[_0x4e510e(0x9d7)]?_0xcbdb4b[_0x4e510e(0x18a)][_0x4e510e(0x67c)]:_0xcbdb4b[_0x4e510e(0x18a)][_0x4e510e(0x1039)]||_0x28c106)+_0x4e510e(0x855)+_0xcbdb4b[_0x4e510e(0x564)]+_0x4e510e(0x114e),_0x8adb1f[_0x4e510e(0x9f4)](_0x5f65f0);}),_0x17f8ec['classList']['add'](_0xa34d56(0x45a));}function _0x4a7289(_0x30906e){const _0x17c677=_0x85c4bf,_0x4df587=document['getElementById']('music-player-overlay');if(!_0x4df587[_0x17c677(0x9cd)]['contains'](_0x17c677(0x45a))){if(_0x30906e)_0x30906e();return;}_0x4df587[_0x17c677(0x9cd)]['remove'](_0x17c677(0x45a)),setTimeout(()=>{const _0x1adbbb=_0x17c677;document[_0x1adbbb(0x479)](_0x1adbbb(0x355))[_0x1adbbb(0x9cd)][_0x1adbbb(0x8b6)](_0x1adbbb(0x45a));if(_0x30906e)_0x30906e();},0x190);}function _0x1a5b5e(_0x104df1){const _0xca255f=_0x85c4bf;if(!_0x104df1)return[];const _0x2e19b1=String(_0x104df1)[_0xca255f(0x53e)](/\r\n?|\n/),_0x3ca482=[],_0x15cb0a=/\[(\d{2}):(\d{2})[.:](\d{2,3})\]/g;for(const _0x133887 of _0x2e19b1){const _0x8e789d=_0x133887['replace'](_0x15cb0a,'')[_0xca255f(0x9c1)]();if(!_0x8e789d)continue;_0x15cb0a[_0xca255f(0x12fe)]=0x0;let _0x3b8cd3;while((_0x3b8cd3=_0x15cb0a[_0xca255f(0x13fa)](_0x133887))!==null){const _0x2684b6=parseInt(_0x3b8cd3[0x1],0xa),_0x4163d6=parseInt(_0x3b8cd3[0x2],0xa),_0x362237=parseInt(_0x3b8cd3[0x3][_0xca255f(0x11e5)](0x3,'0'),0xa),_0x2ba944=_0x2684b6*0x3c+_0x4163d6+_0x362237/0x3e8;_0x3ca482['push']({'time':_0x2ba944,'text':_0x8e789d});}}return _0x3ca482[_0xca255f(0x382)]((_0x50082c,_0x1e0d55)=>_0x50082c[_0xca255f(0x1ba)]-_0x1e0d55[_0xca255f(0x1ba)]);}function _0x2097bb(){const _0x333069=_0x85c4bf,_0x41c79f=document[_0x333069(0x479)](_0x333069(0x88d));_0x41c79f['innerHTML']='';if(!_0x304e8d[_0x333069(0x6f2)]||_0x304e8d[_0x333069(0x6f2)][_0x333069(0x990)]===0x0){_0x41c79f['innerHTML']=_0x333069(0x97f);return;}_0x304e8d['parsedLyrics']['forEach']((_0x740c78,_0x1326ac)=>{const _0xaeb009=_0x333069,_0x2dd749=document[_0xaeb009(0xbd5)]('div');_0x2dd749[_0xaeb009(0xfd4)]='lyric-line',_0x2dd749[_0xaeb009(0x97b)]=_0x740c78[_0xaeb009(0x56d)],_0x2dd749[_0xaeb009(0x13d4)][_0xaeb009(0x959)]=_0x1326ac,_0x41c79f[_0xaeb009(0x9f4)](_0x2dd749);}),_0x41c79f[_0x333069(0x10dd)]['transform']=_0x333069(0x415);}function _0x145084(_0x4d7e30){const _0x30b2cc=_0x85c4bf;if(_0x304e8d[_0x30b2cc(0x6f2)][_0x30b2cc(0x990)]===0x0)return;let _0x2450ce=-0x1;for(let _0x4ae208=0x0;_0x4ae208<_0x304e8d['parsedLyrics'][_0x30b2cc(0x990)];_0x4ae208++){if(_0x4d7e30>=_0x304e8d[_0x30b2cc(0x6f2)][_0x4ae208][_0x30b2cc(0x1ba)])_0x2450ce=_0x4ae208;else break;}if(_0x2450ce===_0x304e8d[_0x30b2cc(0x8f8)])return;_0x304e8d[_0x30b2cc(0x8f8)]=_0x2450ce,_0x5b2fb1();const _0x4ed9b6=document[_0x30b2cc(0x479)](_0x30b2cc(0x590));_0x4ed9b6&&(_0x2450ce>-0x1&&_0x304e8d['parsedLyrics'][_0x2450ce]?_0x4ed9b6[_0x30b2cc(0x97b)]=_0x304e8d[_0x30b2cc(0x6f2)][_0x2450ce][_0x30b2cc(0x56d)]:_0x4ed9b6[_0x30b2cc(0x97b)]=_0x30b2cc(0xb30));const _0x2925d4=document[_0x30b2cc(0x479)](_0x30b2cc(0xffe));_0x2925d4[_0x30b2cc(0x9cd)][_0x30b2cc(0x658)]('visible')&&(_0x2450ce>-0x1&&_0x304e8d[_0x30b2cc(0x6f2)][_0x2450ce]?_0x2925d4[_0x30b2cc(0x97b)]=_0x304e8d['parsedLyrics'][_0x2450ce][_0x30b2cc(0x56d)]:_0x2925d4[_0x30b2cc(0x97b)]='♪');}function _0x5b2fb1(_0xd9b390=![]){const _0x5dbd5b=_0x85c4bf,_0x5d4efd=_0xd9b390?_0x5dbd5b(0x6e4):_0x5dbd5b(0x300),_0x5b6d9e=_0xd9b390?'#fullscreen-lyrics-container':'#music-lyrics-container',_0x531b4a=document[_0x5dbd5b(0x8bc)](_0x5d4efd),_0x206e83=document['querySelector'](_0x5b6d9e);if(!_0x531b4a||!_0x206e83)return;const _0x5ee097=_0x531b4a[_0x5dbd5b(0x99e)]('.lyric-line');_0x5ee097[_0x5dbd5b(0x12be)](_0x35d90a=>_0x35d90a[_0x5dbd5b(0x9cd)][_0x5dbd5b(0x8b6)](_0x5dbd5b(0x5a9)));if(_0x304e8d[_0x5dbd5b(0x8f8)]===-0x1){_0x531b4a[_0x5dbd5b(0x10dd)]['transform']=_0x5dbd5b(0x415);return;}const _0x53d655=_0x531b4a[_0x5dbd5b(0x8bc)](_0x5dbd5b(0x7f6)+_0x304e8d[_0x5dbd5b(0x8f8)]+'\x22]');if(_0x53d655){_0x53d655[_0x5dbd5b(0x9cd)]['add'](_0x5dbd5b(0x5a9));const _0x3b3a58=_0x206e83[_0x5dbd5b(0xfc5)],_0x4b8dad=_0x3b3a58/2.2-_0x53d655[_0x5dbd5b(0x6dc)]-_0x53d655[_0x5dbd5b(0xfc5)]/0x2;_0x531b4a[_0x5dbd5b(0x10dd)][_0x5dbd5b(0x87a)]=_0x5dbd5b(0x26c)+_0x4b8dad+_0x5dbd5b(0x98b);}}function _0x1ba607(_0x19e32e){const _0x27c9a4=_0x85c4bf;if(isNaN(_0x19e32e)||_0x19e32e<0x0)return _0x27c9a4(0xcc3);const _0x462d50=Math[_0x27c9a4(0xd71)](_0x19e32e/0x3c),_0x4b54f7=Math[_0x27c9a4(0xd71)](_0x19e32e%0x3c);return _0x462d50+':'+String(_0x4b54f7)[_0x27c9a4(0x738)](0x2,'0');}let _0x42576f=0x0,_0x3be945;function _0x2db015(){_0x3be945&&cancelAnimationFrame(_0x3be945);function _0xf3aa27(){const _0x47044d=_0x6666;if(!_0x304e8d[_0x47044d(0x11c3)]||!_0x54d46a['duration'])return;const _0x1bb623=performance[_0x47044d(0x12d6)](),_0x6defe3=_0x54d46a['currentTime'],_0x3db952=_0x54d46a[_0x47044d(0x9d6)],_0x59d8b2=_0x6defe3/_0x3db952*0x64;document[_0x47044d(0x479)](_0x47044d(0x6d4))[_0x47044d(0x10dd)]['width']=_0x59d8b2+'%',_0x1bb623-_0x42576f>0x3e8&&(document[_0x47044d(0x479)](_0x47044d(0x930))[_0x47044d(0x97b)]=_0x1ba607(_0x6defe3),document[_0x47044d(0x479)](_0x47044d(0xc5d))['textContent']=_0x1ba607(_0x3db952),_0x42576f=_0x1bb623),_0x145084(_0x6defe3),_0x3be945=requestAnimationFrame(_0xf3aa27);}_0x3be945=requestAnimationFrame(_0xf3aa27);}function _0x196146(){const _0x8661fb=_0x85c4bf;if(!lastRawAiResponse){alert(_0x8661fb(0xaf3));return;}const _0x142e19=document[_0x8661fb(0x479)](_0x8661fb(0x18e)),_0x191cfe=document[_0x8661fb(0x479)]('ai-response-editor-container');_0x191cfe['innerHTML']='';const _0x207b82=lastRawAiResponse['match'](/{[^{}]*}/g);if(_0x207b82)_0x207b82[_0x8661fb(0x12be)](_0x441ec4=>{const _0x9e40ed=_0x8661fb;try{const _0x304ba7=JSON[_0x9e40ed(0x94c)](_0x441ec4),_0x198bc9=JSON['stringify'](_0x304ba7,null,0x2),_0x276cad=_0x135fc1(_0x198bc9);_0x191cfe[_0x9e40ed(0x9f4)](_0x276cad);}catch(_0x4275de){const _0x45f5c0=_0x135fc1(_0x441ec4);_0x191cfe[_0x9e40ed(0x9f4)](_0x45f5c0),console[_0x9e40ed(0x139e)]('在导演模式中发现一个无效的JSON片段:',_0x441ec4);}});else{const _0x394ba3=_0x135fc1(lastRawAiResponse);_0x191cfe[_0x8661fb(0x9f4)](_0x394ba3);}_0x142e19['classList']['add'](_0x8661fb(0x45a));}function _0x135fc1(_0x1d7140=''){const _0xfdd113=_0x85c4bf,_0x539a93=document['createElement'](_0xfdd113(0x6c8));_0x539a93[_0xfdd113(0xfd4)]=_0xfdd113(0x8b8);const _0x41dd27={'text':{'type':_0xfdd113(0x56d),'content':_0xfdd113(0xf5c)},'sticker':{'type':_0xfdd113(0xb9e),'url':_0xfdd113(0x1322),'meaning':_0xfdd113(0xb78)},'image':{'type':_0xfdd113(0x135a),'description':'在这里输入图片描述...'},'voice':{'type':_0xfdd113(0x9bf),'content':'在这里输入语音内容...'},'transfer':{'type':_0xfdd113(0x5f8),'amount':5.2,'note':_0xfdd113(0xfb7)},'offline':{'type':_0xfdd113(0x124e),'content':_0xfdd113(0xf2c)},'quote':{'type':_0xfdd113(0x47f),'target_timestamp':0x499602d2,'reply_content':_0xfdd113(0x1025)}};return _0x539a93[_0xfdd113(0x3de)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条动作\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<textarea>'+_0x1d7140+_0xfdd113(0x137c)+JSON['stringify'](_0x41dd27[_0xfdd113(0x56d)])+_0xfdd113(0x13a8)+JSON[_0xfdd113(0x1308)](_0x41dd27[_0xfdd113(0xb9e)])+_0xfdd113(0xd13)+JSON[_0xfdd113(0x1308)](_0x41dd27['image'])+'\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0xfdd113(0x1308)](_0x41dd27['voice'])+_0xfdd113(0xa77)+JSON[_0xfdd113(0x1308)](_0x41dd27[_0xfdd113(0x5f8)])+_0xfdd113(0xb5c)+JSON[_0xfdd113(0x1308)](_0x41dd27[_0xfdd113(0x832)])+_0xfdd113(0x3e9)+JSON[_0xfdd113(0x1308)](_0x41dd27[_0xfdd113(0xb67)])+_0xfdd113(0x1222),_0x539a93[_0xfdd113(0x8bc)](_0xfdd113(0x895))[_0xfdd113(0xa75)](_0xfdd113(0xd2f),()=>{const _0x265b3a=_0xfdd113;_0x539a93[_0x265b3a(0x8b6)]();}),_0x539a93[_0xfdd113(0x99e)]('.format-btn')[_0xfdd113(0x12be)](_0x2cdf59=>{const _0x11dd2d=_0xfdd113;_0x2cdf59[_0x11dd2d(0xa75)](_0x11dd2d(0xd2f),()=>{const _0x5a8b0c=_0x11dd2d,_0x42624a=_0x2cdf59['dataset'][_0x5a8b0c(0x346)],_0x444588=_0x539a93['querySelector'](_0x5a8b0c(0x1283));if(_0x42624a&&_0x444588)try{const _0x331356=JSON[_0x5a8b0c(0x94c)](_0x42624a);_0x444588['value']=JSON[_0x5a8b0c(0x1308)](_0x331356,null,0x2),_0x444588['focus']();}catch(_0x1212fc){console['error'](_0x5a8b0c(0x593),_0x1212fc);}});}),_0x539a93;}async function _0x370782(){const _0x31e46c=_0x85c4bf,_0x4b4a27=_0x505390[_0x31e46c(0x1027)][_0x505390[_0x31e46c(0x233)]];if(!_0x4b4a27)return;const _0x151cc0=document[_0x31e46c(0x479)](_0x31e46c(0x11ef)),_0x32efae=_0x151cc0['querySelectorAll'](_0x31e46c(0x1283)),_0x225994=Array[_0x31e46c(0x22f)](_0x32efae)[_0x31e46c(0x2e1)](_0x4bd655=>_0x4bd655[_0x31e46c(0x4e0)][_0x31e46c(0x9c1)]())['filter'](Boolean);if(_0x225994[_0x31e46c(0x990)]===0x0){_0x4b4a27['history']=_0x4b4a27[_0x31e46c(0x7d3)]['filter'](_0x510260=>!lastResponseTimestamps[_0x31e46c(0x44f)](_0x510260[_0x31e46c(0x12a2)])),await _0xb81d4e[_0x31e46c(0x1027)][_0x31e46c(0x5d0)](_0x4b4a27),_0x474d6b(_0x505390[_0x31e46c(0x233)]),_0x1b7f69(),document['getElementById']('ai-response-editor-modal')[_0x31e46c(0x9cd)][_0x31e46c(0x8b6)](_0x31e46c(0x45a)),lastRawAiResponse='',lastResponseTimestamps=[];return;}let _0x6bd3ed=[];for(const _0x4c7843 of _0x225994){try{const _0x258767=JSON['parse'](_0x4c7843);_0x6bd3ed[_0x31e46c(0x1a0)](_0x258767);}catch(_0x4c1ecc){console[_0x31e46c(0x139e)]('跳过一个无法解析为JSON的编辑块:',_0x4c7843);}}_0x4b4a27['history']=_0x4b4a27[_0x31e46c(0x7d3)][_0x31e46c(0x85d)](_0x39690c=>!lastResponseTimestamps[_0x31e46c(0x44f)](_0x39690c[_0x31e46c(0x12a2)]));let _0xe791db=[],_0x5d057d=Date['now']();for(const _0x39efcb of _0x6bd3ed){if(!_0x39efcb||typeof _0x39efcb!==_0x31e46c(0x65a)||!_0x39efcb[_0x31e46c(0x858)]){console[_0x31e46c(0x139e)](_0x31e46c(0x128a),_0x39efcb);continue;}let _0x476c6=null;const _0x5b5fca={'role':'assistant','senderName':_0x39efcb['name']||_0x4b4a27[_0x31e46c(0xe2d)],'timestamp':_0x5d057d++};switch(_0x39efcb[_0x31e46c(0x858)]){case _0x31e46c(0x56d):_0x476c6={..._0x5b5fca,'content':String(_0x39efcb[_0x31e46c(0xac4)]||_0x39efcb['message'])};break;case _0x31e46c(0xb9e):{let _0x25b912=![];if(_0x39efcb['url']&&_0x39efcb[_0x31e46c(0x720)])_0x476c6={..._0x5b5fca,'type':_0x31e46c(0xb9e),'content':_0x39efcb[_0x31e46c(0x5f3)],'meaning':_0x39efcb[_0x31e46c(0x720)]},console[_0x31e46c(0x90f)](_0x31e46c(0xda6)),_0x25b912=!![];else{if(_0x39efcb[_0x31e46c(0x720)]){const _0xe7fcc2=_0x505390[_0x31e46c(0x407)][_0x31e46c(0xc0d)](_0x4239e9=>_0x4239e9[_0x31e46c(0x564)]===_0x39efcb[_0x31e46c(0x720)]);_0xe7fcc2?(_0x476c6={..._0x5b5fca,'type':_0x31e46c(0xb9e),'content':_0xe7fcc2['url'],'meaning':_0xe7fcc2[_0x31e46c(0x564)]},console[_0x31e46c(0x90f)](_0x31e46c(0xa97)),_0x25b912=!![]):(_0x476c6={..._0x5b5fca,'type':_0x31e46c(0x56d),'content':_0x31e46c(0xdbf)+_0x39efcb['meaning']+']'},console[_0x31e46c(0x139e)]('导演模式保存(Sticker):\x20提供了\x20meaning\x20但未找到对应表情:',_0x39efcb[_0x31e46c(0x720)]),_0x25b912=!![]);}else{if(_0x39efcb['url']){_0x476c6={..._0x5b5fca,'type':'sticker','content':_0x39efcb[_0x31e46c(0x5f3)]};const _0x454209=_0x505390['userStickers'][_0x31e46c(0xc0d)](_0x4ffb7a=>_0x4ffb7a[_0x31e46c(0x5f3)]===_0x39efcb[_0x31e46c(0x5f3)]);_0x476c6[_0x31e46c(0x720)]=_0x454209?_0x454209[_0x31e46c(0x564)]:_0x31e46c(0x735),console[_0x31e46c(0x90f)]('导演模式保存(Sticker):\x20使用了\x20URL，最终\x20meaning:',_0x476c6[_0x31e46c(0x720)]),_0x25b912=!![];}else{if(_0x39efcb[_0x31e46c(0xac4)]&&typeof _0x39efcb['content']==='string'&&_0x554a0b[_0x31e46c(0x101d)](_0x39efcb[_0x31e46c(0xac4)])){_0x476c6={..._0x5b5fca,'type':_0x31e46c(0xb9e),'content':_0x39efcb['content']};const _0x2638ae=_0x505390['userStickers']['find'](_0x27f2d7=>_0x27f2d7['url']===_0x39efcb[_0x31e46c(0xac4)]);_0x476c6['meaning']=_0x2638ae?_0x2638ae['name']:'未知表情',console[_0x31e46c(0x90f)]('导演模式保存(Sticker):\x20将\x20content\x20视为\x20URL，查找到\x20meaning:',_0x476c6['meaning']),_0x25b912=!![];}}}}if(!_0x25b912){console[_0x31e46c(0xe3b)](_0x31e46c(0x1390),_0x39efcb);continue;}break;}case _0x31e46c(0x135a):_0x476c6={..._0x5b5fca,'type':_0x31e46c(0x135a),'content':_0x39efcb['description']};break;case'voice_message':_0x476c6={..._0x5b5fca,'type':_0x31e46c(0x9bf),'content':_0x39efcb[_0x31e46c(0xac4)]};break;case _0x31e46c(0x5f8):_0x476c6={..._0x5b5fca,'type':_0x31e46c(0x5f8),'amount':_0x39efcb[_0x31e46c(0xc5c)],'note':_0x39efcb['note'],'receiverName':_0x39efcb[_0x31e46c(0xd00)]||'我'};break;case _0x31e46c(0x792):_0x476c6={..._0x5b5fca,'type':_0x31e46c(0x792),'productInfo':_0x39efcb[_0x31e46c(0xaf5)],'amount':_0x39efcb[_0x31e46c(0xc5c)],'status':_0x31e46c(0xa25),'countdownEndTime':Date[_0x31e46c(0x12d6)]()+0xf*0x3c*0x3e8};break;case _0x31e46c(0x124e):_0x476c6={..._0x5b5fca,..._0x39efcb};break;case'gomoku_move':{const _0xac4913=_0x5aa690[_0x4b4a27['id']];if(_0xac4913){const _0x51ecba=_0xac4913[_0x31e46c(0x7d3)][_0x31e46c(0x1c8)](_0x134867=>_0x134867[_0x31e46c(0x1307)]===0x2);if(_0x51ecba>-0x1){const _0x2210d0=_0xac4913[_0x31e46c(0x7d3)][_0x51ecba];_0xac4913[_0x31e46c(0x206)][_0x2210d0['y']][_0x2210d0['x']]=0x0,_0xac4913[_0x31e46c(0x7d3)][_0x31e46c(0x118e)](_0x51ecba,0x1),console['log'](_0x31e46c(0x28a)+_0x2210d0['x']+',\x20'+_0x2210d0['y']+_0x31e46c(0x11f3));}}const _0x15693e=parseInt(_0x39efcb['x']),_0x48379c=parseInt(_0x39efcb['y']);!isNaN(_0x15693e)&&!isNaN(_0x48379c)?_0x5d7053({'x':_0x15693e,'y':_0x48379c},!![]):console[_0x31e46c(0x139e)](_0x31e46c(0x1110),_0x39efcb);continue;}case _0x31e46c(0x751):{if(!_0x4b4a27['isGroup']){_0x39efcb[_0x31e46c(0x279)]&&(_0x4b4a27[_0x31e46c(0x25c)]=String(_0x39efcb[_0x31e46c(0x279)]));_0x39efcb[_0x31e46c(0x84f)]&&(_0x4b4a27[_0x31e46c(0x2cf)]=String(_0x39efcb['random_jottings']));!Array[_0x31e46c(0x285)](_0x4b4a27[_0x31e46c(0x57e)])&&(_0x4b4a27[_0x31e46c(0x57e)]=[]);_0x4b4a27[_0x31e46c(0x57e)][_0x31e46c(0x1a0)]({'heartfeltVoice':_0x4b4a27[_0x31e46c(0x25c)],'randomJottings':_0x4b4a27['randomJottings'],'timestamp':Date[_0x31e46c(0x12d6)]()});_0x4b4a27[_0x31e46c(0x57e)][_0x31e46c(0x990)]>0x32&&_0x4b4a27[_0x31e46c(0x57e)][_0x31e46c(0x13dd)]();const _0x5fa503=_0x31e46c(0x11b3)+_0x4b4a27[_0x31e46c(0x25c)]+_0x31e46c(0x1346)+_0x4b4a27['randomJottings'],_0x29e97a={'role':_0x31e46c(0xbaa),'content':_0x5fa503,'timestamp':Date[_0x31e46c(0x12d6)](),'isHidden':!![]};}continue;}case _0x31e46c(0x47f):{const _0x4fd052=_0x4b4a27[_0x31e46c(0x7d3)]['find'](_0x3e628c=>_0x3e628c['timestamp']===_0x39efcb[_0x31e46c(0xe51)]);let _0x5cd29e=null;if(_0x4fd052){let _0x409a08=_0x4fd052[_0x31e46c(0xdcc)];_0x4fd052['role']===_0x31e46c(0x4c5)&&(_0x409a08=_0x4b4a27[_0x31e46c(0x9d7)]?_0x4b4a27['settings'][_0x31e46c(0xf58)]||'我':_0x505390['qzoneSettings'][_0x31e46c(0x904)]||_0x31e46c(0x80e)),_0x5cd29e={'timestamp':_0x39efcb['target_timestamp'],'senderName':_0x409a08,'content':String(_0x4fd052[_0x31e46c(0xac4)]||'')};}else _0x5cd29e={'timestamp':_0x39efcb[_0x31e46c(0xe51)],'senderName':'未知用户','content':_0x31e46c(0x11b4)};_0x476c6={..._0x5b5fca,'content':_0x39efcb['reply_content'],'quote':_0x5cd29e};break;}default:console[_0x31e46c(0x139e)](_0x31e46c(0x10aa),_0x39efcb[_0x31e46c(0x858)]);break;}_0x476c6&&(_0x4b4a27[_0x31e46c(0x7d3)]['push'](_0x476c6),_0xe791db[_0x31e46c(0x1a0)](_0x476c6[_0x31e46c(0x12a2)]));}await _0xb81d4e[_0x31e46c(0x1027)][_0x31e46c(0x5d0)](_0x4b4a27),_0x474d6b(_0x505390[_0x31e46c(0x233)]),_0x1b7f69(),document[_0x31e46c(0x479)](_0x31e46c(0x18e))[_0x31e46c(0x9cd)][_0x31e46c(0x8b6)](_0x31e46c(0x45a)),lastRawAiResponse=_0x225994['join']('\x0a\x0a'),lastResponseTimestamps=_0xe791db,await _0x1519c8('导演模式','您的修改已保存！');}async function _0x8b172b(){const _0x45176b=_0x85c4bf;if(!_0x45dd47)return;const _0x27315d=0x2*0x3c*0x3e8,_0x1f21ea=_0x45dd47,_0x19112d=Date['now']();if(_0x19112d-_0x1f21ea>_0x27315d){_0x499597(),await _0x1519c8(_0x45176b(0xaab),_0x45176b(0x1396));return;}await _0x25775f(_0x1f21ea,!![]),_0x499597();}async function _0x25775f(_0x539b3c,_0xc1fab4){const _0x1539ee=_0x85c4bf,_0x5c5c62=_0x505390[_0x1539ee(0x1027)][_0x505390[_0x1539ee(0x233)]];if(!_0x5c5c62)return;const _0x5d0b06=_0x5c5c62[_0x1539ee(0x7d3)]['findIndex'](_0x23a0e8=>_0x23a0e8['timestamp']===_0x539b3c);if(_0x5d0b06===-0x1)return;const _0x1cd510=_0x5c5c62['history'][_0x5d0b06],_0x5cc21d={'originalType':_0x1cd510['type']||_0x1539ee(0x56d),'originalContent':_0x1cd510['content'],'originalMeaning':_0x1cd510[_0x1539ee(0x720)],'originalQuote':_0x1cd510[_0x1539ee(0xb67)]};_0x1cd510[_0x1539ee(0x858)]=_0x1539ee(0x93b),_0x1cd510[_0x1539ee(0xac4)]=_0xc1fab4?_0x1539ee(0x184):_0x1539ee(0x1d0),_0x1cd510[_0x1539ee(0x439)]=_0x5cc21d,delete _0x1cd510[_0x1539ee(0x720)],delete _0x1cd510[_0x1539ee(0xb67)];if(_0xc1fab4){const _0x239eb6=_0x5c5c62['isGroup']?_0x5c5c62[_0x1539ee(0x18a)][_0x1539ee(0xf58)]||'我':'我';let _0x16a0fb='';if(_0x5cc21d['originalType']===_0x1539ee(0xb9e))_0x16a0fb=_0x1539ee(0x48b)+(_0x5cc21d[_0x1539ee(0xffb)]||'未知')+']';else _0x5cc21d[_0x1539ee(0x4fa)]==='ai_image'||_0x5cc21d[_0x1539ee(0x4fa)]===_0x1539ee(0x5d5)?_0x16a0fb=_0x1539ee(0xf2e)+_0x5cc21d[_0x1539ee(0x982)]+']':_0x16a0fb='“'+String(_0x5cc21d[_0x1539ee(0x982)])+'”';const _0x484ba9={'role':_0x1539ee(0xbaa),'content':'[系统提示：用户（'+_0x239eb6+_0x1539ee(0x11ae)+_0x16a0fb+'。请你对此作出回应，可以表现出好奇、开玩笑（比如\x27我截图了！\x27）、或者根据你的人设表示理解或疑惑。]','timestamp':Date[_0x1539ee(0x12d6)](),'isHidden':!![]};_0x5c5c62[_0x1539ee(0x7d3)]['push'](_0x484ba9);}await _0xb81d4e[_0x1539ee(0x1027)][_0x1539ee(0x5d0)](_0x5c5c62),_0x474d6b(_0x505390[_0x1539ee(0x233)]),_0xc1fab4&&(_0x1b7f69(),_0x15e1a8());}async function _0x35976f(){const _0x65360c=_0x85c4bf;await _0x437d29(),document[_0x65360c(0x479)](_0x65360c(0x723))['classList'][_0x65360c(0x807)](_0x65360c(0x45a));}async function _0x437d29(){const _0x3468b9=_0x85c4bf,_0x536276=document[_0x3468b9(0x479)](_0x3468b9(0x5e3)),_0x55c571=await _0xb81d4e['worldBookCategories'][_0x3468b9(0x4ba)]();_0x536276['innerHTML']='',_0x55c571[_0x3468b9(0x990)]===0x0&&(_0x536276[_0x3468b9(0x3de)]=_0x3468b9(0xd77)),_0x55c571[_0x3468b9(0x12be)](_0x3a1c4a=>{const _0x39010c=_0x3468b9,_0x7a3284=document['createElement'](_0x39010c(0x6c8));_0x7a3284[_0x39010c(0xfd4)]='existing-group-item',_0x7a3284['innerHTML']=_0x39010c(0xbba)+_0x3a1c4a[_0x39010c(0x564)]+_0x39010c(0xb26)+_0x3a1c4a['id']+_0x39010c(0x13d2),_0x536276[_0x39010c(0x9f4)](_0x7a3284);});}async function _0xb5659e(){const _0x5942e2=_0x85c4bf,_0x286274=document[_0x5942e2(0x479)](_0x5942e2(0x3c8)),_0x2a4e76=_0x286274[_0x5942e2(0x4e0)]['trim']();if(!_0x2a4e76){alert(_0x5942e2(0x446));return;}const _0x4a4d2b=await _0xb81d4e['worldBookCategories'][_0x5942e2(0x46f)]('name')['equals'](_0x2a4e76)[_0x5942e2(0x64e)]();if(_0x4a4d2b){alert(_0x5942e2(0x652)+_0x2a4e76+_0x5942e2(0x12d5));return;}await _0xb81d4e[_0x5942e2(0xfe9)]['add']({'name':_0x2a4e76}),_0x286274['value']='',await _0x437d29();}async function _0x241026(_0x1f310d){const _0x258375=_0x85c4bf,_0x12f31b=await _0x1a9e79('确认删除','删除分类后，该分类下的所有世界书将变为“未分类”。确定要删除吗？',{'confirmButtonClass':_0x258375(0x95a)});if(_0x12f31b){await _0xb81d4e[_0x258375(0xfe9)]['delete'](_0x1f310d);const _0x516458=await _0xb81d4e[_0x258375(0xd1b)][_0x258375(0x46f)](_0x258375(0x470))['equals'](_0x1f310d)[_0x258375(0x4ba)]();for(const _0x4f039d of _0x516458){_0x4f039d[_0x258375(0x470)]=null,await _0xb81d4e[_0x258375(0xd1b)][_0x258375(0x5d0)](_0x4f039d);const _0x21efa7=_0x505390[_0x258375(0xd1b)][_0x258375(0xc0d)](_0x20d93c=>_0x20d93c['id']===_0x4f039d['id']);if(_0x21efa7)_0x21efa7[_0x258375(0x470)]=null;}await _0x437d29();}}async function _0x2c69dc(){const _0x2b1b9f=_0x85c4bf;if(!_0x45dd47)return;const _0x596a93=_0x45dd47;_0x499597();const _0x18e770=_0x505390[_0x2b1b9f(0x1027)][_0x505390[_0x2b1b9f(0x233)]],_0x16d859=_0x18e770[_0x2b1b9f(0x7d3)]['find'](_0x3fde74=>_0x3fde74[_0x2b1b9f(0x12a2)]===_0x596a93);if(!_0x16d859)return;let _0x14f5a1=String(_0x16d859['content']||'')[_0x2b1b9f(0x1323)](0x0,0x32)+'...';if(_0x16d859[_0x2b1b9f(0x858)]===_0x2b1b9f(0x135a))_0x14f5a1=_0x2b1b9f(0x3be)+_0x14f5a1;const _0xabf3ae=await _0x1a9e79(_0x2b1b9f(0x7c9),_0x2b1b9f(0x40b)+_0x14f5a1+'”',{'confirmText':_0x2b1b9f(0x1388)});if(_0xabf3ae){const _0x3f6e4f=_0x18e770[_0x2b1b9f(0x18a)][_0x2b1b9f(0xf58)]||'我';!Array[_0x2b1b9f(0x285)](_0x18e770['announcements'])&&(_0x18e770[_0x2b1b9f(0xbca)]=[]);const _0x281ced={'id':_0x2b1b9f(0x3e5)+Date[_0x2b1b9f(0x12d6)](),'messageTimestamp':_0x596a93,'publisher':_0x3f6e4f,'publishedAt':Date[_0x2b1b9f(0x12d6)](),'isPinned':![]};_0x18e770['announcements'][_0x2b1b9f(0x1a0)](_0x281ced);const _0x1e7178={'role':_0x2b1b9f(0xbaa),'type':_0x2b1b9f(0x81b),'content':_0x3f6e4f+_0x2b1b9f(0x46c),'timestamp':Date[_0x2b1b9f(0x12d6)]()};_0x18e770['history'][_0x2b1b9f(0x1a0)](_0x1e7178),await _0xb81d4e[_0x2b1b9f(0x1027)][_0x2b1b9f(0x5d0)](_0x18e770),_0x48f5ff(_0x1e7178,_0x18e770),_0x1b7f69(),await _0x1519c8('成功','公告已发布！');}}async function _0x1161f0(){const _0x5ec19a=_0x85c4bf,_0x599462=_0x505390[_0x5ec19a(0x1027)][_0x505390['activeChatId']],_0x18b74b=_0x599462['announcements']||[];if(!_0x599462||_0x18b74b[_0x5ec19a(0x990)]===0x0){_0x1519c8('提示',_0x5ec19a(0x7ae));return;}const _0x2f4328=document[_0x5ec19a(0x479)](_0x5ec19a(0x1244));_0x2f4328[_0x5ec19a(0x3de)]='',_0x18b74b[_0x5ec19a(0x382)]((_0x340d61,_0x3db18e)=>(_0x3db18e['isPinned']?0x1:0x0)-(_0x340d61['isPinned']?0x1:0x0));for(const _0x4c7ab6 of _0x18b74b){const _0x4be960=_0x599462['history'][_0x5ec19a(0xc0d)](_0x59990b=>_0x59990b[_0x5ec19a(0x12a2)]===_0x4c7ab6['messageTimestamp']),_0xfd5bbf=document[_0x5ec19a(0xbd5)]('div');_0xfd5bbf['className']=_0x5ec19a(0x7cd);if(_0x4be960){const _0x5fcf88=await _0x43c884(_0x4be960,_0x599462);_0x5fcf88&&_0xfd5bbf[_0x5ec19a(0x9f4)](_0x5fcf88);}else _0xfd5bbf['innerHTML']=_0x5ec19a(0x6a9);_0x4c7ab6[_0x5ec19a(0xe4a)]&&(_0xfd5bbf['innerHTML']+=_0x5ec19a(0x903)),_0xfd5bbf[_0x5ec19a(0x3de)]+='<div\x20class=\x22announcement-item-actions\x22\x20data-anno-id=\x22'+_0x4c7ab6['id']+_0x5ec19a(0x1125),_0x2f4328[_0x5ec19a(0x9f4)](_0xfd5bbf);}document[_0x5ec19a(0x479)](_0x5ec19a(0xa1a))[_0x5ec19a(0x9cd)][_0x5ec19a(0x807)]('visible');}let _0x181ba0=null;function _0x47d3e3(_0x4e9fae){const _0x1b129f=_0x85c4bf;_0x181ba0=_0x4e9fae;const _0x2ca876=_0x505390[_0x1b129f(0x1027)][_0x505390[_0x1b129f(0x233)]],_0x4b1745=_0x2ca876[_0x1b129f(0xbca)][_0x1b129f(0xc0d)](_0x32803a=>_0x32803a['id']===_0x4e9fae);if(!_0x4b1745)return;const _0x1ef05a=document[_0x1b129f(0x479)](_0x1b129f(0x1356));_0x1ef05a[_0x1b129f(0x97b)]=_0x4b1745[_0x1b129f(0xe4a)]?'取消置顶':_0x1b129f(0x5a3),document[_0x1b129f(0x479)](_0x1b129f(0x2db))[_0x1b129f(0x9cd)][_0x1b129f(0x807)](_0x1b129f(0x45a));}async function _0xb8530f(){const _0x1c0ad9=_0x85c4bf;if(!_0x181ba0)return;const _0x56faf2=_0x505390[_0x1c0ad9(0x1027)][_0x505390['activeChatId']],_0x3f3a27=_0x56faf2['announcements'][_0x1c0ad9(0xc0d)](_0x5a610a=>_0x5a610a['id']===_0x181ba0);_0x3f3a27&&(_0x3f3a27[_0x1c0ad9(0xe4a)]=!_0x3f3a27[_0x1c0ad9(0xe4a)],await _0xb81d4e[_0x1c0ad9(0x1027)][_0x1c0ad9(0x5d0)](_0x56faf2),_0x1161f0()),document[_0x1c0ad9(0x479)](_0x1c0ad9(0x2db))[_0x1c0ad9(0x9cd)][_0x1c0ad9(0x8b6)](_0x1c0ad9(0x45a));}async function _0x353c84(){const _0x2e948a=_0x85c4bf;if(!_0x181ba0)return;const _0x1ef497=await _0x1a9e79(_0x2e948a(0x587),'确定要删除这条公告吗？此操作不可恢复。',{'confirmButtonClass':_0x2e948a(0x95a)});if(_0x1ef497){const _0x1e9f3b=_0x505390[_0x2e948a(0x1027)][_0x505390[_0x2e948a(0x233)]];_0x1e9f3b[_0x2e948a(0xbca)]=_0x1e9f3b[_0x2e948a(0xbca)][_0x2e948a(0x85d)](_0x571dc0=>_0x571dc0['id']!==_0x181ba0),await _0xb81d4e[_0x2e948a(0x1027)][_0x2e948a(0x5d0)](_0x1e9f3b),_0x1161f0();}document['getElementById'](_0x2e948a(0x2db))['classList'][_0x2e948a(0x8b6)](_0x2e948a(0x45a));}let _0x49562c=![],_0x578bab={'ai':null,'my':null};function _0x90c5f(_0x77ad2d=_0x85c4bf(0xa50)){const _0x2c7a41=_0x85c4bf,_0x5300e5=document[_0x2c7a41(0x479)](_0x2c7a41(0x436));if(!_0x505390[_0x2c7a41(0x233)])return;const _0x1541d8=_0x505390['chats'][_0x505390['activeChatId']];_0x49562c=_0x77ad2d===_0x2c7a41(0x736);if(_0x49562c){const _0x1b4a95=_0x1541d8['members'][_0x2c7a41(0xc0d)](_0x30bc80=>_0x30bc80['id']===_0x5799fc);if(!_0x1b4a95)return;_0x578bab['my']=_0x1b4a95[_0x2c7a41(0xea1)]||'',_0x44717a(!![],_0x1b4a95[_0x2c7a41(0x799)],_0x1b4a95[_0x2c7a41(0xea1)]);}else _0x578bab['ai']=_0x1541d8[_0x2c7a41(0x18a)][_0x2c7a41(0x663)]||'',_0x578bab['my']=_0x1541d8['settings'][_0x2c7a41(0x486)]||'',_0x44717a(![]);_0x5300e5[_0x2c7a41(0x9cd)][_0x2c7a41(0x807)](_0x2c7a41(0x45a));}function _0x44717a(_0x35004e=![],_0x3a0dbf=null,_0x5b3d71=null){const _0x319342=_0x85c4bf,_0x248923=document[_0x319342(0x479)](_0x319342(0xb3e)),_0x36dcb3=document[_0x319342(0x479)](_0x319342(0xe68)),_0x11a329=_0x505390['chats'][_0x505390['activeChatId']];_0x248923[_0x319342(0x3de)]='',_0x36dcb3['innerHTML']='',document['querySelector'](_0x319342(0xef3))[_0x319342(0x10dd)][_0x319342(0x678)]=_0x35004e?_0x319342(0xff8):'flex',document[_0x319342(0x479)](_0x319342(0x24b))['style']['display']=_0x319342(0xee3),document[_0x319342(0x479)]('my-frame-content')[_0x319342(0x10dd)][_0x319342(0x678)]=_0x319342(0xff8),document['getElementById'](_0x319342(0xdea))[_0x319342(0x9cd)][_0x319342(0x807)](_0x319342(0x5a9)),document[_0x319342(0x479)](_0x319342(0x5a8))[_0x319342(0x9cd)]['remove'](_0x319342(0x5a9));if(_0x35004e)_0x53854d[_0x319342(0x12be)](_0x406ec3=>{const _0x15bef6=_0x319342,_0x1ebbb3=_0x36713b(_0x406ec3,'my',_0x3a0dbf);_0x406ec3[_0x15bef6(0x5f3)]===_0x5b3d71&&_0x1ebbb3['classList']['add'](_0x15bef6(0x10dc)),_0x248923[_0x15bef6(0x9f4)](_0x1ebbb3);});else{const _0x36c48c=_0x11a329[_0x319342(0x18a)][_0x319342(0x1039)]||_0x28c106,_0x340ccd=_0x11a329[_0x319342(0x18a)]['myAvatar']||(_0x11a329[_0x319342(0x9d7)]?_0x2361d7:_0x28c106);_0x53854d[_0x319342(0x12be)](_0x46b93a=>{const _0x368350=_0x319342,_0x46fa71=_0x36713b(_0x46b93a,'ai',_0x36c48c);if(_0x46b93a[_0x368350(0x5f3)]===_0x578bab['ai'])_0x46fa71['classList'][_0x368350(0x807)]('selected');_0x248923['appendChild'](_0x46fa71);const _0x961f1e=_0x36713b(_0x46b93a,'my',_0x340ccd);if(_0x46b93a[_0x368350(0x5f3)]===_0x578bab['my'])_0x961f1e['classList'][_0x368350(0x807)](_0x368350(0x10dc));_0x36dcb3[_0x368350(0x9f4)](_0x961f1e);});}}function _0x36713b(_0x4568e0,_0x30210d,_0x399ab2){const _0x5aff1d=_0x85c4bf,_0x288711=document[_0x5aff1d(0xbd5)](_0x5aff1d(0x6c8));return _0x288711[_0x5aff1d(0xfd4)]=_0x5aff1d(0xd47),_0x288711[_0x5aff1d(0x13d4)][_0x5aff1d(0x107d)]=_0x4568e0[_0x5aff1d(0x5f3)],_0x288711[_0x5aff1d(0xc29)]=_0x4568e0[_0x5aff1d(0x564)],_0x288711['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x399ab2+_0x5aff1d(0xfd3)+(_0x4568e0['url']?_0x5aff1d(0xdba)+_0x4568e0[_0x5aff1d(0x5f3)]+_0x5aff1d(0xae0):'')+_0x5aff1d(0x704),_0x288711[_0x5aff1d(0xa75)]('click',()=>{const _0x19f2fa=_0x5aff1d;_0x578bab[_0x30210d]=_0x4568e0['url'];const _0x2e072c=_0x30210d==='ai'?document[_0x19f2fa(0x479)](_0x19f2fa(0xb3e)):document[_0x19f2fa(0x479)](_0x19f2fa(0xe68));_0x2e072c['querySelectorAll'](_0x19f2fa(0xa7b))[_0x19f2fa(0x12be)](_0x3bdec6=>_0x3bdec6[_0x19f2fa(0x9cd)][_0x19f2fa(0x8b6)](_0x19f2fa(0x10dc))),_0x288711['classList'][_0x19f2fa(0x807)]('selected');}),_0x288711;}async function _0x4df7aa(){const _0x58c705=_0x85c4bf;if(!_0x505390['activeChatId'])return;const _0x48bc82=_0x505390['chats'][_0x505390[_0x58c705(0x233)]];if(_0x49562c){const _0x11db69=_0x48bc82[_0x58c705(0x954)][_0x58c705(0xc0d)](_0x18f3e1=>_0x18f3e1['id']===_0x5799fc);_0x11db69&&(_0x11db69[_0x58c705(0xea1)]=_0x578bab['my']);}else _0x48bc82['settings'][_0x58c705(0x663)]=_0x578bab['ai'],_0x48bc82[_0x58c705(0x18a)][_0x58c705(0x486)]=_0x578bab['my'];await _0xb81d4e['chats'][_0x58c705(0x5d0)](_0x48bc82);if(!_0x49562c&&!_0x48bc82['isGroup']){const _0x264a1d=_0x48bc82['id'];for(const _0xa93537 of Object[_0x58c705(0x3d5)](_0x505390[_0x58c705(0x1027)])){if(_0xa93537[_0x58c705(0x9d7)]&&_0xa93537[_0x58c705(0x954)]){const _0x24f1ea=_0xa93537[_0x58c705(0x954)][_0x58c705(0xc0d)](_0x30091f=>_0x30091f['id']===_0x264a1d);_0x24f1ea&&(_0x24f1ea['avatarFrame']=_0x48bc82[_0x58c705(0x18a)]['aiAvatarFrame'],await _0xb81d4e[_0x58c705(0x1027)]['put'](_0xa93537),console[_0x58c705(0x90f)](_0x58c705(0x649)+_0x264a1d+'\x20的头像框到群聊\x20\x22'+_0xa93537['name']+'\x22'));}}}document[_0x58c705(0x479)](_0x58c705(0x436))[_0x58c705(0x9cd)]['remove'](_0x58c705(0x45a)),_0x474d6b(_0x505390[_0x58c705(0x233)]),alert('头像框已保存并同步！'),_0x49562c=![];}function _0x135357(){const _0x35a3e1=_0x85c4bf;_0xc0eda4=!_0xc0eda4;const _0x16d62b=document['getElementById'](_0x35a3e1(0x122b)),_0x32db46=document[_0x35a3e1(0x479)]('frame-action-bar'),_0x181b8b=document[_0x35a3e1(0x479)](_0x35a3e1(0x111d));document[_0x35a3e1(0x99e)](_0x35a3e1(0x13f2))['forEach'](_0x2dbf30=>{const _0x519696=_0x35a3e1;_0x2dbf30['classList']['toggle'](_0x519696(0x2ae),_0xc0eda4);}),_0xc0eda4?(_0x16d62b['textContent']='完成',_0x32db46[_0x35a3e1(0x10dd)][_0x35a3e1(0x678)]=_0x35a3e1(0x899),_0x1dcb25[_0x35a3e1(0xf8f)](),_0x181b8b[_0x35a3e1(0xf7b)]=![],_0x497e41()):(_0x16d62b[_0x35a3e1(0x97b)]='管理',_0x32db46['style'][_0x35a3e1(0x678)]='none',document['querySelectorAll'](_0x35a3e1(0xb63))[_0x35a3e1(0x12be)](_0x5840eb=>{const _0x2c6f71=_0x35a3e1;_0x5840eb['classList'][_0x2c6f71(0x8b6)](_0x2c6f71(0x10dc));}));}function _0x497e41(){const _0x979fc1=_0x85c4bf,_0x578a9d=document[_0x979fc1(0x479)]('delete-selected-frames-btn');_0x578a9d[_0x979fc1(0x97b)]='删除\x20('+_0x1dcb25[_0x979fc1(0xa7a)]+')';}function _0x40cae5(){const _0x187962=_0x85c4bf,_0x4e47db=document[_0x187962(0x479)](_0x187962(0x111d))[_0x187962(0xf7b)],_0x559698=document[_0x187962(0x8bc)](_0x187962(0x44d));if(!_0x559698)return;_0x559698[_0x187962(0x99e)]('.frame-item:has(.delete-btn)')[_0x187962(0x12be)](_0x2112cb=>{const _0x34b4c0=_0x187962,_0x458035=parseInt(_0x2112cb[_0x34b4c0(0x8bc)]('.delete-btn')['dataset']['id']);if(isNaN(_0x458035))return;_0x2112cb['classList'][_0x34b4c0(0x2bf)]('selected',_0x4e47db),_0x4e47db?_0x1dcb25[_0x34b4c0(0x807)](_0x458035):_0x1dcb25[_0x34b4c0(0x1ea)](_0x458035);}),_0x497e41();}async function _0x455b20(){const _0x50cee8=_0x85c4bf;if(_0x1dcb25[_0x50cee8(0xa7a)]===0x0)return;const _0x4ee329=await _0x1a9e79(_0x50cee8(0x587),_0x50cee8(0xf25)+_0x1dcb25[_0x50cee8(0xa7a)]+_0x50cee8(0xede),{'confirmButtonClass':_0x50cee8(0x95a)});if(_0x4ee329){const _0x30745d=[..._0x1dcb25];await _0xb81d4e['customAvatarFrames'][_0x50cee8(0x12f5)](_0x30745d),_0x135357(),_0x44717a(_0x49562c),await _0x1519c8(_0x50cee8(0xa62),_0x50cee8(0xada));}}function _0x5cefa5(_0x30f515){const _0x49ca83=_0x85c4bf,_0x20f477=document[_0x49ca83(0x479)](_0x49ca83(0x1391));_0x20f477&&(_0x20f477[_0x49ca83(0x3de)]=_0x30f515||'');}async function _0x318ca5(_0x514923){const _0x4ea644=_0x85c4bf;if(!_0x304e8d['isActive']||!_0x304e8d[_0x4ea644(0x233)])return;const _0x5d9950=_0x505390[_0x4ea644(0x1027)][_0x304e8d[_0x4ea644(0x233)]];if(!_0x5d9950)return;const _0x13d2b6=_0x5d9950[_0x4ea644(0x9d7)]?_0x5d9950['settings']['myNickname']||'我':'我',_0x1c1898=_0x4ea644(0x8d4)+_0x13d2b6+')\x20'+_0x514923+']',_0x4070a9={'role':_0x4ea644(0xbaa),'content':_0x1c1898,'timestamp':Date['now'](),'isHidden':!![]};_0x5d9950['history'][_0x4ea644(0x1a0)](_0x4070a9),await _0xb81d4e[_0x4ea644(0x1027)][_0x4ea644(0x5d0)](_0x5d9950);}async function _0x4851b7(){const _0x138ebf=_0x85c4bf;if(_0x373eab[_0x138ebf(0xa7a)]===0x0)return;const _0x5a8949=_0x505390[_0x138ebf(0x1027)][_0x505390['activeChatId']];if(!_0x5a8949)return;const _0x12ac92=document[_0x138ebf(0x479)](_0x138ebf(0x6f3)),_0x59175d=_0x12ac92[_0x138ebf(0x97b)];_0x12ac92[_0x138ebf(0x97b)]=_0x138ebf(0x1064),_0x12ac92[_0x138ebf(0xfce)]=!![];const _0x2e9593=document[_0x138ebf(0xbd5)](_0x138ebf(0x6c8)),_0x1d3668=document[_0x138ebf(0x479)]('phone-screen');_0x2e9593[_0x138ebf(0x10dd)][_0x138ebf(0x9f2)]=_0x1d3668['offsetWidth']+'px',_0x2e9593['style'][_0x138ebf(0xee0)]=_0x138ebf(0x10f8),_0x2e9593['style'][_0x138ebf(0xb8f)]=_0x138ebf(0xb15),_0x2e9593[_0x138ebf(0x10dd)][_0x138ebf(0x138f)]=_0x138ebf(0xb15),_0x2e9593[_0x138ebf(0x10dd)][_0x138ebf(0x678)]=_0x138ebf(0x899),_0x2e9593[_0x138ebf(0x10dd)][_0x138ebf(0xaba)]='column',_0x2e9593['style'][_0x138ebf(0xe41)]=_0x138ebf(0x260);const _0x55d2ad=document[_0x138ebf(0x479)](_0x138ebf(0xdeb));_0x2e9593[_0x138ebf(0x10dd)]['backgroundImage']=_0x55d2ad['style'][_0x138ebf(0x13b9)],_0x2e9593[_0x138ebf(0x10dd)]['backgroundColor']=_0x55d2ad[_0x138ebf(0x10dd)][_0x138ebf(0x11a6)]||(document[_0x138ebf(0x479)](_0x138ebf(0x2e2))[_0x138ebf(0x9cd)][_0x138ebf(0x658)](_0x138ebf(0x9dd))?_0x138ebf(0xb38):_0x138ebf(0x1389));const _0x3ffe88=document[_0x138ebf(0xbd5)](_0x138ebf(0x10dd));_0x3ffe88[_0x138ebf(0x3de)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.message-bubble.selected::after\x20{\x20display:\x20none\x20!important;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cloned-header\x20.default-controls\x20{\x20display:\x20flex\x20!important;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20width:\x20100%;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cloned-header\x20.selection-controls\x20{\x20display:\x20none\x20!important;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',document[_0x138ebf(0x581)][_0x138ebf(0x9f4)](_0x3ffe88);try{const _0x13ed76=_0x55d2ad[_0x138ebf(0x8bc)](_0x138ebf(0x59b))['cloneNode'](!![]);_0x13ed76[_0x138ebf(0x9cd)][_0x138ebf(0x807)]('cloned-header');const _0x5a72d3=document[_0x138ebf(0xbd5)](_0x138ebf(0x6c8)),_0x5f4f98=document[_0x138ebf(0x479)](_0x138ebf(0x659));_0x5a72d3['style']['display']=_0x138ebf(0x899),_0x5a72d3[_0x138ebf(0x10dd)]['flexDirection']=_0x138ebf(0xf6e),_0x5a72d3['style']['gap']=_0x138ebf(0x1117),_0x5a72d3[_0x138ebf(0x10dd)]['padding']='10px\x2015px\x2020px\x2015px',_0x5a72d3[_0x138ebf(0x10dd)][_0x138ebf(0x9f2)]=_0x138ebf(0x38c),_0x5a72d3[_0x138ebf(0x10dd)][_0x138ebf(0x319)]='border-box',_0x5a72d3[_0x138ebf(0x13d4)]['theme']=_0x5f4f98[_0x138ebf(0x13d4)][_0x138ebf(0x1057)],_0x5a72d3[_0x138ebf(0x10dd)][_0x138ebf(0xc76)](_0x138ebf(0x83a),_0x5f4f98['style']['getPropertyValue'](_0x138ebf(0x83a)));const _0x31c5f6=_0x55d2ad[_0x138ebf(0x8bc)](_0x138ebf(0x12f1))[_0x138ebf(0xbcf)](!![]),_0x18656e=[..._0x373eab][_0x138ebf(0x382)]((_0x27b76b,_0x5558f2)=>_0x27b76b-_0x5558f2);_0x18656e[_0x138ebf(0x12be)](_0x31d46c=>{const _0x4f3d07=_0x138ebf,_0x5e4fee=document['querySelector'](_0x4f3d07(0x7b8)+_0x31d46c+'\x22]');if(_0x5e4fee){const _0x4c8485=_0x5e4fee['closest']('.message-wrapper');_0x4c8485&&_0x5a72d3['appendChild'](_0x4c8485[_0x4f3d07(0xbcf)](!![]));}}),_0x2e9593[_0x138ebf(0x9f4)](_0x13ed76),_0x2e9593[_0x138ebf(0x9f4)](_0x5a72d3),_0x2e9593[_0x138ebf(0x9f4)](_0x31c5f6),document[_0x138ebf(0xc78)][_0x138ebf(0x9f4)](_0x2e9593);const _0x40f565=Array['from'](_0x2e9593[_0x138ebf(0x881)]('img')),_0x4065b7=_0x40f565[_0x138ebf(0x2e1)](_0x166fae=>new Promise((_0x558211,_0x815f71)=>{const _0x5834ea=_0x138ebf;if(_0x166fae[_0x5834ea(0xa9c)]['startsWith'](_0x5834ea(0x623))){_0x558211();return;}const _0x5bc61d=new Image();_0x5bc61d[_0x5834ea(0x86e)]=_0x5834ea(0x9ff),_0x5bc61d[_0x5834ea(0x502)]=_0x558211,_0x5bc61d[_0x5834ea(0x1337)]=_0x558211,_0x5bc61d['src']=_0x166fae[_0x5834ea(0xa9c)];}));await Promise[_0x138ebf(0xf78)](_0x4065b7);const _0x13b07d=await html2canvas(_0x2e9593,{'allowTaint':!![],'useCORS':!![],'backgroundColor':null,'scale':window[_0x138ebf(0x945)]||0x2});_0x13b07d[_0x138ebf(0x297)](function(_0x572b37){const _0x8cad65=_0x138ebf,_0x114ecc=URL[_0x8cad65(0xe9c)](_0x572b37),_0x5d0a45=document[_0x8cad65(0xbd5)]('a');_0x5d0a45[_0x8cad65(0x11d0)]=_0x8cad65(0x9ed)+_0x5a8949[_0x8cad65(0x564)]+'-'+Date[_0x8cad65(0x12d6)]()+_0x8cad65(0x1200),_0x5d0a45[_0x8cad65(0x2fa)]=_0x114ecc,document[_0x8cad65(0xc78)]['appendChild'](_0x5d0a45),_0x5d0a45[_0x8cad65(0xd2f)](),document['body'][_0x8cad65(0x20d)](_0x5d0a45),URL[_0x8cad65(0xed5)](_0x114ecc);},'image/png');}catch(_0x21d778){console[_0x138ebf(0xe3b)](_0x138ebf(0x571),_0x21d778),await _0x1519c8(_0x138ebf(0xebe),_0x138ebf(0x404));}finally{document[_0x138ebf(0xc78)][_0x138ebf(0x20d)](_0x2e9593),document[_0x138ebf(0x581)]['removeChild'](_0x3ffe88),_0x12ac92[_0x138ebf(0x97b)]=_0x59175d,_0x12ac92[_0x138ebf(0xfce)]=![],_0x24d789();}}function _0x23554f(_0x4dc593){const _0x5f34a4=_0x85c4bf;if(!_0x4dc593||typeof _0x4dc593!=='string')return'';return _0x4dc593=_0x4dc593['replace'](/!h\{(.*?)\}/g,_0x5f34a4(0x890)),_0x4dc593=_0x4dc593[_0x5f34a4(0x491)](/!u\{(.*?)\}/g,_0x5f34a4(0x104f)),_0x4dc593=_0x4dc593['replace'](/!e\{(.*?)\}/g,_0x5f34a4(0xf71)),_0x4dc593=_0x4dc593[_0x5f34a4(0x491)](/!w\{(.*?)\}/g,_0x5f34a4(0xd7f)),_0x4dc593=_0x4dc593[_0x5f34a4(0x491)](/!m\{(.*?)\}/g,_0x5f34a4(0xcf2)),_0x4dc593=_0x4dc593[_0x5f34a4(0x491)](/\|\|(.*?)\|\|/g,_0x5f34a4(0x7ca)),_0x4dc593=_0x4dc593[_0x5f34a4(0x491)](/\*\*(.*?)\*\*/g,'<strong>$1</strong>'),_0x4dc593=_0x4dc593[_0x5f34a4(0x491)](/\~\~(.*?)\~\~/g,_0x5f34a4(0xd98)),_0x4dc593=_0x4dc593[_0x5f34a4(0x491)](/\*(.*?)\*/g,'<em>$1</em>'),_0x4dc593;}async function _0x6aa3a4(){const _0x25b747=_0x85c4bf;console[_0x25b747(0x90f)]('开始检查并迁移旧的红包数据...');let _0x539fc8=0x0;const _0x1bf3f4=Object[_0x25b747(0x3d5)](_0x505390[_0x25b747(0x1027)]);for(const _0x146f91 of _0x1bf3f4){let _0x37f39e=![];for(const _0x9fe30c of _0x146f91[_0x25b747(0x7d3)]){_0x9fe30c['type']===_0x25b747(0x1358)&&_0x9fe30c[_0x25b747(0xeaf)]===_0x25b747(0x211)&&_0x9fe30c['role']===_0x25b747(0x1328)&&_0x9fe30c['hasOwnProperty'](_0x25b747(0xd00))&&!_0x9fe30c[_0x25b747(0x119e)](_0x25b747(0xfd7))&&(_0x9fe30c[_0x25b747(0xfd7)]=_0x9fe30c['receiver'],delete _0x9fe30c[_0x25b747(0xd00)],_0x37f39e=!![],_0x539fc8++);}_0x37f39e&&(console[_0x25b747(0x90f)](_0x25b747(0x8ec)+_0x146f91[_0x25b747(0x564)]+_0x25b747(0x1199)),await _0xb81d4e['chats'][_0x25b747(0x5d0)](_0x146f91));}_0x539fc8>0x0?(console['log']('数据迁移完成！总共修复了\x20'+_0x539fc8+_0x25b747(0x69f)),alert(_0x25b747(0x8eb)+_0x539fc8+_0x25b747(0x1f1)),location[_0x25b747(0x4ac)]()):console['log'](_0x25b747(0x95b));}function _0x54ec9e(_0xca9812){const _0x4e6733=_0x85c4bf,_0x30327f=_0x505390[_0x4e6733(0x1027)][_0xca9812];if(!_0x30327f||_0x30327f[_0x4e6733(0x9d7)])return;document[_0x4e6733(0x479)](_0x4e6733(0x868))[_0x4e6733(0x97b)]=_0x30327f['heartfeltVoice']||_0x4e6733(0x4d0),document[_0x4e6733(0x479)](_0x4e6733(0x4aa))['textContent']=_0x30327f[_0x4e6733(0x2cf)]||_0x4e6733(0x4d0);const _0x5b3678=document[_0x4e6733(0x479)](_0x4e6733(0x1169));_0x5b3678[_0x4e6733(0x9cd)][_0x4e6733(0x807)](_0x4e6733(0x45a));}function _0x1d8d32(){const _0x2345fb=_0x85c4bf;document[_0x2345fb(0x479)]('profile-main-content')[_0x2345fb(0x10dd)][_0x2345fb(0x678)]=_0x2345fb(0xff8),document['getElementById'](_0x2345fb(0x136d))['style']['display']='flex',_0x1a1740();}function _0x4bc641(){const _0x2e4dbd=_0x85c4bf;document[_0x2e4dbd(0x479)]('profile-thoughts-history-view')[_0x2e4dbd(0x10dd)][_0x2e4dbd(0x678)]='none',document[_0x2e4dbd(0x479)](_0x2e4dbd(0xc68))[_0x2e4dbd(0x10dd)]['display']=_0x2e4dbd(0x899);}function _0x1a1740(){const _0x367fb9=_0x85c4bf,_0x487063=document[_0x367fb9(0x479)](_0x367fb9(0x12c3)),_0x532f9a=_0x505390[_0x367fb9(0x1027)][_0x505390[_0x367fb9(0x233)]];_0x487063[_0x367fb9(0x3de)]='';if(!_0x532f9a||!_0x532f9a[_0x367fb9(0x57e)]||_0x532f9a[_0x367fb9(0x57e)][_0x367fb9(0x990)]===0x0){_0x487063[_0x367fb9(0x3de)]='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20padding:\x2030px\x200;\x22>这里还没有历史记录哦。</p>';return;}const _0x4d72b8=[..._0x532f9a[_0x367fb9(0x57e)]][_0x367fb9(0x336)](),_0xea752e=_0x4d72b8['slice'](0x0,_0x6aead8);_0xea752e[_0x367fb9(0x12be)](_0x16eea8=>{const _0x56ced2=_0x367fb9,_0x3e5601=_0x29c7fe(_0x16eea8);_0x487063[_0x56ced2(0x9f4)](_0x3e5601);}),_0xd87e3c=_0xea752e['length'],_0x4d72b8[_0x367fb9(0x990)]>_0xd87e3c&&appendLoadMoreThoughtsButton(_0x487063);}async function _0x44d3b7(){const _0x15e47e=_0x85c4bf;if(_0x393522)return;_0x393522=!![];const _0x4285c6=document[_0x15e47e(0x479)](_0x15e47e(0x12c3)),_0xc7f41f=_0x505390['chats'][_0x505390[_0x15e47e(0x233)]];if(!_0xc7f41f){_0x393522=![];return;}_0x13e918(_0x4285c6,_0x15e47e(0xeb7)),await new Promise(_0x8854c3=>setTimeout(_0x8854c3,0x1f4));const _0x488b83=[..._0xc7f41f[_0x15e47e(0x57e)]][_0x15e47e(0x336)](),_0x1d92c8=_0x488b83[_0x15e47e(0x990)],_0x224e87=_0xd87e3c,_0x35c2c6=_0xd87e3c+_0x6aead8,_0x4ae055=_0x488b83['slice'](_0x224e87,_0x35c2c6);_0x168e5c(_0x4285c6),_0x4ae055[_0x15e47e(0x12be)](_0x265b0e=>{const _0x2ecd68=_0x29c7fe(_0x265b0e);_0x4285c6['appendChild'](_0x2ecd68);}),_0xd87e3c+=_0x4ae055[_0x15e47e(0x990)],_0x393522=![];}function _0x29c7fe(_0x243399){const _0x444875=_0x85c4bf,_0xe640c=document[_0x444875(0xbd5)](_0x444875(0x6c8));_0xe640c[_0x444875(0xfd4)]=_0x444875(0xf6b);const _0x5189f8=new Date(_0x243399[_0x444875(0x12a2)]),_0x5094e2=_0x5189f8[_0x444875(0xd45)]()+'-'+String(_0x5189f8[_0x444875(0x180)]()+0x1)[_0x444875(0x738)](0x2,'0')+'-'+String(_0x5189f8[_0x444875(0x469)]())[_0x444875(0x738)](0x2,'0')+'\x20'+String(_0x5189f8['getHours']())['padStart'](0x2,'0')+':'+String(_0x5189f8[_0x444875(0x28c)]())['padStart'](0x2,'0');return _0xe640c['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22thought-delete-btn\x22\x20data-timestamp=\x22'+_0x243399[_0x444875(0x12a2)]+_0x444875(0x7fa)+_0x5094e2+_0x444875(0x104e)+_0x243399['heartfeltVoice']+_0x444875(0xd29)+_0x243399[_0x444875(0x2cf)]+_0x444875(0x759),_0xe640c;}async function _0x3ecc85(_0x312668){const _0x40227f=_0x85c4bf,_0x332c28=_0x312668[_0x40227f(0xfa2)][_0x40227f(0xe63)][0x0];if(!_0x332c28)return;try{let _0x31c763,_0x3c71c7=null;if(_0x332c28[_0x40227f(0x564)][_0x40227f(0x1193)](_0x40227f(0x1a6))){const _0x5ee8fa=await _0x332c28[_0x40227f(0x56d)]();_0x31c763=JSON[_0x40227f(0x94c)](_0x5ee8fa);}else{if(_0x332c28[_0x40227f(0x564)][_0x40227f(0x1193)](_0x40227f(0x1200))){const _0x30ad8b=await _0x332c28[_0x40227f(0x4bb)]();_0x31c763=await _0x334ab3(_0x30ad8b),_0x3c71c7=await new Promise(_0x2640f8=>{const _0x58ead9=_0x40227f,_0xab0a3f=new FileReader();_0xab0a3f[_0x58ead9(0x502)]=()=>_0x2640f8(_0xab0a3f[_0x58ead9(0x97e)]),_0xab0a3f[_0x58ead9(0x83c)](_0x332c28);});}else throw new Error(_0x40227f(0xf7e));}await _0x5e7bf0(_0x31c763,_0x3c71c7);}catch(_0x3738f1){console[_0x40227f(0xe3b)]('角色卡导入失败:',_0x3738f1),await _0x1519c8(_0x40227f(0xf28),_0x40227f(0x1113)+_0x3738f1['message']);}finally{_0x312668[_0x40227f(0xfa2)][_0x40227f(0x4e0)]=null;}}function _0x334ab3(_0x233aec){return new Promise((_0x1e8401,_0xdc2d5)=>{const _0x25e1ef=_0x6666,_0x14b163=new DataView(_0x233aec);if(_0x14b163[_0x25e1ef(0x1168)](0x0)!==0x89504e47||_0x14b163[_0x25e1ef(0x1168)](0x4)!==0xd0a1a0a)return _0xdc2d5(new Error('文件不是一个有效的PNG。'));let _0x1c41a=0x8;const _0x4e5b16=new TextDecoder();while(_0x1c41a<_0x14b163[_0x25e1ef(0x4bf)]){const _0x3c29a5=_0x14b163[_0x25e1ef(0x1168)](_0x1c41a),_0xca95f1=_0x4e5b16['decode'](_0x233aec['slice'](_0x1c41a+0x4,_0x1c41a+0x8));if(_0xca95f1===_0x25e1ef(0xa59)){const _0x34dfcb=new Uint8Array(_0x233aec,_0x1c41a+0x8,_0x3c29a5),_0x3bee0f=_0x34dfcb[_0x25e1ef(0xf2f)](0x0);if(_0x3bee0f!==-0x1){const _0x291300=_0x4e5b16[_0x25e1ef(0xc79)](_0x34dfcb[_0x25e1ef(0x777)](0x0,_0x3bee0f));if(_0x291300===_0x25e1ef(0xa89)){const _0x1fd88=_0x4e5b16[_0x25e1ef(0xc79)](_0x34dfcb[_0x25e1ef(0x777)](_0x3bee0f+0x1));try{const _0x10fa57=atob(_0x1fd88),_0x4bf205=new Uint8Array(_0x10fa57[_0x25e1ef(0x990)]);for(let _0x35fe23=0x0;_0x35fe23<_0x10fa57[_0x25e1ef(0x990)];_0x35fe23++){_0x4bf205[_0x35fe23]=_0x10fa57['charCodeAt'](_0x35fe23);}const _0x172dc4=new TextDecoder(_0x25e1ef(0x429))[_0x25e1ef(0xc79)](_0x4bf205);_0x1e8401(JSON[_0x25e1ef(0x94c)](_0x172dc4));return;}catch(_0x3b83c9){return _0xdc2d5(new Error('在PNG中找到角色数据，但解码或解析失败。错误:\x20'+_0x3b83c9[_0x25e1ef(0x757)]));}}}}_0x1c41a+=0x4+0x4+_0x3c29a5+0x4;}_0xdc2d5(new Error(_0x25e1ef(0x450)));});}function _0x493b6e(_0x5d7a34){const _0x3966a8=_0x85c4bf;if(_0x5d7a34['data']?.[_0x3966a8(0x11c5)]?.[_0x3966a8(0xef7)]?.[_0x3966a8(0x990)]>0x0)return console[_0x3966a8(0x90f)]('诊断：在\x20data.character_book\x20中找到世界书。'),_0x5d7a34[_0x3966a8(0x104c)][_0x3966a8(0x11c5)][_0x3966a8(0xef7)];if(_0x5d7a34[_0x3966a8(0x1333)]?.['character_book']?.[_0x3966a8(0xef7)]?.[_0x3966a8(0x990)]>0x0)return console[_0x3966a8(0x90f)](_0x3966a8(0x89e)),_0x5d7a34['extensions'][_0x3966a8(0x11c5)][_0x3966a8(0xef7)];if(_0x5d7a34[_0x3966a8(0x104c)]?.[_0x3966a8(0x1333)]?.[_0x3966a8(0x11c5)]?.[_0x3966a8(0xef7)]?.[_0x3966a8(0x990)]>0x0)return console[_0x3966a8(0x90f)](_0x3966a8(0x1146)),_0x5d7a34[_0x3966a8(0x104c)][_0x3966a8(0x1333)][_0x3966a8(0x11c5)][_0x3966a8(0xef7)];const _0x139e91=[_0x3966a8(0x11c5),_0x3966a8(0x8e3),_0x3966a8(0x715),_0x3966a8(0xa1f)];for(const _0x14c464 of _0x139e91){if(_0x5d7a34[_0x14c464]?.[_0x3966a8(0xef7)]?.['length']>0x0)return console[_0x3966a8(0x90f)](_0x3966a8(0xd78)+_0x14c464+'\x20中找到世界书。'),_0x5d7a34[_0x14c464][_0x3966a8(0xef7)];}return console[_0x3966a8(0x90f)]('诊断：未在此角色卡中找到任何有效的世界书数据。'),null;}async function _0x5e7bf0(_0x38416e,_0x2d8360=null){const _0x4052fb=_0x85c4bf,_0x33d6cb=_0x38416e[_0x4052fb(0x104c)]||_0x38416e;if(!_0x33d6cb[_0x4052fb(0x564)])throw new Error(_0x4052fb(0x13b0));let _0x586d3b=null;const _0x28c9a4=_0x493b6e(_0x38416e);if(_0x28c9a4){const _0x34cd87=_0x28c9a4['filter'](_0x5a4b73=>_0x5a4b73[_0x4052fb(0x2b7)]&&_0x5a4b73[_0x4052fb(0xac4)])[_0x4052fb(0x2e1)](_0x140ffe=>({'keys':_0x140ffe[_0x4052fb(0x108c)]||[],'comment':_0x140ffe[_0x4052fb(0xd6c)]||'','content':_0x140ffe[_0x4052fb(0xac4)][_0x4052fb(0x491)](/<memory>|<\/memory>/g,'')['trim']()}));if(_0x34cd87[_0x4052fb(0x990)]>0x0){const _0x2ec96a={'id':_0x4052fb(0xdb4)+Date[_0x4052fb(0x12d6)](),'name':_0x33d6cb[_0x4052fb(0x564)]+_0x4052fb(0x1320),'content':_0x34cd87,'categoryId':null};await _0xb81d4e[_0x4052fb(0xd1b)][_0x4052fb(0x807)](_0x2ec96a),_0x505390[_0x4052fb(0xd1b)][_0x4052fb(0x1a0)](_0x2ec96a),_0x586d3b=_0x2ec96a['id'];}}let _0x3b8aed=_0x33d6cb[_0x4052fb(0x78b)]||_0x38416e[_0x4052fb(0x78b)]||'无';_0x3b8aed=_0x3b8aed[_0x4052fb(0x491)](/```yaml/g,'')[_0x4052fb(0x491)](/```/g,'')[_0x4052fb(0x491)](/<\/?info>/g,'')[_0x4052fb(0x491)](/<\/?character>/g,'')[_0x4052fb(0x491)](/<\/?writing_rule>/g,'')[_0x4052fb(0x491)](/\[OOC：.*?\]/g,'')[_0x4052fb(0x9c1)]();let _0x2ac410=_0x4052fb(0x2d8)+_0x3b8aed+'\x0a\x0a';if(_0x33d6cb[_0x4052fb(0x10c2)])_0x2ac410+=_0x4052fb(0x1cb)+_0x33d6cb['personality']+'\x0a\x0a';if(_0x33d6cb[_0x4052fb(0x296)])_0x2ac410+=_0x4052fb(0xb68)+_0x33d6cb[_0x4052fb(0x296)]+'\x0a\x0a';if(_0x33d6cb['mes_example'])_0x2ac410+='#\x20对话示例\x0a'+_0x33d6cb[_0x4052fb(0xd1d)]+'\x0a\x0a';const _0x312bc3=_0x33d6cb[_0x4052fb(0x564)],_0x32bcf2=_0x33d6cb[_0x4052fb(0x564)],_0x28d23a=_0x4052fb(0x8f9)+Date['now'](),_0x299400={'id':_0x28d23a,'name':_0x312bc3[_0x4052fb(0x9c1)](),'originalName':_0x32bcf2['trim'](),'isGroup':![],'relationship':{'status':'friend'},'status':{'text':'在线','lastUpdate':Date[_0x4052fb(0x12d6)](),'isBusy':![]},'settings':{'aiPersona':_0x2ac410,'myPersona':_0x4052fb(0x13ae),'maxMemory':0xa,'aiAvatar':_0x28c106,'myAvatar':_0x28c106,'background':'','theme':'default','fontSize':0xd,'customCss':'','linkedWorldBookIds':_0x586d3b?[_0x586d3b]:[],'aiAvatarLibrary':[]},'history':[],'musicData':{'totalTime':0x0},'longTermMemory':[]};_0x2d8360&&(_0x299400[_0x4052fb(0x18a)][_0x4052fb(0x1039)]=_0x2d8360,_0x299400[_0x4052fb(0x18a)][_0x4052fb(0x8c6)][_0x4052fb(0x1a0)]({'name':_0x4052fb(0xbc2),'url':_0x2d8360}));const _0x2a5a3d=_0x33d6cb[_0x4052fb(0x753)]||_0x38416e[_0x4052fb(0x753)];if(_0x2a5a3d&&typeof _0x2a5a3d===_0x4052fb(0x8d9)){const _0x59389e=document['createElement']('div');_0x59389e['innerHTML']=_0x2a5a3d;const _0x1e2d2a=(_0x59389e['textContent']||_0x59389e['innerText']||'')[_0x4052fb(0x491)](/原作者UR.*?开局/s,'')[_0x4052fb(0x9c1)]();_0x1e2d2a&&_0x299400[_0x4052fb(0x7d3)][_0x4052fb(0x1a0)]({'role':_0x4052fb(0x1328),'senderName':_0x299400['originalName'],'content':_0x1e2d2a,'timestamp':Date[_0x4052fb(0x12d6)]()});}_0x505390[_0x4052fb(0x1027)][_0x28d23a]=_0x299400,await _0xb81d4e[_0x4052fb(0x1027)]['put'](_0x299400),_0x1b7f69();let _0x2b211f='角色\x20“'+_0x299400[_0x4052fb(0x564)]+_0x4052fb(0x414);_0x586d3b&&(_0x2b211f+=_0x4052fb(0xa0d)),await _0x1519c8(_0x4052fb(0x10b1),_0x2b211f);}async function _0x2b88d0(){const _0x62d185=_0x85c4bf;if(!_0x505390['activeChatId'])return;const _0x1f36b6=_0x505390['chats'][_0x505390[_0x62d185(0x233)]],_0x2bec03=_0x1f36b6[_0x62d185(0x18a)][_0x62d185(0x80d)];if(!_0x2bec03||_0x2bec03[_0x62d185(0x990)]===0x0){alert(_0x62d185(0x12bb));return;}const _0x5bb628=_0x2bec03[_0x62d185(0x2e1)]((_0x248678,_0x537566)=>{const _0x3f9cf1=_0x62d185,_0xe12141=_0x248678['replace'](/<[^>]*>/g,'')['trim']()[_0x3f9cf1(0x1323)](0x0,0x14);return{'text':'开场\x20'+(_0x537566+0x1)+':\x20'+_0xe12141+'...','value':_0x537566};}),_0x544eef=await _0x5adb5e(_0x62d185(0x41f),_0x5bb628);if(_0x544eef!==null){const _0x3e4b28=await _0x1a9e79('确认操作','切换开场将会【清空并替换】当前的所有聊天记录。确定要继续吗？',{'confirmButtonClass':_0x62d185(0x95a),'confirmText':_0x62d185(0xfaf)});if(_0x3e4b28){const _0x588632=_0x2bec03[_0x544eef],_0x3b531f={'role':_0x62d185(0x1328),'senderName':_0x1f36b6['originalName'],'content':_0x588632,'timestamp':Date[_0x62d185(0x12d6)]()};_0x1f36b6[_0x62d185(0x7d3)]=[_0x3b531f],await _0xb81d4e['chats'][_0x62d185(0x5d0)](_0x1f36b6),_0x474d6b(_0x1f36b6['id']),document[_0x62d185(0x479)](_0x62d185(0xedb))[_0x62d185(0x9cd)]['remove'](_0x62d185(0x45a)),await _0x1519c8('成功','已切换到新的开场故事！');}}}function _0x5951c9(_0x51b1c1={'keys':[],'comment':'','content':'','enabled':!![]}){const _0x4438fd=_0x85c4bf,_0x141b86=document[_0x4438fd(0xbd5)]('div');_0x141b86['className']='message-editor-block';const _0x278c5b=_0x51b1c1[_0x4438fd(0x2b7)]!==![]?'checked':'';return _0x141b86[_0x4438fd(0x3de)]=_0x4438fd(0xeed)+_0x278c5b+'>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22slider\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条目\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>备注\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-comment-input\x22\x20value=\x22'+(_0x51b1c1[_0x4438fd(0xd6c)]||'')+_0x4438fd(0x1ae)+(_0x51b1c1[_0x4438fd(0x108c)]||[])['join'](',\x20')+'\x22\x20placeholder=\x22例如:\x20key1,\x20key2,\x20key3\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>内容</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20class=\x22entry-content-textarea\x22\x20rows=\x225\x22\x20style=\x22width:\x20100%;\x20font-size:\x2014px;\x22>'+(_0x51b1c1['content']||'')+'</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x141b86['querySelector'](_0x4438fd(0x895))[_0x4438fd(0xa75)]('click',()=>{const _0x2bd945=_0x4438fd;_0x141b86[_0x2bd945(0x8b6)]();}),_0x141b86;}async function _0x9b6ea8(){const _0x5a4e74=_0x85c4bf;if(!_0x505390[_0x5a4e74(0x233)])return;const _0x51c1ee=_0x505390[_0x5a4e74(0x233)],_0x300615=document[_0x5a4e74(0x479)](_0x5a4e74(0x75a));if(!_0x300615[_0x5a4e74(0x9cd)][_0x5a4e74(0x658)](_0x5a4e74(0x45a))){const _0x4c2838=document[_0x5a4e74(0x8bc)](_0x5a4e74(0x7da));_0x300615[_0x5a4e74(0x10dd)]['top']=_0x4c2838[_0x5a4e74(0xfc5)]+'px',_0x300615[_0x5a4e74(0x10dd)][_0x5a4e74(0x678)]=_0x5a4e74(0xee3),(!_0x5aa690[_0x51c1ee]||!_0x5aa690[_0x51c1ee][_0x5a4e74(0x4c3)])&&_0x51289b(_0x51c1ee),_0x29f68d(_0x51c1ee),setTimeout(async()=>{const _0x37dfce=_0x5a4e74;_0x300615[_0x37dfce(0x9cd)][_0x37dfce(0x807)](_0x37dfce(0x45a));const _0x3286f0={'role':_0x37dfce(0xbaa),'content':_0x37dfce(0x1145),'timestamp':Date[_0x37dfce(0x12d6)](),'isHidden':!![]};_0x505390[_0x37dfce(0x1027)][_0x51c1ee][_0x37dfce(0x7d3)][_0x37dfce(0x1a0)](_0x3286f0),await _0xb81d4e[_0x37dfce(0x1027)]['put'](_0x505390[_0x37dfce(0x1027)][_0x51c1ee]);},0xa);}else await _0xe46500();}async function _0xe46500(){const _0x19c8eb=_0x85c4bf;if(!_0x505390[_0x19c8eb(0x233)])return;const _0x390f94=_0x505390[_0x19c8eb(0x233)],_0x5e337a=document[_0x19c8eb(0x479)]('gomoku-overlay');_0x5e337a[_0x19c8eb(0x9cd)][_0x19c8eb(0x8b6)](_0x19c8eb(0x45a)),setTimeout(()=>{const _0x470240=_0x19c8eb;_0x5e337a[_0x470240(0x10dd)][_0x470240(0x678)]=_0x470240(0xff8);},0x12c);if(_0x5aa690[_0x390f94]){_0x5aa690[_0x390f94][_0x19c8eb(0x4c3)]=![];const _0x30a7df={'role':'system','content':_0x19c8eb(0x5be),'timestamp':Date['now'](),'isHidden':!![]};_0x505390['chats'][_0x390f94][_0x19c8eb(0x7d3)]['push'](_0x30a7df),await _0xb81d4e[_0x19c8eb(0x1027)][_0x19c8eb(0x5d0)](_0x505390[_0x19c8eb(0x1027)][_0x390f94]);}}function _0x51289b(_0x437264){const _0x3f4b56=_0x85c4bf,_0x540966=document[_0x3f4b56(0x479)](_0x3f4b56(0x11fd)),_0xad78fb=document['getElementById'](_0x3f4b56(0x75a)),_0x4bb1f4=document['getElementById'](_0x3f4b56(0x931)),_0x36461d=_0xad78fb['offsetWidth']-0x28,_0x2e7b9d=_0xad78fb[_0x3f4b56(0xfc5)]-_0x4bb1f4[_0x3f4b56(0xfc5)]-0x28,_0x10a15d=Math[_0x3f4b56(0xd71)](Math[_0x3f4b56(0x80f)](_0x36461d,_0x2e7b9d)),_0x4882fd=0xf,_0x2bf9f0=Math[_0x3f4b56(0xd71)](_0x10a15d/_0x4882fd),_0x611f71=_0x2bf9f0*_0x4882fd;_0x540966[_0x3f4b56(0x9f2)]=_0x611f71,_0x540966[_0x3f4b56(0xe41)]=_0x611f71,_0x5aa690[_0x437264]={'isActive':!![],'board':Array(_0x4882fd)[_0x3f4b56(0x4d8)](0x0)[_0x3f4b56(0x2e1)](()=>Array(_0x4882fd)[_0x3f4b56(0x4d8)](0x0)),'currentPlayer':0x1,'history':[],'isGameOver':![],'GRID_SIZE':_0x4882fd,'CELL_SIZE':_0x2bf9f0};}function _0x29f68d(_0x7066ed){const _0x4ad6ad=_0x85c4bf,_0x3e3d6f=_0x5aa690[_0x7066ed];if(!_0x3e3d6f)return;const _0x2c831b=document['getElementById'](_0x4ad6ad(0x11fd)),_0x4480e2=_0x2c831b[_0x4ad6ad(0x1b4)]('2d'),{GRID_SIZE:_0x5eb1a3,CELL_SIZE:_0x187f02}=_0x3e3d6f,_0x26b1ba=_0x187f02/0x2;_0x4480e2[_0x4ad6ad(0x6bf)](0x0,0x0,_0x2c831b[_0x4ad6ad(0x9f2)],_0x2c831b[_0x4ad6ad(0xe41)]),_0x4480e2[_0x4ad6ad(0x8da)]=_0x4ad6ad(0x1112),_0x4480e2['fillRect'](0x0,0x0,_0x2c831b['width'],_0x2c831b[_0x4ad6ad(0xe41)]),_0x4480e2[_0x4ad6ad(0x1263)]=_0x4ad6ad(0xa48),_0x4480e2[_0x4ad6ad(0x42b)]=0x1;for(let _0x4ad0aa=0x0;_0x4ad0aa<_0x5eb1a3;_0x4ad0aa++){_0x4480e2[_0x4ad6ad(0xcbd)](),_0x4480e2[_0x4ad6ad(0xaa3)](_0x26b1ba,_0x26b1ba+_0x4ad0aa*_0x187f02),_0x4480e2[_0x4ad6ad(0x89d)](_0x2c831b[_0x4ad6ad(0x9f2)]-_0x26b1ba,_0x26b1ba+_0x4ad0aa*_0x187f02),_0x4480e2[_0x4ad6ad(0x1201)](),_0x4480e2[_0x4ad6ad(0xcbd)](),_0x4480e2[_0x4ad6ad(0xaa3)](_0x26b1ba+_0x4ad0aa*_0x187f02,_0x26b1ba),_0x4480e2['lineTo'](_0x26b1ba+_0x4ad0aa*_0x187f02,_0x2c831b[_0x4ad6ad(0xe41)]-_0x26b1ba),_0x4480e2[_0x4ad6ad(0x1201)]();}for(let _0x2ce750=0x0;_0x2ce750<_0x5eb1a3;_0x2ce750++){for(let _0x52db91=0x0;_0x52db91<_0x5eb1a3;_0x52db91++){_0x3e3d6f[_0x4ad6ad(0x206)][_0x2ce750][_0x52db91]!==0x0&&_0x36f499(_0x4480e2,_0x52db91,_0x2ce750,_0x3e3d6f[_0x4ad6ad(0x206)][_0x2ce750][_0x52db91],_0x3e3d6f);}}}function _0x36f499(_0x5fe877,_0x39e72a,_0x5a2bc3,_0x31f794,_0x3da649){const _0xfe985b=_0x85c4bf,{CELL_SIZE:_0xe28c87}=_0x3da649,_0x9d6ef1=_0xe28c87/0x2,_0x3eadbb=_0xe28c87/0x2-0x2;_0x5fe877['beginPath'](),_0x5fe877[_0xfe985b(0x358)](_0x9d6ef1+_0x39e72a*_0xe28c87,_0x9d6ef1+_0x5a2bc3*_0xe28c87,_0x3eadbb,0x0,0x2*Math['PI']),_0x31f794===0x1?_0x5fe877[_0xfe985b(0x8da)]=_0xfe985b(0x12b7):_0x5fe877[_0xfe985b(0x8da)]=_0xfe985b(0x505),_0x5fe877[_0xfe985b(0x4d8)]();}function _0x4f2503(_0x53b1a8){const _0x1d984d=_0x85c4bf,_0x20a91b=_0x505390['activeChatId'],_0x51c9b1=_0x5aa690[_0x20a91b];if(!_0x51c9b1||_0x51c9b1['isGameOver']||_0x51c9b1[_0x1d984d(0x1072)]!==0x1)return;const _0xb082e9=document[_0x1d984d(0x479)](_0x1d984d(0x11fd)),_0xb0f9eb=_0xb082e9[_0x1d984d(0x1b4)]('2d'),_0x25a8df=_0xb082e9[_0x1d984d(0x10f7)](),_0xc0dbb5=_0x53b1a8[_0x1d984d(0x221)]-_0x25a8df[_0x1d984d(0x138f)],_0x4ffead=_0x53b1a8[_0x1d984d(0x87b)]-_0x25a8df['top'],_0x41f3ed=Math['round']((_0xc0dbb5-_0x51c9b1['CELL_SIZE']/0x2)/_0x51c9b1[_0x1d984d(0x1186)]),_0x1e7f6d=Math[_0x1d984d(0x412)]((_0x4ffead-_0x51c9b1[_0x1d984d(0x1186)]/0x2)/_0x51c9b1[_0x1d984d(0x1186)]);_0x29f68d(_0x20a91b);if(_0x41f3ed>=0x0&&_0x41f3ed<_0x51c9b1[_0x1d984d(0xb37)]&&_0x1e7f6d>=0x0&&_0x1e7f6d<_0x51c9b1[_0x1d984d(0xb37)]&&_0x51c9b1[_0x1d984d(0x206)][_0x1e7f6d][_0x41f3ed]===0x0){const _0x9fdb76=_0x51c9b1[_0x1d984d(0x1186)]/0x2-0x2;_0xb0f9eb[_0x1d984d(0xcbd)](),_0xb0f9eb[_0x1d984d(0x358)](_0x51c9b1[_0x1d984d(0x1186)]/0x2+_0x41f3ed*_0x51c9b1[_0x1d984d(0x1186)],_0x51c9b1[_0x1d984d(0x1186)]/0x2+_0x1e7f6d*_0x51c9b1[_0x1d984d(0x1186)],_0x9fdb76,0x0,0x2*Math['PI']),_0xb0f9eb['fillStyle']='rgba(0,\x200,\x200,\x200.4)',_0xb0f9eb[_0x1d984d(0x4d8)]();}}function _0x2af529(_0x492731){const _0x5e423a=_0x85c4bf,_0x160775=_0x505390[_0x5e423a(0x233)],_0x36aba6=_0x5aa690[_0x160775];if(!_0x36aba6||_0x36aba6[_0x5e423a(0x821)]||_0x36aba6[_0x5e423a(0x1072)]!==0x1)return;const _0xedc7a5=document[_0x5e423a(0x479)](_0x5e423a(0x11fd)),_0x1ae7ec=_0xedc7a5[_0x5e423a(0x10f7)](),_0x2020bb=_0x492731['clientX']-_0x1ae7ec['left'],_0x460924=_0x492731[_0x5e423a(0x87b)]-_0x1ae7ec['top'],_0xa75a2a=Math[_0x5e423a(0x412)]((_0x2020bb-_0x36aba6[_0x5e423a(0x1186)]/0x2)/_0x36aba6[_0x5e423a(0x1186)]),_0x644b4a=Math[_0x5e423a(0x412)]((_0x460924-_0x36aba6[_0x5e423a(0x1186)]/0x2)/_0x36aba6[_0x5e423a(0x1186)]);_0xa75a2a>=0x0&&_0xa75a2a<_0x36aba6[_0x5e423a(0xb37)]&&_0x644b4a>=0x0&&_0x644b4a<_0x36aba6['GRID_SIZE']&&_0x36aba6[_0x5e423a(0x206)][_0x644b4a][_0xa75a2a]===0x0&&(_0x36aba6[_0x5e423a(0x206)][_0x644b4a][_0xa75a2a]=0x1,_0x36aba6[_0x5e423a(0x7d3)][_0x5e423a(0x1a0)]({'x':_0xa75a2a,'y':_0x644b4a,'player':0x1}),_0x29f68d(_0x160775),_0x8f257a(_0xa75a2a,_0x644b4a,0x1,_0x36aba6)?(_0x36aba6['isGameOver']=!![],setTimeout(()=>alert(_0x5e423a(0xcf4)),0x64),_0x496ee2(_0x5e423a(0x4c5))):_0x36aba6[_0x5e423a(0x1072)]=0x2);}function _0x5d7053(_0x27b5d1,_0xd9b98a=![]){const _0x87d7b=_0x85c4bf,_0x471a68=_0x505390['activeChatId'],_0x597613=_0x5aa690[_0x471a68];if(!_0x597613||_0x597613[_0x87d7b(0x821)])return;if(!_0xd9b98a&&_0x597613[_0x87d7b(0x1072)]!==0x2)return;const {x:_0x228797,y:_0x369f61}=_0x27b5d1;_0x228797>=0x0&&_0x228797<_0x597613[_0x87d7b(0xb37)]&&_0x369f61>=0x0&&_0x369f61<_0x597613[_0x87d7b(0xb37)]&&_0x597613[_0x87d7b(0x206)][_0x369f61][_0x228797]===0x0?(_0x597613[_0x87d7b(0x206)][_0x369f61][_0x228797]=0x2,_0x597613['history']['push']({'x':_0x228797,'y':_0x369f61,'player':0x2}),_0x29f68d(_0x471a68),_0x8f257a(_0x228797,_0x369f61,0x2,_0x597613)?(_0x597613[_0x87d7b(0x821)]=!![],setTimeout(()=>alert(_0x87d7b(0xc89)),0x64),_0x496ee2('ai')):_0x597613['currentPlayer']=0x1):(console[_0x87d7b(0x139e)](_0x87d7b(0x3db),_0x27b5d1),_0x597613['currentPlayer']=0x1);}function _0x8f257a(_0x5ce5a9,_0x1542b2,_0x5bc865,_0x325d82){const {board:_0xd63bb3,GRID_SIZE:_0x1b31ed}=_0x325d82,_0x474b8f=[[0x1,0x0],[0x0,0x1],[0x1,0x1],[0x1,-0x1]];for(const [_0x25a9a,_0x545b42]of _0x474b8f){let _0x54f958=0x1;for(let _0x51d7f1=0x1;_0x51d7f1<0x5;_0x51d7f1++){const _0x1f9c91=_0x5ce5a9+_0x51d7f1*_0x25a9a,_0x17a8a1=_0x1542b2+_0x51d7f1*_0x545b42;if(_0x1f9c91>=0x0&&_0x1f9c91<_0x1b31ed&&_0x17a8a1>=0x0&&_0x17a8a1<_0x1b31ed&&_0xd63bb3[_0x17a8a1][_0x1f9c91]===_0x5bc865)_0x54f958++;else break;}for(let _0x3fdd2a=0x1;_0x3fdd2a<0x5;_0x3fdd2a++){const _0x4832ea=_0x5ce5a9-_0x3fdd2a*_0x25a9a,_0x494aeb=_0x1542b2-_0x3fdd2a*_0x545b42;if(_0x4832ea>=0x0&&_0x4832ea<_0x1b31ed&&_0x494aeb>=0x0&&_0x494aeb<_0x1b31ed&&_0xd63bb3[_0x494aeb][_0x4832ea]===_0x5bc865)_0x54f958++;else break;}if(_0x54f958>=0x5)return!![];}return![];}function _0xd8afdd(_0x47888e){const _0x3d1eb8=_0x85c4bf;if(!_0x47888e||!_0x47888e[_0x3d1eb8(0x4c3)])return'';let _0x1391b0=_0x3d1eb8(0x1208);_0x1391b0+=_0x47888e[_0x3d1eb8(0x206)][_0x3d1eb8(0x2e1)](_0x19645a=>_0x19645a[_0x3d1eb8(0x35d)]('\x20'))[_0x3d1eb8(0x35d)]('\x0a');let _0xfa7d29=_0x3d1eb8(0xb51);return _0xfa7d29+=_0x47888e[_0x3d1eb8(0x7d3)][_0x3d1eb8(0x2e1)](_0x421aef=>'玩家'+_0x421aef[_0x3d1eb8(0x1307)]+'下在('+_0x421aef['x']+','+_0x421aef['y']+')')[_0x3d1eb8(0x35d)](_0x3d1eb8(0xa42)),'\x0a#\x20当前五子棋局势\x0a'+_0x1391b0+_0x3d1eb8(0xa35)+_0xfa7d29+_0x3d1eb8(0x13b5);}async function _0x496ee2(_0x3c9c81){const _0x2ce07c=_0x85c4bf,_0x32bbf3=_0x505390[_0x2ce07c(0x233)],_0x388beb=_0x505390['chats'][_0x32bbf3];if(!_0x388beb)return;const _0x5c6bed=_0x388beb[_0x2ce07c(0x9d7)]?_0x388beb['settings']['myNickname']||'我':'我',_0x25fddd=_0x388beb['isGroup']?_0x2ce07c(0xfde):_0x388beb[_0x2ce07c(0x564)],_0x22dbbb=_0x3c9c81===_0x2ce07c(0x4c5)?_0x5c6bed:_0x25fddd,_0x117610=_0x3c9c81===_0x2ce07c(0x4c5)?'你输了':_0x2ce07c(0xd16),_0x515eec=_0x2ce07c(0x3e3)+_0x22dbbb+_0x2ce07c(0x12ae)+_0x117610+'。]',_0x55d002={'role':_0x2ce07c(0xbaa),'content':_0x515eec,'timestamp':Date[_0x2ce07c(0x12d6)](),'isHidden':!![]};_0x388beb[_0x2ce07c(0x7d3)][_0x2ce07c(0x1a0)](_0x55d002),await _0xb81d4e[_0x2ce07c(0x1027)]['put'](_0x388beb),console[_0x2ce07c(0x90f)](_0x2ce07c(0x791)+_0x3c9c81);}let _0x179288=![];async function _0x4fdfe7(){const _0x515880=_0x85c4bf,_0x1284ba=document['getElementById'](_0x515880(0x864)),_0x4b0dbe=document[_0x515880(0x479)]('product-category-tabs'),_0x4d328e=document[_0x515880(0x479)](_0x515880(0x7ee));_0x1284ba[_0x515880(0x3de)]='',_0x4b0dbe[_0x515880(0x3de)]='';const [_0x552738,_0x3897c7]=await Promise[_0x515880(0xf78)]([_0xb81d4e[_0x515880(0x13c1)][_0x515880(0x4ba)](),_0xb81d4e[_0x515880(0xdf0)][_0x515880(0x3d2)](_0x515880(0x564))[_0x515880(0x4ba)]()]);_0x4d328e[_0x515880(0x9cd)][_0x515880(0x2bf)]('management-mode',_0x179288);const _0x3e48a7=document[_0x515880(0xbd5)](_0x515880(0x7b6));_0x3e48a7[_0x515880(0xfd4)]='product-category-tab',_0x3e48a7[_0x515880(0x97b)]='全部',_0x3e48a7[_0x515880(0x13d4)][_0x515880(0x470)]=_0x515880(0xf78);if(activeShoppingCategoryId==='all')_0x3e48a7[_0x515880(0x9cd)][_0x515880(0x807)](_0x515880(0x5a9));_0x4b0dbe[_0x515880(0x9f4)](_0x3e48a7),_0x3897c7[_0x515880(0x12be)](_0x116e8f=>{const _0x2cfd93=_0x515880,_0x55e50a=document['createElement'](_0x2cfd93(0x7b6));_0x55e50a[_0x2cfd93(0xfd4)]=_0x2cfd93(0xa7d),_0x55e50a['textContent']=_0x116e8f[_0x2cfd93(0x564)],_0x55e50a[_0x2cfd93(0x13d4)][_0x2cfd93(0x470)]=_0x116e8f['id'];if(activeShoppingCategoryId===_0x116e8f['id'])_0x55e50a[_0x2cfd93(0x9cd)][_0x2cfd93(0x807)](_0x2cfd93(0x5a9));_0x4b0dbe[_0x2cfd93(0x9f4)](_0x55e50a);});let _0x4e6212;activeShoppingCategoryId==='all'?_0x4e6212=_0x552738:_0x4e6212=_0x552738[_0x515880(0x85d)](_0x4dc9a3=>_0x4dc9a3[_0x515880(0x470)]===activeShoppingCategoryId);if(_0x4e6212[_0x515880(0x990)]===0x0){const _0x565fd9=activeShoppingCategoryId===_0x515880(0xf78)?'商店空空如也，点击“管理”添加商品吧！':_0x515880(0x40f);_0x1284ba['innerHTML']=_0x515880(0x1f0)+_0x565fd9+'</p>';return;}_0x4e6212['forEach'](_0x50e7eb=>{const _0x2ac72f=_0x515880,_0x362533=document['createElement'](_0x2ac72f(0x6c8));_0x362533[_0x2ac72f(0xfd4)]=_0x2ac72f(0x717),_0x362533['dataset']['id']=_0x50e7eb['id'];const _0x28c3a8=_0x2ac72f(0x7bb);_0x362533['innerHTML']=_0x2ac72f(0x12cf)+_0x28c3a8+_0x2ac72f(0x18c)+_0x50e7eb[_0x2ac72f(0xa09)]+_0x2ac72f(0x136c)+_0x50e7eb[_0x2ac72f(0x564)]+_0x2ac72f(0x13db)+_0x50e7eb[_0x2ac72f(0x9ce)][_0x2ac72f(0x6e1)](0x2)+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-to-cart-btn\x22>加入购物车</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x1284ba[_0x2ac72f(0x9f4)](_0x362533);});}function _0x400b0c(_0x5a0d97){activeShoppingCategoryId=_0x5a0d97,_0x4fdfe7(),_0x2de00f();}function _0x2de00f(){const _0xc66026=_0x85c4bf,_0x3ad114=document[_0xc66026(0x479)](_0xc66026(0x118b));if(!_0x3ad114)return;const _0x2e2dae=_0x179288&&activeShoppingCategoryId!==_0xc66026(0xf78);_0x3ad114['style'][_0xc66026(0x678)]=_0x2e2dae?_0xc66026(0x899):_0xc66026(0xff8);}async function _0x2b1a05(){const _0x5647ab=_0x85c4bf;if(activeShoppingCategoryId===_0x5647ab(0xf78))return;const _0x4ea5f5=activeShoppingCategoryId,_0x6e1543=await _0xb81d4e[_0x5647ab(0xdf0)]['get'](_0x4ea5f5);if(!_0x6e1543){alert(_0x5647ab(0x813));return;}const _0x5dbde2='确定要永久删除分类\x20“'+_0x6e1543['name']+'”\x20吗？\x0a\x0a此操作【不会】删除分类下的商品，它们将被移至“未分类”。',_0x12f029=await _0x1a9e79(_0x5647ab(0x11f9),_0x5dbde2,{'confirmButtonClass':'btn-danger','confirmText':_0x5647ab(0x587)});_0x12f029&&(await _0x378ad1(_0x4ea5f5),activeShoppingCategoryId=_0x5647ab(0xf78),await _0x4fdfe7(),_0x2de00f(),await _0x1519c8('成功','分类\x20“'+_0x6e1543['name']+_0x5647ab(0xbbf)));}async function _0x21244a(){const _0x54cddd=_0x85c4bf;activeShoppingCategoryId=_0x54cddd(0xf78),await _0x4fdfe7(),_0x731d5('shopping-screen'),_0x2de00f();}async function _0x4fdfe7(){const _0x30a9e5=_0x85c4bf,_0x2aaca0=document[_0x30a9e5(0x479)](_0x30a9e5(0x864)),_0x21c78b=document['getElementById'](_0x30a9e5(0xac9)),_0x161366=document[_0x30a9e5(0x479)](_0x30a9e5(0x7ee));_0x2aaca0[_0x30a9e5(0x3de)]='',_0x21c78b[_0x30a9e5(0x3de)]='';const [_0x1779db,_0x43c154]=await Promise[_0x30a9e5(0xf78)]([_0xb81d4e[_0x30a9e5(0x13c1)][_0x30a9e5(0x4ba)](),_0xb81d4e['shoppingCategories'][_0x30a9e5(0x3d2)](_0x30a9e5(0x564))[_0x30a9e5(0x4ba)]()]);_0x161366['classList'][_0x30a9e5(0x2bf)]('management-mode',_0x179288);const _0x4617d9=document[_0x30a9e5(0xbd5)](_0x30a9e5(0x7b6));_0x4617d9[_0x30a9e5(0xfd4)]='product-category-tab',_0x4617d9[_0x30a9e5(0x97b)]='全部',_0x4617d9[_0x30a9e5(0x13d4)][_0x30a9e5(0x470)]=_0x30a9e5(0xf78);if(activeShoppingCategoryId===_0x30a9e5(0xf78))_0x4617d9[_0x30a9e5(0x9cd)]['add'](_0x30a9e5(0x5a9));_0x21c78b[_0x30a9e5(0x9f4)](_0x4617d9),_0x43c154['forEach'](_0x2dc1ad=>{const _0x24f4c8=_0x30a9e5,_0x4cbf9d=document[_0x24f4c8(0xbd5)](_0x24f4c8(0x7b6));_0x4cbf9d[_0x24f4c8(0xfd4)]=_0x24f4c8(0xa7d),_0x4cbf9d['textContent']=_0x2dc1ad[_0x24f4c8(0x564)],_0x4cbf9d[_0x24f4c8(0x13d4)]['categoryId']=_0x2dc1ad['id'];if(activeShoppingCategoryId===_0x2dc1ad['id'])_0x4cbf9d['classList'][_0x24f4c8(0x807)](_0x24f4c8(0x5a9));_0x21c78b['appendChild'](_0x4cbf9d);});let _0x5a12c1;activeShoppingCategoryId===_0x30a9e5(0xf78)?_0x5a12c1=_0x1779db:_0x5a12c1=_0x1779db[_0x30a9e5(0x85d)](_0x482962=>_0x482962[_0x30a9e5(0x470)]===activeShoppingCategoryId);if(_0x5a12c1[_0x30a9e5(0x990)]===0x0){const _0x5117cb=activeShoppingCategoryId==='all'?_0x30a9e5(0x1009):_0x30a9e5(0x40f);_0x2aaca0[_0x30a9e5(0x3de)]=_0x30a9e5(0x1f0)+_0x5117cb+_0x30a9e5(0x1049);return;}_0x5a12c1[_0x30a9e5(0x12be)](_0xefc7c=>{const _0x451520=_0x30a9e5,_0x38c873=document[_0x451520(0xbd5)]('div');_0x38c873['className']=_0x451520(0x717),_0x38c873['dataset']['id']=_0xefc7c['id'];const _0x5222e6=_0x179288?_0x451520(0x533):'';_0x38c873['innerHTML']=_0x451520(0x704)+_0x5222e6+_0x451520(0x9eb)+_0xefc7c[_0x451520(0xa09)]+_0x451520(0x8a8)+_0xefc7c[_0x451520(0x564)]+_0x451520(0x1237)+_0xefc7c[_0x451520(0x9ce)]['toFixed'](0x2)+_0x451520(0x51e),_0x2aaca0[_0x451520(0x9f4)](_0x38c873);});}async function _0x5a5593(_0x44c6c2,_0x4ee4e1=0x1,_0x558ce7=null){const _0x7d1ca4=_0x85c4bf,_0x4cf250=_0x558ce7?_0x3972fd['find'](_0x38b80d=>_0x38b80d[_0x7d1ca4(0x613)]===_0x44c6c2&&_0x38b80d[_0x7d1ca4(0xd4b)]?.['name']===_0x558ce7[_0x7d1ca4(0x564)]):_0x3972fd[_0x7d1ca4(0xc0d)](_0x4eefb2=>_0x4eefb2[_0x7d1ca4(0x613)]===_0x44c6c2&&!_0x4eefb2[_0x7d1ca4(0xd4b)]);if(_0x4cf250)_0x4cf250[_0x7d1ca4(0x2e8)]+=_0x4ee4e1;else{const _0x1ca354=await _0xb81d4e[_0x7d1ca4(0x13c1)][_0x7d1ca4(0x111a)](_0x44c6c2);_0x1ca354&&_0x3972fd[_0x7d1ca4(0x1a0)]({'productId':_0x1ca354['id'],'quantity':_0x4ee4e1,'variation':_0x558ce7});}_0x19a2a5();}function _0x3eeedd(_0x385a34,_0x15b1a3){const _0x6165cc=_0x85c4bf,_0x38ad60=_0x3972fd['findIndex'](_0x16def9=>_0x16def9['productId']===_0x385a34);_0x38ad60>-0x1&&(_0x3972fd[_0x38ad60][_0x6165cc(0x2e8)]+=_0x15b1a3,_0x3972fd[_0x38ad60]['quantity']<=0x0&&_0x3972fd[_0x6165cc(0x118e)](_0x38ad60,0x1),_0x19a2a5(),_0x57303f());}function _0x19a2a5(){const _0x3f3f5a=_0x85c4bf,_0x5bb909=_0x3972fd[_0x3f3f5a(0x1300)]((_0x19c78a,_0x13b200)=>_0x19c78a+_0x13b200[_0x3f3f5a(0x2e8)],0x0);document[_0x3f3f5a(0x479)]('cart-count')[_0x3f3f5a(0x97b)]=_0x5bb909,document['getElementById']('cart-title')[_0x3f3f5a(0x97b)]=_0x3f3f5a(0x889)+_0x5bb909+')',document[_0x3f3f5a(0x479)]('checkout-btn')[_0x3f3f5a(0x97b)]=_0x3f3f5a(0x39b)+_0x5bb909+')';}function _0x5e1eff(){const _0x1b9c59=_0x85c4bf;_0x57303f(),_0x731d5(_0x1b9c59(0x2dc));}async function _0x57303f(){const _0x4d87ca=_0x85c4bf,_0x2fa268=document[_0x4d87ca(0x479)](_0x4d87ca(0x4de));_0x2fa268['innerHTML']='';let _0x4cc5c7=0x0;if(_0x3972fd[_0x4d87ca(0x990)]===0x0)_0x2fa268['innerHTML']=_0x4d87ca(0x105e);else{const _0x2d0574=_0x3972fd[_0x4d87ca(0x2e1)](_0x7df283=>_0x7df283[_0x4d87ca(0x613)]),_0x5585cf=await _0xb81d4e[_0x4d87ca(0x13c1)][_0x4d87ca(0x46f)]('id')[_0x4d87ca(0x67d)](_0x2d0574)['toArray'](),_0x354e4a=new Map(_0x5585cf['map'](_0x569cd5=>[_0x569cd5['id'],_0x569cd5]));_0x3972fd[_0x4d87ca(0x12be)](_0x982a93=>{const _0x3c2d2b=_0x4d87ca,_0xdbe29e=_0x354e4a['get'](_0x982a93[_0x3c2d2b(0x613)]);if(_0xdbe29e){const _0x25594e=document[_0x3c2d2b(0xbd5)](_0x3c2d2b(0x6c8));_0x25594e[_0x3c2d2b(0xfd4)]=_0x3c2d2b(0x138b);const _0x32f451=_0x982a93[_0x3c2d2b(0xd4b)]?_0x3c2d2b(0x794)+_0x982a93[_0x3c2d2b(0xd4b)]['name']+_0x3c2d2b(0x2c3):'';_0x25594e[_0x3c2d2b(0x3de)]=_0x3c2d2b(0x1085)+_0xdbe29e['id']+_0x3c2d2b(0x986)+(_0x982a93[_0x3c2d2b(0xd4b)]?.[_0x3c2d2b(0xa09)]||_0xdbe29e[_0x3c2d2b(0xa09)])+'\x22\x20class=\x22cart-item-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-name\x22>'+_0xdbe29e[_0x3c2d2b(0x564)]+_0x3c2d2b(0x8db)+_0x32f451+_0x3c2d2b(0x5bf)+(_0x982a93[_0x3c2d2b(0xd4b)]?.[_0x3c2d2b(0x9ce)]||_0xdbe29e[_0x3c2d2b(0x9ce)])[_0x3c2d2b(0x6e1)](0x2)+_0x3c2d2b(0x8bb)+_0xdbe29e['id']+_0x3c2d2b(0xf4e)+_0x982a93[_0x3c2d2b(0x2e8)]+_0x3c2d2b(0x1095)+_0xdbe29e['id']+_0x3c2d2b(0x5e4),_0x2fa268[_0x3c2d2b(0x9f4)](_0x25594e);}});}_0x321440();}async function _0x321440(){const _0x1020c1=_0x85c4bf;let _0x439ecd=0x0;const _0x30c1f8=document[_0x1020c1(0x99e)](_0x1020c1(0xeb4)),_0x5eefaa=Array[_0x1020c1(0x22f)](_0x30c1f8)[_0x1020c1(0x2e1)](_0x1204ef=>parseInt(_0x1204ef[_0x1020c1(0x13d4)]['id']));if(_0x5eefaa['length']>0x0){const _0x58e7b4=await _0xb81d4e[_0x1020c1(0x13c1)][_0x1020c1(0x46f)]('id')[_0x1020c1(0x67d)](_0x5eefaa)[_0x1020c1(0x4ba)](),_0x3bd328=new Map(_0x58e7b4[_0x1020c1(0x2e1)](_0x4741a1=>[_0x4741a1['id'],_0x4741a1]));_0x3972fd['forEach'](_0x11a07c=>{const _0x34c481=_0x1020c1;if(_0x5eefaa['includes'](_0x11a07c[_0x34c481(0x613)])){const _0x1baf45=_0x3bd328[_0x34c481(0x111a)](_0x11a07c[_0x34c481(0x613)]);if(_0x1baf45){const _0x541d03=_0x11a07c['variation']?_0x11a07c[_0x34c481(0xd4b)][_0x34c481(0x9ce)]:_0x1baf45[_0x34c481(0x9ce)];_0x439ecd+=_0x541d03*_0x11a07c[_0x34c481(0x2e8)];}}});}document[_0x1020c1(0x479)](_0x1020c1(0x106e))[_0x1020c1(0x97b)]=_0x1020c1(0x665)+_0x439ecd[_0x1020c1(0x6e1)](0x2);}async function _0x5d7621(){const _0x4ba896=_0x85c4bf,_0x2047bb=_0x505390[_0x4ba896(0x1027)][_0x505390[_0x4ba896(0x233)]];if(!_0x2047bb||!_0x2047bb[_0x4ba896(0x9d7)])return;const _0x57ed8f=document[_0x4ba896(0x479)](_0x4ba896(0x767)),_0x15090f=document[_0x4ba896(0x479)]('gift-recipient-list');_0x15090f[_0x4ba896(0x3de)]='';const _0x37068b=_0x2047bb[_0x4ba896(0x18a)][_0x4ba896(0xf58)]||'我',_0x3939e7=_0x2047bb[_0x4ba896(0x954)][_0x4ba896(0x85d)](_0x181722=>_0x181722[_0x4ba896(0xa54)]!==_0x37068b);_0x3939e7[_0x4ba896(0x12be)](_0x2a0548=>{const _0x120aab=_0x4ba896,_0x428e6f=document[_0x120aab(0xbd5)]('div');_0x428e6f[_0x120aab(0xfd4)]=_0x120aab(0xf47),_0x428e6f[_0x120aab(0x13d4)][_0x120aab(0x1103)]=_0x2a0548[_0x120aab(0xe2d)],_0x428e6f['innerHTML']=_0x120aab(0xf23)+(_0x2a0548[_0x120aab(0x799)]||_0x3ea4df)+_0x120aab(0x855)+_0x2a0548['groupNickname']+_0x120aab(0x114e),_0x15090f[_0x120aab(0x9f4)](_0x428e6f);}),document[_0x4ba896(0x479)](_0x4ba896(0x842))['checked']=![],_0x57ed8f[_0x4ba896(0x9cd)][_0x4ba896(0x807)](_0x4ba896(0x45a));}async function _0xa88787(){const _0xde2cde=_0x85c4bf,_0xb3f301=_0x505390['chats'][_0x505390[_0xde2cde(0x233)]],_0x2cabcc=_0x3972fd[_0xde2cde(0x85d)](_0x27fdaa=>document['querySelector']('.cart-item-checkbox[data-id=\x22'+_0x27fdaa[_0xde2cde(0x613)]+_0xde2cde(0xc64)));if(_0x2cabcc[_0xde2cde(0x990)]===0x0){alert(_0xde2cde(0x13ad));return;}if(_0xb3f301[_0xde2cde(0x9d7)])_0x5d7621();else{const _0x1ab8e2=await _0x1a9e79(_0xde2cde(0xf18),_0xde2cde(0x11da),{'confirmText':_0xde2cde(0xfff)});_0x1ab8e2&&await _0x2b7510(_0x2cabcc);}}async function _0x2b7510(_0x1c67eb,_0x3f20d1=null){const _0x238e2a=_0x85c4bf;if(!_0x505390[_0x238e2a(0x233)])return;const _0x4812cd=_0x505390[_0x238e2a(0x1027)][_0x505390[_0x238e2a(0x233)]],_0x13a349=_0x1c67eb['map'](_0x2b5020=>_0x2b5020[_0x238e2a(0x613)]),_0xce7e72=await _0xb81d4e[_0x238e2a(0x13c1)][_0x238e2a(0x46f)]('id')['anyOf'](_0x13a349)[_0x238e2a(0x4ba)](),_0x21b17a=new Map(_0xce7e72[_0x238e2a(0x2e1)](_0x323bf8=>[_0x323bf8['id'],_0x323bf8])),_0x2431f9=_0x1c67eb[_0x238e2a(0x2e1)](_0x3c17d1=>{const _0x5b49c5=_0x238e2a,_0x5c7d32=_0x21b17a[_0x5b49c5(0x111a)](_0x3c17d1['productId']);return _0x3c17d1[_0x5b49c5(0xd4b)]?{'name':_0x5c7d32[_0x5b49c5(0x564)]+_0x5b49c5(0x501)+_0x3c17d1[_0x5b49c5(0xd4b)][_0x5b49c5(0x564)],'price':_0x3c17d1[_0x5b49c5(0xd4b)]['price'],'imageUrl':_0x3c17d1[_0x5b49c5(0xd4b)]['imageUrl']||_0x5c7d32[_0x5b49c5(0xa09)],'quantity':_0x3c17d1[_0x5b49c5(0x2e8)]}:{'name':_0x5c7d32[_0x5b49c5(0x564)],'price':_0x5c7d32['price'],'imageUrl':_0x5c7d32[_0x5b49c5(0xa09)],'quantity':_0x3c17d1[_0x5b49c5(0x2e8)]};}),_0x2f2c0e={'role':'user','type':_0x238e2a(0x1362),'timestamp':Date['now'](),'items':_0x2431f9,'total':_0x2431f9['reduce']((_0x1bd597,_0x17dbb2)=>_0x1bd597+_0x17dbb2[_0x238e2a(0x9ce)]*_0x17dbb2[_0x238e2a(0x2e8)],0x0),'recipients':_0x3f20d1};_0x4812cd[_0x238e2a(0x7d3)][_0x238e2a(0x1a0)](_0x2f2c0e);if(_0x3f20d1&&_0x3f20d1['length']>0x0){const _0x1df5f4=_0x3f20d1['map'](_0x4b2260=>_0x503999(_0x4812cd,_0x4b2260))[_0x238e2a(0x35d)]('、'),_0x3e7912={'role':'system','content':'[系统提示：用户\x20('+(_0x4812cd[_0x238e2a(0x18a)][_0x238e2a(0xf58)]||'我')+')\x20送出了一份礼物，收礼人是：'+_0x1df5f4+_0x238e2a(0xaa7),'timestamp':Date[_0x238e2a(0x12d6)]()+0x1,'isHidden':!![]};_0x4812cd['history'][_0x238e2a(0x1a0)](_0x3e7912);}await _0xb81d4e[_0x238e2a(0x1027)][_0x238e2a(0x5d0)](_0x4812cd),_0x48f5ff(_0x2f2c0e,_0x4812cd),_0x1b7f69(),_0x3972fd=_0x3972fd[_0x238e2a(0x85d)](_0x236981=>!_0x1c67eb[_0x238e2a(0x1235)](_0x5b2147=>_0x5b2147[_0x238e2a(0x613)]===_0x236981[_0x238e2a(0x613)])),_0x19a2a5(),_0x731d5(_0x238e2a(0xdeb)),await _0x1519c8('成功',_0x238e2a(0xf7a));}function _0x17b674(_0x20428b){const _0x1329de=_0x85c4bf,_0xcc568=_0x505390[_0x1329de(0x1027)][_0x505390[_0x1329de(0x233)]],_0x25d96e=_0xcc568[_0x1329de(0x7d3)][_0x1329de(0xc0d)](_0x24c546=>_0x24c546[_0x1329de(0x12a2)]===_0x20428b);if(!_0x25d96e||_0x25d96e[_0x1329de(0x858)]!==_0x1329de(0x1362))return;const _0x28507a=document[_0x1329de(0x479)](_0x1329de(0x573));let _0x5650a9='';_0x25d96e[_0x1329de(0x117a)][_0x1329de(0x12be)](_0x1457b8=>{const _0x2ed965=_0x1329de;_0x5650a9+=_0x2ed965(0xfa3)+_0x1457b8['name']+_0x2ed965(0x714)+_0x1457b8[_0x2ed965(0x2e8)]+_0x2ed965(0x1158)+_0x1457b8[_0x2ed965(0x9ce)][_0x2ed965(0x6e1)](0x2)+_0x2ed965(0x1071)+(_0x1457b8[_0x2ed965(0x9ce)]*_0x1457b8['quantity'])[_0x2ed965(0x6e1)](0x2)+'</td></tr>';}),_0x28507a[_0x1329de(0x3de)]=_0x1329de(0x66a)+new Date(_0x25d96e[_0x1329de(0x12a2)])[_0x1329de(0x119c)]()+'</p></div><table\x20class=\x22receipt-items-table\x22><thead><tr><th\x20class=\x22item-name\x22>商品</th><th\x20class=\x22item-qty\x22>数量</th><th\x20class=\x22item-price\x22>单价</th><th\x20class=\x22item-subtotal\x22>小计</th></tr></thead><tbody>'+_0x5650a9+_0x1329de(0x1007)+_0x25d96e[_0x1329de(0x947)]['toFixed'](0x2)+_0x1329de(0x1218),document['getElementById'](_0x1329de(0x290))['classList'][_0x1329de(0x807)]('visible');}async function _0x4386ae(_0x56d607=null){const _0x3d213a=_0x85c4bf;_0xcb90ce=_0x56d607;const _0x35d705=document[_0x3d213a(0x479)](_0x3d213a(0x1e6)),_0x58d85f=document[_0x3d213a(0x479)](_0x3d213a(0xc7a)),_0xd572e5=document['getElementById']('product-name-input'),_0x2f7f24=document[_0x3d213a(0x479)]('product-price-input'),_0xee2da8=document[_0x3d213a(0x479)](_0x3d213a(0xea2)),_0x27d3dd=document['getElementById'](_0x3d213a(0x11ee)),_0x41d28c=document[_0x3d213a(0x479)](_0x3d213a(0x1073)),_0x43020b=document['getElementById'](_0x3d213a(0x117f));_0x43020b[_0x3d213a(0x3de)]='',_0x41d28c[_0x3d213a(0x3de)]='<option\x20value=\x22\x22>--\x20未分类\x20--</option>';const _0x5ca178=await _0xb81d4e[_0x3d213a(0xdf0)][_0x3d213a(0x4ba)]();_0x5ca178[_0x3d213a(0x12be)](_0x1746d1=>{const _0x11b90a=_0x3d213a,_0x4c6253=document[_0x11b90a(0xbd5)](_0x11b90a(0x9a2));_0x4c6253[_0x11b90a(0x4e0)]=_0x1746d1['id'],_0x4c6253[_0x11b90a(0x97b)]=_0x1746d1[_0x11b90a(0x564)],_0x41d28c['appendChild'](_0x4c6253);});if(_0x56d607){_0x58d85f[_0x3d213a(0x97b)]=_0x3d213a(0xea3);const _0x3ca91d=await _0xb81d4e['shoppingProducts']['get'](_0x56d607);_0xd572e5[_0x3d213a(0x4e0)]=_0x3ca91d[_0x3d213a(0x564)],_0x2f7f24[_0x3d213a(0x4e0)]=_0x3ca91d['price'],_0xee2da8['value']=_0x3ca91d[_0x3d213a(0x78b)]||'',_0x27d3dd[_0x3d213a(0xa9c)]=_0x3ca91d[_0x3d213a(0xa09)],_0x41d28c['value']=_0x3ca91d[_0x3d213a(0x470)]||'',_0x3ca91d[_0x3d213a(0xaa8)]&&_0x3ca91d['variations'][_0x3d213a(0x990)]>0x0&&_0x3ca91d['variations'][_0x3d213a(0x12be)](_0x44dd0a=>_0x195912(_0x44dd0a));}else _0x58d85f[_0x3d213a(0x97b)]='添加商品',_0xd572e5[_0x3d213a(0x4e0)]='',_0x2f7f24['value']='',_0xee2da8[_0x3d213a(0x4e0)]='',_0x27d3dd[_0x3d213a(0xa9c)]=_0x3d213a(0x220),_0x41d28c[_0x3d213a(0x4e0)]='';_0x35d705[_0x3d213a(0x9cd)][_0x3d213a(0x807)](_0x3d213a(0x45a));}async function _0x18344e(){const _0x1d0e9c=_0x85c4bf,_0x1fb274=document[_0x1d0e9c(0x479)](_0x1d0e9c(0x1245))['value'][_0x1d0e9c(0x9c1)](),_0x4afd7e=parseFloat(document[_0x1d0e9c(0x479)]('product-price-input')[_0x1d0e9c(0x4e0)]),_0x26b2f3=document[_0x1d0e9c(0x479)]('product-description-input')[_0x1d0e9c(0x4e0)][_0x1d0e9c(0x9c1)](),_0x59c522=document[_0x1d0e9c(0x479)](_0x1d0e9c(0x11ee))[_0x1d0e9c(0xa9c)],_0x3072ce=parseInt(document[_0x1d0e9c(0x479)](_0x1d0e9c(0x1073))['value'])||null;if(!_0x1fb274){alert('商品名称不能为空！');return;}if(isNaN(_0x4afd7e)||_0x4afd7e<0x0){alert('请输入有效的默认价格！');return;}const _0x325d24=[];document[_0x1d0e9c(0x99e)]('.variation-block')[_0x1d0e9c(0x12be)](_0x21c6b5=>{const _0x5e71bd=_0x1d0e9c,_0x1406c0=_0x21c6b5[_0x5e71bd(0x8bc)](_0x5e71bd(0xa34))[_0x5e71bd(0x4e0)]['trim'](),_0x5039ff=parseFloat(_0x21c6b5[_0x5e71bd(0x8bc)]('.variation-price-input')[_0x5e71bd(0x4e0)]),_0x54d336=_0x21c6b5[_0x5e71bd(0x8bc)](_0x5e71bd(0x49a))['src'];_0x1406c0&&!isNaN(_0x5039ff)&&_0x5039ff>=0x0&&_0x325d24[_0x5e71bd(0x1a0)]({'name':_0x1406c0,'price':_0x5039ff,'imageUrl':_0x54d336[_0x5e71bd(0x44f)](_0x5e71bd(0x6a6))?null:_0x54d336});});const _0x16cdfc={'name':_0x1fb274,'price':_0x4afd7e,'description':_0x26b2f3,'imageUrl':_0x59c522,'categoryId':_0x3072ce,'variations':_0x325d24};_0xcb90ce?await _0xb81d4e[_0x1d0e9c(0x13c1)][_0x1d0e9c(0xeb2)](_0xcb90ce,_0x16cdfc):await _0xb81d4e[_0x1d0e9c(0x13c1)]['add'](_0x16cdfc),document[_0x1d0e9c(0x479)](_0x1d0e9c(0x1e6))[_0x1d0e9c(0x9cd)][_0x1d0e9c(0x8b6)]('visible'),await _0x4fdfe7();}async function _0x1d5e77(){await _0x243bd3(),_0x731d5('rendering-rules-screen');}async function _0x243bd3(){const _0x1cc593=_0x85c4bf,_0x68aee4=document[_0x1cc593(0x479)](_0x1cc593(0xdad)),_0xdfa66a=document[_0x1cc593(0x479)]('rules-content-container');_0x68aee4[_0x1cc593(0x3de)]='',_0xdfa66a['innerHTML']='';const _0x394a31=await _0xb81d4e[_0x1cc593(0xb06)][_0x1cc593(0x4ba)]();if(_0x394a31['length']===0x0){_0xdfa66a[_0x1cc593(0x3de)]=_0x1cc593(0x929);return;}const _0x3de9a8=document[_0x1cc593(0xbd5)](_0x1cc593(0x7b6));_0x3de9a8[_0x1cc593(0xfd4)]='rules-tab\x20active',_0x3de9a8[_0x1cc593(0x97b)]='公用规则',_0x3de9a8[_0x1cc593(0x13d4)]['categoryId']=_0x1cc593(0xb48),_0x68aee4[_0x1cc593(0x9f4)](_0x3de9a8);const _0x3dafdd=document[_0x1cc593(0xbd5)](_0x1cc593(0x6c8));_0x3dafdd[_0x1cc593(0xfd4)]='rules-category-pane\x20active',_0x3dafdd['dataset'][_0x1cc593(0x470)]=_0x1cc593(0xb48),_0xdfa66a[_0x1cc593(0x9f4)](_0x3dafdd);const _0x1501ba=Object[_0x1cc593(0x3d5)](_0x505390[_0x1cc593(0x1027)])['filter'](_0xd1c92b=>!_0xd1c92b['isGroup']&&_0x394a31[_0x1cc593(0x1235)](_0x2ae076=>_0x2ae076[_0x1cc593(0xd4e)]===_0xd1c92b['id']));_0x1501ba[_0x1cc593(0x12be)](_0x1815d1=>{const _0x217be8=_0x1cc593,_0x288311=document[_0x217be8(0xbd5)](_0x217be8(0x7b6));_0x288311[_0x217be8(0xfd4)]='rules-tab',_0x288311[_0x217be8(0x97b)]=_0x1815d1['name'],_0x288311['dataset'][_0x217be8(0x470)]=_0x1815d1['id'],_0x68aee4['appendChild'](_0x288311);const _0xd35447=document['createElement'](_0x217be8(0x6c8));_0xd35447[_0x217be8(0xfd4)]='rules-category-pane',_0xd35447[_0x217be8(0x13d4)][_0x217be8(0x470)]=_0x1815d1['id'],_0xdfa66a[_0x217be8(0x9f4)](_0xd35447);}),_0x394a31[_0x1cc593(0x12be)](_0x4fd065=>{const _0x57ab06=_0x1cc593,_0x1e28e5=_0xee3081(_0x4fd065),_0x17d241=_0xdfa66a[_0x57ab06(0x8bc)](_0x57ab06(0xf46)+_0x4fd065[_0x57ab06(0xd4e)]+'\x22]');_0x17d241&&_0x17d241[_0x57ab06(0x9f4)](_0x1e28e5);}),document[_0x1cc593(0x99e)](_0x1cc593(0xb96))['forEach'](_0x363fe1=>{const _0x312557=_0x1cc593;_0x363fe1['addEventListener'](_0x312557(0xd2f),()=>_0x34eb35(_0x363fe1[_0x312557(0x13d4)]['categoryId']));});}function _0xee3081(_0xb40208){const _0x4627e0=_0x85c4bf,_0x4d6c60=document[_0x4627e0(0xbd5)](_0x4627e0(0x6c8));return _0x4d6c60[_0x4627e0(0xfd4)]=_0x4627e0(0x984)+(_0xb40208['isEnabled']?'enabled':''),_0x4d6c60[_0x4627e0(0x13d4)][_0x4627e0(0xfbe)]=_0xb40208['id'],_0x4d6c60[_0x4627e0(0x3de)]=_0x4627e0(0x11b5)+_0xb40208[_0x4627e0(0x564)]+_0x4627e0(0x98c)+_0xb40208['regex']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4d6c60[_0x4627e0(0xa75)](_0x4627e0(0xd2f),()=>_0x29e040(_0xb40208['id'])),_0x33282f(_0x4d6c60,()=>_0x18a073(_0xb40208['id'])),_0x4d6c60;}async function _0x29e040(_0x2db43b=null){const _0xb06b71=_0x85c4bf;_0x104c4a=_0x2db43b;const _0x1b07f7=document[_0xb06b71(0x479)]('rule-editor-modal'),_0x2bedcd=document[_0xb06b71(0x479)](_0xb06b71(0x7ed)),_0x1513cb=document[_0xb06b71(0x479)]('rule-name-input'),_0x56ac66=document[_0xb06b71(0x479)](_0xb06b71(0x1223)),_0xf3f60=document[_0xb06b71(0x479)](_0xb06b71(0x4cb)),_0x362b3c=document[_0xb06b71(0x479)](_0xb06b71(0xbc9)),_0x2f1243=document[_0xb06b71(0x479)](_0xb06b71(0xf8c));_0x56ac66['innerHTML']=_0xb06b71(0xdaa),Object[_0xb06b71(0x3d5)](_0x505390[_0xb06b71(0x1027)])[_0xb06b71(0x85d)](_0xc6c1b6=>!_0xc6c1b6[_0xb06b71(0x9d7)])[_0xb06b71(0x12be)](_0x524685=>{const _0x2bf822=_0xb06b71;_0x56ac66[_0x2bf822(0x3de)]+='<option\x20value=\x22'+_0x524685['id']+'\x22>'+_0x524685[_0x2bf822(0x564)]+_0x2bf822(0x61f);});if(_0x2db43b){_0x2bedcd[_0xb06b71(0x97b)]=_0xb06b71(0xf09);const _0x5e32b4=await _0xb81d4e[_0xb06b71(0xb06)][_0xb06b71(0x111a)](_0x2db43b);_0x1513cb[_0xb06b71(0x4e0)]=_0x5e32b4[_0xb06b71(0x564)],_0x56ac66[_0xb06b71(0x4e0)]=_0x5e32b4[_0xb06b71(0xd4e)],_0xf3f60[_0xb06b71(0x4e0)]=_0x5e32b4[_0xb06b71(0x364)],_0x362b3c[_0xb06b71(0x4e0)]=_0x5e32b4[_0xb06b71(0x346)],_0x2f1243[_0xb06b71(0xf7b)]=_0x5e32b4[_0xb06b71(0xfb5)];}else _0x2bedcd[_0xb06b71(0x97b)]=_0xb06b71(0xddd),_0x1513cb[_0xb06b71(0x4e0)]='',_0x56ac66[_0xb06b71(0x4e0)]=_0xb06b71(0xb48),_0xf3f60['value']='',_0x362b3c[_0xb06b71(0x4e0)]='',_0x2f1243[_0xb06b71(0xf7b)]=!![];_0x1b07f7[_0xb06b71(0x9cd)][_0xb06b71(0x807)]('visible');}async function _0x50eb4e(){const _0x540c59=_0x85c4bf,_0x5eca42=document[_0x540c59(0x479)](_0x540c59(0xe12))[_0x540c59(0x4e0)][_0x540c59(0x9c1)](),_0x5181b9=document[_0x540c59(0x479)]('rule-regex-input')[_0x540c59(0x4e0)][_0x540c59(0x9c1)]();if(!_0x5eca42||!_0x5181b9){alert(_0x540c59(0x138d));return;}try{new RegExp(_0x5181b9);}catch(_0x11bec3){alert(_0x540c59(0xa4f)+_0x11bec3['message']);return;}const _0x230ab5={'name':_0x5eca42,'chatId':document['getElementById'](_0x540c59(0x1223))[_0x540c59(0x4e0)],'regex':_0x5181b9,'template':document[_0x540c59(0x479)](_0x540c59(0xbc9))[_0x540c59(0x4e0)],'isEnabled':document[_0x540c59(0x479)](_0x540c59(0xf8c))['checked']};_0x104c4a?await _0xb81d4e[_0x540c59(0xb06)][_0x540c59(0xeb2)](_0x104c4a,_0x230ab5):await _0xb81d4e[_0x540c59(0xb06)]['add'](_0x230ab5),document['getElementById']('rule-editor-modal')[_0x540c59(0x9cd)][_0x540c59(0x8b6)](_0x540c59(0x45a)),await _0x243bd3();}async function _0x18a073(_0x396140){const _0x4e3107=_0x85c4bf,_0x8d13c5=await _0x1a9e79('删除规则',_0x4e3107(0x122d),{'confirmButtonClass':_0x4e3107(0x95a)});_0x8d13c5&&(await _0xb81d4e['renderingRules'][_0x4e3107(0x1ea)](_0x396140),await _0x243bd3());}async function _0xef16b0(_0x57f50f,_0x2efbfa){const _0x5f2c07=_0x85c4bf;if(_0x57f50f[_0x5f2c07(0x9c1)]()[_0x5f2c07(0x591)]('<')||!_0x57f50f[_0x5f2c07(0x44f)]('[')&&!_0x57f50f[_0x5f2c07(0x44f)]('{'))return _0x57f50f;const _0x19c53c=await _0xb81d4e['renderingRules'][_0x5f2c07(0x46f)](_0x5f2c07(0xd4e))['equals'](_0x5f2c07(0xb48))['or'](_0x5f2c07(0xd4e))[_0x5f2c07(0x4a2)](_0x2efbfa)['toArray']();let _0x188f82=_0x57f50f;for(const _0x402a30 of _0x19c53c[_0x5f2c07(0x85d)](_0x2781a3=>_0x2781a3[_0x5f2c07(0xfb5)])){try{const _0x4f3700=new RegExp(_0x402a30['regex'],'g');_0x4f3700[_0x5f2c07(0x101d)](_0x188f82)&&(_0x188f82=_0x188f82[_0x5f2c07(0x491)](_0x4f3700,_0x402a30['template']));}catch(_0x29b375){console[_0x5f2c07(0xe3b)](_0x5f2c07(0xdee)+_0x402a30[_0x5f2c07(0x564)]+']\x20的正则表达式无效:',_0x29b375);}}return _0x188f82;}async function _0x1d5e77(){const _0x4812b1=_0x85c4bf;await _0x243bd3(),_0x731d5(_0x4812b1(0x1ed));}async function _0x243bd3(){const _0x4f4a1e=_0x85c4bf,_0x5987ba=document[_0x4f4a1e(0x479)](_0x4f4a1e(0xdad)),_0x1b5feb=document[_0x4f4a1e(0x479)](_0x4f4a1e(0x632));_0x5987ba['innerHTML']='',_0x1b5feb[_0x4f4a1e(0x3de)]='';const _0x3776e4=await _0xb81d4e[_0x4f4a1e(0xb06)][_0x4f4a1e(0x4ba)]();if(_0x3776e4['length']===0x0){_0x1b5feb[_0x4f4a1e(0x3de)]=_0x4f4a1e(0x929);return;}const _0x45878e=document['createElement']('button');_0x45878e['className']=_0x4f4a1e(0x64c),_0x45878e[_0x4f4a1e(0x97b)]=_0x4f4a1e(0xea6),_0x45878e[_0x4f4a1e(0x13d4)]['categoryId']=_0x4f4a1e(0xb48),_0x5987ba[_0x4f4a1e(0x9f4)](_0x45878e);const _0x446514=document[_0x4f4a1e(0xbd5)](_0x4f4a1e(0x6c8));_0x446514[_0x4f4a1e(0xfd4)]=_0x4f4a1e(0xa93),_0x446514[_0x4f4a1e(0x13d4)][_0x4f4a1e(0x470)]=_0x4f4a1e(0xb48),_0x1b5feb['appendChild'](_0x446514);const _0x37aa45=Object[_0x4f4a1e(0x3d5)](_0x505390['chats'])['filter'](_0x59fc76=>!_0x59fc76[_0x4f4a1e(0x9d7)]&&_0x3776e4[_0x4f4a1e(0x1235)](_0x3661f2=>_0x3661f2[_0x4f4a1e(0xd4e)]===_0x59fc76['id']));_0x37aa45[_0x4f4a1e(0x12be)](_0x1debb6=>{const _0x145cdc=_0x4f4a1e,_0x30ce59=document[_0x145cdc(0xbd5)](_0x145cdc(0x7b6));_0x30ce59['className']=_0x145cdc(0xa2c),_0x30ce59[_0x145cdc(0x97b)]=_0x1debb6[_0x145cdc(0x564)],_0x30ce59[_0x145cdc(0x13d4)][_0x145cdc(0x470)]=_0x1debb6['id'],_0x5987ba[_0x145cdc(0x9f4)](_0x30ce59);const _0x18ba5d=document[_0x145cdc(0xbd5)](_0x145cdc(0x6c8));_0x18ba5d[_0x145cdc(0xfd4)]='rules-category-pane',_0x18ba5d[_0x145cdc(0x13d4)]['categoryId']=_0x1debb6['id'],_0x1b5feb[_0x145cdc(0x9f4)](_0x18ba5d);}),_0x3776e4[_0x4f4a1e(0x12be)](_0x21d641=>{const _0x42d7f8=_0x4f4a1e,_0xbce4ac=_0xee3081(_0x21d641),_0x5c88b4=_0x1b5feb[_0x42d7f8(0x8bc)]('.rules-category-pane[data-category-id=\x22'+_0x21d641['chatId']+'\x22]');_0x5c88b4&&_0x5c88b4[_0x42d7f8(0x9f4)](_0xbce4ac);}),document[_0x4f4a1e(0x99e)](_0x4f4a1e(0xb96))[_0x4f4a1e(0x12be)](_0x580490=>{const _0x19ae70=_0x4f4a1e;_0x580490[_0x19ae70(0xa75)](_0x19ae70(0xd2f),()=>_0x34eb35(_0x580490[_0x19ae70(0x13d4)][_0x19ae70(0x470)]));});}function _0xee3081(_0x13d694){const _0x4601cf=_0x85c4bf,_0x11acea=document['createElement'](_0x4601cf(0x6c8));return _0x11acea[_0x4601cf(0xfd4)]='rule-card\x20'+(_0x13d694[_0x4601cf(0xfb5)]?_0x4601cf(0x2b7):''),_0x11acea[_0x4601cf(0x13d4)][_0x4601cf(0xfbe)]=_0x13d694['id'],_0x11acea[_0x4601cf(0x3de)]=_0x4601cf(0x11b5)+_0x13d694['name']+_0x4601cf(0x98c)+_0x13d694[_0x4601cf(0x364)]+_0x4601cf(0x12da),_0x11acea['addEventListener'](_0x4601cf(0xd2f),()=>_0x29e040(_0x13d694['id'])),_0x33282f(_0x11acea,()=>_0x18a073(_0x13d694['id'])),_0x11acea;}async function _0x29e040(_0x36fd6a=null){const _0x40b538=_0x85c4bf;_0x104c4a=_0x36fd6a;const _0x4e30db=document[_0x40b538(0x479)](_0x40b538(0x119a)),_0x47cf90=document[_0x40b538(0x479)](_0x40b538(0x7ed)),_0x44f977=document[_0x40b538(0x479)]('rule-name-input'),_0x311bf6=document[_0x40b538(0x479)](_0x40b538(0x1223)),_0x2e0e18=document[_0x40b538(0x479)](_0x40b538(0x4cb)),_0x52cec7=document['getElementById'](_0x40b538(0xbc9)),_0x3cd2e7=document[_0x40b538(0x479)](_0x40b538(0xf8c));_0x311bf6[_0x40b538(0x3de)]=_0x40b538(0xdaa),Object[_0x40b538(0x3d5)](_0x505390[_0x40b538(0x1027)])[_0x40b538(0x85d)](_0x29d9af=>!_0x29d9af['isGroup'])['forEach'](_0x2d1d77=>{const _0x1dacaa=_0x40b538;_0x311bf6[_0x1dacaa(0x3de)]+=_0x1dacaa(0x121c)+_0x2d1d77['id']+'\x22>'+_0x2d1d77[_0x1dacaa(0x564)]+_0x1dacaa(0x61f);});if(_0x36fd6a){_0x47cf90[_0x40b538(0x97b)]=_0x40b538(0xf09);const _0x31d185=await _0xb81d4e[_0x40b538(0xb06)][_0x40b538(0x111a)](_0x36fd6a);_0x44f977[_0x40b538(0x4e0)]=_0x31d185[_0x40b538(0x564)],_0x311bf6[_0x40b538(0x4e0)]=_0x31d185[_0x40b538(0xd4e)],_0x2e0e18[_0x40b538(0x4e0)]=_0x31d185['regex'],_0x52cec7[_0x40b538(0x4e0)]=_0x31d185[_0x40b538(0x346)],_0x3cd2e7[_0x40b538(0xf7b)]=_0x31d185[_0x40b538(0xfb5)];}else _0x47cf90['textContent']='创建新规则',_0x44f977[_0x40b538(0x4e0)]='',_0x311bf6[_0x40b538(0x4e0)]=_0x40b538(0xb48),_0x2e0e18[_0x40b538(0x4e0)]='',_0x52cec7[_0x40b538(0x4e0)]='',_0x3cd2e7[_0x40b538(0xf7b)]=!![];_0x4e30db['classList'][_0x40b538(0x807)](_0x40b538(0x45a));}async function _0x50eb4e(){const _0x100ed4=_0x85c4bf,_0x2d3f96=document['getElementById'](_0x100ed4(0xe12))['value'][_0x100ed4(0x9c1)](),_0x1470c3=document[_0x100ed4(0x479)]('rule-regex-input')['value']['trim']();if(!_0x2d3f96||!_0x1470c3){alert('规则名称和正则表达式不能为空！');return;}try{new RegExp(_0x1470c3);}catch(_0x344bc4){alert(_0x100ed4(0xa4f)+_0x344bc4[_0x100ed4(0x757)]);return;}const _0x2341c1={'name':_0x2d3f96,'chatId':document['getElementById'](_0x100ed4(0x1223))['value'],'regex':_0x1470c3,'template':document['getElementById'](_0x100ed4(0xbc9))[_0x100ed4(0x4e0)],'isEnabled':document[_0x100ed4(0x479)](_0x100ed4(0xf8c))['checked']};_0x104c4a?await _0xb81d4e[_0x100ed4(0xb06)][_0x100ed4(0xeb2)](_0x104c4a,_0x2341c1):await _0xb81d4e[_0x100ed4(0xb06)][_0x100ed4(0x807)](_0x2341c1),document[_0x100ed4(0x479)]('rule-editor-modal')[_0x100ed4(0x9cd)][_0x100ed4(0x8b6)](_0x100ed4(0x45a)),await _0x243bd3();}async function _0x18a073(_0x3e1ca0){const _0xdb0054=_0x85c4bf,_0x213f64=await _0x1a9e79(_0xdb0054(0x6f8),'确定要删除这条渲染规则吗？',{'confirmButtonClass':_0xdb0054(0x95a)});_0x213f64&&(await _0xb81d4e[_0xdb0054(0xb06)][_0xdb0054(0x1ea)](_0x3e1ca0),await _0x243bd3());}async function _0xef16b0(_0x5e4fea,_0x212a4b){const _0x47ede5=_0x85c4bf;if(_0x5e4fea['trim']()[_0x47ede5(0x591)]('<')||!_0x5e4fea[_0x47ede5(0x44f)]('[')&&!_0x5e4fea['includes']('{'))return _0x5e4fea;if(!_0x2ca317[_0x212a4b]){console['log']('Caching\x20rendering\x20rules\x20for\x20chat:\x20'+_0x212a4b);const _0x10240a=await _0xb81d4e[_0x47ede5(0xb06)][_0x47ede5(0x46f)](_0x47ede5(0xd4e))[_0x47ede5(0x4a2)](_0x47ede5(0xb48))['or'](_0x47ede5(0xd4e))[_0x47ede5(0x4a2)](_0x212a4b)[_0x47ede5(0x4ba)]();_0x2ca317[_0x212a4b]=_0x10240a[_0x47ede5(0x85d)](_0x14686a=>_0x14686a[_0x47ede5(0xfb5)]);}const _0x29586e=_0x2ca317[_0x212a4b];let _0x5a3633=_0x5e4fea;for(const _0x365a60 of _0x29586e){try{const _0x25dff4=new RegExp(_0x365a60[_0x47ede5(0x364)],'g');let _0x234f94=_0x5a3633;_0x25dff4[_0x47ede5(0x101d)](_0x234f94)&&(_0x5a3633=_0x5a3633['replace'](_0x25dff4,_0x365a60[_0x47ede5(0x346)]));}catch(_0x48e134){console[_0x47ede5(0xe3b)](_0x47ede5(0xdee)+_0x365a60[_0x47ede5(0x564)]+_0x47ede5(0xe78),_0x48e134);}}return _0x5a3633;}function _0x5b803c(_0x3528df){const _0x341a8c=_0x85c4bf;if(!_0x3528df)return'';const _0x440617=new Date(),_0x36182c=new Date(_0x3528df),_0x5f436e=String(_0x36182c[_0x341a8c(0x507)]())['padStart'](0x2,'0'),_0x5c5c9e=String(_0x36182c[_0x341a8c(0x28c)]())['padStart'](0x2,'0'),_0x4d6f71=_0x5f436e+':'+_0x5c5c9e;if(_0x440617[_0x341a8c(0x966)]()===_0x36182c[_0x341a8c(0x966)]())return _0x4d6f71;const _0x13257d=new Date();_0x13257d[_0x341a8c(0x12e9)](_0x440617[_0x341a8c(0x469)]()-0x1);if(_0x13257d[_0x341a8c(0x966)]()===_0x36182c[_0x341a8c(0x966)]())return _0x341a8c(0x3d4)+_0x4d6f71;const _0x96d583=_0x36182c['getFullYear'](),_0x422421=String(_0x36182c['getMonth']()+0x1)[_0x341a8c(0x738)](0x2,'0'),_0x3b588e=String(_0x36182c[_0x341a8c(0x469)]())[_0x341a8c(0x738)](0x2,'0');return _0x440617[_0x341a8c(0xd45)]()===_0x96d583?_0x422421+'月'+_0x3b588e+'日\x20'+_0x4d6f71:_0x96d583+'年'+_0x422421+'月'+_0x3b588e+'日\x20'+_0x4d6f71;}function _0x3a0a18(_0x21a879){const _0x1056a6=_0x85c4bf,_0x4dd7b6=document[_0x1056a6(0xbd5)](_0x1056a6(0x6c8));_0x4dd7b6[_0x1056a6(0xfd4)]=_0x1056a6(0x617);const _0x26ab60=document[_0x1056a6(0xbd5)]('div');return _0x26ab60[_0x1056a6(0xfd4)]=_0x1056a6(0xea7),_0x26ab60[_0x1056a6(0x97b)]=_0x5b803c(_0x21a879),_0x4dd7b6[_0x1056a6(0x9f4)](_0x26ab60),_0x4dd7b6;}async function _0x4e4289(){const _0x102dc0=_0x85c4bf,_0x50b8ef=_0x505390['chats'][_0x505390['activeChatId']];if(!_0x50b8ef||!lastResponseTimestamps||lastResponseTimestamps['length']===0x0){alert(_0x102dc0(0x7dc));return;}_0x50b8ef[_0x102dc0(0x7d3)]=_0x50b8ef[_0x102dc0(0x7d3)][_0x102dc0(0x85d)](_0x2e55ba=>!lastResponseTimestamps[_0x102dc0(0x44f)](_0x2e55ba['timestamp'])),await _0xb81d4e[_0x102dc0(0x1027)]['put'](_0x50b8ef),await _0x474d6b(_0x505390[_0x102dc0(0x233)]),_0x1b1d53();}async function _0x42c20a(){const _0x128d20=_0x85c4bf,_0x1fb7a7=_0x505390[_0x128d20(0x1027)][_0x505390['activeChatId']];if(!_0x1fb7a7)return;const _0x299f94=_0x1fb7a7[_0x128d20(0x7d3)]['findLastIndex'](_0x2946c1=>_0x2946c1[_0x128d20(0x508)]===_0x128d20(0x4c5)&&!_0x2946c1[_0x128d20(0xb9c)]);if(_0x299f94===-0x1){alert(_0x128d20(0x48f));return;}const _0x4cd40c=_0x1fb7a7[_0x128d20(0x7d3)][_0x128d20(0x1c8)](_0x3a9e5f=>_0x3a9e5f[_0x128d20(0x508)]===_0x128d20(0x1328));if(_0x4cd40c<_0x299f94){alert('AI\x20尚未对您的最后一条消息做出回应，无法重新生成。');return;}_0x1fb7a7[_0x128d20(0x7d3)][_0x128d20(0x118e)](_0x299f94+0x1),await _0xb81d4e['chats']['put'](_0x1fb7a7),await _0x474d6b(_0x505390[_0x128d20(0x233)]),await _0x15e1a8();}async function _0x454410(){const _0x2aa957=_0x85c4bf;if(!_0x315a6a['isActive'])return;const _0x49a19a=_0x315a6a['callHistory']['findLastIndex'](_0x244506=>_0x244506[_0x2aa957(0x508)]===_0x2aa957(0x4c5));if(_0x49a19a===-0x1){alert(_0x2aa957(0x689));return;}_0x315a6a[_0x2aa957(0xb25)][_0x2aa957(0x118e)](_0x49a19a+0x1);const _0x1da533=document['getElementById'](_0x2aa957(0x21e));_0x1da533['innerHTML']='',_0x315a6a[_0x2aa957(0xb25)]['forEach'](_0xbfe7d1=>{const _0x3ed19a=_0x2aa957,_0x470c32=document[_0x3ed19a(0xbd5)]('div');_0x470c32[_0x3ed19a(0xfd4)]=_0x3ed19a(0xf4c)+_0xbfe7d1['role']+_0x3ed19a(0x133d),_0x470c32[_0x3ed19a(0x13d4)][_0x3ed19a(0x12a2)]=_0xbfe7d1['timestamp'],_0xbfe7d1[_0x3ed19a(0x508)]===_0x3ed19a(0x4c5)?_0x470c32[_0x3ed19a(0x97b)]=_0xbfe7d1[_0x3ed19a(0xac4)]:_0x470c32[_0x3ed19a(0x3de)]=_0xbfe7d1[_0x3ed19a(0xac4)],_0x33282f(_0x470c32,()=>_0x26d0c7(_0xbfe7d1['timestamp'])),_0x1da533['appendChild'](_0x470c32);}),_0x1da533[_0x2aa957(0x2b3)]=_0x1da533[_0x2aa957(0x9c5)],_0x5cb9e2(null);}async function _0x3c4a3e(){const _0x5a05b0=_0x85c4bf,_0x2e9039=_0x505390['chats'][_0x505390[_0x5a05b0(0x233)]];if(!_0x2e9039)return;_0x156c85(_0x2e9039['id'],!![]);const _0x588f24=document[_0x5a05b0(0x479)](_0x5a05b0(0x81f));!_0x2e9039['isGroup']&&(_0x588f24['style']['opacity']=0x0,setTimeout(()=>{const _0x2dbc99=_0x5a05b0;_0x588f24[_0x2dbc99(0x97b)]=_0x2dbc99(0x12ad),_0x588f24[_0x2dbc99(0x9cd)][_0x2dbc99(0x807)]('typing-status'),_0x588f24[_0x2dbc99(0x10dd)][_0x2dbc99(0x939)]=0x1;},0xc8));try{const {proxyUrl:_0x313db2,apiKey:_0x16b758,model:_0x27f1e2}=_0x505390[_0x5a05b0(0x30c)];if(!_0x313db2||!_0x16b758||!_0x27f1e2)throw new Error(_0x5a05b0(0x34f));const _0x268701=parseInt(_0x2e9039[_0x5a05b0(0x18a)][_0x5a05b0(0x2c6)])||0xa,_0x2d3f44=_0x2e9039['history'][_0x5a05b0(0x777)](-_0x268701),_0x545555=new Date(),_0x2a0642=new Date(_0x545555[_0x5a05b0(0xd2b)]()+_0x545555[_0x5a05b0(0x1387)]()*0xea60+0x36ee80*0x8),_0x3d2df9=_0x2a0642[_0x5a05b0(0x119c)]('zh-CN',{'timeZone':_0x5a05b0(0x20e),'dateStyle':_0x5a05b0(0xf31),'timeStyle':_0x5a05b0(0xe6f)}),_0x50f3ee=_0x3ae0c5(_0x2a0642),_0xefb878=_0x2e9039[_0x5a05b0(0x18a)]['myNickname']||'我';let _0xb48a4e='';if(_0x2e9039[_0x5a05b0(0x18a)][_0x5a05b0(0x13da)]&&_0x2e9039[_0x5a05b0(0x18a)][_0x5a05b0(0x13da)]['length']>0x0){const _0x309cb0=_0x2e9039[_0x5a05b0(0x18a)][_0x5a05b0(0x13da)][_0x5a05b0(0x2e1)](_0x9dce3=>{const _0x52bbf7=_0x5a05b0,_0x3acded=_0x505390['worldBooks']['find'](_0x5e1b0f=>_0x5e1b0f['id']===_0x9dce3);if(!_0x3acded||!Array[_0x52bbf7(0x285)](_0x3acded[_0x52bbf7(0xac4)]))return'';const _0x259f66=_0x3acded[_0x52bbf7(0xac4)][_0x52bbf7(0x85d)](_0x20e8a8=>_0x20e8a8[_0x52bbf7(0x2b7)]!==![])[_0x52bbf7(0x2e1)](_0x2e5b62=>{const _0x74b4d3=_0x52bbf7;let _0xc2dc49=_0x74b4d3(0x1345)+(_0x2e5b62[_0x74b4d3(0xd6c)]||_0x74b4d3(0x561))+'\x0a';if(_0x2e5b62[_0x74b4d3(0x108c)][_0x74b4d3(0x990)]>0x0)_0xc2dc49+=_0x74b4d3(0x6ff)+_0x2e5b62['keys']['join'](',\x20')+'\x0a';return _0xc2dc49+='**内容:**\x0a'+_0x2e5b62[_0x74b4d3(0xac4)],_0xc2dc49;})[_0x52bbf7(0x35d)]('');return _0x259f66?_0x52bbf7(0x103d)+_0x3acded[_0x52bbf7(0x564)]+'\x0a'+_0x259f66:'';})[_0x5a05b0(0x85d)](Boolean)['join']('');_0x309cb0&&(_0xb48a4e=_0x5a05b0(0x12b0)+_0x309cb0+'\x0a#\x20---\x20世界书设定结束\x20---\x0a');}let _0x427bc7='';if(_0x304e8d['isActive']&&_0x304e8d[_0x5a05b0(0x233)]===_0x2e9039['id']){const _0x2a921e=_0x304e8d[_0x5a05b0(0x12a5)]>-0x1?_0x304e8d['playlist'][_0x304e8d['currentIndex']]:null;_0x427bc7=_0x5a05b0(0x8ef);}const _0x265d01=_0xd8afdd(_0x5aa690[_0x2e9039['id']]);let _0x687d3a='';_0x2e9039[_0x5a05b0(0x102f)]&&_0x2e9039['nameHistory'][_0x5a05b0(0x990)]>0x0&&(_0x687d3a=_0x5a05b0(0xfcd)+_0x2e9039['nameHistory'][_0x5a05b0(0x35d)](',\x20')+_0x5a05b0(0x1c1));let _0x520331='';const _0x286a3d=_0x505390[_0x5a05b0(0x1190)][_0x5a05b0(0x904)]||'用户';_0x520331+=_0x5a05b0(0xbb8)+_0x286a3d+_0x5a05b0(0x249);const _0x147b22=Object[_0x5a05b0(0x3d5)](_0x505390['chats'])[_0x5a05b0(0x85d)](_0xadef2e=>_0xadef2e[_0x5a05b0(0x9d7)]&&_0xadef2e['members'][_0x5a05b0(0x1235)](_0x3b5f5a=>_0x3b5f5a['id']===_0x2e9039['id']));_0x147b22[_0x5a05b0(0x990)]>0x0&&(_0x520331+=_0x5a05b0(0xb50),_0x147b22[_0x5a05b0(0x12be)](_0x53602c=>{const _0x334ca4=_0x5a05b0,_0xb3410c=_0x53602c[_0x334ca4(0x18a)][_0x334ca4(0xf58)]||_0x286a3d;_0x520331+=_0x334ca4(0x11f5)+_0x53602c['name']+_0x334ca4(0x421)+_0xb3410c+'”。\x0a';}));_0x520331+=_0x5a05b0(0xadc);const _0x11ba06=_0xfe3b04(_0x2e9039),_0x40ff53=_0x5a05b0(0x826)+_0x2e9039[_0x5a05b0(0xe2d)]+_0x5a05b0(0xa39)+_0x3d2df9+'\x20('+_0x50f3ee+_0x5a05b0(0xb41)+(_0x427bc7?_0x5a05b0(0xee7)+_0x427bc7:'你们没有在听歌。')+'\x0a\x0a3.\x20\x20**主动性**:\x0a\x20\x20\x20\x20-\x20你可以根据对话发展，使用指令来更新自己的状态、更换头像、记录回忆、发起约定或执行其他社交行为。\x0a\x20\x20\x20\x20-\x20【关系破裂时】才可使用\x20`block_user`\x20指令。\x0a4.\x20\x20**内心独白\x20(必须执行)**:\x20在所有其他指令之后，JSON数组的【最后】必须包含一个\x20\x22update_thoughts\x22\x20指令，用于更新角色的“心声”和“散记”。\x0a\x20\x20\x20\x20-\x20**心声\x20(heartfelt_voice)**:\x20一句话概括角色此刻最核心、最私密的想法。\x0a\x20\x20\x20\x20-\x20**散记\x20(random_jottings)**:\x20一段50字以上的、符合人设的思考或心情记录，禁止OOC。\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20长期记忆\x20(必须严格遵守)\x0a'+(_0x2e9039[_0x5a05b0(0x3b4)]&&_0x2e9039[_0x5a05b0(0x3b4)][_0x5a05b0(0x990)]>0x0?_0x2e9039[_0x5a05b0(0x3b4)][_0x5a05b0(0x2e1)](_0x2259ab=>'-\x20'+_0x2259ab[_0x5a05b0(0xac4)])[_0x5a05b0(0x35d)]('\x0a'):_0x5a05b0(0xa15))+_0x5a05b0(0x1317)+_0x2e9039['settings'][_0x5a05b0(0x11f6)]+'\x0a\x0a#\x20关系与身份档案\x20(至关重要)\x0a-\x20\x20\x20**你的本名**:\x20\x22'+_0x2e9039[_0x5a05b0(0xe2d)]+'\x22\x20(核心身份，用于指令中的\x27name\x27字段)\x0a-\x20\x20\x20**用户给你的备注**:\x20\x22'+_0x2e9039[_0x5a05b0(0x564)]+_0x5a05b0(0xdbe)+_0xefb878+_0x5a05b0(0x411)+_0x520331+'\x0a\x20\x20\x20\x20'+_0x687d3a+_0x5a05b0(0x44e)+_0xb48a4e+_0x5a05b0(0xe03)+_0x11ba06+'\x0a#\x20可用资源\x0a-\x20\x20\x20**你的头像库**:\x0a\x20\x20\x20\x20'+(_0x2e9039[_0x5a05b0(0x18a)][_0x5a05b0(0x8c6)]&&_0x2e9039[_0x5a05b0(0x18a)]['aiAvatarLibrary'][_0x5a05b0(0x990)]>0x0?_0x2e9039[_0x5a05b0(0x18a)][_0x5a05b0(0x8c6)][_0x5a05b0(0x2e1)](_0x4cecb3=>'-\x20'+_0x4cecb3[_0x5a05b0(0x564)])['join']('\x0a'):_0x5a05b0(0xd22))+'\x0a-\x20\x20\x20**用户的头像库**:\x0a\x20\x20\x20\x20'+(_0x2e9039[_0x5a05b0(0x18a)][_0x5a05b0(0x846)]&&_0x2e9039[_0x5a05b0(0x18a)][_0x5a05b0(0x846)]['length']>0x0?_0x2e9039[_0x5a05b0(0x18a)][_0x5a05b0(0x846)][_0x5a05b0(0x2e1)](_0x4b6a44=>'-\x20'+_0x4b6a44['name'])[_0x5a05b0(0x35d)]('\x0a'):_0x5a05b0(0xd22))+_0x5a05b0(0xe69)+_0x2e9039[_0x5a05b0(0x18a)]['myPersona']+_0x5a05b0(0x681),_0x1cae0f=_0x2d3f44[_0x5a05b0(0x2e1)](_0x81a444=>({'role':_0x81a444[_0x5a05b0(0x508)],'content':String(_0x81a444['content'])}));_0x1cae0f[_0x5a05b0(0x1a0)]({'role':_0x5a05b0(0x4c5),'content':_0x5a05b0(0x3bf)});let _0x2b49ce=_0x313db2===GEMINI_API_URL,_0x50c0e4=_0x19a701(_0x27f1e2,_0x16b758,_0x40ff53,_0x1cae0f);const _0x15324d=_0x2b49ce?await fetch(_0x50c0e4['url'],_0x50c0e4[_0x5a05b0(0x104c)]):await fetch(_0x313db2+'/v1/chat/completions',{'method':'POST','headers':{'Content-Type':_0x5a05b0(0xcb5),'Authorization':_0x5a05b0(0xb27)+_0x16b758},'body':JSON[_0x5a05b0(0x1308)]({'model':_0x27f1e2,'messages':[{'role':_0x5a05b0(0xbaa),'content':_0x40ff53},..._0x1cae0f],'temperature':_0x505390[_0x5a05b0(0x888)][_0x5a05b0(0x398)]||0.8})});if(!_0x15324d['ok']){const _0x5b9954=await _0x15324d['json']();throw new Error(_0x5a05b0(0xf05)+_0x5b9954[_0x5a05b0(0xe3b)][_0x5a05b0(0x757)]);}const _0x108b8e=await _0x15324d[_0x5a05b0(0xfdf)](),_0x477d3f=getGeminiResponseText(_0x108b8e),_0xb1bc34=_0x2da9f3(_0x477d3f),_0x1a4026=[];for(const _0x56c685 of _0xb1bc34){if(_0x56c685[_0x5a05b0(0x858)]===_0x5a05b0(0x56d)&&typeof _0x56c685['content']===_0x5a05b0(0x8d9)&&_0x56c685[_0x5a05b0(0xac4)][_0x5a05b0(0x44f)]('\x0a')){const _0x374124=_0x56c685[_0x5a05b0(0xac4)]['split'](/\n+/)[_0x5a05b0(0x85d)](_0x27bcf0=>_0x27bcf0['trim']());_0x374124[_0x5a05b0(0x12be)](_0x3e10a6=>{const _0x426581=_0x5a05b0;_0x1a4026[_0x426581(0x1a0)]({..._0x56c685,'content':_0x3e10a6});});}else _0x1a4026[_0x5a05b0(0x1a0)](_0x56c685);}let _0xc03723=Date[_0x5a05b0(0x12d6)]();for(const _0x1da3d8 of _0x1a4026){const _0x31bea7={'role':_0x5a05b0(0x1328),'senderName':_0x2e9039['originalName'],'timestamp':_0xc03723++,'content':_0x1da3d8[_0x5a05b0(0xac4)]||_0x1da3d8[_0x5a05b0(0x757)],'type':_0x1da3d8[_0x5a05b0(0x858)]||'text'};if(_0x1da3d8[_0x5a05b0(0x858)]===_0x5a05b0(0x751)){if(!_0x2e9039['isGroup']){if(_0x1da3d8[_0x5a05b0(0x279)])_0x2e9039['heartfeltVoice']=String(_0x1da3d8[_0x5a05b0(0x279)]);if(_0x1da3d8[_0x5a05b0(0x84f)])_0x2e9039[_0x5a05b0(0x2cf)]=String(_0x1da3d8[_0x5a05b0(0x84f)]);}continue;}_0x2e9039[_0x5a05b0(0x7d3)][_0x5a05b0(0x1a0)](_0x31bea7),_0x48f5ff(_0x31bea7,_0x2e9039),await new Promise(_0x5c916f=>setTimeout(_0x5c916f,Math['random']()*0x3e8+0x320));}await _0xb81d4e[_0x5a05b0(0x1027)][_0x5a05b0(0x5d0)](_0x2e9039),_0x1b7f69();}catch(_0x2daed4){console[_0x5a05b0(0xe3b)](_0x5a05b0(0x10a4),_0x2daed4),await _0x1519c8('操作失败',_0x5a05b0(0xe2b)+_0x2daed4['message']);}finally{_0x156c85(_0x2e9039['id'],![]);if(!_0x2e9039[_0x5a05b0(0x9d7)]&&document[_0x5a05b0(0x479)]('chat-header-title')){const _0x6f44be=document[_0x5a05b0(0x479)](_0x5a05b0(0x81f));_0x6f44be['style'][_0x5a05b0(0x939)]=0x0,setTimeout(()=>{const _0x215358=_0x5a05b0;_0x6f44be['textContent']=_0x2e9039[_0x215358(0x564)],_0x6f44be[_0x215358(0x9cd)][_0x215358(0x8b6)](_0x215358(0x11c7)),_0x6f44be[_0x215358(0x10dd)]['opacity']=0x1;},0xc8);}}}function _0x361231(){const _0x45db5b=_0x85c4bf,_0x4419b4=document['getElementById'](_0x45db5b(0x5af)),_0x4d03e0=_0x505390[_0x45db5b(0x888)][_0x45db5b(0xb10)]||_0x19106c;_0x4d03e0&&_0x4d03e0[_0x45db5b(0x9c1)]()&&(_0x4419b4[_0x45db5b(0xa9c)]=_0x4d03e0,_0x4419b4['play']()[_0x45db5b(0x575)](_0x42976=>console[_0x45db5b(0x90f)]('播放被中断，这是正常行为:',_0x42976)));}function _0x31ff84(){const _0x5736f1=_0x85c4bf;if(!_0x505390[_0x5736f1(0x888)]['widgetData'])return;for(const _0x377c05 in _0x505390[_0x5736f1(0x888)][_0x5736f1(0xd79)]){const _0x333220=document[_0x5736f1(0x479)](_0x377c05),_0x3bf629=_0x505390['globalSettings'][_0x5736f1(0xd79)][_0x377c05];_0x333220&&(_0x333220[_0x5736f1(0x612)]===_0x5736f1(0x42d)?_0x333220[_0x5736f1(0xa9c)]=_0x3bf629:_0x333220[_0x5736f1(0x97b)]=_0x3bf629);}}function _0x1ec1dd(){return new Promise(_0x577b1a=>{const _0x3d0a1f=_0x6666,_0x34835a=document[_0x3d0a1f(0xbd5)]('input');_0x34835a[_0x3d0a1f(0x858)]=_0x3d0a1f(0x1206),_0x34835a[_0x3d0a1f(0xacb)]='image/*',_0x34835a[_0x3d0a1f(0x8b9)]=_0x260eea=>{const _0x5b6a43=_0x3d0a1f,_0x3ff873=_0x260eea[_0x5b6a43(0xfa2)]['files'][0x0];if(_0x3ff873){const _0x4fccca=new FileReader();_0x4fccca[_0x5b6a43(0x502)]=_0x1f10bf=>{const _0x4e2e28=_0x5b6a43;_0x577b1a(_0x1f10bf[_0x4e2e28(0xfa2)][_0x4e2e28(0x97e)]);},_0x4fccca[_0x5b6a43(0x83c)](_0x3ff873);}else _0x577b1a(null);},_0x34835a[_0x3d0a1f(0xd2f)]();});}async function _0x1da0e9(_0x52d915){const _0x4e38fa=_0x85c4bf,_0x5e1788=_0x52d915['id'],_0x5afb97=_0x52d915[_0x4e38fa(0x97b)],_0x4868a3=await _0x9a2c09(_0x4e38fa(0x30e),_0x4e38fa(0x518),_0x5afb97);if(_0x4868a3!==null&&_0x4868a3[_0x4e38fa(0x9c1)]()!==''){const _0x1e61ae=_0x4868a3[_0x4e38fa(0x9c1)]();_0x52d915[_0x4e38fa(0x97b)]=_0x1e61ae,_0x505390[_0x4e38fa(0x888)][_0x4e38fa(0xd79)][_0x5e1788]=_0x1e61ae,await _0xb81d4e[_0x4e38fa(0x888)][_0x4e38fa(0x5d0)](_0x505390[_0x4e38fa(0x888)]),alert(_0x4e38fa(0xab0));}}async function _0x604c0c(_0x17abaf){const _0x1d123e=_0x85c4bf,_0x5dce6d=_0x17abaf['id'],_0x4bd5c9=await _0x5adb5e(_0x1d123e(0xc39),[{'text':_0x1d123e(0x83f),'value':_0x1d123e(0x8d3)},{'text':_0x1d123e(0x10d7),'value':_0x1d123e(0x5f3)}]);let _0x4b0393=null;if(_0x4bd5c9==='local')_0x4b0393=await _0x1ec1dd();else _0x4bd5c9===_0x1d123e(0x5f3)&&(_0x4b0393=await _0x9a2c09(_0x1d123e(0xc39),_0x1d123e(0xca6),_0x17abaf[_0x1d123e(0xa9c)],_0x1d123e(0x5f3)));if(_0x4b0393&&_0x4b0393[_0x1d123e(0x9c1)]()){const _0x256fad=_0x4b0393[_0x1d123e(0x9c1)]();_0x17abaf[_0x1d123e(0xa9c)]=_0x256fad,_0x505390[_0x1d123e(0x888)][_0x1d123e(0xd79)][_0x5dce6d]=_0x256fad,await _0xb81d4e['globalSettings'][_0x1d123e(0x5d0)](_0x505390[_0x1d123e(0x888)]),alert('图片已更新！');}else _0x4bd5c9==='url'&&_0x4b0393!==null&&alert(_0x1d123e(0x4b0));}const _0x27c1e4={'getSongCache'(_0x3e93e4,_0x47f1f4){const _0x12f92e=_0x85c4bf,_0x44649a=(_0x47f1f4||_0x12f92e(0xf78))+':'+_0x3e93e4;if(_0x505390['cache']&&_0x505390['cache'][_0x12f92e(0x9e1)]){const _0x5400d0=_0x505390['cache']['songs'][_0x12f92e(0x111a)](_0x44649a);if(_0x5400d0&&Date['now']()-_0x5400d0[_0x12f92e(0x12a2)]<0x36ee80)return _0x5400d0['data'];}return null;},'setSongCache'(_0x3dce04,_0x50cd03,_0x3ad521){const _0x5f12be=_0x85c4bf,_0x57833a=(_0x3ad521||'all')+':'+_0x3dce04;if(!_0x505390['cache'])_0x505390[_0x5f12be(0x253)]={};if(!_0x505390[_0x5f12be(0x253)][_0x5f12be(0x9e1)])_0x505390[_0x5f12be(0x253)][_0x5f12be(0x9e1)]=new Map();_0x505390[_0x5f12be(0x253)][_0x5f12be(0x9e1)][_0x5f12be(0x111b)](_0x57833a,{'data':_0x50cd03,'timestamp':Date['now']()});}};typeof Http_Get_External==='undefined'&&(window['Http_Get_External']=function(_0x3eca98){return new Promise(_0x5e6a53=>{const _0x2c3325=_0x6666;fetch(_0x3eca98)[_0x2c3325(0x13d8)](_0x50bf53=>_0x50bf53[_0x2c3325(0xfdf)]()[_0x2c3325(0x575)](()=>_0x50bf53[_0x2c3325(0x56d)]()))['then'](_0x5e6a53)[_0x2c3325(0x575)](()=>_0x5e6a53(null));});});async function _0x302b5c(_0xb019fa){return await Http_Get_External(_0xb019fa);}function _0x2ffb66(_0x1c9438){return new Promise(_0x18615e=>{const _0x1dfd9d=_0x6666,_0xb8a5c0=new Audio();_0xb8a5c0[_0x1dfd9d(0xa75)](_0x1dfd9d(0x499),()=>_0x18615e(!![]),{'once':!![]}),_0xb8a5c0[_0x1dfd9d(0xa75)](_0x1dfd9d(0xe3b),()=>_0x18615e(![]),{'once':!![]}),_0xb8a5c0[_0x1dfd9d(0xa9c)]=_0x1c9438;});}async function _0x55856a(_0x45e88a,_0xb6a698){const _0x42b279=_0x85c4bf;try{let _0x114891=_0x45e88a['replace'](/\s/g,'');_0xb6a698&&(_0x114891+='\x20'+_0xb6a698[_0x42b279(0x491)](/\s/g,''));const _0x5a07db=_0x42b279(0xf1a)+encodeURIComponent(_0x114891);console['log']('正在请求网易云音乐API:',_0x5a07db);const _0x46112a=await fetch(_0x5a07db);if(!_0x46112a['ok'])throw new Error('API\x20请求失败，状态码:\x20'+_0x46112a[_0x42b279(0x93c)]);const _0x274de1=await _0x46112a[_0x42b279(0xfdf)]();if(_0x274de1['code']!==0xc8||!_0x274de1[_0x42b279(0x104c)]||_0x274de1[_0x42b279(0x104c)][_0x42b279(0x990)]===0x0)return console[_0x42b279(0x90f)](_0x42b279(0x8d8),_0x274de1),[];return _0x274de1['data'][_0x42b279(0x2e1)](_0x272a12=>({'name':_0x272a12[_0x42b279(0x638)],'artist':_0x272a12['singer'],'id':_0x272a12['id'],'cover':_0x272a12[_0x42b279(0x82e)]||_0x42b279(0x11dd),'source':'netease'}))[_0x42b279(0x777)](0x0,0x1e);}catch(_0x52ca14){return console[_0x42b279(0xe3b)](_0x42b279(0xd2a),_0x52ca14),[];}}async function _0x9e7734(_0x304a96){const _0x1a290b=_0x85c4bf;try{_0x304a96=_0x304a96[_0x1a290b(0x491)](/\s/g,'');const _0x1a48f9=await _0x302b5c(_0x1a290b(0xa8f)+encodeURIComponent(_0x304a96));if(!_0x1a48f9?.[_0x1a290b(0x104c)]?.[_0x1a290b(0x990)])return[];return _0x1a48f9[_0x1a290b(0x104c)][_0x1a290b(0x2e1)](_0x2291b7=>({'name':_0x2291b7[_0x1a290b(0x638)],'artist':_0x2291b7[_0x1a290b(0x8d1)],'id':_0x2291b7['id'],'cover':_0x2291b7[_0x1a290b(0x82e)]||_0x1a290b(0xd38),'source':_0x1a290b(0xd05)}))['slice'](0x0,0x1e);}catch(_0x1c8a7e){return console[_0x1a290b(0xe3b)](_0x1a290b(0x11ad),_0x1c8a7e),[];}}async function _0x4fd519(){const _0x4004cc=_0x85c4bf,_0x3e4b66=await _0x9a2c09(_0x4004cc(0x10be),_0x4004cc(0x1318));if(!_0x3e4b66||!_0x3e4b66[_0x4004cc(0x9c1)]())return;await _0x1519c8(_0x4004cc(0xbd7),_0x4004cc(0x1376));let _0x177603=_0x3e4b66[_0x4004cc(0x9c1)](),_0x2db38b='';if(_0x3e4b66[_0x4004cc(0x44f)]('-')||_0x3e4b66[_0x4004cc(0x44f)]('–')){const _0x97a176=_0x3e4b66['split'](/[-–]/);_0x177603=_0x97a176[0x0][_0x4004cc(0x9c1)](),_0x2db38b=_0x97a176[_0x4004cc(0x777)](0x1)['join']('\x20')['trim']();}const [_0x226a6d,_0x54894c]=await Promise[_0x4004cc(0xf78)]([_0x55856a(_0x177603,_0x2db38b),_0x9e7734(_0x177603)]),_0x1c3159=[..._0x226a6d,..._0x54894c];if(_0x1c3159[_0x4004cc(0x990)]===0x0){await _0x1519c8(_0x4004cc(0x6f1),_0x4004cc(0x13c0));return;}const _0x3b5abd=document[_0x4004cc(0x479)](_0x4004cc(0x2e3)),_0x121d0e=document[_0x4004cc(0x479)](_0x4004cc(0x1af));_0x121d0e[_0x4004cc(0x3de)]='',document[_0x4004cc(0x479)]('select-all-music-search')['checked']=![],_0x1c3159['forEach'](_0x351890=>{const _0x44e78c=_0x4004cc,_0x1ee323=document[_0x44e78c(0xbd5)](_0x44e78c(0x6c8));_0x1ee323[_0x44e78c(0xfd4)]=_0x44e78c(0x79c),_0x1ee323['dataset'][_0x44e78c(0x1256)]=JSON[_0x44e78c(0x1308)](_0x351890),_0x1ee323[_0x44e78c(0x3de)]=_0x44e78c(0xca1)+_0x351890[_0x44e78c(0x564)]+_0x44e78c(0x5db)+_0x351890['artist']+_0x44e78c(0xd73)+(_0x351890[_0x44e78c(0x910)]==='netease'?_0x44e78c(0x47c):'QQ音乐')+_0x44e78c(0xc8e),_0x121d0e['appendChild'](_0x1ee323);}),_0x3b5abd[_0x4004cc(0x9cd)][_0x4004cc(0x807)]('visible');}async function _0x1b4a5b(_0x3bcf5c){const _0xad4bfd=_0x85c4bf;let _0x44486d=null,_0x6fb26b=_0x3bcf5c[_0xad4bfd(0x910)];const _0x16937b=_0x3bcf5c[_0xad4bfd(0x910)]===_0xad4bfd(0x1df)?'https://api.vkeys.cn/v2/music/netease?id='+_0x3bcf5c['id']:_0xad4bfd(0x9fb)+_0x3bcf5c['id'];let _0x4fa0c6=await _0x302b5c(_0x16937b);_0x4fa0c6?.['data']?.['url']&&(_0x44486d={'url':_0x4fa0c6[_0xad4bfd(0x104c)][_0xad4bfd(0x5f3)],'id':_0x3bcf5c['id'],'source':_0x3bcf5c[_0xad4bfd(0x910)]});if(!_0x44486d){const _0x590a0f=_0x3bcf5c[_0xad4bfd(0x910)]===_0xad4bfd(0x1df)?'tencent':'netease',_0x643519=_0x590a0f==='tencent'?await _0x9e7734(_0x3bcf5c[_0xad4bfd(0x564)]):await _0x55856a(_0x3bcf5c[_0xad4bfd(0x564)],_0x3bcf5c[_0xad4bfd(0x9d1)]);if(_0x643519[_0xad4bfd(0x990)]>0x0){const _0x2ac78e=_0x590a0f===_0xad4bfd(0x1df)?_0xad4bfd(0x477)+_0x643519[0x0]['id']:_0xad4bfd(0x9fb)+_0x643519[0x0]['id'],_0x3a6421=await _0x302b5c(_0x2ac78e);_0x3a6421?.[_0xad4bfd(0x104c)]?.[_0xad4bfd(0x5f3)]&&(_0x44486d={'url':_0x3a6421[_0xad4bfd(0x104c)][_0xad4bfd(0x5f3)],'id':_0x643519[0x0]['id'],'source':_0x590a0f},_0x6fb26b=_0x590a0f);}}if(_0x44486d){_0x44486d['url']&&typeof _0x44486d[_0xad4bfd(0x5f3)]===_0xad4bfd(0x8d9)&&(_0x44486d[_0xad4bfd(0x5f3)]=_0x44486d['url'][_0xad4bfd(0x491)](/^http:\/\//i,_0xad4bfd(0x3e2)));_0x3bcf5c[_0xad4bfd(0x82e)]&&typeof _0x3bcf5c[_0xad4bfd(0x82e)]===_0xad4bfd(0x8d9)&&(_0x3bcf5c[_0xad4bfd(0x82e)]=_0x3bcf5c['cover'][_0xad4bfd(0x491)](/^http:\/\//i,'https://'));const _0x516e4b=await _0x152dc3(_0x44486d['id'],_0x6fb26b)||'';return{'name':_0x3bcf5c[_0xad4bfd(0x564)],'artist':_0x3bcf5c[_0xad4bfd(0x9d1)],'src':_0x44486d[_0xad4bfd(0x5f3)],'cover':_0x3bcf5c[_0xad4bfd(0x82e)],'isLocal':![],'lrcContent':_0x516e4b};}return null;}async function _0x152dc3(_0x22e9f3,_0x350fd3){const _0x4dfa01=_0x85c4bf,_0x142160=_0x350fd3==='netease'?_0x4dfa01(0x126b)+_0x22e9f3:_0x4dfa01(0xe16)+_0x22e9f3,_0x70b350=await _0x302b5c(_0x142160);if(_0x70b350?.[_0x4dfa01(0x104c)]){const _0x36428b=_0x70b350['data']['lrc']||_0x70b350[_0x4dfa01(0x104c)][_0x4dfa01(0xcba)]||'',_0x48cd3e=_0x70b350[_0x4dfa01(0x104c)][_0x4dfa01(0x4b5)]||_0x70b350[_0x4dfa01(0x104c)][_0x4dfa01(0x13d9)]||'';return _0x36428b+'\x0a'+_0x48cd3e;}return'';}async function _0x4148d1(_0x15f943){const _0x3c65b6=_0x85c4bf;if(_0x15f943<0x0||_0x15f943>=_0x304e8d[_0x3c65b6(0x13c7)][_0x3c65b6(0x990)])return;const _0x3885e9=await _0x5adb5e('选择歌词导入方式',[{'text':'📁\x20从本地文件\x20(.lrc)','value':_0x3c65b6(0x1206)},{'text':_0x3c65b6(0xcf9),'value':_0x3c65b6(0x12b1)}]);let _0x16a82d=null;if(_0x3885e9==='file')_0x16a82d=await new Promise(_0x628f1b=>{const _0x19f0f3=_0x3c65b6,_0x5700d9=document[_0x19f0f3(0x479)]('lrc-upload-input'),_0xd6742d=_0x2b2227=>{const _0x349d53=_0x19f0f3,_0x1b983d=_0x2b2227['target'][_0x349d53(0xe63)][0x0];if(_0x1b983d){const _0x31dd08=new FileReader();_0x31dd08[_0x349d53(0x502)]=_0x5b275b=>_0x628f1b(_0x5b275b['target'][_0x349d53(0x97e)]),_0x31dd08[_0x349d53(0x1337)]=()=>_0x628f1b(null),_0x31dd08['readAsText'](_0x1b983d);}else _0x628f1b(null);_0x5700d9[_0x349d53(0xdec)](_0x349d53(0x1150),_0xd6742d),_0x5700d9[_0x349d53(0x4e0)]='';};_0x5700d9[_0x19f0f3(0xa75)](_0x19f0f3(0x1150),_0xd6742d,{'once':!![]}),_0x5700d9[_0x19f0f3(0xd2f)]();});else{if(_0x3885e9===_0x3c65b6(0x12b1)){const _0x2ffbe6=await _0x9a2c09(_0x3c65b6(0x294),_0x3c65b6(0xb54),'',_0x3c65b6(0x1283));if(_0x2ffbe6)_0x16a82d=_0x2ffbe6[_0x3c65b6(0x491)](/\[/g,'\x0a[')[_0x3c65b6(0x9c1)]();}}_0x16a82d!==null&&(_0x304e8d['playlist'][_0x15f943]['lrcContent']=_0x16a82d,await _0x120ddf(),_0x304e8d[_0x3c65b6(0x12a5)]===_0x15f943&&(_0x304e8d[_0x3c65b6(0x6f2)]=_0x1a5b5e(_0x16a82d),_0x2097bb(),_0x5b2fb1()),await _0x1519c8('成功','《'+_0x304e8d['playlist'][_0x15f943]['name']+_0x3c65b6(0xf69)));}async function _0xef4e66(){const _0x5c5c64=_0x85c4bf;if(_0x304e8d[_0x5c5c64(0x12a5)]===-0x1)return;const _0xd8ff7a=_0x304e8d[_0x5c5c64(0x13c7)][_0x304e8d['currentIndex']];if(!_0xd8ff7a)return;_0xd8ff7a[_0x5c5c64(0x68f)]=!_0xd8ff7a['isBgClear'],await _0x120ddf();const _0x10223f=document[_0x5c5c64(0x8bc)](_0x5c5c64(0x11a1)),_0x31771d=document[_0x5c5c64(0x479)](_0x5c5c64(0x50d));_0x10223f[_0x5c5c64(0x9cd)][_0x5c5c64(0x2bf)]('bg-clear',_0xd8ff7a['isBgClear']),_0x31771d[_0x5c5c64(0x9cd)]['toggle'](_0x5c5c64(0x5a9),_0xd8ff7a[_0x5c5c64(0x68f)]);}function _0x112f61(){const _0x1c1e77=_0x85c4bf,_0x19511a=document['getElementById'](_0x1c1e77(0x55b)),_0x1fdad6=document[_0x1c1e77(0x479)](_0x1c1e77(0x20a));_0x19511a&&_0x1fdad6&&(_0x19511a['classList'][_0x1c1e77(0x2bf)](_0x1c1e77(0x45a)),_0x1fdad6[_0x1c1e77(0x9cd)][_0x1c1e77(0x2bf)](_0x1c1e77(0x5a9)));}function _0x2fce15(){const _0x1af8a1=_0x85c4bf,_0x20f698=document[_0x1af8a1(0x8bc)]('.music-player-window'),_0x2d7f30=document[_0x1af8a1(0x479)](_0x1af8a1(0xa20));_0x20f698&&_0x2d7f30&&(_0x20f698[_0x1af8a1(0x9cd)][_0x1af8a1(0x2bf)]('fullscreen'),_0x2d7f30[_0x1af8a1(0x9cd)][_0x1af8a1(0x2bf)]('fullscreen-active'));}window['togglePlayerFullscreen']=_0x2fce15;async function _0x5c0e0a(){const _0x573bd0=_0x85c4bf;if(_0x304e8d['playlist'][_0x573bd0(0x990)]===0x0){alert(_0x573bd0(0x574));return;}const _0x22d6ad=await _0x1a9e79('确认清理无效歌曲？',_0x573bd0(0x1351),{'confirmText':_0x573bd0(0x2f0)});if(!_0x22d6ad)return;await _0x1519c8(_0x573bd0(0xbd7),'正在检查\x20'+_0x304e8d[_0x573bd0(0x13c7)][_0x573bd0(0x990)]+_0x573bd0(0x20b));const _0x1037f8=_0x304e8d[_0x573bd0(0x13c7)][_0x573bd0(0x990)],_0x4748f8=[],_0x39f5ef=[],_0x5e00fc=_0x304e8d[_0x573bd0(0x13c7)][_0x573bd0(0x2e1)](async _0x3ab895=>{const _0x559fc0=_0x573bd0;if(_0x3ab895[_0x559fc0(0x755)]){_0x4748f8['push'](_0x3ab895);return;}const _0x5d7f03=await _0x2ffb66(_0x3ab895[_0x559fc0(0xa9c)]);_0x5d7f03?_0x4748f8[_0x559fc0(0x1a0)](_0x3ab895):(_0x39f5ef['push'](_0x3ab895[_0x559fc0(0x564)]),console['warn']('无效链接:\x20'+_0x3ab895[_0x559fc0(0x564)]+_0x559fc0(0x501)+_0x3ab895[_0x559fc0(0xa9c)]));});await Promise['all'](_0x5e00fc);const _0x1335e9=_0x1037f8-_0x4748f8[_0x573bd0(0x990)];if(_0x1335e9>0x0){const _0x3fc394=_0x304e8d[_0x573bd0(0x13c7)][_0x304e8d['currentIndex']],_0x4f7642=_0x39f5ef['includes'](_0x3fc394?.['name']);_0x304e8d['playlist']=_0x4748f8,await _0x120ddf();if(_0x4f7642)_0x54d46a['pause'](),_0x54d46a[_0x573bd0(0xa9c)]='',_0x304e8d['currentIndex']=_0x304e8d[_0x573bd0(0x13c7)][_0x573bd0(0x990)]>0x0?0x0:-0x1,_0x304e8d['isPlaying']=![];else _0x3fc394&&(_0x304e8d[_0x573bd0(0x12a5)]=_0x304e8d[_0x573bd0(0x13c7)]['findIndex'](_0x4c5d74=>_0x4c5d74['src']===_0x3fc394[_0x573bd0(0xa9c)]));_0x582392(),_0x2f97b8(),await _0x1519c8(_0x573bd0(0xab6),_0x573bd0(0x13e8)+_0x1335e9+'\x20首无效歌曲:\x0a\x0a-\x20'+_0x39f5ef[_0x573bd0(0x35d)](_0x573bd0(0xfa6)));}else await _0x1519c8('检查完成',_0x573bd0(0x782));}function _0x2f6f58(){const _0x5cf625=_0x85c4bf,_0x5a8509=document[_0x5cf625(0x479)]('phone-screen');_0x5a8509[_0x5cf625(0x9cd)][_0x5cf625(0x2bf)]('status-bar-visible',!!_0x505390[_0x5cf625(0x888)][_0x5cf625(0x5d9)]);}async function _0x36e9ab(){const _0x1aacaf=_0x85c4bf,_0x28d9e2=document[_0x1aacaf(0x479)]('clear-posts-modal'),_0x1d42a3=document['getElementById'](_0x1aacaf(0xf56));_0x1d42a3['innerHTML']='';const _0xac2b7c=[];_0xac2b7c[_0x1aacaf(0x1a0)]({'text':'清空所有动态\x20(危险)','value':_0x1aacaf(0xf78),'isDanger':!![]});const _0x44f98e=_0x505390['qzoneSettings'][_0x1aacaf(0x904)]||'我';_0xac2b7c['push']({'text':'仅清空\x20'+_0x44f98e+_0x1aacaf(0x971),'value':'user'}),Object[_0x1aacaf(0x3d5)](_0x505390[_0x1aacaf(0x1027)])['forEach'](_0x1577e4=>{const _0x5908df=_0x1aacaf;!_0x1577e4[_0x5908df(0x9d7)]&&_0xac2b7c[_0x5908df(0x1a0)]({'text':_0x5908df(0xa9b)+_0x1577e4[_0x5908df(0x564)]+_0x5908df(0xe75),'value':_0x1577e4['id']});});try{const _0x89a3b8=await _0xb81d4e[_0x1aacaf(0x482)]['toArray']();_0x89a3b8[_0x1aacaf(0x990)]>0x0&&(_0xac2b7c[_0x1aacaf(0x1a0)]({'isSeparator':!![],'text':_0x1aacaf(0x19d)}),_0x89a3b8[_0x1aacaf(0x12be)](_0x16bf80=>{const _0x3b7938=_0x1aacaf;_0xac2b7c[_0x3b7938(0x1a0)]({'text':_0x3b7938(0xa9b)+_0x16bf80[_0x3b7938(0x564)]+_0x3b7938(0x68b),'value':_0x3b7938(0xca5)+_0x16bf80['id']});}));}catch(_0x50a4b3){console[_0x1aacaf(0xe3b)](_0x1aacaf(0xc24),_0x50a4b3);}_0xac2b7c['forEach'](_0x260ae3=>{const _0x3f6a41=_0x1aacaf;if(_0x260ae3['isSeparator']){const _0x4d9f25=document[_0x3f6a41(0xbd5)](_0x3f6a41(0x6c8));_0x4d9f25[_0x3f6a41(0x97b)]=_0x260ae3[_0x3f6a41(0x56d)],_0x4d9f25[_0x3f6a41(0x10dd)][_0x3f6a41(0x506)]=_0x3f6a41(0x4ca),_0x1d42a3[_0x3f6a41(0x9f4)](_0x4d9f25);return;}const _0x3f92db=document['createElement']('div');_0x3f92db[_0x3f6a41(0xfd4)]=_0x3f6a41(0x908),_0x260ae3[_0x3f6a41(0x92c)]&&_0x3f92db[_0x3f6a41(0x9cd)][_0x3f6a41(0x807)](_0x3f6a41(0x12af)),_0x3f92db[_0x3f6a41(0x13d4)][_0x3f6a41(0xb9a)]=_0x260ae3[_0x3f6a41(0x4e0)],_0x3f92db[_0x3f6a41(0x3de)]=_0x3f6a41(0xa73)+_0x260ae3[_0x3f6a41(0x56d)]+_0x3f6a41(0xa8b),_0x1d42a3[_0x3f6a41(0x9f4)](_0x3f92db);}),_0x28d9e2[_0x1aacaf(0x9cd)][_0x1aacaf(0x807)](_0x1aacaf(0x45a));}async function _0x190dc5(){const _0x2305f6=_0x85c4bf,_0x51afe5=document[_0x2305f6(0x99e)]('#clear-posts-list\x20.clear-posts-item.selected');if(_0x51afe5[_0x2305f6(0x990)]===0x0){alert('请至少选择一个要清空的范围。');return;}const _0x28aaf8=Array[_0x2305f6(0x22f)](_0x51afe5)[_0x2305f6(0x2e1)](_0x3d4cbc=>_0x3d4cbc[_0x2305f6(0x13d4)]['targetId']);let _0x103c09=[];_0x28aaf8[_0x2305f6(0x44f)](_0x2305f6(0xf78))?_0x103c09['push'](_0x2305f6(0x9fd)):(_0x28aaf8[_0x2305f6(0x44f)](_0x2305f6(0x4c5))&&_0x103c09[_0x2305f6(0x1a0)]('“'+_0x505390['qzoneSettings'][_0x2305f6(0x904)]+'”'),_0x28aaf8[_0x2305f6(0x12be)](_0x3d9154=>{const _0x49bb4a=_0x2305f6,_0x1e34a5=_0x505390[_0x49bb4a(0x1027)][_0x3d9154];_0x1e34a5&&_0x103c09[_0x49bb4a(0x1a0)]('“'+_0x1e34a5[_0x49bb4a(0x564)]+'”');}));const _0x4f76c9=_0x2305f6(0x9b8)+_0x103c09[_0x2305f6(0x35d)]('、\x20')+_0x2305f6(0x1219),_0x2e1462=await _0x1a9e79('确认清空动态？',_0x4f76c9,{'confirmButtonClass':'btn-danger','confirmText':_0x2305f6(0xe60)});if(!_0x2e1462)return;try{_0x28aaf8['includes'](_0x2305f6(0xf78))?await _0xb81d4e['qzonePosts']['clear']():await _0xb81d4e[_0x2305f6(0xcce)][_0x2305f6(0x46f)](_0x2305f6(0x981))[_0x2305f6(0x67d)](_0x28aaf8)['delete'](),_0x5a98bc=await _0xb81d4e[_0x2305f6(0xcce)]['orderBy']('timestamp')[_0x2305f6(0x336)]()[_0x2305f6(0x4ba)](),_0xf8ae5e=0x0,await _0x2eb20b(),document[_0x2305f6(0x479)](_0x2305f6(0x130b))['classList'][_0x2305f6(0x8b6)](_0x2305f6(0x45a)),await _0x1519c8(_0x2305f6(0xa56),_0x2305f6(0x264));}catch(_0x1a7ac6){console[_0x2305f6(0xe3b)](_0x2305f6(0x7a3),_0x1a7ac6),await _0x1519c8(_0x2305f6(0xaab),_0x2305f6(0x1092)+_0x1a7ac6['message']);}}async function _0x18df37(_0x409d07){const _0x36ee0c=_0x85c4bf,_0x4d651d=await _0x1a9e79(_0x36ee0c(0x587),'确定要永久删除这条心声记录吗？此操作不可恢复。',{'confirmButtonClass':_0x36ee0c(0x95a),'confirmText':_0x36ee0c(0x587)});if(_0x4d651d){const _0x5799c3=_0x505390[_0x36ee0c(0x1027)][_0x505390[_0x36ee0c(0x233)]];if(!_0x5799c3||!_0x5799c3[_0x36ee0c(0x57e)])return;const _0x5d24fc=_0x5799c3[_0x36ee0c(0x57e)]['findIndex'](_0x471ffd=>_0x471ffd[_0x36ee0c(0x12a2)]===_0x409d07);if(_0x5d24fc===-0x1)return;const _0x1e75fa=_0x5d24fc===_0x5799c3[_0x36ee0c(0x57e)][_0x36ee0c(0x990)]-0x1;_0x5799c3[_0x36ee0c(0x57e)]=_0x5799c3[_0x36ee0c(0x57e)]['filter'](_0x572385=>_0x572385[_0x36ee0c(0x12a2)]!==_0x409d07);if(_0x1e75fa){if(_0x5799c3[_0x36ee0c(0x57e)][_0x36ee0c(0x990)]>0x0){const _0x47c79a=_0x5799c3[_0x36ee0c(0x57e)][_0x5799c3[_0x36ee0c(0x57e)][_0x36ee0c(0x990)]-0x1];_0x5799c3[_0x36ee0c(0x25c)]=_0x47c79a[_0x36ee0c(0x25c)],_0x5799c3['randomJottings']=_0x47c79a[_0x36ee0c(0x2cf)];const _0x3dfa7f=document[_0x36ee0c(0x479)](_0x36ee0c(0x868)),_0x3e1943=document[_0x36ee0c(0x479)](_0x36ee0c(0x4aa));if(_0x3dfa7f)_0x3dfa7f[_0x36ee0c(0x97b)]=_0x5799c3[_0x36ee0c(0x25c)];if(_0x3e1943)_0x3e1943[_0x36ee0c(0x97b)]=_0x5799c3[_0x36ee0c(0x2cf)];console[_0x36ee0c(0x90f)](_0x36ee0c(0x679));}else{_0x5799c3[_0x36ee0c(0x25c)]='...',_0x5799c3[_0x36ee0c(0x2cf)]=_0x36ee0c(0x4d0);const _0x4e39f2=document['getElementById']('profile-heartfelt-voice'),_0x3b6842=document[_0x36ee0c(0x479)]('profile-random-jottings');if(_0x4e39f2)_0x4e39f2[_0x36ee0c(0x97b)]=_0x5799c3[_0x36ee0c(0x25c)];if(_0x3b6842)_0x3b6842[_0x36ee0c(0x97b)]=_0x5799c3['randomJottings'];console['log'](_0x36ee0c(0x103e));}}await _0xb81d4e[_0x36ee0c(0x1027)]['put'](_0x5799c3),_0x1a1740(),await _0x1519c8('成功',_0x36ee0c(0x7eb));}}document[_0x85c4bf(0x479)](_0x85c4bf(0x12c3))[_0x85c4bf(0xa75)](_0x85c4bf(0xd2f),_0x4bad61=>{const _0x2e67bf=_0x85c4bf,_0x53ea0b=_0x4bad61[_0x2e67bf(0xfa2)][_0x2e67bf(0x869)](_0x2e67bf(0x696));if(_0x53ea0b){const _0x3ba208=parseInt(_0x53ea0b[_0x2e67bf(0x13d4)][_0x2e67bf(0x12a2)]);!isNaN(_0x3ba208)&&_0x18df37(_0x3ba208);}});async function _0x5c85ec(){const _0x4711e9=_0x85c4bf,_0x22f305=document[_0x4711e9(0x479)](_0x4711e9(0xf17));_0x22f305[_0x4711e9(0x3de)]=_0x4711e9(0xeae);const _0x191425=await _0xb81d4e[_0x4711e9(0xfe7)]['where'](_0x4711e9(0x858))[_0x4711e9(0x4a2)]('global_css')['toArray']();_0x191425[_0x4711e9(0x12be)](_0x45fa06=>{const _0x4e7c7b=_0x4711e9,_0x5483ea=document[_0x4e7c7b(0xbd5)](_0x4e7c7b(0x9a2));_0x5483ea['value']=_0x45fa06['id'],_0x5483ea[_0x4e7c7b(0x97b)]=_0x45fa06[_0x4e7c7b(0x564)],_0x22f305[_0x4e7c7b(0x9f4)](_0x5483ea);});}async function _0x56ed69(){const _0x36f785=_0x85c4bf,_0x4ed6a7=document[_0x36f785(0x479)](_0x36f785(0xf17)),_0x823e73=parseInt(_0x4ed6a7[_0x36f785(0x4e0)]);if(isNaN(_0x823e73))return;const _0x5898d4=await _0xb81d4e[_0x36f785(0xfe7)][_0x36f785(0x111a)](_0x823e73);if(_0x5898d4){const _0x3c6a6c=document[_0x36f785(0x479)](_0x36f785(0x901));_0x3c6a6c['value']=_0x5898d4[_0x36f785(0x4e0)],_0x5cefa5(_0x5898d4[_0x36f785(0x4e0)]);}}async function _0x4e6cc7(){const _0x45e42a=_0x85c4bf,_0x3a48f4=await _0x9a2c09(_0x45e42a(0x12b3),_0x45e42a(0x103f));if(!_0x3a48f4||!_0x3a48f4['trim']())return;const _0x396087=document['getElementById'](_0x45e42a(0x901))[_0x45e42a(0x4e0)],_0x59e4a2=await _0xb81d4e[_0x45e42a(0xfe7)]['where']({'name':_0x3a48f4[_0x45e42a(0x9c1)](),'type':_0x45e42a(0x850)})[_0x45e42a(0x64e)]();if(_0x59e4a2){const _0x38bffd=await _0x1a9e79(_0x45e42a(0xfe1),_0x45e42a(0x11cd)+_0x3a48f4[_0x45e42a(0x9c1)]()+_0x45e42a(0x5fe),{'confirmButtonClass':'btn-danger'});if(!_0x38bffd)return;await _0xb81d4e['appearancePresets'][_0x45e42a(0xeb2)](_0x59e4a2['id'],{'value':_0x396087});}else await _0xb81d4e[_0x45e42a(0xfe7)][_0x45e42a(0x807)]({'name':_0x3a48f4[_0x45e42a(0x9c1)](),'type':_0x45e42a(0x850),'value':_0x396087});await _0x5c85ec(),alert(_0x45e42a(0x60e));}async function _0x5eab04(){const _0x5563fe=_0x85c4bf,_0x2ab4da=document[_0x5563fe(0x479)](_0x5563fe(0xf17)),_0xac2c7=parseInt(_0x2ab4da['value']);if(isNaN(_0xac2c7)){alert(_0x5563fe(0xc22));return;}const _0xd3fba2=await _0xb81d4e['appearancePresets']['get'](_0xac2c7);if(!_0xd3fba2)return;const _0x4dc756=await _0x1a9e79('删除预设',_0x5563fe(0x7aa)+_0xd3fba2['name']+'”\x20吗？',{'confirmButtonClass':'btn-danger'});_0x4dc756&&(await _0xb81d4e[_0x5563fe(0xfe7)]['delete'](_0xac2c7),await _0x5c85ec(),alert('预设已删除。'));}async function _0x9193e5(){const _0x39dcad=_0x85c4bf,_0x4f6b41=document[_0x39dcad(0x479)](_0x39dcad(0xa7f));_0x4f6b41[_0x39dcad(0x3de)]=_0x39dcad(0xeae);const _0x5e938f=await _0xb81d4e[_0x39dcad(0xfe7)][_0x39dcad(0x46f)]('type')[_0x39dcad(0x4a2)](_0x39dcad(0x9cf))[_0x39dcad(0x4ba)]();_0x5e938f['forEach'](_0x2d8280=>{const _0xaa4741=_0x39dcad,_0x339256=document[_0xaa4741(0xbd5)](_0xaa4741(0x9a2));_0x339256[_0xaa4741(0x4e0)]=_0x2d8280['id'],_0x339256[_0xaa4741(0x97b)]=_0x2d8280[_0xaa4741(0x564)],_0x4f6b41[_0xaa4741(0x9f4)](_0x339256);});}async function _0x3940d3(){const _0x350f39=_0x85c4bf,_0x49d6c7=document[_0x350f39(0x479)](_0x350f39(0xa7f)),_0x10e3c9=parseInt(_0x49d6c7[_0x350f39(0x4e0)]);if(isNaN(_0x10e3c9))return;const _0x40cb74=await _0xb81d4e[_0x350f39(0xfe7)][_0x350f39(0x111a)](_0x10e3c9);if(_0x40cb74){const _0x372ee0=document[_0x350f39(0x479)]('font-url-input');_0x372ee0[_0x350f39(0x4e0)]=_0x40cb74[_0x350f39(0x4e0)],_0x57f4d5(_0x40cb74[_0x350f39(0x4e0)],!![]);}}async function _0x52311d(){const _0x56581e=_0x85c4bf,_0x86b121=await _0x9a2c09(_0x56581e(0xac6),_0x56581e(0x103f));if(!_0x86b121||!_0x86b121[_0x56581e(0x9c1)]())return;const _0x31ee7c=document[_0x56581e(0x479)](_0x56581e(0x13e0))[_0x56581e(0x4e0)]['trim']();if(!_0x31ee7c){alert(_0x56581e(0x25a));return;}const _0x171289=await _0xb81d4e['appearancePresets'][_0x56581e(0x46f)]({'name':_0x86b121['trim'](),'type':_0x56581e(0x9cf)})[_0x56581e(0x64e)]();if(_0x171289){const _0x764fb3=await _0x1a9e79(_0x56581e(0xfe1),_0x56581e(0x11cd)+_0x86b121['trim']()+'”\x20的预设已存在。要覆盖它吗？',{'confirmButtonClass':_0x56581e(0x95a)});if(!_0x764fb3)return;await _0xb81d4e['appearancePresets'][_0x56581e(0xeb2)](_0x171289['id'],{'value':_0x31ee7c});}else await _0xb81d4e['appearancePresets'][_0x56581e(0x807)]({'name':_0x86b121['trim'](),'type':_0x56581e(0x9cf),'value':_0x31ee7c});await _0x9193e5(),alert('字体预设已保存！');}async function _0x3050f6(){const _0x575d44=_0x85c4bf,_0xad480b=document[_0x575d44(0x479)](_0x575d44(0xa7f)),_0x56dac2=parseInt(_0xad480b[_0x575d44(0x4e0)]);if(isNaN(_0x56dac2)){alert(_0x575d44(0xc22));return;}const _0x2e12b9=await _0xb81d4e[_0x575d44(0xfe7)][_0x575d44(0x111a)](_0x56dac2);if(!_0x2e12b9)return;const _0x4034dc=await _0x1a9e79(_0x575d44(0x1143),_0x575d44(0x7aa)+_0x2e12b9[_0x575d44(0x564)]+_0x575d44(0x7c7),{'confirmButtonClass':_0x575d44(0x95a)});_0x4034dc&&(await _0xb81d4e[_0x575d44(0xfe7)][_0x575d44(0x1ea)](_0x56dac2),await _0x9193e5(),alert(_0x575d44(0xddf)));}async function _0x6d1778(){const _0x191c03=_0x85c4bf,_0x5edbbf=document['getElementById'](_0x191c03(0x9c6));_0x5edbbf[_0x191c03(0x3de)]='<option\x20value=\x22\x22>--\x20选择一个预设\x20--</option>';const _0x268028=await _0xb81d4e['appearancePresets'][_0x191c03(0x46f)](_0x191c03(0x858))['equals'](_0x191c03(0x91f))[_0x191c03(0x4ba)]();_0x268028[_0x191c03(0x12be)](_0x5d3490=>{const _0x519e73=_0x191c03,_0x26f89d=document[_0x519e73(0xbd5)]('option');_0x26f89d['value']=_0x5d3490['id'],_0x26f89d[_0x519e73(0x97b)]=_0x5d3490[_0x519e73(0x564)],_0x5edbbf['appendChild'](_0x26f89d);});const _0x201cd8={'wallpaper':_0x505390[_0x191c03(0x888)][_0x191c03(0x73f)],'cphoneWallpaper':_0x505390[_0x191c03(0x888)][_0x191c03(0x77b)],'globalChatBackground':_0x505390[_0x191c03(0x888)][_0x191c03(0x960)],'appIcons':_0x505390[_0x191c03(0x888)][_0x191c03(0x12ca)],'cphoneAppIcons':_0x505390[_0x191c03(0x888)][_0x191c03(0x2f6)],'chatActionButtonsOrder':_0x505390['globalSettings'][_0x191c03(0x9a4)],'theme':localStorage[_0x191c03(0x28f)](_0x191c03(0xf49))||_0x191c03(0x5cc),'showStatusBar':_0x505390[_0x191c03(0x888)][_0x191c03(0x5d9)],'notificationSoundUrl':_0x505390[_0x191c03(0x888)][_0x191c03(0xb10)],'widgetData':_0x505390[_0x191c03(0x888)][_0x191c03(0xd79)]};let _0x29e5f2=null;for(const _0x3f66cb of _0x268028){if(JSON[_0x191c03(0x1308)](_0x3f66cb[_0x191c03(0x4e0)])===JSON[_0x191c03(0x1308)](_0x201cd8)){_0x29e5f2=_0x3f66cb['id'];break;}}_0x29e5f2?_0x5edbbf[_0x191c03(0x4e0)]=_0x29e5f2:_0x5edbbf[_0x191c03(0x4e0)]='';}async function _0xd3d814(){const _0x2f7cf4=_0x85c4bf,_0x50ed94=document[_0x2f7cf4(0x479)](_0x2f7cf4(0x9c6)),_0x13cdef=parseInt(_0x50ed94[_0x2f7cf4(0x4e0)]);if(isNaN(_0x13cdef))return;const _0x3437c5=await _0xb81d4e[_0x2f7cf4(0xfe7)][_0x2f7cf4(0x111a)](_0x13cdef);if(_0x3437c5&&_0x3437c5['value']){const _0x38033c=_0x3437c5[_0x2f7cf4(0x4e0)];Object['assign'](_0x505390[_0x2f7cf4(0x888)],_0x38033c),_0x3d7866(_0x38033c[_0x2f7cf4(0x1057)]||_0x2f7cf4(0x5cc)),await _0xb81d4e[_0x2f7cf4(0x888)][_0x2f7cf4(0x5d0)](_0x505390[_0x2f7cf4(0x888)]),_0x49ef38(),_0x355635(),_0x57595d(),_0x1711f7(),_0x2f6f58(),_0x31ff84(),_0x2884ff(),alert(_0x2f7cf4(0x71a)+_0x3437c5['name']+'”');}}async function _0x5e32b6(){const _0x5458f5=_0x85c4bf,_0x3ddd96=await _0x9a2c09(_0x5458f5(0x8e2),_0x5458f5(0x103f));if(!_0x3ddd96||!_0x3ddd96[_0x5458f5(0x9c1)]())return;const _0x2ab299={'wallpaper':_0x505390[_0x5458f5(0x888)][_0x5458f5(0x73f)],'cphoneWallpaper':_0x505390[_0x5458f5(0x888)][_0x5458f5(0x77b)],'globalChatBackground':_0x505390['globalSettings'][_0x5458f5(0x960)],'appIcons':_0x505390[_0x5458f5(0x888)]['appIcons'],'cphoneAppIcons':_0x505390[_0x5458f5(0x888)][_0x5458f5(0x2f6)],'chatActionButtonsOrder':_0x505390['globalSettings'][_0x5458f5(0x9a4)],'theme':localStorage[_0x5458f5(0x28f)](_0x5458f5(0xf49))||_0x5458f5(0x5cc),'showStatusBar':_0x505390[_0x5458f5(0x888)][_0x5458f5(0x5d9)],'notificationSoundUrl':_0x505390[_0x5458f5(0x888)][_0x5458f5(0xb10)],'widgetData':_0x505390['globalSettings'][_0x5458f5(0xd79)]},_0x1c261a=await _0xb81d4e[_0x5458f5(0xfe7)][_0x5458f5(0x46f)]({'name':_0x3ddd96[_0x5458f5(0x9c1)](),'type':'appearance'})[_0x5458f5(0x64e)]();if(_0x1c261a){const _0x356005=await _0x1a9e79('覆盖预设',_0x5458f5(0x11cd)+_0x3ddd96[_0x5458f5(0x9c1)]()+_0x5458f5(0x5fe),{'confirmButtonClass':_0x5458f5(0x95a)});if(!_0x356005)return;await _0xb81d4e[_0x5458f5(0xfe7)]['update'](_0x1c261a['id'],{'value':_0x2ab299});}else await _0xb81d4e[_0x5458f5(0xfe7)][_0x5458f5(0x807)]({'name':_0x3ddd96['trim'](),'type':_0x5458f5(0x91f),'value':_0x2ab299});await _0x6d1778(),alert(_0x5458f5(0x1019));}async function _0xb73418(){const _0xf0e726=_0x85c4bf,_0x1f377=document['getElementById']('appearance-preset-select'),_0x42ea32=parseInt(_0x1f377[_0xf0e726(0x4e0)]);if(isNaN(_0x42ea32)){alert(_0xf0e726(0xc22));return;}const _0x237306=await _0xb81d4e[_0xf0e726(0xfe7)]['get'](_0x42ea32);if(!_0x237306)return;const _0x10a392=await _0x1a9e79(_0xf0e726(0x1143),'确定要删除预设\x20“'+_0x237306[_0xf0e726(0x564)]+'”\x20吗？',{'confirmButtonClass':_0xf0e726(0x95a)});_0x10a392&&(await _0xb81d4e['appearancePresets'][_0xf0e726(0x1ea)](_0x42ea32),await _0x6d1778(),alert(_0xf0e726(0xddf)));}async function _0x60d931(){const _0x4fbc0f=_0x85c4bf,_0x2c76b2=document[_0x4fbc0f(0x479)](_0x4fbc0f(0xe5f));_0x2c76b2[_0x4fbc0f(0x3de)]=_0x4fbc0f(0xeae);const _0x6c1a5=await _0xb81d4e[_0x4fbc0f(0xfe7)]['where'](_0x4fbc0f(0x858))[_0x4fbc0f(0x4a2)](_0x4fbc0f(0x11cb))[_0x4fbc0f(0x4ba)]();_0x6c1a5['forEach'](_0x1e07a3=>{const _0x45fde0=_0x4fbc0f,_0x478f79=document[_0x45fde0(0xbd5)]('option');_0x478f79[_0x45fde0(0x4e0)]=_0x1e07a3['id'],_0x478f79[_0x45fde0(0x97b)]=_0x1e07a3[_0x45fde0(0x564)],_0x2c76b2['appendChild'](_0x478f79);});}async function _0x5067db(){const _0x4ea6d7=_0x85c4bf,_0x6bc113=document[_0x4ea6d7(0x479)](_0x4ea6d7(0xe5f)),_0x292bdf=parseInt(_0x6bc113[_0x4ea6d7(0x4e0)]);if(isNaN(_0x292bdf))return;const _0x4023a2=await _0xb81d4e[_0x4ea6d7(0xfe7)][_0x4ea6d7(0x111a)](_0x292bdf);if(_0x4023a2){const _0x3ca0fb=_0x4023a2[_0x4ea6d7(0x4e0)][_0x4ea6d7(0x6af)]||_0x4ea6d7(0x603),_0x2b0edd=_0x4023a2[_0x4ea6d7(0x4e0)]['custom']||'',_0x1816b6=document[_0x4ea6d7(0x8bc)]('input[name=\x22theme-select\x22][value=\x22'+_0x3ca0fb+'\x22]');_0x1816b6&&(_0x1816b6['checked']=!![]);const _0x419b1c=document[_0x4ea6d7(0x479)]('custom-css-input');_0x419b1c[_0x4ea6d7(0x4e0)]=_0x2b0edd,_0x11fab3();}}async function _0x25d1b3(){const _0x14839c=_0x85c4bf,_0x580b5d=await _0x9a2c09(_0x14839c(0x9d9),_0x14839c(0x103f));if(!_0x580b5d||!_0x580b5d[_0x14839c(0x9c1)]())return;const _0x1a552d=document[_0x14839c(0x8bc)]('input[name=\x22theme-select\x22]:checked'),_0x2644c9=_0x1a552d?_0x1a552d[_0x14839c(0x4e0)]:_0x14839c(0x603),_0x29c5ee=document[_0x14839c(0x479)](_0x14839c(0xbfb))[_0x14839c(0x4e0)][_0x14839c(0x9c1)](),_0x514884={'base':_0x2644c9,'custom':_0x29c5ee},_0x59ce35=await _0xb81d4e['appearancePresets'][_0x14839c(0x46f)]({'name':_0x580b5d[_0x14839c(0x9c1)](),'type':_0x14839c(0x11cb)})[_0x14839c(0x64e)]();if(_0x59ce35){const _0x4a8f30=await _0x1a9e79(_0x14839c(0xfe1),_0x14839c(0x11cd)+_0x580b5d['trim']()+_0x14839c(0x5fe),{'confirmButtonClass':_0x14839c(0x95a)});if(!_0x4a8f30)return;await _0xb81d4e[_0x14839c(0xfe7)][_0x14839c(0xeb2)](_0x59ce35['id'],{'value':_0x514884});}else await _0xb81d4e[_0x14839c(0xfe7)][_0x14839c(0x807)]({'name':_0x580b5d['trim'](),'type':'bubble_theme','value':_0x514884});await _0x60d931(),alert('主题预设已保存！');}async function _0x2a9b6a(){const _0x48fb21=_0x85c4bf,_0x2de399=document[_0x48fb21(0x479)](_0x48fb21(0xe5f)),_0x1b863a=parseInt(_0x2de399[_0x48fb21(0x4e0)]);if(isNaN(_0x1b863a)){alert(_0x48fb21(0xc22));return;}const _0x2669e8=await _0xb81d4e[_0x48fb21(0xfe7)][_0x48fb21(0x111a)](_0x1b863a);if(!_0x2669e8)return;const _0x107968=await _0x1a9e79(_0x48fb21(0x1143),_0x48fb21(0x7aa)+_0x2669e8['name']+'”\x20吗？',{'confirmButtonClass':'btn-danger'});_0x107968&&(await _0xb81d4e[_0x48fb21(0xfe7)]['delete'](_0x1b863a),await _0x60d931(),alert('预设已删除。'));}async function _0x191e83(){const _0x4b2448=_0x85c4bf;await _0x594468(),document[_0x4b2448(0x479)](_0x4b2448(0xe90))[_0x4b2448(0x9cd)][_0x4b2448(0x807)](_0x4b2448(0x45a));}async function _0x594468(){const _0x3eb95e=_0x85c4bf,_0x3f76d4=document[_0x3eb95e(0x479)](_0x3eb95e(0xbe4)),_0x5a55c3=await _0xb81d4e[_0x3eb95e(0x690)][_0x3eb95e(0x4ba)]();_0x3f76d4[_0x3eb95e(0x3de)]='';if(_0x5a55c3['length']===0x0){_0x3f76d4[_0x3eb95e(0x3de)]='<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>';return;}_0x5a55c3[_0x3eb95e(0x12be)](_0x1f252f=>{const _0x2b3690=_0x3eb95e,_0x4f11a6=document[_0x2b3690(0xbd5)]('div');_0x4f11a6[_0x2b3690(0xfd4)]=_0x2b3690(0x100f),_0x4f11a6[_0x2b3690(0x3de)]=_0x2b3690(0xbba)+_0x1f252f[_0x2b3690(0x564)]+_0x2b3690(0xb26)+_0x1f252f['id']+_0x2b3690(0x13d2),_0x3f76d4[_0x2b3690(0x9f4)](_0x4f11a6);});}async function _0x6bacea(){const _0x435009=_0x85c4bf,_0x11b865=document[_0x435009(0x479)](_0x435009(0x218)),_0x4413dc=_0x11b865[_0x435009(0x4e0)]['trim']();if(!_0x4413dc){alert(_0x435009(0x446));return;}const _0x422673=await _0xb81d4e[_0x435009(0x690)][_0x435009(0x46f)](_0x435009(0x564))[_0x435009(0x4a2)](_0x4413dc)[_0x435009(0x64e)]();if(_0x422673){alert(_0x435009(0x652)+_0x4413dc+_0x435009(0x12d5));return;}await _0xb81d4e['stickerCategories'][_0x435009(0x807)]({'name':_0x4413dc}),_0x11b865['value']='',await _0x594468();}async function _0x2566c6(_0x404d8f){const _0x1dabd4=_0x85c4bf,_0x292c16=await _0xb81d4e[_0x1dabd4(0x690)][_0x1dabd4(0x111a)](_0x404d8f);if(!_0x292c16)return;const _0x4fa435=await _0xb81d4e[_0x1dabd4(0x407)][_0x1dabd4(0x46f)](_0x1dabd4(0x470))[_0x1dabd4(0x4a2)](_0x404d8f)[_0x1dabd4(0x32f)](),_0x228800=_0x4fa435>0x0?'确定要删除分类《'+_0x292c16[_0x1dabd4(0x564)]+_0x1dabd4(0xe14)+_0x4fa435+'\x20个表情包，且无法恢复！':_0x1dabd4(0xf93)+_0x292c16[_0x1dabd4(0x564)]+'》吗？',_0x2e16f8=await _0x1a9e79(_0x1dabd4(0x11f9),_0x228800,{'confirmButtonClass':_0x1dabd4(0x95a)});if(_0x2e16f8)try{await _0xb81d4e[_0x1dabd4(0x4b9)]('rw',_0xb81d4e[_0x1dabd4(0x690)],_0xb81d4e['userStickers'],async()=>{const _0x93bfa0=_0x1dabd4,_0x16ffef=await _0xb81d4e[_0x93bfa0(0x407)][_0x93bfa0(0x46f)](_0x93bfa0(0x470))['equals'](_0x404d8f)[_0x93bfa0(0x116c)]();_0x16ffef[_0x93bfa0(0x990)]>0x0&&await _0xb81d4e[_0x93bfa0(0x407)][_0x93bfa0(0x12f5)](_0x16ffef),await _0xb81d4e[_0x93bfa0(0x690)][_0x93bfa0(0x1ea)](_0x404d8f);}),_0x505390[_0x1dabd4(0x407)]=await _0xb81d4e['userStickers'][_0x1dabd4(0x4ba)](),_0x2a104d===_0x404d8f&&(_0x2a104d='all'),await _0x594468(),await _0x46e430(),alert(_0x1dabd4(0x344)+_0x292c16[_0x1dabd4(0x564)]+_0x1dabd4(0x8e6));}catch(_0x57a480){console[_0x1dabd4(0xe3b)](_0x1dabd4(0x5e0),_0x57a480),alert(_0x1dabd4(0xffd));}}function _0x27fdb3(_0xd5a5fc){const _0x4374cd=_0x85c4bf;_0x2a104d=_0xd5a5fc,document['querySelectorAll']('.sticker-category-tab')[_0x4374cd(0x12be)](_0x4eb0bc=>{const _0x41ceea=_0x4374cd;_0x4eb0bc[_0x41ceea(0x9cd)][_0x41ceea(0x2bf)](_0x41ceea(0x5a9),String(_0x4eb0bc[_0x41ceea(0x13d4)][_0x41ceea(0x470)])===String(_0xd5a5fc));}),_0x46e430(![]);const _0x15dfeb=document['getElementById'](_0x4374cd(0x457));if(_0x15dfeb)_0x15dfeb[_0x4374cd(0xf7b)]=![];}async function _0x36b53e(){const _0x3cbe33=_0x85c4bf;if(!_0x505390['activeChatId'])return;const _0x1e07be=_0x505390['chats'][_0x505390['activeChatId']];if(!_0x1e07be)return;try{const _0x114229={'type':_0x3cbe33(0xb60),'version':0x1,'chatData':_0x1e07be},_0xb62690=new Blob([JSON['stringify'](_0x114229,null,0x2)],{'type':_0x3cbe33(0xcb5)}),_0x2971c0=URL['createObjectURL'](_0xb62690),_0x2facce=document[_0x3cbe33(0xbd5)]('a');_0x2facce[_0x3cbe33(0x2fa)]=_0x2971c0,_0x2facce['download']=_0x3cbe33(0x1058)+_0x1e07be[_0x3cbe33(0x564)]+'-'+new Date()[_0x3cbe33(0xaf9)]()[_0x3cbe33(0x53e)]('T')[0x0]+_0x3cbe33(0x1a6),_0x2facce[_0x3cbe33(0xd2f)](),URL[_0x3cbe33(0xed5)](_0x2971c0),await _0x1519c8(_0x3cbe33(0x553),'与“'+_0x1e07be[_0x3cbe33(0x564)]+_0x3cbe33(0x841));}catch(_0x5607fa){console[_0x3cbe33(0xe3b)]('导出单个聊天时出错:',_0x5607fa),await _0x1519c8(_0x3cbe33(0xa3d),_0x3cbe33(0xe49)+_0x5607fa[_0x3cbe33(0x757)]);}}async function _0x23c74a(_0x11cb43){const _0x190fc1=_0x85c4bf;if(!_0x11cb43||!_0x505390['activeChatId'])return;const _0x3d7d6b=_0x505390[_0x190fc1(0x233)],_0x48f551=_0x505390[_0x190fc1(0x1027)][_0x3d7d6b];try{const _0x24c90e=await _0x11cb43[_0x190fc1(0x56d)](),_0x1b02ed=JSON[_0x190fc1(0x94c)](_0x24c90e);if(_0x1b02ed['type']!==_0x190fc1(0xb60)||!_0x1b02ed['chatData'])throw new Error('文件格式不正确，这不是一个有效的单聊备份文件。');const _0x153347=await _0x1a9e79('严重警告！',_0x190fc1(0x906)+_0x48f551[_0x190fc1(0x564)]+_0x190fc1(0x975),{'confirmButtonClass':_0x190fc1(0x95a),'confirmText':_0x190fc1(0x102d)});if(!_0x153347)return;const _0x56183d=_0x1b02ed['chatData'];_0x56183d['id']=_0x3d7d6b,await _0xb81d4e['chats']['put'](_0x56183d),_0x505390[_0x190fc1(0x1027)][_0x3d7d6b]=_0x56183d,await _0x1519c8('导入成功','聊天记录已成功覆盖！正在刷新界面...'),_0x474d6b(_0x3d7d6b),_0x1b7f69(),document[_0x190fc1(0x479)](_0x190fc1(0x2a4))[_0x190fc1(0xd2f)]();}catch(_0x57f858){console['error'](_0x190fc1(0x8ed),_0x57f858),await _0x1519c8(_0x190fc1(0xf28),_0x190fc1(0x894)+_0x57f858[_0x190fc1(0x757)]);}}function _0x2162bb(){const _0xb1f6cc=_0x85c4bf;_0x2437e4(),_0x731d5(_0xb1f6cc(0x39f));}function _0x2437e4(){const _0x5c09a6=_0x85c4bf,_0x22dd22=document[_0x5c09a6(0x479)](_0x5c09a6(0x23c));_0x22dd22[_0x5c09a6(0x3de)]='';const _0x1dab41=Object['values'](_0x505390[_0x5c09a6(0x1027)])[_0x5c09a6(0x85d)](_0x2e22f3=>!_0x2e22f3[_0x5c09a6(0x9d7)]);if(_0x1dab41['length']===0x0){_0x22dd22[_0x5c09a6(0x3de)]=_0x5c09a6(0x1bc);return;}_0x1dab41[_0x5c09a6(0x12be)](_0x180b07=>{const _0x428d01=_0x5c09a6,_0x2feeff=document[_0x428d01(0xbd5)](_0x428d01(0x6c8));_0x2feeff[_0x428d01(0xfd4)]=_0x428d01(0xea8),_0x2feeff[_0x428d01(0x3de)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x180b07['settings']['aiAvatar']||_0x28c106)+_0x428d01(0xbd8)+_0x180b07['name']+_0x428d01(0xa8b),_0x2feeff['addEventListener']('click',()=>_0x32b9cb(_0x180b07['id'])),_0x22dd22['appendChild'](_0x2feeff);});}async function _0x32b9cb(_0x1a91b1){const _0x18fc0f=_0x85c4bf;_0x509091=_0x1a91b1,console[_0x18fc0f(0x90f)](_0x18fc0f(0x8f3)+_0x1a91b1+_0x18fc0f(0xf7d)),_0x355635(),_0x1711f7(),_0x14e98e(),_0x731d5(_0x18fc0f(0x13b2));}function _0x36a900(){const _0xee2582=_0x85c4bf;_0x509091=null,console[_0xee2582(0x90f)]('已返回我的手机'),_0x731d5(_0xee2582(0x45f));}function _0x14e98e(){const _0xce31ce=_0x85c4bf,_0x5beedf=new Date(),_0x64fc72=_0x5beedf[_0xce31ce(0xd96)](_0xce31ce(0xdc2),{'hour':'2-digit','minute':_0xce31ce(0xcde)}),_0x1c9a92=_0x5beedf[_0xce31ce(0xba5)]('zh-CN',{'weekday':_0xce31ce(0x1232),'month':_0xce31ce(0x1232),'day':_0xce31ce(0x1191)});document['getElementById'](_0xce31ce(0xe55))[_0xce31ce(0x97b)]=_0x64fc72,document[_0xce31ce(0x479)](_0xce31ce(0x1246))[_0xce31ce(0x97b)]=_0x1c9a92,_0x1c532a(_0xce31ce(0xa9d));}function _0x1c532a(_0x1b32ae){const _0x35c410=_0x85c4bf;document[_0x35c410(0x99e)](_0x35c410(0x114b))[_0x35c410(0x12be)](_0x244249=>_0x244249[_0x35c410(0x9cd)][_0x35c410(0x8b6)](_0x35c410(0x5a9))),document[_0x35c410(0x479)](_0x1b32ae)['classList'][_0x35c410(0x807)]('active');}window[_0x85c4bf(0xbc6)]=_0x1c532a;async function _0x414946(_0x498926){const _0x2abba8=_0x85c4bf;if(!_0x509091)return;const _0x4a8b22=_0x505390[_0x2abba8(0x1027)][_0x509091];await _0x3c9a0a(_0x509091,_0x498926);switch(_0x498926){case'qq':_0x699e6f(),_0x1c532a(_0x2abba8(0x288));break;case _0x2abba8(0x65e):_0x1af5d9(),_0x1c532a(_0x2abba8(0x124b));break;case _0x2abba8(0xd41):_0x5df82d(),_0x1c532a(_0x2abba8(0x122e));break;case _0x2abba8(0x112a):_0x29fa6a(),_0x1c532a('char-taobao-screen');break;case _0x2abba8(0xf94):_0x38c237(),_0x1c532a(_0x2abba8(0x9d2));break;case _0x2abba8(0xf14):_0xfe5f91(),_0x1c532a('char-diary-screen');break;case'amap':_0x323093(),_0x1c532a('char-amap-screen');break;case _0x2abba8(0xc4c):_0x145ab7(),_0x1c532a(_0x2abba8(0xa92));break;case _0x2abba8(0xeff):_0x50569b(),_0x1c532a(_0x2abba8(0x3c7));break;}}async function _0x1af5d9(){const _0x42c0c6=_0x85c4bf,_0x3dea49=document['getElementById']('char-album-grid');_0x3dea49[_0x42c0c6(0x3de)]='';if(!_0x509091)return;const _0x310149=_0x505390['chats'][_0x509091],_0x2b0784=_0x310149[_0x42c0c6(0xd9a)]||[];if(_0x2b0784[_0x42c0c6(0x990)]===0x0){_0x3dea49[_0x42c0c6(0x3de)]=_0x42c0c6(0x935);return;}const _0x25f723=_0x42c0c6(0x775);_0x2b0784['forEach'](_0x4eaf44=>{const _0x10f350=_0x42c0c6,_0x121c7e=document[_0x10f350(0xbd5)]('div');_0x121c7e[_0x10f350(0xfd4)]=_0x10f350(0x666),_0x121c7e[_0x10f350(0x13d4)][_0x10f350(0x78b)]=_0x4eaf44[_0x10f350(0x78b)],_0x3dea49[_0x10f350(0x9f4)](_0x121c7e);if(_0x505390[_0x10f350(0x888)][_0x10f350(0x105c)]){_0x121c7e['style'][_0x10f350(0x11a6)]='#e9ecef';const _0x19c1bf=/[^\x00-\x7F]/['test'](_0x4eaf44[_0x10f350(0xfb2)]),_0x523860=_0x4eaf44[_0x10f350(0xfb2)]&&_0x4eaf44[_0x10f350(0xfb2)]['trim']()&&!_0x19c1bf,_0x19da49=_0x523860?_0x4eaf44[_0x10f350(0xfb2)]:_0x10f350(0xc0b),_0x54ac9f=_0x10f350(0x730)+encodeURIComponent(_0x19da49),_0x4c4378=new Image();_0x4c4378[_0x10f350(0x502)]=function(){const _0x1b1031=_0x10f350;_0x121c7e[_0x1b1031(0x10dd)][_0x1b1031(0x13b9)]=_0x1b1031(0x10d2)+this[_0x1b1031(0xa9c)]+')';},_0x4c4378[_0x10f350(0x1337)]=function(){const _0xaa4381=_0x10f350;_0x121c7e[_0xaa4381(0x10dd)][_0xaa4381(0x13b9)]='url('+_0x25f723+')';},_0x4c4378[_0x10f350(0xa9c)]=_0x54ac9f;}else{_0x121c7e[_0x10f350(0x10dd)][_0x10f350(0x11a6)]=_0x10f350(0x1389),_0x121c7e['style']['border']=_0x10f350(0x516);const _0x1a0511=document[_0x10f350(0xbd5)]('p');_0x1a0511['className']=_0x10f350(0x923),_0x1a0511[_0x10f350(0x97b)]=_0x4eaf44[_0x10f350(0x78b)]||'(这张照片没有描述)',_0x121c7e[_0x10f350(0x9f4)](_0x1a0511);}});}function _0x5df82d(){const _0x3b2173=_0x85c4bf,_0x4b4a77=document[_0x3b2173(0x479)]('char-browser-history');_0x4b4a77['innerHTML']='';if(!_0x509091)return;const _0x2bae0a=_0x505390[_0x3b2173(0x1027)][_0x509091],_0x5770b7=[_0x2bae0a[_0x3b2173(0x564)],'爱好','旅游','美食','新闻',..._0x2bae0a[_0x3b2173(0x18a)][_0x3b2173(0x11f6)][_0x3b2173(0x53e)](/，|。|\s/)[_0x3b2173(0x777)](0x0,0x5)],_0x3a282b=['知乎',_0x3b2173(0xecd),_0x3b2173(0x671),'微博',_0x3b2173(0x127e)];for(let _0x3a9e81=0x0;_0x3a9e81<0xf;_0x3a9e81++){const _0x3c7cc9=_0x5770b7[Math['floor'](Math[_0x3b2173(0x103a)]()*_0x5770b7[_0x3b2173(0x990)])],_0x5b639d=_0x3a282b[Math[_0x3b2173(0xd71)](Math[_0x3b2173(0x103a)]()*_0x3a282b[_0x3b2173(0x990)])],_0x176431=document[_0x3b2173(0xbd5)](_0x3b2173(0x6c8));_0x176431[_0x3b2173(0xfd4)]=_0x3b2173(0xdca),_0x176431[_0x3b2173(0x3de)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>'+_0x3c7cc9+_0x3b2173(0x501)+_0x5b639d+_0x3b2173(0x496)+_0x5b639d[_0x3b2173(0x1f8)]()+'.com/'+_0x3c7cc9+_0x3b2173(0xeaa),_0x4b4a77[_0x3b2173(0x9f4)](_0x176431);}}function _0x29fa6a(){const _0x1677d5=_0x85c4bf,_0x25b125=document[_0x1677d5(0x479)]('char-product-grid');_0x25b125[_0x1677d5(0x3de)]='';if(!_0x509091)return;const _0x5d29d1=_0x505390[_0x1677d5(0x1027)][_0x509091],_0x223894=_0x5d29d1[_0x1677d5(0x442)]?.[_0x1677d5(0x113b)]||[];if(_0x223894[_0x1677d5(0x990)]===0x0){_0x25b125[_0x1677d5(0x3de)]=_0x1677d5(0xdd2);return;}_0x223894[_0x1677d5(0x12be)](_0x4af533=>{const _0x2f0648=_0x1677d5,_0x3c06cd=document[_0x2f0648(0xbd5)](_0x2f0648(0x6c8));_0x3c06cd['className']=_0x2f0648(0xe32),_0x3c06cd[_0x2f0648(0x13d4)][_0x2f0648(0xaac)]=_0x4af533[_0x2f0648(0xaac)];let _0x1413b4;if(_0x505390[_0x2f0648(0x888)][_0x2f0648(0x105c)]){const _0x4c217b=_0x2f0648(0x730)+encodeURIComponent(_0x4af533[_0x2f0648(0xfb2)]||_0x2f0648(0x13e1));_0x1413b4=_0x2f0648(0xdba)+_0x4c217b+_0x2f0648(0x119d);}else _0x1413b4=_0x2f0648(0xa1d)+(_0x4af533[_0x2f0648(0xaac)]||_0x2f0648(0xc04))+_0x2f0648(0x329);_0x3c06cd[_0x2f0648(0x3de)]=_0x2f0648(0x12cf)+_0x1413b4+_0x2f0648(0x12c6)+_0x4af533[_0x2f0648(0x251)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20margin-top:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>'+(_0x4af533[_0x2f0648(0x9ce)]||0x0)[_0x2f0648(0x6e1)](0x2)+_0x2f0648(0xd6e)+_0x4af533['status']+_0x2f0648(0xde3),_0x25b125[_0x2f0648(0x9f4)](_0x3c06cd);});}function _0x1ac68b(){const _0x17a547=_0x85c4bf;_0x1c532a(_0x17a547(0xa9d));}function _0xe496f6(){const _0x4d5c2a=_0x85c4bf,_0x40b20c=document[_0x4d5c2a(0x479)](_0x4d5c2a(0xf73));_0x40b20c[_0x4d5c2a(0x3de)]='';if(!_0x509091)return;const _0x468ee5=Object['values'](_0x505390[_0x4d5c2a(0x1027)])[_0x4d5c2a(0x85d)](_0x367797=>{const _0x1206eb=_0x4d5c2a;if(_0x367797['id']===_0x509091)return!![];if(_0x367797[_0x1206eb(0x9d7)]&&_0x367797[_0x1206eb(0x954)][_0x1206eb(0x1235)](_0x18174b=>_0x18174b['id']===_0x509091))return!![];return![];});_0x468ee5[_0x4d5c2a(0x12be)](_0x9ca8da=>{const _0x37fb04=_0x4d5c2a,_0x439f1e=_0x373be8(_0x9ca8da);_0x40b20c[_0x37fb04(0x9f4)](_0x439f1e);});}async function _0x3c9a0a(_0x588532,_0x5a0f26){const _0x5da90c=_0x85c4bf,_0x4afff9=_0x505390['chats'][_0x588532];if(!_0x4afff9)return;!_0x4afff9[_0x5da90c(0x12ef)]&&(_0x4afff9[_0x5da90c(0x12ef)]=[]),_0x4afff9[_0x5da90c(0x12ef)][_0x5da90c(0x1a0)]({'appName':_0x5a0f26,'timestamp':Date[_0x5da90c(0x12d6)]()}),_0x4afff9['appUsageLog']['length']>0x32&&_0x4afff9[_0x5da90c(0x12ef)][_0x5da90c(0x13dd)](),await _0xb81d4e[_0x5da90c(0x1027)]['put'](_0x4afff9);}function _0x50569b(){const _0x59a855=_0x85c4bf,_0x52fee6=document[_0x59a855(0x479)]('char-usage-list');_0x52fee6[_0x59a855(0x3de)]='';const _0x826f8f=_0x505390[_0x59a855(0x1027)][_0x509091],_0x1a81db=(_0x826f8f[_0x59a855(0x12ef)]||[])[_0x59a855(0x777)]()['reverse']();if(_0x1a81db[_0x59a855(0x990)]===0x0){_0x52fee6['innerHTML']=_0x59a855(0xe99);return;}const _0x17ebc8={'qq':'QQ','album':'相册','browser':'浏览器','taobao':'淘宝','memo':'备忘录','diary':'日记','amap':_0x59a855(0x9d3),'usage':_0x59a855(0xa31)};_0x1a81db[_0x59a855(0x12be)](_0x3f3d7e=>{const _0x21d6c5=_0x59a855,_0x540afc=document['createElement'](_0x21d6c5(0x6c8));_0x540afc[_0x21d6c5(0xfd4)]=_0x21d6c5(0x13dc),_0x540afc[_0x21d6c5(0x3de)]=_0x21d6c5(0x1266)+new Date(_0x3f3d7e[_0x21d6c5(0x12a2)])[_0x21d6c5(0x119c)]()+_0x21d6c5(0xcfd)+(_0x17ebc8[_0x3f3d7e['appName']]||_0x3f3d7e['appName'])+_0x21d6c5(0x11c2),_0x52fee6['appendChild'](_0x540afc);});}async function _0x27f658(_0x498447){const _0x542057=_0x85c4bf,_0x432453=_0x505390[_0x542057(0x1027)][_0x509091];if(!_0x432453)return;const _0x14ca3e={'role':'assistant','senderName':_0x432453[_0x542057(0xe2d)],'type':_0x542057(0xeef),'content':_0x498447,'imageUrl':_0x542057(0xfed),'timestamp':Date[_0x542057(0x12d6)]()};_0x432453[_0x542057(0x7d3)]['push'](_0x14ca3e),await _0xb81d4e['chats'][_0x542057(0x5d0)](_0x432453),_0x505390['activeChatId']===_0x509091&&_0x48f5ff(_0x14ca3e,_0x432453),await _0x1519c8('分享成功','“'+_0x432453[_0x542057(0x564)]+_0x542057(0x6bc));}async function _0x5b4f0e(_0x5cc7ed){const _0x477ed5=_0x85c4bf,_0x418cb7=_0x505390[_0x477ed5(0x1027)][_0x509091];if(!_0x418cb7||!_0x418cb7['memos'])return;const _0x759366=_0x418cb7[_0x477ed5(0x1325)][_0x477ed5(0xc0d)](_0x465df6=>_0x465df6['id']===_0x5cc7ed);if(_0x759366){_0x3057fc=_0x759366;const _0x1aac50=document[_0x477ed5(0x479)](_0x477ed5(0x330)),_0x23f770=document[_0x477ed5(0x479)](_0x477ed5(0xc85)),_0x27cb0a=document['getElementById'](_0x477ed5(0xc1b));if(_0x1aac50)_0x1aac50[_0x477ed5(0x97b)]=_0x759366[_0x477ed5(0xc29)];if(_0x23f770)_0x23f770[_0x477ed5(0x4e0)]=_0x759366[_0x477ed5(0xac4)];const _0x21dc94=await _0xb81d4e[_0x477ed5(0x3e8)][_0x477ed5(0x46f)]({'type':_0x477ed5(0x96c),'content.id':_0x5cc7ed})[_0x477ed5(0x64e)]();_0x27cb0a['classList'][_0x477ed5(0x2bf)](_0x477ed5(0x5a9),!!_0x21dc94),_0x1c532a('char-memo-detail-screen');}}function _0x38c237(){const _0x3500c3=_0x85c4bf,_0x5d39df=document['getElementById'](_0x3500c3(0x130e));_0x5d39df[_0x3500c3(0x3de)]='';const _0x56c0a9=_0x505390['chats'][_0x509091],_0x55b2ff=(_0x56c0a9[_0x3500c3(0x1325)]||[])[_0x3500c3(0x777)]()['reverse']();if(_0x55b2ff[_0x3500c3(0x990)]===0x0){_0x5d39df[_0x3500c3(0x3de)]=_0x3500c3(0x5b2);return;}_0x55b2ff['forEach'](_0x1d0c01=>{const _0x880163=_0x3500c3,_0x3be2e2=document[_0x880163(0xbd5)](_0x880163(0x6c8));_0x3be2e2[_0x880163(0xfd4)]=_0x880163(0x1268),_0x3be2e2[_0x880163(0x3de)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>'+_0x1d0c01[_0x880163(0xc29)]+_0x880163(0x90c)+(_0x1d0c01[_0x880163(0xac4)]||'')['split']('\x0a')[0x0]+_0x880163(0xeaa),_0x3be2e2[_0x880163(0xa75)](_0x880163(0xd2f),()=>_0x5b4f0e(_0x1d0c01['id'])),_0x33282f(_0x3be2e2,()=>deleteMemo(_0x1d0c01['id'])),_0x5d39df[_0x880163(0x9f4)](_0x3be2e2);});}async function _0x85698d(_0x4e3582=null){const _0x4df1d7=_0x85c4bf;_0x1c2d6e=null;const _0x5becbf=await _0x9a2c09(_0x4df1d7(0x668),_0x4df1d7(0xeb8));if(_0x5becbf===null||!_0x5becbf[_0x4df1d7(0x9c1)]())return;const _0x4ad4d5=await _0x9a2c09(_0x4df1d7(0x1302)+_0x5becbf,_0x4df1d7(0x41d),'',_0x4df1d7(0x1283));_0x4ad4d5!==null&&(await _0x12702a({'title':_0x5becbf[_0x4df1d7(0x9c1)](),'content':_0x4ad4d5}),_0x1c532a(_0x4df1d7(0x9d2)));}async function _0x12702a(_0x313a71){const _0x45bc2d=_0x85c4bf,_0x32591f=_0x505390[_0x45bc2d(0x1027)][_0x509091];if(!_0x32591f[_0x45bc2d(0x1325)])_0x32591f[_0x45bc2d(0x1325)]=[];_0x32591f[_0x45bc2d(0x1325)][_0x45bc2d(0x1a0)]({'id':Date['now'](),'title':_0x313a71['title'],'content':_0x313a71['content']}),await _0xb81d4e[_0x45bc2d(0x1027)]['put'](_0x32591f),_0x38c237();}async function _0x12702a(_0x3da6f6){const _0x3a98d7=_0x85c4bf,_0x5130f3=_0x505390[_0x3a98d7(0x1027)][_0x509091];if(!_0x5130f3[_0x3a98d7(0x1325)])_0x5130f3[_0x3a98d7(0x1325)]=[];if(_0x1c2d6e){const _0x313e9a=_0x5130f3[_0x3a98d7(0x1325)][_0x3a98d7(0xc0d)](_0x2e57c1=>_0x2e57c1['id']===_0x1c2d6e);if(_0x313e9a)_0x313e9a[_0x3a98d7(0xac4)]=_0x3da6f6;}else _0x5130f3[_0x3a98d7(0x1325)][_0x3a98d7(0x1a0)]({'id':Date[_0x3a98d7(0x12d6)](),'content':_0x3da6f6});await _0xb81d4e[_0x3a98d7(0x1027)][_0x3a98d7(0x5d0)](_0x5130f3),_0x38c237(),_0x1c2d6e=null;}async function _0x3969ed(){const _0x35c4b1=_0x85c4bf;if(!_0x509091)return;const _0xe9dd67=_0x505390[_0x35c4b1(0x1027)][_0x509091];if(!_0xe9dd67)return;await _0x1519c8('请稍候...',_0x35c4b1(0xb29)+_0xe9dd67['name']+_0x35c4b1(0x4a8));const {proxyUrl:_0x60cd80,apiKey:_0x1bc4fc,model:_0xcd21c7}=_0x505390[_0x35c4b1(0x30c)];if(!_0x60cd80||!_0x1bc4fc||!_0xcd21c7){alert(_0x35c4b1(0x9f1));return;}const _0x1e9df5=_0x505390[_0x35c4b1(0x1190)][_0x35c4b1(0x904)]===_0x35c4b1(0x80e)||!_0x505390['qzoneSettings']['nickname']?'用户':_0x505390[_0x35c4b1(0x1190)][_0x35c4b1(0x904)],_0x5995ec=_0xe9dd67[_0x35c4b1(0x3b4)]&&_0xe9dd67[_0x35c4b1(0x3b4)][_0x35c4b1(0x990)]>0x0?_0xe9dd67[_0x35c4b1(0x3b4)][_0x35c4b1(0x2e1)](_0x5779bf=>_0x35c4b1(0x619)+_0x3e14b1(_0x5779bf['timestamp'])+')\x20'+_0x5779bf[_0x35c4b1(0xac4)])[_0x35c4b1(0x35d)]('\x0a'):'无',_0x29002f=_0xe9dd67[_0x35c4b1(0x18a)]['maxMemory']||0xa,_0x5b4176=_0xe9dd67[_0x35c4b1(0x7d3)]['slice'](-_0x29002f)[_0x35c4b1(0x2e1)](_0x5a3af3=>(_0x5a3af3[_0x35c4b1(0x508)]==='user'?_0x1e9df5:_0xe9dd67[_0x35c4b1(0x564)])+':\x20'+String(_0x5a3af3[_0x35c4b1(0xac4)])[_0x35c4b1(0x1323)](0x0,0x1e)+_0x35c4b1(0x4d0))['join']('\x0a'),_0x40e3cc=(_0xe9dd67[_0x35c4b1(0x18a)][_0x35c4b1(0x13da)]||[])[_0x35c4b1(0x2e1)](_0x407e0b=>_0x505390[_0x35c4b1(0xd1b)]['find'](_0x3eba49=>_0x3eba49['id']===_0x407e0b))['filter'](Boolean)[_0x35c4b1(0x2e1)](_0x4c9ea8=>'\x0a##\x20世界书《'+_0x4c9ea8[_0x35c4b1(0x564)]+_0x35c4b1(0x8b4)+_0x4c9ea8['content'][_0x35c4b1(0x85d)](_0x37a729=>_0x37a729[_0x35c4b1(0x2b7)])['map'](_0x5dea71=>'-\x20'+_0x5dea71[_0x35c4b1(0xac4)])[_0x35c4b1(0x35d)]('\x0a'))[_0x35c4b1(0x35d)](''),_0x289750=_0x37bdc8(_0xe9dd67,0x3,_0x35c4b1(0x129d)),_0x539945=_0x37bdc8(_0xe9dd67,0x6,_0x35c4b1(0x129d)),_0x2515b8=_0x37bdc8(_0xe9dd67,0x9,_0x35c4b1(0x129d)),_0x20e315=_0x37bdc8(_0xe9dd67,0x1,_0x35c4b1(0x111c)),_0x4ed610=_0x37bdc8(_0xe9dd67,0x3,'days'),_0x3d71ed=_0x37bdc8(_0xe9dd67,0x7,_0x35c4b1(0x111c));let _0x50be45='';if(_0x289750||_0x539945||_0x2515b8||_0x20e315||_0x4ed610||_0x3d71ed){_0x50be45+=_0x35c4b1(0x670);if(_0x289750)_0x50be45+=_0x289750;if(_0x539945)_0x50be45+=_0x539945;if(_0x2515b8)_0x50be45+=_0x2515b8;if(_0x289750||_0x539945||_0x2515b8)_0x50be45+='\x0a';if(_0x20e315)_0x50be45+=_0x20e315;if(_0x4ed610)_0x50be45+=_0x4ed610;if(_0x3d71ed)_0x50be45+=_0x3d71ed;}const _0x3de449=_0x35c4b1(0x2a2)+_0xe9dd67[_0x35c4b1(0x564)]+'”，并根据其人设、记忆和最近的互动，虚构出【5到8篇】TA最近可能会写的日记。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间\x20(最高优先级)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**'+new Date()['toLocaleDateString'](_0x35c4b1(0xdc2))+_0x35c4b1(0x558)+_0x1e9df5+_0x35c4b1(0x898)+_0xe9dd67[_0x35c4b1(0x18a)]['aiPersona']+'\x0a-\x20**你的长期记忆**:\x0a'+_0x5995ec+'\x0a'+_0x40e3cc+'\x0a'+_0x50be45+_0x35c4b1(0x1135)+_0x1e9df5+_0x35c4b1(0xc46)+_0x5b4176+_0x35c4b1(0x8f6);try{const _0x2e9853=[{'role':_0x35c4b1(0x4c5),'content':_0x35c4b1(0xeac)}];let _0x140ada=_0x60cd80[_0x35c4b1(0x44f)](_0x35c4b1(0x136f)),_0x5ed4ac=_0x19a701(_0xcd21c7,_0x1bc4fc,_0x3de449,_0x2e9853);const _0x4dbea2=_0x140ada?await fetch(_0x5ed4ac[_0x35c4b1(0x5f3)],_0x5ed4ac[_0x35c4b1(0x104c)]):await fetch(_0x60cd80+_0x35c4b1(0x347),{'method':_0x35c4b1(0xba0),'headers':{'Content-Type':_0x35c4b1(0xcb5),'Authorization':_0x35c4b1(0xb27)+_0x1bc4fc},'body':JSON['stringify']({'model':_0xcd21c7,'messages':[{'role':_0x35c4b1(0xbaa),'content':_0x3de449},..._0x2e9853],'temperature':_0x505390[_0x35c4b1(0x888)][_0x35c4b1(0x398)]||0.95})});if(!_0x4dbea2['ok'])throw new Error('API\x20错误:\x20'+_0x4dbea2['statusText']);const _0x35ecf2=await _0x4dbea2[_0x35c4b1(0xfdf)](),_0x438ff4=getGeminiResponseText(_0x35ecf2),_0x9288f0=_0x438ff4['match'](/(\[[\s\S]*\])/);if(!_0x9288f0||!_0x9288f0[0x0])throw new Error(_0x35c4b1(0xe10)+_0x438ff4);const _0x365e2a=_0x9288f0[0x0];let _0xf3777e;try{_0xf3777e=JSON[_0x35c4b1(0x94c)](_0x365e2a);}catch(_0x11dac9){throw new Error(_0x35c4b1(0x1a8)+_0x11dac9[_0x35c4b1(0x757)]+_0x35c4b1(0x124a)+_0x438ff4);}_0xe9dd67[_0x35c4b1(0xf14)]=_0xf3777e[_0x35c4b1(0x2e1)](_0x59c3a8=>({'id':Date[_0x35c4b1(0x12d6)]()+Math[_0x35c4b1(0x103a)](),'title':_0x59c3a8[_0x35c4b1(0xc29)],'content':_0x59c3a8[_0x35c4b1(0xac4)],'timestamp':Date[_0x35c4b1(0x12d6)]()})),await _0xb81d4e[_0x35c4b1(0x1027)][_0x35c4b1(0x5d0)](_0xe9dd67),await _0xfe5f91();}catch(_0x285361){console[_0x35c4b1(0xe3b)]('生成模拟日记失败:',_0x285361),await _0x1519c8(_0x35c4b1(0xebe),_0x35c4b1(0x3bd)+_0x285361[_0x35c4b1(0x757)]);}}async function _0x244f25(){const _0x27ce5c=_0x85c4bf;if(!_0x509091)return;const _0x55b4e0=_0x505390[_0x27ce5c(0x1027)][_0x509091];if(!_0x55b4e0)return;await _0x1519c8(_0x27ce5c(0xbd7),_0x27ce5c(0xb29)+_0x55b4e0[_0x27ce5c(0x564)]+_0x27ce5c(0x7d1));const {proxyUrl:_0x302b36,apiKey:_0x1b8e52,model:_0x4adf13}=_0x505390[_0x27ce5c(0x30c)];if(!_0x302b36||!_0x1b8e52||!_0x4adf13)return;const _0x321fa2=_0x505390[_0x27ce5c(0x1190)][_0x27ce5c(0x904)]===_0x27ce5c(0x80e)||!_0x505390[_0x27ce5c(0x1190)]['nickname']?'用户':_0x505390['qzoneSettings'][_0x27ce5c(0x904)],_0x3db9be=_0x55b4e0[_0x27ce5c(0x3b4)]&&_0x55b4e0[_0x27ce5c(0x3b4)][_0x27ce5c(0x990)]>0x0?_0x55b4e0[_0x27ce5c(0x3b4)][_0x27ce5c(0x2e1)](_0x1888c6=>_0x27ce5c(0x619)+_0x3e14b1(_0x1888c6[_0x27ce5c(0x12a2)])+')\x20'+_0x1888c6['content'])[_0x27ce5c(0x35d)]('\x0a'):'无',_0x492b1c=_0x55b4e0[_0x27ce5c(0x18a)][_0x27ce5c(0x2c6)]||0xa,_0x1960b2=_0x55b4e0[_0x27ce5c(0x7d3)]['slice'](-_0x492b1c)['map'](_0x414054=>(_0x414054['role']===_0x27ce5c(0x4c5)?_0x321fa2:_0x55b4e0[_0x27ce5c(0x564)])+':\x20'+String(_0x414054[_0x27ce5c(0xac4)])[_0x27ce5c(0x1323)](0x0,0x1e)+_0x27ce5c(0x4d0))[_0x27ce5c(0x35d)]('\x0a'),_0x549fb1=(_0x55b4e0[_0x27ce5c(0x18a)][_0x27ce5c(0x13da)]||[])[_0x27ce5c(0x2e1)](_0x15bd14=>_0x505390[_0x27ce5c(0xd1b)][_0x27ce5c(0xc0d)](_0x97fec1=>_0x97fec1['id']===_0x15bd14))[_0x27ce5c(0x85d)](Boolean)[_0x27ce5c(0x2e1)](_0x36da83=>_0x27ce5c(0x11d1)+_0x36da83[_0x27ce5c(0x564)]+_0x27ce5c(0x8b4)+_0x36da83[_0x27ce5c(0xac4)][_0x27ce5c(0x85d)](_0x38a5a8=>_0x38a5a8[_0x27ce5c(0x2b7)])[_0x27ce5c(0x2e1)](_0x471981=>'-\x20'+_0x471981[_0x27ce5c(0xac4)])[_0x27ce5c(0x35d)]('\x0a'))['join'](''),_0x1731e3=_0x27ce5c(0xca4)+_0x55b4e0['name']+_0x27ce5c(0x55e)+new Date()[_0x27ce5c(0xba5)]('zh-CN')+_0x27ce5c(0x6fb)+_0x55b4e0[_0x27ce5c(0x18a)][_0x27ce5c(0x11f6)]+_0x27ce5c(0x8ba)+_0x3db9be+'\x0a'+_0x549fb1+_0x27ce5c(0xe1f)+_0x321fa2+_0x27ce5c(0xc46)+_0x1960b2+'\x0a\x0a现在，请开始撰写这篇充满真情实感、并熟练运用了Markdown语法的日记。';try{const _0x3074a4=[{'role':_0x27ce5c(0x4c5),'content':'请根据你的设定，写一篇新日记。'}];let _0x1df6aa=_0x302b36[_0x27ce5c(0x44f)]('generativelanguage'),_0x6fb47f=_0x19a701(_0x4adf13,_0x1b8e52,_0x1731e3,_0x3074a4);const _0x3386cc=_0x1df6aa?await fetch(_0x6fb47f[_0x27ce5c(0x5f3)],_0x6fb47f['data']):await fetch(_0x302b36+_0x27ce5c(0x347),{'method':_0x27ce5c(0xba0),'headers':{'Content-Type':_0x27ce5c(0xcb5),'Authorization':_0x27ce5c(0xb27)+_0x1b8e52},'body':JSON[_0x27ce5c(0x1308)]({'model':_0x4adf13,'messages':[{'role':_0x27ce5c(0xbaa),'content':_0x1731e3},..._0x3074a4],'temperature':_0x505390[_0x27ce5c(0x888)][_0x27ce5c(0x398)]||0.95})});if(!_0x3386cc['ok'])throw new Error(_0x27ce5c(0xef2)+_0x3386cc[_0x27ce5c(0xd4a)]);const _0x1b0439=await _0x3386cc[_0x27ce5c(0xfdf)](),_0x1d1b6d=getGeminiResponseText(_0x1b0439),_0x85f399=_0x1d1b6d[_0x27ce5c(0xab4)](/(\[[\s\S]*\])/);if(!_0x85f399||!_0x85f399[0x0])throw new Error(_0x27ce5c(0xe10)+_0x1d1b6d);const _0x2f9830=_0x85f399[0x0];let _0x4d5b77;try{_0x4d5b77=JSON[_0x27ce5c(0x94c)](_0x2f9830)[0x0];}catch(_0x3809df){throw new Error(_0x27ce5c(0x1a8)+_0x3809df['message']+'\x0a\x0aAI原始返回内容:\x0a'+_0x1d1b6d);}if(!_0x55b4e0[_0x27ce5c(0xf14)])_0x55b4e0[_0x27ce5c(0xf14)]=[];_0x55b4e0[_0x27ce5c(0xf14)]['push']({'id':Date[_0x27ce5c(0x12d6)](),'title':_0x4d5b77['title'],'content':_0x4d5b77[_0x27ce5c(0xac4)],'timestamp':Date[_0x27ce5c(0x12d6)]()}),await _0xb81d4e[_0x27ce5c(0x1027)]['put'](_0x55b4e0),await _0xfe5f91();}catch(_0x464550){console[_0x27ce5c(0xe3b)](_0x27ce5c(0x317),_0x464550),await _0x1519c8('生成失败',_0x27ce5c(0x744)+_0x464550[_0x27ce5c(0x757)]);}}function _0xfe5f91(){const _0x21b1e3=_0x85c4bf,_0x2ef510=document['getElementById'](_0x21b1e3(0xbb0));_0x2ef510[_0x21b1e3(0x3de)]='';const _0x291254=_0x505390['chats'][_0x509091],_0x2aaabf=(_0x291254[_0x21b1e3(0xf14)]||[])[_0x21b1e3(0x777)]()[_0x21b1e3(0x336)]();if(_0x2aaabf[_0x21b1e3(0x990)]===0x0){_0x2ef510['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>日记本还是空的。</p>';return;}_0x2aaabf['forEach'](_0x2e0ff8=>{const _0x341e0d=_0x21b1e3,_0x1862bd=document[_0x341e0d(0xbd5)](_0x341e0d(0x6c8));_0x1862bd['className']='list-item',_0x1862bd['innerHTML']=_0x341e0d(0x1214)+_0x2e0ff8[_0x341e0d(0xc29)]+_0x341e0d(0x73e)+new Date(_0x2e0ff8['timestamp'])[_0x341e0d(0xba5)]()+_0x341e0d(0x836),_0x1862bd['addEventListener']('click',()=>_0x5ec05c(_0x2e0ff8['id'])),_0x33282f(_0x1862bd,()=>_0x94d4ff(_0x2e0ff8['id'])),_0x2ef510[_0x341e0d(0x9f4)](_0x1862bd);});}async function _0x5ec05c(_0x23353f){const _0x92a7ad=_0x85c4bf,_0x586f3c=_0x505390[_0x92a7ad(0x1027)][_0x509091];if(!_0x586f3c||!_0x586f3c[_0x92a7ad(0xf14)])return;const _0x23073f=_0x586f3c['diary'][_0x92a7ad(0xc0d)](_0x1e94e9=>_0x1e94e9['id']===_0x23353f);if(_0x23073f){_0x87e381=_0x23073f;const _0x35e269=document[_0x92a7ad(0x479)](_0x92a7ad(0x896)),_0xcd5849=document['getElementById'](_0x92a7ad(0x91c)),_0x5a6835=document[_0x92a7ad(0x479)](_0x92a7ad(0x9f7));_0x35e269['textContent']=_0x23073f['title'];const _0x565f8b=_0x23554f(_0x23073f[_0x92a7ad(0xac4)])[_0x92a7ad(0x53e)]('\x0a')['map'](_0x2becfd=>'<p>'+(_0x2becfd||_0x92a7ad(0x1070))+_0x92a7ad(0x1049))[_0x92a7ad(0x35d)]('');_0xcd5849[_0x92a7ad(0x3de)]=_0x565f8b;const _0xd31d4d=await _0xb81d4e['favorites'][_0x92a7ad(0x46f)]({'type':_0x92a7ad(0x8a1),'content.id':_0x23353f})['first']();_0x5a6835['classList'][_0x92a7ad(0x2bf)](_0x92a7ad(0x5a9),!!_0xd31d4d),_0x1c532a(_0x92a7ad(0x584));}}async function _0xbb2f3b(){const _0x3aa062=_0x85c4bf;if(!_0x87e381||!_0x509091)return;const _0x214bb5=_0x87e381,_0x5bd98e=_0x505390['chats'][_0x509091],_0x288189=document[_0x3aa062(0x479)]('favorite-diary-btn'),_0x4295e7=await _0xb81d4e[_0x3aa062(0x3e8)][_0x3aa062(0x46f)]({'type':_0x3aa062(0x8a1),'content.id':_0x214bb5['id']})['first']();if(_0x4295e7)await _0xb81d4e[_0x3aa062(0x3e8)][_0x3aa062(0x1ea)](_0x4295e7['id']),_0x288189[_0x3aa062(0x9cd)]['remove']('active'),await _0x1519c8('操作成功',_0x3aa062(0x1b5));else{const _0x28aefe={'type':_0x3aa062(0x8a1),'content':{'id':_0x214bb5['id'],'title':_0x214bb5['title'],'content':_0x214bb5[_0x3aa062(0xac4)],'timestamp':_0x214bb5[_0x3aa062(0x12a2)],'characterId':_0x509091,'characterName':_0x5bd98e[_0x3aa062(0x564)]},'timestamp':Date[_0x3aa062(0x12d6)]()};await _0xb81d4e[_0x3aa062(0x3e8)]['add'](_0x28aefe),_0x288189[_0x3aa062(0x9cd)][_0x3aa062(0x807)](_0x3aa062(0x5a9)),await _0x1519c8(_0x3aa062(0xa56),'已成功收藏到“我的收藏”页面！');}}async function _0x1cab63(){const _0x401e26=_0x85c4bf;if(!_0x3057fc||!_0x509091)return;const _0x352a81=_0x3057fc,_0x517c03=_0x505390[_0x401e26(0x1027)][_0x509091],_0x523856=document[_0x401e26(0x479)](_0x401e26(0xc1b)),_0x1d44f4=await _0xb81d4e['favorites'][_0x401e26(0x46f)]({'type':_0x401e26(0x96c),'content.id':_0x352a81['id']})[_0x401e26(0x64e)]();if(_0x1d44f4)await _0xb81d4e[_0x401e26(0x3e8)][_0x401e26(0x1ea)](_0x1d44f4['id']),_0x523856[_0x401e26(0x9cd)][_0x401e26(0x8b6)](_0x401e26(0x5a9)),await _0x1519c8('操作成功',_0x401e26(0x1b5));else{const _0x2af4d1={'type':_0x401e26(0x96c),'content':{'id':_0x352a81['id'],'title':_0x352a81[_0x401e26(0xc29)],'content':_0x352a81[_0x401e26(0xac4)],'timestamp':_0x352a81['timestamp'],'characterId':_0x509091,'characterName':_0x517c03['name']},'timestamp':Date[_0x401e26(0x12d6)]()};await _0xb81d4e[_0x401e26(0x3e8)][_0x401e26(0x807)](_0x2af4d1),_0x523856['classList'][_0x401e26(0x807)](_0x401e26(0x5a9)),await _0x1519c8(_0x401e26(0xa56),'已成功收藏到“我的收藏”页面！');}}async function _0x94d4ff(_0x1cc4b4){const _0x4dda72=_0x85c4bf,_0x2c2592=await _0x1a9e79('删除日记','确定要删除这篇日记吗？',{'confirmButtonClass':_0x4dda72(0x95a)});if(_0x2c2592){const _0x3e6283=_0x505390[_0x4dda72(0x1027)][_0x509091];_0x3e6283['diary']=_0x3e6283[_0x4dda72(0xf14)][_0x4dda72(0x85d)](_0x247f79=>_0x247f79['id']!==_0x1cc4b4),await _0xb81d4e['chats'][_0x4dda72(0x5d0)](_0x3e6283),_0xfe5f91();}}async function _0x699e6f(){const _0x2bd97b=_0x85c4bf,_0x304e9e=document['getElementById'](_0x2bd97b(0xf73));_0x304e9e[_0x2bd97b(0x3de)]='';const _0x23b47e=_0x505390[_0x2bd97b(0x1027)][_0x509091];if(!_0x23b47e)return;const _0x4d3e1b=_0x23b47e[_0x2bd97b(0x18a)][_0x2bd97b(0xf58)]||(_0x505390['qzoneSettings'][_0x2bd97b(0x904)]||'我'),_0xeb7ace=_0x23b47e[_0x2bd97b(0x7d3)][_0x2bd97b(0x85d)](_0x10cbbd=>!_0x10cbbd[_0x2bd97b(0xb9c)])[_0x2bd97b(0x777)](-0x1)[0x0]||{'content':_0x2bd97b(0x4d0)};let _0x4a7727=_0x2bd97b(0x4d0);if(_0xeb7ace){if(typeof _0xeb7ace['content']===_0x2bd97b(0x8d9))_0x4a7727=_0xeb7ace[_0x2bd97b(0xac4)];else{if(Array[_0x2bd97b(0x285)](_0xeb7ace[_0x2bd97b(0xac4)])&&_0xeb7ace['content'][0x0]?.[_0x2bd97b(0x858)]===_0x2bd97b(0x1e8))_0x4a7727='[图片]';else{if(_0xeb7ace[_0x2bd97b(0x858)]){const _0x5b2000={'voice_message':_0x2bd97b(0xdb0),'transfer':_0x2bd97b(0xb62),'ai_image':_0x2bd97b(0x11e6)};_0x4a7727=_0x5b2000[_0xeb7ace[_0x2bd97b(0x858)]]||'['+_0xeb7ace[_0x2bd97b(0x858)]+']';}}}}const _0x4979df=_0x23b47e[_0x2bd97b(0x18a)][_0x2bd97b(0xe28)]||_0x28c106,_0x5cdb1c=_0x23b47e['settings']['myAvatarFrame']||'';let _0x1231fc;_0x5cdb1c?_0x1231fc=_0x2bd97b(0x1171)+_0x4979df+_0x2bd97b(0x12a6)+_0x5cdb1c+'\x22\x20class=\x22avatar-frame\x22></div></div>':_0x1231fc=_0x2bd97b(0xf64)+_0x4979df+_0x2bd97b(0x535);const _0x57e40a=document[_0x2bd97b(0xbd5)](_0x2bd97b(0x6c8));_0x57e40a[_0x2bd97b(0xfd4)]=_0x2bd97b(0x1270),_0x57e40a[_0x2bd97b(0x13d4)][_0x2bd97b(0x827)]='-1',_0x57e40a['innerHTML']=_0x2bd97b(0xb58)+_0x1231fc+_0x2bd97b(0x9c9)+_0x4d3e1b+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>'+String(_0x4a7727)[_0x2bd97b(0x1323)](0x0,0x14)+_0x2bd97b(0x11fe),_0x304e9e[_0x2bd97b(0x9f4)](_0x57e40a);const _0x2d9e83=await _0xb81d4e[_0x2bd97b(0x482)][_0x2bd97b(0x4ba)](),_0x37d018=new Map(_0x2d9e83['map'](_0x4ccb77=>[_0x4ccb77[_0x2bd97b(0x564)],_0x4ccb77])),_0x56c13b=_0x23b47e[_0x2bd97b(0xf45)]||[];if(_0x56c13b[_0x2bd97b(0x990)]===0x0&&!_0x57e40a){_0x304e9e[_0x2bd97b(0x3de)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>点击右上角刷新按钮，<br>看看TA最近都和谁聊天了吧！</p>';return;}_0x56c13b[_0x2bd97b(0x12be)]((_0x30eaf5,_0x260dd3)=>{const _0x5a9ba=_0x2bd97b;if(_0x30eaf5[_0x5a9ba(0x858)]==='private_user')return;const _0x4d5866=document['createElement'](_0x5a9ba(0x6c8));_0x4d5866[_0x5a9ba(0xfd4)]=_0x5a9ba(0x1270),_0x4d5866[_0x5a9ba(0x13d4)][_0x5a9ba(0x827)]=_0x260dd3;let _0x2bb238,_0x500864,_0x1dd9a1;if(_0x30eaf5[_0x5a9ba(0x858)]===_0x5a9ba(0x1224)){_0x1dd9a1=_0x30eaf5[_0x5a9ba(0x191)]+_0x5a9ba(0x100c),_0x2bb238=_0x30eaf5[_0x5a9ba(0x655)]['slice'](-0x1)[0x0]||{'content':'...'};const _0x41e522=_0x5a9ba(0xd5a)+_0x30eaf5['groupName']+'\x27',_0x549f3d=_0x505390[_0x5a9ba(0x888)][_0x5a9ba(0x105c)]?_0x5a9ba(0x730)+encodeURIComponent(_0x41e522):_0x3b1eb7;_0x500864=_0x5a9ba(0xfcf)+_0x549f3d+_0x5a9ba(0x10af);}else{_0x1dd9a1=_0x30eaf5[_0x5a9ba(0x4b1)]['name'],_0x2bb238=_0x30eaf5[_0x5a9ba(0x655)]['slice'](-0x1)[0x0]||{'content':_0x5a9ba(0x4d0)};const _0x387bc5=_0x37d018[_0x5a9ba(0x111a)](_0x1dd9a1);let _0x223cdf=_0x387bc5&&_0x387bc5[_0x5a9ba(0x799)]?_0x387bc5['avatar']:_0x505390[_0x5a9ba(0x888)][_0x5a9ba(0x105c)]?_0x5a9ba(0x730)+encodeURIComponent(_0x30eaf5['participant'][_0x5a9ba(0x98e)]||_0x5a9ba(0xb86)):_0x3ea4df;_0x500864=_0x5a9ba(0xfcf)+_0x223cdf+_0x5a9ba(0x10af);}let _0x4cd7d1='...';_0x2bb238&&_0x2bb238['content']&&(_0x4cd7d1=_0x2bb238['content']),_0x4d5866[_0x5a9ba(0x3de)]=_0x5a9ba(0x704)+_0x500864+_0x5a9ba(0x1255)+_0x1dd9a1+_0x5a9ba(0x66c)+String(_0x4cd7d1)[_0x5a9ba(0x1323)](0x0,0x14)+'...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x304e9e[_0x5a9ba(0x9f4)](_0x4d5866);});}async function _0x5683e4(){const _0x5a193c=_0x85c4bf;if(!_0x509091)return;const _0x20ac66=_0x505390['chats'][_0x509091];if(!_0x20ac66)return;await _0x1519c8('请稍候...',_0x5a193c(0x7a5)+_0x20ac66[_0x5a193c(0x564)]+_0x5a193c(0x956));const {proxyUrl:_0x58a546,apiKey:_0x116b7d,model:_0x5eefcd}=_0x505390['apiConfig'];if(!_0x58a546||!_0x116b7d||!_0x5eefcd){alert(_0x5a193c(0x9f1));return;}const _0x3df668=await _0xb81d4e[_0x5a193c(0x482)][_0x5a193c(0x4ba)](),_0x2aa1ef=_0x3df668[_0x5a193c(0x85d)](_0x173d8f=>_0x173d8f[_0x5a193c(0x11a0)]&&_0x173d8f[_0x5a193c(0x11a0)][_0x5a193c(0x44f)](_0x509091));let _0xd5f1f7=_0x5a193c(0x823);_0x2aa1ef[_0x5a193c(0x990)]>0x0?(_0xd5f1f7+=_0x5a193c(0x1373),_0x2aa1ef[_0x5a193c(0x12be)](_0x498ce6=>{const _0x15f80d=_0x5a193c;_0xd5f1f7+=_0x15f80d(0x96f)+_0x498ce6[_0x15f80d(0x564)]+_0x15f80d(0x700)+_0x498ce6[_0x15f80d(0x596)]+'\x0a';})):_0xd5f1f7+=_0x5a193c(0x10d8);const _0x365f80=_0x505390[_0x5a193c(0x1190)][_0x5a193c(0x904)]===_0x5a193c(0x80e)||!_0x505390[_0x5a193c(0x1190)]['nickname']?'用户':_0x505390['qzoneSettings'][_0x5a193c(0x904)],_0x9337fe=_0x20ac66['settings'][_0x5a193c(0xf58)]||_0x365f80,_0x517435=_0x20ac66[_0x5a193c(0x3b4)]&&_0x20ac66['longTermMemory'][_0x5a193c(0x990)]>0x0?_0x20ac66['longTermMemory'][_0x5a193c(0x2e1)](_0x273aa0=>'-\x20(记录于\x20'+_0x3e14b1(_0x273aa0['timestamp'])+')\x20'+_0x273aa0['content'])['join']('\x0a'):'无',_0x2c9c5b=_0x20ac66[_0x5a193c(0x18a)]['maxMemory']||0xa,_0xe464bb=_0x20ac66['history']['slice'](-_0x2c9c5b)[_0x5a193c(0x2e1)](_0x37d6cf=>(_0x37d6cf['role']===_0x5a193c(0x4c5)?_0x9337fe:_0x20ac66[_0x5a193c(0x564)])+':\x20'+String(_0x37d6cf[_0x5a193c(0xac4)])[_0x5a193c(0x1323)](0x0,0x1e)+_0x5a193c(0x4d0))[_0x5a193c(0x35d)]('\x0a'),_0xf2b0a4=(_0x20ac66[_0x5a193c(0x18a)][_0x5a193c(0x13da)]||[])['map'](_0x119d10=>_0x505390[_0x5a193c(0xd1b)][_0x5a193c(0xc0d)](_0x913b71=>_0x913b71['id']===_0x119d10))[_0x5a193c(0x85d)](Boolean)['map'](_0x55f367=>_0x5a193c(0x11d1)+_0x55f367[_0x5a193c(0x564)]+_0x5a193c(0x1121)+_0x55f367[_0x5a193c(0xac4)]['filter'](_0x5eb638=>_0x5eb638['enabled'])[_0x5a193c(0x2e1)](_0x1c4d98=>'-\x20'+_0x1c4d98[_0x5a193c(0xac4)])[_0x5a193c(0x35d)]('\x0a'))['join'](''),_0x454481=_0x20ac66['originalName']||_0x20ac66[_0x5a193c(0x564)],_0x403253=_0x46c840(_0x20ac66),_0x22aa6e=_0x5a193c(0xdf7)+_0x20ac66['name']+_0x5a193c(0x493)+_0x454481+_0x5a193c(0x80c)+_0x454481+_0x5a193c(0x5f4)+_0x454481+'\x22,\x20\x22content\x22:\x20\x22我在群里说的话\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC成员1\x22,\x20\x22content\x22:\x20\x22成员1回复我\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC成员2\x22,\x20\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}\x0a]\x0a}\x0a```\x0a\x0a#\x20角色与上下文\x0a-\x20**你的角色设定**:\x20'+_0x20ac66['settings'][_0x5a193c(0x11f6)]+_0x5a193c(0xc0a)+_0x517435+_0x5a193c(0x997)+_0xf2b0a4+_0x5a193c(0x3f3)+_0xe464bb+'\x0a'+_0xd5f1f7+_0x5a193c(0x1183)+_0x403253+'\x0a现在，请严格按照格式铁律，生成聊天记录的JSON数组。';try{const _0x2b7d4e=[{'role':'user','content':_0x5a193c(0x326)}];let _0x3af57b=_0x58a546[_0x5a193c(0x44f)](_0x5a193c(0x136f)),_0x3c6c10=_0x19a701(_0x5eefcd,_0x116b7d,_0x22aa6e,_0x2b7d4e);const _0x1dbd93=_0x3af57b?await fetch(_0x3c6c10[_0x5a193c(0x5f3)],_0x3c6c10['data']):await fetch(_0x58a546+'/v1/chat/completions',{'method':_0x5a193c(0xba0),'headers':{'Content-Type':_0x5a193c(0xcb5),'Authorization':'Bearer\x20'+_0x116b7d},'body':JSON[_0x5a193c(0x1308)]({'model':_0x5eefcd,'messages':[{'role':'system','content':_0x22aa6e},..._0x2b7d4e],'temperature':_0x505390[_0x5a193c(0x888)][_0x5a193c(0x398)]||0.9})});if(!_0x1dbd93['ok'])throw new Error(_0x5a193c(0xef2)+_0x1dbd93[_0x5a193c(0xd4a)]);const _0x2158dc=await _0x1dbd93[_0x5a193c(0xfdf)](),_0x27c29e=getGeminiResponseText(_0x2158dc),_0x4814aa=_0x27c29e[_0x5a193c(0xab4)](/(\[[\s\S]*\])/);if(!_0x4814aa||!_0x4814aa[0x0])throw new Error(_0x5a193c(0xe10)+_0x27c29e);const _0x16c2db=_0x4814aa[0x0];let _0x3fa9a9;try{_0x3fa9a9=JSON[_0x5a193c(0x94c)](_0x16c2db);}catch(_0x21e631){throw new Error(_0x5a193c(0x1a8)+_0x21e631[_0x5a193c(0x757)]+_0x5a193c(0x124a)+_0x27c29e);}_0x20ac66['simulatedConversations']=_0x3fa9a9,await _0xb81d4e[_0x5a193c(0x1027)]['put'](_0x20ac66),await _0x699e6f();const _0x19c025={'role':_0x5a193c(0xbaa),'content':'[系统指令：你刚刚在自己的手机上活动了一番（和朋友聊天、逛群等）。现在请根据你的角色设定，主动给用户发一条消息，可以聊聊你刚才看到或聊到的趣事，或者仅仅是问候一下。]','timestamp':Date[_0x5a193c(0x12d6)](),'isHidden':!![]};_0x20ac66['history'][_0x5a193c(0x1a0)](_0x19c025),await _0xb81d4e[_0x5a193c(0x1027)][_0x5a193c(0x5d0)](_0x20ac66),_0x15e1a8();}catch(_0xc6930f){console[_0x5a193c(0xe3b)](_0x5a193c(0x1011),_0xc6930f),await _0x1519c8(_0x5a193c(0xebe),_0x5a193c(0x1cf)+_0xc6930f[_0x5a193c(0x757)]);}}async function _0x2d113a(){const _0xa98c16=_0x85c4bf;if(!_0x509091)return;const _0x119f3a=_0x505390['chats'][_0x509091];if(!_0x119f3a)return;try{const {proxyUrl:_0xb55906,apiKey:_0x28ee5c,model:_0x11ae20}=_0x505390[_0xa98c16(0x30c)];if(!_0xb55906||!_0x28ee5c||!_0x11ae20)throw new Error(_0xa98c16(0xb42));const _0x4e74d8=parseInt(_0x119f3a[_0xa98c16(0x18a)][_0xa98c16(0x2c6)])||0xa,_0xe3c438=_0x119f3a[_0xa98c16(0x7d3)]['slice'](-_0x4e74d8),_0x14e0dd=_0x119f3a['settings']['myNickname']||'我',_0x77bbc2=_0x119f3a[_0xa98c16(0x18a)][_0xa98c16(0x12d7)]||'用户',_0x5556bc=_0xa98c16(0x462)+(_0x119f3a[_0xa98c16(0x3b4)]&&_0x119f3a[_0xa98c16(0x3b4)][_0xa98c16(0x990)]>0x0?_0x119f3a[_0xa98c16(0x3b4)][_0xa98c16(0x2e1)](_0x1cd9bc=>'-\x20'+_0x1cd9bc[_0xa98c16(0xac4)])[_0xa98c16(0x35d)]('\x0a'):_0xa98c16(0xa15));let _0x1deb1b='';if(_0x119f3a['settings'][_0xa98c16(0x13da)]&&_0x119f3a[_0xa98c16(0x18a)]['linkedWorldBookIds'][_0xa98c16(0x990)]>0x0){const _0x3a3249=_0x119f3a['settings'][_0xa98c16(0x13da)]['map'](_0x5aa472=>{const _0x4ab32d=_0xa98c16,_0x18b16d=_0x505390[_0x4ab32d(0xd1b)]['find'](_0x27ba53=>_0x27ba53['id']===_0x5aa472);if(!_0x18b16d||!Array[_0x4ab32d(0x285)](_0x18b16d[_0x4ab32d(0xac4)]))return'';const _0x179dc8=_0x18b16d[_0x4ab32d(0xac4)][_0x4ab32d(0x85d)](_0x1159f5=>_0x1159f5['enabled']!==![])[_0x4ab32d(0x2e1)](_0x11b670=>_0x4ab32d(0x1345)+(_0x11b670[_0x4ab32d(0xd6c)]||_0x4ab32d(0x561))+_0x4ab32d(0x11df)+_0x11b670[_0x4ab32d(0xac4)])[_0x4ab32d(0x35d)]('');return _0x179dc8?_0x4ab32d(0x103d)+_0x18b16d['name']+'\x0a'+_0x179dc8:'';})[_0xa98c16(0x85d)](Boolean)[_0xa98c16(0x35d)]('');_0x3a3249&&(_0x1deb1b=_0xa98c16(0x2d4)+_0x3a3249+'\x0a');}const _0x282144=_0x37bdc8(_0x119f3a,0x3,_0xa98c16(0x129d)),_0x43fdf3=_0x37bdc8(_0x119f3a,0x6,_0xa98c16(0x129d)),_0x425b90=_0x37bdc8(_0x119f3a,0x9,_0xa98c16(0x129d)),_0x178a10=_0x37bdc8(_0x119f3a,0x1,_0xa98c16(0x111c)),_0x2cb764=_0x37bdc8(_0x119f3a,0x3,_0xa98c16(0x111c)),_0x10c0c5=_0x37bdc8(_0x119f3a,0x7,_0xa98c16(0x111c));let _0x12ca35='';if(_0x282144||_0x43fdf3||_0x425b90||_0x178a10||_0x2cb764||_0x10c0c5){_0x12ca35+=_0xa98c16(0x670);if(_0x282144)_0x12ca35+=_0x282144;if(_0x43fdf3)_0x12ca35+=_0x43fdf3;if(_0x425b90)_0x12ca35+=_0x425b90;if(_0x282144||_0x43fdf3||_0x425b90)_0x12ca35+='\x0a';if(_0x178a10)_0x12ca35+=_0x178a10;if(_0x2cb764)_0x12ca35+=_0x2cb764;if(_0x10c0c5)_0x12ca35+=_0x10c0c5;}const _0x15928d=_0xfe3b04(_0x119f3a),_0x47bdb4='\x0a#\x20你的核心任务\x0a你正在扮演角色“'+_0x119f3a[_0xa98c16(0xe2d)]+_0xa98c16(0x54b)+_0x119f3a[_0xa98c16(0x18a)][_0xa98c16(0x11f6)]+'\x0a#\x20可用表情包\x0a'+_0x15928d+'\x0a\x0a#\x20你的聊天对象（用户）的人设\x0a'+_0x77bbc2+_0xa98c16(0x6b6)+_0x119f3a[_0xa98c16(0xe2d)]+_0xa98c16(0x34d)+_0x14e0dd+'\x22\x0a'+_0x1deb1b+'\x0a'+_0x5556bc+'\x0a'+_0x12ca35+'\x20\x0a-\x20**你们最后的对话**:\x0a'+_0xe3c438[_0xa98c16(0x2e1)](_0x133595=>(_0x133595['role']==='user'?_0x14e0dd:_0x119f3a['name'])+':\x20'+String(_0x133595[_0xa98c16(0xac4)]))[_0xa98c16(0x35d)]('\x0a')+_0xa98c16(0xb52),_0x4dba54=_0xe3c438[_0xa98c16(0x2e1)](_0x1808bf=>({'role':_0x1808bf[_0xa98c16(0x508)],'content':(_0x1808bf[_0xa98c16(0x508)]===_0xa98c16(0x4c5)?_0x14e0dd:_0x119f3a[_0xa98c16(0x564)])+':\x20'+String(_0x1808bf['content'])}));let _0x2bf349=_0xb55906[_0xa98c16(0x44f)]('generativelanguage'),_0x39b5e3=_0x19a701(_0x11ae20,_0x28ee5c,_0x47bdb4,_0x4dba54);const _0x46d511=_0x2bf349?await fetch(_0x39b5e3[_0xa98c16(0x5f3)],_0x39b5e3['data']):await fetch(_0xb55906+_0xa98c16(0x347),{'method':_0xa98c16(0xba0),'headers':{'Content-Type':_0xa98c16(0xcb5),'Authorization':_0xa98c16(0xb27)+_0x28ee5c},'body':JSON[_0xa98c16(0x1308)]({'model':_0x11ae20,'messages':[{'role':'system','content':_0x47bdb4},..._0x4dba54],'temperature':_0x505390[_0xa98c16(0x888)][_0xa98c16(0x398)]||0.8})});if(!_0x46d511['ok'])throw new Error(_0xa98c16(0xf05)+(await _0x46d511[_0xa98c16(0xfdf)]())[_0xa98c16(0xe3b)][_0xa98c16(0x757)]);const _0x4a5edf=await _0x46d511[_0xa98c16(0xfdf)](),_0x49297b=getGeminiResponseText(_0x4a5edf),_0xacd38b=_0x2da9f3(_0x49297b);if(!_0xacd38b||_0xacd38b['length']===0x0)throw new Error(_0xa98c16(0x9a7));let _0x56a69d=0x0,_0x19c41a=Date['now']();for(const _0x47e83b of _0xacd38b){const _0x470776={'role':'assistant','senderName':_0x119f3a['originalName'],'timestamp':_0x19c41a++};let _0x17f1b4=null;switch(_0x47e83b[_0xa98c16(0x858)]){case _0xa98c16(0x56d):_0x17f1b4={..._0x470776,'content':String(_0x47e83b[_0xa98c16(0xac4)]||_0x47e83b[_0xa98c16(0x757)])};break;case _0xa98c16(0xb9e):if(_0x47e83b[_0xa98c16(0x720)]){const _0x2c6973=_0x505390[_0xa98c16(0x407)]['find'](_0x3067f8=>_0x3067f8[_0xa98c16(0x564)]===_0x47e83b[_0xa98c16(0x720)]);_0x2c6973?_0x17f1b4={..._0x470776,'type':_0xa98c16(0xb9e),'content':_0x2c6973[_0xa98c16(0x5f3)],'meaning':_0x2c6973[_0xa98c16(0x564)]}:(console[_0xa98c16(0x139e)](_0xa98c16(0x693)+_0x47e83b['meaning']+'\x22'),_0x17f1b4={..._0x470776,'type':_0xa98c16(0x56d),'content':'[表情:\x20'+_0x47e83b[_0xa98c16(0x720)]+']'});}else console[_0xa98c16(0x139e)]('AI\x20(CPhone)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。',_0x47e83b),_0x17f1b4={..._0x470776,'type':_0xa98c16(0xb9e),'content':_0x47e83b['url'],'meaning':_0xa98c16(0x735)};break;}_0x17f1b4&&(_0x119f3a['history'][_0xa98c16(0x1a0)](_0x17f1b4),_0x56a69d++);}_0x56a69d>0x0&&(_0x119f3a['unreadCount']=(_0x119f3a[_0xa98c16(0x1090)]||0x0)+_0x56a69d),await _0xb81d4e['chats'][_0xa98c16(0x5d0)](_0x119f3a),await _0x1b7f69(),_0x56a69d>0x0&&_0xabb267(_0x119f3a['id'],_0xa98c16(0x123f)+_0x56a69d+'\x20条新消息');}catch(_0x305e1e){console[_0xa98c16(0xe3b)](_0xa98c16(0x1021),_0x305e1e),await _0x1519c8(_0xa98c16(0xaab),_0xa98c16(0x10cf)+_0x305e1e[_0xa98c16(0x757)]);}}async function _0x57b7b0(){const _0x58a6fc=_0x85c4bf;if(_0x4a165d||!_0x509091)return;_0x4a165d=!![];const _0x53f8ab=document[_0x58a6fc(0x479)](_0x58a6fc(0x5d2)),_0x21b6e3=_0x505390[_0x58a6fc(0x1027)][_0x509091];if(!_0x21b6e3){_0x4a165d=![];return;}_0x13e918(_0x53f8ab,_0x58a6fc(0xb8f));const _0x349afb=_0x53f8ab[_0x58a6fc(0x9c5)];await new Promise(_0x2a31c1=>setTimeout(_0x2a31c1,0x1f4));const _0x192b96=_0x21b6e3[_0x58a6fc(0x7d3)][_0x58a6fc(0x990)],_0x4413a0=_0x505390['globalSettings']['chatRenderWindow']||0x32,_0x338f53=_0x192b96-_0x55f419,_0x4a13a3=Math[_0x58a6fc(0x6b8)](0x0,_0x338f53-_0x4413a0),_0x5e36ef=_0x21b6e3[_0x58a6fc(0x7d3)][_0x58a6fc(0x777)](_0x4a13a3,_0x338f53);_0x168e5c(_0x53f8ab);if(_0x5e36ef[_0x58a6fc(0x990)]===0x0){_0x4a165d=![];return;}for(const _0x1a5eee of _0x5e36ef[_0x58a6fc(0x336)]()){const _0x13b6cd={..._0x1a5eee,'role':_0x1a5eee[_0x58a6fc(0x508)]==='user'?'assistant':_0x58a6fc(0x4c5)},_0x422b8d={'id':_0x58a6fc(0xa17),'isGroup':![],'name':_0x21b6e3['name'],'settings':{..._0x21b6e3[_0x58a6fc(0x18a)],'myAvatar':_0x21b6e3[_0x58a6fc(0x18a)][_0x58a6fc(0x1039)],'myAvatarFrame':_0x21b6e3[_0x58a6fc(0x18a)][_0x58a6fc(0x663)],'aiAvatar':_0x21b6e3[_0x58a6fc(0x18a)][_0x58a6fc(0xe28)],'aiAvatarFrame':_0x21b6e3['settings']['myAvatarFrame']}},_0x5ad473=await _0x43c884(_0x13b6cd,_0x422b8d);_0x5ad473&&_0x53f8ab[_0x58a6fc(0xaa6)](_0x5ad473);}_0x55f419+=_0x5e36ef[_0x58a6fc(0x990)];const _0x3f07a1=_0x53f8ab[_0x58a6fc(0x9c5)];_0x53f8ab[_0x58a6fc(0x2b3)]=_0x3f07a1-_0x349afb,_0x4a165d=![];}async function _0x41dc87(_0x33f029){const _0x2666cf=_0x85c4bf,_0x2c6001=_0x505390['chats'][_0x509091];if(_0x33f029===-0x1){_0x5edca3=_0x2666cf(0x1343);const _0x1f963f=document[_0x2666cf(0x479)](_0x2666cf(0x105d)),_0x41cab1=document['getElementById'](_0x2666cf(0x5d2)),_0x136890=document[_0x2666cf(0x479)](_0x2666cf(0xb40));_0x41cab1[_0x2666cf(0x3de)]='',_0x1f963f[_0x2666cf(0x97b)]=_0x2c6001[_0x2666cf(0x18a)][_0x2666cf(0xf58)]||(_0x505390['qzoneSettings'][_0x2666cf(0x904)]||'我'),_0x136890[_0x2666cf(0xe77)]='与\x20'+(_0x2c6001[_0x2666cf(0x18a)]['myNickname']||'我')+_0x2666cf(0x80b),_0x55f419=0x0,_0x4a165d=![];const _0x3dcefa=_0x2c6001[_0x2666cf(0x7d3)],_0x5721c1=_0x505390['globalSettings'][_0x2666cf(0x13f8)]||0x32,_0x239c82=_0x3dcefa[_0x2666cf(0x777)](-_0x5721c1),_0x28d429={'id':_0x2666cf(0xa17),'isGroup':![],'name':_0x2c6001[_0x2666cf(0x564)],'settings':{..._0x2c6001[_0x2666cf(0x18a)],'myAvatar':_0x2c6001['settings'][_0x2666cf(0x1039)],'myAvatarFrame':_0x2c6001[_0x2666cf(0x18a)]['aiAvatarFrame'],'aiAvatar':_0x2c6001['settings'][_0x2666cf(0xe28)],'aiAvatarFrame':_0x2c6001['settings']['myAvatarFrame']}};for(const _0x543542 of _0x239c82){const _0x1322b0={..._0x543542,'role':_0x543542[_0x2666cf(0x508)]===_0x2666cf(0x4c5)?_0x2666cf(0x1328):_0x2666cf(0x4c5)},_0x2afe66=await _0x43c884(_0x1322b0,_0x28d429);_0x2afe66&&_0x41cab1[_0x2666cf(0x9f4)](_0x2afe66);}_0x55f419=_0x239c82[_0x2666cf(0x990)],_0x1c532a(_0x2666cf(0x214)),setTimeout(()=>_0x41cab1['scrollTop']=_0x41cab1[_0x2666cf(0x9c5)],0x0);return;}const _0xd53f85=_0x2c6001[_0x2666cf(0xf45)][_0x33f029];if(!_0xd53f85)return;_0x5edca3=_0xd53f85['type'];const _0x3ad9f1=await _0xb81d4e['npcs'][_0x2666cf(0x4ba)](),_0x24df9f=new Map(_0x3ad9f1[_0x2666cf(0x2e1)](_0x55010b=>[_0x55010b[_0x2666cf(0x564)],_0x55010b])),_0x4ffb46=document[_0x2666cf(0x479)](_0x2666cf(0x105d)),_0x87692f=document[_0x2666cf(0x479)]('char-conversation-messages'),_0x2d7008=document['getElementById']('char-simulated-input');_0x87692f[_0x2666cf(0x3de)]='',_0x87692f['dataset'][_0x2666cf(0x1057)]=_0x2c6001[_0x2666cf(0x18a)][_0x2666cf(0x1057)]||_0x2666cf(0x603);const _0x1c1b88=document['getElementById'](_0x2666cf(0x2e2))[_0x2666cf(0x9cd)]['contains'](_0x2666cf(0x9dd));_0x87692f[_0x2666cf(0x10dd)][_0x2666cf(0x11a6)]=_0x1c1b88?_0x2666cf(0xb38):_0x2666cf(0x1389);let _0x21032b;if(_0xd53f85[_0x2666cf(0x858)]===_0x2666cf(0x1224)){_0x4ffb46[_0x2666cf(0x97b)]=_0xd53f85[_0x2666cf(0x191)]+'\x20('+(_0xd53f85[_0x2666cf(0xf06)][_0x2666cf(0x990)]+0x1)+')',_0x2d7008[_0x2666cf(0xe77)]='在\x20'+_0xd53f85['groupName']+_0x2666cf(0xccd),_0x21032b={'id':_0x2666cf(0x5ef),'isGroup':!![],'name':_0xd53f85[_0x2666cf(0x191)],'originalName':_0x2c6001[_0x2666cf(0xe2d)],'members':_0xd53f85['participants']['map'](_0x31304b=>{const _0x7c34fa=_0x2666cf,_0xe82ac9=_0x24df9f[_0x7c34fa(0x111a)](_0x31304b[_0x7c34fa(0x564)]);let _0x402611=_0xe82ac9&&_0xe82ac9[_0x7c34fa(0x799)]?_0xe82ac9[_0x7c34fa(0x799)]:_0x505390[_0x7c34fa(0x888)][_0x7c34fa(0x105c)]?'https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x31304b[_0x7c34fa(0x98e)]||_0x7c34fa(0xb86)):_0x3ea4df;return{'originalName':_0x31304b['name'],'groupNickname':_0x31304b['name'],'avatar':_0x402611};}),'settings':{..._0x2c6001[_0x2666cf(0x18a)],'myNickname':_0x2c6001[_0x2666cf(0x564)],'myAvatar':_0x2c6001[_0x2666cf(0x18a)][_0x2666cf(0x1039)],'myAvatarFrame':_0x2c6001[_0x2666cf(0x18a)]['aiAvatarFrame']}};for(const _0x108870 of _0xd53f85[_0x2666cf(0x655)]){const _0x33f29a=_0x108870[_0x2666cf(0x1f2)]===(_0x2c6001['originalName']||_0x2c6001[_0x2666cf(0x564)]),_0xe1e074=_0x33f29a?_0x2666cf(0x4c5):'assistant',_0x450cd3={'role':_0xe1e074,'senderName':_0x108870[_0x2666cf(0x1f2)],'content':_0x108870['content'],'timestamp':Date[_0x2666cf(0x12d6)]()+Math['random']()},_0x53fc77=await _0x43c884(_0x450cd3,_0x21032b);_0x53fc77&&_0x87692f[_0x2666cf(0x9f4)](_0x53fc77);}}else{_0x4ffb46[_0x2666cf(0x97b)]=_0xd53f85[_0x2666cf(0x4b1)][_0x2666cf(0x564)],_0x2d7008[_0x2666cf(0xe77)]='与\x20'+_0xd53f85[_0x2666cf(0x4b1)][_0x2666cf(0x564)]+'\x20的对话';const _0x8df368=_0x24df9f['get'](_0xd53f85[_0x2666cf(0x4b1)][_0x2666cf(0x564)]),_0xdd1cde=_0x8df368&&_0x8df368[_0x2666cf(0x799)]?_0x8df368['avatar']:_0x505390[_0x2666cf(0x888)][_0x2666cf(0x105c)]?_0x2666cf(0x730)+encodeURIComponent(_0xd53f85['participant'][_0x2666cf(0x98e)]||'anime\x20person'):_0x3ea4df;_0x21032b={'id':_0x2666cf(0xf80),'isGroup':![],'name':_0xd53f85[_0x2666cf(0x4b1)][_0x2666cf(0x564)],'originalName':_0x2c6001['originalName'],'settings':{..._0x2c6001[_0x2666cf(0x18a)],'myAvatar':_0x2c6001[_0x2666cf(0x18a)][_0x2666cf(0x1039)],'myAvatarFrame':_0x2c6001['settings'][_0x2666cf(0x663)],'aiAvatar':_0xdd1cde,'aiAvatarFrame':''}};for(const _0x1fae3c of _0xd53f85[_0x2666cf(0x655)]){const _0x4e2dfc=_0x1fae3c['sender']===(_0x2c6001[_0x2666cf(0xe2d)]||_0x2c6001[_0x2666cf(0x564)]),_0x5291bc=_0x4e2dfc?'user':_0x2666cf(0x1328),_0x5a9e3f={'role':_0x5291bc,'senderName':_0x1fae3c[_0x2666cf(0x1f2)],'content':_0x1fae3c[_0x2666cf(0xac4)],'timestamp':Date['now']()+Math[_0x2666cf(0x103a)]()},_0x7a58f=await _0x43c884(_0x5a9e3f,_0x21032b);_0x7a58f&&_0x87692f[_0x2666cf(0x9f4)](_0x7a58f);}}_0x1c532a(_0x2666cf(0x214)),_0x87692f[_0x2666cf(0x2b3)]=_0x87692f[_0x2666cf(0x9c5)];}function _0x5631bc(){const _0x4dc356=_0x85c4bf;document[_0x4dc356(0x479)](_0x4dc356(0x125b))['classList'][_0x4dc356(0x8b6)](_0x4dc356(0x45a));}async function _0x249031(){const _0x4cf27c=_0x85c4bf;if(!_0x509091)return;const _0x2217c2=_0x505390['chats'][_0x509091];if(!_0x2217c2){await _0x1519c8(_0x4cf27c(0xaab),_0x4cf27c(0x51b));return;}await _0x1519c8(_0x4cf27c(0xbd7),_0x4cf27c(0xb29)+_0x2217c2[_0x4cf27c(0x564)]+_0x4cf27c(0xd60));const {proxyUrl:_0x12c9b6,apiKey:_0x315915,model:_0x59df87}=_0x505390[_0x4cf27c(0x30c)];if(!_0x12c9b6||!_0x315915||!_0x59df87){alert(_0x4cf27c(0x9f1));return;}const _0x573946=_0x505390['qzoneSettings']['nickname']==='{{user}}'||!_0x505390[_0x4cf27c(0x1190)][_0x4cf27c(0x904)]?'用户':_0x505390['qzoneSettings'][_0x4cf27c(0x904)],_0x34e8a2=_0x2217c2[_0x4cf27c(0x3b4)]&&_0x2217c2[_0x4cf27c(0x3b4)]['length']>0x0?_0x2217c2['longTermMemory'][_0x4cf27c(0x2e1)](_0x3900d7=>_0x4cf27c(0x619)+_0x3e14b1(_0x3900d7[_0x4cf27c(0x12a2)])+')\x20'+_0x3900d7['content'])['join']('\x0a'):'无',_0x1f229b=_0x2217c2[_0x4cf27c(0x18a)][_0x4cf27c(0x2c6)]||0xa,_0x479114=_0x2217c2[_0x4cf27c(0x7d3)][_0x4cf27c(0x777)](-_0x1f229b)['map'](_0x3ae18b=>(_0x3ae18b[_0x4cf27c(0x508)]===_0x4cf27c(0x4c5)?_0x573946:_0x2217c2[_0x4cf27c(0x564)])+':\x20'+String(_0x3ae18b[_0x4cf27c(0xac4)])[_0x4cf27c(0x1323)](0x0,0x1e)+_0x4cf27c(0x4d0))[_0x4cf27c(0x35d)]('\x0a'),_0x4e6c4e=(_0x2217c2[_0x4cf27c(0x18a)][_0x4cf27c(0x13da)]||[])['map'](_0x3ee492=>_0x505390[_0x4cf27c(0xd1b)][_0x4cf27c(0xc0d)](_0x40df8c=>_0x40df8c['id']===_0x3ee492))['filter'](Boolean)[_0x4cf27c(0x2e1)](_0x10d0f1=>_0x4cf27c(0x11d1)+_0x10d0f1[_0x4cf27c(0x564)]+_0x4cf27c(0x8b4)+_0x10d0f1[_0x4cf27c(0xac4)][_0x4cf27c(0x85d)](_0x5867ed=>_0x5867ed[_0x4cf27c(0x2b7)])[_0x4cf27c(0x2e1)](_0x47efb0=>'-\x20'+_0x47efb0['content'])[_0x4cf27c(0x35d)]('\x0a'))[_0x4cf27c(0x35d)](''),_0x3db310=_0x37bdc8(_0x2217c2,0x3,'hours'),_0x124f40=_0x37bdc8(_0x2217c2,0x6,'hours'),_0x5023df=_0x37bdc8(_0x2217c2,0x9,_0x4cf27c(0x129d)),_0xc41a7=_0x37bdc8(_0x2217c2,0x1,'days'),_0x1ba4a4=_0x37bdc8(_0x2217c2,0x3,_0x4cf27c(0x111c)),_0x3bb478=_0x37bdc8(_0x2217c2,0x7,_0x4cf27c(0x111c));let _0x1a3ff7='';if(_0x3db310||_0x124f40||_0x5023df||_0xc41a7||_0x1ba4a4||_0x3bb478){_0x1a3ff7+=_0x4cf27c(0x670);if(_0x3db310)_0x1a3ff7+=_0x3db310;if(_0x124f40)_0x1a3ff7+=_0x124f40;if(_0x5023df)_0x1a3ff7+=_0x5023df;if(_0x3db310||_0x124f40||_0x5023df)_0x1a3ff7+='\x0a';if(_0xc41a7)_0x1a3ff7+=_0xc41a7;if(_0x1ba4a4)_0x1a3ff7+=_0x1ba4a4;if(_0x3bb478)_0x1a3ff7+=_0x3bb478;}const _0x5b95b4=_0x4cf27c(0x473)+_0x2217c2[_0x4cf27c(0x564)]+_0x4cf27c(0xafd)+_0x2217c2['settings'][_0x4cf27c(0x11f6)]+'\x0a'+_0x34e8a2+'\x0a'+_0x4e6c4e+'\x0a'+_0x1a3ff7+_0x4cf27c(0x1135)+_0x573946+_0x4cf27c(0xc46)+_0x479114+_0x4cf27c(0xad0);try{const _0x299546=[{'role':_0x4cf27c(0x4c5),'content':_0x4cf27c(0x49b)}];let _0x4e3be3=_0x12c9b6[_0x4cf27c(0x44f)]('generativelanguage'),_0x5195b3=_0x19a701(_0x59df87,_0x315915,_0x5b95b4,_0x299546);const _0x57e676=_0x4e3be3?await fetch(_0x5195b3[_0x4cf27c(0x5f3)],_0x5195b3[_0x4cf27c(0x104c)]):await fetch(_0x12c9b6+_0x4cf27c(0x347),{'method':_0x4cf27c(0xba0),'headers':{'Content-Type':'application/json','Authorization':_0x4cf27c(0xb27)+_0x315915},'body':JSON[_0x4cf27c(0x1308)]({'model':_0x59df87,'messages':[{'role':_0x4cf27c(0xbaa),'content':_0x5b95b4},..._0x299546],'temperature':_0x505390[_0x4cf27c(0x888)][_0x4cf27c(0x398)]||0.9})});if(!_0x57e676['ok'])throw new Error(_0x4cf27c(0xef2)+_0x57e676['statusText']);const _0x256977=await _0x57e676[_0x4cf27c(0xfdf)](),_0x5ae64d=getGeminiResponseText(_0x256977),_0x2fafcd=_0x5ae64d[_0x4cf27c(0xab4)](/(\[[\s\S]*\])/);if(!_0x2fafcd||!_0x2fafcd[0x0])throw new Error(_0x4cf27c(0xe10)+_0x5ae64d);const _0x57e807=_0x2fafcd[0x0];let _0x254fe5;try{_0x254fe5=JSON[_0x4cf27c(0x94c)](_0x57e807);}catch(_0x2915ba){throw new Error(_0x4cf27c(0x1a8)+_0x2915ba['message']+'\x0a\x0aAI原始返回内容:\x0a'+_0x5ae64d);}_0x2217c2[_0x4cf27c(0xd9a)]=_0x254fe5,await _0xb81d4e[_0x4cf27c(0x1027)]['put'](_0x2217c2),await _0x1af5d9();}catch(_0x26ce32){console[_0x4cf27c(0xe3b)]('生成模拟相册失败:',_0x26ce32),await _0x1519c8(_0x4cf27c(0xebe),_0x4cf27c(0x1221)+_0x26ce32['message']);}}async function _0x1af5d9(){const _0x4aeaa8=_0x85c4bf,_0xffec19=document[_0x4aeaa8(0x479)](_0x4aeaa8(0x8b2));_0xffec19[_0x4aeaa8(0x3de)]='';if(!_0x509091)return;const _0xfdf3e8=_0x505390['chats'][_0x509091],_0x34fb5f=_0xfdf3e8[_0x4aeaa8(0xd9a)]||[];if(_0x34fb5f[_0x4aeaa8(0x990)]===0x0){_0xffec19[_0x4aeaa8(0x3de)]=_0x4aeaa8(0x935);return;}const _0x3a9788=_0x4aeaa8(0x775);_0x34fb5f['forEach'](_0x38daa3=>{const _0x2c8860=_0x4aeaa8,_0x4c5edd=document[_0x2c8860(0xbd5)]('div');_0x4c5edd[_0x2c8860(0xfd4)]=_0x2c8860(0x666),_0x4c5edd[_0x2c8860(0x13d4)]['description']=_0x38daa3['description'],_0xffec19[_0x2c8860(0x9f4)](_0x4c5edd);if(_0x505390[_0x2c8860(0x888)]['enableAiDrawing']){_0x4c5edd['style'][_0x2c8860(0x11a6)]='#e9ecef';const _0x426fcb=/[^\x00-\x7F]/[_0x2c8860(0x101d)](_0x38daa3['image_prompt']),_0x32c92a=_0x38daa3['image_prompt']&&_0x38daa3['image_prompt']['trim']()&&!_0x426fcb,_0x19cabd=_0x32c92a?_0x38daa3[_0x2c8860(0xfb2)]:_0x2c8860(0xc0b),_0x38391f=_0x2c8860(0x730)+encodeURIComponent(_0x19cabd),_0x4f6746=new Image();_0x4f6746['onload']=function(){const _0x412804=_0x2c8860;_0x4c5edd['style'][_0x412804(0x13b9)]=_0x412804(0x10d2)+this[_0x412804(0xa9c)]+')';},_0x4f6746['onerror']=function(){const _0x184d12=_0x2c8860;_0x4c5edd[_0x184d12(0x10dd)]['backgroundImage']='url('+_0x3a9788+')';},_0x4f6746[_0x2c8860(0xa9c)]=_0x38391f;}else{_0x4c5edd['style'][_0x2c8860(0x11a6)]=_0x2c8860(0x1389),_0x4c5edd['style'][_0x2c8860(0x599)]=_0x2c8860(0x516);const _0x325372=document[_0x2c8860(0xbd5)]('p');_0x325372[_0x2c8860(0xfd4)]=_0x2c8860(0x923),_0x325372[_0x2c8860(0x97b)]=_0x38daa3[_0x2c8860(0x78b)]||_0x2c8860(0xae3),_0x4c5edd[_0x2c8860(0x9f4)](_0x325372);}});}async function _0x5b18de(){const _0x4ed7d8=_0x85c4bf;if(!_0x509091)return;const _0x2584cf=_0x505390[_0x4ed7d8(0x1027)][_0x509091];if(!_0x2584cf)return;await _0x1519c8(_0x4ed7d8(0xbd7),_0x4ed7d8(0x5ad)+_0x2584cf[_0x4ed7d8(0x564)]+'”的网上冲浪足迹...');const {proxyUrl:_0x2971a5,apiKey:_0x2e145b,model:_0x221be9}=_0x505390[_0x4ed7d8(0x30c)];if(!_0x2971a5||!_0x2e145b||!_0x221be9){alert(_0x4ed7d8(0x7bd));return;}const _0x5191b7=_0x505390['qzoneSettings']['nickname']==='{{user}}'||!_0x505390[_0x4ed7d8(0x1190)][_0x4ed7d8(0x904)]?'用户':_0x505390[_0x4ed7d8(0x1190)][_0x4ed7d8(0x904)],_0xdd7fcc=_0x2584cf[_0x4ed7d8(0x3b4)]&&_0x2584cf[_0x4ed7d8(0x3b4)]['length']>0x0?_0x2584cf[_0x4ed7d8(0x3b4)][_0x4ed7d8(0x2e1)](_0x48a628=>_0x4ed7d8(0x619)+_0x3e14b1(_0x48a628['timestamp'])+')\x20'+_0x48a628[_0x4ed7d8(0xac4)])[_0x4ed7d8(0x35d)]('\x0a'):'无',_0x2f9fd1=_0x2584cf['settings'][_0x4ed7d8(0x2c6)]||0xa,_0x21081d=_0x2584cf[_0x4ed7d8(0x7d3)][_0x4ed7d8(0x777)](-_0x2f9fd1)[_0x4ed7d8(0x2e1)](_0x213a3d=>(_0x213a3d[_0x4ed7d8(0x508)]===_0x4ed7d8(0x4c5)?_0x5191b7:_0x2584cf[_0x4ed7d8(0x564)])+':\x20'+String(_0x213a3d[_0x4ed7d8(0xac4)])['substring'](0x0,0x1e)+_0x4ed7d8(0x4d0))[_0x4ed7d8(0x35d)]('\x0a'),_0x5dad74=(_0x2584cf[_0x4ed7d8(0x18a)][_0x4ed7d8(0x13da)]||[])[_0x4ed7d8(0x2e1)](_0x1a02db=>_0x505390[_0x4ed7d8(0xd1b)][_0x4ed7d8(0xc0d)](_0x260154=>_0x260154['id']===_0x1a02db))[_0x4ed7d8(0x85d)](Boolean)['map'](_0x4a150f=>'\x0a##\x20世界书《'+_0x4a150f[_0x4ed7d8(0x564)]+_0x4ed7d8(0x8b4)+_0x4a150f[_0x4ed7d8(0xac4)][_0x4ed7d8(0x85d)](_0x720fb7=>_0x720fb7['enabled'])[_0x4ed7d8(0x2e1)](_0x3162fc=>'-\x20'+_0x3162fc[_0x4ed7d8(0xac4)])[_0x4ed7d8(0x35d)]('\x0a'))[_0x4ed7d8(0x35d)](''),_0x2201b1=_0x37bdc8(_0x2584cf,0x3,_0x4ed7d8(0x129d)),_0x5d93ea=_0x37bdc8(_0x2584cf,0x6,'hours'),_0x235e46=_0x37bdc8(_0x2584cf,0x9,_0x4ed7d8(0x129d)),_0x23e2d7=_0x37bdc8(_0x2584cf,0x1,_0x4ed7d8(0x111c)),_0x5e1407=_0x37bdc8(_0x2584cf,0x3,'days'),_0x171a4f=_0x37bdc8(_0x2584cf,0x7,_0x4ed7d8(0x111c));let _0x4cf6fc='';if(_0x2201b1||_0x5d93ea||_0x235e46||_0x23e2d7||_0x5e1407||_0x171a4f){_0x4cf6fc+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x2201b1)_0x4cf6fc+=_0x2201b1;if(_0x5d93ea)_0x4cf6fc+=_0x5d93ea;if(_0x235e46)_0x4cf6fc+=_0x235e46;if(_0x2201b1||_0x5d93ea||_0x235e46)_0x4cf6fc+='\x0a';if(_0x23e2d7)_0x4cf6fc+=_0x23e2d7;if(_0x5e1407)_0x4cf6fc+=_0x5e1407;if(_0x171a4f)_0x4cf6fc+=_0x171a4f;}const _0x1dc82c=_0x4ed7d8(0x473)+_0x2584cf['name']+_0x4ed7d8(0x1228)+_0x2584cf['settings']['aiPersona']+_0x4ed7d8(0x8ba)+_0xdd7fcc+'\x0a'+_0x5dad74+'\x0a'+_0x4cf6fc+_0x4ed7d8(0x1135)+_0x5191b7+_0x4ed7d8(0xc46)+_0x21081d+'\x0a\x0a现在，请开始生成这组【纯文本】的浏览记录。';try{const _0x118ea5=[{'role':_0x4ed7d8(0x4c5),'content':_0x4ed7d8(0xa61)}];let _0x25cc2a=_0x2971a5[_0x4ed7d8(0x44f)](_0x4ed7d8(0x136f)),_0x3001bc=_0x19a701(_0x221be9,_0x2e145b,_0x1dc82c,_0x118ea5);const _0x1ea483=_0x25cc2a?await fetch(_0x3001bc[_0x4ed7d8(0x5f3)],_0x3001bc['data']):await fetch(_0x2971a5+_0x4ed7d8(0x347),{'method':_0x4ed7d8(0xba0),'headers':{'Content-Type':_0x4ed7d8(0xcb5),'Authorization':_0x4ed7d8(0xb27)+_0x2e145b},'body':JSON['stringify']({'model':_0x221be9,'messages':[{'role':_0x4ed7d8(0xbaa),'content':_0x1dc82c},..._0x118ea5],'temperature':_0x505390[_0x4ed7d8(0x888)][_0x4ed7d8(0x398)]||0.9})});if(!_0x1ea483['ok'])throw new Error(_0x4ed7d8(0xef2)+_0x1ea483[_0x4ed7d8(0xd4a)]);const _0x43d459=await _0x1ea483[_0x4ed7d8(0xfdf)](),_0x20b3b4=getGeminiResponseText(_0x43d459),_0x198cd8=_0x20b3b4[_0x4ed7d8(0xab4)](/(\[[\s\S]*\])/);if(!_0x198cd8||!_0x198cd8[0x0])throw new Error(_0x4ed7d8(0xe10)+_0x20b3b4);const _0x287e9e=_0x198cd8[0x0];let _0x4fe370;try{_0x4fe370=JSON[_0x4ed7d8(0x94c)](_0x287e9e);}catch(_0x58ab75){throw new Error('解析AI返回的JSON时出错:\x20'+_0x58ab75[_0x4ed7d8(0x757)]+_0x4ed7d8(0x124a)+_0x20b3b4);}_0x2584cf[_0x4ed7d8(0xe2a)]=_0x4fe370,await _0xb81d4e[_0x4ed7d8(0x1027)]['put'](_0x2584cf),await _0x5df82d();}catch(_0x540b95){console['error'](_0x4ed7d8(0x865),_0x540b95),await _0x1519c8(_0x4ed7d8(0xebe),_0x4ed7d8(0x66b)+_0x540b95['message']);}}function _0x5df82d(){const _0x5b792d=_0x85c4bf,_0x3d99f4=document[_0x5b792d(0x479)](_0x5b792d(0x323));_0x3d99f4[_0x5b792d(0x3de)]='';if(!_0x509091)return;const _0x4dd72b=_0x505390[_0x5b792d(0x1027)][_0x509091],_0xde6f65=_0x4dd72b[_0x5b792d(0xe2a)]||[];if(_0xde6f65['length']===0x0){_0x3d99f4['innerHTML']=_0x5b792d(0x103b);return;}_0xde6f65[_0x5b792d(0x12be)]((_0x17222a,_0x2ccace)=>{const _0x6daeac=_0x5b792d,_0x2f51db=document['createElement'](_0x6daeac(0x6c8));_0x2f51db[_0x6daeac(0xfd4)]='char-browser-item',_0x2f51db['innerHTML']=_0x6daeac(0xb23)+_0x17222a['title']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22url\x22>'+_0x17222a[_0x6daeac(0x5f3)]+_0x6daeac(0xeaa),_0x2f51db['addEventListener'](_0x6daeac(0xd2f),()=>_0x4fb7a3(_0x2ccace)),_0x3d99f4[_0x6daeac(0x9f4)](_0x2f51db);});}async function _0x4fb7a3(_0x16c4a0){const _0x1c0241=_0x85c4bf,_0x1fc54e=_0x505390[_0x1c0241(0x1027)][_0x509091],_0x1825a2=_0x1fc54e[_0x1c0241(0xe2a)][_0x16c4a0];if(!_0x1825a2)return;_0x17b93d=_0x1825a2,_0x251f96(_0x1825a2),_0x1c532a(_0x1c0241(0x225));const _0x1eec0c=document[_0x1c0241(0x479)](_0x1c0241(0xb14)),_0x353e72=await _0xb81d4e['favorites'][_0x1c0241(0x46f)]({'type':'char_browser_article','content.url':_0x1825a2[_0x1c0241(0x5f3)]})[_0x1c0241(0x64e)]();_0x1eec0c[_0x1c0241(0x9cd)][_0x1c0241(0x2bf)](_0x1c0241(0x5a9),!!_0x353e72);}async function _0x43f766(){const _0x511481=_0x85c4bf;if(!_0x17b93d||!_0x509091)return;const _0x2ee87c=_0x17b93d,_0x1aac73=_0x505390[_0x511481(0x1027)][_0x509091],_0xc07a12=document[_0x511481(0x479)]('favorite-article-btn'),_0x1b6db8=await _0xb81d4e[_0x511481(0x3e8)][_0x511481(0x46f)]({'type':_0x511481(0x5aa),'content.url':_0x2ee87c[_0x511481(0x5f3)]})[_0x511481(0x64e)]();if(_0x1b6db8)await _0xb81d4e['favorites'][_0x511481(0x1ea)](_0x1b6db8['id']),_0xc07a12[_0x511481(0x9cd)][_0x511481(0x8b6)]('active'),await _0x1519c8(_0x511481(0xa56),_0x511481(0x1b5));else{const _0x33edd3={'type':_0x511481(0x5aa),'content':{..._0x2ee87c,'characterId':_0x509091,'characterName':_0x1aac73[_0x511481(0x564)]},'timestamp':Date[_0x511481(0x12d6)]()};await _0xb81d4e['favorites'][_0x511481(0x807)](_0x33edd3),_0xc07a12[_0x511481(0x9cd)]['add']('active'),await _0x1519c8('操作成功',_0x511481(0x46a));}}function _0x251f96(_0x585795){const _0x505a0c=_0x85c4bf,_0xcfd53b=document[_0x505a0c(0x479)](_0x505a0c(0x10c0)),_0x4abdd0=document[_0x505a0c(0x479)](_0x505a0c(0x1045));_0xcfd53b[_0x505a0c(0x97b)]=_0x585795[_0x505a0c(0xc29)],_0x4abdd0[_0x505a0c(0x3de)]='',_0x585795[_0x505a0c(0x858)]===_0x505a0c(0x676)?_0x4abdd0[_0x505a0c(0x3de)]=_0x505a0c(0xc26)+(_0x585795[_0x505a0c(0xc29)]||'(无标题)')+_0x505a0c(0x1049):_0x4abdd0[_0x505a0c(0x3de)]=_0x505a0c(0x286)+(_0x585795['content']||_0x505a0c(0xb65))[_0x505a0c(0x491)](/\n/g,_0x505a0c(0x205))+_0x505a0c(0x1049);}async function _0x2176fb(){const _0x7082ff=_0x85c4bf;if(!_0x509091)return;const _0x53413b=_0x505390[_0x7082ff(0x1027)][_0x509091];if(!_0x53413b)return;await _0x1519c8('请稍候...','正在模拟“'+_0x53413b[_0x7082ff(0x564)]+'”的购物习惯...');const {proxyUrl:_0x276a82,apiKey:_0x11d4b4,model:_0x16a56b}=_0x505390[_0x7082ff(0x30c)];if(!_0x276a82||!_0x11d4b4||!_0x16a56b){alert(_0x7082ff(0x7bd));return;}const _0x437a8b=_0x505390[_0x7082ff(0x1190)][_0x7082ff(0x904)]===_0x7082ff(0x80e)||!_0x505390[_0x7082ff(0x1190)]['nickname']?'用户':_0x505390[_0x7082ff(0x1190)]['nickname'],_0xd157ec=_0x53413b[_0x7082ff(0x3b4)]&&_0x53413b[_0x7082ff(0x3b4)]['length']>0x0?_0x53413b[_0x7082ff(0x3b4)][_0x7082ff(0x2e1)](_0x300ca4=>_0x7082ff(0x619)+_0x3e14b1(_0x300ca4[_0x7082ff(0x12a2)])+')\x20'+_0x300ca4['content'])[_0x7082ff(0x35d)]('\x0a'):'无',_0x2c1f2e=_0x53413b[_0x7082ff(0x18a)]['maxMemory']||0xa,_0x21b79f=_0x53413b['history'][_0x7082ff(0x777)](-_0x2c1f2e)[_0x7082ff(0x2e1)](_0x463e64=>(_0x463e64[_0x7082ff(0x508)]===_0x7082ff(0x4c5)?_0x437a8b:_0x53413b[_0x7082ff(0x564)])+':\x20'+String(_0x463e64[_0x7082ff(0xac4)])[_0x7082ff(0x1323)](0x0,0x1e)+_0x7082ff(0x4d0))[_0x7082ff(0x35d)]('\x0a'),_0x21d3af=(_0x53413b[_0x7082ff(0x18a)][_0x7082ff(0x13da)]||[])[_0x7082ff(0x2e1)](_0x2d2bf7=>_0x505390[_0x7082ff(0xd1b)][_0x7082ff(0xc0d)](_0x145795=>_0x145795['id']===_0x2d2bf7))['filter'](Boolean)[_0x7082ff(0x2e1)](_0x3bcf89=>_0x7082ff(0x11d1)+_0x3bcf89[_0x7082ff(0x564)]+'》设定:\x0a'+_0x3bcf89[_0x7082ff(0xac4)][_0x7082ff(0x85d)](_0x57f2ef=>_0x57f2ef['enabled'])[_0x7082ff(0x2e1)](_0x3b5605=>'-\x20'+_0x3b5605[_0x7082ff(0xac4)])[_0x7082ff(0x35d)]('\x0a'))[_0x7082ff(0x35d)](''),_0xd740c1=_0x37bdc8(_0x53413b,0x3,_0x7082ff(0x129d)),_0x2358f5=_0x37bdc8(_0x53413b,0x6,_0x7082ff(0x129d)),_0x155bac=_0x37bdc8(_0x53413b,0x9,_0x7082ff(0x129d)),_0x33f533=_0x37bdc8(_0x53413b,0x1,_0x7082ff(0x111c)),_0x25fa3b=_0x37bdc8(_0x53413b,0x3,_0x7082ff(0x111c)),_0x357d64=_0x37bdc8(_0x53413b,0x7,_0x7082ff(0x111c));let _0xd51f0a='';if(_0xd740c1||_0x2358f5||_0x155bac||_0x33f533||_0x25fa3b||_0x357d64){_0xd51f0a+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0xd740c1)_0xd51f0a+=_0xd740c1;if(_0x2358f5)_0xd51f0a+=_0x2358f5;if(_0x155bac)_0xd51f0a+=_0x155bac;if(_0xd740c1||_0x2358f5||_0x155bac)_0xd51f0a+='\x0a';if(_0x33f533)_0xd51f0a+=_0x33f533;if(_0x25fa3b)_0xd51f0a+=_0x25fa3b;if(_0x357d64)_0xd51f0a+=_0x357d64;}const _0x15f345=_0x7082ff(0x473)+_0x53413b[_0x7082ff(0x564)]+'”，并根据其人设、记忆和最近的互动，虚构出TA最近的淘宝购物记录和账户余额。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**余额铁律\x20(最高优先级)**:\x20你【必须】根据角色的【经济状况】设定一个合理的\x20`totalBalance`\x20(总余额)。例如，富有的角色应该有更高的余额，而学生或经济拮据的角色则应该有较低的余额。\x0a2.\x20\x20**合理性**:\x20购买记录必须完全符合角色的性格、爱好和经济状况。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个【单一的JSON对象】。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`{`\x20开始，并以\x20`}`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记。\x0a\x20\x20\x20\x20-\x20格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22totalBalance\x22:\x2012345.67,\x20//\x20(这是一个示例数字，你必须根据角色的经济状况生成一个全新的、合理的余额！)\x0a\x20\x20\x20\x20\x20\x20\x22purchases\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22itemName\x22:\x20\x22一个具体、生动的商品名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22price\x22:\x20128.80,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22status\x22:\x20\x22已签收\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22reason\x22:\x20\x22这是角色购买这件商品的内心独白或理由，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这张商品图片的、详细的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**purchases**:\x20一个包含12到15个商品对象的数组。\x0a\x20\x20\x20\x20-\x20**status\x20(订单状态)**:\x20只能从\x20\x22已签收\x22,\x20\x22待发货\x22,\x20\x22运输中\x22,\x20\x22待评价\x22\x20中选择。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0x53413b[_0x7082ff(0x18a)][_0x7082ff(0x11f6)]+_0x7082ff(0x8ba)+_0xd157ec+'\x0a'+_0x21d3af+'\x0a'+_0xd51f0a+_0x7082ff(0x1135)+_0x437a8b+_0x7082ff(0xc46)+_0x21b79f+_0x7082ff(0x1375);try{const _0x2dd387=[{'role':_0x7082ff(0x4c5),'content':_0x7082ff(0x6a5)}];let _0x54ce61=_0x276a82[_0x7082ff(0x44f)](_0x7082ff(0x136f)),_0x4d67d2=_0x19a701(_0x16a56b,_0x11d4b4,_0x15f345,_0x2dd387);const _0x4e49e9=_0x54ce61?await fetch(_0x4d67d2[_0x7082ff(0x5f3)],_0x4d67d2[_0x7082ff(0x104c)]):await fetch(_0x276a82+_0x7082ff(0x347),{'method':'POST','headers':{'Content-Type':_0x7082ff(0xcb5),'Authorization':_0x7082ff(0xb27)+_0x11d4b4},'body':JSON[_0x7082ff(0x1308)]({'model':_0x16a56b,'messages':[{'role':'system','content':_0x15f345},..._0x2dd387],'temperature':_0x505390[_0x7082ff(0x888)][_0x7082ff(0x398)]||0.9})});if(!_0x4e49e9['ok'])throw new Error('API\x20错误:\x20'+_0x4e49e9[_0x7082ff(0xd4a)]);const _0x2221d5=await _0x4e49e9['json'](),_0x264ee9=getGeminiResponseText(_0x2221d5),_0x51c35f=_0x264ee9[_0x7082ff(0xab4)](/({[\s\S]*})/);if(!_0x51c35f)throw new Error('AI返回的内容中未找到有效的JSON对象。');const _0x3e4987=JSON['parse'](_0x51c35f[0x0]);!_0x3e4987[_0x7082ff(0x113b)]&&(_0x3e4987[_0x7082ff(0x113b)]=[]),_0x53413b[_0x7082ff(0x442)]=_0x3e4987,await _0xb81d4e[_0x7082ff(0x1027)][_0x7082ff(0x5d0)](_0x53413b),await _0x29fa6a();}catch(_0xcdbf77){console[_0x7082ff(0xe3b)](_0x7082ff(0x27a),_0xcdbf77),await _0x1519c8(_0x7082ff(0xebe),'无法生成购物记录，请检查API配置或稍后再试。\x0a错误:\x20'+_0xcdbf77[_0x7082ff(0x757)]);}}function _0x366d5d(){const _0x510e17=_0x85c4bf;_0x2bef70(),_0x1c532a(_0x510e17(0x495));}function _0x2bef70(){const _0x271ac9=_0x85c4bf,_0x36e560=document[_0x271ac9(0x479)](_0x271ac9(0x1024));_0x36e560[_0x271ac9(0x3de)]='';const _0x53bbc8=_0x505390['chats'][_0x509091],_0x1bb092=_0x53bbc8[_0x271ac9(0x442)]||{},_0x3fd45a=_0x1bb092['purchases']||[],_0x372713=_0x1bb092['totalBalance']||0x0,_0xbbddfc=document[_0x271ac9(0xbd5)](_0x271ac9(0x6c8));_0xbbddfc[_0x271ac9(0x10dd)][_0x271ac9(0x506)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#fff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.06);\x0a\x20\x20\x20\x20',_0xbbddfc['innerHTML']=_0x271ac9(0xe0d)+_0x372713[_0x271ac9(0x6e1)](0x2)+_0x271ac9(0x82b),_0x36e560[_0x271ac9(0x9f4)](_0xbbddfc);const _0x344a04=document[_0x271ac9(0xbd5)]('h3');_0x344a04['textContent']=_0x271ac9(0xfa7),_0x344a04[_0x271ac9(0x10dd)][_0x271ac9(0x506)]='font-size:\x2016px;\x20color:\x20#555;\x20margin-bottom:\x2010px;',_0x36e560['appendChild'](_0x344a04);if(_0x3fd45a[_0x271ac9(0x990)]===0x0){_0x36e560['innerHTML']+=_0x271ac9(0x524);return;}_0x3fd45a[_0x271ac9(0x12be)](_0xb64092=>{const _0x2ac577=_0x271ac9,_0x14b9bd=document[_0x2ac577(0xbd5)]('div');_0x14b9bd['style']['cssText']=_0x2ac577(0xd33),_0x14b9bd[_0x2ac577(0x3de)]=_0x2ac577(0x8c2)+_0xb64092['itemName']+_0x2ac577(0x13ac)+_0xb64092[_0x2ac577(0x93c)]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-weight:\x20600;\x20font-size:\x2016px;\x20color:\x20#ff5722;\x22>-\x20¥'+(_0xb64092[_0x2ac577(0x9ce)]||0x0)[_0x2ac577(0x6e1)](0x2)+_0x2ac577(0xeaa),_0x36e560['appendChild'](_0x14b9bd);});}async function _0x1de531(){const _0x49365b=_0x85c4bf;if(!_0x509091)return;const _0x407585=_0x505390[_0x49365b(0x1027)][_0x509091];if(!_0x407585)return;await _0x1519c8(_0x49365b(0xbd7),_0x49365b(0xb29)+_0x407585[_0x49365b(0x564)]+_0x49365b(0xd1e));const {proxyUrl:_0x1b0766,apiKey:_0x5aa6d5,model:_0x2e816b}=_0x505390[_0x49365b(0x30c)];if(!_0x1b0766||!_0x5aa6d5||!_0x2e816b){alert(_0x49365b(0x9f1));return;}const _0x2f8bbb=_0x505390[_0x49365b(0x1190)][_0x49365b(0x904)]==='{{user}}'||!_0x505390[_0x49365b(0x1190)][_0x49365b(0x904)]?'用户':_0x505390['qzoneSettings'][_0x49365b(0x904)],_0x36075a=_0x407585[_0x49365b(0x3b4)]&&_0x407585['longTermMemory'][_0x49365b(0x990)]>0x0?_0x407585[_0x49365b(0x3b4)][_0x49365b(0x2e1)](_0x1cf4bd=>_0x49365b(0x619)+_0x3e14b1(_0x1cf4bd[_0x49365b(0x12a2)])+')\x20'+_0x1cf4bd['content'])['join']('\x0a'):'无',_0x909bad=_0x407585[_0x49365b(0x18a)][_0x49365b(0x2c6)]||0xa,_0x78e9e3=_0x407585[_0x49365b(0x7d3)][_0x49365b(0x777)](-_0x909bad)[_0x49365b(0x2e1)](_0x1113bb=>(_0x1113bb[_0x49365b(0x508)]===_0x49365b(0x4c5)?_0x2f8bbb:_0x407585[_0x49365b(0x564)])+':\x20'+String(_0x1113bb[_0x49365b(0xac4)])['substring'](0x0,0x1e)+_0x49365b(0x4d0))[_0x49365b(0x35d)]('\x0a'),_0x1c37a8=(_0x407585['settings'][_0x49365b(0x13da)]||[])[_0x49365b(0x2e1)](_0x266ba9=>_0x505390[_0x49365b(0xd1b)][_0x49365b(0xc0d)](_0x16a5bd=>_0x16a5bd['id']===_0x266ba9))[_0x49365b(0x85d)](Boolean)['map'](_0x7ec39a=>_0x49365b(0x11d1)+_0x7ec39a[_0x49365b(0x564)]+_0x49365b(0x8b4)+_0x7ec39a['content']['filter'](_0x42ed33=>_0x42ed33[_0x49365b(0x2b7)])['map'](_0x57166e=>'-\x20'+_0x57166e['content'])['join']('\x0a'))[_0x49365b(0x35d)](''),_0x756f5d=_0x37bdc8(_0x407585,0x3,_0x49365b(0x129d)),_0x5467ff=_0x37bdc8(_0x407585,0x6,_0x49365b(0x129d)),_0x51ebfe=_0x37bdc8(_0x407585,0x9,_0x49365b(0x129d)),_0x143178=_0x37bdc8(_0x407585,0x1,_0x49365b(0x111c)),_0x2b1551=_0x37bdc8(_0x407585,0x3,_0x49365b(0x111c)),_0xa47486=_0x37bdc8(_0x407585,0x7,_0x49365b(0x111c));let _0x27ef1b='';if(_0x756f5d||_0x5467ff||_0x51ebfe||_0x143178||_0x2b1551||_0xa47486){_0x27ef1b+=_0x49365b(0x670);if(_0x756f5d)_0x27ef1b+=_0x756f5d;if(_0x5467ff)_0x27ef1b+=_0x5467ff;if(_0x51ebfe)_0x27ef1b+=_0x51ebfe;if(_0x756f5d||_0x5467ff||_0x51ebfe)_0x27ef1b+='\x0a';if(_0x143178)_0x27ef1b+=_0x143178;if(_0x2b1551)_0x27ef1b+=_0x2b1551;if(_0xa47486)_0x27ef1b+=_0xa47486;}const _0x4d69bb=_0x49365b(0x473)+_0x407585[_0x49365b(0x564)]+'”，并根据其人设、记忆和最近的互动，虚构出【12到20条】TA最近可能会写在手机备忘录里的内容。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20备忘录内容必须完全符合角色的性格、爱好、职业和生活环境。可以是购物清单、待办事项、灵感片段、一些随笔和感悟、草稿等。\x0a2.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一条备忘录，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22备忘录的标题，例如：购物清单\x20或\x20周末计划\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22备忘录的详细内容，必须支持换行符\x5cn。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0x407585['settings'][_0x49365b(0x11f6)]+_0x49365b(0x8ba)+_0x36075a+'\x0a'+_0x1c37a8+'\x0a'+_0x27ef1b+_0x49365b(0xe1f)+_0x2f8bbb+_0x49365b(0xc46)+_0x78e9e3+_0x49365b(0x5ab);try{const _0x1fb102=[{'role':_0x49365b(0x4c5),'content':_0x49365b(0xa9a)}];let _0x5e5c0b=_0x1b0766[_0x49365b(0x44f)](_0x49365b(0x136f)),_0x4c14c7=_0x19a701(_0x2e816b,_0x5aa6d5,_0x4d69bb,_0x1fb102);const _0x26e753=_0x5e5c0b?await fetch(_0x4c14c7[_0x49365b(0x5f3)],_0x4c14c7['data']):await fetch(_0x1b0766+'/v1/chat/completions',{'method':_0x49365b(0xba0),'headers':{'Content-Type':_0x49365b(0xcb5),'Authorization':'Bearer\x20'+_0x5aa6d5},'body':JSON[_0x49365b(0x1308)]({'model':_0x2e816b,'messages':[{'role':_0x49365b(0xbaa),'content':_0x4d69bb},..._0x1fb102],'temperature':_0x505390[_0x49365b(0x888)]['apiTemperature']||0.9})});if(!_0x26e753['ok']){const _0x447d58=await _0x26e753[_0x49365b(0xfdf)]()['catch'](()=>null),_0x17a837=_0x447d58?.['error']?.[_0x49365b(0x757)]||_0x26e753['statusText'];throw new Error('API\x20错误:\x20'+_0x26e753[_0x49365b(0x93c)]+_0x49365b(0x501)+_0x17a837);}const _0x2a5565=await _0x26e753[_0x49365b(0xfdf)](),_0x159cba=getGeminiResponseText(_0x2a5565),_0x4a0d12=_0x159cba[_0x49365b(0xab4)](/(\[[\s\S]*\])/);if(!_0x4a0d12||!_0x4a0d12[0x0])throw new Error(_0x49365b(0xe10)+_0x159cba);const _0x371382=_0x4a0d12[0x0];let _0x22eb02;try{_0x22eb02=JSON[_0x49365b(0x94c)](_0x371382);}catch(_0x543085){throw new Error(_0x49365b(0x1a8)+_0x543085['message']+_0x49365b(0x124a)+_0x159cba);}if(!Array[_0x49365b(0x285)](_0x22eb02))throw new Error(_0x49365b(0x1261)+JSON[_0x49365b(0x1308)](_0x22eb02));_0x407585[_0x49365b(0x1325)]=_0x22eb02['map'](_0x46d71b=>({'id':Date['now']()+Math[_0x49365b(0x103a)](),'title':_0x46d71b['title'],'content':_0x46d71b[_0x49365b(0xac4)]})),await _0xb81d4e['chats'][_0x49365b(0x5d0)](_0x407585),await _0x38c237();}catch(_0x5aef14){console['error'](_0x49365b(0xb4b),_0x5aef14),await _0x1519c8('生成失败',_0x49365b(0x1114)+_0x5aef14[_0x49365b(0x757)]);}}async function _0x4e20ea(){const _0x5ed130=_0x85c4bf;if(!_0x509091)return;const _0x13f648=_0x505390[_0x5ed130(0x1027)][_0x509091];if(!_0x13f648)return;await _0x1519c8(_0x5ed130(0xbd7),_0x5ed130(0x68e)+_0x13f648[_0x5ed130(0x564)]+'”的出行足迹...');const {proxyUrl:_0x1939d5,apiKey:_0x5bbadd,model:_0x3fd2fd}=_0x505390[_0x5ed130(0x30c)];if(!_0x1939d5||!_0x5bbadd||!_0x3fd2fd){alert('API未配置，无法生成内容。');return;}const _0x2ca064=_0x505390[_0x5ed130(0x1190)]['nickname']===_0x5ed130(0x80e)||!_0x505390[_0x5ed130(0x1190)]['nickname']?'用户':_0x505390['qzoneSettings'][_0x5ed130(0x904)],_0x1dc6fa=_0x13f648[_0x5ed130(0x3b4)]&&_0x13f648[_0x5ed130(0x3b4)][_0x5ed130(0x990)]>0x0?_0x13f648[_0x5ed130(0x3b4)][_0x5ed130(0x2e1)](_0x3c24bf=>'-\x20(记录于\x20'+_0x3e14b1(_0x3c24bf[_0x5ed130(0x12a2)])+')\x20'+_0x3c24bf[_0x5ed130(0xac4)])[_0x5ed130(0x35d)]('\x0a'):'无',_0x28a4e9=_0x13f648['settings'][_0x5ed130(0x2c6)]||0xa,_0x48e1ed=_0x13f648[_0x5ed130(0x7d3)][_0x5ed130(0x777)](-_0x28a4e9)[_0x5ed130(0x2e1)](_0x323dbf=>(_0x323dbf[_0x5ed130(0x508)]===_0x5ed130(0x4c5)?_0x2ca064:_0x13f648[_0x5ed130(0x564)])+':\x20'+String(_0x323dbf[_0x5ed130(0xac4)])[_0x5ed130(0x1323)](0x0,0x1e)+_0x5ed130(0x4d0))[_0x5ed130(0x35d)]('\x0a'),_0xf7d54=(_0x13f648[_0x5ed130(0x18a)][_0x5ed130(0x13da)]||[])['map'](_0x3c4745=>_0x505390[_0x5ed130(0xd1b)][_0x5ed130(0xc0d)](_0x517213=>_0x517213['id']===_0x3c4745))[_0x5ed130(0x85d)](Boolean)[_0x5ed130(0x2e1)](_0x4ebaa0=>'\x0a##\x20世界书《'+_0x4ebaa0['name']+_0x5ed130(0x8b4)+_0x4ebaa0[_0x5ed130(0xac4)][_0x5ed130(0x85d)](_0x1c39cd=>_0x1c39cd[_0x5ed130(0x2b7)])[_0x5ed130(0x2e1)](_0x2a8ea2=>'-\x20'+_0x2a8ea2[_0x5ed130(0xac4)])['join']('\x0a'))[_0x5ed130(0x35d)](''),_0x1af44e=_0x37bdc8(_0x13f648,0x3,_0x5ed130(0x129d)),_0x511dc4=_0x37bdc8(_0x13f648,0x6,_0x5ed130(0x129d)),_0x1797d2=_0x37bdc8(_0x13f648,0x9,'hours'),_0xf6caf0=_0x37bdc8(_0x13f648,0x1,'days'),_0x562d7e=_0x37bdc8(_0x13f648,0x3,'days'),_0xeb802=_0x37bdc8(_0x13f648,0x7,_0x5ed130(0x111c));let _0x304668='';if(_0x1af44e||_0x511dc4||_0x1797d2||_0xf6caf0||_0x562d7e||_0xeb802){_0x304668+=_0x5ed130(0x670);if(_0x1af44e)_0x304668+=_0x1af44e;if(_0x511dc4)_0x304668+=_0x511dc4;if(_0x1797d2)_0x304668+=_0x1797d2;if(_0x1af44e||_0x511dc4||_0x1797d2)_0x304668+='\x0a';if(_0xf6caf0)_0x304668+=_0xf6caf0;if(_0x562d7e)_0x304668+=_0x562d7e;if(_0xeb802)_0x304668+=_0xeb802;}const _0x24b6b3=_0x5ed130(0x473)+_0x13f648[_0x5ed130(0x564)]+_0x5ed130(0xc4e)+new Date()['toISOString']()+_0x5ed130(0x7d0)+_0x13f648[_0x5ed130(0x18a)][_0x5ed130(0x11f6)]+_0x5ed130(0x8ba)+_0x1dc6fa+'\x0a'+_0xf7d54+'\x0a'+_0x304668+'\x0a-\x20**你最近和“'+_0x2ca064+_0x5ed130(0xc46)+_0x48e1ed+_0x5ed130(0x5a7);try{const _0x71d992=[{'role':_0x5ed130(0x4c5),'content':'请根据你的设定，生成你的高德地图足迹。'}];let _0x1aa2a7=_0x1939d5['includes'](_0x5ed130(0x136f)),_0x2ace68=_0x19a701(_0x3fd2fd,_0x5bbadd,_0x24b6b3,_0x71d992);const _0xe5dfd3=_0x1aa2a7?await fetch(_0x2ace68[_0x5ed130(0x5f3)],_0x2ace68[_0x5ed130(0x104c)]):await fetch(_0x1939d5+'/v1/chat/completions',{'method':_0x5ed130(0xba0),'headers':{'Content-Type':_0x5ed130(0xcb5),'Authorization':_0x5ed130(0xb27)+_0x5bbadd},'body':JSON['stringify']({'model':_0x3fd2fd,'messages':[{'role':'system','content':_0x24b6b3},..._0x71d992],'temperature':_0x505390['globalSettings'][_0x5ed130(0x398)]||0.9})});if(!_0xe5dfd3['ok'])throw new Error(_0x5ed130(0xef2)+_0xe5dfd3[_0x5ed130(0xd4a)]);const _0x4e9abd=await _0xe5dfd3['json'](),_0x45cc2a=getGeminiResponseText(_0x4e9abd),_0x5b309f=_0x45cc2a[_0x5ed130(0xab4)](/(\[[\s\S]*\])/);if(!_0x5b309f||!_0x5b309f[0x0])throw new Error(_0x5ed130(0xe10)+_0x45cc2a);const _0x874ebd=_0x5b309f[0x0];let _0x2925d9;try{_0x2925d9=JSON[_0x5ed130(0x94c)](_0x874ebd);}catch(_0x2eed7d){throw new Error(_0x5ed130(0x1a8)+_0x2eed7d[_0x5ed130(0x757)]+_0x5ed130(0x124a)+_0x45cc2a);}_0x13f648[_0x5ed130(0x551)]=_0x2925d9,await _0xb81d4e['chats'][_0x5ed130(0x5d0)](_0x13f648),await _0x323093();}catch(_0x3f2d65){console[_0x5ed130(0xe3b)](_0x5ed130(0xa07),_0x3f2d65),await _0x1519c8(_0x5ed130(0xebe),_0x5ed130(0xa2d)+_0x3f2d65['message']);}}function _0x323093(){const _0x64a6b8=_0x85c4bf,_0x575d6a=document['getElementById'](_0x64a6b8(0x89b));_0x575d6a[_0x64a6b8(0x3de)]='';if(!_0x509091)return;const _0x310c0e=_0x505390[_0x64a6b8(0x1027)][_0x509091],_0x5513e2=_0x310c0e[_0x64a6b8(0x551)]||[];if(_0x5513e2['length']===0x0){_0x575d6a[_0x64a6b8(0x3de)]=_0x64a6b8(0xb5a);return;}_0x5513e2[_0x64a6b8(0x12be)](_0x2e5935=>{const _0xc0d9b5=_0x64a6b8,_0x28fc8b=document[_0xc0d9b5(0xbd5)](_0xc0d9b5(0x6c8));_0x28fc8b[_0xc0d9b5(0xfd4)]=_0xc0d9b5(0x1385);let _0x1739f8='';if(_0x2e5935[_0xc0d9b5(0xfb2)]){const _0x43c38=_0xc0d9b5(0x730)+encodeURIComponent(_0x2e5935[_0xc0d9b5(0xfb2)]);_0x1739f8=_0xc0d9b5(0xd4c)+_0x43c38+_0xc0d9b5(0x13ab)+_0x2e5935[_0xc0d9b5(0xd6c)]+_0xc0d9b5(0xd5b);}const _0x1f40d2=_0x2e5935[_0xc0d9b5(0x12a2)]?_0x3e14b1(new Date(_0x2e5935[_0xc0d9b5(0x12a2)])[_0xc0d9b5(0xd2b)]()):'某个时间';_0x28fc8b[_0xc0d9b5(0x3de)]=_0xc0d9b5(0x5e8)+_0x2e5935[_0xc0d9b5(0x1154)]+_0xc0d9b5(0xc20)+_0x2e5935['address']+_0xc0d9b5(0x13e7)+_0x2e5935[_0xc0d9b5(0xd6c)][_0xc0d9b5(0x491)](/\n/g,'<br>')+_0xc0d9b5(0x50f)+_0x1739f8+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-footer\x22>'+_0x1f40d2+_0xc0d9b5(0x836),_0x575d6a[_0xc0d9b5(0x9f4)](_0x28fc8b);});}async function _0x576f1c(){const _0x1f371d=_0x85c4bf;if(!_0x509091)return;const _0x7b3543=_0x505390['chats'][_0x509091];if(!_0x7b3543)return;await _0x1519c8(_0x1f371d(0xbd7),_0x1f371d(0x13cb)+_0x7b3543[_0x1f371d(0x564)]+'”的手机使用习惯...');const {proxyUrl:_0x2ffe7b,apiKey:_0x5626a3,model:_0x1f5c49}=_0x505390[_0x1f371d(0x30c)];if(!_0x2ffe7b||!_0x5626a3||!_0x1f5c49){alert('API未配置，无法生成内容。');return;}const _0x19a618=_0x505390[_0x1f371d(0x1190)][_0x1f371d(0x904)]===_0x1f371d(0x80e)||!_0x505390[_0x1f371d(0x1190)][_0x1f371d(0x904)]?'用户':_0x505390[_0x1f371d(0x1190)][_0x1f371d(0x904)],_0x4934cf=_0x7b3543[_0x1f371d(0x3b4)]&&_0x7b3543['longTermMemory'][_0x1f371d(0x990)]>0x0?_0x7b3543[_0x1f371d(0x3b4)]['map'](_0x37dbaa=>_0x1f371d(0x619)+_0x3e14b1(_0x37dbaa[_0x1f371d(0x12a2)])+')\x20'+_0x37dbaa['content'])[_0x1f371d(0x35d)]('\x0a'):'无',_0x1f3f3c=_0x7b3543['settings'][_0x1f371d(0x2c6)]||0xa,_0x1f7072=_0x7b3543[_0x1f371d(0x7d3)][_0x1f371d(0x777)](-_0x1f3f3c)['map'](_0x9f0787=>(_0x9f0787[_0x1f371d(0x508)]==='user'?_0x19a618:_0x7b3543[_0x1f371d(0x564)])+':\x20'+String(_0x9f0787[_0x1f371d(0xac4)])[_0x1f371d(0x1323)](0x0,0x1e)+_0x1f371d(0x4d0))[_0x1f371d(0x35d)]('\x0a'),_0x5e601e=(_0x7b3543[_0x1f371d(0x18a)][_0x1f371d(0x13da)]||[])[_0x1f371d(0x2e1)](_0xdc9d57=>_0x505390[_0x1f371d(0xd1b)][_0x1f371d(0xc0d)](_0x4a0a10=>_0x4a0a10['id']===_0xdc9d57))[_0x1f371d(0x85d)](Boolean)['map'](_0x2f4194=>_0x1f371d(0x11d1)+_0x2f4194[_0x1f371d(0x564)]+_0x1f371d(0x8b4)+_0x2f4194[_0x1f371d(0xac4)][_0x1f371d(0x85d)](_0x44138a=>_0x44138a[_0x1f371d(0x2b7)])[_0x1f371d(0x2e1)](_0x43fc1c=>'-\x20'+_0x43fc1c[_0x1f371d(0xac4)])[_0x1f371d(0x35d)]('\x0a'))['join'](''),_0x4eb263=_0x37bdc8(_0x7b3543,0x3,'hours'),_0x200107=_0x37bdc8(_0x7b3543,0x6,_0x1f371d(0x129d)),_0x4023e0=_0x37bdc8(_0x7b3543,0x9,'hours'),_0x54aab2=_0x37bdc8(_0x7b3543,0x1,'days'),_0x5ad8f4=_0x37bdc8(_0x7b3543,0x3,_0x1f371d(0x111c)),_0x5c53ad=_0x37bdc8(_0x7b3543,0x7,'days');let _0x418a3b='';if(_0x4eb263||_0x200107||_0x4023e0||_0x54aab2||_0x5ad8f4||_0x5c53ad){_0x418a3b+=_0x1f371d(0x670);if(_0x4eb263)_0x418a3b+=_0x4eb263;if(_0x200107)_0x418a3b+=_0x200107;if(_0x4023e0)_0x418a3b+=_0x4023e0;if(_0x4eb263||_0x200107||_0x4023e0)_0x418a3b+='\x0a';if(_0x54aab2)_0x418a3b+=_0x54aab2;if(_0x5ad8f4)_0x418a3b+=_0x5ad8f4;if(_0x5c53ad)_0x418a3b+=_0x5c53ad;}const _0x549b25=_0x1f371d(0x473)+_0x7b3543['name']+_0x1f371d(0xe5e)+_0x7b3543[_0x1f371d(0x18a)][_0x1f371d(0x11f6)]+_0x1f371d(0x8ba)+_0x4934cf+'\x0a'+_0x5e601e+'\x0a'+_0x418a3b+_0x1f371d(0xe1f)+_0x19a618+'”的对话摘要**:\x0a'+_0x1f7072+_0x1f371d(0xb3d);try{const _0x128668=[{'role':_0x1f371d(0x4c5),'content':_0x1f371d(0x58d)}];let _0x491c12=_0x2ffe7b[_0x1f371d(0x44f)](_0x1f371d(0x136f)),_0x167fc7=_0x19a701(_0x1f5c49,_0x5626a3,_0x549b25,_0x128668);const _0x347010=_0x491c12?await fetch(_0x167fc7['url'],_0x167fc7[_0x1f371d(0x104c)]):await fetch(_0x2ffe7b+_0x1f371d(0x347),{'method':_0x1f371d(0xba0),'headers':{'Content-Type':_0x1f371d(0xcb5),'Authorization':_0x1f371d(0xb27)+_0x5626a3},'body':JSON[_0x1f371d(0x1308)]({'model':_0x1f5c49,'messages':[{'role':_0x1f371d(0xbaa),'content':_0x549b25},..._0x128668],'temperature':_0x505390['globalSettings'][_0x1f371d(0x398)]||0.9})});if(!_0x347010['ok'])throw new Error(_0x1f371d(0xef2)+_0x347010[_0x1f371d(0xd4a)]);const _0x246135=await _0x347010[_0x1f371d(0xfdf)](),_0x1fe064=getGeminiResponseText(_0x246135),_0x10cd33=_0x1fe064[_0x1f371d(0x491)](/^```json\s*/,'')[_0x1f371d(0x491)](/```$/,''),_0x1bd537=JSON[_0x1f371d(0x94c)](_0x10cd33);_0x7b3543[_0x1f371d(0x4d2)]=_0x1bd537,await _0xb81d4e[_0x1f371d(0x1027)][_0x1f371d(0x5d0)](_0x7b3543),await _0x50569b();}catch(_0x55e8bc){console[_0x1f371d(0xe3b)](_0x1f371d(0xea0),_0x55e8bc),await _0x1519c8(_0x1f371d(0xebe),'无法生成记录，请检查API配置或稍后再试。\x0a错误:\x20'+_0x55e8bc[_0x1f371d(0x757)]);}}function _0x50569b(){const _0x12ab1c=_0x85c4bf,_0x413f4c=document[_0x12ab1c(0x479)](_0x12ab1c(0xb83));_0x413f4c[_0x12ab1c(0x3de)]='';if(!_0x509091)return;const _0x2a7e5b=_0x505390[_0x12ab1c(0x1027)][_0x509091],_0xd9bce6=(_0x2a7e5b[_0x12ab1c(0x4d2)]||[])[_0x12ab1c(0x382)]((_0x2740f3,_0xab4cfd)=>_0xab4cfd[_0x12ab1c(0xd93)]-_0x2740f3[_0x12ab1c(0xd93)]);if(_0xd9bce6[_0x12ab1c(0x990)]===0x0){_0x413f4c[_0x12ab1c(0x3de)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有任何使用记录，<br>点击右上角刷新按钮生成一些吧！</p>';return;}_0xd9bce6[_0x12ab1c(0x12be)](_0x51a660=>{const _0x493161=_0x12ab1c,_0x39a98d=document[_0x493161(0xbd5)](_0x493161(0x6c8));_0x39a98d[_0x493161(0xfd4)]=_0x493161(0x74b);const _0x47f5e4=Math[_0x493161(0xd71)](_0x51a660[_0x493161(0xd93)]/0x3c),_0x2c7f0d=_0x51a660[_0x493161(0xd93)]%0x3c;let _0x41115e='';if(_0x47f5e4>0x0)_0x41115e+=_0x47f5e4+'小时';if(_0x2c7f0d>0x0)_0x41115e+=_0x2c7f0d+'分钟';if(!_0x41115e)_0x41115e=_0x493161(0xbe5);const _0x18405b=_0x51a660[_0x493161(0xfb2)]||_0x493161(0x4f9)+_0x51a660[_0x493161(0xc71)]+',\x20flat\x20design,\x20simple',_0x35cbc8=_0x493161(0x730)+encodeURIComponent(_0x18405b);_0x39a98d[_0x493161(0x3de)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x35cbc8+_0x493161(0x1041)+_0x51a660[_0x493161(0xc71)]+_0x493161(0x9ef)+_0x51a660['category']+_0x493161(0x10de)+_0x41115e+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x413f4c[_0x493161(0x9f4)](_0x39a98d);});}async function _0x43936d(){const _0x5aa499=_0x85c4bf;if(!_0x509091)return;const _0x5a758e=_0x505390[_0x5aa499(0x1027)][_0x509091];if(!_0x5a758e)return;await _0x1519c8(_0x5aa499(0xbd7),_0x5aa499(0xb29)+_0x5a758e['name']+_0x5aa499(0x2c7));const {proxyUrl:_0x312b2a,apiKey:_0x2331e5,model:_0x2ea61f}=_0x505390[_0x5aa499(0x30c)];if(!_0x312b2a||!_0x2331e5||!_0x2ea61f){alert('请先在API设置中配置好API信息。');return;}const _0xebd7df=_0x505390[_0x5aa499(0x1190)][_0x5aa499(0x904)]===_0x5aa499(0x80e)||!_0x505390[_0x5aa499(0x1190)][_0x5aa499(0x904)]?'用户':_0x505390['qzoneSettings']['nickname'],_0x2fdd78=_0x5a758e[_0x5aa499(0x3b4)]&&_0x5a758e['longTermMemory'][_0x5aa499(0x990)]>0x0?_0x5a758e[_0x5aa499(0x3b4)][_0x5aa499(0x2e1)](_0x265c22=>'-\x20(记录于\x20'+_0x3e14b1(_0x265c22[_0x5aa499(0x12a2)])+')\x20'+_0x265c22['content'])[_0x5aa499(0x35d)]('\x0a'):'无',_0x797e90=_0x5a758e[_0x5aa499(0x18a)][_0x5aa499(0x2c6)]||0xa,_0x1c071c=_0x5a758e['history'][_0x5aa499(0x777)](-_0x797e90)['map'](_0x5f3a63=>(_0x5f3a63[_0x5aa499(0x508)]===_0x5aa499(0x4c5)?_0xebd7df:_0x5a758e['name'])+':\x20'+String(_0x5f3a63[_0x5aa499(0xac4)])[_0x5aa499(0x1323)](0x0,0x1e)+_0x5aa499(0x4d0))[_0x5aa499(0x35d)]('\x0a'),_0x10b8a5=(_0x5a758e[_0x5aa499(0x18a)][_0x5aa499(0x13da)]||[])[_0x5aa499(0x2e1)](_0x2a0578=>_0x505390[_0x5aa499(0xd1b)][_0x5aa499(0xc0d)](_0x54be68=>_0x54be68['id']===_0x2a0578))[_0x5aa499(0x85d)](Boolean)[_0x5aa499(0x2e1)](_0x4cc598=>_0x5aa499(0x11d1)+_0x4cc598[_0x5aa499(0x564)]+_0x5aa499(0x8b4)+_0x4cc598['content']['filter'](_0xbf5726=>_0xbf5726['enabled'])[_0x5aa499(0x2e1)](_0x2d31d2=>'-\x20'+_0x2d31d2[_0x5aa499(0xac4)])[_0x5aa499(0x35d)]('\x0a'))[_0x5aa499(0x35d)](''),_0x2362a8=_0x5aa499(0x1d2)+_0x5a758e[_0x5aa499(0x564)]+_0x5aa499(0xdde)+_0x5a758e[_0x5aa499(0x18a)]['aiPersona']+_0x5aa499(0x8ba)+_0x2fdd78+'\x0a'+_0x10b8a5+_0x5aa499(0xe1f)+_0xebd7df+_0x5aa499(0xc46)+_0x1c071c+_0x5aa499(0xa1b);try{const _0x4951c0=[{'role':'user','content':_0x5aa499(0x1276)}];let _0x1a3f15=_0x312b2a['includes'](_0x5aa499(0x136f)),_0x91e9e9=_0x19a701(_0x2ea61f,_0x2331e5,_0x2362a8,_0x4951c0);const _0x570d28=_0x1a3f15?await fetch(_0x91e9e9[_0x5aa499(0x5f3)],_0x91e9e9[_0x5aa499(0x104c)]):await fetch(_0x312b2a+_0x5aa499(0x347),{'method':_0x5aa499(0xba0),'headers':{'Content-Type':'application/json','Authorization':_0x5aa499(0xb27)+_0x2331e5},'body':JSON['stringify']({'model':_0x2ea61f,'messages':[{'role':_0x5aa499(0xbaa),'content':_0x2362a8},..._0x4951c0],'temperature':_0x505390[_0x5aa499(0x888)][_0x5aa499(0x398)]||0x1})});if(!_0x570d28['ok'])throw new Error(_0x5aa499(0xef2)+_0x570d28['statusText']);const _0x44f101=await _0x570d28[_0x5aa499(0xfdf)](),_0x5e0523=getGeminiResponseText(_0x44f101),_0x392759=_0x5e0523[_0x5aa499(0x491)](/^```json\s*/,'')[_0x5aa499(0x491)](/```$/,''),_0xe59c57=JSON[_0x5aa499(0x94c)](_0x392759);await _0x1519c8(_0x5aa499(0xbd7),_0x5aa499(0x838)+_0xe59c57[_0x5aa499(0x990)]+_0x5aa499(0x10bf));const _0x25b458=_0xe59c57[_0x5aa499(0x2e1)](async _0x225b1a=>{const _0x4b66c2=_0x5aa499;let _0x46c2db=await _0x55856a(_0x225b1a[_0x4b66c2(0xbf0)],_0x225b1a[_0x4b66c2(0xa10)]);(!_0x46c2db||_0x46c2db[_0x4b66c2(0x990)]===0x0)&&(_0x46c2db=await _0x9e7734(_0x225b1a[_0x4b66c2(0xbf0)]));if(_0x46c2db[_0x4b66c2(0x990)]>0x0)return _0x1b4a5b(_0x46c2db[0x0]);return console[_0x4b66c2(0x139e)]('所有音乐源都未能找到歌曲：“'+_0x225b1a['songName']+_0x4b66c2(0x501)+_0x225b1a[_0x4b66c2(0xa10)]+'”'),null;}),_0x1a91ee=(await Promise['all'](_0x25b458))[_0x5aa499(0x85d)](Boolean);_0x5a758e[_0x5aa499(0xb0d)]=_0x1a91ee,await _0xb81d4e['chats'][_0x5aa499(0x5d0)](_0x5a758e),await _0x145ab7();}catch(_0x40fea5){console[_0x5aa499(0xe3b)](_0x5aa499(0x1c9),_0x40fea5),await _0x1519c8(_0x5aa499(0xebe),'无法生成歌单，请检查API配置或稍后再试。\x0a错误:\x20'+_0x40fea5[_0x5aa499(0x757)]);}}function _0x145ab7(){const _0x227b69=_0x85c4bf,_0x223b50=document[_0x227b69(0x479)](_0x227b69(0x129c));_0x223b50['innerHTML']='';if(!_0x509091)return;const _0x4276f1=_0x505390[_0x227b69(0x1027)][_0x509091],_0xe5aa1e=_0x4276f1[_0x227b69(0xb0d)]||[];if(_0xe5aa1e[_0x227b69(0x990)]===0x0){_0x223b50[_0x227b69(0x3de)]=_0x227b69(0x85a);return;}_0xe5aa1e[_0x227b69(0x12be)]((_0x20c010,_0x2e20ce)=>{const _0x53ba8d=_0x227b69,_0x58aaf3=document[_0x53ba8d(0xbd5)](_0x53ba8d(0x6c8));_0x58aaf3['className']=_0x53ba8d(0xe4d),_0x58aaf3[_0x53ba8d(0x3de)]=_0x53ba8d(0x9eb)+_0x20c010[_0x53ba8d(0x82e)]+_0x53ba8d(0xc80)+_0x20c010[_0x53ba8d(0x564)]+_0x53ba8d(0x1177)+_0x20c010[_0x53ba8d(0x9d1)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x58aaf3[_0x53ba8d(0xa75)]('click',()=>_0x43cacb(_0x20c010)),_0x223b50['appendChild'](_0x58aaf3);});}let _0x5df50f={'currentPlaylist':[],'currentIndex':-0x1,'isPlaying':![],'playMode':'order','lrcUpdateInterval':null,'parsedLyrics':[],'currentLyricIndex':-0x1};function _0x43cacb(_0x2915da){const _0x3aaec9=_0x85c4bf,_0x5d1ed9=document[_0x3aaec9(0x479)](_0x3aaec9(0xaf4)),_0x4ed052=document[_0x3aaec9(0x479)](_0x3aaec9(0x3ed));if(_0x5df50f[_0x3aaec9(0xbee)])clearInterval(_0x5df50f[_0x3aaec9(0xbee)]);_0x5d1ed9[_0x3aaec9(0xa80)]();const _0x21c433=_0x5df50f[_0x3aaec9(0x1e0)][_0x3aaec9(0x120c)](_0x2802f3=>_0x2802f3[_0x3aaec9(0xa9c)]===_0x2915da[_0x3aaec9(0xa9c)]);_0x21c433>-0x1?_0x5df50f[_0x3aaec9(0x12a5)]=_0x21c433:(_0x5df50f[_0x3aaec9(0x1e0)]=[_0x2915da],_0x5df50f[_0x3aaec9(0x12a5)]=0x0);document[_0x3aaec9(0x479)](_0x3aaec9(0x126d))[_0x3aaec9(0x97b)]=_0x2915da[_0x3aaec9(0x564)],document['getElementById']('char-music-artist')['textContent']=_0x2915da['artist'],document[_0x3aaec9(0x479)](_0x3aaec9(0x12d4))[_0x3aaec9(0xa9c)]=_0x2915da['cover'],_0x5df50f[_0x3aaec9(0x6f2)]=_0x1a5b5e(_0x2915da[_0x3aaec9(0x101f)]||''),_0x55f52e();if(_0x2915da[_0x3aaec9(0x755)]){const _0x2b1ce5=new Blob([_0x2915da['src']],{'type':_0x2915da['fileType']||_0x3aaec9(0xc55)});_0x5d1ed9[_0x3aaec9(0xa9c)]=URL[_0x3aaec9(0xe9c)](_0x2b1ce5);}else _0x5d1ed9[_0x3aaec9(0xa9c)]=_0x2915da['src'];_0x5d1ed9[_0x3aaec9(0xe02)]()[_0x3aaec9(0x575)](_0x22bb4e=>console[_0x3aaec9(0xe3b)](_0x3aaec9(0xf5a),_0x22bb4e)),_0x5d1ed9[_0x3aaec9(0xfbf)]=()=>{const _0x3d199e=_0x3aaec9;document[_0x3d199e(0x479)](_0x3d199e(0x28d))[_0x3d199e(0x97b)]=_0x1ba607(_0x5d1ed9[_0x3d199e(0x9d6)]),_0x5df50f['lrcUpdateInterval']=setInterval(_0x278650,0x1f4);},_0x4ed052[_0x3aaec9(0x9cd)][_0x3aaec9(0x807)]('visible');}function _0xd33c39(){const _0x13eabf=_0x85c4bf,_0x4c441a=document[_0x13eabf(0x479)](_0x13eabf(0x3ed)),_0x1dcf2e=document[_0x13eabf(0x479)](_0x13eabf(0xaf4));if(_0x5df50f[_0x13eabf(0xbee)])clearInterval(_0x5df50f['lrcUpdateInterval']);_0x1dcf2e[_0x13eabf(0xa80)](),_0x1dcf2e[_0x13eabf(0xa9c)]='',_0x4c441a[_0x13eabf(0x9cd)][_0x13eabf(0x8b6)](_0x13eabf(0x45a)),_0x5df50f[_0x13eabf(0x11c3)]=![],document[_0x13eabf(0x479)](_0x13eabf(0x231))[_0x13eabf(0x9cd)][_0x13eabf(0x8b6)](_0x13eabf(0xdf6));}function _0x278650(){const _0x201be4=_0x85c4bf,_0x11a732=document['getElementById'](_0x201be4(0xaf4));if(!_0x11a732[_0x201be4(0x9d6)])return;const _0x23647b=_0x11a732[_0x201be4(0x545)],_0x5ecf2a=_0x11a732[_0x201be4(0x9d6)];document['getElementById']('char-music-progress-fill')[_0x201be4(0x10dd)][_0x201be4(0x9f2)]=_0x23647b/_0x5ecf2a*0x64+'%',document[_0x201be4(0x479)](_0x201be4(0x952))['textContent']=_0x1ba607(_0x23647b),_0x19e0e7(_0x23647b);}function _0x55f52e(){const _0x1692e7=_0x85c4bf,_0x2963bb=document[_0x1692e7(0x479)](_0x1692e7(0xd3f));_0x2963bb['innerHTML']='',_0x5df50f['currentLyricIndex']=-0x1;if(!_0x5df50f['parsedLyrics']||_0x5df50f[_0x1692e7(0x6f2)]['length']===0x0){_0x2963bb[_0x1692e7(0x3de)]=_0x1692e7(0xfbc);return;}_0x5df50f['parsedLyrics'][_0x1692e7(0x12be)]((_0x5ce0ed,_0x2c8b15)=>{const _0x22377a=_0x1692e7,_0x4bb1cd=document[_0x22377a(0xbd5)]('p');_0x4bb1cd[_0x22377a(0x97b)]=_0x5ce0ed[_0x22377a(0x56d)],_0x4bb1cd['dataset']['index']=_0x2c8b15,_0x2963bb[_0x22377a(0x9f4)](_0x4bb1cd);});}function _0x19e0e7(_0x3d47c3){const _0x52e71b=_0x85c4bf,_0x380dd4=_0x5df50f['parsedLyrics'];if(_0x380dd4[_0x52e71b(0x990)]===0x0)return;let _0x35af2c=-0x1;for(let _0x2d01d9=0x0;_0x2d01d9<_0x380dd4[_0x52e71b(0x990)];_0x2d01d9++){if(_0x3d47c3>=_0x380dd4[_0x2d01d9][_0x52e71b(0x1ba)])_0x35af2c=_0x2d01d9;else break;}if(_0x35af2c===_0x5df50f[_0x52e71b(0x8f8)])return;_0x5df50f[_0x52e71b(0x8f8)]=_0x35af2c;const _0x22c363=document[_0x52e71b(0x479)](_0x52e71b(0xd3f)),_0x575a58=_0x22c363[_0x52e71b(0x99e)]('p');_0x575a58[_0x52e71b(0x12be)](_0x14341c=>_0x14341c[_0x52e71b(0x9cd)][_0x52e71b(0x8b6)](_0x52e71b(0x5a9)));if(_0x35af2c>-0x1){const _0x460530=_0x22c363['querySelector']('p[data-index=\x22'+_0x35af2c+'\x22]');if(_0x460530){_0x460530[_0x52e71b(0x9cd)][_0x52e71b(0x807)]('active');const _0x2f3fb6=_0x22c363[_0x52e71b(0xc27)]/0x2-_0x460530[_0x52e71b(0x6dc)]-_0x460530[_0x52e71b(0xfc5)]/0x2;_0x575a58[_0x52e71b(0x12be)](_0x5088f0=>{const _0x150f60=_0x52e71b;_0x5088f0['style'][_0x150f60(0x87a)]=_0x150f60(0x26c)+_0x2f3fb6+_0x150f60(0x98b);});}}}function _0x15fc16(){const _0x11cc01=_0x85c4bf;if(_0x5df50f[_0x11cc01(0x1e0)][_0x11cc01(0x990)]===0x0)return;let _0x24dd54;switch(_0x5df50f[_0x11cc01(0x5ca)]){case _0x11cc01(0x103a):_0x24dd54=Math[_0x11cc01(0xd71)](Math[_0x11cc01(0x103a)]()*_0x5df50f[_0x11cc01(0x1e0)][_0x11cc01(0x990)]);break;case _0x11cc01(0xf74):_0x43cacb(_0x5df50f[_0x11cc01(0x1e0)][_0x5df50f[_0x11cc01(0x12a5)]]);return;case _0x11cc01(0x11a3):default:_0x24dd54=(_0x5df50f['currentIndex']+0x1)%_0x5df50f[_0x11cc01(0x1e0)][_0x11cc01(0x990)];break;}_0x43cacb(_0x5df50f['currentPlaylist'][_0x24dd54]);}function _0x10ad48(){const _0x4d6399=_0x85c4bf;if(_0x5df50f['currentPlaylist'][_0x4d6399(0x990)]===0x0)return;const _0x264d52=(_0x5df50f['currentIndex']-0x1+_0x5df50f[_0x4d6399(0x1e0)][_0x4d6399(0x990)])%_0x5df50f[_0x4d6399(0x1e0)][_0x4d6399(0x990)];_0x43cacb(_0x5df50f[_0x4d6399(0x1e0)][_0x264d52]);}function _0x382472(){const _0x3c7566=_0x85c4bf,_0x49f81d=[_0x3c7566(0x11a3),_0x3c7566(0x103a),_0x3c7566(0xf74)],_0x928208=_0x49f81d[_0x3c7566(0xf2f)](_0x5df50f[_0x3c7566(0x5ca)]);_0x5df50f[_0x3c7566(0x5ca)]=_0x49f81d[(_0x928208+0x1)%_0x49f81d['length']],document[_0x3c7566(0x479)]('char-music-mode-btn')[_0x3c7566(0x97b)]={'order':'顺序','random':'随机','single':'单曲'}[_0x5df50f['playMode']];}function _0x4941dd(){const _0x57829d=_0x85c4bf,_0x22931d=document[_0x57829d(0x479)](_0x57829d(0xaf4)),_0x1b959a=document[_0x57829d(0x479)](_0x57829d(0xe87)),_0x456028=document[_0x57829d(0x479)](_0x57829d(0x231));_0x1b959a[_0x57829d(0xa75)]('click',()=>{const _0x2af880=_0x57829d;if(_0x22931d[_0x2af880(0xd90)]){if(_0x5df50f[_0x2af880(0x12a5)]>-0x1)_0x22931d[_0x2af880(0xe02)]();}else _0x22931d[_0x2af880(0xa80)]();}),_0x22931d[_0x57829d(0x4b4)]=()=>{const _0x32bfb8=_0x57829d;_0x1b959a[_0x32bfb8(0x3de)]=_0x32bfb8(0xa37),_0x456028[_0x32bfb8(0x9cd)][_0x32bfb8(0x807)](_0x32bfb8(0xdf6)),_0x5df50f[_0x32bfb8(0x11c3)]=!![];},_0x22931d['onpause']=()=>{const _0x54cb31=_0x57829d;_0x1b959a[_0x54cb31(0x3de)]='<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2232\x22\x20height=\x2232\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M8\x205v14l11-7z\x22></path></svg>',_0x456028[_0x54cb31(0x9cd)][_0x54cb31(0x8b6)](_0x54cb31(0xdf6)),_0x5df50f[_0x54cb31(0x11c3)]=![];},_0x22931d['onended']=()=>{const _0x215f2e=_0x57829d;_0x456028['classList']['remove'](_0x215f2e(0xdf6)),_0x5df50f[_0x215f2e(0x11c3)]=![],_0x15fc16();},document[_0x57829d(0x479)](_0x57829d(0x1120))['addEventListener']('click',_0x10ad48),document[_0x57829d(0x479)](_0x57829d(0x62a))['addEventListener'](_0x57829d(0xd2f),_0x15fc16),document[_0x57829d(0x479)](_0x57829d(0x12d3))[_0x57829d(0xa75)]('click',_0x382472),document[_0x57829d(0x479)](_0x57829d(0xcdd))[_0x57829d(0xa75)](_0x57829d(0xd2f),_0x3b991e=>{const _0x2db9de=_0x57829d;if(!_0x22931d['duration'])return;const _0x12159d=_0x3b991e[_0x2db9de(0x1030)],_0x3e4744=_0x3b991e[_0x2db9de(0xba9)];_0x22931d[_0x2db9de(0x545)]=_0x3e4744/_0x12159d[_0x2db9de(0x90a)]*_0x22931d[_0x2db9de(0x9d6)];});}async function _0x3ea0a9(){const _0x3607cc=_0x85c4bf,_0x24f977=document['getElementById']('douban-posts-list');_0x24f977[_0x3607cc(0x3de)]='';const _0x5b1536=await _0xb81d4e[_0x3607cc(0xd6d)]['orderBy']('timestamp')[_0x3607cc(0x336)]()[_0x3607cc(0x4ba)]();if(_0x5b1536[_0x3607cc(0x990)]===0x0){_0x24f977[_0x3607cc(0x3de)]=_0x3607cc(0x98a);return;}_0x5b1536[_0x3607cc(0x12be)](_0x51007f=>{const _0x548941=_0x3607cc;let _0x48694c;const _0x4a069e=_0x51007f[_0x548941(0x91b)]?Object['values'](_0x505390['chats'])[_0x548941(0xc0d)](_0x477182=>!_0x477182[_0x548941(0x9d7)]&&_0x477182[_0x548941(0x564)]===_0x51007f[_0x548941(0x91b)]):null;if(_0x4a069e)_0x48694c=_0x4a069e['settings'][_0x548941(0x1039)];else{const _0x20bd18=Object[_0x548941(0x3d5)](_0x505390[_0x548941(0x1027)])[_0x548941(0xc0d)](_0x1471d8=>!_0x1471d8[_0x548941(0x9d7)]&&_0x1471d8[_0x548941(0x564)]===_0x51007f[_0x548941(0xd7d)]);if(_0x20bd18)_0x48694c=_0x20bd18['settings']['aiAvatar'];else _0x51007f[_0x548941(0xa6b)]?_0x48694c=_0x548941(0x730)+encodeURIComponent(_0x51007f['authorAvatarPrompt']):_0x48694c=_0x28c106;}const _0x41bdf8=document[_0x548941(0xbd5)](_0x548941(0x6c8));_0x41bdf8[_0x548941(0xfd4)]=_0x548941(0x107a),_0x41bdf8[_0x548941(0x1063)]=()=>_0xe1098e(_0x51007f['id']),_0x41bdf8[_0x548941(0x3de)]=_0x548941(0x1269)+_0x48694c+_0x548941(0x3fb)+_0x51007f[_0x548941(0xd7d)]+_0x548941(0x59e)+_0x51007f[_0x548941(0x191)]+_0x548941(0x762)+_0x51007f[_0x548941(0xa72)]+_0x548941(0x10d9)+_0x51007f[_0x548941(0xac4)][_0x548941(0x491)](/\n/g,_0x548941(0x1043))+_0x548941(0x13ed)+_0x51007f[_0x548941(0xf3d)]+_0x548941(0x985)+_0x51007f['commentsCount']+_0x548941(0x3cb)+_0x3e14b1(_0x51007f[_0x548941(0x12a2)])+_0x548941(0x87f),_0x24f977['appendChild'](_0x41bdf8);});}async function _0x3a2488(){const _0x100f57=_0x85c4bf,_0x1b1340=_0x505390['globalSettings'][_0x100f57(0xce7)]||[];if(_0x1b1340[_0x100f57(0x990)]===0x0){await _0x1519c8(_0x100f57(0x3f2),_0x100f57(0x7b9));return;}await _0x1519c8(_0x100f57(0xbd7),_0x100f57(0x5b0)+_0x1b1340[_0x100f57(0x990)]+_0x100f57(0xa11));const {proxyUrl:_0x1d9820,apiKey:_0x44c47c,model:_0x44c4b7}=_0x505390[_0x100f57(0x30c)];if(!_0x1d9820||!_0x44c47c||!_0x44c4b7){alert(_0x100f57(0x9f1));return;}const _0x1ed36c=new Set();_0x1b1340[_0x100f57(0x12be)](_0x2d4240=>{const _0x11da3e=_0x100f57,_0x1fbbc0=_0x505390[_0x11da3e(0x1027)][_0x2d4240];_0x1fbbc0&&_0x1fbbc0[_0x11da3e(0x18a)]['linkedWorldBookIds']&&_0x1fbbc0[_0x11da3e(0x18a)]['linkedWorldBookIds'][_0x11da3e(0x12be)](_0x529590=>_0x1ed36c[_0x11da3e(0x807)](_0x529590));});let _0x5481cb='';_0x1ed36c[_0x100f57(0xa7a)]>0x0&&(_0x5481cb+=_0x100f57(0xf20),_0x1ed36c[_0x100f57(0x12be)](_0x448071=>{const _0x4eb5d5=_0x100f57,_0x7ad727=_0x505390[_0x4eb5d5(0xd1b)][_0x4eb5d5(0xc0d)](_0x6c1c0b=>_0x6c1c0b['id']===_0x448071);if(_0x7ad727){const _0x587512=_0x7ad727[_0x4eb5d5(0xac4)][_0x4eb5d5(0x85d)](_0x3d4c71=>_0x3d4c71[_0x4eb5d5(0x2b7)]!==![])['map'](_0x2a7f83=>'-\x20'+_0x2a7f83[_0x4eb5d5(0xac4)])[_0x4eb5d5(0x35d)]('\x0a');_0x587512&&(_0x5481cb+='\x0a##\x20来自《'+_0x7ad727[_0x4eb5d5(0x564)]+_0x4eb5d5(0x56e)+_0x587512);}}));const _0x44c68d=_0x505390[_0x100f57(0xd1b)][_0x100f57(0xc0d)](_0x35f84d=>_0x35f84d[_0x100f57(0x564)]===_0x100f57(0x7df));let _0x3b354e='',_0x1bb7d5=[];_0x44c68d&&_0x44c68d[_0x100f57(0xac4)]['forEach'](_0x1e722f=>{const _0x102eaf=_0x100f57;_0x1e722f[_0x102eaf(0xd6c)][_0x102eaf(0x44f)](_0x102eaf(0x5b9))&&(_0x3b354e+=_0x102eaf(0x313)+_0x1e722f[_0x102eaf(0xac4)]);if(_0x1e722f[_0x102eaf(0xd6c)]['includes'](_0x102eaf(0x71c))){const _0x3b5ec9=_0x1e722f[_0x102eaf(0xac4)][_0x102eaf(0x53e)]('\x0a');_0x3b5ec9[_0x102eaf(0x12be)](_0xda85b6=>{const _0xfcdf7b=_0x102eaf,_0x5620a5=_0xda85b6[_0xfcdf7b(0xab4)](/- \*\*昵称\*\*:\s*(.*?)\s*\*\*人设\*\*:\s*(.*)/);_0x5620a5&&_0x1bb7d5[_0xfcdf7b(0x1a0)]({'name':_0x5620a5[0x1]['trim'](),'persona':_0x5620a5[0x2][_0xfcdf7b(0x9c1)]()});});}});const _0x3b7b8a=_0x505390[_0x100f57(0x1190)][_0x100f57(0x904)]||'我',_0x248826=_0x1b1340[_0x100f57(0x990)]>0x0&&_0x505390['chats'][_0x1b1340[0x0]]?_0x505390['chats'][_0x1b1340[0x0]][_0x100f57(0x18a)][_0x100f57(0x12d7)]:_0x100f57(0xf4d);let _0x1f03eb='';_0x1b1340[_0x100f57(0x12be)](_0x31a607=>{const _0x56b0ed=_0x100f57,_0x5ecce3=_0x505390[_0x56b0ed(0x1027)][_0x31a607];if(_0x5ecce3){const _0x553d82=_0x5ecce3['longTermMemory']&&_0x5ecce3[_0x56b0ed(0x3b4)][_0x56b0ed(0x990)]>0x0?_0x5ecce3[_0x56b0ed(0x3b4)][_0x56b0ed(0x2e1)](_0x56e3c6=>_0x56e3c6[_0x56b0ed(0xac4)])[_0x56b0ed(0x35d)](';\x20'):'无',_0x211f32=_0x5ecce3[_0x56b0ed(0x7d3)][_0x56b0ed(0x777)](-0xa)[_0x56b0ed(0x2e1)](_0x596e1f=>(_0x596e1f['role']==='user'?_0x3b7b8a:_0x5ecce3[_0x56b0ed(0x564)])+':\x20'+String(_0x596e1f[_0x56b0ed(0xac4)])[_0x56b0ed(0x1323)](0x0,0x1e)+_0x56b0ed(0x4d0))[_0x56b0ed(0x35d)]('\x0a');_0x1f03eb+=_0x56b0ed(0x97d)+_0x5ecce3[_0x56b0ed(0x564)]+'</name>\x0a\x20\x20<persona>'+_0x5ecce3['settings'][_0x56b0ed(0x11f6)]+'</persona>\x0a\x20\x20<memory>'+_0x553d82+_0x56b0ed(0xd34)+_0x211f32+'</recent_dialogue_with_user>\x0a</character>\x0a';}}),_0x1bb7d5[_0x100f57(0x12be)](_0xa8dceb=>{const _0x43c700=_0x100f57;_0x1f03eb+=_0x43c700(0x97d)+_0xa8dceb[_0x43c700(0x564)]+_0x43c700(0x188)+_0xa8dceb[_0x43c700(0x596)]+_0x43c700(0x554);});const _0x5646f6=new Date(),_0x3aa200=_0x5646f6['toLocaleString'](_0x100f57(0xdc2),{'dateStyle':'full','timeStyle':_0x100f57(0xe6f)}),_0x36c198=_0x505390['globalSettings'][_0x100f57(0x125f)]||0xc,_0x296e8a=_0x505390[_0x100f57(0x888)][_0x100f57(0x53d)]||0x14,_0xbea57=_0x100f57(0xbac)+_0x36c198+'到'+_0x296e8a+'篇】他们最近可能会在各种豆瓣小组中发布的帖子和评论。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间感知】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你【必须】意识到当前是\x20**'+_0x3aa200+_0x100f57(0x804)+_0x3b7b8a+_0x100f57(0x630)+_0x3b7b8a+_0x100f57(0x785)+_0x3b354e+'\x0a'+_0x5481cb+_0x100f57(0x110e)+_0x3aa200+_0x100f57(0x69d)+_0x3b7b8a+'\x0a-\x20**人设**:\x20'+_0x248826+_0x100f57(0x28e)+_0x1f03eb+_0x100f57(0xe8a);try{const _0x5808e4=[{'role':_0x100f57(0x4c5),'content':'请根据角色列表，生成豆瓣小组帖子。'}];let _0x26c359=_0x1d9820['includes']('generativelanguage'),_0xe3e219=_0x19a701(_0x44c4b7,_0x44c47c,_0xbea57,_0x5808e4);const _0x48c3aa=_0x26c359?await fetch(_0xe3e219[_0x100f57(0x5f3)],_0xe3e219[_0x100f57(0x104c)]):await fetch(_0x1d9820+_0x100f57(0x347),{'method':_0x100f57(0xba0),'headers':{'Content-Type':_0x100f57(0xcb5),'Authorization':'Bearer\x20'+_0x44c47c},'body':JSON[_0x100f57(0x1308)]({'model':_0x44c4b7,'messages':[{'role':_0x100f57(0xbaa),'content':_0xbea57},..._0x5808e4],'temperature':_0x505390['globalSettings'][_0x100f57(0x398)]||0x1})});if(!_0x48c3aa['ok'])throw new Error(_0x100f57(0xef2)+_0x48c3aa['statusText']);const _0x3aa970=await _0x48c3aa['json'](),_0x4590f4=getGeminiResponseText(_0x3aa970),_0x5d4f82=_0x4590f4[_0x100f57(0xab4)](/\[[\s\S]*\]/);if(!_0x5d4f82)throw new Error(_0x100f57(0xe10)+_0x4590f4);const _0x499814=JSON[_0x100f57(0x94c)](_0x5d4f82[0x0]);await _0xb81d4e[_0x100f57(0xd6d)][_0x100f57(0xf8f)](),await _0xb81d4e[_0x100f57(0xd6d)][_0x100f57(0x2d9)](_0x499814[_0x100f57(0x2e1)](_0x242d61=>({..._0x242d61,'timestamp':Date[_0x100f57(0x12d6)]()-Math['random']()*0x186a0}))),await _0x3ea0a9();}catch(_0x59f277){console['error']('生成豆瓣帖子失败:',_0x59f277),await _0x1519c8('生成失败',_0x100f57(0xbb1)+_0x59f277[_0x100f57(0x757)]);}}async function _0xe1098e(_0x5763bc){const _0x5ea8fc=_0x85c4bf;_0x731d5(_0x5ea8fc(0x1aa)),_0x2355c5=_0x5763bc;const _0x25cfec=await _0xb81d4e[_0x5ea8fc(0xd6d)][_0x5ea8fc(0x111a)](_0x5763bc);if(!_0x25cfec){_0x731d5(_0x5ea8fc(0x9f8));return;}document[_0x5ea8fc(0x479)](_0x5ea8fc(0xf98))['textContent']='帖子详情';let _0x50b2fa=_0x28c106,_0xee01af=_0x25cfec['authorName'];const _0x46eaa6=_0x25cfec[_0x5ea8fc(0x91b)]?Object[_0x5ea8fc(0x3d5)](_0x505390[_0x5ea8fc(0x1027)])[_0x5ea8fc(0xc0d)](_0x3c3344=>!_0x3c3344[_0x5ea8fc(0x9d7)]&&_0x3c3344['originalName']===_0x25cfec[_0x5ea8fc(0x91b)]):null;if(_0x46eaa6)_0x50b2fa=_0x46eaa6[_0x5ea8fc(0x18a)][_0x5ea8fc(0x1039)];else{const _0xdfe6f4=Object['values'](_0x505390[_0x5ea8fc(0x1027)])[_0x5ea8fc(0xc0d)](_0x176ba3=>!_0x176ba3['isGroup']&&_0x176ba3[_0x5ea8fc(0x564)]===_0x25cfec[_0x5ea8fc(0xd7d)]);if(_0xdfe6f4)_0x50b2fa=_0xdfe6f4[_0x5ea8fc(0x18a)][_0x5ea8fc(0x1039)];else _0x25cfec[_0x5ea8fc(0xa6b)]&&(_0x50b2fa=_0x5ea8fc(0x730)+encodeURIComponent(_0x25cfec[_0x5ea8fc(0xa6b)]));}document['getElementById'](_0x5ea8fc(0xf83))[_0x5ea8fc(0xa9c)]=_0x50b2fa,document[_0x5ea8fc(0x479)](_0x5ea8fc(0x45e))[_0x5ea8fc(0x97b)]=_0xee01af,document['getElementById'](_0x5ea8fc(0xb92))[_0x5ea8fc(0x97b)]='来自\x20'+_0x25cfec[_0x5ea8fc(0x191)],document[_0x5ea8fc(0x479)](_0x5ea8fc(0x19a))[_0x5ea8fc(0x97b)]=_0x25cfec[_0x5ea8fc(0xa72)],document[_0x5ea8fc(0x479)](_0x5ea8fc(0x1008))['innerHTML']=_0x25cfec['content'][_0x5ea8fc(0x491)](/\n/g,_0x5ea8fc(0x1043)),document['getElementById']('douban-my-comment-avatar')['src']=_0x505390['qzoneSettings'][_0x5ea8fc(0x799)],document['getElementById'](_0x5ea8fc(0x381))[_0x5ea8fc(0x4e0)]='';const _0x5f384f=document[_0x5ea8fc(0x479)](_0x5ea8fc(0x123d));_0x5f384f['innerHTML']='';if(_0x25cfec[_0x5ea8fc(0xd3c)]&&_0x25cfec[_0x5ea8fc(0xd3c)][_0x5ea8fc(0x990)]>0x0){const _0x4d3b0c=new Map();_0x25cfec['comments'][_0x5ea8fc(0x12be)](_0x348886=>{const _0x1510ee=_0x5ea8fc;let _0x53f0dd=_0x28c106;const _0x10ef9e=_0x505390[_0x1510ee(0x1190)][_0x1510ee(0x904)]||'我',_0xe916fa=_0x348886['commenter'];if(_0x4d3b0c[_0x1510ee(0x391)](_0xe916fa))_0x53f0dd=_0x4d3b0c[_0x1510ee(0x111a)](_0xe916fa);else{if(_0xe916fa===_0x10ef9e)_0x53f0dd=_0x505390[_0x1510ee(0x1190)]['avatar'];else{if(_0xe916fa===_0x25cfec[_0x1510ee(0xd7d)])_0x53f0dd=_0x50b2fa;else{const _0x159d42=_0x348886[_0x1510ee(0xed3)]?Object[_0x1510ee(0x3d5)](_0x505390[_0x1510ee(0x1027)])['find'](_0x2a06d2=>!_0x2a06d2[_0x1510ee(0x9d7)]&&_0x2a06d2[_0x1510ee(0xe2d)]===_0x348886['commenterOriginalName']):null;if(_0x159d42)_0x53f0dd=_0x159d42['settings']['aiAvatar'];else{const _0x40b2af=Object['values'](_0x505390[_0x1510ee(0x1027)])[_0x1510ee(0xc0d)](_0x117509=>!_0x117509[_0x1510ee(0x9d7)]&&_0x117509[_0x1510ee(0x564)]===_0xe916fa);if(_0x40b2af)_0x53f0dd=_0x40b2af[_0x1510ee(0x18a)][_0x1510ee(0x1039)];else _0x348886[_0x1510ee(0x98e)]&&(_0x53f0dd=_0x1510ee(0x730)+encodeURIComponent(_0x348886[_0x1510ee(0x98e)]));}}}_0x4d3b0c[_0x1510ee(0x111b)](_0xe916fa,_0x53f0dd);}const _0x2474fb=document['createElement'](_0x1510ee(0x6c8));_0x2474fb[_0x1510ee(0xfd4)]=_0x1510ee(0xd7a),_0x2474fb[_0x1510ee(0x3de)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x53f0dd+'\x22\x20class=\x22douban-comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-author\x22>'+_0xe916fa+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-text\x22>'+_0x348886[_0x1510ee(0x56d)][_0x1510ee(0x491)](/\n/g,'<br>')+_0x1510ee(0x242),_0x5f384f['appendChild'](_0x2474fb);});}else _0x5f384f[_0x5ea8fc(0x3de)]=_0x5ea8fc(0x80a);const _0x44d34d=document[_0x5ea8fc(0x479)](_0x5ea8fc(0xec5));if(_0x44d34d)_0x44d34d[_0x5ea8fc(0x2b3)]=0x0;}async function _0x15c09f(){const _0x175847=_0x85c4bf;if(!_0x2355c5)return;const _0x566faa=document[_0x175847(0x479)](_0x175847(0x381)),_0x3f2652=_0x566faa[_0x175847(0x4e0)][_0x175847(0x9c1)]();if(!_0x3f2652)return;const _0x6b5b2a=await _0xb81d4e['doubanPosts']['get'](_0x2355c5);if(!_0x6b5b2a)return;!_0x6b5b2a[_0x175847(0xd3c)]&&(_0x6b5b2a[_0x175847(0xd3c)]=[]);const _0x2e0077=_0x505390[_0x175847(0x1190)]['nickname']||'我';_0x6b5b2a[_0x175847(0xd3c)][_0x175847(0x1a0)]({'commenter':_0x2e0077,'text':_0x3f2652}),_0x6b5b2a[_0x175847(0xf9d)]++,await _0xb81d4e['doubanPosts'][_0x175847(0x5d0)](_0x6b5b2a),_0x566faa[_0x175847(0x4e0)]='',await _0xe1098e(_0x2355c5);}async function _0x189087(){const _0x5192e8=_0x85c4bf;if(!_0x2355c5)return;const _0x3779e6=_0x2355c5,_0x2e6f13=await _0xb81d4e[_0x5192e8(0xd6d)][_0x5192e8(0x111a)](_0x3779e6);if(!_0x2e6f13)return;const _0x332f56=_0x2e6f13['comments']&&_0x2e6f13[_0x5192e8(0xd3c)]['slice'](-0x1)[0x0];if(!_0x332f56){alert(_0x5192e8(0xec0));return;}await _0x1519c8(_0x5192e8(0xbd7),'正在请求AI角色们加入讨论...');try{const {proxyUrl:_0x2e803f,apiKey:_0x30c2ec,model:_0x36a7b}=_0x505390[_0x5192e8(0x30c)];if(!_0x2e803f||!_0x30c2ec||!_0x36a7b)throw new Error(_0x5192e8(0x7bd));const _0x3b792d=_0x505390[_0x5192e8(0x1190)][_0x5192e8(0x904)]||'我',_0x61b8c5=_0x505390[_0x5192e8(0x1027)][Object['keys'](_0x505390[_0x5192e8(0x1027)])[0x0]]?.[_0x5192e8(0x18a)]['myPersona']||'(未设置)',_0x182dd3=new Map();_0x2e6f13[_0x5192e8(0xd3c)]&&_0x2e6f13['comments'][_0x5192e8(0x12be)](_0x2deb57=>{const _0xe29044=_0x5192e8,_0x54d0db=(_0x505390[_0xe29044(0x888)][_0xe29044(0xce7)]||[])['some'](_0x3f0a23=>_0x505390[_0xe29044(0x1027)][_0x3f0a23]?.[_0xe29044(0x564)]===_0x2deb57[_0xe29044(0x351)]);!_0x54d0db&&_0x2deb57['avatar_prompt']&&_0x182dd3[_0xe29044(0x111b)](_0x2deb57[_0xe29044(0x351)],_0x2deb57['avatar_prompt']);});let _0xa89fe5=_0x5192e8(0x1fe);_0x182dd3[_0x5192e8(0xa7a)]>0x0?(_0xa89fe5+='如果以下任何一位NPC再次评论，你【必须】使用我们提供的、完全相同的`avatar_prompt`，以保持头像一致性。\x0a',_0x182dd3[_0x5192e8(0x12be)]((_0x3cf286,_0x5eed65)=>{const _0x229636=_0x5192e8;_0xa89fe5+=_0x229636(0x118a)+_0x5eed65+_0x229636(0x334)+_0x3cf286+'\x22\x0a';})):_0xa89fe5+=_0x5192e8(0x934);const _0x15d87d=_0x505390['worldBooks'][_0x5192e8(0xc0d)](_0x106657=>_0x106657['name']===_0x5192e8(0x7df));let _0x381986=[];_0x15d87d&&_0x15d87d[_0x5192e8(0xac4)][_0x5192e8(0x12be)](_0x442b59=>{const _0x3ed0a6=_0x5192e8;if(_0x442b59[_0x3ed0a6(0xd6c)][_0x3ed0a6(0x44f)](_0x3ed0a6(0x71c))){const _0x27a943=_0x442b59['content'][_0x3ed0a6(0x53e)]('\x0a');_0x27a943[_0x3ed0a6(0x12be)](_0xce8cef=>{const _0x2dc790=_0x3ed0a6,_0x32f8b8=_0xce8cef[_0x2dc790(0xab4)](/- \*\*昵称\*\*:\s*(.*?)\s*\*\*人设\*\*:\s*(.*)/);_0x32f8b8&&_0x381986[_0x2dc790(0x1a0)]({'name':_0x32f8b8[0x1][_0x2dc790(0x9c1)](),'persona':_0x32f8b8[0x2][_0x2dc790(0x9c1)]()});});}});let _0xd0a4af='';const _0x11abc9=_0x505390['globalSettings'][_0x5192e8(0xce7)]||[];_0x11abc9['forEach'](_0x419229=>{const _0x6157ab=_0x5192e8,_0x2033c9=_0x505390[_0x6157ab(0x1027)][_0x419229];if(_0x2033c9){const _0x3a4759=_0x2033c9['longTermMemory']&&_0x2033c9['longTermMemory'][_0x6157ab(0x990)]>0x0?_0x2033c9[_0x6157ab(0x3b4)][_0x6157ab(0x2e1)](_0x392a85=>_0x392a85[_0x6157ab(0xac4)])['join'](';\x20'):'无',_0x13ed3b=_0x2033c9[_0x6157ab(0x7d3)][_0x6157ab(0x777)](-0xa)[_0x6157ab(0x2e1)](_0x3209ff=>(_0x3209ff[_0x6157ab(0x508)]===_0x6157ab(0x4c5)?_0x3b792d:_0x2033c9[_0x6157ab(0x564)])+':\x20'+String(_0x3209ff[_0x6157ab(0xac4)])[_0x6157ab(0x1323)](0x0,0x1e)+_0x6157ab(0x4d0))['join']('\x0a');_0xd0a4af+=_0x6157ab(0xfa6)+_0x2033c9[_0x6157ab(0x564)]+':\x20'+_0x2033c9[_0x6157ab(0x18a)]['aiPersona']['substring'](0x0,0x32)+_0x6157ab(0x4a3)+_0x3a4759+']\x20[最近对话:\x20'+_0x13ed3b+']';}}),_0x381986[_0x5192e8(0x12be)](_0x4aed5e=>{const _0x3abfaa=_0x5192e8;_0xd0a4af+=_0x3abfaa(0xfa6)+_0x4aed5e[_0x3abfaa(0x564)]+':\x20'+_0x4aed5e[_0x3abfaa(0x596)];});const _0x5f5785=new Date(),_0x26b356=_0x5f5785[_0x5192e8(0x119c)](_0x5192e8(0xdc2),{'dateStyle':_0x5192e8(0xf31),'timeStyle':_0x5192e8(0xe6f)}),_0x2ec9de=_0x5192e8(0x4a1)+_0x3b792d+_0x5192e8(0xd0f)+_0x26b356+'**。\x0a\x20\x20\x20\x20-\x20\x20\x20你的评论内容【必须】自然地体现出对【当前真实时间】的感知。\x0a2.\x20\x20**【禁止扮演用户\x20(最最最高优先级！！！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的昵称是“'+_0x3b792d+_0x5192e8(0x96e)+_0x3b792d+'”\x20的评论。你的任务是扮演【除了用户以外】的所有角色。\x0a3.\x20\x20**【互动】**:\x20新生成的评论【必须】是针对【已有评论】的延续或回应，让讨论能继续下去。\x0a4.\x20\x20**【头像一致性\x20(最高优先级！)】**:\x20你【必须】参考下面的“已有路人NPC头像指令”列表。如果一个已有的NPC再次发言，【必须】复用它旧的头像指令。只有在创造一个【全新的、从未出现过的】NPC时，才为其生成新的头像指令。\x0a5.\x20\x20**【格式】**:\x20你的回复【必须且只能】是一个JSON数组，数组中的每个元素都代表一条新评论，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22角色A的名字\x22,\x20\x22text\x22:\x20\x22角色A的新评论内容。\x22,\x20\x22avatar_prompt\x22:\x20\x22(可选)如果评论者是【全新的】NPC,提供头像指令\x22\x20},\x0a\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22角色B的名字\x22,\x20\x22text\x22:\x20\x22角色B对角色A或楼主的看法。\x22\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20上下文\x0a-\x20**帖子标题**:\x20《'+_0x2e6f13[_0x5192e8(0xa72)]+_0x5192e8(0x117d)+_0x2e6f13[_0x5192e8(0xd7d)]+'\x0a-\x20**帖子内容摘要**:\x20'+_0x2e6f13[_0x5192e8(0xac4)][_0x5192e8(0x1323)](0x0,0x64)+_0x5192e8(0x4c2)+_0x2e6f13[_0x5192e8(0xd3c)][_0x5192e8(0x2e1)](_0x2f3740=>'-\x20'+_0x2f3740[_0x5192e8(0x351)]+':\x20'+_0x2f3740[_0x5192e8(0x56d)])[_0x5192e8(0x35d)]('\x0a')+'\x0a\x0a'+_0xa89fe5+_0x5192e8(0x110e)+_0x26b356+'\x0a\x0a#\x20【你的聊天对象（用户）的人设】\x0a-\x20**昵称**:\x20'+_0x3b792d+_0x5192e8(0x1e9)+_0x61b8c5+_0x5192e8(0x30f)+_0xd0a4af+_0x5192e8(0x66e),_0x1bd1aa=[{'role':_0x5192e8(0x4c5),'content':_0x5192e8(0x2d1)}];let _0x3ee178=_0x2e803f[_0x5192e8(0x44f)](_0x5192e8(0x136f)),_0x1153c6=_0x19a701(_0x36a7b,_0x30c2ec,_0x2ec9de,_0x1bd1aa);const _0x24a914=_0x3ee178?await fetch(_0x1153c6[_0x5192e8(0x5f3)],_0x1153c6['data']):await fetch(_0x2e803f+_0x5192e8(0x347),{'method':_0x5192e8(0xba0),'headers':{'Content-Type':_0x5192e8(0xcb5),'Authorization':'Bearer\x20'+_0x30c2ec},'body':JSON['stringify']({'model':_0x36a7b,'messages':[{'role':'system','content':_0x2ec9de},..._0x1bd1aa],'temperature':_0x505390[_0x5192e8(0x888)][_0x5192e8(0x398)]||0x1})});if(!_0x24a914['ok'])throw new Error(_0x5192e8(0xef2)+_0x24a914[_0x5192e8(0xd4a)]);const _0x9f1b4d=await _0x24a914[_0x5192e8(0xfdf)](),_0x3adbdc=getGeminiResponseText(_0x9f1b4d),_0x253ed8=_0x3adbdc[_0x5192e8(0x491)](/^```json\s*/,'')[_0x5192e8(0x491)](/```$/,''),_0x4684e3=JSON['parse'](_0x253ed8);Array[_0x5192e8(0x285)](_0x4684e3)&&_0x4684e3[_0x5192e8(0x990)]>0x0&&(_0x2e6f13['comments'][_0x5192e8(0x1a0)](..._0x4684e3),_0x2e6f13[_0x5192e8(0xf9d)]+=_0x4684e3['length'],await _0xb81d4e[_0x5192e8(0xd6d)][_0x5192e8(0x5d0)](_0x2e6f13)),await _0xe1098e(_0x3779e6),_0x3acce8();}catch(_0x2feddc){console[_0x5192e8(0xe3b)](_0x5192e8(0x58e),_0x2feddc),await _0x1519c8(_0x5192e8(0xaab),_0x5192e8(0x5f0)+_0x2feddc[_0x5192e8(0x757)]);}}async function _0x5322a2(){const _0x163b1a=_0x85c4bf,_0xcd3112=document[_0x163b1a(0x479)]('douban-cast-modal'),_0x34a1ec=document[_0x163b1a(0x479)]('douban-cast-list');_0x34a1ec[_0x163b1a(0x3de)]='';const _0x560dc4=Object[_0x163b1a(0x3d5)](_0x505390[_0x163b1a(0x1027)])[_0x163b1a(0x85d)](_0x3b6f4c=>!_0x3b6f4c[_0x163b1a(0x9d7)]),_0x11cde5=new Set(_0x505390[_0x163b1a(0x888)][_0x163b1a(0xce7)]||[]);_0x560dc4['length']===0x0?_0x34a1ec[_0x163b1a(0x3de)]=_0x163b1a(0x1da):_0x560dc4[_0x163b1a(0x12be)](_0x49c36d=>{const _0x1431ec=_0x163b1a,_0x5301a2=document[_0x1431ec(0xbd5)](_0x1431ec(0x6c8));_0x5301a2[_0x1431ec(0xfd4)]=_0x1431ec(0xf47),_0x5301a2[_0x1431ec(0x3de)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22douban-cast-checkbox\x22\x20data-chat-id=\x22'+_0x49c36d['id']+'\x22\x20'+(_0x11cde5['has'](_0x49c36d['id'])?_0x1431ec(0xf7b):'')+'\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x49c36d['settings']['aiAvatar']||_0x28c106)+_0x1431ec(0x59f)+_0x49c36d[_0x1431ec(0x564)]+_0x1431ec(0xe3c),_0x34a1ec['appendChild'](_0x5301a2);}),_0xcd3112['classList'][_0x163b1a(0x807)](_0x163b1a(0x45a));}async function _0x4d3cf3(){const _0xd27cb2=_0x85c4bf,_0x2cfe2f=document[_0xd27cb2(0x99e)](_0xd27cb2(0xe0a)),_0x5f1913=Array[_0xd27cb2(0x22f)](_0x2cfe2f)[_0xd27cb2(0x2e1)](_0x453665=>_0x453665['dataset'][_0xd27cb2(0xd4e)]);_0x505390['globalSettings']['doubanActiveCharacterIds']=_0x5f1913,await _0xb81d4e[_0xd27cb2(0x888)][_0xd27cb2(0x5d0)](_0x505390[_0xd27cb2(0x888)]),document[_0xd27cb2(0x479)](_0xd27cb2(0xd03))[_0xd27cb2(0x9cd)][_0xd27cb2(0x8b6)]('visible'),await _0x3a2488();}document[_0x85c4bf(0x479)](_0x85c4bf(0xe37))['addEventListener']('click',_0x5322a2),document[_0x85c4bf(0x479)](_0x85c4bf(0x137f))[_0x85c4bf(0xa75)](_0x85c4bf(0xd2f),()=>{const _0x3ea46c=_0x85c4bf;document['getElementById'](_0x3ea46c(0xd03))[_0x3ea46c(0x9cd)][_0x3ea46c(0x8b6)](_0x3ea46c(0x45a));}),document[_0x85c4bf(0x479)](_0x85c4bf(0x870))[_0x85c4bf(0xa75)](_0x85c4bf(0xd2f),_0x4d3cf3),document[_0x85c4bf(0x479)](_0x85c4bf(0xfb9))[_0x85c4bf(0xa75)](_0x85c4bf(0xd2f),_0x4c68cb=>{const _0x4febe1=_0x85c4bf,_0x444de6=_0x4c68cb[_0x4febe1(0xfa2)]['closest']('.contact-picker-item');if(_0x444de6){const _0x2b1c2f=_0x444de6[_0x4febe1(0x8bc)]('.douban-cast-checkbox');_0x2b1c2f&&_0x4c68cb[_0x4febe1(0xfa2)]!==_0x2b1c2f&&(_0x2b1c2f[_0x4febe1(0xf7b)]=!_0x2b1c2f[_0x4febe1(0xf7b)]);}});async function _0x5464a7(_0x338353){const _0x283e7f=_0x85c4bf;if(!_0x338353)return;const _0x2e8492=await _0x1a9e79(_0x283e7f(0x13a2),_0x283e7f(0xe6b),{'confirmText':_0x283e7f(0xbde)});if(!_0x2e8492)return;try{const _0x504fd5=await _0x338353[_0x283e7f(0x56d)](),_0x4fc4e7=JSON[_0x283e7f(0x94c)](_0x504fd5);if(!_0x4fc4e7[_0x283e7f(0x73f)]&&!_0x4fc4e7[_0x283e7f(0x215)]&&!_0x4fc4e7[_0x283e7f(0x12ca)])throw new Error(_0x283e7f(0x12aa));Object['assign'](_0x505390[_0x283e7f(0x888)],_0x4fc4e7),await _0xb81d4e[_0x283e7f(0x888)][_0x283e7f(0x5d0)](_0x505390[_0x283e7f(0x888)]),_0x49ef38(),_0x355635(),_0x57595d(),_0x1711f7(),_0x5cefa5(_0x505390['globalSettings'][_0x283e7f(0x215)]),_0x57f4d5(_0x505390[_0x283e7f(0x888)]['fontUrl']),_0x2f6f58(),_0x31ff84(),_0x2884ff(),await _0x1519c8(_0x283e7f(0x634),_0x283e7f(0x1392));}catch(_0x16b368){console[_0x283e7f(0xe3b)](_0x283e7f(0x707),_0x16b368),await _0x1519c8(_0x283e7f(0xf28),_0x283e7f(0x894)+_0x16b368[_0x283e7f(0x757)]);}}async function _0x3929d9(_0x3d476e){const _0x2fca68=_0x85c4bf;console[_0x2fca68(0x90f)](_0x2fca68(0xb2f)+_0x3d476e[_0x2fca68(0x6e1)](0x1)+_0x2fca68(0xcd0));const _0x30aa2a=Object['values'](_0x505390[_0x2fca68(0x1027)])[_0x2fca68(0x85d)](_0x41e3ee=>!_0x41e3ee[_0x2fca68(0x9d7)]&&_0x41e3ee[_0x2fca68(0x18a)]['enableBackgroundActivity']&&_0x41e3ee[_0x2fca68(0xcda)]?.[_0x2fca68(0x93c)]==='friend');if(_0x30aa2a[_0x2fca68(0x990)]===0x0){console['log'](_0x2fca68(0xf66));return;}for(const _0x176553 of _0x30aa2a){const _0xbfb3f1=_0x176553['settings']['actionCooldownMinutes']||0xf,_0x1fc6ea=_0x176553[_0x2fca68(0xa28)]?(Date['now']()-_0x176553['lastActionTimestamp'])/(0x3e8*0x3c):Infinity;_0x3d476e>_0xbfb3f1&&_0x1fc6ea>_0xbfb3f1&&(Math[_0x2fca68(0x103a)]()<0.3&&(console['log'](_0x2fca68(0xced)+_0x176553[_0x2fca68(0x564)]+_0x2fca68(0xc48)),Math[_0x2fca68(0x103a)]()<0.7?await _0x24c27f(_0x176553['id']):console[_0x2fca68(0x90f)]('角色\x20\x22'+_0x176553[_0x2fca68(0x564)]+_0x2fca68(0x12eb))));}}function _0x43813a(){const _0x19686f=_0x85c4bf;if(!_0x505390['activeChatId'])return;const _0x3c157a=_0x505390[_0x19686f(0x1027)][_0x505390[_0x19686f(0x233)]];document[_0x19686f(0x479)](_0x19686f(0x3ef))[_0x19686f(0x4e0)]='',document[_0x19686f(0x479)](_0x19686f(0x81a))[_0x19686f(0x4e0)]='',document[_0x19686f(0x479)](_0x19686f(0x99b))[_0x19686f(0x3de)]=_0x19686f(0xf03),_0x731d5('search-history-screen');}async function _0x205c09(){const _0x3ee890=_0x85c4bf,_0x38e6a9=_0x505390['chats'][_0x505390[_0x3ee890(0x233)]];if(!_0x38e6a9)return;const _0x27417b=document[_0x3ee890(0x479)](_0x3ee890(0x3ef))[_0x3ee890(0x4e0)]['trim']()['toLowerCase'](),_0x452d34=document['getElementById'](_0x3ee890(0x81a))['value'];if(!_0x27417b&&!_0x452d34){alert('请输入关键词或选择一个日期。');return;}let _0x6a7ea3=_0x38e6a9[_0x3ee890(0x7d3)]['filter'](_0x119e0a=>!_0x119e0a[_0x3ee890(0xb9c)]);_0x27417b&&(_0x6a7ea3=_0x6a7ea3[_0x3ee890(0x85d)](_0x1e8007=>{const _0x2b1033=_0x3ee890;let _0x5bf40d='';if(typeof _0x1e8007['content']==='string')_0x5bf40d=_0x1e8007[_0x2b1033(0xac4)];else{if(_0x1e8007[_0x2b1033(0x858)]==='voice_message')_0x5bf40d=_0x1e8007[_0x2b1033(0xac4)];else{if(_0x1e8007[_0x2b1033(0x858)]===_0x2b1033(0x135a)||_0x1e8007[_0x2b1033(0x858)]===_0x2b1033(0x5d5))_0x5bf40d=_0x1e8007[_0x2b1033(0xac4)];else{if(_0x1e8007[_0x2b1033(0x858)]===_0x2b1033(0x124e))_0x5bf40d=(_0x1e8007[_0x2b1033(0xfba)]||'')+'\x20'+(_0x1e8007['description']||'');else _0x1e8007[_0x2b1033(0xb67)]&&(_0x5bf40d=_0x1e8007[_0x2b1033(0xac4)]);}}}return _0x5bf40d['toLowerCase']()['includes'](_0x27417b);}));if(_0x452d34){const _0x930aef=new Date(_0x452d34),_0x1a5496=new Date(_0x930aef[_0x3ee890(0x123b)](0x0,0x0,0x0,0x0))[_0x3ee890(0xd2b)](),_0x34fef3=new Date(_0x930aef[_0x3ee890(0x123b)](0x17,0x3b,0x3b,0x3e7))['getTime']();_0x6a7ea3=_0x6a7ea3[_0x3ee890(0x85d)](_0x2cd9c0=>_0x2cd9c0[_0x3ee890(0x12a2)]>=_0x1a5496&&_0x2cd9c0['timestamp']<=_0x34fef3);}await _0x2632c2(_0x6a7ea3);}async function _0x2632c2(_0x4f77bf){const _0xb51503=_0x85c4bf,_0x208a13=document['getElementById'](_0xb51503(0x99b)),_0x3d9352=_0x505390[_0xb51503(0x1027)][_0x505390['activeChatId']];_0x208a13[_0xb51503(0x3de)]='';if(_0x4f77bf['length']===0x0){_0x208a13[_0xb51503(0x3de)]=_0xb51503(0xe85);return;}let _0x59ac56='';for(const _0x1633c8 of _0x4f77bf){const _0x121e7a=new Date(_0x1633c8['timestamp']),_0x34fbc0=_0x121e7a['toLocaleDateString']();if(_0x34fbc0!==_0x59ac56){const _0x6f5dbc=document[_0xb51503(0xbd5)]('div');_0x6f5dbc[_0xb51503(0xfd4)]=_0xb51503(0x1104),_0x6f5dbc['textContent']=_0xb51503(0x517)+_0x121e7a[_0xb51503(0xd45)]()+'年'+(_0x121e7a[_0xb51503(0x180)]()+0x1)+'月'+_0x121e7a[_0xb51503(0x469)]()+_0xb51503(0x6a1),_0x208a13['appendChild'](_0x6f5dbc),_0x59ac56=_0x34fbc0;}const _0x633f4=await _0x43c884(_0x1633c8,_0x3d9352);_0x633f4&&(_0x633f4[_0xb51503(0x10dd)][_0xb51503(0xd8b)]=_0xb51503(0x1366),_0x633f4['addEventListener'](_0xb51503(0xd2f),()=>_0x197933(_0x1633c8['timestamp'])),_0x208a13[_0xb51503(0x9f4)](_0x633f4));}}async function _0x197933(_0x2963c4){const _0x175fd3=_0x85c4bf,_0x593a0e=_0x505390[_0x175fd3(0x233)];if(!_0x593a0e)return;_0x731d5(_0x175fd3(0xdeb)),setTimeout(async()=>{const _0x2d4e1a=_0x175fd3,_0x17403f=document[_0x2d4e1a(0x479)](_0x2d4e1a(0x659)),_0x64d453=_0x2d4e1a(0x7b8)+_0x2963c4+'\x22]';let _0x3312fd=_0x17403f[_0x2d4e1a(0x8bc)](_0x64d453),_0x186a13=0x0;const _0x2417e7=0x14;while(!_0x3312fd&&_0x186a13<_0x2417e7){const _0x16448a=document[_0x2d4e1a(0x479)](_0x2d4e1a(0x106c));if(_0x16448a)console[_0x2d4e1a(0x90f)](_0x2d4e1a(0x63a)+(_0x186a13+0x1)+')'),await _0x299b9f(),_0x3312fd=_0x17403f['querySelector'](_0x64d453),_0x186a13++;else break;}_0xd69305(_0x2963c4);},0xc8);}async function _0x3f4678(){const _0x4db138=_0x85c4bf;document[_0x4db138(0x479)](_0x4db138(0x3ef))['value']='',document[_0x4db138(0x479)](_0x4db138(0x81a))[_0x4db138(0x4e0)]='',await _0x2632c2(_0x505390[_0x4db138(0x1027)][_0x505390['activeChatId']][_0x4db138(0x7d3)]['filter'](_0x28264b=>!_0x28264b['isHidden']));}async function _0x44717a(_0x57ed6e=![],_0xe11f2c=null,_0x3122cd=null){const _0x3f0e38=_0x85c4bf,_0x33029c=document['getElementById'](_0x3f0e38(0xb3e)),_0x260513=document['getElementById'](_0x3f0e38(0xe68)),_0x217354=_0x505390['chats'][_0x505390[_0x3f0e38(0x233)]];_0x33029c[_0x3f0e38(0x3de)]='',_0x260513[_0x3f0e38(0x3de)]='';const _0x13e7a9=await _0xb81d4e[_0x3f0e38(0x640)][_0x3f0e38(0x4ba)](),_0x6d4c12=[..._0x53854d,..._0x13e7a9];document[_0x3f0e38(0x8bc)](_0x3f0e38(0xef3))[_0x3f0e38(0x10dd)]['display']=_0x57ed6e?_0x3f0e38(0xff8):_0x3f0e38(0x899),document[_0x3f0e38(0x479)](_0x3f0e38(0x24b))['style']['display']=_0x3f0e38(0xee3),document[_0x3f0e38(0x479)]('my-frame-content')['style'][_0x3f0e38(0x678)]=_0x3f0e38(0xff8),document[_0x3f0e38(0x479)](_0x3f0e38(0xdea))[_0x3f0e38(0x9cd)][_0x3f0e38(0x807)]('active'),document[_0x3f0e38(0x479)](_0x3f0e38(0x5a8))[_0x3f0e38(0x9cd)][_0x3f0e38(0x8b6)](_0x3f0e38(0x5a9));if(_0x57ed6e)_0x6d4c12[_0x3f0e38(0x12be)](_0x3e3a00=>{const _0xc65e76=_0x3f0e38,_0x38e49c=_0x36713b(_0x3e3a00,'my',_0xe11f2c);_0x3e3a00[_0xc65e76(0x5f3)]===_0x3122cd&&_0x38e49c['classList']['add'](_0xc65e76(0x10dc)),_0x33029c[_0xc65e76(0x9f4)](_0x38e49c);});else{const _0x46aa26=_0x217354[_0x3f0e38(0x18a)][_0x3f0e38(0x1039)]||_0x28c106,_0x5482ba=_0x217354[_0x3f0e38(0x18a)]['myAvatar']||(_0x217354[_0x3f0e38(0x9d7)]?_0x2361d7:_0x28c106);_0x6d4c12[_0x3f0e38(0x12be)](_0x23d0e3=>{const _0x200515=_0x3f0e38,_0x1b1331=_0x36713b(_0x23d0e3,'ai',_0x46aa26);if(_0x23d0e3[_0x200515(0x5f3)]===_0x578bab['ai'])_0x1b1331['classList'][_0x200515(0x807)](_0x200515(0x10dc));_0x33029c[_0x200515(0x9f4)](_0x1b1331);const _0xa50cea=_0x36713b(_0x23d0e3,'my',_0x5482ba);if(_0x23d0e3[_0x200515(0x5f3)]===_0x578bab['my'])_0xa50cea['classList'][_0x200515(0x807)](_0x200515(0x10dc));_0x260513[_0x200515(0x9f4)](_0xa50cea);});}}function _0x36713b(_0x3b5cbe,_0x2cea68,_0x349ed2){const _0x26e519=_0x85c4bf,_0x2de701=document[_0x26e519(0xbd5)](_0x26e519(0x6c8));_0x2de701[_0x26e519(0xfd4)]=_0x26e519(0xd47),_0x2de701[_0x26e519(0x13d4)][_0x26e519(0x107d)]=_0x3b5cbe[_0x26e519(0x5f3)],_0x2de701['title']=_0x3b5cbe[_0x26e519(0x564)];const _0x28d537=typeof _0x3b5cbe['id']==='number',_0xecbcdb=_0x28d537?_0x26e519(0x7c0)+_0x3b5cbe['id']+_0x26e519(0xc77):'';return _0x2de701['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0xecbcdb+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x349ed2+'\x22\x20class=\x22preview-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x3b5cbe['url']?_0x26e519(0xdba)+_0x3b5cbe[_0x26e519(0x5f3)]+'\x22\x20class=\x22preview-frame\x22>':'')+'\x0a\x20\x20\x20\x20',_0x2de701['addEventListener'](_0x26e519(0xd2f),_0x26af5d=>{const _0x2272f3=_0x26e519;if(_0x26af5d[_0x2272f3(0xfa2)]['classList'][_0x2272f3(0x658)](_0x2272f3(0xbbd)))return;if(_0xc0eda4){if(_0x28d537){const _0x4c0357=parseInt(_0x3b5cbe['id']);_0x2de701[_0x2272f3(0x9cd)][_0x2272f3(0x2bf)](_0x2272f3(0x10dc)),_0x1dcb25[_0x2272f3(0x391)](_0x4c0357)?_0x1dcb25['delete'](_0x4c0357):_0x1dcb25['add'](_0x4c0357),_0x497e41();}}else{_0x578bab[_0x2cea68]=_0x3b5cbe['url'];const _0x1141fb=_0x2cea68==='ai'?document[_0x2272f3(0x479)](_0x2272f3(0xb3e)):document[_0x2272f3(0x479)](_0x2272f3(0xe68));_0x1141fb[_0x2272f3(0x99e)]('.frame-item')[_0x2272f3(0x12be)](_0x1cb0a9=>_0x1cb0a9[_0x2272f3(0x9cd)][_0x2272f3(0x8b6)](_0x2272f3(0x10dc))),_0x2de701[_0x2272f3(0x9cd)]['add']('selected');}}),_0x2de701;}async function _0x490708(){const _0x32a17a=_0x85c4bf,_0x290a8c=document[_0x32a17a(0x479)](_0x32a17a(0xbe0)),_0x4ed30d=await new Promise(_0x4af121=>{const _0x40ac3c=_0x32a17a,_0xde44a3=_0x4fa8ea=>{const _0x489d99=_0x6666;_0x4af121(_0x4fa8ea['target'][_0x489d99(0xe63)][0x0]||null),_0x290a8c['removeEventListener'](_0x489d99(0x1150),_0xde44a3);};_0x290a8c[_0x40ac3c(0xa75)](_0x40ac3c(0x1150),_0xde44a3,{'once':!![]}),_0x290a8c[_0x40ac3c(0xd2f)]();});if(!_0x4ed30d)return;const _0x596da2=await _0x9a2c09(_0x32a17a(0x845),'请为这个新头像框起个名字');if(!_0x596da2||!_0x596da2[_0x32a17a(0x9c1)]())return;const _0x19a608=await new Promise(_0x2342d2=>{const _0x3c4d74=_0x32a17a,_0x5600bd=new FileReader();_0x5600bd[_0x3c4d74(0x502)]=()=>_0x2342d2(_0x5600bd[_0x3c4d74(0x97e)]),_0x5600bd[_0x3c4d74(0x83c)](_0x4ed30d);});await _0xb81d4e[_0x32a17a(0x640)][_0x32a17a(0x807)]({'name':_0x596da2[_0x32a17a(0x9c1)](),'url':_0x19a608}),_0x44717a(_0x49562c);}async function _0x2f4385(){const _0x2f8876=_0x85c4bf,_0x138d10=_0x2f8876(0xffa),_0x15a47d=await _0x9a2c09(_0x2f8876(0x1040),_0x2f8876(0xf2b),'',_0x2f8876(0x1283),_0x2f8876(0x8c4)+_0x138d10+_0x2f8876(0x1049));if(!_0x15a47d||!_0x15a47d['trim']())return;const _0x2e9fa6=_0x15a47d[_0x2f8876(0x9c1)]()[_0x2f8876(0x53e)]('\x0a'),_0x312624=[];let _0x995afb=0x0;for(const _0x30d293 of _0x2e9fa6){const _0x345194=_0x30d293[_0x2f8876(0xab4)](/^(.+?)[:：]\s*(https?:\/\/.+)$/);if(_0x345194)_0x312624[_0x2f8876(0x1a0)]({'name':_0x345194[0x1]['trim'](),'url':_0x345194[0x2]['trim']()});else _0x30d293['trim']()&&_0x995afb++;}_0x312624[_0x2f8876(0x990)]>0x0&&(await _0xb81d4e[_0x2f8876(0x640)][_0x2f8876(0x2d9)](_0x312624),_0x44717a(_0x49562c),await _0x1519c8(_0x2f8876(0x634),_0x2f8876(0xc09)+_0x312624[_0x2f8876(0x990)]+_0x2f8876(0x3ad))),_0x995afb>0x0&&await _0x1519c8(_0x2f8876(0xa66),'有\x20'+_0x995afb+_0x2f8876(0x11c9));}async function _0x23f822(_0x56b45b){const _0x4491e8=_0x85c4bf,_0x4bf117=await _0xb81d4e[_0x4491e8(0x640)]['get'](_0x56b45b);if(!_0x4bf117)return;const _0x5d8b48=await _0x1a9e79(_0x4491e8(0x587),_0x4491e8(0xed8)+_0x4bf117[_0x4491e8(0x564)]+_0x4491e8(0x7c7),{'confirmButtonClass':'btn-danger'});_0x5d8b48&&(await _0xb81d4e['customAvatarFrames'][_0x4491e8(0x1ea)](_0x56b45b),_0x44717a(_0x49562c));}let _0x328869=0x0;const _0x31ca9f=0x2;function _0x502741(){const _0x2b714b=_0x85c4bf,_0x4afe0a=document[_0x2b714b(0x479)]('home-screen-pages-container'),_0x4a1302=document[_0x2b714b(0x479)](_0x2b714b(0x699)),_0x51e778=document[_0x2b714b(0x99e)]('.pagination-dot');let _0x263c2e=0x0,_0x3c1e82=0x0,_0x12ae1f=0x0,_0x20b19b=![],_0x511d5e=!![];const _0x1d2f6d=()=>{const _0x616ee=_0x2b714b;_0x4a1302[_0x616ee(0x10dd)][_0x616ee(0x87a)]='translateX(-'+_0x328869*(0x64/_0x31ca9f)+'%)',_0x51e778[_0x616ee(0x12be)]((_0x4f38dd,_0x4ce9fd)=>{const _0x676f49=_0x616ee;_0x4f38dd['classList'][_0x676f49(0x2bf)](_0x676f49(0x5a9),_0x4ce9fd===_0x328869);});},_0x1426df=_0x1f76a8=>{const _0xd33bfc=_0x2b714b;_0x20b19b=!![],_0x511d5e=!![],_0x263c2e=_0x1f76a8[_0xd33bfc(0x858)]['includes'](_0xd33bfc(0xcec))?_0x1f76a8['pageX']:_0x1f76a8[_0xd33bfc(0x639)][0x0][_0xd33bfc(0xb0f)],_0x3c1e82=_0x1f76a8[_0xd33bfc(0x858)][_0xd33bfc(0x44f)](_0xd33bfc(0xcec))?_0x1f76a8['pageY']:_0x1f76a8[_0xd33bfc(0x639)][0x0][_0xd33bfc(0xe0c)],_0x4a1302[_0xd33bfc(0x10dd)][_0xd33bfc(0xe23)]=_0xd33bfc(0xff8);},_0x3912f5=_0x5d7018=>{const _0x33bc1a=_0x2b714b;if(!_0x20b19b)return;const _0x452bd2=_0x5d7018[_0x33bc1a(0x858)][_0x33bc1a(0x44f)](_0x33bc1a(0xcec))?_0x5d7018[_0x33bc1a(0xe0c)]:_0x5d7018[_0x33bc1a(0x639)][0x0][_0x33bc1a(0xe0c)];_0x12ae1f=_0x5d7018[_0x33bc1a(0x858)]['includes'](_0x33bc1a(0xcec))?_0x5d7018[_0x33bc1a(0xb0f)]:_0x5d7018['touches'][0x0][_0x33bc1a(0xb0f)];const _0x671c95=_0x12ae1f-_0x263c2e,_0x493ef9=_0x452bd2-_0x3c1e82;_0x511d5e&&(Math[_0x33bc1a(0xdc5)](_0x671c95)>0xa||Math['abs'](_0x493ef9)>0xa)&&(_0x511d5e=![]);if(Math['abs'](_0x671c95)>Math[_0x33bc1a(0xdc5)](_0x493ef9)){if(_0x5d7018['cancelable'])_0x5d7018[_0x33bc1a(0xd58)]();_0x4a1302[_0x33bc1a(0x10dd)][_0x33bc1a(0x87a)]=_0x33bc1a(0x232)+_0x328869*(0x64/_0x31ca9f)+_0x33bc1a(0x1015)+_0x671c95+_0x33bc1a(0x117c);}},_0x11c717=_0x81df47=>{const _0x468fcc=_0x2b714b;if(!_0x20b19b)return;_0x20b19b=![],_0x4a1302['style'][_0x468fcc(0xe23)]=_0x468fcc(0xf99);if(_0x511d5e){_0x1d2f6d();return;}const _0x3b856a=_0x12ae1f-_0x263c2e;if(Math[_0x468fcc(0xdc5)](_0x3b856a)>_0x4afe0a[_0x468fcc(0x918)]/0x4){if(_0x3b856a>0x0&&_0x328869>0x0)_0x328869--;else _0x3b856a<0x0&&_0x328869<_0x31ca9f-0x1&&_0x328869++;}_0x1d2f6d();};_0x4afe0a['addEventListener'](_0x2b714b(0xee9),_0x1426df),_0x4afe0a[_0x2b714b(0xa75)](_0x2b714b(0xaf1),_0x3912f5),_0x4afe0a[_0x2b714b(0xa75)]('mouseup',_0x11c717),_0x4afe0a[_0x2b714b(0xa75)](_0x2b714b(0x1353),_0x11c717),_0x4afe0a[_0x2b714b(0xa75)](_0x2b714b(0x2a9),_0x1426df,{'passive':![]}),_0x4afe0a[_0x2b714b(0xa75)](_0x2b714b(0x56f),_0x3912f5,{'passive':![]}),_0x4afe0a[_0x2b714b(0xa75)]('touchend',_0x11c717);}let _0x2c61d3=null;async function _0x36558b(){await _0x26c096(),_0x731d5('preset-screen');}async function _0x26c096(){const _0x1d5f0e=_0x85c4bf,_0x3cc78f=document[_0x1d5f0e(0x479)]('preset-tabs'),_0x10c965=document[_0x1d5f0e(0x479)](_0x1d5f0e(0x78d));_0x3cc78f[_0x1d5f0e(0x3de)]='',_0x10c965[_0x1d5f0e(0x3de)]='';const [_0x5d2ec9,_0x37e13e]=await Promise['all']([_0xb81d4e[_0x1d5f0e(0xaa0)][_0x1d5f0e(0x4ba)](),_0xb81d4e[_0x1d5f0e(0xebc)][_0x1d5f0e(0x3d2)](_0x1d5f0e(0x564))[_0x1d5f0e(0x4ba)]()]);_0x505390[_0x1d5f0e(0xaa0)]=_0x5d2ec9;if(_0x5d2ec9['length']===0x0){_0x10c965[_0x1d5f0e(0x3de)]='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20创建你的第一个预设</p>';return;}const _0x2ec0cf=document[_0x1d5f0e(0xbd5)](_0x1d5f0e(0x7b6));_0x2ec0cf[_0x1d5f0e(0xfd4)]='world-book-tab\x20active',_0x2ec0cf['textContent']='全部',_0x2ec0cf[_0x1d5f0e(0x13d4)][_0x1d5f0e(0x470)]='all',_0x3cc78f[_0x1d5f0e(0x9f4)](_0x2ec0cf);const _0x576df3=document[_0x1d5f0e(0xbd5)](_0x1d5f0e(0x6c8));_0x576df3['className']=_0x1d5f0e(0x13d0),_0x576df3[_0x1d5f0e(0x13d4)]['categoryId']=_0x1d5f0e(0xf78),_0x10c965[_0x1d5f0e(0x9f4)](_0x576df3),_0x37e13e[_0x1d5f0e(0x12be)](_0x4b3d44=>{const _0x386998=_0x1d5f0e,_0x5995ed=document[_0x386998(0xbd5)](_0x386998(0x7b6));_0x5995ed['className']=_0x386998(0x12ea),_0x5995ed[_0x386998(0x97b)]=_0x4b3d44[_0x386998(0x564)],_0x5995ed[_0x386998(0x13d4)][_0x386998(0x470)]=String(_0x4b3d44['id']),_0x3cc78f[_0x386998(0x9f4)](_0x5995ed);const _0x182fa4=document[_0x386998(0xbd5)](_0x386998(0x6c8));_0x182fa4[_0x386998(0xfd4)]=_0x386998(0x8c0),_0x182fa4[_0x386998(0x13d4)]['categoryId']=String(_0x4b3d44['id']),_0x10c965[_0x386998(0x9f4)](_0x182fa4);});const _0x38d37e=_0x5d2ec9['some'](_0x1d4901=>!_0x1d4901['categoryId']);if(_0x38d37e){const _0x186ecb=document['createElement'](_0x1d5f0e(0x7b6));_0x186ecb[_0x1d5f0e(0xfd4)]=_0x1d5f0e(0x12ea),_0x186ecb[_0x1d5f0e(0x97b)]=_0x1d5f0e(0xcee),_0x186ecb[_0x1d5f0e(0x13d4)][_0x1d5f0e(0x470)]=_0x1d5f0e(0x331),_0x3cc78f[_0x1d5f0e(0x9f4)](_0x186ecb);const _0x53ad47=document['createElement']('div');_0x53ad47[_0x1d5f0e(0xfd4)]='world-book-category-pane',_0x53ad47['dataset']['categoryId']=_0x1d5f0e(0x331),_0x10c965[_0x1d5f0e(0x9f4)](_0x53ad47);}_0x5d2ec9['forEach'](_0xdd1b42=>{const _0xdd20cb=_0x1d5f0e,_0x33c3db=_0xdd20cb(0xb8e)+_0xdd1b42['content']['length']+_0xdd20cb(0x771),_0x3f7f8e=document[_0xdd20cb(0xbd5)]('div');_0x3f7f8e[_0xdd20cb(0xfd4)]=_0xdd20cb(0x552),_0x3f7f8e['innerHTML']=_0xdd20cb(0xf10)+_0xdd1b42[_0xdd20cb(0x564)]+_0xdd20cb(0xa4b)+_0x33c3db+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';const _0x35eaab=()=>_0x496dc9(_0xdd1b42['id']),_0x29bf85=async()=>{const _0x12d6ff=_0xdd20cb,_0x50f9e7=await _0x1a9e79(_0x12d6ff(0x1143),'确定要删除《'+_0xdd1b42[_0x12d6ff(0x564)]+'》吗？',{'confirmButtonClass':_0x12d6ff(0x95a)});_0x50f9e7&&(await _0xb81d4e['presets'][_0x12d6ff(0x1ea)](_0xdd1b42['id']),_0x505390[_0x12d6ff(0xaa0)]=await _0xb81d4e[_0x12d6ff(0xaa0)][_0x12d6ff(0x4ba)](),_0x26c096());};_0x3f7f8e[_0xdd20cb(0xa75)](_0xdd20cb(0xd2f),_0x35eaab),_0x33282f(_0x3f7f8e,_0x29bf85);const _0x19ec2c=_0x3f7f8e[_0xdd20cb(0xbcf)](!![]);_0x19ec2c['addEventListener']('click',_0x35eaab),_0x33282f(_0x19ec2c,_0x29bf85),_0x576df3[_0xdd20cb(0x9f4)](_0x19ec2c);const _0x52ea72=_0xdd1b42[_0xdd20cb(0x470)]?String(_0xdd1b42[_0xdd20cb(0x470)]):_0xdd20cb(0x331),_0x1a7ce8=_0x10c965['querySelector']('.world-book-category-pane[data-category-id=\x22'+_0x52ea72+'\x22]');_0x1a7ce8&&_0x1a7ce8[_0xdd20cb(0x9f4)](_0x3f7f8e);}),document[_0x1d5f0e(0x99e)]('#preset-tabs\x20.world-book-tab')[_0x1d5f0e(0x12be)](_0x1e7463=>{const _0x1d505b=_0x1d5f0e;_0x1e7463[_0x1d505b(0xa75)](_0x1d505b(0xd2f),()=>_0x17034a(_0x1e7463[_0x1d505b(0x13d4)][_0x1d505b(0x470)]));});}function _0x17034a(_0x272bcf){const _0x2b8d9e=_0x85c4bf;document[_0x2b8d9e(0x99e)](_0x2b8d9e(0xaf2))[_0x2b8d9e(0x12be)](_0x37ee03=>{const _0x4dedfa=_0x2b8d9e;_0x37ee03['classList']['toggle'](_0x4dedfa(0x5a9),_0x37ee03[_0x4dedfa(0x13d4)]['categoryId']===_0x272bcf);}),document['querySelectorAll'](_0x2b8d9e(0x530))[_0x2b8d9e(0x12be)](_0x76a06a=>{const _0x550832=_0x2b8d9e;_0x76a06a[_0x550832(0x9cd)][_0x550832(0x2bf)](_0x550832(0x5a9),_0x76a06a['dataset'][_0x550832(0x470)]===_0x272bcf);});}async function _0x496dc9(_0x12071c){const _0x464300=_0x85c4bf;_0x731d5(_0x464300(0xd0a)),_0x2c61d3=_0x12071c;try{const [_0x6f6829,_0x285275]=await Promise[_0x464300(0xf78)]([_0xb81d4e[_0x464300(0xaa0)][_0x464300(0x111a)](_0x12071c),_0xb81d4e[_0x464300(0xebc)]['toArray']()]);if(!_0x6f6829){console[_0x464300(0xe3b)]('错误：尝试打开一个不存在的预设，ID:',_0x12071c),await _0x1519c8(_0x464300(0x88c),'找不到这个预设的详细信息。'),_0x731d5('preset-screen');return;}setTimeout(()=>{const _0x49e5a6=_0x464300;document['getElementById'](_0x49e5a6(0x3bb))[_0x49e5a6(0x97b)]=_0x6f6829['name'],document[_0x49e5a6(0x479)]('preset-name-input')[_0x49e5a6(0x4e0)]=_0x6f6829[_0x49e5a6(0x564)];const _0xacdc57=document[_0x49e5a6(0x479)]('preset-category-select');_0xacdc57['innerHTML']=_0x49e5a6(0x278),_0x285275[_0x49e5a6(0x12be)](_0x3ab7da=>{const _0x47644e=_0x49e5a6,_0x3acc80=document[_0x47644e(0xbd5)](_0x47644e(0x9a2));_0x3acc80['value']=_0x3ab7da['id'],_0x3acc80[_0x47644e(0x97b)]=_0x3ab7da[_0x47644e(0x564)];if(_0x6f6829[_0x47644e(0x470)]===_0x3ab7da['id'])_0x3acc80[_0x47644e(0x10dc)]=!![];_0xacdc57['appendChild'](_0x3acc80);});const _0x1ff19b=document[_0x49e5a6(0x479)]('preset-entries-container');_0x1ff19b[_0x49e5a6(0x3de)]='',Array[_0x49e5a6(0x285)](_0x6f6829[_0x49e5a6(0xac4)])&&_0x6f6829['content'][_0x49e5a6(0x990)]>0x0?_0x6f6829['content'][_0x49e5a6(0x12be)](_0x2f9641=>{const _0x2a1535=_0x49e5a6,_0x18c6c4=_0x503f27(_0x2f9641);_0x1ff19b[_0x2a1535(0x9f4)](_0x18c6c4);}):_0x1ff19b[_0x49e5a6(0x3de)]=_0x49e5a6(0x121f);},0x32);}catch(_0x37e802){console['error'](_0x464300(0xd0b),_0x37e802),await _0x1519c8(_0x464300(0x88c),_0x464300(0xed9)+_0x37e802[_0x464300(0x757)]),_0x731d5(_0x464300(0xc49));}}function _0x503f27(_0x5c0bf6={'keys':[],'comment':'','content':'','enabled':!![]}){const _0x50722e=_0x85c4bf,_0xaa3c0a=document[_0x50722e(0xbd5)](_0x50722e(0x6c8));_0xaa3c0a[_0x50722e(0xfd4)]='message-editor-block';const _0x77f719=_0x5c0bf6[_0x50722e(0x2b7)]!==![]?_0x50722e(0xf7b):'';_0xaa3c0a[_0x50722e(0x3de)]=_0x50722e(0xdbd)+_0x77f719+_0x50722e(0x46d)+(_0x5c0bf6[_0x50722e(0xd6c)]||'')+_0x50722e(0x61b)+(_0x5c0bf6[_0x50722e(0x108c)]||[])['join'](',\x20')+_0x50722e(0x2d7)+(_0x5c0bf6[_0x50722e(0xac4)]||'')+'</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0xaa3c0a[_0x50722e(0x8bc)](_0x50722e(0x895))['addEventListener'](_0x50722e(0xd2f),()=>_0xaa3c0a[_0x50722e(0x8b6)]());const _0x5cd35c=_0xaa3c0a[_0x50722e(0x8bc)](_0x50722e(0xb6d)),_0x4affca=_0xaa3c0a[_0x50722e(0x8bc)]('.entry-content-container');return _0x5cd35c[_0x50722e(0xa75)](_0x50722e(0xd2f),()=>{const _0x5a0850=_0x50722e,_0x436147=_0x4affca[_0x5a0850(0x10dd)]['display']==='none';_0x4affca[_0x5a0850(0x10dd)][_0x5a0850(0x678)]=_0x436147?_0x5a0850(0xee3):'none',_0x5cd35c['textContent']=_0x436147?'收起':'展开';}),_0xaa3c0a;}async function _0x9f4091(){const _0x693696=_0x85c4bf;await _0x4aebac(),document[_0x693696(0x8bc)]('#group-management-modal\x20.modal-header\x20span')[_0x693696(0x97b)]=_0x693696(0xab9),document['getElementById'](_0x693696(0xc60))[_0x693696(0x1063)]=_0x35580f,document[_0x693696(0x479)]('existing-groups-list')[_0x693696(0x1063)]=_0x3b0710=>{const _0x294691=_0x693696;_0x3b0710['target'][_0x294691(0x9cd)][_0x294691(0x658)](_0x294691(0x970))&&_0x5937f1(parseInt(_0x3b0710[_0x294691(0xfa2)][_0x294691(0x13d4)]['id']));},document['getElementById']('close-group-manager-btn')[_0x693696(0x1063)]=()=>{const _0x4099d9=_0x693696;document['getElementById'](_0x4099d9(0x557))[_0x4099d9(0x9cd)][_0x4099d9(0x8b6)](_0x4099d9(0x45a)),_0x26c096();},document[_0x693696(0x479)](_0x693696(0x557))[_0x693696(0x9cd)][_0x693696(0x807)](_0x693696(0x45a));}async function _0x4aebac(){const _0x4eb58d=_0x85c4bf,_0x1fe4ce=document[_0x4eb58d(0x479)](_0x4eb58d(0x135e)),_0x4f48c6=await _0xb81d4e[_0x4eb58d(0xebc)][_0x4eb58d(0x4ba)]();_0x1fe4ce['innerHTML']='',_0x4f48c6[_0x4eb58d(0x990)]===0x0&&(_0x1fe4ce[_0x4eb58d(0x3de)]=_0x4eb58d(0xd77)),_0x4f48c6['forEach'](_0xb07817=>{const _0x1a3df1=_0x4eb58d,_0x22182c=document[_0x1a3df1(0xbd5)](_0x1a3df1(0x6c8));_0x22182c[_0x1a3df1(0xfd4)]=_0x1a3df1(0x100f),_0x22182c[_0x1a3df1(0x3de)]=_0x1a3df1(0xea4)+_0xb07817[_0x1a3df1(0x564)]+_0x1a3df1(0x13f9)+_0xb07817['id']+_0x1a3df1(0x13be),_0x1fe4ce['appendChild'](_0x22182c);});}async function _0x35580f(){const _0x1fc501=_0x85c4bf,_0x5f217e=document[_0x1fc501(0x479)](_0x1fc501(0x6d6)),_0x372b2c=_0x5f217e[_0x1fc501(0x4e0)]['trim']();if(!_0x372b2c)return alert(_0x1fc501(0x446));const _0x3e310f=await _0xb81d4e[_0x1fc501(0xebc)][_0x1fc501(0x46f)](_0x1fc501(0x564))[_0x1fc501(0x4a2)](_0x372b2c)['first']();if(_0x3e310f)return alert(_0x1fc501(0x652)+_0x372b2c+_0x1fc501(0x12d5));await _0xb81d4e[_0x1fc501(0xebc)][_0x1fc501(0x807)]({'name':_0x372b2c}),_0x5f217e[_0x1fc501(0x4e0)]='',await _0x4aebac();}async function _0x5937f1(_0x3b1b09){const _0x249b4b=_0x85c4bf,_0xd87321=await _0x1a9e79('确认删除',_0x249b4b(0xab8),{'confirmButtonClass':_0x249b4b(0x95a)});_0xd87321&&(await _0xb81d4e[_0x249b4b(0xebc)][_0x249b4b(0x1ea)](_0x3b1b09),await _0xb81d4e[_0x249b4b(0xaa0)][_0x249b4b(0x46f)](_0x249b4b(0x470))[_0x249b4b(0x4a2)](_0x3b1b09)[_0x249b4b(0x629)]({'categoryId':null}),_0x505390[_0x249b4b(0xaa0)]=await _0xb81d4e[_0x249b4b(0xaa0)]['toArray'](),await _0x4aebac());}async function _0x35d928(_0x13bb7b){const _0x2ccabc=_0x85c4bf,_0x5b36e0=_0x13bb7b[_0x2ccabc(0xfa2)][_0x2ccabc(0xe63)][0x0];if(!_0x5b36e0)return;try{if(!_0x5b36e0[_0x2ccabc(0x564)][_0x2ccabc(0x1193)](_0x2ccabc(0x1a6)))throw new Error(_0x2ccabc(0xc75));const _0x202ff7=await _0x5b36e0[_0x2ccabc(0x56d)](),_0x405bbb=JSON[_0x2ccabc(0x94c)](_0x202ff7);await _0x26354c(_0x405bbb,_0x5b36e0[_0x2ccabc(0x564)]);}catch(_0x856b03){console[_0x2ccabc(0xe3b)](_0x2ccabc(0xd68),_0x856b03),await _0x1519c8(_0x2ccabc(0xf28),_0x2ccabc(0x1363)+_0x856b03['message']);}finally{_0x13bb7b[_0x2ccabc(0xfa2)]['value']=null;}}async function _0x26354c(_0x3d79e9,_0x1cfcb9){const _0x15cdfa=_0x85c4bf;let _0x37e2bd=[];if(Array[_0x15cdfa(0x285)](_0x3d79e9[_0x15cdfa(0x11de)])&&Array[_0x15cdfa(0x285)](_0x3d79e9[_0x15cdfa(0x92d)])&&_0x3d79e9[_0x15cdfa(0x92d)]['length']>0x0){console[_0x15cdfa(0x90f)](_0x15cdfa(0x100a));const _0x258d26=new Map(_0x3d79e9[_0x15cdfa(0x11de)][_0x15cdfa(0x2e1)](_0x5d8955=>[_0x5d8955['identifier'],_0x5d8955])),_0x234cea=_0x3d79e9[_0x15cdfa(0x92d)][_0x15cdfa(0x1300)]((_0x812fdb,_0x4072a3)=>_0x4072a3[_0x15cdfa(0x11a3)]&&_0x4072a3['order'][_0x15cdfa(0x990)]>(_0x812fdb['length']||0x0)?_0x4072a3[_0x15cdfa(0x11a3)]:_0x812fdb,[]);_0x234cea&&_0x234cea['length']>0x0&&(_0x37e2bd=_0x234cea[_0x15cdfa(0x2e1)](_0x4931f2=>{const _0x2556b0=_0x15cdfa,_0x4ca32b=_0x258d26['get'](_0x4931f2[_0x2556b0(0xe8e)]);if(_0x4ca32b)return{'keys':[],'comment':_0x4ca32b[_0x2556b0(0x564)]||'无标题','content':_0x4ca32b[_0x2556b0(0xac4)]||'','enabled':_0x4931f2['enabled']};return null;})['filter'](Boolean));}else{if(_0x3d79e9['entries']&&typeof _0x3d79e9[_0x15cdfa(0xef7)]===_0x15cdfa(0x65a))console[_0x15cdfa(0x90f)](_0x15cdfa(0x374)),Array[_0x15cdfa(0x285)](_0x3d79e9[_0x15cdfa(0x11a3)])?(console[_0x15cdfa(0x90f)](_0x15cdfa(0x13e5)),_0x37e2bd=_0x3d79e9[_0x15cdfa(0x11a3)][_0x15cdfa(0x2e1)](_0x532d47=>_0x3d79e9[_0x15cdfa(0xef7)][_0x532d47])[_0x15cdfa(0x85d)](Boolean)[_0x15cdfa(0x2e1)](_0x48362f=>({'keys':_0x48362f['key']||[],'comment':_0x48362f[_0x15cdfa(0xd6c)]||_0x15cdfa(0x561),'content':_0x48362f['content']||'','enabled':!_0x48362f[_0x15cdfa(0xf3a)]}))):(console['warn']('未在文件中找到\x20\x27order\x27\x20字段，条目可能无法按原始顺序导入。'),_0x37e2bd=Object[_0x15cdfa(0x3d5)](_0x3d79e9['entries'])[_0x15cdfa(0x2e1)](_0x1f3539=>({'keys':_0x1f3539[_0x15cdfa(0x4f3)]||[],'comment':_0x1f3539[_0x15cdfa(0xd6c)]||_0x15cdfa(0x561),'content':_0x1f3539[_0x15cdfa(0xac4)]||'','enabled':!_0x1f3539[_0x15cdfa(0xf3a)]})));else{if(Array[_0x15cdfa(0x285)](_0x3d79e9['prompts']))console[_0x15cdfa(0x90f)](_0x15cdfa(0x77d)),_0x37e2bd=_0x3d79e9[_0x15cdfa(0x11de)][_0x15cdfa(0x2e1)](_0x34c5f2=>({'keys':[],'comment':_0x34c5f2[_0x15cdfa(0x564)]||_0x15cdfa(0xb3c),'content':_0x34c5f2[_0x15cdfa(0xac4)]||'','enabled':!![]}));else throw new Error(_0x15cdfa(0x53a));}}_0x37e2bd=_0x37e2bd[_0x15cdfa(0x85d)](_0x4516a4=>_0x4516a4[_0x15cdfa(0xac4)]);if(_0x37e2bd['length']===0x0){alert('这个预设文件中没有找到任何有效的提示词条目。');return;}const _0x179e40=_0x1cfcb9[_0x15cdfa(0x491)](/\.json$/i,''),_0xfdca08=await _0x9a2c09(_0x15cdfa(0x565),_0x15cdfa(0x4b6),_0x179e40);if(!_0xfdca08||!_0xfdca08[_0x15cdfa(0x9c1)]()){alert(_0x15cdfa(0x13ec));return;}const _0xa2c8d6={'id':_0x15cdfa(0x75f)+Date[_0x15cdfa(0x12d6)](),'name':_0xfdca08[_0x15cdfa(0x9c1)](),'content':_0x37e2bd,'categoryId':null};await _0xb81d4e[_0x15cdfa(0xaa0)][_0x15cdfa(0x807)](_0xa2c8d6),_0x505390[_0x15cdfa(0xaa0)][_0x15cdfa(0x1a0)](_0xa2c8d6),await _0x26c096(),await _0x1519c8(_0x15cdfa(0x10b1),_0x15cdfa(0x3b9)+_0xfdca08+'》。');}async function _0x3f7fde(_0x4a8e42){const _0x10a296=_0x85c4bf,_0x332c6f=document[_0x10a296(0x479)]('offline-preset-select');if(!_0x332c6f)return;const _0x85f478=_0x505390[_0x10a296(0xaa0)]||[];_0x332c6f[_0x10a296(0x3de)]=_0x10a296(0x6f7),_0x85f478['forEach'](_0x502892=>{const _0x5a1125=_0x10a296,_0x12094a=document['createElement'](_0x5a1125(0x9a2));_0x12094a['value']=_0x502892['id'],_0x12094a[_0x5a1125(0x97b)]=_0x502892[_0x5a1125(0x564)],_0x332c6f['appendChild'](_0x12094a);}),_0x4a8e42[_0x10a296(0x18a)][_0x10a296(0x212)]&&(_0x332c6f['value']=_0x4a8e42[_0x10a296(0x18a)][_0x10a296(0x212)]);}function _0x21b744(){const _0x4ac7b6=_0x85c4bf,_0x5d21e0=document[_0x4ac7b6(0x479)]('button-order-editor');if(!_0x5d21e0)return;_0x5d21e0[_0x4ac7b6(0x3de)]='';let _0x2745e8=_0x505390['globalSettings'][_0x4ac7b6(0x9a4)]||_0x4fe226;_0x2745e8[_0x4ac7b6(0x12be)](_0xe122e9=>{const _0x25283e=_0x4ac7b6,_0x3237ea=document[_0x25283e(0x479)](_0xe122e9);if(_0x3237ea){const _0x98f0c6=document[_0x25283e(0xbd5)](_0x25283e(0x6c8));_0x98f0c6[_0x25283e(0xfd4)]='draggable-button-item',_0x98f0c6[_0x25283e(0x182)]=!![],_0x98f0c6['dataset'][_0x25283e(0xb39)]=_0xe122e9,_0x98f0c6['innerHTML']=_0x3237ea['innerHTML'],_0x5d21e0[_0x25283e(0x9f4)](_0x98f0c6);}});}function _0x4af4f0(){const _0x460610=_0x85c4bf,_0x554cf7=document['getElementById'](_0x460610(0x89c));if(!_0x554cf7)return;let _0x1dcc1a=null;const _0x236ee8=_0x2e0596=>{const _0x3678c3=_0x460610,_0x37310e=_0x2e0596[_0x3678c3(0xfa2)][_0x3678c3(0x869)](_0x3678c3(0x53c));if(!_0x37310e)return;_0x1dcc1a=_0x37310e,_0x1dcc1a['classList']['add'](_0x3678c3(0x925));if(_0x2e0596[_0x3678c3(0x520)])_0x2e0596['preventDefault']();},_0x31f676=_0x27fa93=>{const _0x54ce0a=_0x460610;if(!_0x1dcc1a)return;const _0xe09f5=_0x27fa93[_0x54ce0a(0x858)]['includes'](_0x54ce0a(0xcec))?_0x27fa93[_0x54ce0a(0x221)]:_0x27fa93[_0x54ce0a(0x639)][0x0][_0x54ce0a(0x221)],_0x384880=_0x38d2a6(_0x554cf7,_0xe09f5);_0x384880==null?_0x554cf7[_0x54ce0a(0x9f4)](_0x1dcc1a):_0x554cf7[_0x54ce0a(0xe22)](_0x1dcc1a,_0x384880);},_0x55fbc0=()=>{const _0x9747fa=_0x460610;if(!_0x1dcc1a)return;_0x1dcc1a[_0x9747fa(0x9cd)][_0x9747fa(0x8b6)](_0x9747fa(0x925)),_0x1dcc1a=null,_0xeb32b();};_0x554cf7['addEventListener'](_0x460610(0xee9),_0x236ee8),_0x554cf7[_0x460610(0xa75)](_0x460610(0x2a9),_0x236ee8,{'passive':![]}),_0x554cf7[_0x460610(0xa75)](_0x460610(0xaf1),_0x31f676),_0x554cf7[_0x460610(0xa75)](_0x460610(0x56f),_0x31f676,{'passive':![]}),_0x554cf7[_0x460610(0xa75)]('mouseup',_0x55fbc0),_0x554cf7[_0x460610(0xa75)](_0x460610(0x1353),_0x55fbc0),_0x554cf7[_0x460610(0xa75)](_0x460610(0xeba),_0x55fbc0);}function _0x38d2a6(_0x3cbadf,_0x2a3225){const _0x2d08a3=_0x85c4bf,_0x1fbc65=[..._0x3cbadf['querySelectorAll']('.draggable-button-item:not(.dragging)')];return _0x1fbc65[_0x2d08a3(0x1300)]((_0x5eaf04,_0x1c6e6c)=>{const _0x16ec14=_0x2d08a3,_0x3b44df=_0x1c6e6c[_0x16ec14(0x10f7)](),_0x1082a4=_0x2a3225-_0x3b44df[_0x16ec14(0x138f)]-_0x3b44df['width']/0x2;return _0x1082a4<0x0&&_0x1082a4>_0x5eaf04['offset']?{'offset':_0x1082a4,'element':_0x1c6e6c}:_0x5eaf04;},{'offset':Number[_0x2d08a3(0x8ac)]})[_0x2d08a3(0xabf)];}async function _0xeb32b(){const _0x220d8d=_0x85c4bf,_0x50de5c=document['getElementById'](_0x220d8d(0x89c)),_0x4feda8=Array[_0x220d8d(0x22f)](_0x50de5c['querySelectorAll']('.draggable-button-item'))[_0x220d8d(0x2e1)](_0x10d2a3=>_0x10d2a3[_0x220d8d(0x13d4)][_0x220d8d(0xb39)]);_0x505390[_0x220d8d(0x888)]['chatActionButtonsOrder']=_0x4feda8,await _0xb81d4e[_0x220d8d(0x888)][_0x220d8d(0x5d0)](_0x505390['globalSettings']);}function _0x22bc83(){const _0xd0d0c9=_0x85c4bf,_0x374fac=_0x505390['globalSettings'][_0xd0d0c9(0x9a4)];if(!_0x374fac||!Array[_0xd0d0c9(0x285)](_0x374fac)||_0x374fac[_0xd0d0c9(0x990)]===0x0)return;const _0x43e8ba=document[_0xd0d0c9(0x479)](_0xd0d0c9(0x485));if(!_0x43e8ba)return;_0x374fac[_0xd0d0c9(0x12be)](_0x1cf6dc=>{const _0xe5376b=_0xd0d0c9,_0x1cf3fd=document['getElementById'](_0x1cf6dc);_0x1cf3fd&&_0x43e8ba[_0xe5376b(0x9f4)](_0x1cf3fd);});}const _0x4fe226=[_0x85c4bf(0x4ad),_0x85c4bf(0xf1e),_0x85c4bf(0x9b9),_0x85c4bf(0x3b6),'voice-message-btn','send-waimai-request-btn',_0x85c4bf(0x1016),'group-video-call-btn',_0x85c4bf(0x8b0),'share-link-btn',_0x85c4bf(0xadb),_0x85c4bf(0x74e),_0x85c4bf(0x9a1),_0x85c4bf(0xc61),'edit-last-response-btn',_0x85c4bf(0x547),'propel-btn',_0x85c4bf(0xd48),'werewolf-game-btn','read-together-btn'];async function _0x38b1db(){const _0x57e8b1=_0x85c4bf;_0x505390['globalSettings']['chatActionButtonsOrder']=null,await _0xb81d4e['globalSettings']['put'](_0x505390['globalSettings']),_0x21b744(),_0x22bc83(),await _0x1519c8('成功',_0x57e8b1(0x8cc));}let _0x1eef0d=[],_0x95cf56=[];function _0x3be7e1(){const _0x158d0c=_0x85c4bf,_0x2cad23=document[_0x158d0c(0x479)]('data-clear-wizard-modal');_0x1eef0d=[],_0x95cf56=[],_0x30a4c9(),document[_0x158d0c(0x479)](_0x158d0c(0xa78))[_0x158d0c(0x10dd)][_0x158d0c(0x678)]=_0x158d0c(0x899),document[_0x158d0c(0x479)](_0x158d0c(0x9b6))[_0x158d0c(0x10dd)][_0x158d0c(0x678)]='none',_0x2cad23[_0x158d0c(0x9cd)]['add'](_0x158d0c(0x45a));}function _0x30a4c9(){const _0x212ca1=_0x85c4bf,_0x2d5f04=document[_0x212ca1(0x479)](_0x212ca1(0x10fd));_0x2d5f04['innerHTML']='';const _0x5cf79f=document[_0x212ca1(0xbd5)]('div');_0x5cf79f[_0x212ca1(0xfd4)]=_0x212ca1(0x908),_0x5cf79f['dataset'][_0x212ca1(0x101b)]=_0x212ca1(0x4c5),_0x5cf79f['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+(_0x505390[_0x212ca1(0x1190)][_0x212ca1(0x904)]||'我')+_0x212ca1(0x11ff),_0x2d5f04['appendChild'](_0x5cf79f),Object[_0x212ca1(0x3d5)](_0x505390['chats'])[_0x212ca1(0x12be)](_0x48090f=>{const _0x204609=_0x212ca1;if(!_0x48090f['isGroup']){const _0x26a071=document[_0x204609(0xbd5)](_0x204609(0x6c8));_0x26a071[_0x204609(0xfd4)]='clear-posts-item',_0x26a071[_0x204609(0x13d4)][_0x204609(0x101b)]=_0x48090f['id'],_0x26a071[_0x204609(0x3de)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x48090f['name']+_0x204609(0x126c),_0x2d5f04[_0x204609(0x9f4)](_0x26a071);}});}function _0x3afa69(){const _0x51e50b=_0x85c4bf,_0x1ea11b=document[_0x51e50b(0x479)](_0x51e50b(0x583));_0x1ea11b[_0x51e50b(0x3de)]='';const _0x18f789=[{'id':_0x51e50b(0xa50),'name':_0x51e50b(0x12f7),'description':'将清空选定角色的所有对话消息、曾用备注和你的昵称。'},{'id':'qzone','name':'动态与互动','description':'将清空选定角色的所有动态、评论和点赞。'},{'id':'calls','name':_0x51e50b(0x503),'description':_0x51e50b(0xe73)},{'id':_0x51e50b(0x12c2),'name':'心声','description':'将清空选定角色的心声和散记历史。'},{'id':_0x51e50b(0xa2f),'name':_0x51e50b(0xf75),'description':'将清空选定角色的所有长期记忆。'},{'id':_0x51e50b(0x3e8),'name':'收藏','description':_0x51e50b(0x47a)},{'id':'cphone','name':_0x51e50b(0xa33),'description':'将清空角色的相册、QQ、浏览器、淘宝、日记、备忘录等所有模拟手机数据。'}];_0x18f789[_0x51e50b(0x12be)](_0x459ea1=>{const _0x2fdd27=_0x51e50b,_0x4594c9=document[_0x2fdd27(0xbd5)](_0x2fdd27(0x6c8));_0x4594c9['className']='clear-posts-item',_0x4594c9[_0x2fdd27(0x13d4)][_0x2fdd27(0x348)]=_0x459ea1['id'],_0x4594c9['innerHTML']=_0x2fdd27(0x10a9)+_0x459ea1[_0x2fdd27(0x564)]+_0x2fdd27(0xe83)+_0x459ea1[_0x2fdd27(0x78b)]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x1ea11b[_0x2fdd27(0x9f4)](_0x4594c9);});}function _0xddbc58(){const _0x4f2325=_0x85c4bf,_0x3d0c2a=document[_0x4f2325(0x99e)](_0x4f2325(0x1364));if(_0x3d0c2a[_0x4f2325(0x990)]===0x0){alert(_0x4f2325(0x605));return;}_0x1eef0d=Array['from'](_0x3d0c2a)['map'](_0x76b38=>_0x76b38[_0x4f2325(0x13d4)]['charId']),_0x3afa69(),document[_0x4f2325(0x479)](_0x4f2325(0xa78))[_0x4f2325(0x10dd)][_0x4f2325(0x678)]=_0x4f2325(0xff8),document[_0x4f2325(0x479)](_0x4f2325(0x9b6))[_0x4f2325(0x10dd)][_0x4f2325(0x678)]=_0x4f2325(0x899);}function _0x353c55(){const _0x5ced70=_0x85c4bf;document['getElementById'](_0x5ced70(0x9b6))[_0x5ced70(0x10dd)][_0x5ced70(0x678)]=_0x5ced70(0xff8),document['getElementById'](_0x5ced70(0xa78))[_0x5ced70(0x10dd)][_0x5ced70(0x678)]=_0x5ced70(0x899),document[_0x5ced70(0x99e)](_0x5ced70(0x4dd))['forEach'](_0x31d925=>{const _0x59de23=_0x5ced70;_0x1eef0d[_0x59de23(0x44f)](_0x31d925[_0x59de23(0x13d4)][_0x59de23(0x101b)])&&_0x31d925[_0x59de23(0x9cd)][_0x59de23(0x807)](_0x59de23(0x10dc));});}async function _0x2c263d(){const _0x12ec6c=_0x85c4bf,_0x300e92=document[_0x12ec6c(0x99e)](_0x12ec6c(0xeb5));if(_0x300e92[_0x12ec6c(0x990)]===0x0){alert(_0x12ec6c(0x1bb));return;}_0x95cf56=Array[_0x12ec6c(0x22f)](_0x300e92)[_0x12ec6c(0x2e1)](_0x42c31c=>_0x42c31c[_0x12ec6c(0x13d4)][_0x12ec6c(0x348)]);const _0x56e1c2=await _0x1a9e79(_0x12ec6c(0xe53),_0x12ec6c(0xfa8),{'confirmButtonClass':_0x12ec6c(0x95a),'confirmText':'确认删除'});if(!_0x56e1c2)return;await _0x1519c8(_0x12ec6c(0xbd7),_0x12ec6c(0x99a));try{await _0xb81d4e['transaction']('rw',_0xb81d4e['tables'],async()=>{const _0x599d7c=_0x12ec6c;for(const _0x137a89 of _0x1eef0d){for(const _0x507ff5 of _0x95cf56){if(_0x507ff5===_0x599d7c(0xa50)){if(_0x137a89===_0x599d7c(0x4c5)){const _0x58c0e6=await _0xb81d4e[_0x599d7c(0x1027)][_0x599d7c(0x4ba)]();for(const _0x31c420 of _0x58c0e6){_0x31c420['history']=_0x31c420[_0x599d7c(0x7d3)][_0x599d7c(0x85d)](_0x31ed67=>_0x31ed67['role']!==_0x599d7c(0x4c5)),await _0xb81d4e[_0x599d7c(0x1027)][_0x599d7c(0x5d0)](_0x31c420);}}else{const _0x96a207=await _0xb81d4e[_0x599d7c(0x1027)][_0x599d7c(0x111a)](_0x137a89);_0x96a207&&(_0x96a207[_0x599d7c(0x7d3)]=[],_0x96a207[_0x599d7c(0x25c)]='...',_0x96a207['randomJottings']='...',Array[_0x599d7c(0x285)](_0x96a207['nameHistory'])&&(_0x96a207[_0x599d7c(0x102f)]=[]),_0x96a207[_0x599d7c(0x18a)]&&(_0x96a207['settings'][_0x599d7c(0xf58)]='我'),await _0xb81d4e['chats'][_0x599d7c(0x5d0)](_0x96a207));}}if(_0x507ff5===_0x599d7c(0xa79)){const _0xeeffa0=_0x137a89==='user'?'user':_0x137a89;await _0xb81d4e[_0x599d7c(0xcce)][_0x599d7c(0x46f)]('authorId')[_0x599d7c(0x4a2)](_0xeeffa0)[_0x599d7c(0x1ea)]();}_0x507ff5==='calls'&&_0x137a89!=='user'&&await _0xb81d4e['callRecords']['where']('chatId')[_0x599d7c(0x4a2)](_0x137a89)[_0x599d7c(0x1ea)]();if(_0x507ff5===_0x599d7c(0x12c2)&&_0x137a89!==_0x599d7c(0x4c5)){const _0x4198fd=await _0xb81d4e[_0x599d7c(0x1027)][_0x599d7c(0x111a)](_0x137a89);_0x4198fd&&(_0x4198fd[_0x599d7c(0x57e)]=[],_0x4198fd['heartfeltVoice']=_0x599d7c(0x4d0),_0x4198fd[_0x599d7c(0x2cf)]=_0x599d7c(0x4d0),await _0xb81d4e[_0x599d7c(0x1027)][_0x599d7c(0x5d0)](_0x4198fd));}if(_0x507ff5===_0x599d7c(0xa2f)&&_0x137a89!==_0x599d7c(0x4c5)){const _0x2c2c62=await _0xb81d4e[_0x599d7c(0x1027)][_0x599d7c(0x111a)](_0x137a89);_0x2c2c62&&(_0x2c2c62[_0x599d7c(0x3b4)]=[],await _0xb81d4e[_0x599d7c(0x1027)]['put'](_0x2c2c62));}_0x507ff5===_0x599d7c(0x3e8)&&(_0x137a89===_0x599d7c(0x4c5)?(await _0xb81d4e[_0x599d7c(0x3e8)]['where'](_0x599d7c(0x858))['equals']('qzone_post')[_0x599d7c(0x85d)](_0x48c329=>_0x48c329[_0x599d7c(0xac4)][_0x599d7c(0x981)]===_0x599d7c(0x4c5))[_0x599d7c(0x1ea)](),await _0xb81d4e[_0x599d7c(0x3e8)][_0x599d7c(0x46f)](_0x599d7c(0x858))[_0x599d7c(0x4a2)](_0x599d7c(0xeab))[_0x599d7c(0x85d)](_0x512f37=>_0x512f37[_0x599d7c(0xac4)]['role']==='user')['delete']()):(await _0xb81d4e[_0x599d7c(0x3e8)][_0x599d7c(0x46f)]('type')['equals'](_0x599d7c(0xeab))['and'](_0x3937=>_0x3937[_0x599d7c(0xd4e)]===_0x137a89)[_0x599d7c(0x1ea)](),await _0xb81d4e['favorites']['where']('type')[_0x599d7c(0x4a2)]('qzone_post')[_0x599d7c(0x85d)](_0xf62900=>_0xf62900['content'][_0x599d7c(0x981)]===_0x137a89)[_0x599d7c(0x1ea)](),await _0xb81d4e[_0x599d7c(0x3e8)][_0x599d7c(0x46f)](_0x599d7c(0x858))[_0x599d7c(0x4a2)](_0x599d7c(0x8a1))[_0x599d7c(0x85d)](_0x4b690f=>_0x4b690f['content'][_0x599d7c(0x8cb)]===_0x137a89)[_0x599d7c(0x1ea)](),await _0xb81d4e[_0x599d7c(0x3e8)][_0x599d7c(0x46f)](_0x599d7c(0x858))[_0x599d7c(0x4a2)](_0x599d7c(0x5aa))[_0x599d7c(0x85d)](_0x50dab0=>_0x50dab0[_0x599d7c(0xac4)]['characterId']===_0x137a89)['delete'](),await _0xb81d4e['favorites'][_0x599d7c(0x46f)](_0x599d7c(0x858))['equals'](_0x599d7c(0x96c))['filter'](_0x25b727=>_0x25b727[_0x599d7c(0xac4)][_0x599d7c(0x8cb)]===_0x137a89)[_0x599d7c(0x1ea)]()));if(_0x507ff5===_0x599d7c(0x728)&&_0x137a89!=='user'){const _0x597229=await _0xb81d4e[_0x599d7c(0x1027)][_0x599d7c(0x111a)](_0x137a89);_0x597229&&(_0x597229[_0x599d7c(0xd9a)]=[],_0x597229[_0x599d7c(0xf45)]=[],_0x597229[_0x599d7c(0xe2a)]=[],_0x597229[_0x599d7c(0x442)]=null,_0x597229[_0x599d7c(0x551)]=[],_0x597229[_0x599d7c(0x4d2)]=[],_0x597229[_0x599d7c(0xb0d)]=[],_0x597229[_0x599d7c(0xf14)]=[],_0x597229[_0x599d7c(0x1325)]=[],await _0xb81d4e[_0x599d7c(0x1027)][_0x599d7c(0x5d0)](_0x597229));}}}}),await _0x361f5e(),await _0x1b7f69(),document[_0x12ec6c(0x479)]('data-clear-wizard-modal')[_0x12ec6c(0x9cd)][_0x12ec6c(0x8b6)]('visible'),await _0x1519c8(_0x12ec6c(0xab6),'指定的数据已成功清除。');}catch(_0x269cb7){console[_0x12ec6c(0xe3b)](_0x12ec6c(0x9f3),_0x269cb7),await _0x1519c8(_0x12ec6c(0x83e),'操作失败:\x20'+_0x269cb7[_0x12ec6c(0x757)]);}}async function _0x14a5e4(_0x5ba8ba,_0x35849a,_0x55ecfe){const _0xd527da=_0x85c4bf,_0xce43aa=_0x55ecfe[_0xd527da(0x8bc)](_0xd527da(0xd21))['alt'],_0x355c77=await _0x5adb5e(_0xd527da(0x5b7)+_0xce43aa+_0xd527da(0x746),[{'text':_0xd527da(0x83f),'value':_0xd527da(0x8d3)},{'text':_0xd527da(0x10d7),'value':_0xd527da(0x5f3)}]);let _0x3b1199=null;if(_0x355c77===_0xd527da(0x8d3))_0x3b1199=await _0x1ec1dd();else{if(_0x355c77===_0xd527da(0x5f3)){const _0x272f06=_0x35849a==='cphone'?_0x505390[_0xd527da(0x888)][_0xd527da(0x2f6)][_0x5ba8ba]:_0x505390['globalSettings'][_0xd527da(0x12ca)][_0x5ba8ba],_0x549305=_0x272f06['startsWith'](_0xd527da(0x631)),_0x20d254=_0x549305?'':_0x272f06;_0x3b1199=await _0x9a2c09(_0xd527da(0x1196),'请输入新的图片URL',_0x20d254,_0xd527da(0x5f3));}}if(_0x3b1199&&_0x3b1199[_0xd527da(0x9c1)]()){const _0xf8cb1d=_0x3b1199[_0xd527da(0x9c1)]();_0x35849a===_0xd527da(0x728)?_0x505390[_0xd527da(0x888)][_0xd527da(0x2f6)][_0x5ba8ba]=_0xf8cb1d:_0x505390[_0xd527da(0x888)][_0xd527da(0x12ca)][_0x5ba8ba]=_0xf8cb1d,_0x55ecfe['querySelector'](_0xd527da(0xd21))[_0xd527da(0xa9c)]=_0xf8cb1d;}else _0x3b1199!==null&&alert('请输入一个有效的URL或选择一个文件！');}async function _0x54f3cf(){const _0x1594c6=_0x85c4bf,_0x1c4038=await _0x1a9e79('确认压缩图片？',_0x1594c6(0xdcb),{'confirmButtonClass':_0x1594c6(0x95a),'confirmText':_0x1594c6(0x124c)});if(!_0x1c4038)return;await _0x1519c8(_0x1594c6(0xbd7),_0x1594c6(0x121a));let _0x5142b2={'found':0x0,'compressed':0x0,'skipped':0x0,'originalSize':0x0,'newSize':0x0};try{console['log'](_0x1594c6(0x1075));const _0x234ed3=['chats',_0x1594c6(0x888),'qzoneSettings','userStickers',_0x1594c6(0x640)],_0x47e3e8=[];for(const _0x505c2b of _0x234ed3){const _0x35476e=_0xb81d4e[_0x1594c6(0x4d7)](_0x505c2b),_0x3df459=await _0x35476e['toArray']();_0x47e3e8['push']({'tableName':_0x505c2b,'records':_0x3df459});}console[_0x1594c6(0x90f)](_0x1594c6(0x73a));for(const _0x470435 of _0x47e3e8){for(const _0x4fb605 of _0x470435[_0x1594c6(0x1395)]){await _0x3c2c99(_0x4fb605,_0x5142b2);}}console['log']('压缩步骤\x203/3:\x20正在将压缩后的数据写回数据库...'),await _0xb81d4e['transaction']('rw',_0x234ed3,async()=>{const _0x579375=_0x1594c6;for(const _0x47e437 of _0x47e3e8){await _0xb81d4e[_0x579375(0x4d7)](_0x47e437[_0x579375(0xcf5)])[_0x579375(0x100e)](_0x47e437[_0x579375(0x1395)]);}});const _0x3b5538=_0x5142b2['originalSize']-_0x5142b2[_0x1594c6(0x2e6)],_0x5ef1ec=_0x5142b2[_0x1594c6(0xea9)]>0x0?(_0x3b5538/_0x5142b2['originalSize']*0x64)['toFixed'](0x2):0x0;await _0x1519c8(_0x1594c6(0x515),_0x1594c6(0xa3b)+_0x5142b2[_0x1594c6(0x2a1)]+_0x1594c6(0xcf6)+_0x5142b2[_0x1594c6(0x2ba)]+_0x1594c6(0x964)+_0x5142b2[_0x1594c6(0xa3c)]+_0x1594c6(0x5c0)+(_0x3b5538/0x400/0x400)['toFixed'](0x2)+_0x1594c6(0x1d6)+_0x5ef1ec+_0x1594c6(0x1304));}catch(_0x234382){console[_0x1594c6(0xe3b)](_0x1594c6(0xb6b),_0x234382),await _0x1519c8('压缩失败','操作失败:\x20'+_0x234382['message']);}}function _0x7276ba(_0x2984de,_0x4ead6b=''){const _0x3a4503=_0x85c4bf;let _0x237ba3=0x0;for(const _0x2b821e in _0x2984de){if(_0x2984de[_0x3a4503(0x119e)](_0x2b821e)){const _0x28c52d=_0x2984de[_0x2b821e];if(typeof _0x28c52d===_0x3a4503(0x8d9)&&_0x28c52d[_0x3a4503(0x591)](_0x3a4503(0x631))){const _0x3fbc91=_0x4ead6b===_0x3a4503(0x888)&&(_0x2b821e===_0x3a4503(0x73f)||_0x2b821e==='cphoneWallpaper'||_0x2b821e===_0x3a4503(0x960))||_0x4ead6b===_0x3a4503(0xd79)||_0x4ead6b===_0x3a4503(0x18a)&&_0x2b821e===_0x3a4503(0x7fb)||(_0x4ead6b===_0x3a4503(0x12ca)||_0x4ead6b==='cphoneAppIcons');!_0x3fbc91&&(_0x237ba3+=_0x28c52d['length']);}else typeof _0x28c52d===_0x3a4503(0x65a)&&_0x28c52d!==null&&(_0x237ba3+=_0x7276ba(_0x28c52d,_0x2b821e));}}return _0x237ba3;}async function _0x3d5843(){const _0xfbdd56=_0x85c4bf,_0x27b0e7=document['getElementById'](_0xfbdd56(0x536));if(!_0x27b0e7)return;_0x27b0e7[_0xfbdd56(0x3de)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>正在计算可压缩图片大小...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22>--\x20MB</span>\x0a\x20\x20\x20\x20';try{let _0x5afa5f=0x0;const _0x5d3e59=['chats',_0xfbdd56(0x888),_0xfbdd56(0x1190),_0xfbdd56(0x407),'customAvatarFrames'];for(const _0x528858 of _0x5d3e59){const _0x511349=_0xb81d4e[_0xfbdd56(0x4d7)](_0x528858);await _0x511349[_0xfbdd56(0x12f9)](_0x339408=>{_0x5afa5f+=_0x7276ba(_0x339408);});}const _0x5ae5c0=(_0x5afa5f/0x400/0x400)[_0xfbdd56(0x6e1)](0x2);_0x27b0e7[_0xfbdd56(0x3de)]=_0xfbdd56(0xace)+_0x5ae5c0+_0xfbdd56(0x452);}catch(_0x5d379a){console[_0xfbdd56(0xe3b)](_0xfbdd56(0x237),_0x5d379a),_0x27b0e7[_0xfbdd56(0x3de)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>计算图片大小时出错</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22>Error</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}async function _0x3c2c99(_0x444b52,_0x5d3b5a,_0x3455e2=''){const _0x153706=_0x85c4bf;for(const _0x286978 in _0x444b52){if(_0x444b52['hasOwnProperty'](_0x286978)){const _0x3ab146=_0x444b52[_0x286978];if(typeof _0x3ab146==='string'&&_0x3ab146[_0x153706(0x591)](_0x153706(0x631))){const _0x3fb5e5=_0x3455e2===_0x153706(0x888)&&(_0x286978===_0x153706(0x73f)||_0x286978===_0x153706(0x77b)||_0x286978==='globalChatBackground')||_0x3455e2===_0x153706(0xd79)||_0x3455e2==='settings'&&_0x286978===_0x153706(0x7fb)||(_0x3455e2===_0x153706(0x12ca)||_0x3455e2===_0x153706(0x2f6));if(_0x3fb5e5)continue;_0x5d3b5a[_0x153706(0x2a1)]++,_0x5d3b5a['originalSize']+=_0x3ab146['length'];const _0x5ec4a3=await _0x3c00c7(_0x3ab146);_0x5ec4a3&&_0x5ec4a3!==_0x3ab146?(_0x444b52[_0x286978]=_0x5ec4a3,_0x5d3b5a[_0x153706(0x2ba)]++,_0x5d3b5a[_0x153706(0x2e6)]+=_0x5ec4a3[_0x153706(0x990)]):(_0x5d3b5a[_0x153706(0xa3c)]++,_0x5d3b5a['newSize']+=_0x3ab146[_0x153706(0x990)]);}else typeof _0x3ab146===_0x153706(0x65a)&&_0x3ab146!==null&&await _0x3c2c99(_0x3ab146,_0x5d3b5a,_0x286978);}}}function _0x3c00c7(_0x3e401b,_0x1f493b={}){return new Promise(_0x1b8380=>{const _0x1bf3bf=_0x6666;if(!_0x3e401b[_0x1bf3bf(0x591)](_0x1bf3bf(0x631))){console[_0x1bf3bf(0x139e)](_0x1bf3bf(0x1b1),_0x3e401b[_0x1bf3bf(0x1323)](0x0,0x32)+'...'),_0x1b8380(_0x3e401b);return;}const _0xf5613f=_0x1f493b[_0x1bf3bf(0x1077)]||0.5,_0x2f9558=_0x1f493b[_0x1bf3bf(0x116e)]||0x320,_0x345606=new Image();_0x345606[_0x1bf3bf(0x502)]=()=>{const _0x25be9d=_0x1bf3bf;let _0x4d29e0=_0x345606[_0x25be9d(0x9f2)],_0x7d18aa=_0x345606[_0x25be9d(0xe41)];_0x4d29e0>_0x2f9558&&(_0x7d18aa=Math['round'](_0x2f9558/_0x4d29e0*_0x7d18aa),_0x4d29e0=_0x2f9558);const _0x2f9a31=document[_0x25be9d(0xbd5)](_0x25be9d(0xc01));_0x2f9a31['width']=_0x4d29e0,_0x2f9a31[_0x25be9d(0xe41)]=_0x7d18aa;const _0x19eb8c=_0x2f9a31[_0x25be9d(0x1b4)]('2d');_0x19eb8c[_0x25be9d(0x109d)](_0x345606,0x0,0x0,_0x4d29e0,_0x7d18aa);const _0x18dd53=_0x2f9a31[_0x25be9d(0x455)](_0x25be9d(0xb3b),_0xf5613f);_0x1b8380(_0x18dd53);},_0x345606['onerror']=()=>{const _0xbe7687=_0x1bf3bf;console[_0xbe7687(0x139e)]('加载图片失败，跳过压缩:',_0x3e401b[_0xbe7687(0x1323)](0x0,0x32)+_0xbe7687(0x4d0)),_0x1b8380(_0x3e401b);},_0x345606[_0x1bf3bf(0xa9c)]=_0x3e401b;});}function _0xbc544a(_0xa07699,_0x50808a){const _0x323337=_0x85c4bf;if(!_0xa07699||!_0x50808a||typeof _0xa07699!==_0x323337(0x8d9)||typeof _0x50808a!==_0x323337(0x8d9))return 0x0;const _0x482a88=_0xa07699[_0x323337(0x53e)]('.')['map'](Number),_0x3161d5=_0x50808a[_0x323337(0x53e)]('.')[_0x323337(0x2e1)](Number),_0xe4582f=Math['max'](_0x482a88[_0x323337(0x990)],_0x3161d5['length']);for(let _0x368cf0=0x0;_0x368cf0<_0xe4582f;_0x368cf0++){const _0x2f3507=_0x482a88[_0x368cf0]||0x0,_0x406e26=_0x3161d5[_0x368cf0]||0x0;if(_0x2f3507>_0x406e26)return 0x1;if(_0x2f3507<_0x406e26)return-0x1;}return 0x0;}async function _0x408380(){const _0x52c1be=_0x85c4bf,_0x40d424=_0x52c1be(0x95e);try{const _0x60dd1e=await fetch(_0x52c1be(0x13eb)+Date[_0x52c1be(0x12d6)]());if(!_0x60dd1e['ok']){console['warn']('获取更新通知文件失败。');return;}const _0x9790fc=await _0x60dd1e[_0x52c1be(0x56d)](),_0x1131f4=document[_0x52c1be(0xbd5)](_0x52c1be(0x6c8));_0x1131f4[_0x52c1be(0x3de)]=_0x9790fc;const _0x28e24b=_0x1131f4[_0x52c1be(0x8bc)](_0x52c1be(0x5f6));if(!_0x28e24b){console['error'](_0x52c1be(0xf02));return;}const _0x240abc=_0x28e24b[_0x52c1be(0x13d4)][_0x52c1be(0x1094)],_0x56eca4=localStorage[_0x52c1be(0x28f)](_0x52c1be(0xf60));!_0x56eca4||_0xbc544a(_0x240abc,_0x56eca4)>0x0?(console[_0x52c1be(0x90f)]('发现新版本通知:\x20'+_0x240abc+_0x52c1be(0xb75)+(_0x56eca4||'无')+')'),_0x3262a2(_0x240abc,_0x28e24b[_0x52c1be(0x3de)])):console[_0x52c1be(0x90f)](_0x52c1be(0x849)+_0x240abc+_0x52c1be(0xec1));}catch(_0xe3d8d9){console[_0x52c1be(0xe3b)](_0x52c1be(0xf85),_0xe3d8d9);}}function _0x3262a2(_0x1b1830,_0x44e873){const _0x4f10d6=_0x85c4bf,_0x5b40b0=document[_0x4f10d6(0x479)](_0x4f10d6(0x2ca)),_0x299dac=document['getElementById'](_0x4f10d6(0x11f7)),_0x4e5d07=document['getElementById'](_0x4f10d6(0xc6a)),_0x543864=document['getElementById'](_0x4f10d6(0x7f8));_0x299dac[_0x4f10d6(0x3de)]=_0x44e873,_0x4e5d07['onclick']=()=>{const _0x42e5a1=_0x4f10d6;_0x5b40b0['classList'][_0x42e5a1(0x8b6)](_0x42e5a1(0x45a));},_0x543864[_0x4f10d6(0x1063)]=()=>{const _0x2b0192=_0x4f10d6;localStorage[_0x2b0192(0x3f0)](_0x2b0192(0xf60),_0x1b1830),_0x5b40b0[_0x2b0192(0x9cd)][_0x2b0192(0x8b6)](_0x2b0192(0x45a)),console[_0x2b0192(0x90f)](_0x2b0192(0xd66)+_0x1b1830);},_0x5b40b0[_0x4f10d6(0x9cd)][_0x4f10d6(0x807)]('visible');}function _0x2553ab(){const _0x24f33f=_0x85c4bf,_0x5b773f=document[_0x24f33f(0x479)](_0x24f33f(0x1386));document[_0x24f33f(0x479)]('douban-min-posts-input')[_0x24f33f(0x4e0)]=_0x505390['globalSettings'][_0x24f33f(0x125f)]||0xc,document['getElementById'](_0x24f33f(0x22a))['value']=_0x505390[_0x24f33f(0x888)][_0x24f33f(0x53d)]||0x14,_0x5b773f[_0x24f33f(0x9cd)][_0x24f33f(0x807)]('visible');}async function _0x3737ca(){const _0x323551=_0x85c4bf,_0x377910=document[_0x323551(0x479)]('douban-min-posts-input'),_0x52833e=document[_0x323551(0x479)](_0x323551(0x22a)),_0x144563=parseInt(_0x377910[_0x323551(0x4e0)]),_0x40f7bc=parseInt(_0x52833e[_0x323551(0x4e0)]);if(isNaN(_0x144563)||isNaN(_0x40f7bc)||_0x144563<0x1||_0x40f7bc<0x1){alert('请输入有效的正整数！');return;}if(_0x144563>_0x40f7bc){alert(_0x323551(0xfad));return;}_0x505390[_0x323551(0x888)][_0x323551(0x125f)]=_0x144563,_0x505390[_0x323551(0x888)]['doubanMaxPosts']=_0x40f7bc,await _0xb81d4e[_0x323551(0x888)][_0x323551(0x5d0)](_0x505390[_0x323551(0x888)]),document[_0x323551(0x479)](_0x323551(0x1386))[_0x323551(0x9cd)][_0x323551(0x8b6)]('visible'),await _0x1519c8(_0x323551(0x8fa),_0x323551(0x38f));}async function _0x1e4cd5(_0x29eac9){const _0x69da71=_0x85c4bf,_0x37509b=document[_0x69da71(0x479)](_0x69da71(0x1a3)),_0x543925=document[_0x69da71(0x479)](_0x69da71(0x11d2));_0x543925[_0x69da71(0x3de)]='';let _0x4cdabb=[];if(_0x29eac9===_0x69da71(0xb48)){const _0x2b3838=Object[_0x69da71(0x3d5)](_0x505390['chats'])[_0x69da71(0x85d)](_0x8f1fe0=>!_0x8f1fe0[_0x69da71(0x9d7)]),_0x41c0a4=await _0xb81d4e['npcs'][_0x69da71(0x4ba)]();_0x4cdabb=[{'id':'user','name':_0x505390[_0x69da71(0x1190)][_0x69da71(0x904)]||'我','originalName':_0x505390['qzoneSettings'][_0x69da71(0x904)]||'我','avatar':_0x505390[_0x69da71(0x1190)]['avatar'],'type':_0x69da71(0x4c5)},..._0x2b3838[_0x69da71(0x2e1)](_0x59703f=>({'id':_0x59703f['id'],'name':_0x59703f[_0x69da71(0x564)],'originalName':_0x59703f['originalName'],'avatar':_0x59703f[_0x69da71(0x18a)][_0x69da71(0x1039)],'type':'character'})),..._0x41c0a4[_0x69da71(0x2e1)](_0x35f1fb=>({'id':_0x69da71(0xca5)+_0x35f1fb['id'],'name':_0x35f1fb[_0x69da71(0x564)],'originalName':_0x35f1fb['name'],'avatar':_0x35f1fb[_0x69da71(0x799)],'type':_0x69da71(0x71b)}))],_0x511f5d[_0x69da71(0xd4e)]=null;}else{const _0x38bddd=_0x505390[_0x69da71(0x1027)][_0x505390['activeChatId']];if(!_0x38bddd||!_0x38bddd[_0x69da71(0x9d7)])return;_0x4cdabb=[{'id':_0x69da71(0x4c5),'name':_0x38bddd[_0x69da71(0x18a)]['myNickname']||'我','originalName':_0x505390[_0x69da71(0x1190)][_0x69da71(0x904)]||'我','avatar':_0x38bddd[_0x69da71(0x18a)][_0x69da71(0xe28)],'type':'user'},..._0x38bddd[_0x69da71(0x954)][_0x69da71(0x2e1)](_0x48fc11=>{const _0x41062b=_0x69da71,_0xf62702=_0x505390[_0x41062b(0x1027)][_0x48fc11['id']],_0x5b2fb5=_0x48fc11['avatar']||(_0xf62702?_0xf62702[_0x41062b(0x18a)][_0x41062b(0x1039)]:_0x3ea4df);return{'id':_0x48fc11['id'],'name':_0x48fc11[_0x41062b(0xa54)],'originalName':_0x48fc11[_0x41062b(0xe2d)],'avatar':_0x5b2fb5,'type':_0x48fc11[_0x41062b(0x95f)]?_0x41062b(0x71b):_0x41062b(0x390)};})],_0x511f5d['chatId']=_0x505390[_0x69da71(0x233)];}_0x4cdabb[_0x69da71(0x12be)](_0x3ae5fe=>{const _0x519414=_0x69da71,_0x479d93=document[_0x519414(0xbd5)](_0x519414(0x6c8));_0x479d93[_0x519414(0xfd4)]='contact-picker-item',_0x479d93['innerHTML']=_0x519414(0x102e)+JSON[_0x519414(0x1308)](_0x3ae5fe)+'\x27\x20'+(_0x3ae5fe[_0x519414(0x858)]===_0x519414(0x4c5)?'checked\x20disabled':_0x519414(0xf7b))+_0x519414(0x131d)+_0x3ae5fe[_0x519414(0x799)]+_0x519414(0xbd8)+_0x3ae5fe[_0x519414(0x564)]+_0x519414(0xa8b),_0x543925[_0x519414(0x9f4)](_0x479d93);}),_0x37509b['classList'][_0x69da71(0x807)]('visible');}async function _0x4b25ad(){const _0x5bcb1f=_0x85c4bf,_0x403fb4=document[_0x5bcb1f(0x99e)](_0x5bcb1f(0x4d9)),_0x35c064=_0x403fb4['length'];let _0x523ea6=[];if(_0x35c064===0x6)_0x511f5d[_0x5bcb1f(0xabd)]='6p',_0x523ea6=['狼人','狼人','平民','平民',_0x5bcb1f(0x1250),'猎人'];else{if(_0x35c064===0x9)_0x511f5d['gameMode']='9p',_0x523ea6=['狼人','狼人','狼人','平民','平民','平民',_0x5bcb1f(0x1250),'女巫','猎人'];else{if(_0x35c064===0xc)_0x511f5d[_0x5bcb1f(0xabd)]=_0x5bcb1f(0xa5d),_0x523ea6=['狼人','狼人','狼人','狼人','平民','平民','平民','平民',_0x5bcb1f(0x1250),'女巫','猎人','守卫'];else{alert(_0x5bcb1f(0xac5)+_0x35c064+_0x5bcb1f(0x130c));return;}}}document[_0x5bcb1f(0x479)](_0x5bcb1f(0x1a3))[_0x5bcb1f(0x9cd)][_0x5bcb1f(0x8b6)]('visible'),await _0x1519c8(_0x5bcb1f(0xb9b),'游戏即将开始，正在为各位玩家分配身份...');for(let _0x24d3aa=_0x523ea6[_0x5bcb1f(0x990)]-0x1;_0x24d3aa>0x0;_0x24d3aa--){const _0x4e2b64=Math['floor'](Math[_0x5bcb1f(0x103a)]()*(_0x24d3aa+0x1));[_0x523ea6[_0x24d3aa],_0x523ea6[_0x4e2b64]]=[_0x523ea6[_0x4e2b64],_0x523ea6[_0x24d3aa]];}const _0x395d7a=Array[_0x5bcb1f(0x22f)](_0x403fb4)['map'](_0x2dd81d=>JSON[_0x5bcb1f(0x94c)](_0x2dd81d[_0x5bcb1f(0x13d4)][_0x5bcb1f(0x21a)]));_0x511f5d['players']=[];for(let _0x353f77=0x0;_0x353f77<_0x395d7a[_0x5bcb1f(0x990)];_0x353f77++){const _0x292c9a=_0x395d7a[_0x353f77],_0x1995e5=_0x523ea6[_0x353f77];let _0x4fb40f='一个普通玩家';if(_0x292c9a[_0x5bcb1f(0x858)]===_0x5bcb1f(0x390)){const _0x806b75=_0x505390[_0x5bcb1f(0x1027)][_0x292c9a['id']];_0x4fb40f=_0x806b75?_0x806b75[_0x5bcb1f(0x18a)][_0x5bcb1f(0x11f6)]:_0x5bcb1f(0x2fb);}else{if(_0x292c9a['type']===_0x5bcb1f(0x71b)){const _0x1ee788=await _0xb81d4e[_0x5bcb1f(0x482)][_0x5bcb1f(0x4ba)](),_0x2d4343=_0x1ee788[_0x5bcb1f(0xc0d)](_0x245f6f=>'npc_'+_0x245f6f['id']===_0x292c9a['id']);_0x4fb40f=_0x2d4343?_0x2d4343['persona']:_0x5bcb1f(0x5c9);}else{if(_0x292c9a[_0x5bcb1f(0x858)]===_0x5bcb1f(0x4c5)){const _0x327240=_0x511f5d[_0x5bcb1f(0xd4e)]?_0x505390['chats'][_0x511f5d['chatId']]:null;_0x4fb40f=_0x327240?_0x327240[_0x5bcb1f(0x18a)][_0x5bcb1f(0x12d7)]:_0x5bcb1f(0x13ae);}}}const _0x2fa93d={..._0x292c9a,'role':_0x1995e5,'isAlive':!![],'character_persona':_0x4fb40f};_0x1995e5==='女巫'&&(_0x2fa93d['antidoteUsed']=![],_0x2fa93d[_0x5bcb1f(0x74a)]=![]),_0x1995e5==='守卫'&&(_0x2fa93d[_0x5bcb1f(0x944)]=null),_0x511f5d[_0x5bcb1f(0xf4f)][_0x5bcb1f(0x1a0)](_0x2fa93d);}_0x511f5d[_0x5bcb1f(0x4c3)]=!![],_0x511f5d[_0x5bcb1f(0xa0b)]=0x1,_0x511f5d[_0x5bcb1f(0x12f2)]='start',_0x511f5d['gameLog']=[],_0x511f5d[_0x5bcb1f(0x29e)]=[];const _0x753fa2=_0x523ea6[_0x5bcb1f(0x1300)]((_0x39a27a,_0x1f6b8b)=>{return _0x39a27a[_0x1f6b8b]=(_0x39a27a[_0x1f6b8b]||0x0)+0x1,_0x39a27a;},{}),_0x32a6ee=Object[_0x5bcb1f(0xef7)](_0x753fa2)['map'](([_0x5212ca,_0xaba16a])=>_0x5212ca+'\x20x'+_0xaba16a)[_0x5bcb1f(0x35d)]('、');_0x2365f0(_0x5bcb1f(0x40e)+_0x35c064+'人局，身份为\x20'+_0x32a6ee+'。');const _0x38ae54=_0x511f5d[_0x5bcb1f(0xf4f)][_0x5bcb1f(0xc0d)](_0x1068ef=>_0x1068ef['id']==='user');_0x12b3de(),_0x731d5(_0x5bcb1f(0x427)),_0x228e17(_0x38ae54[_0x5bcb1f(0x508)]);}function _0x12b3de(){const _0x461b17=_0x85c4bf,_0x44c3bd=document[_0x461b17(0x479)](_0x461b17(0xe79));_0x44c3bd[_0x461b17(0x3de)]='';const _0x4aa728=[..._0x511f5d[_0x461b17(0xf4f)]][_0x461b17(0x382)]((_0x2c8d5d,_0x1f6d2a)=>_0x2c8d5d[_0x461b17(0x6a2)]-_0x1f6d2a[_0x461b17(0x6a2)]);_0x4aa728[_0x461b17(0x12be)]((_0x1dad6f,_0x479830)=>{const _0x2010bd=_0x461b17,_0x592975=_0x511f5d[_0x2010bd(0xf4f)][_0x2010bd(0x120c)](_0x4a0e62=>_0x4a0e62['id']===_0x1dad6f['id'])+0x1,_0x698274=document[_0x2010bd(0xbd5)](_0x2010bd(0x6c8));_0x698274[_0x2010bd(0xfd4)]=_0x2010bd(0x6ec);if(!_0x1dad6f[_0x2010bd(0x6a2)])_0x698274[_0x2010bd(0x9cd)]['add'](_0x2010bd(0x731));_0x698274[_0x2010bd(0x3de)]=_0x2010bd(0x9eb)+_0x1dad6f[_0x2010bd(0x799)]+_0x2010bd(0x3e4)+_0x592975+'.\x20'+_0x1dad6f['name']+_0x2010bd(0xa8b),_0x44c3bd[_0x2010bd(0x9f4)](_0x698274);});const _0xde7d0a=document[_0x461b17(0x479)](_0x461b17(0x1189));_0xde7d0a[_0x461b17(0x3de)]='';for(let _0x41fe64=0x1;_0x41fe64<=_0x511f5d[_0x461b17(0xa0b)];_0x41fe64++){const _0x2502bf=[..._0x511f5d['gameLog'][_0x461b17(0x85d)](_0x598ddc=>_0x598ddc[_0x461b17(0x1306)]===_0x41fe64),..._0x511f5d[_0x461b17(0x29e)][_0x461b17(0x85d)](_0x59a3c2=>_0x59a3c2[_0x461b17(0x1306)]===_0x41fe64)]['sort']((_0x3eafe7,_0xf6e62c)=>(_0x3eafe7['timestamp']||0x0)-(_0xf6e62c['timestamp']||0x0));if(_0x2502bf[_0x461b17(0x990)]>0x0){const _0x19205c=document[_0x461b17(0xbd5)](_0x461b17(0x6c8));_0x19205c[_0x461b17(0xfd4)]='werewolf-log-entry\x20system',_0x19205c[_0x461b17(0x97b)]='---\x20第\x20'+_0x41fe64+_0x461b17(0x1286),_0x19205c[_0x461b17(0x10dd)][_0x461b17(0x506)]=_0x461b17(0x401),_0xde7d0a[_0x461b17(0x9f4)](_0x19205c),_0x2502bf[_0x461b17(0x12be)](_0x1c2221=>{const _0x45fdfe=_0x461b17,_0x326f82=document[_0x45fdfe(0xbd5)](_0x45fdfe(0x6c8));_0x326f82['className']=_0x45fdfe(0x58f)+_0x1c2221[_0x45fdfe(0x858)],_0x1c2221[_0x45fdfe(0x858)]===_0x45fdfe(0xfba)?_0x326f82['innerHTML']=_0x45fdfe(0x38b)+_0x1c2221[_0x45fdfe(0xc9d)]+_0x45fdfe(0x12f3)+_0x1c2221['content']:_0x326f82[_0x45fdfe(0x97b)]=_0x1c2221[_0x45fdfe(0xac4)],_0xde7d0a[_0x45fdfe(0x9f4)](_0x326f82);});}}_0xde7d0a[_0x461b17(0x2b3)]=_0xde7d0a[_0x461b17(0x9c5)];const _0x1f0a02={'start':'游戏开始','night':'第'+_0x511f5d[_0x461b17(0xa0b)]+_0x461b17(0x2c9),'day':'第'+_0x511f5d[_0x461b17(0xa0b)]+_0x461b17(0x8e7),'discussion':'第'+_0x511f5d['currentDay']+_0x461b17(0xa87),'voting':'第'+_0x511f5d[_0x461b17(0xa0b)]+_0x461b17(0x7e9),'gameover':_0x461b17(0x53b)};document['getElementById']('werewolf-game-title')['textContent']='狼人杀\x20-\x20'+(_0x1f0a02[_0x511f5d[_0x461b17(0x12f2)]]||_0x511f5d[_0x461b17(0x12f2)]);}function _0x228e17(_0x41c79d){const _0x305f5b=_0x85c4bf,_0x31623b={'狼人':'你的目标是杀死所有好人。每晚可以和同伴一起刀一个玩家。','平民':_0x305f5b(0xfd8),'预言家':_0x305f5b(0x3d7),'猎人':_0x305f5b(0x7ac),'女巫':_0x305f5b(0x129b),'守卫':_0x305f5b(0xbc5)};document[_0x305f5b(0x479)](_0x305f5b(0x10f4))[_0x305f5b(0x97b)]=_0x41c79d,document[_0x305f5b(0x479)]('werewolf-role-description')[_0x305f5b(0x97b)]=_0x31623b[_0x41c79d]||_0x305f5b(0x627),document['getElementById']('werewolf-role-modal')[_0x305f5b(0x9cd)][_0x305f5b(0x807)](_0x305f5b(0x45a));}async function _0x1a4323(){const _0x2f0ab2=_0x85c4bf;_0x511f5d[_0x2f0ab2(0x12f2)]='第'+_0x511f5d['currentDay']+_0x2f0ab2(0x2c9),_0x511f5d['nightActions']={},_0x2365f0(_0x2f0ab2(0x1341)),_0x12b3de(),document['getElementById']('werewolf-action-bar')['style'][_0x2f0ab2(0x678)]=_0x2f0ab2(0xff8),document[_0x2f0ab2(0x479)]('werewolf-retry-btn')['style'][_0x2f0ab2(0x678)]=_0x2f0ab2(0xff8),await new Promise(_0x893e1d=>setTimeout(_0x893e1d,0x5dc));const _0x3ceca2=_0x511f5d['players'][_0x2f0ab2(0xc0d)](_0x2d8e00=>_0x2d8e00[_0x2f0ab2(0x508)]==='守卫'&&_0x2d8e00[_0x2f0ab2(0x6a2)]);if(_0x3ceca2){_0x2365f0(_0x2f0ab2(0x875)),_0x12b3de();let _0x309dfd=null;if(_0x3ceca2['id']==='user')_0x309dfd=await _0x1bb838(_0x2f0ab2(0x5fc),_0x3ceca2['lastGuardedId']);else{const _0x5588fb=_0x511f5d[_0x2f0ab2(0xf4f)]['filter'](_0x2dced6=>_0x2dced6[_0x2f0ab2(0x6a2)]&&_0x2dced6['id']!==_0x3ceca2[_0x2f0ab2(0x944)]);_0x5588fb[_0x2f0ab2(0x990)]>0x0&&(_0x309dfd=_0x5588fb[Math[_0x2f0ab2(0xd71)](Math[_0x2f0ab2(0x103a)]()*_0x5588fb[_0x2f0ab2(0x990)])]['id']);}_0x309dfd&&(_0x511f5d[_0x2f0ab2(0x2fe)][_0x2f0ab2(0x852)]=_0x309dfd,_0x3ceca2[_0x2f0ab2(0x944)]=_0x309dfd),_0x2365f0('守卫已行动，守卫请闭眼。'),_0x12b3de(),await new Promise(_0x308e7b=>setTimeout(_0x308e7b,0x5dc));}_0x2365f0('狼人请睁眼，请选择要刀的玩家。'),_0x12b3de();const _0x1c1873=_0x511f5d[_0x2f0ab2(0xf4f)]['filter'](_0x3cd939=>_0x3cd939[_0x2f0ab2(0x508)]==='狼人'&&_0x3cd939[_0x2f0ab2(0x6a2)]),_0x363fef=_0x1c1873[_0x2f0ab2(0x1235)](_0x6dfc65=>_0x6dfc65['id']===_0x2f0ab2(0x4c5));let _0x24a5ca=null;_0x511f5d[_0x2f0ab2(0x1372)]=_0x2f0ab2(0x120a);try{if(_0x363fef)_0x2365f0(_0x2f0ab2(0x10d6)),_0x12b3de(),_0x24a5ca=await _0x9e2736();else{if(_0x511f5d[_0x2f0ab2(0xa0b)]===0x1){console['log'](_0x2f0ab2(0xc4a));const _0x18d437=_0x511f5d[_0x2f0ab2(0xf4f)][_0x2f0ab2(0x85d)](_0x323f8c=>_0x323f8c[_0x2f0ab2(0x6a2)]&&_0x323f8c['role']!=='狼人');_0x18d437[_0x2f0ab2(0x990)]>0x0&&(_0x24a5ca=_0x18d437[Math[_0x2f0ab2(0xd71)](Math[_0x2f0ab2(0x103a)]()*_0x18d437['length'])]['id']);}else _0x24a5ca=await _0x1f873b();}_0x511f5d['lastFailedAction']=null;}catch(_0x4a0cfd){console[_0x2f0ab2(0xe3b)](_0x2f0ab2(0xa36),_0x4a0cfd),await _0x1519c8('操作失败',_0x2f0ab2(0xfe8)),document['getElementById'](_0x2f0ab2(0x733))[_0x2f0ab2(0x10dd)][_0x2f0ab2(0x678)]=_0x2f0ab2(0xee3);return;}_0x511f5d['nightActions'][_0x2f0ab2(0x41b)]=_0x24a5ca,_0x2365f0('狼人已行动，狼人请闭眼。'),_0x12b3de(),await new Promise(_0x5ac538=>setTimeout(_0x5ac538,0x5dc));const _0x480971=_0x511f5d[_0x2f0ab2(0xf4f)][_0x2f0ab2(0xc0d)](_0x33731f=>_0x33731f['role']==='女巫'&&_0x33731f['isAlive']);if(_0x480971){_0x2365f0(_0x2f0ab2(0x13bf)),_0x12b3de();const _0x3605af=_0x511f5d[_0x2f0ab2(0xf4f)][_0x2f0ab2(0xc0d)](_0x56f2cc=>_0x56f2cc['id']===_0x511f5d[_0x2f0ab2(0x2fe)][_0x2f0ab2(0x41b)]),_0x455025=_0x511f5d[_0x2f0ab2(0x2fe)]['guardedId']===_0x511f5d[_0x2f0ab2(0x2fe)][_0x2f0ab2(0x41b)],_0x542e4a=_0x455025||!_0x3605af?null:_0x3605af;if(_0x480971['id']===_0x2f0ab2(0x4c5)){let _0x6e576d=await _0x29d635(_0x542e4a,_0x480971);_0x6e576d[_0x2f0ab2(0x115d)]&&(_0x511f5d[_0x2f0ab2(0x2fe)][_0x2f0ab2(0x60a)]=_0x511f5d[_0x2f0ab2(0x2fe)][_0x2f0ab2(0x41b)],_0x480971[_0x2f0ab2(0x857)]=!![]),_0x6e576d[_0x2f0ab2(0x201)]&&(_0x511f5d[_0x2f0ab2(0x2fe)][_0x2f0ab2(0x677)]=_0x6e576d[_0x2f0ab2(0x201)],_0x480971[_0x2f0ab2(0x74a)]=!![]);}else{if(!_0x480971['antidoteUsed']&&_0x542e4a){let _0x13eacd=0x0;_0x511f5d[_0x2f0ab2(0xa0b)]===0x1?_0x13eacd=0.3:_0x13eacd=0.8,console[_0x2f0ab2(0x90f)](_0x2f0ab2(0x820)+_0x511f5d[_0x2f0ab2(0xa0b)]+'天，救人概率为\x20'+_0x13eacd*0x64+'%'),Math[_0x2f0ab2(0x103a)]()<_0x13eacd?(console[_0x2f0ab2(0x90f)](_0x2f0ab2(0x32b)),_0x511f5d[_0x2f0ab2(0x2fe)][_0x2f0ab2(0x60a)]=_0x511f5d[_0x2f0ab2(0x2fe)][_0x2f0ab2(0x41b)],_0x480971[_0x2f0ab2(0x857)]=!![]):console[_0x2f0ab2(0x90f)](_0x2f0ab2(0x113a));}if(!_0x511f5d[_0x2f0ab2(0x2fe)]['savedId']&&!_0x480971[_0x2f0ab2(0x74a)]&&Math[_0x2f0ab2(0x103a)]()<0.5){const _0x440c7c=_0x511f5d[_0x2f0ab2(0xf4f)]['filter'](_0x3c3d2d=>_0x3c3d2d[_0x2f0ab2(0x6a2)]&&_0x3c3d2d['id']!==_0x511f5d[_0x2f0ab2(0x2fe)]['killedId']);if(_0x440c7c[_0x2f0ab2(0x990)]>0x0){const _0x2a1d23=_0x440c7c[Math[_0x2f0ab2(0xd71)](Math[_0x2f0ab2(0x103a)]()*_0x440c7c[_0x2f0ab2(0x990)])];_0x511f5d[_0x2f0ab2(0x2fe)][_0x2f0ab2(0x677)]=_0x2a1d23['id'],_0x480971['poisonUsed']=!![],console[_0x2f0ab2(0x90f)](_0x2f0ab2(0x3f7)+_0x2a1d23['name']);}}}_0x2365f0('女巫已行动，女巫请闭眼。'),_0x12b3de(),await new Promise(_0x1fe426=>setTimeout(_0x1fe426,0x5dc));}const _0x45d0a0=_0x511f5d[_0x2f0ab2(0xf4f)][_0x2f0ab2(0xc0d)](_0x1b4d08=>_0x1b4d08['role']===_0x2f0ab2(0x1250)&&_0x1b4d08['isAlive']);if(_0x45d0a0){_0x2365f0('预言家请睁眼，请选择要查验的玩家。'),_0x12b3de();if(_0x45d0a0['id']==='user'){const _0x654daf=await _0x1bb838('prophet'),_0x29b526=_0x511f5d[_0x2f0ab2(0xf4f)][_0x2f0ab2(0xc0d)](_0x2fe1f9=>_0x2fe1f9['id']===_0x654daf);if(_0x29b526){const _0x478f21=_0x29b526[_0x2f0ab2(0x508)]==='狼人';await _0x1519c8(_0x2f0ab2(0x4b2),_0x2f0ab2(0x621)+_0x29b526['name']+_0x2f0ab2(0x314)+(_0x478f21?'狼人':'好人')),_0x511f5d['nightActions'][_0x2f0ab2(0x49d)]={'target':_0x654daf,'result':_0x478f21?'狼人':'好人'};}}else{const _0x2c9fcd=_0x511f5d[_0x2f0ab2(0xf4f)][_0x2f0ab2(0x85d)](_0x316e29=>_0x316e29[_0x2f0ab2(0x6a2)]&&_0x316e29['id']!==_0x45d0a0['id']);if(_0x2c9fcd[_0x2f0ab2(0x990)]>0x0){const _0x181e87=_0x2c9fcd[Math[_0x2f0ab2(0xd71)](Math['random']()*_0x2c9fcd['length'])];_0x511f5d[_0x2f0ab2(0x2fe)]['prophetCheck']={'target':_0x181e87['id'],'result':_0x181e87[_0x2f0ab2(0x508)]==='狼人'?'狼人':'好人'};}}_0x2365f0(_0x2f0ab2(0x8bf)),_0x12b3de(),await new Promise(_0x228dd0=>setTimeout(_0x228dd0,0x5dc));}_0x2fe8e2();}async function _0x2fe8e2(){const _0x4d4183=_0x85c4bf;_0x511f5d['currentPhase']='第'+_0x511f5d[_0x4d4183(0xa0b)]+_0x4d4183(0x8e7),_0x511f5d[_0x4d4183(0xf3b)]={},_0x2365f0(_0x4d4183(0xa91));const {killedId:_0x347dcf,guardedId:_0x467dda,savedId:_0x268175,poisonedId:_0x255c19}=_0x511f5d['nightActions'],_0x512f12=new Set();_0x347dcf&&_0x347dcf!==_0x467dda&&_0x347dcf!==_0x268175&&_0x512f12[_0x4d4183(0x807)](_0x347dcf);_0x255c19&&_0x512f12['add'](_0x255c19);if(_0x512f12[_0x4d4183(0xa7a)]===0x0)_0x2365f0(_0x4d4183(0xdfa));else for(const _0x10d8cd of _0x512f12){const _0x53669f=_0x511f5d[_0x4d4183(0xf4f)][_0x4d4183(0xc0d)](_0xf4f7e0=>_0xf4f7e0['id']===_0x10d8cd);if(_0x53669f&&_0x53669f[_0x4d4183(0x6a2)]){_0x53669f[_0x4d4183(0x6a2)]=![],_0x2365f0('昨晚\x20'+_0x53669f[_0x4d4183(0x564)]+_0x4d4183(0x13a0));if(_0x53669f[_0x4d4183(0x508)]==='猎人'){_0x2365f0(_0x4d4183(0xe61)),_0x12b3de();let _0x533274=null;if(_0x53669f['id']==='user')_0x533274=await _0x1bb838(_0x4d4183(0xc11));else{const _0x59f8b6=_0x511f5d[_0x4d4183(0xf4f)]['filter'](_0x2bbf07=>_0x2bbf07[_0x4d4183(0x6a2)]&&_0x2bbf07['id']!==_0x53669f['id']);_0x59f8b6[_0x4d4183(0x990)]>0x0&&(_0x533274=_0x59f8b6[Math[_0x4d4183(0xd71)](Math[_0x4d4183(0x103a)]()*_0x59f8b6[_0x4d4183(0x990)])]['id']);}const _0x3cebaa=_0x511f5d[_0x4d4183(0xf4f)]['find'](_0x4318ae=>_0x4318ae['id']===_0x533274);_0x3cebaa&&(_0x3cebaa[_0x4d4183(0x6a2)]=![],_0x2365f0(_0x4d4183(0x1074)+_0x3cebaa[_0x4d4183(0x564)]+'。'));}}}_0x12b3de();if(_0x4be975())return;await _0x3af14c();}async function _0x3af14c(){const _0x9bee34=_0x85c4bf;_0x2365f0(_0x9bee34(0x803)),_0x12b3de();const {proxyUrl:_0xa88e45,apiKey:_0xc9d424,model:_0x28a017}=_0x505390[_0x9bee34(0x30c)];if(!_0xa88e45||!_0xc9d424||!_0x28a017){alert(_0x9bee34(0xb42));return;}const _0x4cbd5f=_0x17d27f();_0x511f5d[_0x9bee34(0x1372)]=_0x9bee34(0x322);try{await _0x1519c8(_0x9bee34(0x113c),_0x9bee34(0x1061));let _0xde93eb=_0xa88e45[_0x9bee34(0x44f)]('generativelanguage'),_0x50b04a=[{'role':_0x9bee34(0x4c5),'content':_0x9bee34(0x7e4)}],_0x16d2b8=_0x19a701(_0x28a017,_0xc9d424,_0x4cbd5f,_0x50b04a);const _0x33b4bd=_0xde93eb?await fetch(_0x16d2b8[_0x9bee34(0x5f3)],_0x16d2b8[_0x9bee34(0x104c)]):await fetch(_0xa88e45+_0x9bee34(0x347),{'method':'POST','headers':{'Content-Type':_0x9bee34(0xcb5),'Authorization':_0x9bee34(0xb27)+_0xc9d424},'body':JSON[_0x9bee34(0x1308)]({'model':_0x28a017,'messages':[{'role':_0x9bee34(0xbaa),'content':_0x4cbd5f},..._0x50b04a],'temperature':_0x505390[_0x9bee34(0x888)]['apiTemperature']||0.95})});if(!_0x33b4bd['ok']){const _0x1888d0=await _0x33b4bd[_0x9bee34(0xfdf)]();throw new Error(_0x9bee34(0xef2)+_0x1888d0[_0x9bee34(0xe3b)][_0x9bee34(0x757)]);}const _0x246885=await _0x33b4bd['json'](),_0xa910d3=getGeminiResponseText(_0x246885),_0x5b36ad=_0xa910d3[_0x9bee34(0xab4)](/(\[[\s\S]*\])/);if(!_0x5b36ad)throw new Error(_0x9bee34(0x13f0)+_0xa910d3);const _0x405f86=JSON[_0x9bee34(0x94c)](_0x5b36ad[0x0]);for(const _0x2c927a of _0x405f86){_0x2c927a[_0x9bee34(0xd44)]&&_0x2c927a[_0x9bee34(0xfba)]&&(_0x4cb27e(_0x2c927a[_0x9bee34(0xd44)],_0x2c927a[_0x9bee34(0xfba)]),_0x12b3de(),await new Promise(_0x39dd6f=>setTimeout(_0x39dd6f,0x5dc+Math[_0x9bee34(0x103a)]()*0x7d0)));}_0x511f5d['lastFailedAction']=null;}catch(_0x1567de){console[_0x9bee34(0xe3b)]('狼人杀AI讨论生成失败:',_0x1567de),await _0x1519c8(_0x9bee34(0xd87),_0x9bee34(0x94e)+_0x1567de[_0x9bee34(0x757)]),document[_0x9bee34(0x479)](_0x9bee34(0x733))['style'][_0x9bee34(0x678)]=_0x9bee34(0xee3);return;}const _0x2ece2f=_0x511f5d['players'][_0x9bee34(0xc0d)](_0x995637=>_0x995637['id']==='user'),_0x5bc8bd=document[_0x9bee34(0x479)](_0x9bee34(0x21d)),_0x177be7=document[_0x9bee34(0x479)](_0x9bee34(0x713)),_0xc2ac7=document[_0x9bee34(0x479)](_0x9bee34(0xc1c)),_0x4fa935=document['getElementById'](_0x9bee34(0xce8));_0x5bc8bd['style'][_0x9bee34(0x678)]=_0x9bee34(0x899);if(_0x2ece2f&&_0x2ece2f['isAlive']){_0x177be7[_0x9bee34(0x97b)]=_0x9bee34(0xf55),_0xc2ac7[_0x9bee34(0x97b)]=_0x9bee34(0xfc2),_0x177be7[_0x9bee34(0x10dd)][_0x9bee34(0x678)]=_0x9bee34(0xee3),_0xc2ac7[_0x9bee34(0x10dd)]['display']=_0x9bee34(0xee3),_0x4fa935[_0x9bee34(0xfce)]=![],_0x4fa935[_0x9bee34(0xe77)]=_0x9bee34(0x13ef),_0x4fa935['focus']();const _0x416647=_0x177be7[_0x9bee34(0xbcf)](!![]);_0x177be7['parentNode'][_0x9bee34(0xf0d)](_0x416647,_0x177be7),_0x416647[_0x9bee34(0xa75)](_0x9bee34(0xd2f),_0x281366);const _0x319619=_0xc2ac7[_0x9bee34(0xbcf)](!![]);_0xc2ac7[_0x9bee34(0x1134)]['replaceChild'](_0x319619,_0xc2ac7),_0x319619['addEventListener'](_0x9bee34(0xd2f),_0x355079);}else{_0x2365f0(_0x9bee34(0x42f)),_0x12b3de(),_0x177be7['textContent']=_0x9bee34(0x871),_0xc2ac7[_0x9bee34(0x97b)]=_0x9bee34(0x119b),_0x177be7['style']['display']='block',_0xc2ac7[_0x9bee34(0x10dd)][_0x9bee34(0x678)]=_0x9bee34(0xee3),_0x4fa935[_0x9bee34(0xfce)]=!![],_0x4fa935['placeholder']=_0x9bee34(0x4f0);const _0x4f9a2d=_0x177be7['cloneNode'](!![]);_0x177be7['parentNode'][_0x9bee34(0xf0d)](_0x4f9a2d,_0x177be7),_0x4f9a2d['addEventListener'](_0x9bee34(0xd2f),_0x10f747);const _0x5c9050=_0xc2ac7[_0x9bee34(0xbcf)](!![]);_0xc2ac7[_0x9bee34(0x1134)][_0x9bee34(0xf0d)](_0x5c9050,_0xc2ac7),_0x5c9050[_0x9bee34(0xa75)](_0x9bee34(0xd2f),_0x3c536b);}}function _0x17d27f(){const _0x21a238=_0x85c4bf,_0x3a5464=_0x511f5d[_0x21a238(0xf4f)][_0x21a238(0x85d)](_0xb98432=>_0xb98432[_0x21a238(0x6a2)]),_0x4f7032=_0x511f5d['players'][_0x21a238(0xc0d)](_0x48980f=>_0x48980f['id']===_0x21a238(0x4c5)),_0x264621=_0x4f7032?_0x4f7032[_0x21a238(0x564)]:'用户',_0x10df9a=_0x3a5464[_0x21a238(0x1235)](_0x431476=>_0x431476['id']==='user');let _0xfb61ef=_0x21a238(0x61a);_0x3a5464[_0x21a238(0x12be)]((_0x4dc7fc,_0x23276d)=>{const _0x1aefd6=_0x21a238,_0x1f3eec=_0x511f5d[_0x1aefd6(0xf4f)]['findIndex'](_0x1f6b02=>_0x1f6b02['id']===_0x4dc7fc['id'])+0x1;_0xfb61ef+=_0x1aefd6(0x25d)+_0x1f3eec+_0x1aefd6(0x6c1)+_0x4dc7fc[_0x1aefd6(0x564)]+_0x1aefd6(0x12dd)+_0x4dc7fc[_0x1aefd6(0xe2d)]+_0x1aefd6(0x11e0)+(_0x4dc7fc['id']===_0x1aefd6(0x4c5)?_0x1aefd6(0xa6a):_0x1aefd6(0xa99))+_0x1aefd6(0x131e)+_0x4dc7fc[_0x1aefd6(0xd94)]+'\x0a';if(_0x4dc7fc['type']===_0x1aefd6(0x390)){const _0x301a5d=_0x505390[_0x1aefd6(0x1027)][_0x4dc7fc['id']];if(_0x301a5d&&_0x301a5d['longTermMemory']&&_0x301a5d['longTermMemory'][_0x1aefd6(0x990)]>0x0){const _0x5d795f=_0x301a5d['longTermMemory'][_0x1aefd6(0x2e1)](_0x31fa38=>_0x31fa38[_0x1aefd6(0xac4)])[_0x1aefd6(0x35d)](';\x20');_0xfb61ef+=_0x1aefd6(0x409)+_0x5d795f+'\x0a';}}});let _0x207796=_0x21a238(0xa3f);const _0x103cd0=_0x511f5d[_0x21a238(0x48d)][_0x21a238(0x85d)](_0xc5889c=>_0xc5889c[_0x21a238(0xac4)]['includes'](_0x21a238(0x20c))&&_0xc5889c['day']===_0x511f5d['currentDay']);_0x103cd0[_0x21a238(0x990)]===0x0?_0x207796+='-\x20昨晚是平安夜，无人死亡。\x0a':_0x103cd0[_0x21a238(0x12be)](_0x40f5aa=>{_0x207796+='-\x20'+_0x40f5aa['content']+'\x0a';});let _0x29f064=_0x21a238(0x3d0);if(_0x511f5d[_0x21a238(0xa0b)]>0x1)for(let _0x206db1=0x1;_0x206db1<_0x511f5d['currentDay'];_0x206db1++){_0x29f064+='\x0a**---\x20第\x20'+_0x206db1+_0x21a238(0x1b9);const _0x41f9ab=_0x511f5d[_0x21a238(0x48d)][_0x21a238(0x85d)](_0xba1a3f=>_0xba1a3f['day']===_0x206db1&&(_0xba1a3f[_0x21a238(0xac4)][_0x21a238(0x44f)]('死亡')||_0xba1a3f['content'][_0x21a238(0x44f)]('放逐')));_0x41f9ab[_0x21a238(0x990)]>0x0?_0x29f064+=_0x21a238(0x54a)+_0x41f9ab[_0x21a238(0x2e1)](_0x6292c1=>_0x6292c1[_0x21a238(0xac4)])[_0x21a238(0x35d)]('\x20')+'\x0a':_0x29f064+=_0x21a238(0x2b0);const _0x174f4f=_0x511f5d['discussionLog'][_0x21a238(0x85d)](_0x4b6d5f=>_0x4b6d5f[_0x21a238(0x1306)]===_0x206db1);_0x174f4f[_0x21a238(0x990)]>0x0&&(_0x29f064+=_0x21a238(0xb5e)+_0x174f4f[_0x21a238(0x2e1)](_0x3a556e=>'-\x20'+_0x3a556e['speaker']+':\x20'+_0x3a556e['content'])[_0x21a238(0x35d)]('\x0a')+'\x0a');}else _0x29f064+=_0x21a238(0x793);let _0x5bfb80=_0x21a238(0x128f);_0x3a5464[_0x21a238(0x12be)](_0x2b4b73=>{const _0x3d3893=_0x21a238;if(_0x2b4b73['id']!==_0x3d3893(0x4c5)){_0x5bfb80+=_0x3d3893(0x125c)+_0x2b4b73['name']+_0x3d3893(0x1369)+_0x2b4b73[_0x3d3893(0x508)]+'】\x0a';if(_0x2b4b73[_0x3d3893(0x508)]==='狼人'){const _0x5782d2=_0x511f5d[_0x3d3893(0xf4f)][_0x3d3893(0x85d)](_0x96eb94=>_0x96eb94[_0x3d3893(0x508)]==='狼人'&&_0x96eb94['id']!==_0x2b4b73['id'])['map'](_0x52ff6a=>_0x52ff6a[_0x3d3893(0x564)])[_0x3d3893(0x35d)]('、');_0x5bfb80+=_0x3d3893(0x1296)+(_0x5782d2||'无')+'\x0a';const _0x1b37c4=_0x511f5d[_0x3d3893(0xf4f)][_0x3d3893(0xc0d)](_0x2cea14=>_0x2cea14['id']===_0x511f5d['nightActions'][_0x3d3893(0x41b)]);_0x5bfb80+=_0x3d3893(0x606)+(_0x1b37c4?_0x1b37c4[_0x3d3893(0x564)]:'空刀')+'\x0a';}if(_0x2b4b73[_0x3d3893(0x508)]===_0x3d3893(0x1250)&&_0x511f5d[_0x3d3893(0x2fe)][_0x3d3893(0x49d)]){const _0xd3f6f=_0x511f5d['players']['find'](_0x5c01ea=>_0x5c01ea['id']===_0x511f5d[_0x3d3893(0x2fe)][_0x3d3893(0x49d)][_0x3d3893(0xfa2)]);_0x5bfb80+='-\x20你昨晚查验了\x20'+_0xd3f6f[_0x3d3893(0x564)]+'，TA的身份是：【'+_0x511f5d[_0x3d3893(0x2fe)][_0x3d3893(0x49d)][_0x3d3893(0x97e)]+'】\x0a';}if(_0x2b4b73[_0x3d3893(0x508)]==='女巫'){if(_0x511f5d[_0x3d3893(0x2fe)]['savedId']){const _0x1b7ef8=_0x511f5d[_0x3d3893(0xf4f)][_0x3d3893(0xc0d)](_0x5b5e26=>_0x5b5e26['id']===_0x511f5d['nightActions'][_0x3d3893(0x60a)]);_0x5bfb80+=_0x3d3893(0x45c)+_0x1b7ef8[_0x3d3893(0x564)]+'。\x0a';}if(_0x511f5d[_0x3d3893(0x2fe)][_0x3d3893(0x677)]){const _0x82e8f6=_0x511f5d[_0x3d3893(0xf4f)]['find'](_0x1ebd69=>_0x1ebd69['id']===_0x511f5d[_0x3d3893(0x2fe)]['poisonedId']);_0x5bfb80+=_0x3d3893(0x576)+_0x82e8f6[_0x3d3893(0x564)]+'。\x0a';}_0x5bfb80+=_0x3d3893(0xbc8)+(_0x2b4b73[_0x3d3893(0x857)]?'已使用':_0x3d3893(0x861))+'\x0a',_0x5bfb80+=_0x3d3893(0x65f)+(_0x2b4b73['poisonUsed']?_0x3d3893(0x1a4):_0x3d3893(0x861))+'\x0a';}if(_0x2b4b73[_0x3d3893(0x508)]==='守卫'){if(_0x511f5d[_0x3d3893(0x2fe)][_0x3d3893(0x852)]){const _0x584c60=_0x511f5d[_0x3d3893(0xf4f)][_0x3d3893(0xc0d)](_0x1f8c2b=>_0x1f8c2b['id']===_0x511f5d[_0x3d3893(0x2fe)]['guardedId']);_0x5bfb80+=_0x3d3893(0x3c0)+_0x584c60[_0x3d3893(0x564)]+'。\x0a';}else _0x5bfb80+=_0x3d3893(0x4f2);}_0x5bfb80+='\x0a';}});let _0x3c8a7b=_0x21a238(0x7a7);const _0x296868=_0x511f5d[_0x21a238(0x29e)][_0x21a238(0x85d)](_0x3e1222=>_0x3e1222[_0x21a238(0x1306)]===_0x511f5d[_0x21a238(0xa0b)]);_0x296868[_0x21a238(0x990)]>0x0?_0x3c8a7b+=_0x296868[_0x21a238(0x2e1)](_0x1caed0=>_0x21a238(0x118a)+_0x1caed0['speaker']+_0x21a238(0xed4)+_0x1caed0[_0x21a238(0xac4)])[_0x21a238(0x35d)]('\x0a'):_0x3c8a7b+=_0x21a238(0x281);const _0x13f730='\x0a#\x20你的任务\x0a你是一个狼人杀游戏导演。你的任务是扮演【除了'+(_0x10df9a?_0x21a238(0x129e)+_0x264621+')':'已死亡的用户('+_0x264621+')')+_0x21a238(0x6c6)+_0xfb61ef+_0x21a238(0xe58)+(_0x511f5d[_0x21a238(0xabd)]===_0x21a238(0xa5d)?_0x21a238(0x23e):_0x21a238(0x60c))+_0x21a238(0x570)+_0x511f5d[_0x21a238(0xa0b)]+'\x20天的讨论环节。\x0a'+_0x207796+_0x21a238(0x1a5)+_0x3a5464['map'](_0x3a88d9=>_0x3a88d9[_0x21a238(0x564)]+'\x20('+(_0x3a88d9['id']==='user'?'用户':'AI')+')')['join'](',\x20')+_0x21a238(0xdb3)+_0x264621+_0x21a238(0x6ea)+_0x29f064+_0x21a238(0xa35)+_0x3c8a7b+'\x0a\x0a'+_0x5bfb80+'\x0a\x0a现在，请为所有【存活的AI角色】生成他们充满策略和博弈的发言。';return _0x13f730;}function _0xb5ab0b(_0x5db3f5){const _0x53e31f=_0x85c4bf;let _0x39c818='---\x20狼人杀对局完整复盘\x20---\x0a\x0a';const _0x4d80fd=_0x5db3f5[_0x53e31f(0x48d)][_0x53e31f(0xc0d)](_0x53d86a=>_0x53d86a[_0x53e31f(0xac4)][_0x53e31f(0x44f)]('胜利'))?.[_0x53e31f(0xac4)]||'胜负未分';_0x39c818+=_0x53e31f(0x132a)+_0x4d80fd+'\x0a\x0a',_0x39c818+='###\x20玩家身份配置:\x0a',_0x5db3f5[_0x53e31f(0xf4f)][_0x53e31f(0x12be)](_0x3ea334=>{const _0x31fc19=_0x53e31f,_0x34b27d=_0x3ea334['isAlive']?'存活':_0x31fc19(0xfd5);_0x39c818+='-\x20'+_0x3ea334['name']+':\x20'+_0x3ea334['role']+'\x20('+_0x34b27d+')\x0a';}),_0x39c818+=_0x53e31f(0x9d8);for(let _0x2da169=0x1;_0x2da169<=_0x5db3f5[_0x53e31f(0xa0b)];_0x2da169++){_0x39c818+=_0x53e31f(0x492)+_0x2da169+_0x53e31f(0x1b9);const _0x1faa06=_0x5db3f5[_0x53e31f(0x48d)]['filter'](_0xb51632=>_0xb51632[_0x53e31f(0x1306)]===_0x2da169&&_0xb51632[_0x53e31f(0xac4)][_0x53e31f(0x44f)]('死亡'));if(_0x1faa06[_0x53e31f(0x990)]>0x0)_0x39c818+='**[夜晚]**\x20'+_0x1faa06[_0x53e31f(0x2e1)](_0xb6ff1e=>_0xb6ff1e[_0x53e31f(0xac4)])['join']('\x20')+'\x0a';else(_0x2da169>0x1||_0x2da169===0x1&&_0x5db3f5[_0x53e31f(0xa0b)]>0x1)&&(_0x39c818+='**[夜晚]**\x20平安夜。\x0a');const _0x2eca87=_0x5db3f5[_0x53e31f(0x29e)][_0x53e31f(0x85d)](_0x324d00=>_0x324d00[_0x53e31f(0x1306)]===_0x2da169);_0x2eca87[_0x53e31f(0x990)]>0x0&&(_0x39c818+=_0x53e31f(0x5a2)+_0x2eca87[_0x53e31f(0x2e1)](_0x28bbb8=>'-\x20'+_0x28bbb8[_0x53e31f(0xc9d)]+':\x20'+_0x28bbb8[_0x53e31f(0xac4)])[_0x53e31f(0x35d)]('\x0a')+'\x0a');const _0x20547c=_0x5db3f5[_0x53e31f(0x48d)][_0x53e31f(0xc0d)](_0x3a559c=>_0x3a559c[_0x53e31f(0x1306)]===_0x2da169&&_0x3a559c['content'][_0x53e31f(0x44f)](_0x53e31f(0xdc1)));_0x20547c&&(_0x39c818+='**[投票结果]**\x20'+_0x20547c[_0x53e31f(0xac4)]+'\x0a');}return _0x39c818+='\x0a---\x20复盘结束\x20---',_0x39c818;}async function _0x4749f6(_0x1c0d18){const _0xb33295=_0x85c4bf;let _0x4684ce=0x0;for(const _0x11caf9 of _0x511f5d['players']){if(_0x11caf9[_0xb33295(0x858)]==='character'){const _0x1b1f76=_0x505390[_0xb33295(0x1027)][_0x11caf9['id']];if(_0x1b1f76){const _0x16e25c={'content':_0x1c0d18,'timestamp':Date['now'](),'source':_0xb33295(0x1339)};!_0x1b1f76[_0xb33295(0x3b4)]&&(_0x1b1f76[_0xb33295(0x3b4)]=[]),_0x1b1f76['longTermMemory'][_0xb33295(0x1a0)](_0x16e25c),await _0xb81d4e[_0xb33295(0x1027)]['put'](_0x1b1f76),_0x4684ce++;}}}return _0x4684ce;}async function _0x157816(){const _0x3fca59=_0x85c4bf;if(!_0x511f5d[_0x3fca59(0x4c3)]&&_0x511f5d[_0x3fca59(0x12f2)]===_0x3fca59(0x3a1)){await _0x1519c8('请稍候...','正在为所有AI角色生成并注入游戏记忆...');try{const _0x1f50be=_0xb5ab0b(_0x511f5d),_0x15cd6e=await _0x4749f6(_0x1f50be);await _0x1519c8('成功',_0x3fca59(0x103c)+_0x15cd6e+_0x3fca59(0x45b));}catch(_0x425e4d){console[_0x3fca59(0xe3b)]('手动注入狼人杀记忆失败:',_0x425e4d),await _0x1519c8('失败',_0x3fca59(0x5a6)+_0x425e4d[_0x3fca59(0x757)]);}}else alert(_0x3fca59(0x7d9));}async function _0x56578f(_0x15ab0f){const _0x17dc5a=_0x85c4bf;_0x511f5d[_0x17dc5a(0x4c3)]=![],_0x511f5d[_0x17dc5a(0x12f2)]=_0x17dc5a(0x3a1),_0x2365f0(_0x15ab0f+_0x17dc5a(0x115a)),document['getElementById']('werewolf-game-over-title')[_0x17dc5a(0x97b)]=_0x15ab0f+'胜利！';let _0x2e7c38='';_0x15ab0f==='好人'?_0x2e7c38='所有狼人已被放逐，好人阵营获得了胜利！':_0x2e7c38='狼人数量已达到胜利条件，狼人阵营获得了胜利！';const _0x4785ba=document[_0x17dc5a(0x479)](_0x17dc5a(0x99f));_0x4785ba['textContent']=_0x2e7c38;const _0x28e9b3=document[_0x17dc5a(0x479)](_0x17dc5a(0x7ab));_0x28e9b3[_0x17dc5a(0x3de)]='';const _0x43ca48=[..._0x511f5d[_0x17dc5a(0xf4f)]][_0x17dc5a(0x382)]((_0x2cffab,_0x596de7)=>{const _0x36e3c5=_0x17dc5a,_0x504289=_0x511f5d[_0x36e3c5(0xf4f)][_0x36e3c5(0x120c)](_0x3c1318=>_0x3c1318['id']===_0x2cffab['id']),_0x48d1f6=_0x511f5d[_0x36e3c5(0xf4f)][_0x36e3c5(0x120c)](_0x23cbfd=>_0x23cbfd['id']===_0x596de7['id']);return _0x504289-_0x48d1f6;});_0x43ca48[_0x17dc5a(0x12be)]((_0x57bd39,_0x2d1ba0)=>{const _0x10c6d7=_0x17dc5a,_0x13b929=document['createElement']('div');_0x13b929[_0x10c6d7(0x10dd)][_0x10c6d7(0x506)]='display:\x20flex;\x20align-items:\x20center;\x20padding:\x208px\x200;\x20border-bottom:\x201px\x20solid\x20#444;\x20color:\x20white;';if(_0x2d1ba0===_0x43ca48[_0x10c6d7(0x990)]-0x1)_0x13b929[_0x10c6d7(0x10dd)][_0x10c6d7(0xb1e)]=_0x10c6d7(0xff8);const _0x2ec450=_0x57bd39[_0x10c6d7(0x508)]==='狼人'?_0x10c6d7(0xbf8):_0x10c6d7(0xbc1);_0x13b929['innerHTML']=_0x10c6d7(0x18c)+_0x57bd39['avatar']+_0x10c6d7(0x23f)+(_0x57bd39[_0x10c6d7(0x6a2)]?'none':_0x10c6d7(0x5c2))+_0x10c6d7(0xf92)+(_0x57bd39[_0x10c6d7(0x6a2)]?'none':'line-through')+_0x10c6d7(0xc7c)+(_0x2d1ba0+0x1)+'.\x20'+_0x57bd39[_0x10c6d7(0x564)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20style=\x22color:\x20'+_0x2ec450+';\x22>'+_0x57bd39[_0x10c6d7(0x508)]+_0x10c6d7(0x709),_0x28e9b3[_0x10c6d7(0x9f4)](_0x13b929);}),document[_0x17dc5a(0x479)](_0x17dc5a(0xe46))[_0x17dc5a(0x9cd)][_0x17dc5a(0x807)](_0x17dc5a(0x45a));try{console[_0x17dc5a(0x90f)](_0x17dc5a(0xff6));const _0x10c56d=_0xb5ab0b(_0x511f5d),_0x27bac7=await generateAndInjectWerewolfMemories(_0x10c56d);console[_0x17dc5a(0x90f)](_0x17dc5a(0x1384)+_0x27bac7+_0x17dc5a(0x1313));}catch(_0x4e450b){console[_0x17dc5a(0xe3b)](_0x17dc5a(0x303),_0x4e450b),_0x4785ba&&(_0x4785ba['innerHTML']+=_0x17dc5a(0x39c));}}function _0x2365f0(_0x3c467c){const _0x51b945=_0x85c4bf;_0x511f5d[_0x51b945(0x48d)][_0x51b945(0x1a0)]({'type':'system','content':_0x3c467c,'timestamp':Date[_0x51b945(0x12d6)](),'day':_0x511f5d[_0x51b945(0xa0b)]});}function _0x4cb27e(_0x1b0d98,_0x27b940){const _0x47b1ca=_0x85c4bf;_0x511f5d[_0x47b1ca(0x29e)]['push']({'type':_0x47b1ca(0xfba),'speaker':_0x1b0d98,'content':_0x27b940,'timestamp':Date[_0x47b1ca(0x12d6)](),'day':_0x511f5d['currentDay']});}function _0x1bb838(_0x576684){return new Promise(_0xe1c289=>{const _0x49d8c1=_0x6666,_0x56d1a0='werewolf-'+_0x576684+_0x49d8c1(0x604),_0x4c629b=_0x49d8c1(0x111f)+_0x576684+'-selection-list';let _0x89f718='';if(_0x576684===_0x49d8c1(0x10b6))_0x89f718='confirm-prophet-check-btn';if(_0x576684===_0x49d8c1(0xc11))_0x89f718=_0x49d8c1(0x72b);if(_0x576684===_0x49d8c1(0x2bc))_0x89f718='confirm-vote-btn';const _0x5c6955=document[_0x49d8c1(0x479)](_0x56d1a0),_0x3aafeb=document[_0x49d8c1(0x479)](_0x4c629b),_0x1630eb=document[_0x49d8c1(0x479)](_0x89f718);_0x3aafeb[_0x49d8c1(0x3de)]='';let _0x2afca5=null;const _0x39bf50=_0x511f5d[_0x49d8c1(0xf4f)][_0x49d8c1(0x85d)](_0x53d1e2=>_0x53d1e2[_0x49d8c1(0x6a2)]&&(_0x576684===_0x49d8c1(0xc11)||_0x576684===_0x49d8c1(0x2bc)||_0x53d1e2['id']!=='user'));_0x39bf50[_0x49d8c1(0x12be)](_0x19c2d9=>{const _0x5d389d=_0x49d8c1,_0x1d75eb=document[_0x5d389d(0xbd5)](_0x5d389d(0x6c8));_0x1d75eb['className']=_0x5d389d(0xe72),_0x1d75eb[_0x5d389d(0x13d4)]['id']=_0x19c2d9['id'],_0x1d75eb[_0x5d389d(0x3de)]=_0x5d389d(0xdba)+_0x19c2d9[_0x5d389d(0x799)]+_0x5d389d(0x86b)+_0x19c2d9['name']+_0x5d389d(0x451),_0x1d75eb[_0x5d389d(0x1063)]=()=>{const _0x553ece=_0x5d389d;_0x3aafeb[_0x553ece(0x99e)]('.selected')[_0x553ece(0x12be)](_0x5e1e6f=>_0x5e1e6f[_0x553ece(0x9cd)][_0x553ece(0x8b6)](_0x553ece(0x10dc))),_0x1d75eb[_0x553ece(0x9cd)][_0x553ece(0x807)](_0x553ece(0x10dc)),_0x2afca5=_0x19c2d9['id'];},_0x3aafeb[_0x5d389d(0x9f4)](_0x1d75eb);});const _0x5d6c96=_0x1630eb[_0x49d8c1(0xbcf)](!![]);_0x1630eb['parentNode'][_0x49d8c1(0xf0d)](_0x5d6c96,_0x1630eb),_0x5d6c96[_0x49d8c1(0x1063)]=()=>{const _0x676cfe=_0x49d8c1;_0x2afca5?(_0x5c6955[_0x676cfe(0x9cd)][_0x676cfe(0x8b6)](_0x676cfe(0x45a)),_0xe1c289(_0x2afca5)):alert(_0x676cfe(0x3cf));},_0x5c6955['classList'][_0x49d8c1(0x807)]('visible');});}function _0x9e2736(){return new Promise(_0x5be741=>{const _0x4e2e2e=_0x6666,_0x6fc72c=document[_0x4e2e2e(0x479)](_0x4e2e2e(0xc40)),_0x1d2e83=document[_0x4e2e2e(0x479)](_0x4e2e2e(0x110f)),_0x3d0ffe=document['getElementById'](_0x4e2e2e(0xad2)),_0x50bf8a=_0x6fc72c[_0x4e2e2e(0x8bc)](_0x4e2e2e(0xfa1)),_0x5c85e3=_0x511f5d[_0x4e2e2e(0xf4f)][_0x4e2e2e(0x85d)](_0x254837=>_0x254837[_0x4e2e2e(0x508)]==='狼人'&&_0x254837['isAlive']),_0x32d642=_0x5c85e3[_0x4e2e2e(0x85d)](_0x162b6d=>_0x162b6d['id']!=='user')[_0x4e2e2e(0x2e1)](_0xc73f35=>_0xc73f35[_0x4e2e2e(0x564)])[_0x4e2e2e(0x35d)]('、');_0x32d642?_0x50bf8a['innerHTML']=_0x4e2e2e(0x1ee)+_0x32d642+_0x4e2e2e(0x3f6):_0x50bf8a['textContent']=_0x4e2e2e(0x91d);_0x1d2e83[_0x4e2e2e(0x3de)]='';let _0x4efc5a=null;const _0x2ce3cb=_0x511f5d[_0x4e2e2e(0xf4f)]['filter'](_0x4a10cf=>_0x4a10cf['isAlive']&&_0x4a10cf[_0x4e2e2e(0x508)]!=='狼人');_0x2ce3cb[_0x4e2e2e(0x12be)](_0x2c55c8=>{const _0x3210bb=_0x4e2e2e,_0x5431a2=document[_0x3210bb(0xbd5)](_0x3210bb(0x6c8));_0x5431a2[_0x3210bb(0xfd4)]=_0x3210bb(0xe72),_0x5431a2[_0x3210bb(0x13d4)]['id']=_0x2c55c8['id'],_0x5431a2[_0x3210bb(0x3de)]='<img\x20src=\x22'+_0x2c55c8[_0x3210bb(0x799)]+_0x3210bb(0x86b)+_0x2c55c8[_0x3210bb(0x564)]+_0x3210bb(0x451),_0x5431a2['onclick']=()=>{const _0x5094ce=_0x3210bb;_0x1d2e83[_0x5094ce(0x99e)](_0x5094ce(0xd51))[_0x5094ce(0x12be)](_0x5094f6=>_0x5094f6[_0x5094ce(0x9cd)][_0x5094ce(0x8b6)](_0x5094ce(0x10dc))),_0x5431a2['classList'][_0x5094ce(0x807)](_0x5094ce(0x10dc)),_0x4efc5a=_0x2c55c8['id'];},_0x1d2e83[_0x3210bb(0x9f4)](_0x5431a2);});const _0x53d19f=_0x3d0ffe[_0x4e2e2e(0xbcf)](!![]);_0x3d0ffe[_0x4e2e2e(0x1134)]['replaceChild'](_0x53d19f,_0x3d0ffe),_0x53d19f['onclick']=()=>{const _0x4146f8=_0x4e2e2e;_0x4efc5a?(_0x6fc72c[_0x4146f8(0x9cd)][_0x4146f8(0x8b6)](_0x4146f8(0x45a)),_0x5be741(_0x4efc5a)):alert(_0x4146f8(0x3cf));},_0x6fc72c['classList']['add'](_0x4e2e2e(0x45a));});}function _0x355079(){const _0x428079=_0x85c4bf,_0x3dcf60=_0x511f5d['players'][_0x428079(0xc0d)](_0x3ed082=>_0x3ed082['id']===_0x428079(0x4c5));if(!_0x3dcf60||!_0x3dcf60[_0x428079(0x6a2)])return;const _0x203acc=document['getElementById']('werewolf-user-input'),_0x1cb38e=_0x203acc[_0x428079(0x4e0)]['trim']();_0x1cb38e&&(_0x4cb27e(_0x3dcf60[_0x428079(0x564)],_0x1cb38e),_0x12b3de()),document[_0x428079(0x479)]('werewolf-action-bar')[_0x428079(0x10dd)]['display']=_0x428079(0xff8),_0x203acc[_0x428079(0x4e0)]='',_0x3c536b();}async function _0x10f747(){const _0x1ad632=_0x85c4bf;_0x2365f0(_0x1ad632(0x31c)),_0x12b3de();const _0x417f9b=document[_0x1ad632(0x479)]('werewolf-wait-reply-btn');if(_0x417f9b)_0x417f9b[_0x1ad632(0xfce)]=!![];await _0x1519c8(_0x1ad632(0x113c),_0x1ad632(0x76e));const {proxyUrl:_0x592caf,apiKey:_0x12f1e8,model:_0x487fb1}=_0x505390[_0x1ad632(0x30c)];if(!_0x592caf||!_0x12f1e8||!_0x487fb1){alert('API未配置，无法生成对话。');return;}const _0x15386b=_0x17d27f();try{let _0x55f378=_0x592caf['includes'](_0x1ad632(0x136f)),_0x5aa724=[{'role':_0x1ad632(0x4c5),'content':_0x1ad632(0x10fc)}],_0x5108e1=_0x19a701(_0x487fb1,_0x12f1e8,_0x15386b,_0x5aa724);const _0x57bb82=_0x55f378?await fetch(_0x5108e1['url'],_0x5108e1[_0x1ad632(0x104c)]):await fetch(_0x592caf+_0x1ad632(0x347),{'method':_0x1ad632(0xba0),'headers':{'Content-Type':_0x1ad632(0xcb5),'Authorization':_0x1ad632(0xb27)+_0x12f1e8},'body':JSON[_0x1ad632(0x1308)]({'model':_0x487fb1,'messages':[{'role':_0x1ad632(0xbaa),'content':_0x15386b},..._0x5aa724],'temperature':_0x505390['globalSettings']['apiTemperature']||0.9})});if(!_0x57bb82['ok']){const _0x2684e8=await _0x57bb82['json']();throw new Error(_0x1ad632(0xef2)+_0x2684e8[_0x1ad632(0xe3b)][_0x1ad632(0x757)]);}const _0x29d124=await _0x57bb82[_0x1ad632(0xfdf)](),_0x5e3137=getGeminiResponseText(_0x29d124),_0x3781fb=_0x5e3137['match'](/(\[[\s\S]*\])/);if(!_0x3781fb)throw new Error(_0x1ad632(0xe10)+_0x5e3137);const _0x1043a3=JSON[_0x1ad632(0x94c)](_0x3781fb[0x0]);for(const _0x25c03b of _0x1043a3){_0x25c03b['speaker_name']&&_0x25c03b[_0x1ad632(0xfba)]&&(_0x4cb27e(_0x25c03b[_0x1ad632(0xd44)],_0x25c03b['dialogue']),_0x12b3de(),await new Promise(_0x132654=>setTimeout(_0x132654,0x5dc+Math[_0x1ad632(0x103a)]()*0x7d0)));}}catch(_0x81e3ca){console[_0x1ad632(0xe3b)](_0x1ad632(0x752),_0x81e3ca),await _0x1519c8(_0x1ad632(0xd87),_0x1ad632(0x744)+_0x81e3ca[_0x1ad632(0x757)]);}finally{if(_0x417f9b)_0x417f9b[_0x1ad632(0xfce)]=![];}}async function _0x281366(){const _0x55515c=_0x85c4bf,_0x42de6f=_0x511f5d['players'][_0x55515c(0xc0d)](_0x1f8d59=>_0x1f8d59['id']===_0x55515c(0x4c5));if(!_0x42de6f||!_0x42de6f['isAlive']){console[_0x55515c(0x139e)](_0x55515c(0x969));return;}const _0x45bd36=document[_0x55515c(0x479)]('werewolf-user-input'),_0x24f81a=_0x45bd36[_0x55515c(0x4e0)][_0x55515c(0x9c1)]();if(!_0x24f81a){alert(_0x55515c(0x9ea));return;}_0x4cb27e(_0x42de6f[_0x55515c(0x564)],_0x24f81a),_0x12b3de(),_0x45bd36[_0x55515c(0x4e0)]='',await _0x1519c8('请稍候',_0x55515c(0x7a0));const {proxyUrl:_0x26d53a,apiKey:_0x2a6a3c,model:_0x2f4774}=_0x505390['apiConfig'];if(!_0x26d53a||!_0x2a6a3c||!_0x2f4774){alert(_0x55515c(0xb42));return;}const _0x182046=_0x17d27f();try{let _0x1f30ea=_0x26d53a[_0x55515c(0x44f)]('generativelanguage'),_0x5ea95c=[{'role':_0x55515c(0x4c5),'content':_0x55515c(0x9c7)+_0x42de6f[_0x55515c(0x564)]+_0x55515c(0x463)}],_0x5a8966=_0x19a701(_0x2f4774,_0x2a6a3c,_0x182046,_0x5ea95c);const _0x14b72b=_0x1f30ea?await fetch(_0x5a8966[_0x55515c(0x5f3)],_0x5a8966[_0x55515c(0x104c)]):await fetch(_0x26d53a+'/v1/chat/completions',{'method':_0x55515c(0xba0),'headers':{'Content-Type':_0x55515c(0xcb5),'Authorization':_0x55515c(0xb27)+_0x2a6a3c},'body':JSON[_0x55515c(0x1308)]({'model':_0x2f4774,'messages':[{'role':_0x55515c(0xbaa),'content':_0x182046},..._0x5ea95c],'temperature':_0x505390[_0x55515c(0x888)][_0x55515c(0x398)]||0.9})});if(!_0x14b72b['ok']){const _0x597b8e=await _0x14b72b[_0x55515c(0xfdf)]();throw new Error(_0x55515c(0xef2)+_0x597b8e['error']['message']);}const _0x4dd49b=await _0x14b72b['json'](),_0x48f227=getGeminiResponseText(_0x4dd49b),_0x58bb8b=_0x48f227[_0x55515c(0xab4)](/(\[[\s\S]*\])/);if(!_0x58bb8b)throw new Error(_0x55515c(0xe10)+_0x48f227);const _0xd21d01=JSON[_0x55515c(0x94c)](_0x58bb8b[0x0]);for(const _0x429dd1 of _0xd21d01){_0x429dd1[_0x55515c(0xd44)]&&_0x429dd1['dialogue']&&(_0x4cb27e(_0x429dd1['speaker_name'],_0x429dd1[_0x55515c(0xfba)]),_0x12b3de(),await new Promise(_0x4c5b06=>setTimeout(_0x4c5b06,0x5dc+Math[_0x55515c(0x103a)]()*0x7d0)));}}catch(_0x53de42){console[_0x55515c(0xe3b)](_0x55515c(0x752),_0x53de42),await _0x1519c8('AI\x20发言失败','错误:\x20'+_0x53de42['message']);}}async function _0x3c536b(){const _0x65a976=_0x85c4bf;_0x2365f0('发言结束，现在开始投票。'),_0x12b3de(),_0x511f5d['votes']={};let _0x2874b4=null;_0x511f5d[_0x65a976(0x1372)]=_0x65a976(0xd1a);try{_0x2874b4=await _0x1328df(),_0x2874b4&&_0x2874b4[_0x65a976(0x12be)](_0x3b0994=>{const _0x17b2a8=_0x65a976,_0x54ef36=_0x511f5d['players'][_0x17b2a8(0xc0d)](_0x4045ce=>_0x4045ce[_0x17b2a8(0x564)]===_0x3b0994[_0x17b2a8(0x1305)]),_0x218152=_0x511f5d[_0x17b2a8(0xf4f)][_0x17b2a8(0xc0d)](_0x267c93=>_0x267c93[_0x17b2a8(0x564)]===_0x3b0994[_0x17b2a8(0x12d8)]);_0x54ef36&&_0x54ef36[_0x17b2a8(0x6a2)]&&_0x218152&&(_0x511f5d[_0x17b2a8(0x78e)][_0x54ef36[_0x17b2a8(0x564)]]=_0x218152[_0x17b2a8(0x564)]);}),_0x511f5d[_0x65a976(0x1372)]=null;}catch(_0x1005f4){console[_0x65a976(0xe3b)](_0x65a976(0x31d),_0x1005f4),await _0x1519c8(_0x65a976(0xaab),_0x65a976(0x247)+_0x1005f4[_0x65a976(0x757)]),document[_0x65a976(0x479)](_0x65a976(0x733))[_0x65a976(0x10dd)][_0x65a976(0x678)]='block';return;}const _0x2fb504=_0x511f5d['players'][_0x65a976(0xc0d)](_0x416be2=>_0x416be2['id']===_0x65a976(0x4c5));if(_0x2fb504&&_0x2fb504[_0x65a976(0x6a2)]){_0x2365f0(_0x65a976(0x749)),_0x12b3de();const _0x18fe6e=await _0x1bb838(_0x65a976(0x2bc)),_0x8da784=_0x511f5d['players']['find'](_0x18de5d=>_0x18de5d['id']===_0x18fe6e);_0x8da784&&(_0x511f5d[_0x65a976(0x78e)][_0x2fb504[_0x65a976(0x564)]]=_0x8da784['name']);}_0x221bcb();}async function _0x1328df(){const _0x29b32a=_0x85c4bf,{proxyUrl:_0x5ae12d,apiKey:_0x274167,model:_0x601719}=_0x505390[_0x29b32a(0x30c)];if(!_0x5ae12d||!_0x274167||!_0x601719)return null;const _0x5d3466=_0x511f5d['players']['filter'](_0x1b29e9=>_0x1b29e9['isAlive']&&_0x1b29e9['id']!==_0x29b32a(0x4c5)),_0x14a49f=_0x511f5d[_0x29b32a(0xf4f)]['filter'](_0xb5c0ea=>_0xb5c0ea['isAlive'])[_0x29b32a(0x2e1)](_0x15a3f8=>_0x15a3f8[_0x29b32a(0x564)]);let _0x4c1e5c=_0x17d27f();_0x4c1e5c+=_0x29b32a(0x1368)+_0x14a49f[_0x29b32a(0x35d)](',\x20')+'\x0a\x0a现在，请为所有存活的AI角色生成他们的投票决定。';try{let _0x503b4b=_0x5ae12d['includes']('generativelanguage'),_0x3c3954=[{'role':_0x29b32a(0x4c5),'content':_0x29b32a(0xcfb)}],_0x3eac44=_0x19a701(_0x601719,_0x274167,_0x4c1e5c,_0x3c3954);const _0x2da22e=_0x503b4b?await fetch(_0x3eac44[_0x29b32a(0x5f3)],_0x3eac44[_0x29b32a(0x104c)]):await fetch(_0x5ae12d+_0x29b32a(0x347),{'method':_0x29b32a(0xba0),'headers':{'Content-Type':'application/json','Authorization':_0x29b32a(0xb27)+_0x274167},'body':JSON[_0x29b32a(0x1308)]({'model':_0x601719,'messages':[{'role':_0x29b32a(0xbaa),'content':_0x4c1e5c},..._0x3c3954],'temperature':_0x505390[_0x29b32a(0x888)][_0x29b32a(0x398)]||0.8})});if(!_0x2da22e['ok'])throw new Error((await _0x2da22e[_0x29b32a(0xfdf)]())[_0x29b32a(0xe3b)][_0x29b32a(0x757)]);const _0x30ebba=await _0x2da22e[_0x29b32a(0xfdf)](),_0x57f3db=getGeminiResponseText(_0x30ebba);let _0x398a39=_0x57f3db[_0x29b32a(0x491)](/^```json\s*/,'')[_0x29b32a(0x491)](/```$/,'')[_0x29b32a(0x9c1)]();const _0x1a96ba=_0x398a39[_0x29b32a(0xf2f)]('['),_0x170396=_0x398a39[_0x29b32a(0x7c5)](']');if(_0x1a96ba===-0x1||_0x170396===-0x1||_0x170396<_0x1a96ba)throw new Error(_0x29b32a(0xb20));const _0x2e5c4d=_0x398a39[_0x29b32a(0x1323)](_0x1a96ba,_0x170396+0x1);try{const _0x268db3=_0x2e5c4d[_0x29b32a(0xab4)](/(\[[\s\S]*?\])/g);if(_0x268db3&&_0x268db3[_0x29b32a(0x990)]>0x0)return JSON[_0x29b32a(0x94c)](_0x268db3[_0x268db3['length']-0x1]);return JSON[_0x29b32a(0x94c)](_0x2e5c4d);}catch(_0x1e0a7b){throw new Error(_0x29b32a(0xf72)+_0x1e0a7b[_0x29b32a(0x757)]+_0x29b32a(0x124a)+_0x57f3db);}}catch(_0x4e6a40){console[_0x29b32a(0xe3b)](_0x29b32a(0xff5),_0x4e6a40);throw new Error('获取AI投票决策失败:\x20'+_0x4e6a40[_0x29b32a(0x757)]);}}function _0x221bcb(){const _0x367b9e=_0x85c4bf,_0x39b078={},_0x35dc3e={};for(const _0x3ddbfd in _0x511f5d[_0x367b9e(0x78e)]){const _0x4e3611=_0x511f5d[_0x367b9e(0x78e)][_0x3ddbfd];_0x39b078[_0x4e3611]=(_0x39b078[_0x4e3611]||0x0)+0x1,!_0x35dc3e[_0x4e3611]&&(_0x35dc3e[_0x4e3611]=[]),_0x35dc3e[_0x4e3611]['push'](_0x3ddbfd);}let _0x2fe9b0=0x0,_0x3ce07c=[];for(const _0x518d73 in _0x39b078){const _0x417369=_0x39b078[_0x518d73];if(_0x417369>_0x2fe9b0)_0x2fe9b0=_0x417369,_0x3ce07c=[_0x518d73];else _0x417369===_0x2fe9b0&&_0x3ce07c[_0x367b9e(0x1a0)](_0x518d73);}_0x2365f0('投票结果：');for(const _0x182a90 in _0x35dc3e){_0x2365f0(_0x182a90+'\x20('+_0x35dc3e[_0x182a90]['length']+'票):\x20'+_0x35dc3e[_0x182a90][_0x367b9e(0x35d)]('、\x20'));}if(_0x3ce07c[_0x367b9e(0x990)]===0x1&&_0x2fe9b0>0x0){const _0x46b8ea=_0x511f5d[_0x367b9e(0xf4f)][_0x367b9e(0xc0d)](_0x37aa6c=>_0x37aa6c[_0x367b9e(0x564)]===_0x3ce07c[0x0]);if(_0x46b8ea){_0x46b8ea['isAlive']=![],_0x2365f0(_0x46b8ea[_0x367b9e(0x564)]+_0x367b9e(0x101e));if(_0x46b8ea[_0x367b9e(0x508)]==='猎人'){}}}else _0x2365f0(_0x367b9e(0xd42));_0x12b3de();if(_0x4be975())return;_0x511f5d[_0x367b9e(0xa0b)]++,_0x1a4323();}async function _0x1f873b(){const _0x3b58ab=_0x85c4bf,{proxyUrl:_0x2f5a30,apiKey:_0x360825,model:_0x5a436c}=_0x505390['apiConfig'];if(!_0x2f5a30||!_0x360825||!_0x5a436c)return null;const _0x26b457=_0x511f5d[_0x3b58ab(0xf4f)][_0x3b58ab(0x85d)](_0x215ce3=>_0x215ce3[_0x3b58ab(0x508)]==='狼人'&&_0x215ce3[_0x3b58ab(0x6a2)]),_0x41c2e0=_0x511f5d[_0x3b58ab(0xf4f)][_0x3b58ab(0x85d)](_0x3d4c58=>_0x3d4c58[_0x3b58ab(0x6a2)]&&_0x3d4c58[_0x3b58ab(0x508)]!=='狼人'),_0x46c12d='\x0a#\x20你的任务\x0a你现在是狼人团队的指挥官。你的任务是分析当前局势，并为狼人团队选择一个最佳的刀人目标。\x0a#\x20核心规则\x0a1.\x20\x20**目标**:\x20优先刀掉预言家、女巫等神职人员。如果没有明确的神职信息，可以根据发言来判断谁的逻辑清晰、威胁最大。\x0a2.\x20\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON对象，格式如下:\x0a\x20\x20\x20\x20`{\x22target_name\x22:\x20\x22你决定要刀的玩家名字\x22}`\x0a\x0a#\x20游戏状态\x0a-\x20**你的狼队友是**:\x20'+_0x26b457[_0x3b58ab(0x2e1)](_0x32a7f0=>_0x32a7f0[_0x3b58ab(0x564)])[_0x3b58ab(0x35d)]('、\x20')+_0x3b58ab(0x525)+_0x41c2e0['map'](_0x1622e2=>_0x1622e2[_0x3b58ab(0x564)])['join']('、\x20')+_0x3b58ab(0x1264)+_0x511f5d['discussionLog'][_0x3b58ab(0x2e1)](_0x524be6=>_0x524be6[_0x3b58ab(0xc9d)]+':\x20'+_0x524be6[_0x3b58ab(0xac4)])[_0x3b58ab(0x35d)]('\x0a')+_0x3b58ab(0xe3e);try{let _0x138b37=_0x2f5a30[_0x3b58ab(0x44f)](_0x3b58ab(0x136f)),_0x5c0004=[{'role':_0x3b58ab(0x4c5),'content':'请选择今晚的目标。'}],_0x3a0d31=_0x19a701(_0x5a436c,_0x360825,_0x46c12d,_0x5c0004);const _0x10ae8b=_0x138b37?await fetch(_0x3a0d31[_0x3b58ab(0x5f3)],_0x3a0d31[_0x3b58ab(0x104c)]):await fetch(_0x2f5a30+'/v1/chat/completions',{'method':'POST','headers':{'Content-Type':_0x3b58ab(0xcb5),'Authorization':_0x3b58ab(0xb27)+_0x360825},'body':JSON['stringify']({'model':_0x5a436c,'messages':[{'role':'system','content':_0x46c12d},..._0x5c0004],'temperature':_0x505390[_0x3b58ab(0x888)][_0x3b58ab(0x398)]||0.8})});if(!_0x10ae8b['ok'])throw new Error((await _0x10ae8b[_0x3b58ab(0xfdf)]())[_0x3b58ab(0xe3b)][_0x3b58ab(0x757)]);const _0x16f978=await _0x10ae8b[_0x3b58ab(0xfdf)](),_0x4f0050=getGeminiResponseText(_0x16f978),_0x2cb9f9=_0x4f0050['match'](/({[\s\S]*})/);if(!_0x2cb9f9)throw new Error(_0x3b58ab(0xf11));const _0x257717=JSON[_0x3b58ab(0x94c)](_0x2cb9f9[0x0]),_0x247a57=_0x511f5d[_0x3b58ab(0xf4f)][_0x3b58ab(0xc0d)](_0x2db8b6=>_0x2db8b6[_0x3b58ab(0x564)]===_0x257717[_0x3b58ab(0x13b3)]);return _0x247a57?_0x247a57['id']:null;}catch(_0x197090){return console[_0x3b58ab(0xe3b)](_0x3b58ab(0x291),_0x197090),_0x41c2e0[Math[_0x3b58ab(0xd71)](Math[_0x3b58ab(0x103a)]()*_0x41c2e0['length'])]['id'];}}function _0x29d635(_0x3ef24e,_0x182344){return new Promise(_0x483ca4=>{const _0x57007a=_0x6666,_0x585af0=document[_0x57007a(0x479)](_0x57007a(0xbcc)),_0x3b8ed2=document[_0x57007a(0x479)]('werewolf-witch-selection-list'),_0x28c809=document[_0x57007a(0x479)]('witch-modal-title'),_0x4d35be=document[_0x57007a(0x479)](_0x57007a(0x11a7)),_0x279b5=document[_0x57007a(0x479)](_0x57007a(0x10e5));_0x3b8ed2[_0x57007a(0x3de)]='';const _0x50976b=_0x4d35be['cloneNode'](!![]);_0x4d35be[_0x57007a(0x1134)]['replaceChild'](_0x50976b,_0x4d35be);const _0x48defa=_0x279b5[_0x57007a(0xbcf)](!![]);_0x279b5[_0x57007a(0x1134)]['replaceChild'](_0x48defa,_0x279b5),_0x50976b[_0x57007a(0x10dd)][_0x57007a(0x678)]=_0x57007a(0xee3),_0x50976b[_0x57007a(0xfce)]=!![];let _0x32e8ad={'save':![],'poison':null},_0x47b451=null;if(_0x3ef24e&&!_0x182344[_0x57007a(0x857)]){_0x28c809[_0x57007a(0x97b)]=_0x57007a(0x8ce)+_0x3ef24e[_0x57007a(0x564)]+_0x57007a(0x8a0);const _0x9a6ec6=document[_0x57007a(0xbd5)](_0x57007a(0x7b6));_0x9a6ec6[_0x57007a(0xfd4)]=_0x57007a(0x4e9),_0x9a6ec6[_0x57007a(0x97b)]=_0x57007a(0x1176),_0x9a6ec6[_0x57007a(0x10dd)][_0x57007a(0x37d)]=_0x57007a(0x1117),_0x9a6ec6['onclick']=()=>{const _0x231c1c=_0x57007a;_0x32e8ad['save']=!![],_0x585af0['classList'][_0x231c1c(0x8b6)](_0x231c1c(0x45a)),_0x483ca4(_0x32e8ad);},_0x3b8ed2[_0x57007a(0x9f4)](_0x9a6ec6);}else _0x3ef24e?_0x28c809['textContent']=_0x57007a(0x8ce)+_0x3ef24e[_0x57007a(0x564)]+_0x57007a(0x9dc):_0x28c809['textContent']=_0x57007a(0xca7);if(!_0x182344[_0x57007a(0x74a)]){const _0x56c3b1=document[_0x57007a(0xbd5)]('p');_0x56c3b1[_0x57007a(0x97b)]=_0x57007a(0x85b),_0x56c3b1[_0x57007a(0x10dd)]['textAlign']='center',_0x56c3b1[_0x57007a(0x10dd)][_0x57007a(0x29d)]=_0x57007a(0x1117),_0x3b8ed2['appendChild'](_0x56c3b1);const _0x15a85a=_0x511f5d[_0x57007a(0xf4f)][_0x57007a(0x85d)](_0x1a12be=>_0x1a12be[_0x57007a(0x6a2)]&&_0x1a12be['id']!==_0x3ef24e?.['id']);_0x15a85a[_0x57007a(0x12be)](_0x5ad40e=>{const _0x3f54df=_0x57007a,_0x4ef163=document[_0x3f54df(0xbd5)](_0x3f54df(0x6c8));_0x4ef163[_0x3f54df(0xfd4)]=_0x3f54df(0xe72),_0x4ef163[_0x3f54df(0x13d4)]['id']=_0x5ad40e['id'],_0x4ef163[_0x3f54df(0x3de)]=_0x3f54df(0xdba)+_0x5ad40e[_0x3f54df(0x799)]+_0x3f54df(0x86b)+_0x5ad40e[_0x3f54df(0x564)]+_0x3f54df(0x451),_0x4ef163['onclick']=()=>{const _0xa7b16=_0x3f54df;_0x3b8ed2[_0xa7b16(0x99e)]('.selected')[_0xa7b16(0x12be)](_0x2a4998=>_0x2a4998[_0xa7b16(0x9cd)][_0xa7b16(0x8b6)](_0xa7b16(0x10dc))),_0x4ef163[_0xa7b16(0x9cd)][_0xa7b16(0x807)]('selected'),_0x47b451=_0x5ad40e['id'],_0x50976b[_0xa7b16(0xfce)]=![];},_0x3b8ed2[_0x3f54df(0x9f4)](_0x4ef163);});}_0x50976b['onclick']=()=>{const _0x2d5a35=_0x57007a;_0x47b451&&(_0x32e8ad[_0x2d5a35(0x201)]=_0x47b451,_0x585af0[_0x2d5a35(0x9cd)][_0x2d5a35(0x8b6)](_0x2d5a35(0x45a)),_0x483ca4(_0x32e8ad));},_0x48defa['onclick']=()=>{const _0xa4b38=_0x57007a;_0x585af0[_0xa4b38(0x9cd)][_0xa4b38(0x8b6)](_0xa4b38(0x45a)),_0x483ca4(_0x32e8ad);},_0x585af0['classList'][_0x57007a(0x807)](_0x57007a(0x45a));});}async function _0x196341(){const _0x2bc64f=_0x85c4bf,_0x1b9f60=_0x511f5d['lastFailedAction'];if(!_0x1b9f60)return;document[_0x2bc64f(0x479)]('werewolf-retry-btn')[_0x2bc64f(0x10dd)][_0x2bc64f(0x678)]=_0x2bc64f(0xff8),await _0x1519c8(_0x2bc64f(0xbd7),_0x2bc64f(0x11c8)+_0x1b9f60+_0x2bc64f(0x127a));switch(_0x1b9f60){case _0x2bc64f(0x120a):await _0x1a4323();break;case _0x2bc64f(0x322):await _0x3af14c();break;case'getVotes':await _0x3c536b();break;}}function _0x4be975(){const _0x1ff0a4=_0x85c4bf,_0x493fb7=_0x511f5d[_0x1ff0a4(0xf4f)][_0x1ff0a4(0x85d)](_0x521d77=>_0x521d77['isAlive']),_0x55993a=_0x493fb7[_0x1ff0a4(0x85d)](_0x1fde1e=>_0x1fde1e[_0x1ff0a4(0x508)]==='狼人'),_0x2ddeaa=_0x493fb7[_0x1ff0a4(0x85d)](_0x4ba397=>[_0x1ff0a4(0x1250),'女巫','猎人','守卫']['includes'](_0x4ba397[_0x1ff0a4(0x508)])),_0x19af35=_0x493fb7[_0x1ff0a4(0x85d)](_0x441e38=>_0x441e38[_0x1ff0a4(0x508)]==='平民');let _0xca323d=null;if(_0x55993a['length']===0x0)_0xca323d='好人';else{if(_0x55993a[_0x1ff0a4(0x990)]>=_0x2ddeaa[_0x1ff0a4(0x990)]+_0x19af35[_0x1ff0a4(0x990)])_0xca323d='狼人';else _0x511f5d[_0x1ff0a4(0xabd)]===_0x1ff0a4(0xa5d)?(_0x2ddeaa[_0x1ff0a4(0x990)]===0x0||_0x19af35['length']===0x0)&&(_0xca323d='狼人'):_0x2ddeaa[_0x1ff0a4(0x990)]===0x0&&_0x19af35['length']===0x0&&(_0xca323d='狼人');}if(_0xca323d)return _0x56578f(_0xca323d),!![];return![];}async function _0x2ef0d4(){const _0x4b5bc7=_0x85c4bf,_0x58627b=await _0x1a9e79(_0x4b5bc7(0x1c0),'此功能将扫描数据库，尝试找出并修复“角色在数据库中存在，但未在聊天列表显示”的问题。<br><br><strong>操作通常是安全的，但仍建议在操作前备份数据。</strong>',{'confirmText':_0x4b5bc7(0x3c1)});if(!_0x58627b)return;await _0x1519c8('请稍候...',_0x4b5bc7(0x3c9));try{const _0x42384e=await _0xb81d4e[_0x4b5bc7(0x1027)][_0x4b5bc7(0x4ba)]();let _0x9cadbb=0x0;for(const _0x11f950 of _0x42384e){let _0x44b942=![];!Array[_0x4b5bc7(0x285)](_0x11f950[_0x4b5bc7(0x7d3)])&&(_0x11f950[_0x4b5bc7(0x7d3)]=[],_0x44b942=!![]),(typeof _0x11f950[_0x4b5bc7(0x18a)]!=='object'||_0x11f950[_0x4b5bc7(0x18a)]===null)&&(_0x11f950['settings']={},_0x44b942=!![]),!_0x11f950[_0x4b5bc7(0x9d7)]&&!_0x11f950[_0x4b5bc7(0xe2d)]&&(_0x11f950[_0x4b5bc7(0xe2d)]=_0x11f950[_0x4b5bc7(0x564)],_0x44b942=!![]),typeof _0x11f950[_0x4b5bc7(0x1090)]===_0x4b5bc7(0xcb8)&&(_0x11f950[_0x4b5bc7(0x1090)]=0x0,_0x44b942=!![]),!Array[_0x4b5bc7(0x285)](_0x11f950[_0x4b5bc7(0x3b4)])&&(_0x11f950[_0x4b5bc7(0x3b4)]=[],_0x44b942=!![]),_0x44b942&&(_0x9cadbb++,console[_0x4b5bc7(0x90f)](_0x4b5bc7(0xf5b)+_0x11f950['name']+_0x4b5bc7(0x1ec)+_0x11f950['id']+')\x20的残缺数据。'),await _0xb81d4e[_0x4b5bc7(0x1027)][_0x4b5bc7(0x5d0)](_0x11f950)),_0x505390[_0x4b5bc7(0x1027)][_0x11f950['id']]=_0x11f950;}_0x9cadbb>0x0?(await _0x1519c8('修复完成！',_0x4b5bc7(0x438)+_0x9cadbb+_0x4b5bc7(0xba6)),await _0x1b7f69()):await _0x1519c8(_0x4b5bc7(0xbd1),_0x4b5bc7(0x8f5));}catch(_0x183e26){console['error'](_0x4b5bc7(0xafc),_0x183e26),await _0x1519c8(_0x4b5bc7(0xaab),_0x4b5bc7(0x1fd)+_0x183e26[_0x4b5bc7(0x757)]);}}function _0x13e918(_0x4083ec,_0x35bd52=_0x85c4bf(0xb8f)){const _0x4b89c5=_0x85c4bf;if(_0x4083ec[_0x4b89c5(0x8bc)]('.loader-container'))return;const _0x2121a9=document['createElement'](_0x4b89c5(0x6c8));_0x2121a9[_0x4b89c5(0xfd4)]='loader-container',_0x2121a9['innerHTML']=_0x4b89c5(0xd88),_0x35bd52===_0x4b89c5(0xeb7)?_0x4083ec['appendChild'](_0x2121a9):_0x4083ec['prepend'](_0x2121a9);}function _0x168e5c(_0x5a6e40){const _0x4d0abf=_0x85c4bf,_0xfaa48c=_0x5a6e40[_0x4d0abf(0x8bc)](_0x4d0abf(0xa08));_0xfaa48c&&_0xfaa48c['remove']();}async function _0x3da604(){const _0x21cbe2=_0x85c4bf,_0x7d5cc3=document['getElementById'](_0x21cbe2(0xcd6)),_0x3e4488=document['getElementById'](_0x21cbe2(0xd9e)),_0x230c56=document[_0x21cbe2(0x479)](_0x21cbe2(0x9de));_0x3e4488[_0x21cbe2(0x3de)]='',_0x230c56[_0x21cbe2(0xf7b)]=![];const _0x119578=await _0xb81d4e[_0x21cbe2(0xd1b)]['toArray']();_0x119578[_0x21cbe2(0x990)]===0x0?_0x3e4488[_0x21cbe2(0x3de)]=_0x21cbe2(0x11c4):_0x119578[_0x21cbe2(0x12be)](_0x549299=>{const _0x41916b=_0x21cbe2,_0x3b4dc3=document[_0x41916b(0xbd5)](_0x41916b(0x6c8));_0x3b4dc3[_0x41916b(0xfd4)]=_0x41916b(0x908),_0x3b4dc3[_0x41916b(0x13d4)]['bookId']=_0x549299['id'],_0x3b4dc3['innerHTML']=_0x41916b(0x33e)+_0x549299[_0x41916b(0x564)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x3e4488['appendChild'](_0x3b4dc3);}),_0x7d5cc3[_0x21cbe2(0x9cd)][_0x21cbe2(0x807)]('visible');}async function _0x272208(){const _0x112a09=_0x85c4bf,_0x5b253c=document[_0x112a09(0x99e)](_0x112a09(0x10a1));if(_0x5b253c['length']===0x0){alert(_0x112a09(0xf3e));return;}const _0x33b432=Array['from'](_0x5b253c)[_0x112a09(0x2e1)](_0x38f7cd=>_0x38f7cd[_0x112a09(0x13d4)][_0x112a09(0x1124)]),_0x91fd49=await _0x1a9e79(_0x112a09(0xe53),_0x112a09(0xc1f)+_0x5b253c[_0x112a09(0x990)]+_0x112a09(0x795),{'confirmButtonClass':'btn-danger','confirmText':_0x112a09(0x587)});if(!_0x91fd49)return;await _0x1519c8(_0x112a09(0xbd7),_0x112a09(0x112b));try{await _0xb81d4e[_0x112a09(0x4b9)]('rw',_0xb81d4e[_0x112a09(0xd1b)],_0xb81d4e['chats'],async()=>{const _0x3d3eed=_0x112a09;await _0xb81d4e['worldBooks'][_0x3d3eed(0x12f5)](_0x33b432);const _0x10fb9c=await _0xb81d4e[_0x3d3eed(0x1027)][_0x3d3eed(0x4ba)]();for(const _0x134239 of _0x10fb9c){if(_0x134239['settings']&&Array[_0x3d3eed(0x285)](_0x134239['settings'][_0x3d3eed(0x13da)])){const _0x37826a=_0x134239['settings'][_0x3d3eed(0x13da)][_0x3d3eed(0x990)];_0x134239[_0x3d3eed(0x18a)][_0x3d3eed(0x13da)]=_0x134239[_0x3d3eed(0x18a)]['linkedWorldBookIds'][_0x3d3eed(0x85d)](_0x231422=>!_0x33b432[_0x3d3eed(0x44f)](_0x231422)),_0x134239[_0x3d3eed(0x18a)][_0x3d3eed(0x13da)]['length']<_0x37826a&&await _0xb81d4e[_0x3d3eed(0x1027)][_0x3d3eed(0x5d0)](_0x134239);}}}),_0x505390['worldBooks']=_0x505390['worldBooks'][_0x112a09(0x85d)](_0x1e3ea4=>!_0x33b432[_0x112a09(0x44f)](_0x1e3ea4['id'])),document[_0x112a09(0x479)](_0x112a09(0xcd6))[_0x112a09(0x9cd)][_0x112a09(0x8b6)](_0x112a09(0x45a)),await _0x1519c8(_0x112a09(0xa62),_0x5b253c[_0x112a09(0x990)]+_0x112a09(0x6df));}catch(_0x5abf63){console[_0x112a09(0xe3b)](_0x112a09(0x46b),_0x5abf63),await _0x1519c8(_0x112a09(0x8fd),_0x112a09(0x10c9)+_0x5abf63[_0x112a09(0x757)]);}}function _0x3a3b09(){const _0x48cd53=_0x85c4bf;if(!_0x505390[_0x48cd53(0x233)])return;const _0x2d2bb9=_0x505390[_0x48cd53(0x233)],_0x2b0b29=document[_0x48cd53(0x479)](_0x48cd53(0x9a6)),_0x46fa61=document[_0x48cd53(0x479)](_0x48cd53(0x10cb)),_0x460693=document[_0x48cd53(0x479)](_0x48cd53(0x192));let _0x34ab0e=_0x36a37a[_0x2d2bb9];if(_0x34ab0e&&_0x34ab0e[_0x48cd53(0x4c3)]){_0x34ab0e[_0x48cd53(0x8e9)]&&_0x3a597c();_0x2b0b29[_0x48cd53(0x10dd)]['display']='flex';return;}_0x29613e(_0x2d2bb9),_0x501051(_0x2d2bb9),_0x2b0b29[_0x48cd53(0x10dd)][_0x48cd53(0x678)]='flex',_0x46fa61[_0x48cd53(0x9cd)]['remove'](_0x48cd53(0x4bd)),_0x460693[_0x48cd53(0x10dd)][_0x48cd53(0x678)]=_0x48cd53(0xff8);const _0x3220ab=document[_0x48cd53(0x479)]('phone-screen'),_0x115f39=_0x46fa61[_0x48cd53(0x10f7)](),_0xa8c202=(_0x3220ab['clientHeight']-_0x115f39['height'])/0x2,_0x4d2319=(_0x3220ab[_0x48cd53(0x90a)]-_0x115f39['width'])/0x2;_0x46fa61[_0x48cd53(0x10dd)]['top']=_0xa8c202+'px',_0x46fa61[_0x48cd53(0x10dd)][_0x48cd53(0x138f)]=_0x4d2319+'px',_0x46fa61['style'][_0x48cd53(0x87a)]='';}function _0x29613e(_0x15ed3e){const _0x5b94da=_0x85c4bf;_0x36a37a[_0x15ed3e]={'isActive':!![],'isMinimized':![],'title':_0x5b94da(0x1216),'contentLines':[],'currentPage':0x0,'totalPages':0x0,'linesPerPage':0xf,'currentSnippet':''};}function _0x1cbcba(){const _0x2fd74f=_0x85c4bf,_0x40a91f=_0x505390[_0x2fd74f(0x233)];if(!_0x40a91f||!_0x36a37a[_0x40a91f]||!_0x36a37a[_0x40a91f]['isActive'])return;document[_0x2fd74f(0x479)]('reading-overlay')['style'][_0x2fd74f(0x678)]=_0x2fd74f(0xff8),document[_0x2fd74f(0x479)](_0x2fd74f(0x192))[_0x2fd74f(0x10dd)][_0x2fd74f(0x678)]=_0x2fd74f(0xff8),document['getElementById']('reading-window')['classList'][_0x2fd74f(0x8b6)](_0x2fd74f(0x4bd)),_0x36a37a[_0x40a91f][_0x2fd74f(0x4c3)]=![],console[_0x2fd74f(0x90f)](_0x2fd74f(0x8fb));}function _0x1cefc0(){const _0x2056f0=_0x85c4bf,_0x8155b3=_0x36a37a[_0x505390[_0x2056f0(0x233)]];if(!_0x8155b3||!_0x8155b3['isActive']||_0x8155b3['isMinimized'])return;_0x8155b3['isMinimized']=!![],document[_0x2056f0(0x479)](_0x2056f0(0x10cb))[_0x2056f0(0x9cd)][_0x2056f0(0x807)](_0x2056f0(0x4bd)),document[_0x2056f0(0x479)](_0x2056f0(0x192))[_0x2056f0(0x10dd)][_0x2056f0(0x678)]=_0x2056f0(0x899);}function _0x3a597c(){const _0x5cc949=_0x85c4bf,_0x4cf054=_0x36a37a[_0x505390[_0x5cc949(0x233)]];if(!_0x4cf054||!_0x4cf054[_0x5cc949(0x4c3)]||!_0x4cf054[_0x5cc949(0x8e9)])return;_0x4cf054['isMinimized']=![],document[_0x5cc949(0x479)](_0x5cc949(0x192))[_0x5cc949(0x10dd)][_0x5cc949(0x678)]=_0x5cc949(0xff8),document[_0x5cc949(0x479)](_0x5cc949(0x10cb))[_0x5cc949(0x9cd)][_0x5cc949(0x8b6)](_0x5cc949(0x4bd));}function _0x58c937(_0x13d3d2,_0x3b53dc){const _0x301279=_0x85c4bf;let _0x3de88c=0x0,_0x2a5557=0x0,_0x358763=0x0,_0x2ae659=0x0;const _0x41582b=document[_0x301279(0x479)](_0x301279(0x2e2)),_0x5f5a32=_0x22e03b=>{const _0x3b6b16=_0x301279;if(_0x22e03b[_0x3b6b16(0xfa2)]['closest']('button'))return;if(_0x13d3d2['style'][_0x3b6b16(0x87a)]){const _0x13f4e5=_0x13d3d2[_0x3b6b16(0x10f7)](),_0x4a414e=_0x13d3d2[_0x3b6b16(0x2d2)]['getBoundingClientRect']();_0x13d3d2['style'][_0x3b6b16(0xb8f)]=_0x13f4e5[_0x3b6b16(0xb8f)]-_0x4a414e[_0x3b6b16(0xb8f)]+'px',_0x13d3d2['style'][_0x3b6b16(0x138f)]=_0x13f4e5[_0x3b6b16(0x138f)]-_0x4a414e[_0x3b6b16(0x138f)]+'px',_0x13d3d2['style'][_0x3b6b16(0x87a)]='';}_0x22e03b['preventDefault']();const _0x2eb26d=_0x22e03b[_0x3b6b16(0x858)]===_0x3b6b16(0x2a9)?_0x22e03b[_0x3b6b16(0x639)][0x0]:_0x22e03b;_0x358763=_0x2eb26d[_0x3b6b16(0x221)],_0x2ae659=_0x2eb26d['clientY'],document[_0x3b6b16(0xa75)]('mouseup',_0x9a5d46),document[_0x3b6b16(0xa75)](_0x3b6b16(0xaf1),_0x41f519),document['addEventListener']('touchend',_0x9a5d46),document['addEventListener'](_0x3b6b16(0x56f),_0x41f519);},_0x41f519=_0x43ac82=>{const _0x125924=_0x301279,_0x21956d=_0x43ac82['type']==='touchmove'?_0x43ac82[_0x125924(0x639)][0x0]:_0x43ac82;_0x3de88c=_0x358763-_0x21956d[_0x125924(0x221)],_0x2a5557=_0x2ae659-_0x21956d['clientY'],_0x358763=_0x21956d[_0x125924(0x221)],_0x2ae659=_0x21956d['clientY'];let _0x1a1256=_0x13d3d2[_0x125924(0x6dc)]-_0x2a5557,_0x41fcba=_0x13d3d2[_0x125924(0x13a3)]-_0x3de88c;const _0x579f22=_0x41582b['clientHeight']-_0x13d3d2['offsetHeight']-0xa,_0x25a649=_0x41582b[_0x125924(0x90a)]-_0x13d3d2[_0x125924(0x918)]-0xa;_0x1a1256=Math[_0x125924(0x6b8)](0xa,Math[_0x125924(0x80f)](_0x1a1256,_0x579f22)),_0x41fcba=Math[_0x125924(0x6b8)](0xa,Math['min'](_0x41fcba,_0x25a649)),_0x13d3d2[_0x125924(0x10dd)][_0x125924(0xb8f)]=_0x1a1256+'px',_0x13d3d2[_0x125924(0x10dd)][_0x125924(0x138f)]=_0x41fcba+'px';},_0x9a5d46=()=>{const _0x7cd853=_0x301279;document[_0x7cd853(0xdec)]('mouseup',_0x9a5d46),document['removeEventListener']('mousemove',_0x41f519),document[_0x7cd853(0xdec)]('touchend',_0x9a5d46),document[_0x7cd853(0xdec)](_0x7cd853(0x56f),_0x41f519);};_0x3b53dc['addEventListener'](_0x301279(0xee9),_0x5f5a32),_0x3b53dc['addEventListener'](_0x301279(0x2a9),_0x5f5a32);}function _0x501051(_0x256b09){const _0x2202de=_0x85c4bf,_0x140821=_0x36a37a[_0x256b09];if(!_0x140821)return;const _0x582b44=document[_0x2202de(0x479)](_0x2202de(0x57d)),_0x12008b=document[_0x2202de(0x479)](_0x2202de(0x7af)),_0x112f91=document[_0x2202de(0x479)](_0x2202de(0x11a5)),_0x2b8863=document[_0x2202de(0x479)](_0x2202de(0x1100)),_0xd0af51=document[_0x2202de(0x479)](_0x2202de(0x531));_0x582b44[_0x2202de(0x97b)]=_0x140821[_0x2202de(0xc29)];if(_0x140821[_0x2202de(0x92f)]['length']===0x0)_0x12008b[_0x2202de(0x3de)]=_0x2202de(0x283),_0x140821[_0x2202de(0x10ba)]=0x0,_0x140821['currentPage']=0x0;else{const _0x5527d=_0x140821[_0x2202de(0xe24)]*_0x140821[_0x2202de(0xbf2)],_0x4437df=_0x5527d+_0x140821[_0x2202de(0xbf2)];_0x12008b[_0x2202de(0x97b)]=_0x140821[_0x2202de(0x92f)][_0x2202de(0x777)](_0x5527d,_0x4437df)[_0x2202de(0x35d)]('\x0a');}_0x112f91[_0x2202de(0x97b)]=_0x140821[_0x2202de(0xe24)]+0x1+_0x2202de(0x4e7)+_0x140821[_0x2202de(0x10ba)],_0x2b8863['disabled']=_0x140821[_0x2202de(0xe24)]===0x0,_0xd0af51['disabled']=_0x140821[_0x2202de(0xe24)]>=_0x140821['totalPages']-0x1;}function _0x408d73(){const _0x3b4f07=_0x85c4bf,_0x5764c8=_0x36a37a[_0x505390[_0x3b4f07(0x233)]];_0x5764c8&&_0x5764c8['currentPage']<_0x5764c8[_0x3b4f07(0x10ba)]-0x1&&(_0x5764c8[_0x3b4f07(0xe24)]++,_0x501051(_0x505390[_0x3b4f07(0x233)]),document[_0x3b4f07(0x479)](_0x3b4f07(0x7af))[_0x3b4f07(0x2b3)]=0x0,_0x5228ae(_0x5764c8[_0x3b4f07(0x1291)],_0x5764c8[_0x3b4f07(0xe24)]));}async function _0x126658(){const _0x359f70=_0x85c4bf,_0x6199c7=_0x36a37a[_0x505390['activeChatId']];_0x6199c7&&_0x6199c7[_0x359f70(0xe24)]>0x0&&(_0x6199c7[_0x359f70(0xe24)]--,_0x501051(_0x505390[_0x359f70(0x233)]),document[_0x359f70(0x479)]('reading-content')[_0x359f70(0x2b3)]=0x0,await _0x5228ae(_0x6199c7[_0x359f70(0x1291)],_0x6199c7[_0x359f70(0xe24)]),await notifyAiOfPageTurn(_0x505390[_0x359f70(0x233)],_0x6199c7));}function _0x5e5956(){const _0x432648=_0x85c4bf;document['getElementById']('book-upload-input')[_0x432648(0xd2f)]();}async function _0x24b869(_0x1e1106){const _0x344740=_0x85c4bf,_0x43c71d=new Uint8Array(_0x1e1106);if(_0x43c71d[_0x344740(0x990)]>=0x3&&_0x43c71d[0x0]===0xef&&_0x43c71d[0x1]===0xbb&&_0x43c71d[0x2]===0xbf)return console['log']('检测到\x20UTF-8\x20BOM，使用\x20UTF-8\x20解码。'),new TextDecoder(_0x344740(0x429))[_0x344740(0xc79)](_0x43c71d);if(_0x43c71d[_0x344740(0x990)]>=0x2&&_0x43c71d[0x0]===0xff&&_0x43c71d[0x1]===0xfe)return console[_0x344740(0x90f)](_0x344740(0x579)),new TextDecoder(_0x344740(0x254))[_0x344740(0xc79)](_0x43c71d);if(_0x43c71d[_0x344740(0x990)]>=0x2&&_0x43c71d[0x0]===0xfe&&_0x43c71d[0x1]===0xff)return console[_0x344740(0x90f)]('检测到\x20UTF-16\x20BE\x20BOM，使用\x20UTF-16\x20BE\x20解码。'),new TextDecoder(_0x344740(0xa95))[_0x344740(0xc79)](_0x43c71d);try{console[_0x344740(0x90f)](_0x344740(0x32d));const _0x498ebc=new TextDecoder(_0x344740(0x429),{'fatal':!![]})[_0x344740(0xc79)](_0x43c71d);return console[_0x344740(0x90f)](_0x344740(0x1332)),_0x498ebc;}catch(_0x4b1e93){console[_0x344740(0x90f)](_0x344740(0x10f9));try{const _0x450869=new TextDecoder(_0x344740(0xae4))[_0x344740(0xc79)](_0x43c71d);return console[_0x344740(0x90f)](_0x344740(0x75c)),_0x450869;}catch(_0x282fc8){console[_0x344740(0xe3b)](_0x344740(0x774),_0x282fc8);throw new Error(_0x344740(0xccc));}}}async function _0x5107bf(_0x3189df){const _0x34a070=_0x85c4bf,_0x2222ad=_0x3189df['target'][_0x34a070(0xe63)][0x0];if(!_0x2222ad)return;try{const _0x2f6786=await _0x2222ad[_0x34a070(0x4bb)](),_0x13eec8=await _0x24b869(_0x2f6786),_0x3fba34=_0x2222ad[_0x34a070(0x564)]['replace'](/\.txt$/i,''),_0x4c3f28=await _0xb81d4e[_0x34a070(0x243)]['add']({'title':_0x3fba34,'content':_0x13eec8,'lastOpened':Date[_0x34a070(0x12d6)]()});await _0xa9ed10(_0x4c3f28),document['getElementById'](_0x34a070(0xf2d))['classList'][_0x34a070(0x658)](_0x34a070(0x45a))&&_0x5eeb7f();}catch(_0x357e0d){console[_0x34a070(0xe3b)]('导入书籍失败:',_0x357e0d),await _0x1519c8(_0x34a070(0xf28),_0x357e0d[_0x34a070(0x757)]);}finally{_0x3189df[_0x34a070(0xfa2)]['value']=null;}}async function _0x5cc7b8(){const _0x3745f4=_0x85c4bf,_0x5954ff=_0x505390[_0x3745f4(0x233)];if(!_0x5954ff)return;const _0x248a34=_0x36a37a[_0x5954ff];if(!_0x248a34||_0x248a34['totalPages']<=0x1)return;const _0x15cc45=await _0x9a2c09(_0x3745f4(0x59a),'请输入想跳转的页码\x20(1\x20-\x20'+_0x248a34[_0x3745f4(0x10ba)]+')',_0x248a34[_0x3745f4(0xe24)]+0x1);if(_0x15cc45===null)return;const _0x46b162=parseInt(_0x15cc45);if(isNaN(_0x46b162)||_0x46b162<0x1||_0x46b162>_0x248a34[_0x3745f4(0x10ba)]){alert(_0x3745f4(0xcb1));return;}_0x248a34[_0x3745f4(0xe24)]=_0x46b162-0x1,_0x501051(_0x5954ff),_0x5228ae(_0x248a34[_0x3745f4(0x1291)],_0x248a34[_0x3745f4(0xe24)]);}async function _0x5228ae(_0x1634c3,_0x274ee0){const _0x26abed=_0x85c4bf;if(!_0x1634c3)return;try{await _0xb81d4e[_0x26abed(0x243)][_0x26abed(0xeb2)](_0x1634c3,{'currentPage':_0x274ee0});}catch(_0x733806){console[_0x26abed(0xe3b)](_0x26abed(0x6be)+_0x1634c3+_0x26abed(0x900),_0x733806);}}async function _0x408d73(){const _0x3905b4=_0x85c4bf,_0x553641=_0x36a37a[_0x505390[_0x3905b4(0x233)]];_0x553641&&_0x553641[_0x3905b4(0xe24)]<_0x553641[_0x3905b4(0x10ba)]-0x1&&(_0x553641[_0x3905b4(0xe24)]++,_0x501051(_0x505390[_0x3905b4(0x233)]),document['getElementById']('reading-content')[_0x3905b4(0x2b3)]=0x0,await _0x5228ae(_0x553641[_0x3905b4(0x1291)],_0x553641[_0x3905b4(0xe24)]),await notifyAiOfPageTurn(_0x505390['activeChatId'],_0x553641));}function _0x3697a9(_0x52c997,_0x124028){const _0x347f81=_0x85c4bf,_0x4e7613=_0x505390[_0x347f81(0x233)];if(!_0x4e7613)return;const _0x268103=_0x36a37a[_0x4e7613];_0x268103[_0x347f81(0xc29)]=_0x52c997[_0x347f81(0x491)](/\.txt$/i,''),_0x268103[_0x347f81(0x92f)]=_0x124028[_0x347f81(0x53e)](/\r\n?|\n/)['map'](_0x464d0a=>_0x464d0a['replace'](/ +/g,'\x20')),_0x268103[_0x347f81(0x10ba)]=Math['ceil'](_0x268103[_0x347f81(0x92f)]['length']/_0x268103[_0x347f81(0xbf2)]),_0x268103[_0x347f81(0xe24)]=0x0,_0x501051(_0x4e7613);}async function _0x2a7b44(){const _0x2f176d=_0x85c4bf;document[_0x2f176d(0x479)]('reading-library-search-input')[_0x2f176d(0x4e0)]='',await _0x5eeb7f(),document[_0x2f176d(0x479)](_0x2f176d(0xf2d))['classList'][_0x2f176d(0x807)]('visible');}async function _0x5eeb7f(_0x577901=''){const _0x12cbe3=_0x85c4bf,_0x418a1e=document[_0x12cbe3(0x479)]('reading-library-list');let _0x5728a9=await _0xb81d4e[_0x12cbe3(0x243)][_0x12cbe3(0x3d2)](_0x12cbe3(0x79b))[_0x12cbe3(0x336)]()['toArray']();_0x418a1e[_0x12cbe3(0x3de)]='';_0x577901&&(_0x5728a9=_0x5728a9[_0x12cbe3(0x85d)](_0x19e8e3=>_0x19e8e3['title'][_0x12cbe3(0x1f8)]()['includes'](_0x577901[_0x12cbe3(0x1f8)]())));if(_0x5728a9[_0x12cbe3(0x990)]===0x0){const _0x4337c1=_0x577901?_0x12cbe3(0xfdd):_0x12cbe3(0xcb4);_0x418a1e[_0x12cbe3(0x3de)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>'+_0x4337c1+_0x12cbe3(0x1049);return;}_0x5728a9[_0x12cbe3(0x12be)](_0x33b427=>{const _0x5005bd=_0x12cbe3,_0x4387bd=document[_0x5005bd(0xbd5)](_0x5005bd(0x6c8));_0x4387bd[_0x5005bd(0xfd4)]=_0x5005bd(0x100f),_0x4387bd[_0x5005bd(0x3de)]=_0x5005bd(0x1309)+_0x33b427['id']+'\x22>'+_0x33b427[_0x5005bd(0xc29)]+_0x5005bd(0x66d)+_0x33b427['id']+_0x5005bd(0xe05),_0x418a1e[_0x5005bd(0x9f4)](_0x4387bd);});}async function _0xa9ed10(_0x9e3bde){const _0x13b7f9=_0x85c4bf,_0x592a8d=_0x505390[_0x13b7f9(0x233)];if(!_0x592a8d)return;const _0x4cb21d=await _0xb81d4e[_0x13b7f9(0x243)][_0x13b7f9(0x111a)](_0x9e3bde);if(!_0x4cb21d){alert('找不到这本书！');return;}await _0xb81d4e[_0x13b7f9(0x243)]['update'](_0x9e3bde,{'lastOpened':Date[_0x13b7f9(0x12d6)]()});const _0x664881=_0x36a37a[_0x592a8d];_0x664881[_0x13b7f9(0x1291)]=_0x9e3bde,_0x664881[_0x13b7f9(0xc29)]=_0x4cb21d[_0x13b7f9(0xc29)],_0x664881['contentLines']=_0x4cb21d[_0x13b7f9(0xac4)][_0x13b7f9(0x53e)](/\r\n?|\n/)[_0x13b7f9(0x2e1)](_0x5af462=>_0x5af462[_0x13b7f9(0x491)](/ +/g,'\x20')),_0x664881[_0x13b7f9(0x10ba)]=Math[_0x13b7f9(0x62d)](_0x664881[_0x13b7f9(0x92f)][_0x13b7f9(0x990)]/_0x664881[_0x13b7f9(0xbf2)]),_0x664881[_0x13b7f9(0xe24)]=_0x4cb21d[_0x13b7f9(0xe24)]||0x0,_0x501051(_0x592a8d),document[_0x13b7f9(0x479)]('reading-content')['scrollTop']=0x0,document[_0x13b7f9(0x479)]('reading-library-modal')['classList'][_0x13b7f9(0x8b6)](_0x13b7f9(0x45a));}async function _0x6b53a0(_0x51b9cf){const _0x3df0ed=_0x85c4bf,_0x297492=await _0xb81d4e['readingLibrary'][_0x3df0ed(0x111a)](_0x51b9cf);if(!_0x297492)return;const _0x1b040f=await _0x1a9e79(_0x3df0ed(0x92a),'确定要删除《'+_0x297492['title']+_0x3df0ed(0x1e2),{'confirmButtonClass':'btn-danger'});_0x1b040f&&(await _0xb81d4e['readingLibrary']['delete'](_0x51b9cf),await _0x5eeb7f());}function _0x3697a9(_0x41071f,_0x31998f){const _0x30ebbb=_0x85c4bf,_0xb66caa=_0x505390[_0x30ebbb(0x233)];if(!_0xb66caa)return;const _0x1e50d1=_0x36a37a[_0xb66caa];_0x1e50d1[_0x30ebbb(0xc29)]=_0x41071f[_0x30ebbb(0x491)](/\.txt$/i,''),_0x1e50d1[_0x30ebbb(0x92f)]=_0x31998f[_0x30ebbb(0x53e)](/\r\n?|\n/),_0x1e50d1[_0x30ebbb(0x10ba)]=Math[_0x30ebbb(0x62d)](_0x1e50d1[_0x30ebbb(0x92f)][_0x30ebbb(0x990)]/_0x1e50d1[_0x30ebbb(0xbf2)]),_0x1e50d1[_0x30ebbb(0xe24)]=0x0,_0x501051(_0xb66caa);}function _0x58c937(_0x77a2be,_0x59436c){const _0x442df8=_0x85c4bf;let _0x5c672e=0x0,_0x10f368=0x0,_0x15d1db=0x0,_0x580559=0x0,_0x45822d=![],_0x3d1ae7=![];const _0x1fc73e=document[_0x442df8(0x479)](_0x442df8(0x2e2)),_0x2875ae=_0x15ae08=>{const _0x10f61e=_0x442df8;if(_0x77a2be!==_0x59436c&&_0x15ae08['target']['closest'](_0x10f61e(0x7b6)))return;_0x45822d=!![],_0x3d1ae7=![];const _0x40f2f2=_0x15ae08[_0x10f61e(0x858)]===_0x10f61e(0x2a9)?_0x15ae08[_0x10f61e(0x639)][0x0]:_0x15ae08;_0x15d1db=_0x40f2f2[_0x10f61e(0x221)],_0x580559=_0x40f2f2['clientY'],_0x77a2be[_0x10f61e(0x10dd)][_0x10f61e(0xb8f)]=_0x77a2be['offsetTop']+'px',_0x77a2be[_0x10f61e(0x10dd)]['left']=_0x77a2be[_0x10f61e(0x13a3)]+'px',_0x77a2be['style'][_0x10f61e(0x87a)]='',document[_0x10f61e(0xa75)](_0x10f61e(0xe94),_0x14da97),document['addEventListener']('mousemove',_0x49fa9f),document[_0x10f61e(0xa75)](_0x10f61e(0xeba),_0x14da97),document[_0x10f61e(0xa75)]('touchmove',_0x49fa9f,{'passive':![]});},_0x49fa9f=_0x5be3b5=>{const _0x1d8979=_0x442df8;if(!_0x45822d)return;const _0x340fdf=_0x5be3b5['type']===_0x1d8979(0x56f)?_0x5be3b5[_0x1d8979(0x639)][0x0]:_0x5be3b5,_0x3be6af=_0x340fdf['clientX']-_0x15d1db,_0x224e4b=_0x340fdf[_0x1d8979(0x87b)]-_0x580559;!_0x3d1ae7&&(Math[_0x1d8979(0xdc5)](_0x3be6af)>0x5||Math['abs'](_0x224e4b)>0x5)&&(_0x3d1ae7=!![]);_0x3d1ae7&&_0x5be3b5[_0x1d8979(0x520)]&&_0x5be3b5[_0x1d8979(0xd58)]();_0x5c672e=_0x15d1db-_0x340fdf[_0x1d8979(0x221)],_0x10f368=_0x580559-_0x340fdf[_0x1d8979(0x87b)],_0x15d1db=_0x340fdf[_0x1d8979(0x221)],_0x580559=_0x340fdf[_0x1d8979(0x87b)];let _0xa5e43a=_0x77a2be[_0x1d8979(0x6dc)]-_0x10f368,_0x23fd9e=_0x77a2be[_0x1d8979(0x13a3)]-_0x5c672e;const _0x55f245=_0x1fc73e['clientHeight']-_0x77a2be[_0x1d8979(0xfc5)]-0xa,_0x3aa13a=_0x1fc73e[_0x1d8979(0x90a)]-_0x77a2be['offsetWidth']-0xa;_0xa5e43a=Math['max'](0xa,Math[_0x1d8979(0x80f)](_0xa5e43a,_0x55f245)),_0x23fd9e=Math[_0x1d8979(0x6b8)](0xa,Math[_0x1d8979(0x80f)](_0x23fd9e,_0x3aa13a)),_0x77a2be['style'][_0x1d8979(0xb8f)]=_0xa5e43a+'px',_0x77a2be[_0x1d8979(0x10dd)]['left']=_0x23fd9e+'px';},_0x14da97=()=>{const _0x53015b=_0x442df8;document['removeEventListener'](_0x53015b(0xe94),_0x14da97),document[_0x53015b(0xdec)](_0x53015b(0xaf1),_0x49fa9f),document[_0x53015b(0xdec)](_0x53015b(0xeba),_0x14da97),document[_0x53015b(0xdec)](_0x53015b(0x56f),_0x49fa9f);if(!_0x45822d)return;_0x45822d=![],!_0x3d1ae7&&_0x77a2be['click']();};_0x59436c[_0x442df8(0xa75)]('mousedown',_0x2875ae),_0x59436c['addEventListener']('touchstart',_0x2875ae,{'passive':![]});}function _0x1cefc0(){const _0x3a2762=_0x85c4bf,_0x516a4a=_0x36a37a[_0x505390[_0x3a2762(0x233)]];if(!_0x516a4a||!_0x516a4a[_0x3a2762(0x4c3)])return;document['getElementById'](_0x3a2762(0x10cb))[_0x3a2762(0x9cd)][_0x3a2762(0x807)](_0x3a2762(0x4bd)),document[_0x3a2762(0x479)](_0x3a2762(0x192))['style'][_0x3a2762(0x678)]=_0x3a2762(0x899),_0x516a4a['isMinimized']=!![];}function _0x3a597c(){const _0x1f3937=_0x85c4bf,_0x335afa=_0x36a37a[_0x505390[_0x1f3937(0x233)]];if(!_0x335afa||!_0x335afa[_0x1f3937(0x4c3)])return;document['getElementById']('reading-restore-btn')['style'][_0x1f3937(0x678)]='none',document[_0x1f3937(0x479)](_0x1f3937(0x10cb))[_0x1f3937(0x9cd)]['remove'](_0x1f3937(0x4bd)),_0x335afa['isMinimized']=![];}function _0x153d21(_0x11f80d,_0x57cfe9){let _0xb2017;return function(..._0x3a1ecf){const _0x10582d=_0x6666,_0x4490d2=this;clearTimeout(_0xb2017),_0xb2017=setTimeout(()=>_0x11f80d[_0x10582d(0x1275)](_0x4490d2,_0x3a1ecf),_0x57cfe9);};}function _0x39755a(_0x56c097){const _0x3ae808=_0x85c4bf,_0xb5fd5=_0x36a37a[_0x56c097];if(!_0xb5fd5||!_0xb5fd5[_0x3ae808(0x4c3)])return'';const _0x3f55be=_0xb5fd5['title']||'未知书籍';let _0x3678e6='',_0x2a5ced='';if(_0xb5fd5['currentSnippet']&&_0xb5fd5['currentSnippet']['trim']())_0x3678e6=_0xb5fd5[_0x3ae808(0x132e)],_0x2a5ced=_0x3ae808(0x75b);else{if(_0xb5fd5['contentLines'][_0x3ae808(0x990)]>0x0){const _0x1e8df4=_0xb5fd5['currentPage']*_0xb5fd5[_0x3ae808(0xbf2)],_0x5aa058=_0x1e8df4+_0xb5fd5[_0x3ae808(0xbf2)];_0x3678e6=_0xb5fd5[_0x3ae808(0x92f)]['slice'](_0x1e8df4,_0x5aa058)[_0x3ae808(0x35d)]('\x0a')[_0x3ae808(0x1323)](0x0,0xc8),_0x2a5ced=_0x3ae808(0x7e2);}else _0x3678e6=_0x3ae808(0x107b),_0x2a5ced='内容';}return _0x3ae808(0xcb9)+_0x3f55be+_0x3ae808(0xd04)+_0x2a5ced+_0x3ae808(0x334)+_0x3678e6+_0x3ae808(0x123a)+(_0x505390[_0x3ae808(0x1027)][_0x56c097]?.[_0x3ae808(0xe2d)]||_0x3ae808(0xd39))+_0x3ae808(0xc19);}function _0x3cb1bd(){const _0x1a8e0a=_0x85c4bf,_0x58629e=_0x505390[_0x1a8e0a(0x233)];if(!_0x58629e||!_0x36a37a[_0x58629e])return;const _0xcffa00=_0x36a37a[_0x58629e],_0xeab5d5=document[_0x1a8e0a(0x479)](_0x1a8e0a(0x7af)),_0x49ed03=_0xeab5d5[_0x1a8e0a(0x2b3)],_0x2255ff=_0xeab5d5['clientHeight'],_0x5b76e6=_0x49ed03+_0x2255ff,_0x293a0d=0xf*1.8,_0x5607ad=Math[_0x1a8e0a(0xd71)](_0x49ed03/_0x293a0d),_0xccb78f=Math[_0x1a8e0a(0x62d)](_0x5b76e6/_0x293a0d),_0x5b2956=_0xcffa00[_0x1a8e0a(0xe24)]*_0xcffa00[_0x1a8e0a(0xbf2)]+_0x5607ad,_0x57c701=_0xcffa00[_0x1a8e0a(0xe24)]*_0xcffa00[_0x1a8e0a(0xbf2)]+_0xccb78f;if(_0x5b2956<0x0||_0x5b2956>=_0xcffa00[_0x1a8e0a(0x92f)][_0x1a8e0a(0x990)])return;const _0x3936c9=_0xcffa00[_0x1a8e0a(0x92f)][_0x1a8e0a(0x777)](Math['max'](0x0,_0x5b2956),Math[_0x1a8e0a(0x80f)](_0xcffa00['contentLines']['length'],_0x57c701))[_0x1a8e0a(0x35d)]('\x0a');_0xcffa00[_0x1a8e0a(0x132e)]=_0x3936c9;}function _0x91c8a5(){const _0x1cba79=_0x85c4bf,_0x2148af=document[_0x1cba79(0x479)]('silent-audio-player');if(_0x2148af){const _0x4bede8=_0x2148af[_0x1cba79(0xe02)]();_0x4bede8!==undefined&&_0x4bede8[_0x1cba79(0x13d8)](_0x31891d=>{const _0x44ca4=_0x1cba79;console[_0x44ca4(0x90f)](_0x44ca4(0x7c6));})[_0x1cba79(0x575)](_0x3bda0e=>{const _0x561478=_0x1cba79;console[_0x561478(0x139e)](_0x561478(0x539),_0x3bda0e);});}}function _0x2a4a67(){const _0x839983=_0x85c4bf,_0x3522d5=document[_0x839983(0x479)]('silent-audio-player');_0x3522d5&&!_0x3522d5[_0x839983(0xd90)]&&(_0x3522d5[_0x839983(0xa80)](),_0x3522d5[_0x839983(0x545)]=0x0,console[_0x839983(0x90f)](_0x839983(0xcf1)));}async function _0x31c356(_0x14fdba){const _0x4c56f4=_0x85c4bf,_0x40f30c=decodeURIComponent(_0x14fdba['dataset']['text']),_0x26d757=_0x14fdba['dataset'][_0x4c56f4(0xf67)],_0x5c42f7=_0x14fdba[_0x4c56f4(0x8bc)](_0x4c56f4(0xe92)),_0x2c0722=_0x14fdba['querySelector'](_0x4c56f4(0x1b8)),_0x23ec29=document[_0x4c56f4(0x479)]('tts-audio-player');if(!_0x23ec29[_0x4c56f4(0xd90)]&&_0x23ec29[_0x4c56f4(0x13d4)][_0x4c56f4(0x1140)]===_0x40f30c&&_0x23ec29['dataset'][_0x4c56f4(0x92e)]===_0x26d757){_0x23ec29[_0x4c56f4(0xa80)]();return;}_0x23ec29[_0x4c56f4(0xa80)](),document[_0x4c56f4(0x99e)](_0x4c56f4(0xe92))['forEach'](_0x191895=>_0x191895[_0x4c56f4(0x97b)]='▶');const _0x2f46b7='tts_'+_0x26d757+'_'+_0x40f30c;let _0x3852fd=_0x505390['ttsCache'][_0x4c56f4(0x111a)](_0x2f46b7);if(_0x3852fd){console[_0x4c56f4(0x90f)](_0x4c56f4(0xd09)),await _0x24ecdd(_0x3852fd[_0x4c56f4(0x5f3)],_0x3852fd[_0x4c56f4(0x858)],_0x40f30c,_0x26d757,_0x14fdba);return;}console[_0x4c56f4(0x90f)]('无缓存，正在请求\x20Minimax\x20TTS\x20API...');if(_0x5c42f7)_0x5c42f7['style'][_0x4c56f4(0x678)]=_0x4c56f4(0xff8);_0x2c0722['style'][_0x4c56f4(0x678)]=_0x4c56f4(0xee3);const {minimaxGroupId:_0x2fa689,minimaxApiKey:_0x26a958}=_0x505390[_0x4c56f4(0x30c)];if(!_0x2fa689||!_0x26a958){await _0x1519c8('配置错误',_0x4c56f4(0xf61)),_0x2c0722['style'][_0x4c56f4(0x678)]='none';if(_0x5c42f7)_0x5c42f7[_0x4c56f4(0x10dd)]['display']=_0x4c56f4(0x899);return;}try{const _0x16cb8b=await fetch(_0x4c56f4(0xfda)+_0x2fa689,{'method':_0x4c56f4(0xba0),'headers':{'Authorization':_0x4c56f4(0xb27)+_0x26a958,'Content-Type':_0x4c56f4(0xcb5)},'body':JSON[_0x4c56f4(0x1308)]({'text':_0x40f30c,'voice_id':_0x26d757,'model':_0x505390[_0x4c56f4(0x30c)]['minimaxModel']||_0x4c56f4(0xcc4),'speed':0x1,'vol':0x1,'pitch':0x0})});if(!_0x16cb8b['ok']){let _0x29674d='API\x20返回错误:\x20'+_0x16cb8b[_0x4c56f4(0x93c)];try{const _0x2609f0=await _0x16cb8b['json']();_0x29674d=_0x2609f0[_0x4c56f4(0xce6)]?.[_0x4c56f4(0x2be)]||JSON[_0x4c56f4(0x1308)](_0x2609f0);}catch(_0x5efa21){_0x29674d=await _0x16cb8b[_0x4c56f4(0x56d)]();}throw new Error(_0x29674d);}const _0x33140c=await _0x16cb8b[_0x4c56f4(0xb02)](),_0x597485=URL[_0x4c56f4(0xe9c)](_0x33140c);await _0x24ecdd(_0x597485,_0x33140c[_0x4c56f4(0x858)],_0x40f30c,_0x26d757,_0x14fdba);const _0x1aaec9=new FileReader();_0x1aaec9[_0x4c56f4(0x989)]=function(){const _0x512072=_0x4c56f4;_0x505390[_0x512072(0x6db)]['set'](_0x2f46b7,{'url':_0x1aaec9[_0x512072(0x97e)],'type':_0x33140c[_0x512072(0x858)]}),console[_0x512072(0x90f)](_0x512072(0xf34));},_0x1aaec9[_0x4c56f4(0x83c)](_0x33140c);}catch(_0x3ddda6){console[_0x4c56f4(0xe3b)](_0x4c56f4(0xb87),_0x3ddda6),await _0x1519c8(_0x4c56f4(0x488),_0x4c56f4(0x744)+_0x3ddda6['message']);}finally{_0x2c0722[_0x4c56f4(0x10dd)][_0x4c56f4(0x678)]=_0x4c56f4(0xff8);if(_0x5c42f7)_0x5c42f7['style'][_0x4c56f4(0x678)]=_0x4c56f4(0x899);}}function _0x24ecdd(_0x2287fc,_0x121ad2,_0x3253e3,_0x2c1292,_0x201c22){return new Promise((_0x15531e,_0x28271f)=>{const _0x12d738=_0x6666,_0x161971=document[_0x12d738(0x479)](_0x12d738(0x993));_0x161971[_0x12d738(0xa9c)]=_0x2287fc,_0x161971[_0x12d738(0x858)]=_0x121ad2,_0x161971['dataset'][_0x12d738(0x1140)]=_0x3253e3,_0x161971['dataset'][_0x12d738(0x92e)]=_0x2c1292;const _0x15b48f=_0x161971[_0x12d738(0xe02)]();_0x15b48f!==undefined&&_0x15b48f[_0x12d738(0x13d8)](()=>{const _0x3ed6fa=_0x12d738,_0x339deb=_0x201c22[_0x3ed6fa(0x8bc)](_0x3ed6fa(0xe92));if(_0x339deb)_0x339deb[_0x3ed6fa(0x97b)]='❚❚';_0x15531e();})[_0x12d738(0x575)](_0x1d1264=>{const _0x7c264d=_0x12d738;console[_0x7c264d(0xe3b)](_0x7c264d(0xf5a),_0x1d1264),_0x28271f(_0x1d1264);}),_0x161971['onended']=()=>{const _0x2340ea=_0x12d738,_0x143f46=_0x201c22[_0x2340ea(0x8bc)](_0x2340ea(0xe92));if(_0x143f46)_0x143f46['textContent']='▶';},_0x161971['onpause']=()=>{const _0x1d6982=_0x12d738,_0x31b2d7=_0x201c22[_0x1d6982(0x8bc)](_0x1d6982(0xe92));if(_0x31b2d7)_0x31b2d7[_0x1d6982(0x97b)]='▶';};});}function _0x46887d(_0x2015b1){const _0x36e37b=_0x85c4bf,_0x565320=_0x2015b1['closest']('.message-bubble');if(!_0x565320)return;const _0x2ac3be=_0x565320[_0x36e37b(0x8bc)]('.voice-transcript'),_0x163295=decodeURIComponent(_0x2015b1[_0x36e37b(0x13d4)]['text']);_0x2ac3be[_0x36e37b(0x10dd)]['display']==='block'?_0x2ac3be['style'][_0x36e37b(0x678)]='none':(_0x2ac3be[_0x36e37b(0x97b)]=_0x163295,_0x2ac3be[_0x36e37b(0x10dd)]['display']=_0x36e37b(0xee3));}async function _0x7e784b(){const _0x1d614d=_0x85c4bf;await _0x44bde9(),document[_0x1d614d(0x479)](_0x1d614d(0x1197))[_0x1d614d(0x9cd)][_0x1d614d(0x807)](_0x1d614d(0x45a));}async function _0x44bde9(){const _0x3688ad=_0x85c4bf,_0x46b38d=document[_0x3688ad(0x479)](_0x3688ad(0xa45)),_0x551fb8=await _0xb81d4e[_0x3688ad(0xdf0)]['toArray']();_0x46b38d['innerHTML']='';if(_0x551fb8['length']===0x0){_0x46b38d[_0x3688ad(0x3de)]=_0x3688ad(0xd77);return;}_0x551fb8[_0x3688ad(0x12be)](_0x4a8e86=>{const _0xb55c56=_0x3688ad,_0x3b5a61=document[_0xb55c56(0xbd5)](_0xb55c56(0x6c8));_0x3b5a61[_0xb55c56(0xfd4)]=_0xb55c56(0x100f),_0x3b5a61[_0xb55c56(0x3de)]=_0xb55c56(0xdf5)+_0x4a8e86[_0xb55c56(0x564)]+_0xb55c56(0xf63)+_0x4a8e86['id']+_0xb55c56(0x13a9),_0x46b38d['appendChild'](_0x3b5a61);});}async function _0x368475(){const _0x57cf14=_0x85c4bf,_0x4bad8f=document[_0x57cf14(0x479)](_0x57cf14(0x695)),_0x47fc54=_0x4bad8f[_0x57cf14(0x4e0)]['trim']();if(!_0x47fc54)return alert(_0x57cf14(0x446));const _0x3fe32f=await _0xb81d4e[_0x57cf14(0xdf0)][_0x57cf14(0x46f)](_0x57cf14(0x564))[_0x57cf14(0x4a2)](_0x47fc54)[_0x57cf14(0x64e)]();if(_0x3fe32f)return alert('分类\x20\x22'+_0x47fc54+_0x57cf14(0x12d5));await _0xb81d4e[_0x57cf14(0xdf0)][_0x57cf14(0x807)]({'name':_0x47fc54}),_0x4bad8f[_0x57cf14(0x4e0)]='',await _0x44bde9();}async function _0x378ad1(_0x5daf1c){const _0x2665f9=_0x85c4bf,_0x59613a=await _0x1a9e79(_0x2665f9(0x587),'删除分类后，该分类下的所有商品将变为“未分类”。确定吗？',{'confirmButtonClass':'btn-danger'});_0x59613a&&(await _0xb81d4e[_0x2665f9(0xdf0)][_0x2665f9(0x1ea)](_0x5daf1c),await _0xb81d4e[_0x2665f9(0x13c1)][_0x2665f9(0x46f)]('categoryId')[_0x2665f9(0x4a2)](_0x5daf1c)[_0x2665f9(0x629)]({'categoryId':null}),await _0x44bde9());}function _0x195912(_0x4c37fa={}){const _0x458a9c=_0x85c4bf,_0x42f577=document[_0x458a9c(0x479)]('product-variations-container'),_0x566e11=document['createElement'](_0x458a9c(0x6c8));return _0x566e11[_0x458a9c(0xfd4)]=_0x458a9c(0x790),_0x566e11[_0x458a9c(0x3de)]=_0x458a9c(0x1167)+(_0x4c37fa[_0x458a9c(0x564)]||'')+_0x458a9c(0xdef)+(_0x4c37fa[_0x458a9c(0x9ce)]||'')+_0x458a9c(0x8cf)+(_0x4c37fa[_0x458a9c(0xa09)]||_0x458a9c(0x106b))+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22form-button-secondary\x20upload-variation-image-btn\x22\x20style=\x22margin:\x200;\x20padding:\x208px\x2012px;\x22>上传</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22file\x22\x20class=\x22variation-image-input\x22\x20accept=\x22image/*\x22\x20hidden>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0x566e11[_0x458a9c(0x8bc)]('.delete-block-btn')[_0x458a9c(0xa75)](_0x458a9c(0xd2f),()=>_0x566e11['remove']()),_0x566e11[_0x458a9c(0x8bc)](_0x458a9c(0x373))[_0x458a9c(0xa75)](_0x458a9c(0xd2f),()=>{const _0x13c348=_0x458a9c;_0x566e11[_0x13c348(0x8bc)](_0x13c348(0x135f))[_0x13c348(0xd2f)]();}),_0x566e11[_0x458a9c(0x8bc)](_0x458a9c(0x135f))[_0x458a9c(0xa75)](_0x458a9c(0x1150),_0x36884f=>{const _0x2fb2be=_0x458a9c,_0x220057=_0x36884f['target']['files'][0x0];if(_0x220057){const _0x3890ea=new FileReader();_0x3890ea[_0x2fb2be(0x502)]=_0x86bcd6=>{const _0x4b5635=_0x2fb2be;_0x566e11['querySelector']('.variation-image-preview')[_0x4b5635(0xa9c)]=_0x86bcd6[_0x4b5635(0xfa2)][_0x4b5635(0x97e)];},_0x3890ea[_0x2fb2be(0x83c)](_0x220057);}}),_0x42f577['appendChild'](_0x566e11),_0x566e11;}async function _0x49993d(_0xf6a780){const _0x35af41=_0x85c4bf,_0x129ea0=await _0xb81d4e['shoppingProducts'][_0x35af41(0x111a)](_0xf6a780);if(!_0x129ea0||!_0x129ea0[_0x35af41(0xaa8)]||_0x129ea0['variations'][_0x35af41(0x990)]===0x0)return;const _0x617233=document['getElementById'](_0x35af41(0x724));document[_0x35af41(0x479)]('variation-product-image')['src']=_0x129ea0[_0x35af41(0xa09)],document['getElementById'](_0x35af41(0x9f0))[_0x35af41(0x97b)]=_0x129ea0[_0x35af41(0x564)];const _0x4c0d66=document['getElementById'](_0x35af41(0x1020));_0x4c0d66['innerHTML']='',_0x129ea0[_0x35af41(0xaa8)][_0x35af41(0x12be)]((_0x19a41e,_0x27183)=>{const _0xfd0e77=_0x35af41,_0xfda6a6=document[_0xfd0e77(0xbd5)]('input');_0xfda6a6[_0xfd0e77(0x858)]=_0xfd0e77(0xe54),_0xfda6a6[_0xfd0e77(0x564)]=_0xfd0e77(0xbab),_0xfda6a6['id']=_0xfd0e77(0x7a8)+_0xf6a780+'-'+_0x27183,_0xfda6a6[_0xfd0e77(0x4e0)]=_0x27183,_0xfda6a6[_0xfd0e77(0x10dd)][_0xfd0e77(0x678)]=_0xfd0e77(0xff8);if(_0x27183===0x0)_0xfda6a6[_0xfd0e77(0xf7b)]=!![];const _0x514e7f=document[_0xfd0e77(0xbd5)](_0xfd0e77(0xfac));_0x514e7f[_0xfd0e77(0x271)]='var-'+_0xf6a780+'-'+_0x27183,_0x514e7f[_0xfd0e77(0x97b)]=_0x19a41e[_0xfd0e77(0x564)],_0x514e7f[_0xfd0e77(0x10dd)][_0xfd0e77(0x506)]=_0xfd0e77(0x1067),_0x4c0d66[_0xfd0e77(0x9f4)](_0xfda6a6),_0x4c0d66[_0xfd0e77(0x9f4)](_0x514e7f);});const _0x26a38f=()=>{const _0x39d3fb=_0x35af41,_0x542e0d=_0x4c0d66['querySelector']('input[name=\x22variation-select\x22]:checked');_0x4c0d66[_0x39d3fb(0x99e)](_0x39d3fb(0xfac))[_0x39d3fb(0x12be)](_0x458b98=>{const _0x32aa13=_0x39d3fb;_0x458b98[_0x32aa13(0x10dd)][_0x32aa13(0x210)]=_0x32aa13(0x13d7),_0x458b98[_0x32aa13(0x10dd)]['color']='#333',_0x458b98[_0x32aa13(0x10dd)][_0x32aa13(0x11a6)]=_0x32aa13(0x505);});if(_0x542e0d){const _0x5180ae=_0x4c0d66['querySelector'](_0x39d3fb(0x1035)+_0x542e0d['id']+'\x22]');_0x5180ae[_0x39d3fb(0x10dd)][_0x39d3fb(0x210)]='var(--accent-color)',_0x5180ae['style'][_0x39d3fb(0x131f)]=_0x39d3fb(0xc14),_0x5180ae[_0x39d3fb(0x10dd)]['backgroundColor']='#e7f3ff';const _0x5c54f5=_0x129ea0[_0x39d3fb(0xaa8)][parseInt(_0x542e0d[_0x39d3fb(0x4e0)])];document[_0x39d3fb(0x479)](_0x39d3fb(0x41a))[_0x39d3fb(0x97b)]='¥'+_0x5c54f5[_0x39d3fb(0x9ce)]['toFixed'](0x2),_0x5c54f5[_0x39d3fb(0xa09)]?document[_0x39d3fb(0x479)](_0x39d3fb(0x1238))[_0x39d3fb(0xa9c)]=_0x5c54f5['imageUrl']:document[_0x39d3fb(0x479)](_0x39d3fb(0x1238))[_0x39d3fb(0xa9c)]=_0x129ea0['imageUrl'];}};_0x4c0d66[_0x35af41(0xa75)]('change',_0x26a38f),_0x26a38f(),document[_0x35af41(0x479)](_0x35af41(0xcc7))[_0x35af41(0x97b)]='1';const _0x184edd=document[_0x35af41(0x479)](_0x35af41(0x19c)),_0x327e07=_0x184edd['cloneNode'](!![]);_0x184edd[_0x35af41(0x1134)]['replaceChild'](_0x327e07,_0x184edd),_0x327e07[_0x35af41(0xa75)]('click',async()=>{const _0x304407=_0x35af41,_0x45907c=_0x4c0d66[_0x304407(0x8bc)]('input[name=\x22variation-select\x22]:checked'),_0x53fdb7=parseInt(document[_0x304407(0x479)](_0x304407(0xcc7))['textContent']);if(_0x45907c){const _0x2a7ebd=_0x129ea0['variations'][parseInt(_0x45907c[_0x304407(0x4e0)])];await _0x5a5593(_0xf6a780,_0x53fdb7,_0x2a7ebd),_0x617233[_0x304407(0x9cd)]['remove']('visible'),await _0x1519c8('成功','已成功加入购物车！');}}),_0x617233[_0x35af41(0x9cd)]['add'](_0x35af41(0x45a));}function _0x3f56d3(){const _0x150899=_0x85c4bf,_0x3300cd=document[_0x150899(0x479)](_0x150899(0x11a9));document['getElementById']('shopping-category-count-input')[_0x150899(0x4e0)]=_0x505390[_0x150899(0x888)][_0x150899(0x25b)]||0x3,document['getElementById'](_0x150899(0x1b0))[_0x150899(0x4e0)]=_0x505390[_0x150899(0x888)][_0x150899(0xfcc)]||0x8,_0x3300cd[_0x150899(0x9cd)][_0x150899(0x807)](_0x150899(0x45a));}async function _0xa122aa(){const _0x2c15f7=_0x85c4bf,_0x53870f=document[_0x2c15f7(0x479)](_0x2c15f7(0x510)),_0x547a5e=document[_0x2c15f7(0x479)]('shopping-product-count-input'),_0x3ab3f7=parseInt(_0x53870f[_0x2c15f7(0x4e0)]),_0x168891=parseInt(_0x547a5e[_0x2c15f7(0x4e0)]);if(isNaN(_0x3ab3f7)||isNaN(_0x168891)||_0x3ab3f7<0x1||_0x168891<0x1){alert(_0x2c15f7(0x761));return;}_0x505390[_0x2c15f7(0x888)][_0x2c15f7(0x25b)]=_0x3ab3f7,_0x505390[_0x2c15f7(0x888)]['shoppingProductCount']=_0x168891,await _0xb81d4e[_0x2c15f7(0x888)][_0x2c15f7(0x5d0)](_0x505390['globalSettings']),document['getElementById'](_0x2c15f7(0x11a9))[_0x2c15f7(0x9cd)][_0x2c15f7(0x8b6)]('visible'),await _0x1519c8(_0x2c15f7(0x8fa),_0x2c15f7(0x1001));}async function _0x4235dc(){const _0x124e19=_0x85c4bf;if(!_0x505390[_0x124e19(0x233)]){await _0x1519c8(_0x124e19(0xaab),_0x124e19(0x111e));return;}const _0x25f129=_0x505390[_0x124e19(0x1027)][_0x505390[_0x124e19(0x233)]],_0x441d5b=await _0x1a9e79('为“'+_0x25f129[_0x124e19(0x564)]+_0x124e19(0x958),_0x124e19(0x349),{'confirmText':_0x124e19(0x1149)});if(!_0x441d5b)return;await _0x1519c8(_0x124e19(0xbd7),_0x124e19(0x7a5)+_0x25f129['name']+_0x124e19(0x217));const _0x246a18=_0x505390[_0x124e19(0x30c)]['secondaryProxyUrl']&&_0x505390[_0x124e19(0x30c)][_0x124e19(0xbf6)]&&_0x505390['apiConfig'][_0x124e19(0x11ea)],{proxyUrl:_0x551028,apiKey:_0x66a9a5,model:_0x19fa1a}=_0x246a18?{'proxyUrl':_0x505390[_0x124e19(0x30c)]['secondaryProxyUrl'],'apiKey':_0x505390['apiConfig']['secondaryApiKey'],'model':_0x505390[_0x124e19(0x30c)][_0x124e19(0x11ea)]}:_0x505390[_0x124e19(0x30c)];if(!_0x551028||!_0x66a9a5||!_0x19fa1a){await _0x1519c8(_0x124e19(0x34f),_0x124e19(0xbc4));return;}const _0x34654b=_0x505390[_0x124e19(0x888)][_0x124e19(0x25b)]||0x3,_0x42d67c=_0x505390[_0x124e19(0x888)][_0x124e19(0xfcc)]||0x8,_0x304f5c=await _0xb81d4e['shoppingCategories'][_0x124e19(0x4ba)]();let _0x498549='';_0x304f5c['length']>0x0&&(_0x498549=_0x124e19(0x134d)+_0x304f5c[_0x124e19(0x2e1)](_0xb58310=>'\x22'+_0xb58310[_0x124e19(0x564)]+'\x22')['join'](',\x20')+']\x0a');const _0x5edc5f=_0x505390['qzoneSettings']['nickname']||'我',_0x47bb1b=_0x25f129[_0x124e19(0x3b4)]&&_0x25f129[_0x124e19(0x3b4)][_0x124e19(0x990)]>0x0?_0x25f129[_0x124e19(0x3b4)][_0x124e19(0x2e1)](_0x270235=>_0x124e19(0x619)+_0x3e14b1(_0x270235[_0x124e19(0x12a2)])+')\x20'+_0x270235['content'])[_0x124e19(0x35d)]('\x0a'):'无',_0x258845=_0x25f129[_0x124e19(0x7d3)]['slice'](-0xa)[_0x124e19(0x2e1)](_0xfeeef6=>(_0xfeeef6[_0x124e19(0x508)]===_0x124e19(0x4c5)?_0x5edc5f:_0x25f129[_0x124e19(0x564)])+':\x20'+String(_0xfeeef6['content'])[_0x124e19(0x1323)](0x0,0x1e)+_0x124e19(0x4d0))[_0x124e19(0x35d)]('\x0a');let _0x531a56='';if(_0x25f129[_0x124e19(0x18a)][_0x124e19(0x13da)]&&_0x25f129[_0x124e19(0x18a)][_0x124e19(0x13da)][_0x124e19(0x990)]>0x0){const _0x4f42ad=_0x25f129[_0x124e19(0x18a)][_0x124e19(0x13da)][_0x124e19(0x2e1)](_0x4a50e8=>{const _0x1fc0f4=_0x124e19,_0x8e986f=_0x505390[_0x1fc0f4(0xd1b)][_0x1fc0f4(0xc0d)](_0x3f6217=>_0x3f6217['id']===_0x4a50e8);if(!_0x8e986f||!Array[_0x1fc0f4(0x285)](_0x8e986f[_0x1fc0f4(0xac4)]))return'';const _0x30c70c=_0x8e986f[_0x1fc0f4(0xac4)][_0x1fc0f4(0x85d)](_0x2be027=>_0x2be027[_0x1fc0f4(0x2b7)]!==![])[_0x1fc0f4(0x2e1)](_0x11f972=>'-\x20'+_0x11f972[_0x1fc0f4(0xac4)])[_0x1fc0f4(0x35d)]('\x0a');return _0x30c70c?_0x1fc0f4(0x834)+_0x8e986f['name']+'》:\x0a'+_0x30c70c:'';})[_0x124e19(0x85d)](Boolean)[_0x124e19(0x35d)]('');_0x4f42ad&&(_0x531a56=_0x124e19(0x119f)+_0x4f42ad+'\x0a');}const _0x3b8659=_0x124e19(0x12d2)+_0x25f129[_0x124e19(0x564)]+'”量身打造一个专属的商品列表。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【角色定制(最高优先级)】**:\x20你生成的所有商品和分类【必须】深度绑定角色的性格、记忆和最近的对话。它们应该是角色会真正感兴趣、购买或制作的东西。\x0a2.\x20\x20**创造性与合理性**:\x20商品和分类必须合理且多样化。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个【单一的JSON对象】。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`{`\x20开始，并以\x20`}`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON对象前后添加任何多余的文字、解释或\x20markdown\x20标记。\x0a\x20\x20\x20\x20-\x20格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22categories\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22name\x22:\x20\x22分类名称1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22products\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22name\x22:\x20\x22商品名称1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22price\x22:\x2099.80,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22这是商品的详细描述，不少于50字...\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22variations\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22name\x22:\x20\x22款式1\x22,\x20\x22price\x22:\x20108.80,\x20\x22image_prompt\x22:\x20\x22款式1的图片【英文】关键词...\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22name\x22:\x20\x22款式2\x22,\x20\x22price\x22:\x20118.80,\x20\x22image_prompt\x22:\x20\x22款式2的图片【英文】关键词...\x22\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20],\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22商品主图的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**categories**:\x20生成\x20'+_0x34654b+_0x124e19(0x3e1)+_0x42d67c+'\x20个商品。\x0a\x20\x20\x20\x20-\x20**variations**:\x20每个商品【必须】包含【2到4个】不同的款式。\x0a\x0a#\x20角色与上下文\x20(你的灵感来源)\x0a-\x20**角色名称**:\x20'+_0x25f129[_0x124e19(0x564)]+_0x124e19(0x1105)+_0x25f129['settings'][_0x124e19(0x11f6)]+'\x0a-\x20**长期记忆**:\x20'+_0x47bb1b+_0x124e19(0x856)+_0x531a56+'\x0a'+_0x498549+_0x124e19(0x6e0)+_0x258845+_0x124e19(0xcbc)+_0x25f129[_0x124e19(0x564)]+'”生成这组【与角色高度相关】的商品数据。';try{const _0x386739=[{'role':_0x124e19(0x4c5),'content':_0x124e19(0xae1)}];let _0x30c838=_0x551028[_0x124e19(0x44f)](_0x124e19(0x136f)),_0x224ec4=_0x19a701(_0x19fa1a,_0x66a9a5,_0x3b8659,_0x386739);const _0x3f8599=_0x30c838?await fetch(_0x224ec4[_0x124e19(0x5f3)],_0x224ec4[_0x124e19(0x104c)]):await fetch(_0x551028+_0x124e19(0x347),{'method':_0x124e19(0xba0),'headers':{'Content-Type':_0x124e19(0xcb5),'Authorization':_0x124e19(0xb27)+_0x66a9a5},'body':JSON[_0x124e19(0x1308)]({'model':_0x19fa1a,'messages':[{'role':_0x124e19(0xbaa),'content':_0x3b8659},..._0x386739],'temperature':_0x505390[_0x124e19(0x888)][_0x124e19(0x398)]||0.9})});if(!_0x3f8599['ok'])throw new Error(_0x124e19(0xef2)+_0x3f8599[_0x124e19(0xd4a)]);const _0xea45a4=await _0x3f8599['json'](),_0x16da93=getGeminiResponseText(_0xea45a4),_0x4b1d15=_0x16da93[_0x124e19(0xab4)](/({[\s\S]*})/);if(!_0x4b1d15)throw new Error(_0x124e19(0x121d));const _0x64aed=JSON[_0x124e19(0x94c)](_0x4b1d15[0x0]);if(!_0x64aed['categories']||!Array[_0x124e19(0x285)](_0x64aed['categories']))throw new Error(_0x124e19(0x63c));await _0xb81d4e['transaction']('rw',_0xb81d4e[_0x124e19(0x13c1)],_0xb81d4e['shoppingCategories'],async()=>{const _0x1ffa41=_0x124e19;for(const _0x22f84c of _0x64aed[_0x1ffa41(0x4c4)]){let _0x49b3ba;const _0x20cd4f=await _0xb81d4e[_0x1ffa41(0xdf0)][_0x1ffa41(0x46f)](_0x1ffa41(0x564))['equalsIgnoreCase'](_0x22f84c['name'])[_0x1ffa41(0x64e)]();_0x20cd4f?_0x49b3ba=_0x20cd4f['id']:_0x49b3ba=await _0xb81d4e[_0x1ffa41(0xdf0)][_0x1ffa41(0x807)]({'name':_0x22f84c['name']});const _0x3812fe=_0x22f84c[_0x1ffa41(0x11fb)][_0x1ffa41(0x2e1)](_0x2e5752=>{const _0x48be92=_0x1ffa41;return{'name':_0x2e5752[_0x48be92(0x564)],'price':_0x2e5752[_0x48be92(0x9ce)]||0x0,'description':_0x2e5752[_0x48be92(0x78b)]||'','imageUrl':_0x48be92(0x730)+encodeURIComponent(_0x2e5752[_0x48be92(0xfb2)]),'variations':(_0x2e5752[_0x48be92(0xaa8)]||[])[_0x48be92(0x2e1)](_0x1f6451=>({..._0x1f6451,'imageUrl':_0x48be92(0x730)+encodeURIComponent(_0x1f6451[_0x48be92(0xfb2)])})),'categoryId':_0x49b3ba};});_0x3812fe[_0x1ffa41(0x990)]>0x0&&await _0xb81d4e[_0x1ffa41(0x13c1)]['bulkAdd'](_0x3812fe);}}),activeShoppingCategoryId=_0x124e19(0xf78),await _0x4fdfe7(),await _0x1519c8('生成成功！','为“'+_0x25f129['name']+_0x124e19(0x27b));}catch(_0x4fa733){console[_0x124e19(0xe3b)](_0x124e19(0x1175),_0x4fa733),await _0x1519c8(_0x124e19(0xebe),_0x124e19(0x582)+_0x4fa733[_0x124e19(0x757)]);}}async function _0x5b87ea(_0x2d941b){const _0x4a7bc1=_0x85c4bf,_0x2e8ee6=document[_0x4a7bc1(0x479)](_0x2d941b);if(!_0x2e8ee6)return;const _0x313877=await _0x5adb5e('更换图片',[{'text':_0x4a7bc1(0x83f),'value':'local'},{'text':_0x4a7bc1(0x10d7),'value':_0x4a7bc1(0x5f3)}]);let _0x1a51e3=null;if(_0x313877===_0x4a7bc1(0x8d3))_0x1a51e3=await _0x1ec1dd();else _0x313877===_0x4a7bc1(0x5f3)&&(_0x1a51e3=await _0x9a2c09(_0x4a7bc1(0x458),_0x4a7bc1(0xca6),_0x2e8ee6[_0x4a7bc1(0xa9c)],'url'));if(_0x1a51e3&&_0x1a51e3[_0x4a7bc1(0x9c1)]()){const _0x413ecf=_0x1a51e3['trim']();_0x2e8ee6['src']=_0x413ecf,!_0x505390[_0x4a7bc1(0x888)][_0x4a7bc1(0xd79)]&&(_0x505390[_0x4a7bc1(0x888)][_0x4a7bc1(0xd79)]={}),_0x505390[_0x4a7bc1(0x888)]['widgetData'][_0x2d941b]=_0x413ecf,await _0xb81d4e['globalSettings']['put'](_0x505390[_0x4a7bc1(0x888)]),await _0x1519c8('成功',_0x4a7bc1(0xeea));}}window['handleWidgetImageChange']=_0x5b87ea;async function _0x100901(){const _0x3ccdec=_0x85c4bf;if(!window[_0x3ccdec(0x73d)]){alert(_0x3ccdec(0x383));return;}await _0x1519c8(_0x3ccdec(0x453),_0x3ccdec(0x12d0));const _0x4bc0ae=streamSaver[_0x3ccdec(0x2f1)](_0x3ccdec(0xef9)+new Date()['toISOString']()[_0x3ccdec(0x53e)]('T')[0x0]+_0x3ccdec(0x1a6)),_0x12e4f6=_0x4bc0ae[_0x3ccdec(0x12bc)](),_0x4bfa8f=new TextEncoder();try{await _0x12e4f6[_0x3ccdec(0xe8b)](_0x4bfa8f['encode'](_0x3ccdec(0xe01)+Date[_0x3ccdec(0x12d6)]()+',\x0a\x22data\x22:\x20{\x0a'));const _0x51b198=await _0xb81d4e[_0x3ccdec(0x1155)][_0x3ccdec(0x2e1)](_0x42dffd=>_0x42dffd[_0x3ccdec(0x564)]);for(let _0x491e2a=0x0;_0x491e2a<_0x51b198['length'];_0x491e2a++){const _0x97f9a4=_0x51b198[_0x491e2a],_0x3b8afc=_0xb81d4e['table'](_0x97f9a4);await _0x12e4f6['write'](_0x4bfa8f[_0x3ccdec(0xdda)]('\x22'+_0x97f9a4+_0x3ccdec(0xa2b)));let _0x4ff9ab=!![];await _0x3b8afc['each'](_0x3a2bc9=>{const _0x4959ff=_0x3ccdec;!_0x4ff9ab&&_0x12e4f6[_0x4959ff(0xe8b)](_0x4bfa8f[_0x4959ff(0xdda)](',\x0a')),_0x12e4f6[_0x4959ff(0xe8b)](_0x4bfa8f[_0x4959ff(0xdda)](JSON[_0x4959ff(0x1308)](_0x3a2bc9))),_0x4ff9ab=![];}),await _0x12e4f6[_0x3ccdec(0xe8b)](_0x4bfa8f[_0x3ccdec(0xdda)]('\x0a]')),_0x491e2a<_0x51b198['length']-0x1&&await _0x12e4f6[_0x3ccdec(0xe8b)](_0x4bfa8f[_0x3ccdec(0xdda)](',\x0a'));}await _0x12e4f6[_0x3ccdec(0xe8b)](_0x4bfa8f[_0x3ccdec(0xdda)]('\x0a}\x0a}'));}catch(_0x3d46cf){console['error'](_0x3ccdec(0x924),_0x3d46cf),await _0x1519c8('导出失败','在写入文件流时发生错误:\x20'+_0x3d46cf[_0x3ccdec(0x757)]);}finally{await _0x12e4f6['close']();}}async function _0x364fad(){const _0x5d34f1=_0x85c4bf;await _0x1519c8(_0x5d34f1(0x453),_0x5d34f1(0x4ea));try{const _0x3419a0={'version':0x3,'timestamp':Date[_0x5d34f1(0x12d6)](),'data':{}},_0x5d522f=_0xb81d4e[_0x5d34f1(0x1155)][_0x5d34f1(0x2e1)](_0xd92c7a=>_0xd92c7a[_0x5d34f1(0x564)]);for(const _0x3e3a7c of _0x5d522f){const _0xb580e3=await _0xb81d4e[_0x5d34f1(0x4d7)](_0x3e3a7c)[_0x5d34f1(0x4ba)]();_0x3419a0['data'][_0x3e3a7c]=_0xb580e3,console[_0x5d34f1(0x90f)](_0x5d34f1(0x27f)+_0x3e3a7c+_0x5d34f1(0xe45)+_0xb580e3[_0x5d34f1(0x990)]);}const _0x3b5ba9=new Blob([JSON[_0x5d34f1(0x1308)](_0x3419a0,null,0x2)],{'type':'application/json'}),_0x3b6e9b=URL[_0x5d34f1(0xe9c)](_0x3b5ba9),_0x4c5807=document[_0x5d34f1(0xbd5)]('a');_0x4c5807[_0x5d34f1(0x2fa)]=_0x3b6e9b,_0x4c5807[_0x5d34f1(0x11d0)]=_0x5d34f1(0x95c)+new Date()['toISOString']()[_0x5d34f1(0x53e)]('T')[0x0]+_0x5d34f1(0x1a6),_0x4c5807[_0x5d34f1(0xd2f)](),URL['revokeObjectURL'](_0x3b6e9b),await _0x1519c8('导出成功',_0x5d34f1(0x9b0));}catch(_0x53053f){console[_0x5d34f1(0xe3b)](_0x5d34f1(0x43d),_0x53053f),await _0x1519c8(_0x5d34f1(0xa3d),_0x5d34f1(0xe49)+_0x53053f[_0x5d34f1(0x757)]);}}function _0x3f74ae(){const _0x554eb3=_0x85c4bf,_0x250f04=Object[_0x554eb3(0x3d5)](_0x505390['chats'])[_0x554eb3(0x1300)]((_0x383696,_0x1683e0)=>{const _0x42667d=_0x554eb3;if(_0x1683e0['id']===_0x505390[_0x42667d(0x233)])return _0x383696;return _0x383696+(_0x1683e0[_0x42667d(0x1090)]||0x0);},0x0),_0x58551d=_0x22cc4e||0x0,_0x762240=_0x250f04+_0x58551d,_0x4239a3=document['getElementById'](_0x554eb3(0x598));if(!_0x4239a3)return;let _0x471536=_0x4239a3[_0x554eb3(0x8bc)](_0x554eb3(0xb90));!_0x471536&&(_0x471536=document[_0x554eb3(0xbd5)](_0x554eb3(0xf91)),_0x471536['className']=_0x554eb3(0x369),_0x4239a3[_0x554eb3(0x9f4)](_0x471536));let _0x1de5fe=_0x4239a3[_0x554eb3(0x8bc)](_0x554eb3(0x3eb));_0x1de5fe&&_0x1de5fe[_0x554eb3(0x8b6)](),_0x762240>0x0?(_0x471536[_0x554eb3(0x97b)]=_0x762240>0x63?_0x554eb3(0x1002):_0x762240,_0x471536[_0x554eb3(0x10dd)]['display']='block',_0x471536['style'][_0x554eb3(0x1096)]='20',_0x471536[_0x554eb3(0x10dd)]['transform']='scale(0.8)'):_0x471536[_0x554eb3(0x10dd)][_0x554eb3(0x678)]=_0x554eb3(0xff8);}async function _0x457fdf(_0x17cd45){const _0x806d4c=_0x85c4bf,_0x39fb5f=_0x17cd45===_0x806d4c(0x331)?{'id':'uncategorized','name':'未分类'}:await _0xb81d4e[_0x806d4c(0x690)][_0x806d4c(0x111a)](_0x17cd45);if(!_0x39fb5f){console[_0x806d4c(0xe3b)](_0x806d4c(0xb82),_0x17cd45);return;}const _0x37b070=document['getElementById'](_0x806d4c(0x75e)),_0x428bb6=document[_0x806d4c(0x479)]('sticker-binding-chat-list'),_0x112dc4=_0x37b070['querySelector'](_0x806d4c(0xfa1));_0x428bb6[_0x806d4c(0x3de)]='',_0x112dc4[_0x806d4c(0x97b)]=_0x806d4c(0x6b7)+_0x39fb5f[_0x806d4c(0x564)]+_0x806d4c(0x37e);const _0xbb5909=Object['values'](_0x505390[_0x806d4c(0x1027)])[_0x806d4c(0x382)]((_0x2cfd0a,_0xb4734d)=>_0x2cfd0a[_0x806d4c(0x564)][_0x806d4c(0x223)](_0xb4734d[_0x806d4c(0x564)],_0x806d4c(0xdc2)));_0xbb5909[_0x806d4c(0x12be)](_0x588d8f=>{const _0x218518=_0x806d4c,_0x423169=_0x588d8f[_0x218518(0x18a)][_0x218518(0x115b)]['includes'](_0x17cd45),_0x46846b=document[_0x218518(0xbd5)](_0x218518(0x6c8));_0x46846b[_0x218518(0xfd4)]=_0x218518(0xf47),_0x46846b[_0x218518(0x3de)]=_0x218518(0x3cd)+_0x588d8f['id']+'\x22\x20'+(_0x423169?_0x218518(0xf7b):'')+_0x218518(0x240)+(_0x588d8f[_0x218518(0x9d7)]?_0x588d8f[_0x218518(0x18a)]['groupAvatar']:_0x588d8f[_0x218518(0x18a)]['aiAvatar']||_0x28c106)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x588d8f[_0x218518(0x564)]+_0x218518(0xa8b),_0x428bb6[_0x218518(0x9f4)](_0x46846b);}),document['getElementById'](_0x806d4c(0xfc4))['onclick']=()=>_0x1f0810(_0x17cd45),document[_0x806d4c(0x479)](_0x806d4c(0x6d2))[_0x806d4c(0x1063)]=()=>_0x37b070['classList'][_0x806d4c(0x8b6)](_0x806d4c(0x45a)),_0x37b070['classList'][_0x806d4c(0x807)]('visible');}async function _0x1f0810(_0x301241){const _0x53045d=_0x85c4bf,_0x44a15b=new Set(Array[_0x53045d(0x22f)](document[_0x53045d(0x99e)](_0x53045d(0xc94)))[_0x53045d(0x2e1)](_0x54eb3b=>_0x54eb3b['dataset'][_0x53045d(0xd4e)])),_0x5a43bd=[];for(const _0x15ef35 in _0x505390[_0x53045d(0x1027)]){const _0x24bbbb=_0x505390['chats'][_0x15ef35];!Array['isArray'](_0x24bbbb[_0x53045d(0x18a)][_0x53045d(0x115b)])&&(_0x24bbbb[_0x53045d(0x18a)]['stickerCategoryIds']=[]);const _0xeb62c0=_0x24bbbb['settings'][_0x53045d(0x115b)]['includes'](_0x301241),_0x19ed47=_0x44a15b[_0x53045d(0x391)](_0x15ef35);if(_0xeb62c0&&!_0x19ed47)_0x24bbbb[_0x53045d(0x18a)][_0x53045d(0x115b)]=_0x24bbbb['settings']['stickerCategoryIds']['filter'](_0x2e4f08=>_0x2e4f08!==_0x301241),_0x5a43bd['push'](_0x24bbbb);else!_0xeb62c0&&_0x19ed47&&(_0x24bbbb[_0x53045d(0x18a)][_0x53045d(0x115b)]['push'](_0x301241),_0x5a43bd[_0x53045d(0x1a0)](_0x24bbbb));}_0x5a43bd[_0x53045d(0x990)]>0x0&&(await _0xb81d4e['chats']['bulkPut'](_0x5a43bd),await _0x1519c8(_0x53045d(0x8fa),_0x53045d(0x1289))),document['getElementById']('sticker-binding-modal')[_0x53045d(0x9cd)][_0x53045d(0x8b6)](_0x53045d(0x45a));}function _0xfe3b04(_0x57a375){const _0x3b4020=_0x85c4bf;if(!_0x57a375||!_0x57a375[_0x3b4020(0x18a)]['stickerCategoryIds']||_0x57a375[_0x3b4020(0x18a)]['stickerCategoryIds'][_0x3b4020(0x990)]===0x0)return'';const _0xf6084e=_0x57a375[_0x3b4020(0x18a)]['stickerCategoryIds'];let _0x40fcc9=[];const _0x5c0ccd=new Set();_0xf6084e[_0x3b4020(0x12be)](_0x1bc0b6=>{const _0xa58ccf=_0x3b4020;let _0x2d6173;_0x1bc0b6===_0xa58ccf(0x331)?_0x2d6173=_0x505390[_0xa58ccf(0x407)]['filter'](_0x3027be=>!_0x3027be[_0xa58ccf(0x470)]):_0x2d6173=_0x505390['userStickers'][_0xa58ccf(0x85d)](_0x3d3243=>_0x3d3243[_0xa58ccf(0x470)]===_0x1bc0b6),_0x2d6173[_0xa58ccf(0x12be)](_0x4da28c=>{const _0x52577=_0xa58ccf;!_0x5c0ccd['has'](_0x4da28c[_0x52577(0x564)])&&(_0x40fcc9[_0x52577(0x1a0)](_0x4da28c),_0x5c0ccd[_0x52577(0x807)](_0x4da28c['name']));});});if(_0x40fcc9['length']===0x0)return'';const _0x49b8ab=_0x40fcc9[_0x3b4020(0x2e1)](_0x273c40=>'-\x20'+_0x273c40['name'])[_0x3b4020(0x35d)]('\x0a');return _0x3b4020(0x7e5)+_0x49b8ab+'\x0a';}function _0x46c840(_0x443c1a){const _0x298445=_0x85c4bf;if(!_0x443c1a||!_0x443c1a[_0x298445(0x9d7)])return'';let _0x1222eb=_0x298445(0x135b),_0x483804=![];return _0x443c1a[_0x298445(0x954)][_0x298445(0x12be)](_0x95ba66=>{const _0x4aca5a=_0x298445;if(_0x95ba66['id']===_0x4aca5a(0x4c5))return;const _0x4f5d35=_0x505390[_0x4aca5a(0x1027)][_0x95ba66['id']];if(_0x4f5d35&&_0x4f5d35[_0x4aca5a(0x18a)][_0x4aca5a(0x115b)]&&_0x4f5d35[_0x4aca5a(0x18a)][_0x4aca5a(0x115b)][_0x4aca5a(0x990)]>0x0){const _0x2507eb=_0x4f5d35[_0x4aca5a(0x18a)]['stickerCategoryIds'];let _0x53af1a=[];const _0x4cb7b2=new Set();_0x2507eb['forEach'](_0x58e4e9=>{const _0x2f7727=_0x4aca5a;let _0x484692;_0x58e4e9==='uncategorized'?_0x484692=_0x505390[_0x2f7727(0x407)][_0x2f7727(0x85d)](_0x3876e2=>!_0x3876e2[_0x2f7727(0x470)]):_0x484692=_0x505390['userStickers'][_0x2f7727(0x85d)](_0x283755=>_0x283755[_0x2f7727(0x470)]===_0x58e4e9),_0x484692['forEach'](_0x43119f=>{const _0x41c62b=_0x2f7727;!_0x4cb7b2[_0x41c62b(0x391)](_0x43119f['name'])&&(_0x53af1a['push'](_0x43119f),_0x4cb7b2[_0x41c62b(0x807)](_0x43119f[_0x41c62b(0x564)]));});}),_0x53af1a['length']>0x0&&(_0x483804=!![],_0x1222eb+=_0x4aca5a(0x25d)+_0x95ba66[_0x4aca5a(0xa54)]+_0x4aca5a(0x13c8)+_0x95ba66[_0x4aca5a(0xe2d)]+_0x4aca5a(0x996),_0x1222eb+=_0x53af1a[_0x4aca5a(0x2e1)](_0x24cf4f=>'-\x20'+_0x24cf4f[_0x4aca5a(0x564)])[_0x4aca5a(0x35d)]('\x0a'));}}),_0x483804?_0x1222eb:'';}async function _0x2221dc(){const _0x494435=_0x85c4bf;async function _0x28a22a(_0x18a58e){const _0x124f47=_0x6666;if(!_0x18a58e)return;try{const _0x5ab37b=await _0x18a58e[_0x124f47(0x56d)](),_0x5303a5=JSON[_0x124f47(0x94c)](_0x5ab37b);if(_0x5303a5[_0x124f47(0x858)]==='EPhoneWorldBookBackup')console[_0x124f47(0x90f)]('检测到\x20EPhone\x20备份文件，执行标准导入...'),await _0xae899(_0x5303a5);else{if(_0x5303a5['entries']&&typeof _0x5303a5[_0x124f47(0xef7)]===_0x124f47(0x65a))console['log'](_0x124f47(0x34b)),await _0x56bdc4(_0x5303a5,_0x18a58e[_0x124f47(0x564)]);else throw new Error(_0x124f47(0x10e7));}}catch(_0x473c88){console[_0x124f47(0xe3b)](_0x124f47(0xf16),_0x473c88),await _0x1519c8('导入失败',_0x124f47(0x894)+_0x473c88[_0x124f47(0x757)]);}}async function _0x56bdc4(_0x1153fa,_0x1d044b){const _0x20f618=_0x6666,_0x267158=_0x1d044b[_0x20f618(0x491)](/\.json$/i,''),_0x3aceed=await _0x9a2c09(_0x20f618(0xed7),'请为这本设定集命名：',_0x267158);if(!_0x3aceed||!_0x3aceed[_0x20f618(0x9c1)]()){alert(_0x20f618(0x57f));return;}const _0x45c25b=Object[_0x20f618(0x3d5)](_0x1153fa[_0x20f618(0xef7)])[_0x20f618(0x2e1)](_0x32b826=>{const _0x5f1752=_0x20f618;return{'keys':_0x32b826['key']||[],'comment':_0x32b826[_0x5f1752(0xd6c)]||'无备注','content':_0x32b826[_0x5f1752(0xac4)]||'','enabled':!_0x32b826[_0x5f1752(0xf3a)]};})[_0x20f618(0x85d)](_0x839949=>_0x839949[_0x20f618(0xac4)]);if(_0x45c25b[_0x20f618(0x990)]===0x0){alert(_0x20f618(0x9e4));return;}const _0x1b69fa={'id':_0x20f618(0xdb4)+Date[_0x20f618(0x12d6)](),'name':_0x3aceed[_0x20f618(0x9c1)](),'content':_0x45c25b,'categoryId':null};await _0xb81d4e['worldBooks'][_0x20f618(0x807)](_0x1b69fa),_0x505390[_0x20f618(0xd1b)][_0x20f618(0x1a0)](_0x1b69fa),await _0x30b101(),await _0x1519c8('导入成功！',_0x20f618(0xc02)+_0x3aceed+'》。');}async function _0x56f7a0(){const _0x4fe4b1=_0x6666;try{const _0x543917=await _0xb81d4e[_0x4fe4b1(0xd1b)][_0x4fe4b1(0x4ba)](),_0x448b1b=await _0xb81d4e['worldBookCategories']['toArray']();if(_0x543917[_0x4fe4b1(0x990)]===0x0&&_0x448b1b[_0x4fe4b1(0x990)]===0x0){alert(_0x4fe4b1(0x41e));return;}const _0x45d237={'type':_0x4fe4b1(0x30b),'version':0x1,'timestamp':Date[_0x4fe4b1(0x12d6)](),'books':_0x543917,'categories':_0x448b1b},_0x1ad1ca=new Blob([JSON['stringify'](_0x45d237,null,0x2)],{'type':'application/json'}),_0x569b08=URL['createObjectURL'](_0x1ad1ca),_0x27c5b1=document[_0x4fe4b1(0xbd5)]('a');_0x27c5b1['href']=_0x569b08,_0x27c5b1[_0x4fe4b1(0x11d0)]=_0x4fe4b1(0x440)+new Date()['toISOString']()[_0x4fe4b1(0x53e)]('T')[0x0]+'.json',_0x27c5b1[_0x4fe4b1(0xd2f)](),URL[_0x4fe4b1(0xed5)](_0x569b08),await _0x1519c8(_0x4fe4b1(0x553),_0x4fe4b1(0xbd6));}catch(_0x4ae8b8){console[_0x4fe4b1(0xe3b)](_0x4fe4b1(0x768),_0x4ae8b8),await _0x1519c8(_0x4fe4b1(0xa3d),'发生了一个错误:\x20'+_0x4ae8b8['message']);}}async function _0xae899(_0x547d86){const _0x8e8d54=_0x6666;try{if(_0x547d86[_0x8e8d54(0x858)]!==_0x8e8d54(0x30b)||!_0x547d86[_0x8e8d54(0xf57)])throw new Error(_0x8e8d54(0xcb0));const _0xd66c0=await _0x1a9e79(_0x8e8d54(0xa12),_0x8e8d54(0x750),{'confirmButtonClass':_0x8e8d54(0x95a),'confirmText':'确认覆盖'});if(!_0xd66c0)return;await _0xb81d4e[_0x8e8d54(0x4b9)]('rw',_0xb81d4e[_0x8e8d54(0xd1b)],_0xb81d4e[_0x8e8d54(0xfe9)],async()=>{const _0x5e9b1e=_0x8e8d54;await _0xb81d4e[_0x5e9b1e(0xd1b)]['clear'](),await _0xb81d4e[_0x5e9b1e(0xfe9)][_0x5e9b1e(0xf8f)](),Array[_0x5e9b1e(0x285)](_0x547d86['books'])&&await _0xb81d4e[_0x5e9b1e(0xd1b)][_0x5e9b1e(0x100e)](_0x547d86[_0x5e9b1e(0xf57)]),Array[_0x5e9b1e(0x285)](_0x547d86['categories'])&&await _0xb81d4e[_0x5e9b1e(0xfe9)][_0x5e9b1e(0x100e)](_0x547d86[_0x5e9b1e(0x4c4)]);}),_0x505390['worldBooks']=await _0xb81d4e[_0x8e8d54(0xd1b)][_0x8e8d54(0x4ba)](),await _0x30b101(),await _0x1519c8('导入成功',_0x8e8d54(0xd43));}catch(_0x1d3d44){console[_0x8e8d54(0xe3b)](_0x8e8d54(0xf16),_0x1d3d44),await _0x1519c8(_0x8e8d54(0xf28),'文件解析或应用失败:\x20'+_0x1d3d44[_0x8e8d54(0x757)]);}}const _0x37f191=localStorage['getItem'](_0x494435(0xdb2));if(_0x37f191){const _0x139cf0=(Date[_0x494435(0x12d6)]()-parseInt(_0x37f191))/(0x3e8*0x3c);_0x139cf0>0x5&&_0x3929d9(_0x139cf0);}_0x4941dd(),window['showScreen']=_0x731d5,window['openRenderingRulesScreen']=_0x1d5e77,window[_0x494435(0x5d8)]=_0xda4eb1,window['openCharacterSelector']=_0x2162bb,window[_0x494435(0xa23)]=_0x414946,window[_0x494435(0x2c4)]=_0x36a900,window['openCharWallet']=_0x366d5d,window['switchToCharHomeScreen']=_0x1ac68b,window[_0x494435(0xc6f)]=_0x2a76b9;const _0x2c0b4a=document[_0x494435(0xbd5)](_0x494435(0x6c8));_0x2c0b4a['id']=_0x494435(0x3a6),_0x2c0b4a[_0x494435(0x3de)]='<button\x20id=\x22delete-selected-stickers-btn\x22>删除\x20(0)</button>',document[_0x494435(0x479)]('sticker-panel')[_0x494435(0x9f4)](_0x2c0b4a);const _0x2225d3=document[_0x494435(0xbd5)](_0x494435(0x10dd));_0x2225d3['id']='global-custom-style',document[_0x494435(0x581)]['appendChild'](_0x2225d3),_0x50f1ba['panelEl']=document[_0x494435(0x479)](_0x494435(0x18b)),_0x50f1ba[_0x494435(0xad6)]=document[_0x494435(0x479)](_0x494435(0x5ce));const _0x216203=localStorage[_0x494435(0x28f)](_0x494435(0xf49))||_0x494435(0x5cc);_0x3d7866(_0x216203);const _0x1e75bb=document[_0x494435(0xbd5)](_0x494435(0x10dd));_0x1e75bb['id']=_0x494435(0xa86),document[_0x494435(0x581)]['appendChild'](_0x1e75bb);const _0x42de17=document[_0x494435(0xbd5)](_0x494435(0x10dd));_0x42de17['id']=_0x494435(0x487),document[_0x494435(0x581)][_0x494435(0x9f4)](_0x42de17),_0x4156f1('',_0x494435(0x47d),_0x494435(0xa86)),_0x4156f1('','#settings-preview-area',_0x494435(0x487)),window[_0x494435(0xae9)]=_0x1d5e77,window[_0x494435(0x1230)]=_0x731d5,window[_0x494435(0x104d)]=_0x1b7f69,window['renderApiSettingsProxy']=_0xedf874,window[_0x494435(0x691)]=_0x2884ff,window[_0x494435(0x11a2)]=_0x30b101,await _0x361f5e(),_0x2f6f58(),await _0x6aa3a4(),_0x5cefa5(_0x505390[_0x494435(0x888)][_0x494435(0x215)]);const _0x169393=parseInt(localStorage[_0x494435(0x28f)](_0x494435(0x1029)))||0x0;_0xa385c3(_0x169393);_0x505390['globalSettings']&&_0x505390['globalSettings'][_0x494435(0x69a)]&&_0x57f4d5(_0x505390[_0x494435(0x888)]['fontUrl']);_0x2ded70(),setInterval(_0x2ded70,0x3e8*0x1e),_0x49ef38(),_0x44f426(),_0x57595d(),_0x31ff84(),document[_0x494435(0x479)](_0x494435(0xdad))[_0x494435(0xa75)](_0x494435(0xd2f),_0x429e05=>{const _0x485a7a=_0x494435;_0x429e05[_0x485a7a(0xfa2)][_0x485a7a(0x9cd)]['contains']('rules-tab')&&_0x34eb35(_0x429e05[_0x485a7a(0xfa2)][_0x485a7a(0x13d4)]['categoryId']);}),document[_0x494435(0x479)](_0x494435(0x86a))['addEventListener'](_0x494435(0xd2f),()=>_0x29e040(null)),document[_0x494435(0x479)]('cancel-rule-editor-btn')['addEventListener'](_0x494435(0xd2f),()=>{const _0xe2a673=_0x494435;document[_0xe2a673(0x479)](_0xe2a673(0x119a))[_0xe2a673(0x9cd)]['remove'](_0xe2a673(0x45a));}),document[_0x494435(0x479)](_0x494435(0x2f8))[_0x494435(0xa75)](_0x494435(0xd2f),_0x50eb4e),document[_0x494435(0x479)]('pat-btn')[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x3ec040=_0x494435;if(_0x505390[_0x3ec040(0x233)]&&!_0x505390[_0x3ec040(0x1027)][_0x505390[_0x3ec040(0x233)]][_0x3ec040(0x9d7)]){const _0xf56e35=_0x505390[_0x3ec040(0x1027)][_0x505390[_0x3ec040(0x233)]];_0x5be2f7(_0xf56e35['id'],_0xf56e35['originalName']);}});let _0x1241af=null;function _0x3aceb9(_0x2f66f6){const _0x1cafbf=_0x494435;_0x1241af=_0x2f66f6;const _0x2f94c7=_0x505390[_0x1cafbf(0x1027)][_0x505390[_0x1cafbf(0x233)]],_0x38d18b=_0x2f94c7[_0x1cafbf(0xbca)][_0x1cafbf(0xc0d)](_0x55c0ce=>_0x55c0ce['id']===_0x2f66f6);if(!_0x38d18b)return;const _0x31384c=document[_0x1cafbf(0x479)](_0x1cafbf(0x1356));_0x31384c[_0x1cafbf(0x97b)]=_0x38d18b[_0x1cafbf(0xe4a)]?_0x1cafbf(0xec4):_0x1cafbf(0x5a3),document[_0x1cafbf(0x479)](_0x1cafbf(0x2db))[_0x1cafbf(0x9cd)][_0x1cafbf(0x807)]('visible');}async function _0x5289e3(){const _0x25b25f=_0x494435;if(!_0x1241af)return;const _0x4ef78f=_0x505390[_0x25b25f(0x1027)][_0x505390[_0x25b25f(0x233)]],_0x40e1ea=_0x4ef78f[_0x25b25f(0xbca)][_0x25b25f(0xc0d)](_0x5eb1c7=>_0x5eb1c7['id']===_0x1241af);_0x40e1ea&&(_0x40e1ea[_0x25b25f(0xe4a)]=!_0x40e1ea[_0x25b25f(0xe4a)],await _0xb81d4e[_0x25b25f(0x1027)][_0x25b25f(0x5d0)](_0x4ef78f),_0x1161f0()),document[_0x25b25f(0x479)](_0x25b25f(0x2db))[_0x25b25f(0x9cd)][_0x25b25f(0x8b6)]('visible');}async function _0x5a76c7(){const _0x4b3002=_0x494435;if(!_0x1241af)return;const _0x3d0142=await _0x1a9e79(_0x4b3002(0x587),_0x4b3002(0xb5d),{'confirmButtonClass':'btn-danger'});if(_0x3d0142){const _0x36f1b8=_0x505390[_0x4b3002(0x1027)][_0x505390[_0x4b3002(0x233)]];_0x36f1b8[_0x4b3002(0xbca)]=_0x36f1b8[_0x4b3002(0xbca)][_0x4b3002(0x85d)](_0x215b4d=>_0x215b4d['id']!==_0x1241af),await _0xb81d4e[_0x4b3002(0x1027)][_0x4b3002(0x5d0)](_0x36f1b8),_0x1161f0();}document[_0x4b3002(0x479)](_0x4b3002(0x2db))[_0x4b3002(0x9cd)]['remove'](_0x4b3002(0x45a));}document[_0x494435(0x479)](_0x494435(0x26f))[_0x494435(0xa75)](_0x494435(0xd2f),_0x3acce8),document[_0x494435(0x479)](_0x494435(0x11e1))[_0x494435(0xa75)](_0x494435(0xd2f),_0xfb0609=>{if(_0xfb0609['target']===_0x2f75ea)_0x3acce8();}),document[_0x494435(0x479)](_0x494435(0x1122))[_0x494435(0xa75)](_0x494435(0xd2f),async()=>{const _0x588d5a=_0x494435,_0x201717=await _0x5adb5e(_0x588d5a(0xeeb),[{'text':'智能导出\x20(推荐，速度快，内存占用小)','value':_0x588d5a(0x4ae)},{'text':_0x588d5a(0x8a6),'value':_0x588d5a(0xb02)}]);if(_0x201717==='stream')_0x100901();else _0x201717===_0x588d5a(0xb02)&&_0x364fad();}),document[_0x494435(0x479)](_0x494435(0x1303))[_0x494435(0xa75)](_0x494435(0xd2f),_0x260684),document[_0x494435(0x479)](_0x494435(0x1b2))[_0x494435(0xa75)](_0x494435(0x1150),_0x40862e=>{const _0x3c3934=_0x494435;document[_0x3c3934(0x479)](_0x3c3934(0x1118))[_0x3c3934(0x10dd)]['display']=_0x40862e[_0x3c3934(0xfa2)][_0x3c3934(0xf7b)]?_0x3c3934(0xee3):_0x3c3934(0xff8);}),document['getElementById'](_0x494435(0x24c))['addEventListener'](_0x494435(0xd2f),()=>document[_0x494435(0x479)]('import-data-input')[_0x494435(0xd2f)]()),document[_0x494435(0x479)](_0x494435(0xdb9))[_0x494435(0xa75)](_0x494435(0x1150),_0x8d573=>{const _0x78c4ad=_0x494435;document[_0x78c4ad(0x479)]('time-zone-group')[_0x78c4ad(0x10dd)]['display']=_0x8d573[_0x78c4ad(0xfa2)][_0x78c4ad(0xf7b)]?_0x78c4ad(0xee3):'none';}),document[_0x494435(0x479)]('import-data-input')[_0x494435(0xa75)](_0x494435(0x1150),_0x2f8de7=>_0x585cee(_0x2f8de7[_0x494435(0xfa2)][_0x494435(0xe63)][0x0])),document['getElementById'](_0x494435(0xade))[_0x494435(0xa75)]('change',_0x3ecc85),document[_0x494435(0x479)](_0x494435(0x598))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x584fbd=_0x494435;_0x2ca317={},_0x4156f1('',_0x584fbd(0x47d),_0x584fbd(0xa86)),_0x4156f1('',_0x584fbd(0x1c4),'preview-bubble-style'),_0x24d789(),_0x505390[_0x584fbd(0x233)]=null,_0x731d5(_0x584fbd(0xe34));}),document[_0x494435(0x479)](_0x494435(0x2a5))[_0x494435(0xa75)]('click',async()=>{const _0x11ced8=_0x494435,_0x41fb08=await _0x5adb5e('创建新聊天',[{'text':'手动创建角色','value':_0x11ced8(0xc32)},{'text':_0x11ced8(0x12a8),'value':_0x11ced8(0x10a6)}]);if(_0x41fb08===_0x11ced8(0xc32)){const _0x38b075=await _0x9a2c09(_0x11ced8(0x7ff),_0x11ced8(0x86d));if(!_0x38b075||!_0x38b075[_0x11ced8(0x9c1)]())return;const _0x528425=await _0x9a2c09('创建新聊天\x20(第2/2步)',_0x11ced8(0x1233));if(!_0x528425||!_0x528425[_0x11ced8(0x9c1)]())return;const _0x1d2326=_0x11ced8(0x8f9)+Date['now'](),_0x5a35c9={'id':_0x1d2326,'name':_0x38b075[_0x11ced8(0x9c1)](),'originalName':_0x528425['trim'](),'isGroup':![],'isPinned':![],'unreadCount':0x0,'relationship':{'status':_0x11ced8(0xc83),'blockedTimestamp':null,'applicationReason':''},'status':{'text':'在线','lastUpdate':Date['now'](),'isBusy':![]},'settings':{'aiPersona':'这是一个通过手动创建的角色。','myPersona':_0x11ced8(0x13ae),'myNickname':'我','maxMemory':0xa,'aiAvatar':_0x28c106,'myAvatar':_0x28c106,'background':'','theme':_0x11ced8(0x603),'fontSize':0xd,'customCss':'','linkedWorldBookIds':[],'aiAvatarLibrary':[],'myAvatarLibrary':[],'enableBackgroundActivity':!![],'actionCooldownMinutes':0xf,'enableTimePerception':!![],'isOfflineMode':![],'offlineMinLength':0x64,'offlineMaxLength':0x12c,'offlinePresetId':null,'timeZone':'Asia/Shanghai'},'history':[],'musicData':{'totalTime':0x0},'longTermMemory':[],'thoughtsHistory':[]};_0x505390['chats'][_0x1d2326]=_0x5a35c9,await _0xb81d4e[_0x11ced8(0x1027)][_0x11ced8(0x5d0)](_0x5a35c9),_0x1b7f69();}else _0x41fb08==='import_card'&&document[_0x11ced8(0x479)](_0x11ced8(0xade))['click']();}),document[_0x494435(0x479)](_0x494435(0x2eb))[_0x494435(0xa75)](_0x494435(0xd2f),_0x5d8903),document[_0x494435(0x479)]('transfer-cancel-btn')[_0x494435(0xa75)]('click',()=>document['getElementById'](_0x494435(0xcdb))[_0x494435(0x9cd)][_0x494435(0x8b6)](_0x494435(0x45a))),document[_0x494435(0x479)](_0x494435(0xe2e))[_0x494435(0xa75)](_0x494435(0xd2f),_0x1fe38a),document['getElementById'](_0x494435(0xc88))[_0x494435(0xa75)](_0x494435(0xd2f),_0xda4eb1),document[_0x494435(0x479)](_0x494435(0xd12))[_0x494435(0xa75)](_0x494435(0xd2f),()=>_0x15b5ff(!![])),document[_0x494435(0x479)](_0x494435(0x8f2))['addEventListener'](_0x494435(0xd2f),_0x4b3e91),document[_0x494435(0x479)]('music-play-pause-btn')[_0x494435(0xa75)]('click',_0x4adfbd),document['getElementById'](_0x494435(0x420))[_0x494435(0xa75)](_0x494435(0xd2f),_0x547a68),document[_0x494435(0x479)](_0x494435(0x8b3))[_0x494435(0xa75)](_0x494435(0xd2f),_0x4f5344),document['getElementById'](_0x494435(0xaef))['addEventListener'](_0x494435(0xd2f),_0x3aff44),document[_0x494435(0x479)](_0x494435(0x778))['addEventListener'](_0x494435(0xd2f),()=>{const _0x42e6a8=_0x494435;_0x582392(),document[_0x42e6a8(0x479)](_0x42e6a8(0x355))['classList'][_0x42e6a8(0x807)](_0x42e6a8(0x45a));}),document[_0x494435(0x479)](_0x494435(0x729))[_0x494435(0xa75)]('click',()=>document[_0x494435(0x479)](_0x494435(0x355))['classList']['remove']('visible')),document[_0x494435(0x479)]('add-song-url-btn')['addEventListener']('click',_0x77aab8),document[_0x494435(0x479)]('add-song-local-btn')[_0x494435(0xa75)](_0x494435(0xd2f),()=>document[_0x494435(0x479)](_0x494435(0x275))[_0x494435(0xd2f)]()),document['getElementById'](_0x494435(0x275))[_0x494435(0xa75)](_0x494435(0x1150),_0x3f19d9),document[_0x494435(0x479)](_0x494435(0x817))['addEventListener'](_0x494435(0xd2f),_0x57c3a4=>{const _0x294d0a=_0x494435,_0x181360=_0x57c3a4['target'],_0x28b5c5=parseInt(_0x181360['dataset'][_0x294d0a(0x959)]);if(isNaN(_0x28b5c5))return;if(_0x181360[_0x294d0a(0x9cd)][_0x294d0a(0x658)](_0x294d0a(0x5da)))_0x5744b4(_0x28b5c5);else{if(_0x181360[_0x294d0a(0x9cd)]['contains'](_0x294d0a(0x1098)))_0x4148d1(_0x28b5c5);else{if(_0x181360[_0x294d0a(0x9cd)][_0x294d0a(0x658)]('bg-btn'))_0xf689b(_0x28b5c5);else _0x181360[_0x294d0a(0x9cd)][_0x294d0a(0x658)]('delete-track-btn')&&_0x2a6ace(_0x28b5c5);}}}),_0x54d46a[_0x494435(0xa75)](_0x494435(0xdd8),()=>{const _0x1965a7=_0x494435;document['getElementById'](_0x1965a7(0x2bb))['classList'][_0x1965a7(0x8b6)](_0x1965a7(0xdf6)),_0x547a68();});const _0x4cc3e9=document[_0x494435(0x479)](_0x494435(0x706));document[_0x494435(0x479)]('send-btn')['addEventListener'](_0x494435(0xd2f),()=>{const _0x1c133b=_0x494435;_0x91c8a5();const _0x1ff6b1=_0x4cc3e9[_0x1c133b(0x4e0)][_0x1c133b(0x9c1)]();if(!_0x1ff6b1||!_0x505390['activeChatId'])return;const _0x32462f=_0x505390[_0x1c133b(0x1027)][_0x505390['activeChatId']],_0x420a40={'role':_0x1c133b(0x4c5),'content':_0x1ff6b1,'timestamp':Date[_0x1c133b(0x12d6)]()};_0x213dd3&&(_0x420a40[_0x1c133b(0xb67)]=_0x213dd3),_0x48f5ff(_0x420a40,_0x32462f),((async()=>{const _0x3ef4f5=_0x1c133b;_0x32462f[_0x3ef4f5(0x7d3)][_0x3ef4f5(0x1a0)](_0x420a40),await _0xb81d4e['chats'][_0x3ef4f5(0x5d0)](_0x32462f),_0x1b7f69();})()),_0x4cc3e9[_0x1c133b(0x4e0)]='',_0x4cc3e9[_0x1c133b(0x10dd)][_0x1c133b(0xe41)]=_0x1c133b(0x260),_0x4cc3e9['focus'](),_0x4388b3();}),document[_0x494435(0x479)](_0x494435(0x110d))['addEventListener'](_0x494435(0xd2f),_0x15e1a8),_0x4cc3e9[_0x494435(0xa75)](_0x494435(0xdb5),_0x5417f7=>{const _0x3836a3=_0x494435;_0x5417f7['key']==='Enter'&&!_0x5417f7[_0x3836a3(0x51c)]&&(_0x5417f7[_0x3836a3(0xd58)](),document[_0x3836a3(0x479)]('send-btn')[_0x3836a3(0xd2f)]());}),document[_0x494435(0x479)](_0x494435(0x657))[_0x494435(0xa75)]('change',async _0x1c501d=>{const _0x4fdf95=_0x494435,_0x1c2843=_0x1c501d[_0x4fdf95(0xfa2)][_0x4fdf95(0xe63)][0x0];if(_0x1c2843){const _0xb9a8c=await new Promise((_0x3137a4,_0x4a552e)=>{const _0x423d37=_0x4fdf95,_0x377d42=new FileReader();_0x377d42[_0x423d37(0x502)]=()=>_0x3137a4(_0x377d42['result']),_0x377d42[_0x423d37(0x1337)]=()=>_0x4a552e(_0x377d42['error']),_0x377d42[_0x423d37(0x83c)](_0x1c2843);});_0x1b68ba=_0xb9a8c,_0x2884ff();}}),document[_0x494435(0x479)](_0x494435(0xce9))[_0x494435(0xa75)]('click',async()=>{const _0x28c6f6=_0x494435;_0x1b68ba&&(_0x505390[_0x28c6f6(0x888)]['wallpaper']=_0x1b68ba),_0x505390['globalSettings'][_0x28c6f6(0x215)]=document[_0x28c6f6(0x479)](_0x28c6f6(0x901))[_0x28c6f6(0x4e0)]['trim'](),_0x505390[_0x28c6f6(0x888)]['notificationSoundUrl']=document[_0x28c6f6(0x479)]('notification-sound-url-input')['value'][_0x28c6f6(0x9c1)](),_0x505390[_0x28c6f6(0x888)][_0x28c6f6(0x5d9)]=document['getElementById'](_0x28c6f6(0xaad))['checked'],await _0xb81d4e['globalSettings'][_0x28c6f6(0x5d0)](_0x505390[_0x28c6f6(0x888)]),_0x49ef38(),_0x355635(),_0x1b68ba=null,_0x57595d(),_0x1711f7(),_0x5cefa5(_0x505390[_0x28c6f6(0x888)]['globalCss']),_0x2f6f58(),alert('外观设置已保存并应用！'),_0x731d5(_0x28c6f6(0x45f));});const _0x597671=document[_0x494435(0x479)](_0x494435(0x770));_0x597671[_0x494435(0xa75)]('scroll',()=>{const {scrollTop:_0x2f5433,scrollHeight:_0x4c193b,clientHeight:_0x40a6a8}=_0x597671;_0x4c193b-_0x2f5433-_0x40a6a8<_0x40a6a8&&(!_0xc050fd&&_0x598558());}),document[_0x494435(0x479)]('save-api-settings-btn')['addEventListener'](_0x494435(0xd2f),async()=>{const _0x47f58a=_0x494435;_0x505390[_0x47f58a(0x30c)][_0x47f58a(0x42c)]=document[_0x47f58a(0x479)](_0x47f58a(0x1060))[_0x47f58a(0x4e0)][_0x47f58a(0x9c1)](),_0x505390['apiConfig'][_0x47f58a(0x2d5)]=document[_0x47f58a(0x479)]('api-key')[_0x47f58a(0x4e0)][_0x47f58a(0x9c1)](),_0x505390[_0x47f58a(0x30c)][_0x47f58a(0xc42)]=document[_0x47f58a(0x479)](_0x47f58a(0x8d2))[_0x47f58a(0x4e0)],_0x505390['apiConfig'][_0x47f58a(0x7f1)]=document[_0x47f58a(0x479)](_0x47f58a(0xddc))[_0x47f58a(0x4e0)][_0x47f58a(0x9c1)](),_0x505390[_0x47f58a(0x30c)][_0x47f58a(0xd7c)]=document['getElementById']('minimax-api-key')[_0x47f58a(0x4e0)][_0x47f58a(0x9c1)](),_0x505390[_0x47f58a(0x30c)]['minimaxModel']=document[_0x47f58a(0x479)](_0x47f58a(0x227))[_0x47f58a(0x4e0)],_0x505390[_0x47f58a(0x30c)][_0x47f58a(0xe39)]=document[_0x47f58a(0x479)](_0x47f58a(0x10a2))[_0x47f58a(0x4e0)][_0x47f58a(0x9c1)](),_0x505390['apiConfig']['secondaryApiKey']=document[_0x47f58a(0x479)](_0x47f58a(0xdbc))[_0x47f58a(0x4e0)][_0x47f58a(0x9c1)](),_0x505390[_0x47f58a(0x30c)][_0x47f58a(0x11ea)]=document[_0x47f58a(0x479)](_0x47f58a(0x8b5))[_0x47f58a(0x4e0)],await _0xb81d4e[_0x47f58a(0x30c)][_0x47f58a(0x5d0)](_0x505390[_0x47f58a(0x30c)]);const _0x1df354=document[_0x47f58a(0x479)](_0x47f58a(0x829)),_0x38ec84=document[_0x47f58a(0x479)](_0x47f58a(0x968)),_0x290aeb=document[_0x47f58a(0x479)](_0x47f58a(0x6a4));_0x505390[_0x47f58a(0x888)]['enableBackgroundActivity']=_0x1df354[_0x47f58a(0xf7b)],_0x505390[_0x47f58a(0x888)][_0x47f58a(0xe65)]=parseInt(_0x38ec84[_0x47f58a(0x4e0)])||0x3c,_0x505390[_0x47f58a(0x888)][_0x47f58a(0x10b3)]=parseFloat(_0x290aeb[_0x47f58a(0x4e0)])||0x1,_0x505390[_0x47f58a(0x888)][_0x47f58a(0x105c)]=document[_0x47f58a(0x479)](_0x47f58a(0xbfc))['checked'],_0x505390[_0x47f58a(0x888)][_0x47f58a(0x13f8)]=parseInt(document[_0x47f58a(0x479)](_0x47f58a(0x52c))[_0x47f58a(0x4e0)])||0x32,_0x505390[_0x47f58a(0x888)][_0x47f58a(0x625)]=parseInt(document[_0x47f58a(0x479)]('chat-list-render-window-input')[_0x47f58a(0x4e0)])||0x1e,_0x505390[_0x47f58a(0x888)]['apiTemperature']=parseFloat(document[_0x47f58a(0x479)](_0x47f58a(0x1127))[_0x47f58a(0x4e0)]),await _0xb81d4e[_0x47f58a(0x888)]['put'](_0x505390[_0x47f58a(0x888)]),_0x9397c8(),_0x505390[_0x47f58a(0x888)]['enableBackgroundActivity']?(_0x351d83(),console['log'](_0x47f58a(0xf82)+_0x505390[_0x47f58a(0x888)][_0x47f58a(0xe65)]+'秒')):console[_0x47f58a(0x90f)](_0x47f58a(0xec7)),alert('所有API与后台设置已保存!');});const _0x23313d=document[_0x494435(0x479)](_0x494435(0x9f6));_0x23313d[_0x494435(0xa75)]('focus',_0x24beb2=>{const _0x435807=_0x494435;_0x24beb2['target'][_0x435807(0x912)]('type',_0x435807(0x56d));}),_0x23313d[_0x494435(0xa75)]('blur',_0x14d121=>{const _0x2db6d1=_0x494435;_0x14d121[_0x2db6d1(0xfa2)][_0x2db6d1(0x912)](_0x2db6d1(0x858),'password');});async function _0x1d71e6(_0x2ff152,_0x564f1b,_0x569003){const _0x160a2d=_0x494435,_0x5d1896=document['getElementById'](_0x2ff152)[_0x160a2d(0x4e0)]['trim'](),_0x4d53d3=document[_0x160a2d(0x479)](_0x564f1b)[_0x160a2d(0x4e0)][_0x160a2d(0x9c1)]();if(!_0x5d1896||!_0x4d53d3)return alert(_0x160a2d(0xfb4));try{let _0x2310b2=_0x5d1896===GEMINI_API_URL;const _0x168103=await fetch(_0x2310b2?GEMINI_API_URL+_0x160a2d(0x614)+getRandomValue(_0x4d53d3):_0x5d1896+_0x160a2d(0x77c),_0x2310b2?undefined:{'headers':{'Authorization':_0x160a2d(0xb27)+_0x4d53d3}});if(!_0x168103['ok'])throw new Error('无法获取模型列表');const _0xaa5308=await _0x168103[_0x160a2d(0xfdf)]();let _0x13dccb=_0x2310b2?_0xaa5308[_0x160a2d(0x13b7)][_0x160a2d(0x2e1)](_0x2502f5=>({'id':_0x2502f5[_0x160a2d(0x564)]['split']('/')[0x1]||_0x2502f5[_0x160a2d(0x564)]})):_0xaa5308[_0x160a2d(0x104c)];const _0x3e17d6=document['getElementById'](_0x569003);_0x3e17d6[_0x160a2d(0x3de)]='';const _0x538eb1=_0x569003===_0x160a2d(0x8d2)?_0x505390[_0x160a2d(0x30c)]['model']:_0x505390['apiConfig'][_0x160a2d(0x11ea)];_0x13dccb[_0x160a2d(0x12be)](_0x46a8c6=>{const _0x2b0772=_0x160a2d,_0x576376=document['createElement'](_0x2b0772(0x9a2));_0x576376[_0x2b0772(0x4e0)]=_0x46a8c6['id'],_0x576376[_0x2b0772(0x97b)]=_0x46a8c6['id'];if(_0x46a8c6['id']===_0x538eb1)_0x576376[_0x2b0772(0x10dc)]=!![];_0x3e17d6[_0x2b0772(0x9f4)](_0x576376);}),alert(_0x160a2d(0x6ca));}catch(_0x32df69){alert(_0x160a2d(0x399)+_0x32df69['message']);}}document[_0x494435(0x479)](_0x494435(0x85f))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x5cca1f=_0x494435;_0x1d71e6(_0x5cca1f(0x1060),_0x5cca1f(0x9f6),'model-select');}),document[_0x494435(0x479)](_0x494435(0x1361))['addEventListener'](_0x494435(0xd2f),()=>{const _0x669da4=_0x494435;_0x1d71e6(_0x669da4(0x10a2),'secondary-api-key',_0x669da4(0x8b5));}),document[_0x494435(0x479)](_0x494435(0xe52))[_0x494435(0xa75)](_0x494435(0xd2f),async()=>{const _0x460567=_0x494435,_0x398452=await _0x9a2c09(_0x460567(0x387),_0x460567(0xde0));if(_0x398452&&_0x398452[_0x460567(0x9c1)]()){const _0x51f035={'id':_0x460567(0xdb4)+Date[_0x460567(0x12d6)](),'name':_0x398452['trim'](),'content':''};await _0xb81d4e[_0x460567(0xd1b)][_0x460567(0x807)](_0x51f035),_0x505390['worldBooks'][_0x460567(0x1a0)](_0x51f035),_0x30b101(),_0x2e203c(_0x51f035['id']);}}),document[_0x494435(0x479)](_0x494435(0xa44))[_0x494435(0xa75)](_0x494435(0xd2f),async()=>{const _0x569265=_0x494435;if(!_0x1c457a)return;const _0x80c6da=_0x505390['worldBooks'][_0x569265(0xc0d)](_0x4fffcf=>_0x4fffcf['id']===_0x1c457a);if(!_0x80c6da)return;const _0x16aec3=document[_0x569265(0x479)](_0x569265(0x872))[_0x569265(0x4e0)]['trim']();if(!_0x16aec3){alert(_0x569265(0x384));return;}_0x80c6da[_0x569265(0x564)]=_0x16aec3;const _0x1f337d=document[_0x569265(0x479)](_0x569265(0x138c))[_0x569265(0x4e0)];_0x80c6da[_0x569265(0x470)]=_0x1f337d?parseInt(_0x1f337d):null;const _0x1fdc02=document['getElementById'](_0x569265(0xe40)),_0x4e5637=_0x1fdc02[_0x569265(0x99e)](_0x569265(0x4e3)),_0xe0fafe=[];_0x4e5637[_0x569265(0x12be)](_0x3b9e89=>{const _0x4a6d0d=_0x569265,_0xd922fe=_0x3b9e89['querySelector'](_0x4a6d0d(0x1247))[_0x4a6d0d(0x4e0)]['trim'](),_0x35391c=_0x3b9e89[_0x4a6d0d(0x8bc)](_0x4a6d0d(0x389))[_0x4a6d0d(0x4e0)][_0x4a6d0d(0x9c1)](),_0x1de03a=_0x3b9e89[_0x4a6d0d(0x8bc)]('.entry-enabled-switch')['checked'];_0x35391c&&_0xe0fafe['push']({'comment':_0x3b9e89[_0x4a6d0d(0x8bc)](_0x4a6d0d(0x6c7))[_0x4a6d0d(0x4e0)]['trim'](),'keys':_0xd922fe?_0xd922fe[_0x4a6d0d(0x53e)](',')['map'](_0x3bc941=>_0x3bc941[_0x4a6d0d(0x9c1)]())[_0x4a6d0d(0x85d)](_0x2c683b=>_0x2c683b):[],'content':_0x35391c,'enabled':_0x1de03a});}),_0x80c6da[_0x569265(0xac4)]=_0xe0fafe,await _0xb81d4e['worldBooks'][_0x569265(0x5d0)](_0x80c6da),document[_0x569265(0x479)]('world-book-editor-title')[_0x569265(0x97b)]=_0x16aec3,_0x1c457a=null,_0x731d5(_0x569265(0x4f6)),await _0x30b101();}),document[_0x494435(0x479)](_0x494435(0x659))['addEventListener'](_0x494435(0xd2f),async _0x31041b=>{const _0x31e8e4=_0x494435,_0x222e46=_0x31041b[_0x31e8e4(0xfa2)]['closest'](_0x31e8e4(0xc87));if(_0x222e46){const _0x389a36=_0x505390[_0x31e8e4(0x1027)][_0x505390['activeChatId']];if(!_0x389a36)return;_0x46887d(_0x222e46);const _0xaa3a0d=_0x222e46[_0x31e8e4(0x869)](_0x31e8e4(0xc28)),_0x3d211d=_0xaa3a0d?_0xaa3a0d['querySelector'](_0x31e8e4(0x128c)):null;if(_0x222e46[_0x31e8e4(0x13d4)][_0x31e8e4(0xf67)]&&_0x3d211d&&_0x3d211d[_0x31e8e4(0x10dd)][_0x31e8e4(0x678)]===_0x31e8e4(0xee3)){if(_0x389a36['isGroup']){console['log']('这是一条群聊语音消息，已禁止发起TTS请求。');return;}if(_0x389a36['settings']['enableTts']===![]){console[_0x31e8e4(0x90f)]('“'+_0x389a36[_0x31e8e4(0x564)]+_0x31e8e4(0x43b));return;}_0x31c356(_0x222e46);}return;}const _0x2de8c3=_0x31041b['target'][_0x31e8e4(0x869)](_0x31e8e4(0x3e7));if(_0x2de8c3){const _0x375597=_0x2de8c3[_0x31e8e4(0x869)](_0x31e8e4(0xc28));if(_0x375597){const _0x37c24d=parseInt(_0x375597['dataset'][_0x31e8e4(0x12a2)]);if(!isNaN(_0x37c24d)){_0x9bfc5b(_0x37c24d);return;}}}const _0x13008d=_0x31041b[_0x31e8e4(0xfa2)]['closest'](_0x31e8e4(0x6b5));if(_0x13008d){const _0x5118a3=_0x13008d['closest'](_0x31e8e4(0xc28));if(_0x5118a3){const _0xa6d907=parseInt(_0x5118a3[_0x31e8e4(0x13d4)][_0x31e8e4(0x12a2)]),_0x5e966f=_0x13008d[_0x31e8e4(0x13d4)][_0x31e8e4(0x560)];if(!isNaN(_0xa6d907)&&_0x5e966f){await _0x26466b(_0xa6d907,_0x5e966f);return;}}}const _0x1647e4=_0x31041b[_0x31e8e4(0xfa2)]['closest'](_0x31e8e4(0x78f));if(_0x1647e4){const _0x5f0583=parseInt(_0x1647e4[_0x31e8e4(0x13d4)][_0x31e8e4(0x403)]);if(!isNaN(_0x5f0583)){const _0x12e720=await _0xb81d4e[_0x31e8e4(0xcce)]['get'](_0x5f0583);if(_0x12e720){let _0x17bb84='';const _0x3a5fb7=_0x12e720[_0x31e8e4(0x981)]===_0x31e8e4(0x4c5)?_0x505390[_0x31e8e4(0x1190)][_0x31e8e4(0x904)]:_0x505390[_0x31e8e4(0x1027)][_0x12e720[_0x31e8e4(0x981)]]?.['name']||_0x31e8e4(0x64f);if(_0x12e720[_0x31e8e4(0x858)]==='shuoshuo')_0x17bb84=_0x12e720[_0x31e8e4(0xac4)];else{_0x17bb84=_0x12e720[_0x31e8e4(0x105a)]||'';if(_0x12e720['imageUrl'])_0x17bb84+=_0x31e8e4(0xd11);if(_0x12e720[_0x31e8e4(0x112d)])_0x17bb84+=_0x31e8e4(0x7ad)+_0x12e720[_0x31e8e4(0x112d)]+']';}_0x1519c8(_0x31e8e4(0x10d3)+_0x3a5fb7+_0x31e8e4(0xe95),_0x17bb84[_0x31e8e4(0x491)](/\n/g,'<br>'));}else _0x1519c8('提示','这条动态的原始数据已被彻底清除。');}return;}const _0x4f5ee0=_0x31041b['target'][_0x31e8e4(0x869)](_0x31e8e4(0xe18));if(_0x4f5ee0){const _0xd3cece=_0x4f5ee0[_0x31e8e4(0x13d4)]['description'];if(_0xd3cece)_0x1519c8(_0x31e8e4(0x812),_0xd3cece);return;}const _0x416917=_0x31041b[_0x31e8e4(0xfa2)][_0x31e8e4(0x869)](_0x31e8e4(0x49f));if(_0x416917&&_0x416917['dataset'][_0x31e8e4(0xcc2)]){const _0x2f5c1d=parseInt(_0x416917[_0x31e8e4(0x13d4)]['originalTimestamp']);!isNaN(_0x2f5c1d)&&_0xd69305(_0x2f5c1d);}const _0x5219ac=_0x31041b[_0x31e8e4(0xfa2)]['closest'](_0x31e8e4(0x1160));if(_0x5219ac){const _0x127d36=_0x5219ac['closest'](_0x31e8e4(0xc28));_0x127d36&&_0x17b674(parseInt(_0x127d36['dataset'][_0x31e8e4(0x12a2)]));}const _0x4794c2=_0x31041b[_0x31e8e4(0xfa2)]['closest'](_0x31e8e4(0xb88));if(_0x4794c2){const _0x456fae=_0x4794c2[_0x31e8e4(0x869)](_0x31e8e4(0xc28));if(_0x456fae&&_0x456fae[_0x31e8e4(0x13d4)]['timestamp']){const _0x3cb1b3=parseInt(_0x456fae[_0x31e8e4(0x13d4)][_0x31e8e4(0x12a2)]);_0x3bc284(_0x3cb1b3);}}const _0x2c81f5=_0x31041b[_0x31e8e4(0xfa2)][_0x31e8e4(0x869)](_0x31e8e4(0x76b));if(_0x2c81f5){const _0x110154=parseInt(_0x2c81f5[_0x31e8e4(0x13d4)]['pollTimestamp']);if(isNaN(_0x110154))return;const _0x2cdf3d=_0x31041b[_0x31e8e4(0xfa2)][_0x31e8e4(0x869)](_0x31e8e4(0x2cd));if(_0x2cdf3d&&!_0x2c81f5[_0x31e8e4(0x9cd)][_0x31e8e4(0x658)]('closed')){_0x398b9c(_0x110154,_0x2cdf3d[_0x31e8e4(0x13d4)][_0x31e8e4(0x9a2)]);return;}const _0x291e43=_0x31041b[_0x31e8e4(0xfa2)][_0x31e8e4(0x869)](_0x31e8e4(0x973));if(_0x291e43){_0x2c81f5[_0x31e8e4(0x9cd)][_0x31e8e4(0x658)](_0x31e8e4(0x544))?_0x17870e(_0x110154):_0x509d06(_0x110154);return;}_0x2c81f5[_0x31e8e4(0x9cd)][_0x31e8e4(0x658)](_0x31e8e4(0x544))&&_0x17870e(_0x110154);}const _0x57aeaa=_0x31041b[_0x31e8e4(0xfa2)][_0x31e8e4(0x869)](_0x31e8e4(0xe31));if(_0x57aeaa){const _0x511efc=_0x505390[_0x31e8e4(0x1027)][_0x505390[_0x31e8e4(0x233)]],_0x5bf661=_0x57aeaa[_0x31e8e4(0x869)]('.message-wrapper');if(_0x511efc&&_0x5bf661){const _0x282d67=parseInt(_0x5bf661[_0x31e8e4(0x13d4)][_0x31e8e4(0x12a2)]),_0x4e9658=_0x511efc[_0x31e8e4(0x7d3)][_0x31e8e4(0xc0d)](_0x202493=>_0x202493['timestamp']===_0x282d67);if(_0x4e9658&&_0x4e9658[_0x31e8e4(0x439)]){let _0x2e731b='';const _0x3d1bf9=_0x4e9658[_0x31e8e4(0x439)];_0x3d1bf9[_0x31e8e4(0x4fa)]===_0x31e8e4(0x56d)?_0x2e731b=_0x31e8e4(0xcaf)+_0x3d1bf9[_0x31e8e4(0x982)]+'\x22':_0x2e731b=_0x31e8e4(0xac3)+_0x3d1bf9[_0x31e8e4(0x4fa)]+_0x31e8e4(0x13f4),_0x1519c8(_0x31e8e4(0x1344),_0x2e731b);}}}const _0xa3717a=_0x31041b[_0x31e8e4(0xfa2)][_0x31e8e4(0x869)](_0x31e8e4(0xf44));if(_0xa3717a&&_0xa3717a['closest'](_0x31e8e4(0x859))){const _0xb61d9b=parseInt(_0xa3717a[_0x31e8e4(0x13d4)][_0x31e8e4(0x12a2)]);_0x26080c(_0xb61d9b);}const _0x4ef8d7=_0x31041b[_0x31e8e4(0xfa2)][_0x31e8e4(0x869)](_0x31e8e4(0xc28));if(_0x4ef8d7&&_0x4ef8d7[_0x31e8e4(0x9cd)][_0x31e8e4(0x658)]('ai')&&_0x4ef8d7[_0x31e8e4(0x9cd)][_0x31e8e4(0x658)](_0x31e8e4(0x12b6))&&_0x4ef8d7[_0x31e8e4(0x13d4)][_0x31e8e4(0x93c)]===_0x31e8e4(0xa25)){const _0x158a85=parseInt(_0x4ef8d7[_0x31e8e4(0x13d4)][_0x31e8e4(0x12a2)]);!isNaN(_0x158a85)&&_0x196d69(_0x158a85);}});const _0x46cb16=document[_0x494435(0x479)](_0x494435(0xedb)),_0x46baec=document['querySelector']('.custom-multiselect\x20.select-box'),_0x41d677=document[_0x494435(0x479)](_0x494435(0x4b3));function _0x2113ee(){const _0x426a47=_0x494435,_0xec355b=_0x41d677[_0x426a47(0x99e)](_0x426a47(0x375)),_0x377894=document[_0x426a47(0x8bc)](_0x426a47(0x4d6));if(_0xec355b[_0x426a47(0x990)]===0x0)_0x377894[_0x426a47(0x97b)]='--\x20点击选择\x20--';else{if(_0xec355b[_0x426a47(0x990)]>0x2)_0x377894[_0x426a47(0x97b)]=_0x426a47(0x3c5)+_0xec355b['length']+_0x426a47(0x1278);else{const _0x3dcec9=Array[_0x426a47(0x22f)](_0xec355b)[_0x426a47(0x2e1)](_0x132ebd=>{const _0x21a7fd=_0x426a47;return _0x132ebd[_0x21a7fd(0x8be)][_0x21a7fd(0x97b)][_0x21a7fd(0x9c1)]();});_0x377894[_0x426a47(0x97b)]=_0x3dcec9['join'](',\x20');}}}_0x46baec['addEventListener']('click',_0x2619a1=>{const _0x1d970b=_0x494435;_0x2619a1[_0x1d970b(0x748)](),_0x41d677['classList']['toggle'](_0x1d970b(0x45a)),_0x46baec[_0x1d970b(0x9cd)][_0x1d970b(0x2bf)](_0x1d970b(0x18d));}),document[_0x494435(0x479)]('world-book-checkboxes-container')['addEventListener'](_0x494435(0x1150),_0x2113ee),window[_0x494435(0xa75)](_0x494435(0xd2f),_0x280e8f=>{const _0x3ad0cd=_0x494435;!document[_0x3ad0cd(0x8bc)](_0x3ad0cd(0x961))['contains'](_0x280e8f['target'])&&(_0x41d677[_0x3ad0cd(0x9cd)][_0x3ad0cd(0x8b6)]('visible'),_0x46baec[_0x3ad0cd(0x9cd)]['remove'](_0x3ad0cd(0x18d)));}),document['getElementById'](_0x494435(0x2a4))['addEventListener'](_0x494435(0xd2f),async()=>{const _0x1f015d=_0x494435;_0x60d931();if(!_0x505390['activeChatId'])return;const _0x23187d=_0x505390[_0x1f015d(0x1027)][_0x505390['activeChatId']],_0x23764b=_0x23187d['isGroup'],_0xe414f3=document[_0x1f015d(0x479)](_0x1f015d(0x128d));!_0x23764b&&_0x23187d[_0x1f015d(0x18a)][_0x1f015d(0x80d)]&&_0x23187d['settings'][_0x1f015d(0x80d)]['length']>0x0?_0xe414f3[_0x1f015d(0x10dd)]['display']='block':_0xe414f3[_0x1f015d(0x10dd)]['display']=_0x1f015d(0xff8);document[_0x1f015d(0x479)](_0x1f015d(0x352))[_0x1f015d(0x10dd)][_0x1f015d(0x678)]=_0x1f015d(0xee3),document['getElementById'](_0x1f015d(0xd32))[_0x1f015d(0x10dd)]['display']=_0x1f015d(0xee3),document[_0x1f015d(0x479)](_0x1f015d(0x11e2))[_0x1f015d(0x10dd)][_0x1f015d(0x678)]=_0x1f015d(0xee3),document['getElementById'](_0x1f015d(0xbbe))['style'][_0x1f015d(0x678)]=_0x23764b?_0x1f015d(0xee3):_0x1f015d(0xff8),document[_0x1f015d(0x479)]('my-nickname-group')[_0x1f015d(0x10dd)][_0x1f015d(0x678)]=_0x23764b?'none':_0x1f015d(0xee3),document[_0x1f015d(0x479)](_0x1f015d(0xe26))[_0x1f015d(0x10dd)][_0x1f015d(0x678)]=_0x23764b?_0x1f015d(0xee3):_0x1f015d(0xff8),document[_0x1f015d(0x479)](_0x1f015d(0x13c9))['style'][_0x1f015d(0x678)]=_0x23764b?'block':_0x1f015d(0xff8),document[_0x1f015d(0x479)](_0x1f015d(0xa67))[_0x1f015d(0x10dd)]['display']=_0x23764b?_0x1f015d(0xff8):'block',document[_0x1f015d(0x479)]('ai-avatar-group')['style'][_0x1f015d(0x678)]=_0x23764b?_0x1f015d(0xff8):_0x1f015d(0xee3),document[_0x1f015d(0x479)]('assign-group-section')[_0x1f015d(0x10dd)]['display']=_0x23764b?'none':_0x1f015d(0xee3),document['getElementById'](_0x1f015d(0x511))['style'][_0x1f015d(0x678)]=_0x23764b?_0x1f015d(0xff8):'block',document[_0x1f015d(0x479)](_0x1f015d(0xf65))[_0x1f015d(0x10dd)][_0x1f015d(0x678)]=_0x23764b?_0x1f015d(0xff8):_0x1f015d(0xee3),document[_0x1f015d(0x479)](_0x1f015d(0xbbc))[_0x1f015d(0x10dd)]['display']=_0x23764b?_0x1f015d(0xff8):_0x1f015d(0xee3),document[_0x1f015d(0x479)](_0x1f015d(0xc62))[_0x1f015d(0x10dd)][_0x1f015d(0x678)]=_0x23764b?'none':_0x1f015d(0xee3),document['getElementById'](_0x1f015d(0x2ab))[_0x1f015d(0x10dd)][_0x1f015d(0x678)]=_0x23764b?'none':_0x1f015d(0xee3),document[_0x1f015d(0x479)]('group-cooldown-group')[_0x1f015d(0x10dd)][_0x1f015d(0x678)]=_0x23764b?_0x1f015d(0xee3):_0x1f015d(0xff8),document[_0x1f015d(0x479)]('chat-name-input')[_0x1f015d(0x4e0)]=_0x23187d[_0x1f015d(0x564)],document[_0x1f015d(0x479)](_0x1f015d(0x269))[_0x1f015d(0x4e0)]=_0x23187d[_0x1f015d(0x18a)][_0x1f015d(0x12d7)],document[_0x1f015d(0x479)](_0x1f015d(0xdfe))[_0x1f015d(0xa9c)]=_0x23187d[_0x1f015d(0x18a)][_0x1f015d(0xe28)]||(_0x23764b?_0x2361d7:_0x28c106),document[_0x1f015d(0x479)](_0x1f015d(0xdd7))[_0x1f015d(0x4e0)]=_0x23187d[_0x1f015d(0x18a)][_0x1f015d(0x2c6)],document['getElementById'](_0x1f015d(0x454))[_0x1f015d(0x4e0)]=_0x23187d[_0x1f015d(0x18a)][_0x1f015d(0xefc)]||0xa;const _0x973fde=document[_0x1f015d(0x479)]('bg-preview'),_0x1df8a0=document[_0x1f015d(0x479)](_0x1f015d(0x460));_0x23187d[_0x1f015d(0x18a)][_0x1f015d(0x7fb)]?(_0x973fde[_0x1f015d(0xa9c)]=_0x23187d[_0x1f015d(0x18a)][_0x1f015d(0x7fb)],_0x973fde[_0x1f015d(0x10dd)]['display']=_0x1f015d(0xee3),_0x1df8a0[_0x1f015d(0x10dd)][_0x1f015d(0x678)]=_0x1f015d(0x25f)):(_0x973fde[_0x1f015d(0x10dd)][_0x1f015d(0x678)]='none',_0x1df8a0[_0x1f015d(0x10dd)][_0x1f015d(0x678)]=_0x1f015d(0xff8));document[_0x1f015d(0x479)](_0x1f015d(0x1055))[_0x1f015d(0x10dd)]['display']=_0x23764b?_0x1f015d(0xff8):_0x1f015d(0xee3),document[_0x1f015d(0x479)](_0x1f015d(0x1194))[_0x1f015d(0x10dd)][_0x1f015d(0x678)]=_0x23764b?_0x1f015d(0xff8):'block',document[_0x1f015d(0x479)](_0x1f015d(0x8fe))['style'][_0x1f015d(0x678)]=_0x23764b?_0x1f015d(0xee3):_0x1f015d(0xff8);const _0x17ff42=document['getElementById'](_0x1f015d(0xdb9)),_0x4d9faf=document[_0x1f015d(0x479)](_0x1f015d(0x1156));_0x17ff42[_0x1f015d(0xf7b)]=_0x23187d[_0x1f015d(0x18a)][_0x1f015d(0xeb0)],_0x4d9faf[_0x1f015d(0x10dd)][_0x1f015d(0x678)]=_0x17ff42[_0x1f015d(0xf7b)]?_0x1f015d(0xee3):_0x1f015d(0xff8);const _0x6afd1d=document['getElementById'](_0x1f015d(0xda7)),_0x4a3c0a=Intl[_0x1f015d(0xd3a)](_0x1f015d(0xac0));_0x6afd1d[_0x1f015d(0x3de)]='',_0x4a3c0a[_0x1f015d(0x12be)](_0x582f88=>{const _0x9da53c=_0x1f015d,_0x471a97=document[_0x9da53c(0xbd5)](_0x9da53c(0x9a2));_0x471a97[_0x9da53c(0x4e0)]=_0x582f88,_0x471a97['textContent']=_0x582f88,_0x6afd1d[_0x9da53c(0x9f4)](_0x471a97);}),_0x6afd1d[_0x1f015d(0x4e0)]=_0x23187d['settings']['timeZone']||_0x1f015d(0x20e);if(_0x23764b)document['getElementById'](_0x1f015d(0xcad))[_0x1f015d(0xf7b)]=_0x23187d[_0x1f015d(0x18a)]['enableBackgroundActivity'],document[_0x1f015d(0x479)](_0x1f015d(0x136e))[_0x1f015d(0x4e0)]=_0x23187d[_0x1f015d(0x18a)][_0x1f015d(0xf58)]||'',document['getElementById']('group-avatar-preview')[_0x1f015d(0xa9c)]=_0x23187d['settings'][_0x1f015d(0x67c)]||_0x3b1eb7,document[_0x1f015d(0x479)](_0x1f015d(0xdd3))[_0x1f015d(0x4e0)]=_0x23187d[_0x1f015d(0x18a)][_0x1f015d(0x1097)]||0xa,document[_0x1f015d(0x479)]('single-char-background-activity-group')[_0x1f015d(0x10dd)][_0x1f015d(0x678)]=_0x1f015d(0xff8),_0x5645b9(_0x23187d[_0x1f015d(0x954)]);else{document[_0x1f015d(0x479)](_0x1f015d(0x1194))['style'][_0x1f015d(0x678)]='block',document[_0x1f015d(0x479)](_0x1f015d(0x7d6))[_0x1f015d(0xf7b)]=_0x23187d['settings'][_0x1f015d(0xc00)],document[_0x1f015d(0x479)](_0x1f015d(0x3da))[_0x1f015d(0xf7b)]=_0x23187d['settings']['injectLatestThought'];const _0x14618a=document[_0x1f015d(0x479)](_0x1f015d(0x1b2)),_0xbc9d97=document[_0x1f015d(0x479)]('offline-mode-options'),_0x12f0fd=document[_0x1f015d(0x479)](_0x1f015d(0x277)),_0x5f3d74=document['getElementById']('offline-max-length-input');_0x14618a[_0x1f015d(0xf7b)]=_0x23187d[_0x1f015d(0x18a)][_0x1f015d(0x328)]||![],_0xbc9d97['style'][_0x1f015d(0x678)]=_0x14618a[_0x1f015d(0xf7b)]?_0x1f015d(0xee3):_0x1f015d(0xff8),_0x12f0fd['value']=_0x23187d[_0x1f015d(0x18a)][_0x1f015d(0x780)]||0x64,_0x5f3d74[_0x1f015d(0x4e0)]=_0x23187d['settings'][_0x1f015d(0x1084)]||0x12c,await _0x3f7fde(_0x23187d),document[_0x1f015d(0x479)](_0x1f015d(0xfb1))[_0x1f015d(0x4e0)]=_0x23187d[_0x1f015d(0xe2d)],document[_0x1f015d(0x479)](_0x1f015d(0x236))['value']=_0x23187d[_0x1f015d(0x18a)][_0x1f015d(0x1180)]||'',document[_0x1f015d(0x479)](_0x1f015d(0x7be))[_0x1f015d(0xf7b)]=_0x23187d['settings']['enableTts']!==![],document[_0x1f015d(0x479)](_0x1f015d(0x1139))[_0x1f015d(0x4e0)]=_0x23187d[_0x1f015d(0x18a)]['aiPersona'],document[_0x1f015d(0x479)]('ai-avatar-preview')[_0x1f015d(0xa9c)]=_0x23187d[_0x1f015d(0x18a)]['aiAvatar']||_0x28c106,document[_0x1f015d(0x479)](_0x1f015d(0x1159))[_0x1f015d(0x4e0)]=_0x23187d[_0x1f015d(0x18a)][_0x1f015d(0xf58)]||'我',document[_0x1f015d(0x479)]('ai-action-cooldown-input')[_0x1f015d(0x4e0)]=_0x23187d[_0x1f015d(0x18a)]['actionCooldownMinutes']||0xa;const _0x3ae88d=document[_0x1f015d(0x479)](_0x1f015d(0x6a7));_0x3ae88d[_0x1f015d(0x3de)]=_0x1f015d(0xbd2);const _0x40a10f=await _0xb81d4e[_0x1f015d(0xbce)][_0x1f015d(0x4ba)]();_0x40a10f[_0x1f015d(0x12be)](_0x25ba3e=>{const _0x52311e=_0x1f015d,_0x5053b9=document[_0x52311e(0xbd5)](_0x52311e(0x9a2));_0x5053b9['value']=_0x25ba3e['id'],_0x5053b9[_0x52311e(0x97b)]=_0x25ba3e['name'];if(_0x23187d[_0x52311e(0x194)]===_0x25ba3e['id'])_0x5053b9[_0x52311e(0x10dc)]=!![];_0x3ae88d['appendChild'](_0x5053b9);});const _0x13b73c=_0x23187d['settings'][_0x1f015d(0x1211)]||{'vertical':_0x1f015d(0xb8f),'horizontal':'center','offset':0xa};document[_0x1f015d(0x479)](_0x1f015d(0x7f3))[_0x1f015d(0x4e0)]=_0x13b73c[_0x1f015d(0x22e)],document[_0x1f015d(0x479)](_0x1f015d(0x120e))[_0x1f015d(0x4e0)]=_0x13b73c['horizontal'],document[_0x1f015d(0x479)](_0x1f015d(0x2df))[_0x1f015d(0x4e0)]=_0x13b73c[_0x1f015d(0x7a1)];}const _0x98920f=document[_0x1f015d(0x479)](_0x1f015d(0x4b3));_0x98920f[_0x1f015d(0x3de)]='';const [_0x324f19,_0x2814a1]=await Promise[_0x1f015d(0xf78)]([_0xb81d4e[_0x1f015d(0xfe9)]['toArray'](),_0xb81d4e[_0x1f015d(0xd1b)][_0x1f015d(0x4ba)]()]),_0x430119=new Set(_0x23187d[_0x1f015d(0x18a)][_0x1f015d(0x13da)]||[]);if(_0x2814a1[_0x1f015d(0x990)]===0x0)_0x98920f[_0x1f015d(0x3de)]=_0x1f015d(0xf90);else{_0x324f19[_0x1f015d(0x12be)](_0x305c23=>{const _0x347ef6=_0x1f015d,_0x3823a5=_0x2814a1[_0x347ef6(0x85d)](_0x2706b0=>_0x2706b0['categoryId']===_0x305c23['id']);if(_0x3823a5[_0x347ef6(0x990)]>0x0){const _0x98b19c=document[_0x347ef6(0xbd5)]('h4');_0x98b19c[_0x347ef6(0x97b)]=_0x305c23[_0x347ef6(0x564)],_0x98b19c['style'][_0x347ef6(0x506)]=_0x347ef6(0xab1),_0x98920f[_0x347ef6(0x9f4)](_0x98b19c),_0x3823a5[_0x347ef6(0x12be)](_0x4e7a62=>{const _0x26f119=_0x347ef6,_0x348775=_0x430119[_0x26f119(0x391)](_0x4e7a62['id']),_0x304f15=document['createElement']('label');_0x304f15[_0x26f119(0x3de)]='<input\x20type=\x22checkbox\x22\x20value=\x22book_'+_0x4e7a62['id']+'\x22\x20'+(_0x348775?_0x26f119(0xf7b):'')+'>\x20'+_0x4e7a62[_0x26f119(0x564)],_0x98920f[_0x26f119(0x9f4)](_0x304f15);});}});const _0x1a306b=_0x2814a1[_0x1f015d(0x85d)](_0x2923c3=>!_0x2923c3[_0x1f015d(0x470)]);if(_0x1a306b[_0x1f015d(0x990)]>0x0){const _0x4073ee=document[_0x1f015d(0xbd5)]('h4');_0x4073ee[_0x1f015d(0x97b)]=_0x1f015d(0xcee),_0x4073ee[_0x1f015d(0x10dd)]['cssText']=_0x1f015d(0x726),_0x98920f[_0x1f015d(0x9f4)](_0x4073ee),_0x1a306b[_0x1f015d(0x12be)](_0x9501ab=>{const _0x2fce96=_0x1f015d,_0x5c55ce=_0x430119[_0x2fce96(0x391)](_0x9501ab['id']),_0x47b4ba=document[_0x2fce96(0xbd5)](_0x2fce96(0xfac));_0x47b4ba[_0x2fce96(0x3de)]=_0x2fce96(0xa02)+_0x9501ab['id']+'\x22\x20'+(_0x5c55ce?_0x2fce96(0xf7b):'')+'>\x20'+_0x9501ab[_0x2fce96(0x564)],_0x98920f[_0x2fce96(0x9f4)](_0x47b4ba);});}}_0x2113ee();const _0xaa4c0c=document['getElementById'](_0x1f015d(0xac7)),_0x486e9a=document[_0x1f015d(0x479)](_0x1f015d(0xce0)),_0x3cac14=document[_0x1f015d(0x479)](_0x1f015d(0x88a)),_0x567835=_0x23187d[_0x1f015d(0x18a)][_0x1f015d(0xefa)]||[];_0xaa4c0c[_0x1f015d(0xf7b)]=_0x567835['length']>0x0,_0x486e9a['style'][_0x1f015d(0x678)]=_0xaa4c0c['checked']?_0x1f015d(0xee3):_0x1f015d(0xff8),_0x3cac14[_0x1f015d(0x3de)]='',Object['values'](_0x505390[_0x1f015d(0x1027)])[_0x1f015d(0x12be)](_0x87e58=>{const _0x2299ae=_0x1f015d;if(_0x87e58['id']===_0x23187d['id'])return;const _0x5bbc64=_0x567835['includes'](_0x87e58['id']),_0x278ee8=_0x87e58[_0x2299ae(0x9d7)]?_0x2299ae(0x519):_0x2299ae(0x9ae),_0x2f792c=document[_0x2299ae(0xbd5)]('label');_0x2f792c['innerHTML']=_0x2299ae(0x880)+_0x87e58['id']+'\x22\x20'+(_0x5bbc64?_0x2299ae(0xf7b):'')+'>\x20'+_0x278ee8+'\x20'+_0x87e58[_0x2299ae(0x564)],_0x3cac14[_0x2299ae(0x9f4)](_0x2f792c);});function _0x1aa54a(){const _0x532ada=_0x1f015d,_0x2689bf=_0x3cac14[_0x532ada(0x99e)](_0x532ada(0x375)),_0x5d0b2d=_0x486e9a['querySelector'](_0x532ada(0x4d6));if(_0x2689bf[_0x532ada(0x990)]===0x0)_0x5d0b2d[_0x532ada(0x97b)]=_0x532ada(0xa71);else _0x2689bf['length']>0x2?_0x5d0b2d[_0x532ada(0x97b)]='已选择\x20'+_0x2689bf[_0x532ada(0x990)]+'\x20项':_0x5d0b2d['textContent']=Array['from'](_0x2689bf)[_0x532ada(0x2e1)](_0x68e26d=>_0x68e26d[_0x532ada(0x8be)][_0x532ada(0x97b)][_0x532ada(0x9c1)]())['join'](',\x20');}_0x1aa54a(),_0xaa4c0c[_0x1f015d(0xa75)](_0x1f015d(0x1150),()=>{const _0x48b109=_0x1f015d;_0x486e9a[_0x48b109(0x10dd)][_0x48b109(0x678)]=_0xaa4c0c[_0x48b109(0xf7b)]?'block':'none';});const _0x455704=_0x486e9a['querySelector'](_0x1f015d(0x5f7)),_0x3be7b7=_0x455704[_0x1f015d(0xbcf)](!![]);_0x455704[_0x1f015d(0x1134)][_0x1f015d(0xf0d)](_0x3be7b7,_0x455704),_0x3be7b7[_0x1f015d(0xa75)]('click',_0x2f12c7=>{const _0x751c48=_0x1f015d;_0x2f12c7[_0x751c48(0x748)](),_0x3cac14['classList'][_0x751c48(0x2bf)]('visible'),_0x3be7b7['classList'][_0x751c48(0x2bf)](_0x751c48(0x18d));}),_0x3cac14[_0x1f015d(0xa75)](_0x1f015d(0x1150),_0x1aa54a);const _0x1816ae=document['querySelector'](_0x1f015d(0x543)+(_0x23187d[_0x1f015d(0x18a)][_0x1f015d(0x1057)]||_0x1f015d(0x603))+'\x22]');if(_0x1816ae)_0x1816ae[_0x1f015d(0xf7b)]=!![];const _0x2bfbb9=document[_0x1f015d(0x479)](_0x1f015d(0xa94));_0x2bfbb9[_0x1f015d(0x4e0)]=_0x23187d['settings']['fontSize']||0xd,document[_0x1f015d(0x479)](_0x1f015d(0x860))['textContent']=_0x2bfbb9[_0x1f015d(0x4e0)]+'px';const _0x5defad=document[_0x1f015d(0x479)](_0x1f015d(0xbfb));_0x5defad['value']=_0x23187d[_0x1f015d(0x18a)]['customCss']||'',_0x11fab3(),document['getElementById'](_0x1f015d(0x5c8))[_0x1f015d(0xf7b)]=_0x23187d[_0x1f015d(0x18a)]['enableAutoMemory']||![],document['getElementById'](_0x1f015d(0xdd4))['value']=_0x23187d[_0x1f015d(0x18a)][_0x1f015d(0xbfd)]||0x14,_0x731d5(_0x1f015d(0x67a));});function _0x5645b9(_0x44424f){const _0x225196=_0x494435,_0x489886=document['getElementById'](_0x225196(0x1287));_0x489886[_0x225196(0x3de)]='',_0x44424f[_0x225196(0x12be)](_0x1553f2=>{const _0x4f2486=_0x225196,_0x4ca200=document[_0x4f2486(0xbd5)](_0x4f2486(0x6c8));_0x4ca200[_0x4f2486(0xfd4)]=_0x4f2486(0x6e6),_0x4ca200[_0x4f2486(0x13d4)][_0x4f2486(0xb55)]=_0x1553f2['id'];const _0x4b5737=_0x1553f2[_0x4f2486(0x799)]||(_0x505390[_0x4f2486(0x1027)][_0x1553f2['id']]?_0x505390['chats'][_0x1553f2['id']][_0x4f2486(0x18a)][_0x4f2486(0x1039)]:_0x3ea4df);_0x4ca200[_0x4f2486(0x3de)]='<img\x20src=\x22'+_0x4b5737+_0x4f2486(0xa6f)+_0x1553f2[_0x4f2486(0xa54)]+'\x22><div\x20class=\x22member-name\x22>'+_0x1553f2[_0x4f2486(0xa54)]+_0x4f2486(0x2c3),_0x4ca200[_0x4f2486(0xa75)](_0x4f2486(0xd2f),()=>_0x5b6bff(_0x1553f2['id'])),_0x489886[_0x4f2486(0x9f4)](_0x4ca200);});}document['getElementById'](_0x494435(0xfa9))[_0x494435(0xa75)](_0x494435(0xd2f),async()=>{const _0x1c7433=_0x494435;if(!_0x5799fc)return;const _0x2fdcac=_0x505390[_0x1c7433(0x1027)][_0x505390[_0x1c7433(0x233)]],_0x25c9e4=_0x2fdcac[_0x1c7433(0x954)][_0x1c7433(0xc0d)](_0xf2745b=>_0xf2745b['id']===_0x5799fc);if(!_0x25c9e4)return;const _0x4314c3=document[_0x1c7433(0x479)]('member-name-input')[_0x1c7433(0x4e0)]['trim']();if(!_0x4314c3){alert(_0x1c7433(0xd30));return;}_0x25c9e4[_0x1c7433(0xa54)]=_0x4314c3,_0x25c9e4[_0x1c7433(0x596)]=document['getElementById'](_0x1c7433(0x1d7))[_0x1c7433(0x4e0)];const _0x314aa0=document[_0x1c7433(0x479)]('member-avatar-preview')[_0x1c7433(0xa9c)];_0x25c9e4['avatar']=_0x314aa0;const _0x19ae90=_0x505390['chats'][_0x25c9e4['id']];_0x19ae90&&(_0x19ae90[_0x1c7433(0x18a)][_0x1c7433(0x1039)]=_0x314aa0,await _0xb81d4e['chats'][_0x1c7433(0x5d0)](_0x19ae90)),await _0xb81d4e[_0x1c7433(0x1027)][_0x1c7433(0x5d0)](_0x2fdcac),_0x5645b9(_0x2fdcac[_0x1c7433(0x954)]),document['getElementById'](_0x1c7433(0xb59))[_0x1c7433(0x9cd)][_0x1c7433(0x8b6)](_0x1c7433(0x45a)),_0x5799fc=null;});function _0x5b6bff(_0x1edae9){const _0x218999=_0x494435;_0x5799fc=_0x1edae9;const _0x2b1000=_0x505390[_0x218999(0x1027)][_0x505390['activeChatId']],_0x29bd9a=_0x2b1000[_0x218999(0x954)][_0x218999(0xc0d)](_0x7e7e20=>_0x7e7e20['id']===_0x1edae9);if(!_0x29bd9a)return;document[_0x218999(0x479)]('member-name-input')[_0x218999(0x4e0)]=_0x29bd9a[_0x218999(0xa54)],document[_0x218999(0x479)]('member-persona-input')[_0x218999(0x4e0)]=_0x29bd9a[_0x218999(0x596)];const _0x37a030=_0x29bd9a[_0x218999(0x799)]||(_0x505390[_0x218999(0x1027)][_0x29bd9a['id']]?_0x505390['chats'][_0x29bd9a['id']]['settings']['aiAvatar']:_0x3ea4df);document[_0x218999(0x479)]('member-avatar-preview')[_0x218999(0xa9c)]=_0x37a030,document['getElementById'](_0x218999(0xb59))['classList'][_0x218999(0x807)](_0x218999(0x45a));}document[_0x494435(0x479)](_0x494435(0xc99))['addEventListener'](_0x494435(0xd2f),()=>{const _0x37cb48=_0x494435;document[_0x37cb48(0x479)](_0x37cb48(0xb59))[_0x37cb48(0x9cd)][_0x37cb48(0x8b6)](_0x37cb48(0x45a)),_0x5799fc=null;}),document[_0x494435(0x479)](_0x494435(0xfa9))[_0x494435(0xa75)](_0x494435(0xd2f),async()=>{const _0x35fed0=_0x494435;if(!_0x5799fc)return;const _0x46dbbf=_0x505390[_0x35fed0(0x1027)][_0x505390[_0x35fed0(0x233)]],_0x12023e=_0x46dbbf[_0x35fed0(0x954)][_0x35fed0(0xc0d)](_0x4c61ba=>_0x4c61ba['id']===_0x5799fc);if(!_0x12023e)return;const _0x5a74f5=document[_0x35fed0(0x479)]('member-name-input')[_0x35fed0(0x4e0)][_0x35fed0(0x9c1)]();if(!_0x5a74f5){alert(_0x35fed0(0xd30));return;}_0x12023e[_0x35fed0(0xa54)]=_0x5a74f5,_0x12023e['persona']=document[_0x35fed0(0x479)](_0x35fed0(0x1d7))[_0x35fed0(0x4e0)];const _0x136110=document[_0x35fed0(0x479)](_0x35fed0(0xf19))[_0x35fed0(0xa9c)];_0x12023e['avatar']=_0x136110;const _0x76e2f9=_0x505390[_0x35fed0(0x1027)][_0x12023e['id']];_0x76e2f9&&(_0x76e2f9[_0x35fed0(0x18a)][_0x35fed0(0x1039)]=_0x136110,await _0xb81d4e['chats'][_0x35fed0(0x5d0)](_0x76e2f9)),await _0xb81d4e[_0x35fed0(0x1027)][_0x35fed0(0x5d0)](_0x46dbbf),_0x5645b9(_0x46dbbf[_0x35fed0(0x954)]),document[_0x35fed0(0x479)](_0x35fed0(0xb59))['classList'][_0x35fed0(0x8b6)](_0x35fed0(0x45a)),_0x5799fc=null;}),document[_0x494435(0x479)](_0x494435(0x7b1))['addEventListener'](_0x494435(0xd2f),()=>{const _0x5ec306=_0x494435;document[_0x5ec306(0x479)](_0x5ec306(0xf04))['checked']=!![];}),document['getElementById'](_0x494435(0xe86))[_0x494435(0xa75)](_0x494435(0xd2f),async()=>{const _0x4f9b38=_0x494435;if(!_0x505390[_0x4f9b38(0x233)])return;const _0x51d118=_0x505390[_0x4f9b38(0x1027)][_0x505390['activeChatId']],_0x44a1b7=_0x51d118[_0x4f9b38(0x18a)][_0x4f9b38(0x328)]||![],_0x2ba75e=document[_0x4f9b38(0x479)]('chat-name-input')[_0x4f9b38(0x4e0)][_0x4f9b38(0x9c1)]();if(!_0x2ba75e)return alert(_0x4f9b38(0x13af));if(!_0x51d118[_0x4f9b38(0x9d7)]&&_0x2ba75e!==_0x51d118[_0x4f9b38(0x564)]){if(!_0x51d118['nameHistory'])_0x51d118[_0x4f9b38(0x102f)]=[];if(!_0x51d118['nameHistory']['includes'](_0x51d118['name']))_0x51d118['nameHistory']['push'](_0x51d118[_0x4f9b38(0x564)]);}_0x51d118['name']=_0x2ba75e;const _0x402e70=document[_0x4f9b38(0x8bc)]('input[name=\x22theme-select\x22]:checked');_0x51d118[_0x4f9b38(0x18a)][_0x4f9b38(0x1057)]=_0x402e70?_0x402e70[_0x4f9b38(0x4e0)]:'default',_0x51d118[_0x4f9b38(0x18a)][_0x4f9b38(0x1106)]=parseInt(document[_0x4f9b38(0x479)](_0x4f9b38(0xa94))[_0x4f9b38(0x4e0)]),_0x51d118[_0x4f9b38(0x18a)][_0x4f9b38(0x1290)]=document[_0x4f9b38(0x479)](_0x4f9b38(0xbfb))[_0x4f9b38(0x4e0)][_0x4f9b38(0x9c1)](),_0x51d118[_0x4f9b38(0x18a)]['myPersona']=document[_0x4f9b38(0x479)]('my-persona')[_0x4f9b38(0x4e0)],_0x51d118[_0x4f9b38(0x18a)][_0x4f9b38(0xe28)]=document[_0x4f9b38(0x479)](_0x4f9b38(0xdfe))[_0x4f9b38(0xa9c)],_0x51d118[_0x4f9b38(0x18a)][_0x4f9b38(0x2c6)]=parseInt(document['getElementById'](_0x4f9b38(0xdd7))['value'])||0xa,_0x51d118['settings'][_0x4f9b38(0xefc)]=parseInt(document[_0x4f9b38(0x479)](_0x4f9b38(0x454))[_0x4f9b38(0x4e0)])||0xa;const _0x3cc56c=document[_0x4f9b38(0x99e)](_0x4f9b38(0x6b3)),_0xe2da6e=[];_0x3cc56c['forEach'](_0x2de167=>{const _0x31d50a=_0x4f9b38;_0x2de167[_0x31d50a(0x4e0)][_0x31d50a(0x591)](_0x31d50a(0x7e6))&&_0xe2da6e[_0x31d50a(0x1a0)](_0x2de167[_0x31d50a(0x4e0)]['replace'](_0x31d50a(0x7e6),''));}),_0x51d118[_0x4f9b38(0x18a)][_0x4f9b38(0x13da)]=_0xe2da6e;const _0xdd71c=document['getElementById'](_0x4f9b38(0xac7))['checked'];if(_0xdd71c){const _0xeed445=document[_0x4f9b38(0x99e)]('#linked-chats-checkboxes-container\x20input:checked');_0x51d118['settings'][_0x4f9b38(0xefa)]=Array[_0x4f9b38(0x22f)](_0xeed445)[_0x4f9b38(0x2e1)](_0x1006ee=>_0x1006ee[_0x4f9b38(0x4e0)]);}else _0x51d118[_0x4f9b38(0x18a)][_0x4f9b38(0xefa)]=[];_0x51d118[_0x4f9b38(0x18a)][_0x4f9b38(0x9e7)]=document[_0x4f9b38(0x479)](_0x4f9b38(0x5c8))[_0x4f9b38(0xf7b)],_0x51d118[_0x4f9b38(0x18a)][_0x4f9b38(0xbfd)]=parseInt(document[_0x4f9b38(0x479)](_0x4f9b38(0xdd4))['value'])||0x14,_0x51d118['settings'][_0x4f9b38(0xeb0)]=document[_0x4f9b38(0x479)](_0x4f9b38(0xdb9))['checked'],_0x51d118[_0x4f9b38(0x18a)][_0x4f9b38(0xac0)]=document['getElementById']('time-zone-select')[_0x4f9b38(0x4e0)];if(_0x51d118[_0x4f9b38(0x9d7)])_0x51d118[_0x4f9b38(0x18a)][_0x4f9b38(0xc00)]=document['getElementById']('group-background-activity-switch')[_0x4f9b38(0xf7b)],_0x51d118[_0x4f9b38(0x18a)]['myNickname']=document[_0x4f9b38(0x479)](_0x4f9b38(0x136e))['value'][_0x4f9b38(0x9c1)](),_0x51d118[_0x4f9b38(0x18a)][_0x4f9b38(0x67c)]=document[_0x4f9b38(0x479)](_0x4f9b38(0x71e))['src'],_0x51d118[_0x4f9b38(0x18a)][_0x4f9b38(0x1097)]=parseInt(document[_0x4f9b38(0x479)](_0x4f9b38(0xdd3))[_0x4f9b38(0x4e0)])||0xa;else{_0x51d118[_0x4f9b38(0x18a)][_0x4f9b38(0xc00)]=document['getElementById'](_0x4f9b38(0x7d6))[_0x4f9b38(0xf7b)];const _0x1d2514=document[_0x4f9b38(0x479)](_0x4f9b38(0x1b2))[_0x4f9b38(0xf7b)];_0x51d118[_0x4f9b38(0x18a)][_0x4f9b38(0x328)]=_0x1d2514;if(_0x44a1b7===!![]&&_0x1d2514===![]){const _0x5a4b93={'role':'system','content':'[系统指令：模式已切换！你现在回到了线上聊天模式。你的回复【必须】严格遵守线上模式的JSON数组格式，例如\x20[{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好\x22}]]','timestamp':Date['now'](),'isHidden':!![]};_0x51d118[_0x4f9b38(0x7d3)][_0x4f9b38(0x1a0)](_0x5a4b93),console[_0x4f9b38(0x90f)](_0x4f9b38(0xebf));}_0x51d118['settings']['injectLatestThought']=document[_0x4f9b38(0x479)](_0x4f9b38(0x3da))['checked'],_0x51d118[_0x4f9b38(0x18a)]['offlineMinLength']=parseInt(document['getElementById'](_0x4f9b38(0x277))['value'])||0x64,_0x51d118[_0x4f9b38(0x18a)][_0x4f9b38(0x1084)]=parseInt(document[_0x4f9b38(0x479)](_0x4f9b38(0x9b3))[_0x4f9b38(0x4e0)])||0x12c,_0x51d118[_0x4f9b38(0x18a)][_0x4f9b38(0x212)]=document['getElementById'](_0x4f9b38(0x86f))[_0x4f9b38(0x4e0)]||null;const _0x30c68f=document[_0x4f9b38(0x479)]('ai-original-name-input')['value']['trim']();if(!_0x30c68f)return alert(_0x4f9b38(0x2dd));_0x51d118['originalName']=_0x30c68f,_0x51d118[_0x4f9b38(0x18a)][_0x4f9b38(0x11f6)]=document['getElementById']('ai-persona')['value'],_0x51d118[_0x4f9b38(0x18a)][_0x4f9b38(0x1180)]=document[_0x4f9b38(0x479)](_0x4f9b38(0x236))[_0x4f9b38(0x4e0)][_0x4f9b38(0x9c1)](),_0x51d118[_0x4f9b38(0x18a)]['enableTts']=document[_0x4f9b38(0x479)](_0x4f9b38(0x7be))[_0x4f9b38(0xf7b)],_0x51d118[_0x4f9b38(0x18a)][_0x4f9b38(0x1039)]=document[_0x4f9b38(0x479)](_0x4f9b38(0xcd8))[_0x4f9b38(0xa9c)],_0x51d118[_0x4f9b38(0x18a)]['myNickname']=document[_0x4f9b38(0x479)]('my-nickname-input')[_0x4f9b38(0x4e0)]['trim']()||'我',_0x51d118[_0x4f9b38(0x18a)][_0x4f9b38(0x1097)]=parseInt(document['getElementById'](_0x4f9b38(0x131a))[_0x4f9b38(0x4e0)])||0xa,_0x51d118[_0x4f9b38(0x18a)][_0x4f9b38(0x1211)]={'vertical':document[_0x4f9b38(0x479)](_0x4f9b38(0x7f3))[_0x4f9b38(0x4e0)],'horizontal':document[_0x4f9b38(0x479)]('lyrics-horizontal-pos')[_0x4f9b38(0x4e0)],'offset':parseInt(document[_0x4f9b38(0x479)](_0x4f9b38(0x2df))['value'])||0xa};const _0x2f2a09=document[_0x4f9b38(0x479)](_0x4f9b38(0x6a7))[_0x4f9b38(0x4e0)];_0x51d118[_0x4f9b38(0x194)]=_0x2f2a09?parseInt(_0x2f2a09):null;}await _0xb81d4e['chats']['put'](_0x51d118),!_0x51d118[_0x4f9b38(0x9d7)]&&(await _0x377162(_0x51d118),await _0x134037(_0x51d118)),_0x372924(_0x51d118),_0x4156f1(_0x51d118['settings'][_0x4f9b38(0x1290)],_0x4f9b38(0x47d),_0x4f9b38(0xa86)),_0x731d5('chat-interface-screen'),_0x474d6b(_0x505390[_0x4f9b38(0x233)]),_0x1b7f69();}),document['getElementById'](_0x494435(0x67a))['addEventListener'](_0x494435(0xd2f),_0x3b49a4=>{const _0x73d60f=_0x494435;_0x3b49a4[_0x73d60f(0xfa2)][_0x73d60f(0x9cd)]['contains'](_0x73d60f(0x70a))&&_0x90c5f(_0x73d60f(0xa50));}),document['getElementById']('member-settings-modal')['addEventListener'](_0x494435(0xd2f),_0x56a615=>{const _0x321f2c=_0x494435;_0x56a615[_0x321f2c(0xfa2)][_0x321f2c(0x9cd)]['contains'](_0x321f2c(0x70a))&&_0x90c5f(_0x321f2c(0x736));});const _0x3bda41=document[_0x494435(0x479)](_0x494435(0x436)),_0x169a0a=document[_0x494435(0x479)](_0x494435(0xdea)),_0x36bc1e=document[_0x494435(0x479)](_0x494435(0x5a8)),_0x28ea93=document['getElementById'](_0x494435(0x24b)),_0x28daa1=document['getElementById'](_0x494435(0xa5b));document['getElementById'](_0x494435(0xf8b))[_0x494435(0xa75)]('click',_0x4df7aa),document[_0x494435(0x479)]('cancel-frame-settings-btn')[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x5180e0=_0x494435;_0x3bda41[_0x5180e0(0x9cd)][_0x5180e0(0x8b6)]('visible'),_0x49562c=![];}),_0x169a0a[_0x494435(0xa75)]('click',()=>{const _0x218c73=_0x494435;_0x169a0a[_0x218c73(0x9cd)][_0x218c73(0x807)](_0x218c73(0x5a9)),_0x36bc1e[_0x218c73(0x9cd)][_0x218c73(0x8b6)](_0x218c73(0x5a9)),_0x28ea93[_0x218c73(0x10dd)][_0x218c73(0x678)]='block',_0x28daa1['style']['display']=_0x218c73(0xff8);}),_0x36bc1e[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x39c327=_0x494435;_0x36bc1e['classList']['add'](_0x39c327(0x5a9)),_0x169a0a[_0x39c327(0x9cd)][_0x39c327(0x8b6)](_0x39c327(0x5a9)),_0x28daa1[_0x39c327(0x10dd)]['display']=_0x39c327(0xee3),_0x28ea93[_0x39c327(0x10dd)][_0x39c327(0x678)]='none';}),document['getElementById'](_0x494435(0x96b))['addEventListener']('click',async()=>{const _0x5ee51c=_0x494435;if(!_0x505390[_0x5ee51c(0x233)])return;const _0x4a3ab3=_0x505390[_0x5ee51c(0x1027)][_0x505390[_0x5ee51c(0x233)]],_0x553ba9=await _0x1a9e79(_0x5ee51c(0x1080),_0x5ee51c(0x38e),{'confirmButtonClass':_0x5ee51c(0x95a)});_0x553ba9&&(_0x4a3ab3[_0x5ee51c(0x7d3)]=[],_0x4a3ab3[_0x5ee51c(0x25c)]=_0x5ee51c(0x4d0),_0x4a3ab3['randomJottings']=_0x5ee51c(0x4d0),await _0xb81d4e[_0x5ee51c(0x1027)]['put'](_0x4a3ab3),_0x474d6b(_0x505390['activeChatId']),_0x1b7f69(),_0x46cb16[_0x5ee51c(0x9cd)][_0x5ee51c(0x8b6)](_0x5ee51c(0x45a)));});const _0xb1a0a1=(_0xc8637e,_0x11466e)=>{const _0x2001f4=_0x494435;document[_0x2001f4(0x479)](_0xc8637e)['addEventListener']('change',async _0x5c4722=>{const _0x263905=_0x2001f4,_0x3d49b7=_0x5c4722['target'][_0x263905(0xe63)][0x0];if(_0x3d49b7){const _0x229348=await new Promise((_0x55db92,_0x4509a4)=>{const _0x49371f=_0x263905,_0x1b7b88=new FileReader();_0x1b7b88[_0x49371f(0x502)]=()=>_0x55db92(_0x1b7b88[_0x49371f(0x97e)]),_0x1b7b88[_0x49371f(0x1337)]=()=>_0x4509a4(_0x1b7b88[_0x49371f(0xe3b)]),_0x1b7b88['readAsDataURL'](_0x3d49b7);});_0x11466e(_0x229348),_0x5c4722[_0x263905(0xfa2)][_0x263905(0x4e0)]=null;}});};_0xb1a0a1(_0x494435(0xd7e),_0x45fbbe=>document[_0x494435(0x479)](_0x494435(0xcd8))[_0x494435(0xa9c)]=_0x45fbbe),_0xb1a0a1(_0x494435(0x4f8),_0x535297=>document[_0x494435(0x479)](_0x494435(0xdfe))[_0x494435(0xa9c)]=_0x535297),_0xb1a0a1(_0x494435(0x4b7),_0x28037f=>document[_0x494435(0x479)](_0x494435(0x71e))['src']=_0x28037f),_0xb1a0a1(_0x494435(0x108b),_0x1a7700=>document[_0x494435(0x479)]('member-avatar-preview')['src']=_0x1a7700),_0xb1a0a1(_0x494435(0x12d1),_0x42660d=>{const _0x4321b9=_0x494435;if(_0x505390[_0x4321b9(0x233)]){_0x505390[_0x4321b9(0x1027)][_0x505390[_0x4321b9(0x233)]][_0x4321b9(0x18a)][_0x4321b9(0x7fb)]=_0x42660d;const _0x10fb53=document[_0x4321b9(0x479)](_0x4321b9(0xb0b));_0x10fb53['src']=_0x42660d,_0x10fb53[_0x4321b9(0x10dd)][_0x4321b9(0x678)]=_0x4321b9(0xee3),document[_0x4321b9(0x479)](_0x4321b9(0x460))[_0x4321b9(0x10dd)][_0x4321b9(0x678)]=_0x4321b9(0x25f);}}),_0xb1a0a1('preset-avatar-input',_0x16f0de=>document[_0x494435(0x479)](_0x494435(0x675))['src']=_0x16f0de),document[_0x494435(0x479)](_0x494435(0x460))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x5d89d9=_0x494435;if(_0x505390[_0x5d89d9(0x233)]){_0x505390[_0x5d89d9(0x1027)][_0x505390[_0x5d89d9(0x233)]]['settings'][_0x5d89d9(0x7fb)]='';const _0x124fde=document[_0x5d89d9(0x479)](_0x5d89d9(0xb0b));_0x124fde['src']='',_0x124fde['style'][_0x5d89d9(0x678)]=_0x5d89d9(0xff8),document[_0x5d89d9(0x479)](_0x5d89d9(0x460))['style'][_0x5d89d9(0x678)]=_0x5d89d9(0xff8);}});const _0x4b6531=document[_0x494435(0x479)](_0x494435(0xb8d));document[_0x494435(0x479)](_0x494435(0x4ad))['addEventListener'](_0x494435(0xd2f),()=>{const _0x1140b5=_0x494435,_0x459906=_0x505390[_0x1140b5(0x1027)][_0x505390[_0x1140b5(0x233)]];_0x459906&&_0x459906['settings']['stickerCategoryId']?_0x2a104d=_0x459906[_0x1140b5(0x18a)][_0x1140b5(0x1371)]:_0x2a104d=_0x1140b5(0xf78),_0x46e430(),_0x4b6531[_0x1140b5(0x9cd)]['add']('visible');}),document['getElementById']('close-sticker-panel-btn')['addEventListener'](_0x494435(0xd2f),()=>_0x4b6531[_0x494435(0x9cd)][_0x494435(0x8b6)](_0x494435(0x45a))),document[_0x494435(0x479)]('add-sticker-batch-btn')['addEventListener'](_0x494435(0xd2f),_0x5d7c47),document[_0x494435(0x479)](_0x494435(0x42a))[_0x494435(0xa75)](_0x494435(0xd2f),()=>document['getElementById']('sticker-upload-input')['click']()),document['getElementById'](_0x494435(0x13ca))[_0x494435(0xa75)](_0x494435(0x1150),async _0x2d4823=>{const _0x18b274=_0x494435,_0x2d0c91=_0x2d4823[_0x18b274(0xfa2)][_0x18b274(0xe63)][0x0];if(!_0x2d0c91)return;const _0x394c5a=new FileReader();_0x394c5a[_0x18b274(0x83c)](_0x2d0c91),_0x394c5a['onload']=async()=>{const _0x3881b1=_0x18b274,_0x2ebfd5=_0x394c5a[_0x3881b1(0x97e)],_0x5080db=await _0x9a2c09(_0x3881b1(0x3af),_0x3881b1(0x1dc));if(_0x5080db&&_0x5080db[_0x3881b1(0x9c1)]()){const _0x10915d={'id':'sticker_'+Date[_0x3881b1(0x12d6)](),'url':_0x2ebfd5,'name':_0x5080db[_0x3881b1(0x9c1)](),'categoryId':_0x2a104d!==_0x3881b1(0xf78)&&_0x2a104d!==_0x3881b1(0x331)?_0x2a104d:null};await _0xb81d4e[_0x3881b1(0x407)][_0x3881b1(0x807)](_0x10915d),_0x505390[_0x3881b1(0x407)]['push'](_0x10915d),_0x46e430();}else{if(_0x5080db!==null)alert('表情名不能为空！');}},_0x2d4823[_0x18b274(0xfa2)][_0x18b274(0x4e0)]=null;}),document[_0x494435(0x479)](_0x494435(0x9b9))[_0x494435(0xa75)](_0x494435(0xd2f),()=>document[_0x494435(0x479)]('image-upload-input')[_0x494435(0xd2f)]()),document[_0x494435(0x479)](_0x494435(0x280))[_0x494435(0xa75)](_0x494435(0x1150),async _0x2c4109=>{const _0x271c6f=_0x494435,_0x3286c9=_0x2c4109[_0x271c6f(0xfa2)][_0x271c6f(0xe63)][0x0];if(!_0x3286c9||!_0x505390[_0x271c6f(0x233)])return;const _0x81eeff=new FileReader();_0x81eeff[_0x271c6f(0x502)]=async _0x4c2a33=>{const _0x1d1ea2=_0x271c6f,_0x24c6a9=_0x4c2a33[_0x1d1ea2(0xfa2)][_0x1d1ea2(0x97e)],_0x360a5d=_0x505390[_0x1d1ea2(0x1027)][_0x505390[_0x1d1ea2(0x233)]],_0xd428c3={'role':'user','content':[{'type':'image_url','image_url':{'url':_0x24c6a9}}],'timestamp':Date[_0x1d1ea2(0x12d6)]()};_0x360a5d[_0x1d1ea2(0x7d3)][_0x1d1ea2(0x1a0)](_0xd428c3),await _0xb81d4e['chats'][_0x1d1ea2(0x5d0)](_0x360a5d),_0x48f5ff(_0xd428c3,_0x360a5d),_0x1b7f69();},_0x81eeff['readAsDataURL'](_0x3286c9),_0x2c4109[_0x271c6f(0xfa2)][_0x271c6f(0x4e0)]=null;}),document['getElementById'](_0x494435(0x13ce))[_0x494435(0xa75)](_0x494435(0xd2f),async()=>{const _0x6bfd77=_0x494435;if(!_0x505390[_0x6bfd77(0x233)])return;const _0x3adda2=await _0x9a2c09(_0x6bfd77(0x1381),_0x6bfd77(0xed6));if(_0x3adda2&&_0x3adda2[_0x6bfd77(0x9c1)]()){const _0x2de40e=_0x505390['chats'][_0x505390['activeChatId']],_0x40adcd={'role':_0x6bfd77(0x4c5),'type':_0x6bfd77(0x9bf),'content':_0x3adda2[_0x6bfd77(0x9c1)](),'timestamp':Date[_0x6bfd77(0x12d6)]()};_0x2de40e[_0x6bfd77(0x7d3)][_0x6bfd77(0x1a0)](_0x40adcd),await _0xb81d4e['chats'][_0x6bfd77(0x5d0)](_0x2de40e),_0x48f5ff(_0x40adcd,_0x2de40e),_0x1b7f69();}}),document['getElementById'](_0x494435(0xf1e))['addEventListener'](_0x494435(0xd2f),async()=>{const _0xda2964=_0x494435;if(!_0x505390[_0xda2964(0x233)])return;const _0x2afc52=await _0x9a2c09(_0xda2964(0x11e4),'请用文字描述您要发送的照片：');if(_0x2afc52&&_0x2afc52['trim']()){const _0x203663=_0x505390['chats'][_0x505390['activeChatId']],_0x54a2e={'role':_0xda2964(0x4c5),'type':_0xda2964(0x5d5),'content':_0x2afc52[_0xda2964(0x9c1)](),'timestamp':Date[_0xda2964(0x12d6)]()};_0x203663[_0xda2964(0x7d3)]['push'](_0x54a2e),await _0xb81d4e[_0xda2964(0x1027)][_0xda2964(0x5d0)](_0x203663),_0x48f5ff(_0x54a2e,_0x203663),_0x1b7f69();}});const _0x414a24=document[_0x494435(0x479)](_0x494435(0xc03));document[_0x494435(0x479)]('send-waimai-request-btn')[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0xa22bf3=_0x494435;_0x414a24[_0xa22bf3(0x9cd)][_0xa22bf3(0x807)](_0xa22bf3(0x45a));}),_0x414a24[_0x494435(0xa75)](_0x494435(0xd2f),_0x539e99=>{const _0x35ace3=_0x494435;_0x539e99[_0x35ace3(0xfa2)]===_0x414a24&&_0x414a24[_0x35ace3(0x9cd)][_0x35ace3(0x8b6)](_0x35ace3(0x45a));}),document[_0x494435(0x479)](_0x494435(0x136b))[_0x494435(0xa75)](_0x494435(0xd2f),_0x2e4b5b),document[_0x494435(0x479)]('waimai-confirm-btn')['addEventListener'](_0x494435(0xd2f),async()=>{const _0xb3ebc4=_0x494435;if(!_0x505390['activeChatId'])return;const _0x27ccf2=document['getElementById']('waimai-product-info'),_0x10b8e2=document[_0xb3ebc4(0x479)](_0xb3ebc4(0x1236)),_0x37660c=_0x27ccf2[_0xb3ebc4(0x4e0)][_0xb3ebc4(0x9c1)](),_0x5dd0f3=parseFloat(_0x10b8e2[_0xb3ebc4(0x4e0)]);if(!_0x37660c||isNaN(_0x5dd0f3)||_0x5dd0f3<=0x0){alert(_0xb3ebc4(0xc41));return;}const _0x86be61=_0x505390['chats'][_0x505390[_0xb3ebc4(0x233)]],_0x3ba627=Date[_0xb3ebc4(0x12d6)](),_0x4eca89=_0x86be61['isGroup']?_0x86be61[_0xb3ebc4(0x18a)][_0xb3ebc4(0xf58)]||'我':'我',_0x1705f4={'role':_0xb3ebc4(0x4c5),'senderName':_0x4eca89,'type':_0xb3ebc4(0x792),'productInfo':_0x37660c,'amount':_0x5dd0f3,'status':_0xb3ebc4(0xa25),'countdownEndTime':_0x3ba627+0xf*0x3c*0x3e8,'timestamp':_0x3ba627};_0x86be61['history']['push'](_0x1705f4),await _0xb81d4e[_0xb3ebc4(0x1027)][_0xb3ebc4(0x5d0)](_0x86be61),_0x48f5ff(_0x1705f4,_0x86be61),_0x1b7f69(),_0x27ccf2[_0xb3ebc4(0x4e0)]='',_0x10b8e2[_0xb3ebc4(0x4e0)]='',_0x414a24['classList'][_0xb3ebc4(0x8b6)](_0xb3ebc4(0x45a));}),document['getElementById'](_0x494435(0xb81))['addEventListener'](_0x494435(0xd2f),_0x45b462),document[_0x494435(0x479)](_0x494435(0xbb6))[_0x494435(0xa75)](_0x494435(0xd2f),_0xf7de35),document[_0x494435(0x479)](_0x494435(0x667))['addEventListener'](_0x494435(0xd2f),_0x46fee0),document[_0x494435(0x479)]('cancel-persona-editor-btn')[_0x494435(0xa75)](_0x494435(0xd2f),_0x4d2b7),document['getElementById'](_0x494435(0xc3e))[_0x494435(0xa75)](_0x494435(0xd2f),_0xc976f1),document[_0x494435(0x479)](_0x494435(0x2ee))[_0x494435(0xa75)](_0x494435(0xd2f),_0x1b6c65),document[_0x494435(0x479)](_0x494435(0xc82))['addEventListener'](_0x494435(0xd2f),_0x403b7d),document[_0x494435(0x479)](_0x494435(0x132c))[_0x494435(0xa75)](_0x494435(0xd2f),_0x3ac37e),document[_0x494435(0x479)]('selection-cancel-btn')[_0x494435(0xa75)](_0x494435(0xd2f),_0x24d789),document[_0x494435(0x479)](_0x494435(0x5bd))['addEventListener'](_0x494435(0xd2f),async()=>{const _0x1d118b=_0x494435;if(_0x373eab['size']===0x0)return;const _0x19c446=await _0x1a9e79(_0x1d118b(0x4cd),_0x1d118b(0x12f6)+_0x373eab[_0x1d118b(0xa7a)]+'\x20条消息吗？这会通知AI这些消息已被删除。',{'confirmButtonClass':_0x1d118b(0x95a)});if(_0x19c446){const _0x55066c=_0x505390[_0x1d118b(0x1027)][_0x505390[_0x1d118b(0x233)]];let _0x3d6962=[];for(const _0x1f6d16 of _0x373eab){const _0x5ddbe5=_0x55066c[_0x1d118b(0x7d3)][_0x1d118b(0xc0d)](_0x413a7f=>_0x413a7f['timestamp']===_0x1f6d16);_0x5ddbe5&&_0x5ddbe5['type']===_0x1d118b(0xb34)&&_0x3d6962['push'](_0x1d118b(0xaed)+_0x5ddbe5['question']+_0x1d118b(0x10c8)+_0x5ddbe5[_0x1d118b(0x12a2)]+')');}_0x55066c['history']=_0x55066c[_0x1d118b(0x7d3)][_0x1d118b(0x85d)](_0x230ed1=>!_0x373eab['has'](_0x230ed1['timestamp']));let _0x57fbb8='一些之前的消息已被用户删除。';_0x3d6962[_0x1d118b(0x990)]>0x0&&(_0x57fbb8+=_0x1d118b(0xb97)+_0x3d6962[_0x1d118b(0x35d)]('；')+'。');_0x57fbb8+=_0x1d118b(0x11db);const _0x22806c={'role':_0x1d118b(0xbaa),'content':_0x1d118b(0x306)+_0x57fbb8+']','timestamp':Date[_0x1d118b(0x12d6)](),'isHidden':!![]};_0x55066c[_0x1d118b(0x7d3)][_0x1d118b(0x1a0)](_0x22806c),await _0xb81d4e[_0x1d118b(0x1027)][_0x1d118b(0x5d0)](_0x55066c),_0x474d6b(_0x505390[_0x1d118b(0x233)]),_0x1b7f69();}}),document[_0x494435(0x479)](_0x494435(0x189))[_0x494435(0xa75)]('click',async()=>{const _0x218530=_0x494435;if(_0x373eab[_0x218530(0xa7a)]===0x0)return;const _0x36bb27=await _0x1a9e79(_0x218530(0x1365),_0x218530(0x1109)+_0x373eab[_0x218530(0xa7a)]+'\x20条消息，AI将完全遗忘它们的存在。确定吗？',{'confirmButtonClass':_0x218530(0x95a),'confirmText':'确认抹除'});if(_0x36bb27){const _0x113925=_0x505390[_0x218530(0x1027)][_0x505390[_0x218530(0x233)]];_0x113925[_0x218530(0x7d3)]=_0x113925[_0x218530(0x7d3)][_0x218530(0x85d)](_0x22efc8=>!_0x373eab['has'](_0x22efc8['timestamp'])),await _0xb81d4e[_0x218530(0x1027)][_0x218530(0x5d0)](_0x113925),_0x474d6b(_0x505390[_0x218530(0x233)]),_0x1b7f69();}});const _0x8dc4e=document[_0x494435(0x479)](_0x494435(0x13e0));_0x8dc4e[_0x494435(0xa75)](_0x494435(0xa01),()=>_0x57f4d5(_0x8dc4e[_0x494435(0x4e0)]['trim'](),!![])),document[_0x494435(0x479)](_0x494435(0x1202))['addEventListener'](_0x494435(0xd2f),async()=>{const _0x364ddc=_0x494435,_0x5da09e=_0x8dc4e[_0x364ddc(0x4e0)][_0x364ddc(0x9c1)]();if(!_0x5da09e){alert('请输入有效的字体URL。');return;}_0x57f4d5(_0x5da09e,![]),_0x505390[_0x364ddc(0x888)][_0x364ddc(0x69a)]=_0x5da09e,await _0xb81d4e[_0x364ddc(0x888)][_0x364ddc(0x5d0)](_0x505390[_0x364ddc(0x888)]),alert(_0x364ddc(0x6ba));}),document['getElementById'](_0x494435(0xca2))[_0x494435(0xa75)](_0x494435(0xd2f),_0x2dbe36),document[_0x494435(0x99e)](_0x494435(0x692))[_0x494435(0x12be)](_0x36a0a9=>{const _0x48a164=_0x494435;_0x36a0a9[_0x48a164(0xa75)]('click',()=>_0x104a0f(_0x36a0a9[_0x48a164(0x13d4)]['view']));}),document[_0x494435(0x479)]('qzone-back-btn')[_0x494435(0xa75)](_0x494435(0xd2f),()=>_0x104a0f('messages-view')),document[_0x494435(0x479)](_0x494435(0x913))[_0x494435(0xa75)]('click',async()=>{const _0x452a7d=_0x494435,_0x46129e=await _0x9a2c09(_0x452a7d(0x9db),_0x452a7d(0x468),_0x505390['qzoneSettings'][_0x452a7d(0x904)]);_0x46129e&&_0x46129e[_0x452a7d(0x9c1)]()&&(_0x505390[_0x452a7d(0x1190)][_0x452a7d(0x904)]=_0x46129e[_0x452a7d(0x9c1)](),await _0x1d3d0a(),_0xad28fe());}),document[_0x494435(0x479)](_0x494435(0x1360))[_0x494435(0xa75)](_0x494435(0xd2f),()=>document[_0x494435(0x479)](_0x494435(0x321))[_0x494435(0xd2f)]()),document[_0x494435(0x479)](_0x494435(0x116f))[_0x494435(0xa75)](_0x494435(0xd2f),()=>document['getElementById'](_0x494435(0xfe0))[_0x494435(0xd2f)]()),document['getElementById']('qzone-avatar-input')['addEventListener'](_0x494435(0x1150),async _0xfba75f=>{const _0x360b66=_0x494435,_0x4f9176=_0xfba75f['target']['files'][0x0];if(_0x4f9176){const _0x3d252d=await new Promise(_0x361eec=>{const _0x33b156=_0x6666,_0x16cd0c=new FileReader();_0x16cd0c[_0x33b156(0x502)]=()=>_0x361eec(_0x16cd0c[_0x33b156(0x97e)]),_0x16cd0c[_0x33b156(0x83c)](_0x4f9176);});_0x505390['qzoneSettings'][_0x360b66(0x799)]=_0x3d252d,await _0x1d3d0a(),_0xad28fe();}_0xfba75f['target'][_0x360b66(0x4e0)]=null;}),document[_0x494435(0x479)](_0x494435(0xfe0))['addEventListener'](_0x494435(0x1150),async _0x35a572=>{const _0x3d7377=_0x494435,_0x30bd9f=_0x35a572[_0x3d7377(0xfa2)][_0x3d7377(0xe63)][0x0];if(_0x30bd9f){const _0x3206e2=await new Promise(_0x54f13a=>{const _0x1cc2dc=_0x3d7377,_0x25df70=new FileReader();_0x25df70[_0x1cc2dc(0x502)]=()=>_0x54f13a(_0x25df70['result']),_0x25df70['readAsDataURL'](_0x30bd9f);});_0x505390[_0x3d7377(0x1190)]['banner']=_0x3206e2,await _0x1d3d0a(),_0xad28fe();}_0x35a572[_0x3d7377(0xfa2)]['value']=null;}),document[_0x494435(0x479)]('create-shuoshuo-btn')[_0x494435(0xa75)]('click',async()=>{const _0x5b1d53=_0x494435;_0x2a8e48();const _0x3da764=document[_0x5b1d53(0x479)]('create-post-modal');_0x3da764[_0x5b1d53(0x13d4)][_0x5b1d53(0xb99)]=_0x5b1d53(0x395),_0x3da764[_0x5b1d53(0x8bc)](_0x5b1d53(0xfb8))[_0x5b1d53(0x10dd)]['display']=_0x5b1d53(0xff8),_0x3da764[_0x5b1d53(0x8bc)](_0x5b1d53(0x6ce))[_0x5b1d53(0x10dd)][_0x5b1d53(0x678)]=_0x5b1d53(0xff8),_0x3da764[_0x5b1d53(0x8bc)]('#text-image-mode-content')[_0x5b1d53(0x10dd)][_0x5b1d53(0x678)]=_0x5b1d53(0xff8),_0x3da764[_0x5b1d53(0x8bc)](_0x5b1d53(0xc25))['placeholder']=_0x5b1d53(0x441);const _0x93a255=document[_0x5b1d53(0x479)](_0x5b1d53(0x116a));_0x93a255[_0x5b1d53(0x3de)]='';const _0x2d65ab=await _0xb81d4e[_0x5b1d53(0xbce)]['toArray']();_0x2d65ab['length']>0x0?_0x2d65ab[_0x5b1d53(0x12be)](_0x4795e1=>{const _0x2740de=_0x5b1d53,_0x1b9bdb=document[_0x2740de(0xbd5)]('label');_0x1b9bdb['style'][_0x2740de(0x678)]='block',_0x1b9bdb['innerHTML']='<input\x20type=\x22checkbox\x22\x20name=\x22visibility_group\x22\x20value=\x22'+_0x4795e1['id']+_0x2740de(0x219)+_0x4795e1['name'],_0x93a255[_0x2740de(0x9f4)](_0x1b9bdb);}):_0x93a255[_0x5b1d53(0x3de)]='<p\x20style=\x22color:\x20var(--text-secondary);\x22>没有可用的分组</p>',_0x3da764['classList'][_0x5b1d53(0x807)](_0x5b1d53(0x45a));}),document['getElementById'](_0x494435(0xb4c))[_0x494435(0xa75)](_0x494435(0xd2f),async()=>{const _0x568e5a=_0x494435;_0x2a8e48();const _0x14a345=document['getElementById'](_0x568e5a(0x1066));_0x14a345['dataset'][_0x568e5a(0xb99)]=_0x568e5a(0xf00),_0x14a345[_0x568e5a(0x8bc)]('.post-mode-switcher')[_0x568e5a(0x10dd)][_0x568e5a(0x678)]=_0x568e5a(0x899),_0x14a345[_0x568e5a(0x8bc)](_0x568e5a(0x6ce))['classList']['add'](_0x568e5a(0x5a9)),_0x14a345['querySelector'](_0x568e5a(0xa68))[_0x568e5a(0x9cd)][_0x568e5a(0x8b6)](_0x568e5a(0x5a9)),_0x14a345[_0x568e5a(0x8bc)](_0x568e5a(0xc25))[_0x568e5a(0xe77)]=_0x568e5a(0xa52);const _0x1e13b2=document[_0x568e5a(0x479)](_0x568e5a(0x116a));_0x1e13b2[_0x568e5a(0x3de)]='';const _0x260771=await _0xb81d4e[_0x568e5a(0xbce)][_0x568e5a(0x4ba)]();_0x260771['length']>0x0?_0x260771[_0x568e5a(0x12be)](_0x435059=>{const _0x38b282=_0x568e5a,_0x558944=document[_0x38b282(0xbd5)](_0x38b282(0xfac));_0x558944[_0x38b282(0x10dd)][_0x38b282(0x678)]=_0x38b282(0xee3),_0x558944[_0x38b282(0x3de)]=_0x38b282(0x1209)+_0x435059['id']+_0x38b282(0x219)+_0x435059[_0x38b282(0x564)],_0x1e13b2[_0x38b282(0x9f4)](_0x558944);}):_0x1e13b2[_0x568e5a(0x3de)]=_0x568e5a(0x202),_0x14a345[_0x568e5a(0x9cd)][_0x568e5a(0x807)](_0x568e5a(0x45a));}),document[_0x494435(0x479)](_0x494435(0xaca))['addEventListener']('click',async()=>{const _0x3496bc=_0x494435;await _0x118dd8(),_0x731d5(_0x3496bc(0x428));}),document[_0x494435(0x479)](_0x494435(0x134b))['addEventListener'](_0x494435(0xd2f),()=>{const _0x3ce321=_0x494435;_0x731d5('chat-list-screen'),_0x104a0f(_0x3ce321(0xc8d));}),document[_0x494435(0x479)](_0x494435(0x905))['addEventListener']('click',()=>{const _0x4fdb7b=_0x494435;_0x505390[_0x4fdb7b(0x3dc)]=null,_0x731d5(_0x4fdb7b(0x428));}),document[_0x494435(0x479)](_0x494435(0x948))[_0x494435(0xa75)]('click',()=>document[_0x494435(0x479)](_0x494435(0x47b))[_0x494435(0xd2f)]()),document[_0x494435(0x479)](_0x494435(0x47b))[_0x494435(0xa75)]('change',async _0x403351=>{const _0x5c3206=_0x494435;if(!_0x505390[_0x5c3206(0x3dc)])return;const _0x26fb6f=_0x403351[_0x5c3206(0xfa2)][_0x5c3206(0xe63)];if(!_0x26fb6f[_0x5c3206(0x990)])return;const _0x2e4bc2=await _0xb81d4e['qzoneAlbums'][_0x5c3206(0x111a)](_0x505390[_0x5c3206(0x3dc)]);for(const _0x2f60ba of _0x26fb6f){const _0x293022=await new Promise(_0x4c64e3=>{const _0x18424a=_0x5c3206,_0x5a4908=new FileReader();_0x5a4908[_0x18424a(0x502)]=()=>_0x4c64e3(_0x5a4908[_0x18424a(0x97e)]),_0x5a4908[_0x18424a(0x83c)](_0x2f60ba);});await _0xb81d4e[_0x5c3206(0x340)][_0x5c3206(0x807)]({'albumId':_0x505390[_0x5c3206(0x3dc)],'url':_0x293022,'createdAt':Date[_0x5c3206(0x12d6)]()});}const _0x38c55c=await _0xb81d4e[_0x5c3206(0x340)][_0x5c3206(0x46f)](_0x5c3206(0x127c))[_0x5c3206(0x4a2)](_0x505390[_0x5c3206(0x3dc)])[_0x5c3206(0x32f)](),_0x1a6673={'photoCount':_0x38c55c};if(!_0x2e4bc2['photoCount']||_0x2e4bc2[_0x5c3206(0x370)][_0x5c3206(0x44f)]('placeholder')){const _0x34f7b4=await _0xb81d4e[_0x5c3206(0x340)][_0x5c3206(0x46f)](_0x5c3206(0x127c))[_0x5c3206(0x4a2)](_0x505390[_0x5c3206(0x3dc)])[_0x5c3206(0x64e)]();if(_0x34f7b4)_0x1a6673[_0x5c3206(0x370)]=_0x34f7b4[_0x5c3206(0x5f3)];}await _0xb81d4e[_0x5c3206(0xdf4)]['update'](_0x505390[_0x5c3206(0x3dc)],_0x1a6673),await _0x25856b(),await _0x118dd8(),_0x403351['target'][_0x5c3206(0x4e0)]=null,alert(_0x5c3206(0x13de));}),document[_0x494435(0x479)]('photos-grid-page')[_0x494435(0xa75)](_0x494435(0xd2f),async _0x40706f=>{const _0x42eb5c=_0x494435,_0x338eda=_0x40706f[_0x42eb5c(0xfa2)][_0x42eb5c(0x869)](_0x42eb5c(0x113f)),_0x50a660=_0x40706f[_0x42eb5c(0xfa2)][_0x42eb5c(0x869)](_0x42eb5c(0x8ca));if(_0x338eda){_0x40706f['stopPropagation']();const _0x268f9b=parseInt(_0x338eda['dataset']['photoId']),_0x2354a6=await _0x1a9e79('删除照片','确定要删除这张照片吗？此操作不可恢复。',{'confirmButtonClass':'btn-danger'});if(_0x2354a6){const _0x23761f=await _0xb81d4e['qzonePhotos'][_0x42eb5c(0x111a)](_0x268f9b);if(!_0x23761f)return;await _0xb81d4e[_0x42eb5c(0x340)][_0x42eb5c(0x1ea)](_0x268f9b);const _0x3d5aff=await _0xb81d4e[_0x42eb5c(0xdf4)][_0x42eb5c(0x111a)](_0x505390[_0x42eb5c(0x3dc)]),_0x24ca33=(_0x3d5aff['photoCount']||0x1)-0x1,_0x534f28={'photoCount':_0x24ca33};if(_0x3d5aff[_0x42eb5c(0x370)]===_0x23761f[_0x42eb5c(0x5f3)]){const _0x3b913c=await _0xb81d4e[_0x42eb5c(0x340)]['where'](_0x42eb5c(0x127c))['equals'](_0x505390[_0x42eb5c(0x3dc)])[_0x42eb5c(0x64e)]();_0x534f28[_0x42eb5c(0x370)]=_0x3b913c?_0x3b913c[_0x42eb5c(0x5f3)]:_0x42eb5c(0x11dd);}await _0xb81d4e['qzoneAlbums'][_0x42eb5c(0xeb2)](_0x505390[_0x42eb5c(0x3dc)],_0x534f28),await _0x25856b(),await _0x118dd8(),alert(_0x42eb5c(0xbd9));}}else _0x50a660&&_0x30f87f(_0x50a660['src']);}),document[_0x494435(0x479)](_0x494435(0xac1))[_0x494435(0xa75)](_0x494435(0xd2f),_0x11805e),document[_0x494435(0x479)](_0x494435(0xb16))[_0x494435(0xa75)](_0x494435(0xd2f),_0x592426),document[_0x494435(0x479)](_0x494435(0x702))[_0x494435(0xa75)](_0x494435(0xd2f),_0x4adc96),document[_0x494435(0xa75)](_0x494435(0x3e0),_0x519b18=>{const _0x1f2789=_0x494435;if(!_0x4a2783[_0x1f2789(0xeb9)])return;if(_0x519b18['key']==='ArrowRight')_0x592426();else{if(_0x519b18['key']===_0x1f2789(0xa14))_0x4adc96();else _0x519b18[_0x1f2789(0x4f3)]===_0x1f2789(0x13f3)&&_0x11805e();}}),document[_0x494435(0x479)]('create-album-btn-page')[_0x494435(0xa75)](_0x494435(0xd2f),async()=>{const _0x248a66=_0x494435,_0x15af79=await _0x9a2c09(_0x248a66(0x819),'请输入相册名称');if(_0x15af79&&_0x15af79[_0x248a66(0x9c1)]()){const _0x3471bd={'name':_0x15af79[_0x248a66(0x9c1)](),'coverUrl':_0x248a66(0x11dd),'photoCount':0x0,'createdAt':Date['now']()};await _0xb81d4e[_0x248a66(0xdf4)][_0x248a66(0x807)](_0x3471bd),await _0x118dd8(),alert(_0x248a66(0x6b4)+_0x15af79+_0x248a66(0x6b0));}else _0x15af79!==null&&alert(_0x248a66(0x74c));}),document['getElementById'](_0x494435(0x35c))[_0x494435(0xa75)](_0x494435(0xd2f),()=>document[_0x494435(0x479)]('create-post-modal')[_0x494435(0x9cd)][_0x494435(0x8b6)](_0x494435(0x45a))),document['getElementById'](_0x494435(0x708))[_0x494435(0xa75)]('click',()=>document[_0x494435(0x479)](_0x494435(0xdfb))[_0x494435(0xd2f)]()),document['getElementById'](_0x494435(0xdfb))['addEventListener'](_0x494435(0x1150),_0x120cbf=>{const _0x5da2f9=_0x494435,_0x5725e3=_0x120cbf[_0x5da2f9(0xfa2)][_0x5da2f9(0xe63)][0x0];if(_0x5725e3){const _0x34c259=new FileReader();_0x34c259[_0x5da2f9(0x502)]=_0x1ff950=>{const _0x13603a=_0x5da2f9;document[_0x13603a(0x479)]('post-image-preview')['src']=_0x1ff950[_0x13603a(0xfa2)][_0x13603a(0x97e)],document['getElementById'](_0x13603a(0x13b4))[_0x13603a(0x9cd)][_0x13603a(0x807)]('visible'),document[_0x13603a(0x479)](_0x13603a(0xaae))[_0x13603a(0x10dd)]['display']='block';},_0x34c259[_0x5da2f9(0x83c)](_0x5725e3);}}),document[_0x494435(0x479)](_0x494435(0x1241))['addEventListener'](_0x494435(0xd2f),async()=>{const _0x5ca404=_0x494435,_0x281458=await _0x9a2c09(_0x5ca404(0xf8e),'请输入网络图片的链接','',_0x5ca404(0x5f3));_0x281458&&(document[_0x5ca404(0x479)](_0x5ca404(0x13bc))['src']=_0x281458,document[_0x5ca404(0x479)](_0x5ca404(0x13b4))[_0x5ca404(0x9cd)][_0x5ca404(0x807)](_0x5ca404(0x45a)),document['getElementById'](_0x5ca404(0xaae))[_0x5ca404(0x10dd)]['display']=_0x5ca404(0xee3));}),document[_0x494435(0x479)](_0x494435(0x226))['addEventListener'](_0x494435(0xd2f),()=>_0x2a8e48());const _0x4be558=document[_0x494435(0x479)](_0x494435(0xe89)),_0x256a25=document[_0x494435(0x479)](_0x494435(0xecf)),_0x5a0a6b=document[_0x494435(0x479)](_0x494435(0x6d7)),_0x1cea3c=document[_0x494435(0x479)](_0x494435(0x897));_0x4be558[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x23b703=_0x494435;_0x4be558['classList'][_0x23b703(0x807)]('active'),_0x256a25[_0x23b703(0x9cd)][_0x23b703(0x8b6)](_0x23b703(0x5a9)),_0x5a0a6b[_0x23b703(0x9cd)][_0x23b703(0x807)](_0x23b703(0x5a9)),_0x1cea3c[_0x23b703(0x9cd)][_0x23b703(0x8b6)](_0x23b703(0x5a9));}),_0x256a25[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x1f5d24=_0x494435;_0x256a25[_0x1f5d24(0x9cd)][_0x1f5d24(0x807)](_0x1f5d24(0x5a9)),_0x4be558['classList'][_0x1f5d24(0x8b6)]('active'),_0x1cea3c[_0x1f5d24(0x9cd)]['add']('active'),_0x5a0a6b['classList'][_0x1f5d24(0x8b6)]('active');}),document[_0x494435(0x479)](_0x494435(0x39a))[_0x494435(0xa75)]('click',async()=>{const _0x3fe48d=_0x494435,_0x54e50a=document['getElementById'](_0x3fe48d(0x1066)),_0x2ff87d=_0x54e50a['dataset']['mode'],_0x37fcd1=document[_0x3fe48d(0x8bc)]('input[name=\x22visibility\x22]:checked')['value'];let _0x62f2f=null;_0x37fcd1===_0x3fe48d(0x13a1)&&(_0x62f2f=Array['from'](document[_0x3fe48d(0x99e)](_0x3fe48d(0x1334)))[_0x3fe48d(0x2e1)](_0x139edf=>parseInt(_0x139edf['value'])));let _0x4b3173={};const _0x2cead8={'timestamp':Date[_0x3fe48d(0x12d6)](),'authorId':_0x3fe48d(0x4c5),'visibleGroupIds':_0x62f2f};if(_0x2ff87d===_0x3fe48d(0x395)){const _0x30b8ee=document[_0x3fe48d(0x479)]('post-public-text')['value'][_0x3fe48d(0x9c1)]();if(!_0x30b8ee){alert(_0x3fe48d(0x133c));return;}_0x4b3173={..._0x2cead8,'type':'shuoshuo','content':_0x30b8ee};}else{const _0x41fb1c=document[_0x3fe48d(0x479)]('post-public-text')[_0x3fe48d(0x4e0)][_0x3fe48d(0x9c1)](),_0x5a8086=document[_0x3fe48d(0x479)](_0x3fe48d(0x6d7))[_0x3fe48d(0x9cd)][_0x3fe48d(0x658)](_0x3fe48d(0x5a9));if(_0x5a8086){const _0x407111=document[_0x3fe48d(0x479)](_0x3fe48d(0x13bc))[_0x3fe48d(0xa9c)],_0xfe1565=document[_0x3fe48d(0x479)](_0x3fe48d(0x26b))['value']['trim']();if(!_0x407111||!(_0x407111['startsWith'](_0x3fe48d(0xc6c))||_0x407111['startsWith']('data:'))){alert(_0x3fe48d(0x953));return;}if(!_0xfe1565){alert(_0x3fe48d(0x734));return;}_0x4b3173={..._0x2cead8,'type':_0x3fe48d(0x133a),'publicText':_0x41fb1c,'imageUrl':_0x407111,'imageDescription':_0xfe1565};}else{const _0x4559b4=document['getElementById'](_0x3fe48d(0xaea))[_0x3fe48d(0x4e0)][_0x3fe48d(0x9c1)]();if(!_0x4559b4){alert(_0x3fe48d(0xaff));return;}_0x4b3173={..._0x2cead8,'type':_0x3fe48d(0xd84),'publicText':_0x41fb1c,'hiddenContent':_0x4559b4};}}const _0x2d1c41=await _0xb81d4e['qzonePosts']['add'](_0x4b3173);let _0x1e8f19=_0x4b3173['content']||_0x4b3173['publicText']||_0x4b3173[_0x3fe48d(0x11a4)]||_0x4b3173[_0x3fe48d(0x112d)]||_0x3fe48d(0x7a2);_0x1e8f19=_0x1e8f19[_0x3fe48d(0x1323)](0x0,0x32)+(_0x1e8f19[_0x3fe48d(0x990)]>0x32?_0x3fe48d(0x4d0):'');for(const _0x1c0a9d in _0x505390[_0x3fe48d(0x1027)]){const _0x312284=_0x505390[_0x3fe48d(0x1027)][_0x1c0a9d];if(_0x312284[_0x3fe48d(0x9d7)])continue;let _0x575000=![];const _0x57fbbf=_0x4b3173['visibleGroupIds'];if(!_0x57fbbf||_0x57fbbf[_0x3fe48d(0x990)]===0x0)_0x575000=!![];else _0x312284['groupId']&&_0x57fbbf[_0x3fe48d(0x44f)](_0x312284[_0x3fe48d(0x194)])&&(_0x575000=!![]);if(_0x575000){const _0x37c232={'role':_0x3fe48d(0xbaa),'content':_0x3fe48d(0x1198)+_0x2d1c41+')，内容摘要是：“'+_0x1e8f19+_0x3fe48d(0x21c),'timestamp':Date[_0x3fe48d(0x12d6)](),'isHidden':!![]};_0x312284[_0x3fe48d(0x7d3)]['push'](_0x37c232),await _0xb81d4e[_0x3fe48d(0x1027)][_0x3fe48d(0x5d0)](_0x312284);}}await _0x2eb20b(),_0x54e50a[_0x3fe48d(0x9cd)][_0x3fe48d(0x8b6)](_0x3fe48d(0x45a)),alert('动态发布成功！');});const _0x34eecc=document[_0x494435(0x479)]('qzone-posts-list');let _0x6da2ad={'isDragging':![],'startX':0x0,'startY':0x0,'currentX':0x0,'activeContainer':null,'swipeDirection':null,'isClick':!![]};function _0x4f1400(_0x13fd74=null){const _0x106bd9=_0x494435;document[_0x106bd9(0x99e)](_0x106bd9(0x662))[_0x106bd9(0x12be)](_0x43d25b=>{const _0x330cf3=_0x106bd9;_0x43d25b!==_0x13fd74&&_0x43d25b[_0x330cf3(0x8bc)](_0x330cf3(0xe11))['classList']['remove'](_0x330cf3(0x878));});}async function _0x4f8191(_0xfa966e){const _0x423b2a=_0x494435;_0xfa966e['stopPropagation']();const _0x5be316=_0xfa966e[_0x423b2a(0xfa2)],_0x9a6007=_0x5be316[_0x423b2a(0x869)]('.comment-delete-btn');if(_0x9a6007){const _0x5d73e9=_0x9a6007[_0x423b2a(0x869)]('.qzone-post-container'),_0x369cf5=parseInt(_0x5d73e9['dataset']['postId']),_0x1ee5aa=parseInt(_0x9a6007[_0x423b2a(0x13d4)]['commentIndex']);if(isNaN(_0x369cf5)||isNaN(_0x1ee5aa))return;const _0x3d19c1=_0x5a98bc[_0x423b2a(0xc0d)](_0x204cad=>_0x204cad['id']===_0x369cf5);if(!_0x3d19c1||!_0x3d19c1['comments']||!_0x3d19c1[_0x423b2a(0xd3c)][_0x1ee5aa])return;const _0xd450b8=_0x3d19c1[_0x423b2a(0xd3c)][_0x1ee5aa],_0x5f020c=await _0x1a9e79(_0x423b2a(0xa38),_0x423b2a(0x1ff),{'confirmButtonClass':_0x423b2a(0x95a)});if(_0x5f020c){_0x3d19c1['comments']['splice'](_0x1ee5aa,0x1),await _0xb81d4e[_0x423b2a(0xcce)][_0x423b2a(0xeb2)](_0x369cf5,{'comments':_0x3d19c1['comments']});if(_0xd450b8&&_0xd450b8['commenterName']===_0x505390[_0x423b2a(0x1190)][_0x423b2a(0x904)]){console[_0x423b2a(0x90f)]('用户删除了自己的评论，开始清理AI记忆...');const _0x285bcc=new Set();_0x3d19c1[_0x423b2a(0x981)]!==_0x423b2a(0x4c5)&&_0x285bcc['add'](_0x3d19c1[_0x423b2a(0x981)]);if(_0xd450b8['replyTo']){const _0x46a8a1=Object[_0x423b2a(0x3d5)](_0x505390[_0x423b2a(0x1027)])[_0x423b2a(0xc0d)](_0x3ca4f9=>_0x3ca4f9[_0x423b2a(0xe2d)]===_0xd450b8[_0x423b2a(0x32a)]);_0x46a8a1&&_0x285bcc['add'](_0x46a8a1['id']);}const _0x5784ca=(_0x3d19c1['publicText']||_0x3d19c1[_0x423b2a(0xac4)]||'')[_0x423b2a(0x1323)](0x0,0x1e),_0x48a388=_0x505390['qzoneSettings']['nickname'];let _0x37e374;const _0x5be00d=_0x505390['userStickers'][_0x423b2a(0xc0d)](_0x56a90a=>_0x56a90a[_0x423b2a(0x5f3)]===_0xd450b8['text']);if(_0x5be00d)_0x37e374=_0x423b2a(0xd59)+_0x48a388+_0x423b2a(0x97c)+_0x5784ca+_0x423b2a(0x588)+_0x5be00d[_0x423b2a(0x564)]+'”。';else{if(_0xd450b8[_0x423b2a(0x32a)]){const _0x2e033b=_0x148d9b(_0xd450b8[_0x423b2a(0x32a)]);_0x37e374=_0x423b2a(0xd59)+_0x48a388+'\x27刚刚在你的动态“'+_0x5784ca+_0x423b2a(0x11cc)+_0x2e033b+_0x423b2a(0xeb1)+_0xd450b8[_0x423b2a(0x56d)]+'”。';}else _0x37e374=_0x423b2a(0xd59)+_0x48a388+_0x423b2a(0x1380)+_0x5784ca+'”，内容是：“'+_0xd450b8['text']+'”。';}const _0x1048e1=_0x423b2a(0x306)+_0x37e374+'请你对此作出回应。]';for(const _0x5be015 of _0x285bcc){const _0x36dc75=_0x505390[_0x423b2a(0x1027)][_0x5be015];if(_0x36dc75){const _0xc383a5=_0x36dc75[_0x423b2a(0x7d3)][_0x423b2a(0x990)];_0x36dc75['history']=_0x36dc75['history'][_0x423b2a(0x85d)](_0x2551bb=>!(_0x2551bb[_0x423b2a(0xb9c)]&&_0x2551bb[_0x423b2a(0x508)]===_0x423b2a(0xbaa)&&_0x2551bb[_0x423b2a(0xac4)]===_0x1048e1)),_0x36dc75['history']['length']<_0xc383a5&&(console['log']('在角色\x20\x22'+_0x36dc75[_0x423b2a(0x564)]+'\x22\x20的记忆中清除了1条关于已删除评论的通知。'),await _0xb81d4e['chats'][_0x423b2a(0x5d0)](_0x36dc75));}}}await _0x7cb448(_0x369cf5);}return;}const _0x20d2a2=_0x5be316[_0x423b2a(0x869)](_0x423b2a(0x58b));if(_0x20d2a2){const _0x5e2213=_0x20d2a2['closest'](_0x423b2a(0x662));if(!_0x5e2213)return;const _0x5df678=parseInt(_0x5e2213[_0x423b2a(0x13d4)][_0x423b2a(0x403)]);_0x50f1ba[_0x423b2a(0xeb9)]&&_0x50f1ba['activePostId']===_0x5df678?_0x3a8fa4():_0x5c0317(_0x5df678,_0x20d2a2);return;}const _0x2a28a5=_0x5be316[_0x423b2a(0x869)](_0x423b2a(0xb3f));if(_0x2a28a5){const _0x4362eb=parseInt(_0x2a28a5[_0x423b2a(0x13d4)][_0x423b2a(0x403)]),_0x4f1713=_0x2a28a5[_0x423b2a(0x13d4)][_0x423b2a(0xed3)],_0x16baa2=_0x2a28a5['dataset'][_0x423b2a(0x13a6)];if(!_0x4f1713||!_0x16baa2||_0x4f1713===_0x505390[_0x423b2a(0x1190)][_0x423b2a(0x904)]){_0x54b53c(_0x2a28a5['closest'](_0x423b2a(0x662)));return;}_0xaa9aca={'postId':_0x4362eb,'replyToName':_0x4f1713,'replyToDisplayName':_0x16baa2};const _0x1cd364=_0x2a28a5[_0x423b2a(0x869)]('.qzone-post-container'),_0x510706=_0x1cd364[_0x423b2a(0x8bc)]('.comment-input');_0x510706[_0x423b2a(0xe77)]=_0x423b2a(0xce5)+_0x16baa2+':',_0x510706[_0x423b2a(0xc07)]();return;}if(_0x5be316[_0x423b2a(0x9cd)][_0x423b2a(0x658)](_0x423b2a(0x89a))){const _0x1d6aab=_0x5be316[_0x423b2a(0x869)](_0x423b2a(0x662));if(_0x1d6aab&&_0x1d6aab['dataset'][_0x423b2a(0x403)])_0x5360ea(parseInt(_0x1d6aab[_0x423b2a(0x13d4)][_0x423b2a(0x403)]));return;}if(_0x5be316[_0x423b2a(0x612)]===_0x423b2a(0x42d)&&_0x5be316['dataset'][_0x423b2a(0x1059)]){_0x1519c8(_0x423b2a(0x35b),_0x5be316['dataset'][_0x423b2a(0x1059)][_0x423b2a(0x491)](/<br>/g,'\x0a'));return;}const _0x4f4aa3=_0x5be316[_0x423b2a(0x869)](_0x423b2a(0x662));if(!_0x4f4aa3)return;const _0x410af6=parseInt(_0x4f4aa3[_0x423b2a(0x13d4)][_0x423b2a(0x403)]);if(isNaN(_0x410af6))return;if(_0x5be316[_0x423b2a(0x869)](_0x423b2a(0x12ee))){const _0x17c695=await _0x1a9e79('删除动态',_0x423b2a(0xe2f),{'confirmButtonClass':_0x423b2a(0x95a)});_0x17c695&&(_0x4f4aa3['style'][_0x423b2a(0xe23)]=_0x423b2a(0x95d),_0x4f4aa3['style'][_0x423b2a(0x87a)]='scale(0.8)',_0x4f4aa3[_0x423b2a(0x10dd)][_0x423b2a(0x939)]='0',setTimeout(async()=>{const _0xc65045=_0x423b2a;await _0xb81d4e['qzonePosts'][_0xc65045(0x1ea)](_0x410af6);const _0x328c17='(ID:\x20'+_0x410af6+')';for(const _0x2315e9 in _0x505390[_0xc65045(0x1027)]){const _0x2bbcba=_0x505390['chats'][_0x2315e9],_0x84edb1=_0x2bbcba[_0xc65045(0x7d3)][_0xc65045(0x990)];_0x2bbcba['history']=_0x2bbcba['history'][_0xc65045(0x85d)](_0x5f3c14=>!(_0x5f3c14['role']==='system'&&_0x5f3c14[_0xc65045(0xac4)][_0xc65045(0x44f)](_0x328c17)));if(_0x2bbcba[_0xc65045(0x7d3)][_0xc65045(0x990)]<_0x84edb1)await _0xb81d4e[_0xc65045(0x1027)][_0xc65045(0x5d0)](_0x2bbcba);}await _0x2eb20b(),alert('动态已删除。');},0x12c));return;}const _0xad62b7=_0x5be316['closest'](_0x423b2a(0x828));if(_0xad62b7){if(_0xad62b7['classList'][_0x423b2a(0x658)](_0x423b2a(0xe30))){_0xca3fea(_0x410af6);return;}if(_0xad62b7[_0x423b2a(0x9cd)][_0x423b2a(0x658)]('like')){const _0x35f386=_0x5a98bc[_0x423b2a(0xc0d)](_0x1bb0ad=>_0x1bb0ad['id']===_0x410af6);if(!_0x35f386)return;if(!_0x35f386[_0x423b2a(0x12e3)])_0x35f386[_0x423b2a(0x12e3)]=[];const _0x5d6553=_0x505390[_0x423b2a(0x1190)][_0x423b2a(0x904)],_0x3a392b=_0x35f386[_0x423b2a(0x12e3)][_0x423b2a(0xf2f)](_0x5d6553);_0x3a392b>-0x1?_0x35f386[_0x423b2a(0x12e3)][_0x423b2a(0x118e)](_0x3a392b,0x1):(_0x35f386['likes'][_0x423b2a(0x1a0)](_0x5d6553),_0xad62b7[_0x423b2a(0x9cd)][_0x423b2a(0x807)](_0x423b2a(0x654)),_0xad62b7['addEventListener'](_0x423b2a(0xcd4),()=>_0xad62b7[_0x423b2a(0x9cd)][_0x423b2a(0x8b6)](_0x423b2a(0x654)),{'once':!![]})),await _0xb81d4e[_0x423b2a(0xcce)]['update'](_0x410af6,{'likes':_0x35f386['likes']}),await _0x7cb448(_0x410af6);}if(_0xad62b7['classList']['contains'](_0x423b2a(0x120d))){const _0x192b01=await _0xb81d4e[_0x423b2a(0x3e8)]['where']({'type':'qzone_post','content.id':_0x410af6})['first']();if(_0x192b01)await _0xb81d4e[_0x423b2a(0x3e8)][_0x423b2a(0x1ea)](_0x192b01['id']),await _0x1519c8('提示','已取消收藏');else{const _0x415524=await _0xb81d4e[_0x423b2a(0xcce)][_0x423b2a(0x111a)](_0x410af6);_0x415524&&(await _0xb81d4e['favorites'][_0x423b2a(0x807)]({'type':_0x423b2a(0x239),'content':_0x415524,'timestamp':Date[_0x423b2a(0x12d6)]()}),await _0x1519c8('提示',_0x423b2a(0x13bb)));}await _0x7cb448(_0x410af6);}return;}const _0x1e1c7f=_0x5be316[_0x423b2a(0x869)](_0x423b2a(0x854));if(_0x1e1c7f){const _0x27a0b3=_0x4f4aa3[_0x423b2a(0x8bc)](_0x423b2a(0x127d)),_0x78b2ce=_0x27a0b3[_0x423b2a(0x4e0)][_0x423b2a(0x9c1)]();if(!_0x78b2ce)return alert(_0x423b2a(0x873));const _0x458fb9=_0x5a98bc['find'](_0x41e3ec=>_0x41e3ec['id']===_0x410af6);if(!_0x458fb9)return;if(!_0x458fb9[_0x423b2a(0xd3c)])_0x458fb9[_0x423b2a(0xd3c)]=[];const _0x369a4c={'commenterName':_0x505390[_0x423b2a(0x1190)][_0x423b2a(0x904)],'text':_0x78b2ce,'timestamp':Date['now'](),'replyTo':_0xaa9aca&&_0xaa9aca[_0x423b2a(0x403)]===_0x410af6?_0xaa9aca[_0x423b2a(0x1251)]:null};_0x458fb9['comments'][_0x423b2a(0x1a0)](_0x369a4c),await _0xb81d4e[_0x423b2a(0xcce)][_0x423b2a(0xeb2)](_0x410af6,{'comments':_0x458fb9[_0x423b2a(0xd3c)]});let _0x527647=(_0x458fb9[_0x423b2a(0x105a)]||_0x458fb9[_0x423b2a(0xac4)]||'')[_0x423b2a(0x1323)](0x0,0x1e);const _0x290fc7=_0x505390['qzoneSettings']['nickname'],_0x5e90cd=new Set();if(_0x458fb9[_0x423b2a(0x981)]!==_0x423b2a(0x4c5))_0x5e90cd[_0x423b2a(0x807)](_0x458fb9['authorId']);if(_0x369a4c[_0x423b2a(0x32a)]&&_0x369a4c[_0x423b2a(0x32a)]!==_0x290fc7){const _0x36f7f5=Object[_0x423b2a(0x3d5)](_0x505390[_0x423b2a(0x1027)])[_0x423b2a(0xc0d)](_0x120c2d=>_0x120c2d[_0x423b2a(0xe2d)]===_0x369a4c[_0x423b2a(0x32a)]);if(_0x36f7f5)_0x5e90cd[_0x423b2a(0x807)](_0x36f7f5['id']);}for(const _0x44f2aa of _0x5e90cd){const _0x1ede22=_0x505390[_0x423b2a(0x1027)][_0x44f2aa];if(_0x1ede22&&!_0x1ede22[_0x423b2a(0x9d7)]){const _0x2d5938=_0x505390[_0x423b2a(0x407)]['find'](_0x551f81=>_0x551f81[_0x423b2a(0x5f3)]===_0x78b2ce);let _0x2b4d42=_0x2d5938?_0x423b2a(0xd59)+_0x290fc7+_0x423b2a(0x97c)+_0x527647+_0x423b2a(0x588)+_0x2d5938[_0x423b2a(0x564)]+'”。':_0x369a4c[_0x423b2a(0x32a)]?_0x423b2a(0xd59)+_0x290fc7+'\x27刚刚在你的动态“'+_0x527647+_0x423b2a(0x11cc)+_0xaa9aca[_0x423b2a(0x2ef)]+'\x27的评论，内容是：“'+_0x78b2ce+'”。':_0x423b2a(0xd59)+_0x290fc7+'\x27刚刚评论了你的动态“'+_0x527647+_0x423b2a(0x8c7)+_0x78b2ce+'”。';const _0x42b94c={'role':_0x423b2a(0xbaa),'content':'[系统提示：'+_0x2b4d42+_0x423b2a(0x5b4),'timestamp':Date[_0x423b2a(0x12d6)](),'isHidden':!![]};_0x1ede22[_0x423b2a(0x7d3)][_0x423b2a(0x1a0)](_0x42b94c),await _0xb81d4e['chats'][_0x423b2a(0x5d0)](_0x1ede22);}}_0x27a0b3[_0x423b2a(0x4e0)]='',_0x54b53c(_0x4f4aa3),await _0x7cb448(_0x410af6);return;}}const _0x1a3485=_0x800db7=>{const _0x3e349c=_0x494435,_0x2e0262=_0x800db7[_0x3e349c(0xfa2)];if(_0x2e0262[_0x3e349c(0x869)](_0x3e349c(0x183)))return;const _0x4f98b8=_0x800db7[_0x3e349c(0xfa2)][_0x3e349c(0x869)](_0x3e349c(0x662));if(!_0x4f98b8)return;_0x4f1400(_0x4f98b8),_0x6da2ad[_0x3e349c(0x1377)]=_0x4f98b8,_0x6da2ad[_0x3e349c(0x456)]=!![],_0x6da2ad['isClick']=!![],_0x6da2ad[_0x3e349c(0x1184)]=null,_0x6da2ad[_0x3e349c(0x7b7)]=_0x800db7[_0x3e349c(0x858)][_0x3e349c(0x44f)]('mouse')?_0x800db7[_0x3e349c(0xb0f)]:_0x800db7[_0x3e349c(0x639)][0x0]['pageX'],_0x6da2ad[_0x3e349c(0x3d9)]=_0x800db7[_0x3e349c(0x858)][_0x3e349c(0x44f)](_0x3e349c(0xcec))?_0x800db7[_0x3e349c(0xe0c)]:_0x800db7[_0x3e349c(0x639)][0x0][_0x3e349c(0xe0c)],_0x6da2ad[_0x3e349c(0x1377)][_0x3e349c(0x8bc)](_0x3e349c(0xe11))[_0x3e349c(0x10dd)][_0x3e349c(0xe23)]='none',document['addEventListener'](_0x3e349c(0xaf1),_0x5d1590),document[_0x3e349c(0xa75)](_0x3e349c(0xe94),_0x4c3944),document[_0x3e349c(0xa75)]('touchmove',_0x5d1590,{'passive':![]}),document[_0x3e349c(0xa75)](_0x3e349c(0xeba),_0x4c3944);},_0x5d1590=_0x1362fb=>{const _0x228d7c=_0x494435;if(!_0x6da2ad[_0x228d7c(0x456)]||!_0x6da2ad['activeContainer'])return;const _0x22156a=_0x1362fb[_0x228d7c(0x858)][_0x228d7c(0x44f)](_0x228d7c(0xcec))?_0x1362fb['pageX']:_0x1362fb[_0x228d7c(0x639)][0x0]['pageX'],_0x1a4b79=_0x1362fb['type']['includes'](_0x228d7c(0xcec))?_0x1362fb[_0x228d7c(0xe0c)]:_0x1362fb[_0x228d7c(0x639)][0x0][_0x228d7c(0xe0c)],_0x437dbd=_0x22156a-_0x6da2ad['startX'],_0x4ec132=_0x1a4b79-_0x6da2ad[_0x228d7c(0x3d9)];_0x6da2ad[_0x228d7c(0x11d8)]&&(Math[_0x228d7c(0xdc5)](_0x437dbd)>0x5||Math['abs'](_0x4ec132)>0x5)&&(_0x6da2ad[_0x228d7c(0x11d8)]=![]);!_0x6da2ad[_0x228d7c(0x1184)]&&(Math[_0x228d7c(0xdc5)](_0x437dbd)>Math[_0x228d7c(0xdc5)](_0x4ec132)?_0x6da2ad[_0x228d7c(0x1184)]=_0x228d7c(0xc2d):_0x6da2ad[_0x228d7c(0x1184)]='vertical');if(_0x6da2ad[_0x228d7c(0x1184)]===_0x228d7c(0xc2d)){_0x1362fb[_0x228d7c(0xd58)](),_0x6da2ad['currentX']=_0x22156a;let _0x425768=Math[_0x228d7c(0x80f)](0x0,Math[_0x228d7c(0x6b8)](-0x5a,_0x437dbd));_0x6da2ad[_0x228d7c(0x1377)][_0x228d7c(0x8bc)](_0x228d7c(0xe11))[_0x228d7c(0x10dd)][_0x228d7c(0x87a)]=_0x228d7c(0x3ab)+_0x425768+_0x228d7c(0x98b);}},_0x4c3944=_0x1aa438=>{const _0xc19a64=_0x494435;document[_0xc19a64(0xdec)](_0xc19a64(0xaf1),_0x5d1590),document[_0xc19a64(0xdec)](_0xc19a64(0xe94),_0x4c3944),document[_0xc19a64(0xdec)](_0xc19a64(0x56f),_0x5d1590),document['removeEventListener']('touchend',_0x4c3944);if(!_0x6da2ad[_0xc19a64(0x456)]||!_0x6da2ad[_0xc19a64(0x1377)])return;const _0x43288f=_0x6da2ad[_0xc19a64(0x1377)][_0xc19a64(0x8bc)](_0xc19a64(0xe11));_0x43288f[_0xc19a64(0x10dd)][_0xc19a64(0xe23)]='transform\x200.3s\x20ease';if(_0x6da2ad[_0xc19a64(0x1184)]===_0xc19a64(0xc2d)&&!_0x6da2ad[_0xc19a64(0x11d8)]){const _0x8bcfbb=_0x1aa438['type'][_0xc19a64(0x44f)](_0xc19a64(0xeba))?_0x1aa438[_0xc19a64(0x7f0)][0x0]['pageX']:_0x1aa438[_0xc19a64(0xb0f)],_0x45f1bd=_0x8bcfbb-_0x6da2ad[_0xc19a64(0x7b7)];_0x45f1bd<-0x28?_0x43288f[_0xc19a64(0x9cd)]['add'](_0xc19a64(0x878)):_0x43288f[_0xc19a64(0x9cd)]['remove'](_0xc19a64(0x878));}_0x43288f[_0xc19a64(0x10dd)]['transform']='',_0x6da2ad['isDragging']=![],_0x6da2ad[_0xc19a64(0x1377)]=null,_0x6da2ad['swipeDirection']=null,_0x6da2ad['isClick']=!![];};_0x34eecc[_0x494435(0xa75)](_0x494435(0xd2f),_0x4f8191),_0x34eecc[_0x494435(0xa75)]('mousedown',_0x1a3485),_0x34eecc[_0x494435(0xa75)](_0x494435(0x2a9),_0x1a3485,{'passive':!![]}),_0x34eecc[_0x494435(0xa75)](_0x494435(0xd2f),_0x23ec6a=>{const _0xebe2f3=_0x494435;_0x23ec6a['target']&&_0x23ec6a[_0xebe2f3(0xfa2)]['id']===_0xebe2f3(0x3a9)&&_0x163d7a();}),document[_0x494435(0x479)](_0x494435(0xbd4))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x14155e=_0x494435;_0x505390['activeChatId']&&_0x433360(_0x505390[_0x14155e(0x233)]);}),document[_0x494435(0x479)](_0x494435(0x965))[_0x494435(0xa75)](_0x494435(0x1150),_0x545b84),document[_0x494435(0x479)](_0x494435(0x115f))[_0x494435(0xa75)](_0x494435(0xd2f),_0x272f57),document['getElementById'](_0x494435(0xa6e))[_0x494435(0xa75)](_0x494435(0xd2f),_0x5dbd83),document[_0x494435(0x479)](_0x494435(0x2f5))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x57367d=_0x494435,_0x199af4=document[_0x57367d(0x479)](_0x57367d(0xe40));_0x199af4['querySelector']('p')&&(_0x199af4[_0x57367d(0x3de)]='');const _0x3e53d2=_0x5951c9();_0x199af4[_0x57367d(0x9f4)](_0x3e53d2),_0x3e53d2['querySelector'](_0x57367d(0x389))[_0x57367d(0xc07)]();}),document[_0x494435(0x479)](_0x494435(0x3f9))[_0x494435(0xa75)](_0x494435(0xd2f),_0x2b88d0),document[_0x494435(0x479)]('thoughts-history-list')['addEventListener']('click',_0x2b2cad=>{const _0x407d79=_0x494435;_0x2b2cad[_0x407d79(0xfa2)]&&_0x2b2cad[_0x407d79(0xfa2)]['id']===_0x407d79(0x853)&&_0x44d3b7();}),document[_0x494435(0x479)](_0x494435(0x992))['addEventListener'](_0x494435(0xd2f),_0x1d8d32),document['getElementById'](_0x494435(0x8af))[_0x494435(0xa75)](_0x494435(0xd2f),_0x4bc641),document[_0x494435(0x479)]('character-profile-modal')[_0x494435(0xa75)]('click',_0x5ba347=>{const _0x356c8f=_0x494435;_0x5ba347[_0x356c8f(0xfa2)]['id']==='character-profile-modal'&&_0x5ba347['target'][_0x356c8f(0x9cd)][_0x356c8f(0x8b6)](_0x356c8f(0x45a));}),document[_0x494435(0x479)]('manage-stickers-btn')['addEventListener'](_0x494435(0xd2f),_0x101bec),document[_0x494435(0x479)](_0x494435(0x93d))[_0x494435(0xa75)](_0x494435(0xd2f),_0x48f307),document[_0x494435(0x479)](_0x494435(0x3ee))[_0x494435(0xa75)](_0x494435(0xd2f),()=>_0x104a0f('messages-view')),document[_0x494435(0x479)](_0x494435(0xae8))[_0x494435(0xa75)](_0x494435(0xd2f),()=>_0x104a0f(_0x494435(0x770)));const _0x4a233b=document[_0x494435(0x479)](_0x494435(0x626)),_0x426339=document[_0x494435(0x479)](_0x494435(0xba8));_0x4a233b[_0x494435(0xa75)]('input',()=>{const _0x5c3573=_0x494435,_0x6b465f=_0x4a233b[_0x5c3573(0x4e0)]['trim']()['toLowerCase']();_0x426339[_0x5c3573(0x10dd)][_0x5c3573(0x678)]=_0x6b465f?_0x5c3573(0xee3):_0x5c3573(0xff8);if(!_0x6b465f){_0x1da1be(allFavoriteItems);return;}const _0x37a358=allFavoriteItems[_0x5c3573(0x85d)](_0x38cfa5=>{const _0x4cfca0=_0x5c3573;let _0x10dd5b='',_0x371351='';if(_0x38cfa5[_0x4cfca0(0x858)]==='qzone_post'){const _0x38200f=_0x38cfa5['content'];_0x10dd5b+=(_0x38200f[_0x4cfca0(0x105a)]||'')+'\x20'+(_0x38200f[_0x4cfca0(0xac4)]||'');if(_0x38200f[_0x4cfca0(0x981)]===_0x4cfca0(0x4c5))_0x371351=_0x505390[_0x4cfca0(0x1190)][_0x4cfca0(0x904)];else _0x505390[_0x4cfca0(0x1027)][_0x38200f[_0x4cfca0(0x981)]]&&(_0x371351=_0x505390[_0x4cfca0(0x1027)][_0x38200f[_0x4cfca0(0x981)]][_0x4cfca0(0x564)]);}else{if(_0x38cfa5[_0x4cfca0(0x858)]===_0x4cfca0(0xeab)){const _0x83604a=_0x38cfa5['content'];typeof _0x83604a['content']===_0x4cfca0(0x8d9)&&(_0x10dd5b=_0x83604a[_0x4cfca0(0xac4)]);const _0x52fe75=_0x505390[_0x4cfca0(0x1027)][_0x38cfa5[_0x4cfca0(0xd4e)]];_0x52fe75&&(_0x83604a['role']===_0x4cfca0(0x4c5)?_0x371351=_0x52fe75[_0x4cfca0(0x9d7)]?_0x52fe75[_0x4cfca0(0x18a)]['myNickname']||'我':'我':_0x371351=_0x52fe75['isGroup']?_0x83604a['senderName']:_0x52fe75['name']);}}return _0x10dd5b[_0x4cfca0(0x1f8)]()[_0x4cfca0(0x44f)](_0x6b465f)||_0x371351[_0x4cfca0(0x1f8)]()[_0x4cfca0(0x44f)](_0x6b465f);});_0x1da1be(_0x37a358);}),_0x426339[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0xcd4698=_0x494435;_0x4a233b[_0xcd4698(0x4e0)]='',_0x426339[_0xcd4698(0x10dd)][_0xcd4698(0x678)]=_0xcd4698(0xff8),_0x1da1be(allFavoriteItems),_0x4a233b['focus']();}),document[_0x494435(0x479)](_0x494435(0xfc0))['addEventListener'](_0x494435(0xd2f),async()=>{const _0x11ce20=_0x494435;if(_0x373eab[_0x11ce20(0xa7a)]===0x0)return;const _0xc16b58=_0x505390[_0x11ce20(0x1027)][_0x505390[_0x11ce20(0x233)]];if(!_0xc16b58)return;const _0x247fbe=[],_0x14d660=[..._0x373eab];for(const _0x483861 of _0x14d660){const _0x2de3fd=await _0xb81d4e[_0x11ce20(0x3e8)]['where'](_0x11ce20(0xcc2))[_0x11ce20(0x4a2)](_0x483861)[_0x11ce20(0x64e)]();if(!_0x2de3fd){const _0x45b59d=_0xc16b58[_0x11ce20(0x7d3)]['find'](_0x4c7bb2=>_0x4c7bb2['timestamp']===_0x483861);_0x45b59d&&_0x247fbe[_0x11ce20(0x1a0)]({'type':_0x11ce20(0xeab),'content':_0x45b59d,'chatId':_0x505390['activeChatId'],'timestamp':Date['now'](),'originalTimestamp':_0x45b59d['timestamp']});}}_0x247fbe[_0x11ce20(0x990)]>0x0?(await _0xb81d4e[_0x11ce20(0x3e8)][_0x11ce20(0x2d9)](_0x247fbe),allFavoriteItems=await _0xb81d4e[_0x11ce20(0x3e8)][_0x11ce20(0x3d2)]('timestamp')['reverse']()['toArray'](),await _0x1519c8(_0x11ce20(0x3b2),_0x11ce20(0xd72)+_0x247fbe[_0x11ce20(0x990)]+_0x11ce20(0x8d7))):await _0x1519c8('提示','选中的消息均已收藏过。'),_0x24d789();});const _0x470a66=document[_0x494435(0x479)](_0x494435(0xf8a)),_0x1d962c=document[_0x494435(0x479)](_0x494435(0x980)),_0x250faa=document[_0x494435(0x479)](_0x494435(0xda8)),_0x30536d=document[_0x494435(0x479)](_0x494435(0x9cb)),_0x1662de=document['getElementById'](_0x494435(0x9ec));_0x470a66['addEventListener'](_0x494435(0xd2f),()=>{const _0x569eec=_0x494435;_0x267d11=!_0x267d11,_0x1d962c[_0x569eec(0x9cd)][_0x569eec(0x2bf)](_0x569eec(0xc9b),_0x267d11),_0x267d11?(_0x470a66[_0x569eec(0x97b)]='完成',_0x250faa['style'][_0x569eec(0x678)]=_0x569eec(0xee3),_0x30536d[_0x569eec(0x10dd)][_0x569eec(0x678)]=_0x569eec(0xff8),_0x1662de['style'][_0x569eec(0xa46)]='80px'):(_0x470a66[_0x569eec(0x97b)]='编辑',_0x250faa[_0x569eec(0x10dd)]['display']=_0x569eec(0xff8),_0x30536d[_0x569eec(0x10dd)][_0x569eec(0x678)]=_0x569eec(0x899),_0x1662de[_0x569eec(0x10dd)]['paddingBottom']='',_0x15cb7e[_0x569eec(0xf8f)](),document[_0x569eec(0x99e)](_0x569eec(0x1f3))[_0x569eec(0x12be)](_0x684b69=>_0x684b69[_0x569eec(0x9cd)]['remove'](_0x569eec(0x10dc))),document[_0x569eec(0x479)]('favorites-delete-selected-btn')[_0x569eec(0x97b)]=_0x569eec(0x10e4));}),document[_0x494435(0x479)](_0x494435(0x9ec))['addEventListener']('click',_0x40121a=>{const _0x192a6d=_0x494435,_0x833905=_0x40121a[_0x192a6d(0xfa2)],_0x376cf2=_0x833905[_0x192a6d(0x869)](_0x192a6d(0x405));if(_0x833905[_0x192a6d(0x612)]===_0x192a6d(0x42d)&&_0x833905[_0x192a6d(0x13d4)][_0x192a6d(0x1059)]){const _0x1e2c54=_0x833905[_0x192a6d(0x13d4)][_0x192a6d(0x1059)];_0x1519c8(_0x192a6d(0x35b),_0x1e2c54[_0x192a6d(0x491)](/<br>/g,'\x0a'));return;}if(!_0x267d11)return;if(!_0x376cf2)return;const _0x53cf40=parseInt(_0x376cf2[_0x192a6d(0x13d4)]['favid']);if(isNaN(_0x53cf40))return;_0x15cb7e[_0x192a6d(0x391)](_0x53cf40)?(_0x15cb7e[_0x192a6d(0x1ea)](_0x53cf40),_0x376cf2[_0x192a6d(0x9cd)][_0x192a6d(0x8b6)]('selected')):(_0x15cb7e['add'](_0x53cf40),_0x376cf2[_0x192a6d(0x9cd)][_0x192a6d(0x807)](_0x192a6d(0x10dc))),document[_0x192a6d(0x479)](_0x192a6d(0x559))[_0x192a6d(0x97b)]='删除\x20('+_0x15cb7e[_0x192a6d(0xa7a)]+')';}),document[_0x494435(0x479)](_0x494435(0x559))[_0x494435(0xa75)](_0x494435(0xd2f),async()=>{const _0x279abb=_0x494435;if(_0x15cb7e[_0x279abb(0xa7a)]===0x0)return;const _0xd101a1=await _0x1a9e79(_0x279abb(0x587),'确定要从收藏夹中移除这\x20'+_0x15cb7e['size']+_0x279abb(0x54c),{'confirmButtonClass':_0x279abb(0x95a)});if(_0xd101a1){const _0x49632d=[..._0x15cb7e];await _0xb81d4e[_0x279abb(0x3e8)][_0x279abb(0x12f5)](_0x49632d),await _0x1519c8(_0x279abb(0xa62),_0x279abb(0x2e9)),allFavoriteItems=allFavoriteItems['filter'](_0xbc2e4d=>!_0x49632d[_0x279abb(0x44f)](_0xbc2e4d['id'])),_0x1da1be(allFavoriteItems),_0x470a66[_0x279abb(0xd2f)]();}});_0x505390['globalSettings'][_0x494435(0xc00)]&&(_0x351d83(),console[_0x494435(0x90f)](_0x494435(0x537)));document[_0x494435(0x99e)](_0x494435(0xba4))[_0x494435(0x12be)](_0x398176=>{const _0x59bc97=_0x494435;_0x398176[_0x59bc97(0xa75)](_0x59bc97(0x1150),_0x11fab3);});const _0x35ed21=document[_0x494435(0x479)](_0x494435(0xa94));_0x35ed21[_0x494435(0xa75)](_0x494435(0xa01),()=>{const _0x180a50=_0x494435;document[_0x180a50(0x479)](_0x180a50(0x860))['textContent']=_0x35ed21['value']+'px',_0x11fab3();});const _0x26745a=document[_0x494435(0x479)](_0x494435(0xbfb));_0x26745a[_0x494435(0xa75)]('input',_0x11fab3),document['getElementById'](_0x494435(0x7b1))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x4de502=_0x494435;document['getElementById'](_0x4de502(0xf04))[_0x4de502(0xf7b)]=!![],_0x11fab3();}),document['getElementById'](_0x494435(0x5c6))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x124f09=_0x494435;document[_0x124f09(0x479)](_0x124f09(0xbfb))['value']='',_0x11fab3();}),document['getElementById'](_0x494435(0x7f3))[_0x494435(0xa75)](_0x494435(0x1150),_0x11fab3),document['getElementById'](_0x494435(0x120e))['addEventListener'](_0x494435(0x1150),_0x11fab3),document[_0x494435(0x479)](_0x494435(0x2df))['addEventListener'](_0x494435(0xa01),_0x11fab3),document[_0x494435(0x99e)]('input[name=\x22visibility\x22]')['forEach'](_0x299db2=>{const _0x2164ca=_0x494435;_0x299db2[_0x2164ca(0xa75)]('change',function(){const _0x5beba5=_0x2164ca,_0x47bdfa=document['getElementById'](_0x5beba5(0x116a));this[_0x5beba5(0x4e0)]===_0x5beba5(0x13a1)||this[_0x5beba5(0x4e0)]===_0x5beba5(0x682)?_0x47bdfa[_0x5beba5(0x10dd)]['display']=_0x5beba5(0xee3):_0x47bdfa[_0x5beba5(0x10dd)]['display']=_0x5beba5(0xff8);});}),document['getElementById'](_0x494435(0xead))[_0x494435(0xa75)](_0x494435(0xd2f),_0x1c5ba1),document[_0x494435(0x479)]('close-group-manager-btn')['addEventListener'](_0x494435(0xd2f),()=>{const _0x36253a=_0x494435;document[_0x36253a(0x479)](_0x36253a(0x557))[_0x36253a(0x9cd)][_0x36253a(0x8b6)](_0x36253a(0x45a));const _0x2a16d8=document[_0x36253a(0x479)](_0x36253a(0x2a4));document[_0x36253a(0x479)]('chat-settings-modal')[_0x36253a(0x9cd)][_0x36253a(0x658)](_0x36253a(0x45a))&&_0x2a16d8[_0x36253a(0xd2f)]();}),document[_0x494435(0x479)](_0x494435(0xc60))['addEventListener'](_0x494435(0xd2f),_0x341d84),document[_0x494435(0x479)](_0x494435(0x135e))[_0x494435(0xa75)](_0x494435(0xd2f),_0xa09d3b=>{const _0x3672b4=_0x494435;if(_0xa09d3b[_0x3672b4(0xfa2)][_0x3672b4(0x9cd)][_0x3672b4(0x658)](_0x3672b4(0x970))){const _0x2cbc6d=parseInt(_0xa09d3b['target']['dataset']['id']);_0x34c07a(_0x2cbc6d);}}),document[_0x494435(0x479)](_0x494435(0x8bd))['addEventListener'](_0x494435(0xd2f),_0x499597),document[_0x494435(0x479)](_0x494435(0x1225))[_0x494435(0xa75)](_0x494435(0xd2f),_0x3e93d8),document[_0x494435(0x479)]('copy-message-btn')[_0x494435(0xa75)]('click',_0x472e40),document[_0x494435(0x479)](_0x494435(0x53f))['addEventListener'](_0x494435(0xd2f),_0x8b172b),document[_0x494435(0x479)](_0x494435(0xc4f))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x5b3934=_0x45dd47;_0x499597(),_0x5b3934&&_0x50e948(_0x5b3934);}),document['getElementById'](_0x494435(0x659))[_0x494435(0xa75)](_0x494435(0xd2f),_0x53545d=>{const _0x53c074=_0x494435,_0x47b8a0=_0x53545d['target']['closest'](_0x53c074(0xc28));if(!_0x47b8a0)return;if(_0x47b8a0[_0x53c074(0x9cd)][_0x53c074(0x658)]('ai')&&_0x47b8a0[_0x53c074(0x9cd)][_0x53c074(0x658)](_0x53c074(0x12b6))&&_0x47b8a0[_0x53c074(0x13d4)][_0x53c074(0x93c)]===_0x53c074(0xa25)){const _0x30c0b3=parseInt(_0x47b8a0[_0x53c074(0x13d4)][_0x53c074(0x12a2)]);!isNaN(_0x30c0b3)&&_0x196d69(_0x30c0b3);}}),document['getElementById']('transfer-action-accept')[_0x494435(0xa75)](_0x494435(0xd2f),()=>_0x5b9a92(_0x494435(0x1312))),document[_0x494435(0x479)](_0x494435(0x432))['addEventListener']('click',()=>_0x5b9a92(_0x494435(0xe4b))),document['getElementById'](_0x494435(0x70c))[_0x494435(0xa75)](_0x494435(0xd2f),_0xccdc91),document[_0x494435(0x479)](_0x494435(0x737))['addEventListener'](_0x494435(0xd2f),_0x4bfd06),document[_0x494435(0x479)](_0x494435(0x5df))[_0x494435(0xa75)](_0x494435(0xd2f),_0x214669),document[_0x494435(0x479)](_0x494435(0x740))[_0x494435(0xa75)](_0x494435(0xd2f),_0xe7d7f5),document[_0x494435(0x479)](_0x494435(0x228))['addEventListener'](_0x494435(0xd2f),()=>{const _0x2335b5=_0x494435;_0x731d5(_0x2335b5(0xe34));}),document[_0x494435(0x479)](_0x494435(0x1163))['addEventListener'](_0x494435(0xd2f),_0x763ca4=>{const _0x1f202f=_0x494435,_0x833e31=_0x763ca4[_0x1f202f(0xfa2)][_0x1f202f(0x869)]('.contact-picker-item');if(!_0x833e31)return;const _0x55217e=_0x833e31[_0x1f202f(0x13d4)][_0x1f202f(0x33a)];_0x833e31[_0x1f202f(0x9cd)][_0x1f202f(0x2bf)](_0x1f202f(0x10dc)),_0x15ec27[_0x1f202f(0x391)](_0x55217e)?_0x15ec27[_0x1f202f(0x1ea)](_0x55217e):_0x15ec27['add'](_0x55217e),_0x3af29a();}),document['getElementById'](_0x494435(0x781))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{_0xc43f8();}),document[_0x494435(0x479)]('back-from-member-management')[_0x494435(0xa75)]('click',()=>{const _0x5cb758=_0x494435;_0x731d5(_0x5cb758(0xdeb)),document[_0x5cb758(0x479)](_0x5cb758(0x2a4))[_0x5cb758(0xd2f)]();}),document[_0x494435(0x479)](_0x494435(0x2aa))['addEventListener'](_0x494435(0xd2f),_0x5da508=>{const _0x43bd7a=_0x494435;_0x5da508[_0x43bd7a(0xfa2)][_0x43bd7a(0x9cd)][_0x43bd7a(0x658)](_0x43bd7a(0xb5b))&&_0x42b81f(_0x5da508['target']['dataset'][_0x43bd7a(0xb55)]);}),document[_0x494435(0x479)](_0x494435(0xa06))['addEventListener'](_0x494435(0xd2f),async()=>{const _0x2f1f83=_0x494435,_0x6a0750=document[_0x2f1f83(0x479)](_0x2f1f83(0x5c5)),_0x183ca6=_0x6a0750[_0x2f1f83(0xbcf)](!![]);_0x6a0750[_0x2f1f83(0x1134)][_0x2f1f83(0xf0d)](_0x183ca6,_0x6a0750),_0x183ca6[_0x2f1f83(0xa75)]('click',_0x25c6a4),await _0x53cac1();}),document[_0x494435(0x479)](_0x494435(0x1294))[_0x494435(0xa75)](_0x494435(0xd2f),_0x3ff379),document[_0x494435(0x479)](_0x494435(0x1016))['addEventListener'](_0x494435(0xd2f),_0x5b2567),document[_0x494435(0x479)](_0x494435(0xd2c))[_0x494435(0xa75)]('click',_0x5b2567),document[_0x494435(0x479)](_0x494435(0x1018))[_0x494435(0xa75)](_0x494435(0xd2f),_0x299d4a),document['getElementById']('cancel-call-btn')[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x5b3c9d=_0x494435;_0x315a6a[_0x5b3c9d(0xbb7)]=![],_0x731d5(_0x5b3c9d(0xdeb));}),document[_0x494435(0x479)]('join-call-btn')['addEventListener'](_0x494435(0xd2f),_0x231c14),document[_0x494435(0x479)]('decline-call-btn')[_0x494435(0xa75)](_0x494435(0xd2f),async()=>{const _0x52c0f7=_0x494435;_0x33a53();const _0x413157=_0x505390[_0x52c0f7(0x1027)][_0x315a6a['activeChatId']];if(!_0x413157)return;if(_0x315a6a[_0x52c0f7(0x7bf)]){_0x315a6a['isUserParticipating']=![];const _0x5ec13d={'role':_0x52c0f7(0xbaa),'content':_0x52c0f7(0x12ba),'timestamp':Date['now'](),'isHidden':!![]};_0x413157[_0x52c0f7(0x7d3)][_0x52c0f7(0x1a0)](_0x5ec13d),await _0xb81d4e['chats'][_0x52c0f7(0x5d0)](_0x413157),await _0x15e1a8();}else{const _0x105ff3={'role':_0x52c0f7(0x4c5),'content':_0x52c0f7(0x12a0),'timestamp':Date[_0x52c0f7(0x12d6)]()};_0x413157[_0x52c0f7(0x7d3)]['push'](_0x105ff3),await _0xb81d4e['chats'][_0x52c0f7(0x5d0)](_0x413157),_0x731d5(_0x52c0f7(0xdeb)),_0x48f5ff(_0x105ff3,_0x413157),_0x15e1a8();}_0x315a6a['isAwaitingResponse']=![];}),document[_0x494435(0x479)](_0x494435(0x12b5))[_0x494435(0xa75)]('click',async()=>{const _0xc1fc6b=_0x494435;_0x33a53(),_0x315a6a[_0xc1fc6b(0x181)]='ai',_0x315a6a[_0xc1fc6b(0x9bc)]=!![],_0x315a6a[_0xc1fc6b(0x233)]=_0x505390[_0xc1fc6b(0x233)];if(_0x315a6a['isGroupCall']){const _0x51d347=_0x505390[_0xc1fc6b(0x1027)][_0x315a6a['activeChatId']],_0x17b0d2=_0x51d347[_0xc1fc6b(0x954)][_0xc1fc6b(0xc0d)](_0x2e3346=>_0x2e3346[_0xc1fc6b(0x564)]===_0x315a6a[_0xc1fc6b(0x648)]);_0x17b0d2?_0x315a6a['participants']=[_0x17b0d2]:_0x315a6a[_0xc1fc6b(0xf06)]=[];}_0x511eb0();}),document[_0x494435(0x479)](_0x494435(0x40c))[_0x494435(0xa75)]('click',async()=>{const _0x2c8f0a=_0x494435;if(!_0x315a6a[_0x2c8f0a(0x4c3)])return;const _0x499b6f=document[_0x2c8f0a(0x8bc)]('.participant-avatar-wrapper[data-participant-id=\x22user\x22]\x20.participant-avatar');_0x499b6f&&_0x499b6f['classList'][_0x2c8f0a(0x807)](_0x2c8f0a(0x2af));const _0xd66c7a=await _0x9a2c09('你说',_0x2c8f0a(0x3b7));_0x499b6f&&_0x499b6f['classList'][_0x2c8f0a(0x8b6)]('speaking'),_0xd66c7a&&_0xd66c7a[_0x2c8f0a(0x9c1)]()&&_0x5cb9e2(_0xd66c7a['trim']());}),document[_0x494435(0x8bc)](_0x494435(0x12fc))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x3f5246=_0x494435;_0x267d11&&document['getElementById']('favorites-edit-btn')[_0x3f5246(0xd2f)](),_0x104a0f(_0x3f5246(0x739)),_0x5d6891();}),document['getElementById'](_0x494435(0xfe2))[_0x494435(0xa75)](_0x494435(0xd2f),()=>_0x104a0f(_0x494435(0x770))),document['getElementById'](_0x494435(0xf5f))['addEventListener']('click',async()=>{const _0x4a6af6=_0x494435,_0x2ed26c=document[_0x4a6af6(0x479)](_0x4a6af6(0xbb2))[_0x4a6af6(0x4e0)][_0x4a6af6(0x9c1)](),_0x58519a=document[_0x4a6af6(0x479)](_0x4a6af6(0x138e))[_0x4a6af6(0x4e0)];if(!_0x2ed26c||!_0x58519a){alert(_0x4a6af6(0x27e));return;}const _0x15b390=new Date(_0x58519a);if(isNaN(_0x15b390)||_0x15b390<=new Date()){alert(_0x4a6af6(0xd95));return;}const _0x2d5cb2={'authorId':_0x4a6af6(0x4c5),'description':_0x2ed26c,'timestamp':Date['now'](),'type':_0x4a6af6(0x38a),'targetDate':_0x15b390['getTime']()};await _0xb81d4e['memories']['add'](_0x2d5cb2),document[_0x4a6af6(0x479)](_0x4a6af6(0x664))[_0x4a6af6(0x9cd)][_0x4a6af6(0x8b6)]('visible'),_0x5d6891();}),document[_0x494435(0x479)](_0x494435(0x1000))[_0x494435(0xa75)]('click',async()=>{const _0x4a3356=_0x494435;if(!_0x505390[_0x4a3356(0x233)]||_0x505390[_0x4a3356(0x1027)][_0x505390[_0x4a3356(0x233)]][_0x4a3356(0x9d7)])return;const _0x26b01e=_0x505390['chats'][_0x505390['activeChatId']],_0x52548f=await _0x1a9e79(_0x4a3356(0x73c),_0x4a3356(0x1083)+_0x26b01e[_0x4a3356(0x564)]+'”吗？拉黑后您将无法向其发送消息，直到您将Ta移出黑名单，或等待Ta重新申请好友。',{'confirmButtonClass':_0x4a3356(0x95a)});if(_0x52548f){_0x26b01e[_0x4a3356(0xcda)][_0x4a3356(0x93c)]=_0x4a3356(0x89f),_0x26b01e['relationship'][_0x4a3356(0x122a)]=Date[_0x4a3356(0x12d6)]();const _0x3c2e7b={'role':_0x4a3356(0xbaa),'content':'[系统提示：你刚刚被用户拉黑了。在对方解除拉黑之前，你无法再主动发起对话，也无法回应。]','timestamp':Date[_0x4a3356(0x12d6)]()+0x1,'isHidden':!![]};_0x26b01e[_0x4a3356(0x7d3)][_0x4a3356(0x1a0)](_0x3c2e7b),await _0xb81d4e[_0x4a3356(0x1027)][_0x4a3356(0x5d0)](_0x26b01e),document[_0x4a3356(0x479)](_0x4a3356(0xedb))['classList'][_0x4a3356(0x8b6)]('visible'),_0x474d6b(_0x505390[_0x4a3356(0x233)]),_0x1b7f69();}}),document[_0x494435(0x479)](_0x494435(0x11ca))[_0x494435(0xa75)]('click',async _0x1a7547=>{const _0x5ab3b8=_0x494435,_0x40ed0f=_0x505390['chats'][_0x505390[_0x5ab3b8(0x233)]];if(!_0x40ed0f)return;if(_0x1a7547[_0x5ab3b8(0xfa2)]['id']===_0x5ab3b8(0xb5f)){alert('正在手动触发好友申请流程，请稍后...\x0a如果API调用成功，将弹出提示。如果失败，也会有错误提示。如果长时间无反应，说明AI可能决定暂时不申请。'),await _0x1f5dd9(_0x40ed0f['id']),_0x474d6b(_0x40ed0f['id']);return;}if(_0x1a7547[_0x5ab3b8(0xfa2)]['id']===_0x5ab3b8(0xebd)){_0x40ed0f[_0x5ab3b8(0xcda)][_0x5ab3b8(0x93c)]=_0x5ab3b8(0xc83),_0x40ed0f[_0x5ab3b8(0xcda)]['blockedTimestamp']=null;const _0x418205={'role':_0x5ab3b8(0xbaa),'content':_0x5ab3b8(0x1331),'timestamp':Date[_0x5ab3b8(0x12d6)](),'isHidden':!![]};_0x40ed0f[_0x5ab3b8(0x7d3)][_0x5ab3b8(0x1a0)](_0x418205),await _0xb81d4e[_0x5ab3b8(0x1027)][_0x5ab3b8(0x5d0)](_0x40ed0f),_0x474d6b(_0x40ed0f['id']),_0x1b7f69(),_0x15e1a8();}else{if(_0x1a7547['target']['id']===_0x5ab3b8(0x1282)){_0x40ed0f['relationship'][_0x5ab3b8(0x93c)]=_0x5ab3b8(0xc83),_0x40ed0f[_0x5ab3b8(0xcda)][_0x5ab3b8(0xcd9)]='';const _0x1e9281={'role':'system','type':_0x5ab3b8(0x81b),'content':_0x5ab3b8(0x916)+_0x40ed0f[_0x5ab3b8(0x564)]+_0x5ab3b8(0x8dd),'timestamp':Date[_0x5ab3b8(0x12d6)]()};_0x40ed0f[_0x5ab3b8(0x7d3)][_0x5ab3b8(0x1a0)](_0x1e9281);const _0x19ae8f={'role':_0x5ab3b8(0x1328),'senderName':_0x40ed0f[_0x5ab3b8(0x564)],'content':'太好了！我们又可以聊天啦！','timestamp':Date[_0x5ab3b8(0x12d6)]()+0x1};_0x40ed0f[_0x5ab3b8(0x7d3)][_0x5ab3b8(0x1a0)](_0x19ae8f),await _0xb81d4e[_0x5ab3b8(0x1027)]['put'](_0x40ed0f),_0x474d6b(_0x40ed0f['id']),_0x1b7f69();}else{if(_0x1a7547['target']['id']===_0x5ab3b8(0x3ff))_0x40ed0f['relationship'][_0x5ab3b8(0x93c)]='blocked_by_user',_0x40ed0f[_0x5ab3b8(0xcda)][_0x5ab3b8(0x122a)]=Date[_0x5ab3b8(0x12d6)](),_0x40ed0f[_0x5ab3b8(0xcda)][_0x5ab3b8(0xcd9)]='',await _0xb81d4e[_0x5ab3b8(0x1027)][_0x5ab3b8(0x5d0)](_0x40ed0f),_0x474d6b(_0x40ed0f['id']);else{if(_0x1a7547[_0x5ab3b8(0xfa2)]['id']==='apply-friend-btn'){const _0x47feca=await _0x9a2c09(_0x5ab3b8(0xce1),_0x5ab3b8(0x472)+_0x40ed0f['name']+_0x5ab3b8(0xeee),_0x5ab3b8(0x139d));_0x47feca!==null&&(_0x40ed0f['relationship']['status']=_0x5ab3b8(0xb79),_0x40ed0f[_0x5ab3b8(0xcda)][_0x5ab3b8(0xcd9)]=_0x47feca,await _0xb81d4e[_0x5ab3b8(0x1027)][_0x5ab3b8(0x5d0)](_0x40ed0f),_0x474d6b(_0x40ed0f['id']),_0x1b7f69(),_0x15e1a8());}}}}}),document[_0x494435(0x479)](_0x494435(0x3b6))[_0x494435(0xa75)]('click',_0x17b614),document[_0x494435(0x479)](_0x494435(0x13ea))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x16e1a7=_0x494435;document['getElementById'](_0x16e1a7(0x866))[_0x16e1a7(0x9cd)][_0x16e1a7(0x8b6)](_0x16e1a7(0x45a));}),document[_0x494435(0x479)](_0x494435(0xd1c))[_0x494435(0xa75)](_0x494435(0xd2f),_0x2e32ab),document[_0x494435(0x479)]('send-direct-packet-btn')['addEventListener'](_0x494435(0xd2f),_0x25366f);const _0x45175f=document[_0x494435(0x479)](_0x494435(0xe7d)),_0x58b346=document[_0x494435(0x479)]('rp-tab-direct'),_0x2d0da2=document[_0x494435(0x479)]('rp-content-group'),_0x388d29=document[_0x494435(0x479)](_0x494435(0x292));_0x45175f[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x98edef=_0x494435;_0x45175f['classList'][_0x98edef(0x807)]('active'),_0x58b346[_0x98edef(0x9cd)]['remove'](_0x98edef(0x5a9)),_0x2d0da2[_0x98edef(0x10dd)]['display']='block',_0x388d29['style'][_0x98edef(0x678)]='none';}),_0x58b346['addEventListener'](_0x494435(0xd2f),()=>{const _0x4b5c38=_0x494435;_0x58b346[_0x4b5c38(0x9cd)][_0x4b5c38(0x807)]('active'),_0x45175f[_0x4b5c38(0x9cd)]['remove']('active'),_0x388d29['style']['display']=_0x4b5c38(0xee3),_0x2d0da2[_0x4b5c38(0x10dd)][_0x4b5c38(0x678)]=_0x4b5c38(0xff8);}),document['getElementById'](_0x494435(0x298))[_0x494435(0xa75)]('input',_0x1b930f=>{const _0x3a494f=_0x494435,_0x477d36=parseFloat(_0x1b930f[_0x3a494f(0xfa2)]['value'])||0x0;document['getElementById']('rp-group-total')[_0x3a494f(0x97b)]='¥\x20'+_0x477d36[_0x3a494f(0x6e1)](0x2);}),document[_0x494435(0x479)](_0x494435(0x9bb))[_0x494435(0xa75)](_0x494435(0xa01),_0x1c81d7=>{const _0x344421=_0x494435,_0x446e26=parseFloat(_0x1c81d7[_0x344421(0xfa2)][_0x344421(0x4e0)])||0x0;document['getElementById'](_0x344421(0xa41))['textContent']='¥\x20'+_0x446e26[_0x344421(0x6e1)](0x2);}),document[_0x494435(0x479)]('chat-messages')[_0x494435(0xa75)](_0x494435(0xd2f),_0x98067=>{const _0x4f3af1=_0x494435,_0x3008fd=_0x98067[_0x4f3af1(0xfa2)][_0x4f3af1(0x869)](_0x4f3af1(0xb88));if(!_0x3008fd)return;const _0x52816c=_0x3008fd[_0x4f3af1(0x869)]('.message-bubble');if(!_0x52816c||!_0x52816c[_0x4f3af1(0x13d4)][_0x4f3af1(0x12a2)])return;const _0x452bda=parseInt(_0x52816c[_0x4f3af1(0x13d4)]['timestamp']);_0x3bc284(_0x452bda);}),document[_0x494435(0x479)](_0x494435(0x8b0))[_0x494435(0xa75)]('click',_0x1fece2),document[_0x494435(0x479)](_0x494435(0x30d))[_0x494435(0xa75)](_0x494435(0xd2f),_0x105c67),document['getElementById'](_0x494435(0x77e))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x2b68b3=_0x494435;document[_0x2b68b3(0x479)](_0x2b68b3(0xf1c))[_0x2b68b3(0x9cd)]['remove'](_0x2b68b3(0x45a));}),document[_0x494435(0x479)](_0x494435(0xfc9))[_0x494435(0xa75)](_0x494435(0xd2f),_0x10d607),document[_0x494435(0x479)](_0x494435(0x659))['addEventListener'](_0x494435(0xd2f),_0x18f685=>{const _0x111a5c=_0x494435,_0x576c5f=_0x18f685[_0x111a5c(0xfa2)][_0x111a5c(0x869)](_0x111a5c(0x76b));if(!_0x576c5f)return;const _0x4e15c4=parseInt(_0x576c5f[_0x111a5c(0x13d4)]['pollTimestamp']);if(isNaN(_0x4e15c4))return;const _0x3120a0=_0x18f685[_0x111a5c(0xfa2)][_0x111a5c(0x869)](_0x111a5c(0x2cd));if(_0x3120a0&&!_0x576c5f[_0x111a5c(0x9cd)]['contains'](_0x111a5c(0x544))){_0x398b9c(_0x4e15c4,_0x3120a0[_0x111a5c(0x13d4)][_0x111a5c(0x9a2)]);return;}const _0x3d7409=_0x18f685[_0x111a5c(0xfa2)][_0x111a5c(0x869)](_0x111a5c(0x973));if(_0x3d7409){_0x576c5f[_0x111a5c(0x9cd)][_0x111a5c(0x658)]('closed')?_0x17870e(_0x4e15c4):_0x509d06(_0x4e15c4);return;}_0x576c5f[_0x111a5c(0x9cd)]['contains']('closed')&&_0x17870e(_0x4e15c4);}),document[_0x494435(0x479)](_0x494435(0x1e4))[_0x494435(0xa75)](_0x494435(0xd2f),_0x568f90),document[_0x494435(0x479)](_0x494435(0x108d))['addEventListener'](_0x494435(0xd2f),()=>_0x23bc48('ai')),document[_0x494435(0x479)](_0x494435(0xed1))[_0x494435(0xa75)](_0x494435(0xd2f),()=>_0x23bc48(_0x494435(0x1224))),document['getElementById'](_0x494435(0x10d4))[_0x494435(0xa75)](_0x494435(0xd2f),_0x5dcdd),document[_0x494435(0x479)](_0x494435(0x8cd))['addEventListener'](_0x494435(0xd2f),()=>{const _0x2c215f=_0x494435;document[_0x2c215f(0x479)]('ai-avatar-upload-input')[_0x2c215f(0xd2f)]();}),document[_0x494435(0x479)](_0x494435(0xf6c))[_0x494435(0xa75)](_0x494435(0x1150),_0xc7db2c),document[_0x494435(0x479)](_0x494435(0xedc))[_0x494435(0xa75)](_0x494435(0xd2f),_0x3edad5),document[_0x494435(0x479)](_0x494435(0xd8f))[_0x494435(0xa75)](_0x494435(0xd2f),_0xb539a6),document[_0x494435(0x479)]('add-group-avatar-url-btn')[_0x494435(0xa75)](_0x494435(0xd2f),_0x489eae),document[_0x494435(0x479)](_0x494435(0xd4f))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x1377c5=_0x494435;document[_0x1377c5(0x479)](_0x1377c5(0x483))[_0x1377c5(0xd2f)]();}),document[_0x494435(0x479)](_0x494435(0x483))['addEventListener'](_0x494435(0x1150),_0x35d18d),document['getElementById'](_0x494435(0xbbb))['addEventListener']('click',_0x13d2d4),document['getElementById'](_0x494435(0x84c))[_0x494435(0xa75)](_0x494435(0xd2f),_0x4f1c99=>{const _0x488a1b=_0x494435;if(_0x4f1c99['target'][_0x488a1b(0x9cd)][_0x488a1b(0x658)](_0x488a1b(0x5d7))){const _0x50c2a5=_0x4f1c99[_0x488a1b(0xfa2)]['closest'](_0x488a1b(0xff3)),_0x4361c5=_0x50c2a5[_0x488a1b(0x13d4)][_0x488a1b(0x23b)];_0x4361c5&&_0x14a5e4(_0x4361c5,_0x488a1b(0x10a3),_0x50c2a5);}}),document[_0x494435(0x479)]('chat-messages')[_0x494435(0xa75)]('click',_0x10f07d=>{const _0x3de4e0=_0x494435,_0x1d607d=_0x10f07d[_0x3de4e0(0xfa2)][_0x3de4e0(0x869)](_0x3de4e0(0xf44));if(_0x1d607d){const _0x3eada2=parseInt(_0x1d607d[_0x3de4e0(0x13d4)][_0x3de4e0(0x12a2)]);!isNaN(_0x3eada2)&&_0x25c787(_0x3eada2);}}),document['getElementById'](_0x494435(0x835))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{_0x731d5('chat-interface-screen');}),_0x50f1ba['panelEl'][_0x494435(0xa75)]('click',async _0x4610fe=>{const _0x480549=_0x494435,_0x33bc14=_0x4610fe['target'][_0x480549(0x869)](_0x480549(0x43f));if(_0x33bc14&&_0x50f1ba[_0x480549(0x25e)]!==null){const _0x51de9a=_0x33bc14[_0x480549(0x10dd)][_0x480549(0x13b9)][_0x480549(0x777)](0x5,-0x2),_0x251a13=_0x505390['userStickers']['find'](_0x3a8c5f=>_0x3a8c5f[_0x480549(0x5f3)]===_0x51de9a);_0x251a13?await _0x431fd0(_0x50f1ba[_0x480549(0x25e)],_0x251a13):console[_0x480549(0x139e)](_0x480549(0x994),_0x51de9a);}}),document[_0x494435(0xa75)]('click',_0x3d8fae=>{const _0x3dec96=_0x494435;_0x50f1ba[_0x3dec96(0xeb9)]&&!_0x50f1ba[_0x3dec96(0xe50)]['contains'](_0x3d8fae[_0x3dec96(0xfa2)])&&!_0x3d8fae[_0x3dec96(0xfa2)][_0x3dec96(0x869)](_0x3dec96(0x58b))&&_0x3a8fa4();}),document[_0x494435(0x479)](_0x494435(0x1086))[_0x494435(0xa75)](_0x494435(0xd2f),_0xcb3934),document[_0x494435(0x479)](_0x494435(0x318))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x5e3560=_0x494435;document[_0x5e3560(0x479)]('share-link-modal')[_0x5e3560(0x9cd)][_0x5e3560(0x8b6)]('visible');}),document[_0x494435(0x479)](_0x494435(0x851))[_0x494435(0xa75)](_0x494435(0xd2f),_0x5e567d),document[_0x494435(0x479)](_0x494435(0x26d))[_0x494435(0xa75)](_0x494435(0x1150),_0x18be33),document[_0x494435(0x479)](_0x494435(0xadb))[_0x494435(0xa75)](_0x494435(0xd2f),_0x4ed3c4),document['getElementById'](_0x494435(0x13f5))[_0x494435(0xa75)](_0x494435(0xd2f),_0xfd273f),document[_0x494435(0x479)](_0x494435(0x13ba))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{_0x731d5('chat-list-screen');}),document['getElementById'](_0x494435(0x1315))[_0x494435(0xa75)]('click',_0x50f9a2=>{const _0x50937a=_0x494435,_0x5c6a0c=_0x50f9a2[_0x50937a(0xfa2)][_0x50937a(0x869)](_0x50937a(0xd91));_0x5c6a0c&&_0x5c6a0c['dataset'][_0x50937a(0xe29)]&&_0x52514e(parseInt(_0x5c6a0c[_0x50937a(0x13d4)][_0x50937a(0xe29)]));}),document['getElementById']('close-call-transcript-btn')['addEventListener'](_0x494435(0xd2f),()=>{const _0x5eb78d=_0x494435;document['getElementById'](_0x5eb78d(0xfab))[_0x5eb78d(0x9cd)][_0x5eb78d(0x8b6)](_0x5eb78d(0x45a));}),document[_0x494435(0x479)](_0x494435(0x39e))[_0x494435(0xa75)](_0x494435(0xd2f),_0x1008e7),document[_0x494435(0x479)](_0x494435(0x1013))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x4cab8d=_0x494435;_0x373eab[_0x4cab8d(0xa7a)]>0x0&&_0x139293();}),document[_0x494435(0x479)]('selection-screenshot-btn')[_0x494435(0xa75)]('click',_0x4851b7),document[_0x494435(0x479)]('confirm-share-target-btn')['addEventListener'](_0x494435(0xd2f),async()=>{const _0x334737=_0x494435,_0x5d6a87=_0x505390['chats'][_0x505390[_0x334737(0x233)]],_0x3c4e61=Array[_0x334737(0x22f)](document[_0x334737(0x99e)](_0x334737(0x1298)))[_0x334737(0x2e1)](_0x25a1d0=>_0x25a1d0[_0x334737(0x13d4)][_0x334737(0xd4e)]);if(_0x3c4e61[_0x334737(0x990)]===0x0){alert(_0x334737(0xc18));return;}const _0x2670eb=[],_0x3d7048=[..._0x373eab][_0x334737(0x382)]((_0x19dc28,_0x498041)=>_0x19dc28-_0x498041);for(const _0xce703a of _0x3d7048){const _0x420360=_0x5d6a87[_0x334737(0x7d3)][_0x334737(0xc0d)](_0x64694=>_0x64694[_0x334737(0x12a2)]===_0xce703a);_0x420360&&_0x2670eb[_0x334737(0x1a0)](_0x420360);}const _0x54c728={'role':_0x334737(0x4c5),'senderName':_0x5d6a87[_0x334737(0x9d7)]?_0x5d6a87[_0x334737(0x18a)][_0x334737(0xf58)]||'我':'我','type':_0x334737(0xc59),'timestamp':Date['now'](),'payload':{'sourceChatName':_0x5d6a87[_0x334737(0x564)],'title':_0x334737(0x419)+_0x5d6a87[_0x334737(0x564)]+_0x334737(0x83d),'sharedHistory':_0x2670eb}};for(const _0x2c175e of _0x3c4e61){const _0x3b20b2=_0x505390[_0x334737(0x1027)][_0x2c175e];_0x3b20b2&&(_0x3b20b2[_0x334737(0x7d3)]['push'](_0x54c728),await _0xb81d4e[_0x334737(0x1027)][_0x334737(0x5d0)](_0x3b20b2));}document[_0x334737(0x479)](_0x334737(0x608))[_0x334737(0x9cd)]['remove'](_0x334737(0x45a)),_0x24d789(),await _0x1519c8('分享成功',_0x334737(0xca9)+_0x3c4e61['length']+_0x334737(0xf39)),_0x1b7f69();}),document[_0x494435(0x479)](_0x494435(0x339))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x42fc5c=_0x494435;document[_0x42fc5c(0x479)]('share-target-modal')[_0x42fc5c(0x9cd)][_0x42fc5c(0x8b6)](_0x42fc5c(0x45a));}),document[_0x494435(0x479)](_0x494435(0x659))[_0x494435(0xa75)](_0x494435(0xd2f),_0x2eceb7=>{const _0x339637=_0x494435,_0x29009b=_0x2eceb7[_0x339637(0xfa2)][_0x339637(0x869)](_0x339637(0x818));if(_0x29009b&&_0x29009b['closest'](_0x339637(0x859))){const _0x39fdfd=parseInt(_0x29009b[_0x339637(0x13d4)][_0x339637(0x12a2)]);_0x26080c(_0x39fdfd);}}),document['getElementById']('close-shared-history-viewer-btn')[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x3f341a=_0x494435;document['getElementById'](_0x3f341a(0x1182))[_0x3f341a(0x9cd)]['remove'](_0x3f341a(0x45a));});async function _0x26080c(_0x2cc20f){const _0xbb62d3=_0x494435,_0x56c44d=_0x505390['chats'][_0x505390[_0xbb62d3(0x233)]],_0x87c87f=_0x56c44d['history'][_0xbb62d3(0xc0d)](_0x267407=>_0x267407[_0xbb62d3(0x12a2)]===_0x2cc20f);if(!_0x87c87f||_0x87c87f[_0xbb62d3(0x858)]!=='share_card'||!_0x87c87f[_0xbb62d3(0xdf8)]){console[_0xbb62d3(0xe3b)](_0xbb62d3(0xe9b),_0x2cc20f),await _0x1519c8(_0xbb62d3(0xa96),_0xbb62d3(0x99c));return;}const _0x2ffb12=document[_0xbb62d3(0x479)](_0xbb62d3(0x1182)),_0x3c7c57=document[_0xbb62d3(0x479)]('shared-history-viewer-title'),_0xc9439f=document[_0xbb62d3(0x479)]('shared-history-viewer-content');_0x3c7c57[_0xbb62d3(0x97b)]=_0x87c87f[_0xbb62d3(0xdf8)][_0xbb62d3(0xc29)],_0xc9439f[_0xbb62d3(0x3de)]='';const _0x47b47c=document[_0xbb62d3(0x3dd)](),_0x5bae7b=Object[_0xbb62d3(0x3d5)](_0x505390[_0xbb62d3(0x1027)])[_0xbb62d3(0xc0d)](_0x125e3d=>_0x125e3d[_0xbb62d3(0x564)]===_0x87c87f[_0xbb62d3(0xdf8)][_0xbb62d3(0xc9f)])||_0x56c44d;for(const _0x325cdc of _0x87c87f[_0xbb62d3(0xdf8)][_0xbb62d3(0x1e3)]){const _0x17adef=await _0x43c884(_0x325cdc,_0x5bae7b);_0x17adef&&_0x47b47c['appendChild'](_0x17adef);}_0xc9439f[_0xbb62d3(0x9f4)](_0x47b47c),_0x2ffb12[_0xbb62d3(0x9cd)][_0xbb62d3(0x807)](_0xbb62d3(0x45a));}_0x54d46a[_0x494435(0xa75)](_0x494435(0xa85),_0x2db015),_0x54d46a[_0x494435(0xa75)](_0x494435(0xa80),()=>{const _0x311791=_0x494435;_0x304e8d['isActive']&&(_0x304e8d[_0x311791(0x11c3)]=![],_0x2f97b8());}),_0x54d46a[_0x494435(0xa75)]('play',()=>{const _0x36463a=_0x494435;_0x304e8d[_0x36463a(0x4c3)]&&(_0x304e8d[_0x36463a(0x11c3)]=!![],_0x2f97b8());}),document[_0x494435(0x479)](_0x494435(0x817))['addEventListener'](_0x494435(0xd2f),async _0x96bc25=>{const _0x1350f4=_0x494435,_0x2d9b19=_0x96bc25['target'],_0x14c569=_0x2d9b19[_0x1350f4(0x869)](_0x1350f4(0xb18));if(_0x14c569){const _0x127b63=parseInt(_0x14c569[_0x1350f4(0x13d4)][_0x1350f4(0x959)]);!isNaN(_0x127b63)&&await _0x5744b4(_0x127b63);return;}const _0x57927e=_0x2d9b19['closest'](_0x1350f4(0x70d));if(_0x57927e){const _0x3d3f62=parseInt(_0x57927e[_0x1350f4(0x13d4)][_0x1350f4(0x959)]);if(isNaN(_0x3d3f62))return;await _0x4148d1(_0x3d3f62);return;}const _0x10d4b4=_0x2d9b19[_0x1350f4(0x869)](_0x1350f4(0x36c));if(_0x10d4b4){const _0x3a09e7=parseInt(_0x10d4b4[_0x1350f4(0x13d4)]['index']);if(isNaN(_0x3a09e7))return;const _0xd979d4=_0x304e8d['playlist'][_0x3a09e7],_0x26d255=await _0x1a9e79(_0x1350f4(0xd3e),'确定要从播放列表中删除《'+_0xd979d4[_0x1350f4(0x564)]+_0x1350f4(0x1e2));_0x26d255&&_0x2a6ace(_0x3a09e7);return;}const _0x5de726=_0x2d9b19[_0x1350f4(0x869)](_0x1350f4(0x372));if(_0x5de726){const _0x3ed859=_0x5de726['closest'](_0x1350f4(0xfe5)),_0x3363b9=Array['from'](_0x3ed859[_0x1350f4(0x8be)][_0x1350f4(0xb31)])['indexOf'](_0x3ed859);_0x3363b9>-0x1&&_0x589174(_0x3363b9);}}),document['querySelector'](_0x494435(0x4e2))[_0x494435(0xa75)](_0x494435(0xd2f),_0x4f6a2a=>{const _0x2847a2=_0x494435;if(!_0x54d46a[_0x2847a2(0x9d6)])return;const _0x59f265=_0x4f6a2a[_0x2847a2(0x1030)],_0x1b058b=_0x59f265[_0x2847a2(0x90a)],_0x5e7484=_0x4f6a2a[_0x2847a2(0xba9)];_0x54d46a[_0x2847a2(0x545)]=_0x5e7484/_0x1b058b*_0x54d46a['duration'];}),document['getElementById']('chat-messages')[_0x494435(0xa75)]('click',_0x3c55c5=>{const _0x36c670=_0x494435,_0x4828be=_0x3c55c5[_0x36c670(0xfa2)][_0x36c670(0x869)](_0x36c670(0xe31));if(_0x4828be){const _0xcadd2=_0x505390[_0x36c670(0x1027)][_0x505390[_0x36c670(0x233)]],_0x4324e1=_0x4828be[_0x36c670(0x869)](_0x36c670(0x10f6));if(_0xcadd2&&_0x4324e1){const _0x3f0e85=parseInt(_0x4324e1[_0x36c670(0x13d4)][_0x36c670(0x12a2)]),_0x513a5a=_0xcadd2[_0x36c670(0x7d3)]['find'](_0x478155=>_0x478155['timestamp']===_0x3f0e85);if(_0x513a5a&&_0x513a5a[_0x36c670(0x439)]){let _0x4c9890='';const _0x5eae0a=_0x513a5a[_0x36c670(0x439)];switch(_0x5eae0a[_0x36c670(0x4fa)]){case _0x36c670(0x56d):_0x4c9890=_0x36c670(0xcaf)+_0x5eae0a[_0x36c670(0x982)]+'\x22';break;case _0x36c670(0x5d5):case'ai_image':case _0x36c670(0xd84):_0x4c9890='[图片/文字图]\x20描述:\x20\x22'+_0x5eae0a[_0x36c670(0x982)]+'\x22';break;case _0x36c670(0x9bf):_0x4c9890=_0x36c670(0xc1a)+_0x5eae0a[_0x36c670(0x982)]+'\x22';break;case _0x36c670(0xb9e):_0x4c9890=_0x36c670(0x72d)+(_0x5eae0a[_0x36c670(0xffb)]||_0x36c670(0xb9f))+_0x36c670(0xb98)+_0x5eae0a[_0x36c670(0x982)];break;case _0x36c670(0x5f8):_0x4c9890='一条[转账]消息已被撤回。';break;default:_0x4c9890=_0x36c670(0xac3)+_0x5eae0a['originalType']+_0x36c670(0xf50)+JSON[_0x36c670(0x1308)](_0x5eae0a[_0x36c670(0x982)]);break;}_0x1519c8(_0x36c670(0x1344),_0x4c9890);}}}}),document['getElementById'](_0x494435(0x338))[_0x494435(0xa75)](_0x494435(0xd2f),_0x35976f),document[_0x494435(0x479)](_0x494435(0x1207))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0xab5b6=_0x494435;document[_0xab5b6(0x479)](_0xab5b6(0x723))[_0xab5b6(0x9cd)][_0xab5b6(0x8b6)](_0xab5b6(0x45a)),_0x30b101();}),document['getElementById']('add-new-category-btn')[_0x494435(0xa75)](_0x494435(0xd2f),_0xb5659e),document[_0x494435(0x479)]('existing-categories-list')[_0x494435(0xa75)](_0x494435(0xd2f),_0x1c245d=>{const _0x4acbe1=_0x494435;if(_0x1c245d[_0x4acbe1(0xfa2)][_0x4acbe1(0x9cd)][_0x4acbe1(0x658)]('delete-group-btn')){const _0x55af8f=parseInt(_0x1c245d[_0x4acbe1(0xfa2)]['dataset']['id']);_0x241026(_0x55af8f);}}),document[_0x494435(0x479)](_0x494435(0x32c))[_0x494435(0xa75)](_0x494435(0xd2f),_0x326b04),document[_0x494435(0x479)](_0x494435(0xb36))['addEventListener'](_0x494435(0xd2f),_0x2763d4),document[_0x494435(0x479)](_0x494435(0x11ec))[_0x494435(0xa75)](_0x494435(0xd2f),_0x1a9111),document['getElementById'](_0x494435(0xf9c))['addEventListener'](_0x494435(0xd2f),_0x4388b3),document['getElementById']('qzone-posts-list')['addEventListener']('input',_0x44ff49=>{const _0x6aeb4a=_0x494435;if(!_0x44ff49[_0x6aeb4a(0xfa2)][_0x6aeb4a(0x70e)](_0x6aeb4a(0x127d)))return;const _0x5a138f=_0x44ff49['target'],_0x39fa84=_0x5a138f[_0x6aeb4a(0x869)](_0x6aeb4a(0x662));if(!_0x39fa84)return;const _0x41ea33=_0x39fa84['querySelector'](_0x6aeb4a(0x12f4)),_0x46fbd1=_0x5a138f[_0x6aeb4a(0x4e0)],_0x57876a=_0x46fbd1[_0x6aeb4a(0xab4)](/@([\p{L}\w]*)$/u);if(_0x57876a){const _0x154ec8=new Set(),_0x597b68=_0x39fa84[_0x6aeb4a(0x8bc)](_0x6aeb4a(0x9ba))?.[_0x6aeb4a(0x97b)];if(_0x597b68)_0x154ec8['add'](_0x597b68);_0x39fa84[_0x6aeb4a(0x99e)](_0x6aeb4a(0x21b))[_0x6aeb4a(0x12be)](_0x4b523d=>{const _0x55e4c0=_0x6aeb4a;_0x154ec8[_0x55e4c0(0x807)](_0x4b523d['textContent'][_0x55e4c0(0x491)](':',''));}),_0x154ec8[_0x6aeb4a(0x1ea)](_0x505390['qzoneSettings'][_0x6aeb4a(0x904)]),_0x41ea33[_0x6aeb4a(0x3de)]='';if(_0x154ec8[_0x6aeb4a(0xa7a)]>0x0){const _0x4d7e68=_0x57876a[0x1];_0x154ec8[_0x6aeb4a(0x12be)](_0x4fa3de=>{const _0x477d1e=_0x6aeb4a;if(_0x4fa3de[_0x477d1e(0x1f8)]()[_0x477d1e(0x44f)](_0x4d7e68[_0x477d1e(0x1f8)]())){const _0x9f3e3=document[_0x477d1e(0xbd5)](_0x477d1e(0x6c8));_0x9f3e3[_0x477d1e(0xfd4)]=_0x477d1e(0xbdf),_0x9f3e3[_0x477d1e(0x97b)]=_0x4fa3de,_0x9f3e3[_0x477d1e(0xa75)]('mousedown',_0x498c0c=>{const _0x2864c4=_0x477d1e;_0x498c0c[_0x2864c4(0xd58)]();const _0x5dc537=_0x46fbd1[_0x2864c4(0x1323)](0x0,_0x57876a[_0x2864c4(0x959)])+('@'+_0x4fa3de+'\x20');_0x5a138f['value']=_0x5dc537,_0x41ea33['style']['display']=_0x2864c4(0xff8),_0x5a138f[_0x2864c4(0xc07)]();}),_0x41ea33['appendChild'](_0x9f3e3);}}),_0x41ea33[_0x6aeb4a(0x10dd)][_0x6aeb4a(0x678)]=_0x41ea33['children'][_0x6aeb4a(0x990)]>0x0?_0x6aeb4a(0xee3):_0x6aeb4a(0xff8);}else _0x41ea33[_0x6aeb4a(0x10dd)]['display']=_0x6aeb4a(0xff8);}else _0x41ea33[_0x6aeb4a(0x10dd)][_0x6aeb4a(0x678)]=_0x6aeb4a(0xff8);}),document['getElementById'](_0x494435(0xa1c))[_0x494435(0xa75)](_0x494435(0x8ad),_0xcfd8d7=>{const _0x978f87=_0x494435;if(_0xcfd8d7[_0x978f87(0xfa2)][_0x978f87(0x70e)](_0x978f87(0x127d))){const _0x564b17=_0xcfd8d7[_0x978f87(0xfa2)][_0x978f87(0x869)](_0x978f87(0x662));if(_0x564b17){const _0x1cb02c=_0x564b17[_0x978f87(0x8bc)](_0x978f87(0x12f4));_0x1cb02c&&setTimeout(()=>{const _0x3433bd=_0x978f87;_0x1cb02c[_0x3433bd(0x10dd)][_0x3433bd(0x678)]=_0x3433bd(0xff8);},0xc8);}}});const _0x60e542=document[_0x494435(0x479)](_0x494435(0x706)),_0x157512=document[_0x494435(0x479)](_0x494435(0x586));_0x60e542[_0x494435(0xa75)](_0x494435(0xa01),()=>{const _0xe5cdeb=_0x494435;if(!_0x505390['activeChatId']||!_0x505390['chats'][_0x505390[_0xe5cdeb(0x233)]]['isGroup']){_0x157512[_0xe5cdeb(0x10dd)]['display']=_0xe5cdeb(0xff8);return;}const _0x2bae22=_0x505390[_0xe5cdeb(0x1027)][_0x505390['activeChatId']],_0x1f7dc7=_0x60e542['value'],_0x4d7c72=_0x1f7dc7['match'](/@([\p{L}\w]*)$/u);if(_0x4d7c72){const _0x2b0aae=_0x2bae22[_0xe5cdeb(0x18a)][_0xe5cdeb(0xf58)]||'我',_0x4b6df1=_0x2bae22['members']['map'](_0x447ed=>_0x447ed[_0xe5cdeb(0xa54)])[_0xe5cdeb(0x85d)](_0x486eb7=>_0x486eb7!==_0x2b0aae);_0x157512[_0xe5cdeb(0x3de)]='';if(_0x4b6df1[_0xe5cdeb(0x990)]>0x0){const _0x56893c=_0x4d7c72[0x1];_0x4b6df1[_0xe5cdeb(0x12be)](_0x56f67c=>{const _0x251df7=_0xe5cdeb;if(_0x56f67c[_0x251df7(0x1f8)]()[_0x251df7(0x44f)](_0x56893c['toLowerCase']())){const _0x6b64db=document['createElement'](_0x251df7(0x6c8));_0x6b64db['className']=_0x251df7(0xbdf),_0x6b64db[_0x251df7(0x97b)]=_0x56f67c,_0x6b64db['addEventListener'](_0x251df7(0xee9),_0x524012=>{const _0x5d7b55=_0x251df7;_0x524012[_0x5d7b55(0xd58)]();const _0x34c0bb=_0x1f7dc7[_0x5d7b55(0x1323)](0x0,_0x4d7c72[_0x5d7b55(0x959)])+('@'+_0x56f67c+'\x20');_0x60e542[_0x5d7b55(0x4e0)]=_0x34c0bb,_0x157512[_0x5d7b55(0x10dd)][_0x5d7b55(0x678)]='none',_0x60e542[_0x5d7b55(0xc07)]();}),_0x157512[_0x251df7(0x9f4)](_0x6b64db);}}),_0x157512['style'][_0xe5cdeb(0x678)]=_0x157512[_0xe5cdeb(0xb31)][_0xe5cdeb(0x990)]>0x0?'block':'none';}else _0x157512[_0xe5cdeb(0x10dd)]['display']=_0xe5cdeb(0xff8);}else _0x157512['style'][_0xe5cdeb(0x678)]=_0xe5cdeb(0xff8);}),_0x60e542[_0x494435(0xa75)](_0x494435(0x100b),()=>{setTimeout(()=>{const _0x42530f=_0x6666;_0x157512[_0x42530f(0x10dd)][_0x42530f(0x678)]=_0x42530f(0xff8);},0xc8);}),document[_0x494435(0x479)](_0x494435(0xbfa))[_0x494435(0xa75)](_0x494435(0xd2f),_0x2c69dc),document[_0x494435(0x479)]('show-announcement-board-btn')[_0x494435(0xa75)](_0x494435(0xd2f),_0x1161f0),document[_0x494435(0x479)](_0x494435(0x7ef))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x537a74=_0x494435;document[_0x537a74(0x479)]('announcement-board-modal')[_0x537a74(0x9cd)][_0x537a74(0x8b6)](_0x537a74(0x45a));}),document[_0x494435(0x479)](_0x494435(0x1244))['addEventListener'](_0x494435(0xd2f),_0x17dc4a=>{const _0x1ec1d6=_0x494435;if(_0x17dc4a['target'][_0x1ec1d6(0x9cd)][_0x1ec1d6(0x658)](_0x1ec1d6(0x566))){const _0x39bc9f=_0x17dc4a[_0x1ec1d6(0xfa2)][_0x1ec1d6(0x13d4)][_0x1ec1d6(0xbef)];_0x39bc9f&&_0x3aceb9(_0x39bc9f);}}),document[_0x494435(0x479)]('announcement-action-pin')[_0x494435(0xa75)]('click',_0x5289e3),document[_0x494435(0x479)](_0x494435(0x9e9))[_0x494435(0xa75)]('click',_0x5a76c7),document[_0x494435(0x479)](_0x494435(0x76c))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x36b5c6=_0x494435;document['getElementById']('announcement-actions-modal')['classList'][_0x36b5c6(0x8b6)]('visible');}),document[_0x494435(0x479)](_0x494435(0x371))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0xb542fa=_0x494435;document['getElementById'](_0xb542fa(0x901))[_0xb542fa(0x4e0)]='';}),document['getElementById'](_0x494435(0xfe4))[_0x494435(0xa75)](_0x494435(0xd2f),_0x2c061b),document[_0x494435(0x479)](_0x494435(0xb33))['addEventListener'](_0x494435(0xd2f),()=>{const _0x171760=_0x494435;_0x731d5(_0x171760(0xdeb));}),document[_0x494435(0x479)](_0x494435(0x611))[_0x494435(0xa75)](_0x494435(0xd2f),_0x1dd2cd),document['getElementById'](_0x494435(0xe33))[_0x494435(0xa75)]('click',_0x53909a),document['getElementById']('memory-list-container')[_0x494435(0xa75)](_0x494435(0xd2f),_0x574b2a=>{const _0x2d6eef=_0x494435,_0x2a4694=_0x574b2a[_0x2d6eef(0xfa2)][_0x2d6eef(0x869)](_0x2d6eef(0xe48));if(_0x2a4694){_0x294f9b(_0x2a4694[_0x2d6eef(0x13d4)][_0x2d6eef(0x981)],parseInt(_0x2a4694[_0x2d6eef(0x13d4)]['memoryTimestamp']));return;}const _0x4f28cb=_0x574b2a['target'][_0x2d6eef(0x869)]('.delete-memory-btn');if(_0x4f28cb){_0x23c257(_0x4f28cb[_0x2d6eef(0x13d4)][_0x2d6eef(0x981)],parseInt(_0x4f28cb[_0x2d6eef(0x13d4)][_0x2d6eef(0x867)]));return;}}),document[_0x494435(0x479)]('gomoku-btn')[_0x494435(0xa75)](_0x494435(0xd2f),_0x9b6ea8),document[_0x494435(0x479)](_0x494435(0x73b))[_0x494435(0xa75)]('click',_0xe46500);const _0x18e848=document['getElementById']('gomoku-board');_0x18e848['addEventListener'](_0x494435(0xaf1),_0x4f2503),_0x18e848[_0x494435(0xa75)](_0x494435(0x9ad),()=>_0x29f68d(_0x505390[_0x494435(0x233)])),_0x18e848[_0x494435(0xa75)]('click',_0x2af529),document['getElementById'](_0x494435(0x130f))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x3dedf0=_0x494435;document[_0x3dedf0(0x479)](_0x3dedf0(0xbb2))[_0x3dedf0(0x4e0)]='',document[_0x3dedf0(0x479)](_0x3dedf0(0x138e))[_0x3dedf0(0x4e0)]='',document[_0x3dedf0(0x479)](_0x3dedf0(0x664))[_0x3dedf0(0x9cd)]['add']('visible');}),document[_0x494435(0x479)]('cancel-create-countdown-btn')['addEventListener']('click',()=>{const _0xbb6cb3=_0x494435;document[_0xbb6cb3(0x479)](_0xbb6cb3(0x664))[_0xbb6cb3(0x9cd)][_0xbb6cb3(0x8b6)](_0xbb6cb3(0x45a));}),document[_0x494435(0x479)](_0x494435(0xea5))['addEventListener'](_0x494435(0xd2f),_0x4cabd4),document[_0x494435(0x479)](_0x494435(0xde6))['addEventListener'](_0x494435(0xd2f),_0x387b2f),document['getElementById'](_0x494435(0x1ce))[_0x494435(0xa75)](_0x494435(0xd2f),_0x37b2fb),document[_0x494435(0x479)](_0x494435(0xff4))['addEventListener'](_0x494435(0xd2f),_0x196146),document[_0x494435(0x479)](_0x494435(0x1f7))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x3a58a5=_0x494435;document[_0x3a58a5(0x479)](_0x3a58a5(0x18e))[_0x3a58a5(0x9cd)][_0x3a58a5(0x8b6)](_0x3a58a5(0x45a));}),document['getElementById'](_0x494435(0xaaf))['addEventListener'](_0x494435(0xd2f),_0x370782),document[_0x494435(0x479)]('add-ai-response-block-btn')[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x23dc98=_0x494435,_0x5e788c=document['getElementById'](_0x23dc98(0x11ef)),_0xeb8896=_0x135fc1(_0x23dc98(0x562));_0x5e788c['appendChild'](_0xeb8896),_0xeb8896['querySelector']('textarea')['focus']();}),document[_0x494435(0x479)](_0x494435(0x4c1))[_0x494435(0xa75)](_0x494435(0xd2f),_0x35171f),document['getElementById'](_0x494435(0x3ba))[_0x494435(0xa75)](_0x494435(0xd2f),_0x21a1b8),document[_0x494435(0x479)](_0x494435(0x1347))['addEventListener'](_0x494435(0xd2f),_0x302e77),document[_0x494435(0x479)](_0x494435(0x8c1))['addEventListener'](_0x494435(0xd2f),()=>{const _0x5c6b73=_0x494435;document[_0x5c6b73(0x479)](_0x5c6b73(0xe3f))[_0x5c6b73(0xd2f)]();}),document['getElementById'](_0x494435(0xe3f))[_0x494435(0xa75)](_0x494435(0x1150),_0x54038f),document[_0x494435(0x479)]('add-my-avatar-batch-btn')[_0x494435(0xa75)]('click',async()=>{const _0x1a03f6=_0x494435,_0x775223=_0x1a03f6(0xbc7),_0x4de5aa=await _0x9a2c09(_0x1a03f6(0x5c1),_0x775223,'',_0x1a03f6(0x1283));_0x4de5aa&&_0x4de5aa[_0x1a03f6(0x9c1)]()&&await _0x4786bf(_0x4de5aa);}),document[_0x494435(0x479)]('open-shopping-btn')['addEventListener'](_0x494435(0xd2f),_0x21244a),document['getElementById']('shopping-back-btn')[_0x494435(0xa75)](_0x494435(0xd2f),()=>_0x731d5(_0x494435(0xdeb))),document[_0x494435(0x479)](_0x494435(0x5cb))['addEventListener'](_0x494435(0xd2f),_0x5e1eff),document[_0x494435(0x479)]('cart-back-btn')[_0x494435(0xa75)](_0x494435(0xd2f),_0x21244a),document[_0x494435(0x479)](_0x494435(0x11bf))[_0x494435(0xa75)](_0x494435(0xd2f),_0xa88787),document[_0x494435(0x479)](_0x494435(0xde1))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x329ebd=_0x494435;document['getElementById'](_0x329ebd(0x290))[_0x329ebd(0x9cd)]['remove'](_0x329ebd(0x45a));}),document[_0x494435(0x479)](_0x494435(0xe1e))[_0x494435(0xa75)]('click',()=>{const _0x210931=_0x494435;_0x179288=!_0x179288;const _0x2339f5=document[_0x210931(0x479)](_0x210931(0xe1e)),_0x3d5279=document[_0x210931(0x479)](_0x210931(0x1123)),_0x19714b=document[_0x210931(0x479)](_0x210931(0x864));_0x2339f5[_0x210931(0x10dd)][_0x210931(0x131f)]=_0x179288?'var(--accent-color)':'var(--text-primary)',_0x179288?(_0x3d5279['style'][_0x210931(0x678)]=_0x210931(0x899),_0x19714b[_0x210931(0x10dd)][_0x210931(0xa46)]=_0x210931(0x907)):(_0x3d5279[_0x210931(0x10dd)][_0x210931(0x678)]=_0x210931(0xff8),_0x19714b[_0x210931(0x10dd)][_0x210931(0xa46)]='',_0x1bb9d3[_0x210931(0xf8f)](),document[_0x210931(0x99e)](_0x210931(0xbe1))[_0x210931(0x12be)](_0x42dcdc=>_0x42dcdc[_0x210931(0x9cd)][_0x210931(0x8b6)](_0x210931(0x10dc))),document[_0x210931(0x479)]('delete-selected-products-btn')[_0x210931(0x97b)]=_0x210931(0x10e4),document[_0x210931(0x479)](_0x210931(0x50e))[_0x210931(0xf7b)]=![]),_0x4fdfe7(),_0x2de00f();}),document[_0x494435(0x479)](_0x494435(0xe44))['addEventListener']('click',()=>{const _0x2537d1=_0x494435;_0x179288?_0x4386ae(null):alert(_0x2537d1(0xa04));}),document[_0x494435(0x479)]('product-grid')[_0x494435(0xa75)](_0x494435(0xd2f),async _0x52edf5=>{const _0x375515=_0x494435,_0x115f53=_0x52edf5[_0x375515(0xfa2)]['closest'](_0x375515(0x3a3));if(!_0x115f53)return;const _0x478366=parseInt(_0x115f53['dataset']['id']);if(isNaN(_0x478366))return;if(_0x179288){if(_0x52edf5[_0x375515(0xfa2)][_0x375515(0x9cd)]['contains'](_0x375515(0x229))){_0x4386ae(_0x478366);return;}if(_0x52edf5[_0x375515(0xfa2)]['classList'][_0x375515(0x658)]('delete-product-btn')){const _0xd5ab63=await _0xb81d4e[_0x375515(0x13c1)]['get'](_0x478366);if(!_0xd5ab63)return;const _0x430362=await _0x1a9e79(_0x375515(0x1297),'确定要永久删除商品\x20“'+_0xd5ab63[_0x375515(0x564)]+_0x375515(0x7c7),{'confirmButtonClass':_0x375515(0x95a)});_0x430362&&(await _0xb81d4e[_0x375515(0x13c1)][_0x375515(0x1ea)](_0x478366),await _0x4fdfe7(),alert('商品已删除。'));return;}_0x115f53[_0x375515(0x9cd)][_0x375515(0x2bf)]('selected');_0x1bb9d3[_0x375515(0x391)](_0x478366)?_0x1bb9d3[_0x375515(0x1ea)](_0x478366):_0x1bb9d3[_0x375515(0x807)](_0x478366);document[_0x375515(0x479)]('delete-selected-products-btn')[_0x375515(0x97b)]=_0x375515(0x110b)+_0x1bb9d3[_0x375515(0xa7a)]+')';return;}if(_0x52edf5[_0x375515(0xfa2)][_0x375515(0x9cd)][_0x375515(0x658)]('add-to-cart-btn')){const _0x5477d3=await _0xb81d4e[_0x375515(0x13c1)][_0x375515(0x111a)](_0x478366);_0x5477d3[_0x375515(0xaa8)]&&_0x5477d3[_0x375515(0xaa8)][_0x375515(0x990)]>0x0?_0x49993d(_0x478366):(await _0x5a5593(_0x478366),await _0x1519c8('成功',_0x375515(0x400)));return;}_0x115f53[_0x375515(0x658)](_0x52edf5[_0x375515(0xfa2)])&&console[_0x375515(0x90f)](_0x375515(0x684)+_0x478366);}),document[_0x494435(0x479)](_0x494435(0x4de))[_0x494435(0xa75)](_0x494435(0xd2f),_0x39e042=>{const _0x51d103=_0x494435,_0x22d7e5=_0x39e042[_0x51d103(0xfa2)];_0x22d7e5['classList']['contains'](_0x51d103(0x8b7))&&_0x3eeedd(parseInt(_0x22d7e5[_0x51d103(0x13d4)]['id']),-0x1),_0x22d7e5[_0x51d103(0x9cd)][_0x51d103(0x658)](_0x51d103(0x4fe))&&_0x3eeedd(parseInt(_0x22d7e5['dataset']['id']),0x1),_0x22d7e5[_0x51d103(0x9cd)][_0x51d103(0x658)](_0x51d103(0x528))&&_0x321440();}),document['getElementById'](_0x494435(0xb2c))[_0x494435(0xa75)]('click',async()=>{if(_0x3972fd['length']===0x0)return;const _0x4aaaa9=await _0x1a9e79('清空购物车','确定要清空购物车中的所有商品吗？');_0x4aaaa9&&(_0x3972fd=[],_0x19a2a5(),_0x57303f());}),document[_0x494435(0x479)](_0x494435(0x359))['addEventListener'](_0x494435(0x1150),function(_0x39a53d){const _0x55242b=_0x494435;document['querySelectorAll'](_0x55242b(0x8e0))[_0x55242b(0x12be)](_0x49e4a6=>{const _0x39be11=_0x55242b;_0x49e4a6[_0x39be11(0xf7b)]=_0x39a53d[_0x39be11(0xfa2)]['checked'];}),_0x321440();}),document['getElementById'](_0x494435(0x267))[_0x494435(0xa75)]('click',()=>{const _0x43e0b5=_0x494435;document[_0x43e0b5(0x479)](_0x43e0b5(0x1e6))['classList'][_0x43e0b5(0x8b6)](_0x43e0b5(0x45a));}),document[_0x494435(0x479)](_0x494435(0x94d))[_0x494435(0xa75)](_0x494435(0xd2f),_0x18344e),document[_0x494435(0x479)](_0x494435(0x31a))[_0x494435(0xa75)](_0x494435(0x1150),_0x566c81=>{const _0x4b0df3=_0x494435,_0xd9e86e=_0x566c81[_0x4b0df3(0xfa2)][_0x4b0df3(0xe63)][0x0];if(_0xd9e86e){const _0x1c55f1=new FileReader();_0x1c55f1[_0x4b0df3(0x502)]=_0x711122=>{const _0x3f3f77=_0x4b0df3;document[_0x3f3f77(0x479)](_0x3f3f77(0x11ee))[_0x3f3f77(0xa9c)]=_0x711122[_0x3f3f77(0xfa2)]['result'];},_0x1c55f1[_0x4b0df3(0x83c)](_0xd9e86e);}}),document['getElementById'](_0x494435(0x659))['addEventListener']('click',_0x57459d=>{const _0x3d4053=_0x494435,_0x6179d2=_0x57459d[_0x3d4053(0xfa2)][_0x3d4053(0x869)](_0x3d4053(0x1160));if(_0x6179d2){const _0x3ff288=_0x6179d2[_0x3d4053(0x869)](_0x3d4053(0xc28));_0x3ff288&&_0x17b674(parseInt(_0x3ff288[_0x3d4053(0x13d4)][_0x3d4053(0x12a2)]));}}),document[_0x494435(0x479)](_0x494435(0x5e2))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x52e9c2=_0x494435;document[_0x52e9c2(0x479)](_0x52e9c2(0x767))[_0x52e9c2(0x9cd)][_0x52e9c2(0x8b6)]('visible');}),document['getElementById'](_0x494435(0xda9))[_0x494435(0xa75)](_0x494435(0xd2f),async()=>{const _0x33701f=_0x494435,_0x81e286=Array[_0x33701f(0x22f)](document[_0x33701f(0x99e)]('#gift-recipient-list\x20.contact-picker-item.selected'))[_0x33701f(0x2e1)](_0x157fed=>_0x157fed[_0x33701f(0x13d4)]['recipientName']);if(_0x81e286[_0x33701f(0x990)]===0x0){alert('请至少选择一位收礼人。');return;}const _0x4dff6a=_0x3972fd[_0x33701f(0x85d)](_0x1aa6b3=>document[_0x33701f(0x8bc)](_0x33701f(0xd99)+_0x1aa6b3[_0x33701f(0x613)]+_0x33701f(0xc64)));await _0x2b7510(_0x4dff6a,_0x81e286),document[_0x33701f(0x479)](_0x33701f(0x767))[_0x33701f(0x9cd)]['remove'](_0x33701f(0x45a));}),document['getElementById']('gift-recipient-list')[_0x494435(0xa75)]('click',_0x404fa5=>{const _0x4412de=_0x494435,_0x1040ca=_0x404fa5[_0x4412de(0xfa2)][_0x4412de(0x869)]('.contact-picker-item');_0x1040ca&&_0x1040ca[_0x4412de(0x9cd)][_0x4412de(0x2bf)](_0x4412de(0x10dc));}),document[_0x494435(0x479)]('select-all-recipients')['addEventListener'](_0x494435(0x1150),function(_0x1bf323){const _0xbca3ed=_0x494435,_0x38267c=_0x1bf323['target'][_0xbca3ed(0xf7b)];document[_0xbca3ed(0x99e)](_0xbca3ed(0xcaa))[_0xbca3ed(0x12be)](_0x5c4030=>{const _0x39305c=_0xbca3ed;_0x5c4030[_0x39305c(0x9cd)][_0x39305c(0x2bf)]('selected',_0x38267c);});}),document[_0x494435(0x479)](_0x494435(0x547))[_0x494435(0xa75)](_0x494435(0xd2f),_0x42c20a),document['getElementById']('regenerate-call-btn')['addEventListener'](_0x494435(0xd2f),_0x454410),document[_0x494435(0x479)]('propel-btn')[_0x494435(0xa75)]('click',_0x3c4a3e),document[_0x494435(0x479)](_0x494435(0xd26))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x2e5222=_0x494435,_0x28590d=document[_0x2e5222(0x479)](_0x2e5222(0x5af)),_0x41fa6c=document[_0x2e5222(0x479)](_0x2e5222(0x4cc))[_0x2e5222(0x4e0)][_0x2e5222(0x9c1)]()||_0x19106c;_0x28590d[_0x2e5222(0xa9c)]=_0x41fa6c,_0x28590d[_0x2e5222(0xe02)]()['catch'](_0x1819f7=>alert(_0x2e5222(0x885)));}),document[_0x494435(0x479)]('reset-sound-btn')[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x3cde42=_0x494435;document[_0x3cde42(0x479)](_0x3cde42(0x4cc))[_0x3cde42(0x4e0)]='',alert(_0x3cde42(0x2d3));}),document[_0x494435(0x479)](_0x494435(0x45f))[_0x494435(0xa75)](_0x494435(0xd2f),_0x5b4aa1=>{const _0x35306d=_0x494435,_0xb7fb46=_0x5b4aa1[_0x35306d(0xfa2)];_0xb7fb46[_0x35306d(0x9cd)][_0x35306d(0x658)]('editable-text')&&_0x1da0e9(_0xb7fb46),_0xb7fb46[_0x35306d(0x9cd)][_0x35306d(0x658)](_0x35306d(0x337))&&_0x604c0c(_0xb7fb46);}),document[_0x494435(0x479)](_0x494435(0xdf2))['addEventListener'](_0x494435(0xd2f),_0x4fd519),document[_0x494435(0x479)](_0x494435(0xbfe))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x2dbb40=_0x494435;document['getElementById']('music-search-results-modal')['classList'][_0x2dbb40(0x8b6)](_0x2dbb40(0x45a));}),document[_0x494435(0x479)](_0x494435(0xdf2))[_0x494435(0xa75)](_0x494435(0xd2f),_0x4fd519),document[_0x494435(0x479)](_0x494435(0xbfe))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x58b434=_0x494435;document[_0x58b434(0x479)]('music-search-results-modal')[_0x58b434(0x9cd)][_0x58b434(0x8b6)]('visible');}),document[_0x494435(0x479)](_0x494435(0x13e2))[_0x494435(0xa75)]('change',function(_0x541642){const _0x5a5d3a=_0x494435;document['querySelectorAll'](_0x5a5d3a(0x879))[_0x5a5d3a(0x12be)](_0x2a70ac=>{const _0x58bdca=_0x5a5d3a;_0x2a70ac[_0x58bdca(0xf7b)]=_0x541642[_0x58bdca(0xfa2)][_0x58bdca(0xf7b)];});}),document[_0x494435(0x479)](_0x494435(0x1af))['addEventListener'](_0x494435(0xd2f),_0x594859=>{const _0x429507=_0x494435,_0x3e3566=_0x594859[_0x429507(0xfa2)][_0x429507(0x869)]('.search-result-item');if(_0x3e3566){const _0x4cf8a7=_0x3e3566[_0x429507(0x8bc)]('.music-search-checkbox');_0x4cf8a7&&(_0x594859['target']!==_0x4cf8a7&&(_0x4cf8a7[_0x429507(0xf7b)]=!_0x4cf8a7['checked']));}}),document[_0x494435(0x479)](_0x494435(0xfd1))[_0x494435(0xa75)]('click',async()=>{const _0x4d439c=_0x494435,_0x4f1b87=document['querySelectorAll'](_0x4d439c(0x1042));if(_0x4f1b87['length']===0x0){alert(_0x4d439c(0x1107));return;}document['getElementById'](_0x4d439c(0x2e3))[_0x4d439c(0x9cd)][_0x4d439c(0x8b6)](_0x4d439c(0x45a)),await _0x1519c8(_0x4d439c(0xbd7),_0x4d439c(0x6ab)+_0x4f1b87[_0x4d439c(0x990)]+'\x20首歌曲...');const _0x34ea05=Array[_0x4d439c(0x22f)](_0x4f1b87)['map'](_0x522d2f=>JSON[_0x4d439c(0x94c)](_0x522d2f[_0x4d439c(0x869)](_0x4d439c(0x312))[_0x4d439c(0x13d4)]['songJson']));let _0x3fef3f=0x0,_0x8de937=[];const _0x39bc3d=_0x34ea05[_0x4d439c(0x2e1)](_0x3e7edc=>_0x1b4a5b(_0x3e7edc)),_0x2c1875=await Promise['all'](_0x39bc3d);_0x2c1875[_0x4d439c(0x12be)]((_0x1c4b0e,_0x1f33fc)=>{const _0x41f12f=_0x4d439c;_0x1c4b0e?(_0x304e8d[_0x41f12f(0x13c7)][_0x41f12f(0x1a0)](_0x1c4b0e),_0x3fef3f++):_0x8de937[_0x41f12f(0x1a0)](_0x34ea05[_0x1f33fc][_0x41f12f(0x564)]);});_0x3fef3f>0x0&&(await _0x120ddf(),_0x582392(),_0x304e8d[_0x4d439c(0x12a5)]===-0x1&&(_0x304e8d[_0x4d439c(0x12a5)]=_0x304e8d[_0x4d439c(0x13c7)][_0x4d439c(0x990)]-_0x3fef3f,_0x2f97b8()));let _0x5377d4=_0x4d439c(0x10bd)+_0x3fef3f+_0x4d439c(0xe9d);_0x8de937[_0x4d439c(0x990)]>0x0&&(_0x5377d4+='\x0a\x0a'+_0x8de937['length']+'\x20首歌曲获取失败:\x0a-\x20'+_0x8de937[_0x4d439c(0x35d)](_0x4d439c(0xfa6))),await _0x1519c8('操作结果',_0x5377d4);}),document[_0x494435(0x479)]('music-visual-container')['addEventListener'](_0x494435(0xd2f),()=>{const _0x39cc77=_0x494435;document['getElementById'](_0x39cc77(0xd28))[_0x39cc77(0x9cd)][_0x39cc77(0x2bf)](_0x39cc77(0xd37));}),document[_0x494435(0x479)](_0x494435(0xdf2))['addEventListener']('click',_0x4fd519),document[_0x494435(0x479)]('cancel-music-search-btn')[_0x494435(0xa75)]('click',()=>{const _0x5b49db=_0x494435;document[_0x5b49db(0x479)]('music-search-results-modal')[_0x5b49db(0x9cd)][_0x5b49db(0x8b6)](_0x5b49db(0x45a));}),document['getElementById']('search-results-list')[_0x494435(0xa75)](_0x494435(0xd2f),_0x21734b=>{const _0x39e20d=_0x494435,_0x28c987=_0x21734b[_0x39e20d(0xfa2)][_0x39e20d(0x869)](_0x39e20d(0x312));if(_0x28c987&&_0x28c987[_0x39e20d(0x13d4)][_0x39e20d(0x1256)]){const _0x5b8f7e=JSON[_0x39e20d(0x94c)](_0x28c987[_0x39e20d(0x13d4)]['songJson']);handleSearchResultClick(_0x5b8f7e);}}),document[_0x494435(0x479)](_0x494435(0xb6e))[_0x494435(0xa75)](_0x494435(0xd2f),_0x5c0e0a),document[_0x494435(0x479)](_0x494435(0x50d))[_0x494435(0xa75)](_0x494435(0xd2f),_0xef4e66),document[_0x494435(0x479)](_0x494435(0x974))[_0x494435(0xa75)](_0x494435(0xd2f),_0x2fce15),document[_0x494435(0x479)](_0x494435(0x20a))['addEventListener'](_0x494435(0xd2f),_0x112f61),document[_0x494435(0x479)](_0x494435(0xaad))[_0x494435(0xa75)](_0x494435(0x1150),()=>{const _0x47ddcd=_0x494435;_0x505390[_0x47ddcd(0x888)][_0x47ddcd(0x5d9)]=document[_0x47ddcd(0x479)]('status-bar-toggle-switch')[_0x47ddcd(0xf7b)],_0x2f6f58();}),document[_0x494435(0x479)]('qzone-more-actions-btn')[_0x494435(0xa75)]('click',_0x36e9ab),document[_0x494435(0x479)](_0x494435(0x397))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x5f0b18=_0x494435;document[_0x5f0b18(0x479)](_0x5f0b18(0x130b))['classList']['remove'](_0x5f0b18(0x45a));}),document[_0x494435(0x479)](_0x494435(0xa7e))['addEventListener'](_0x494435(0xd2f),_0x190dc5),document[_0x494435(0x479)]('clear-posts-list')[_0x494435(0xa75)](_0x494435(0xd2f),_0x117160=>{const _0x5c8f65=_0x494435,_0x3a38d3=_0x117160[_0x5c8f65(0xfa2)]['closest']('.clear-posts-item');_0x3a38d3&&_0x3a38d3[_0x5c8f65(0x9cd)]['toggle'](_0x5c8f65(0x10dc));}),document[_0x494435(0x479)](_0x494435(0x42e))[_0x494435(0xa75)](_0x494435(0x1150),async _0x4ce24f=>{const _0x2a907d=_0x494435,_0x2d2409=_0x4ce24f[_0x2a907d(0xfa2)][_0x2a907d(0xe63)][0x0];if(_0x2d2409){const _0x345110=await new Promise(_0x2bafaf=>{const _0x2607f9=_0x2a907d,_0x29447e=new FileReader();_0x29447e['onload']=()=>_0x2bafaf(_0x29447e[_0x2607f9(0x97e)]),_0x29447e[_0x2607f9(0x83c)](_0x2d2409);});_0x505390[_0x2a907d(0x888)][_0x2a907d(0x960)]=_0x345110,_0x2884ff();}_0x4ce24f[_0x2a907d(0xfa2)]['value']=null;}),document[_0x494435(0x479)](_0x494435(0x82d))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x2b608e=_0x494435;_0x505390[_0x2b608e(0x888)][_0x2b608e(0x960)]='',_0x2884ff();}),document[_0x494435(0x479)](_0x494435(0xce9))[_0x494435(0xa75)](_0x494435(0xd2f),async()=>{const _0x41f265=_0x494435;_0x1b68ba&&(_0x505390[_0x41f265(0x888)][_0x41f265(0x73f)]=_0x1b68ba),_0x505390[_0x41f265(0x888)][_0x41f265(0x215)]=document[_0x41f265(0x479)](_0x41f265(0x901))[_0x41f265(0x4e0)][_0x41f265(0x9c1)](),_0x505390[_0x41f265(0x888)][_0x41f265(0xb10)]=document[_0x41f265(0x479)](_0x41f265(0x4cc))[_0x41f265(0x4e0)][_0x41f265(0x9c1)](),_0x505390['globalSettings'][_0x41f265(0x5d9)]=document[_0x41f265(0x479)]('status-bar-toggle-switch')['checked'],await _0xb81d4e['globalSettings'][_0x41f265(0x5d0)](_0x505390[_0x41f265(0x888)]),_0x49ef38(),_0x1b68ba=null,_0x57595d(),_0x5cefa5(_0x505390[_0x41f265(0x888)]['globalCss']),_0x2f6f58(),alert('外观设置已保存并应用！'),_0x731d5(_0x41f265(0x45f));}),document[_0x494435(0x479)](_0x494435(0xd64))[_0x494435(0xa75)](_0x494435(0xd2f),async()=>{const _0x2901cc=_0x494435,_0x296daa=await _0x9a2c09(_0x2901cc(0x7b5),_0x2901cc(0x928),'',_0x2901cc(0x5f3));if(_0x296daa&&_0x296daa['trim']())_0x505390[_0x2901cc(0x888)]['globalChatBackground']=_0x296daa[_0x2901cc(0x9c1)](),_0x2884ff();else _0x296daa!==null&&alert(_0x2901cc(0xefb));}),document[_0x494435(0x479)](_0x494435(0x97a))[_0x494435(0xa75)](_0x494435(0xd2f),async()=>{const _0x51b2e2=_0x494435,_0x3a4c5b=await _0x9a2c09(_0x51b2e2(0x332),_0x51b2e2(0xc1e),'',_0x51b2e2(0x5f3));if(_0x3a4c5b&&_0x3a4c5b[_0x51b2e2(0x9c1)]())_0x1b68ba=_0x3a4c5b[_0x51b2e2(0x9c1)](),_0x2884ff();else _0x3a4c5b!==null&&alert(_0x51b2e2(0xefb));}),document[_0x494435(0x479)](_0x494435(0xed0))[_0x494435(0xa75)](_0x494435(0xd2f),async()=>{const _0x4781e5=_0x494435,_0x46797b=await _0x9a2c09(_0x4781e5(0xdb1),_0x4781e5(0xf41),'',_0x4781e5(0x5f3));if(_0x46797b&&_0x46797b['trim']())_0x505390[_0x4781e5(0x888)]['cphoneWallpaper']=_0x46797b[_0x4781e5(0x9c1)](),_0x2884ff();else _0x46797b!==null&&alert(_0x4781e5(0xefb));}),document[_0x494435(0x479)]('remove-ephone-bg-btn')[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x15697f=_0x494435;_0x1b68ba=null,_0x505390[_0x15697f(0x888)][_0x15697f(0x73f)]='',_0x2884ff();}),document[_0x494435(0x479)](_0x494435(0x107c))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x2074f7=_0x494435;_0x505390[_0x2074f7(0x888)][_0x2074f7(0x77b)]='',_0x2884ff();}),document[_0x494435(0x479)]('css-preset-select')[_0x494435(0xa75)](_0x494435(0x1150),_0x56ed69),document[_0x494435(0x479)]('save-css-preset-btn')[_0x494435(0xa75)](_0x494435(0xd2f),_0x4e6cc7),document[_0x494435(0x479)]('delete-css-preset-btn')[_0x494435(0xa75)](_0x494435(0xd2f),_0x5eab04),document['getElementById'](_0x494435(0xa7f))[_0x494435(0xa75)](_0x494435(0x1150),_0x3940d3),document['getElementById'](_0x494435(0x3a0))[_0x494435(0xa75)]('click',_0x52311d),document['getElementById']('delete-font-preset-btn')[_0x494435(0xa75)]('click',_0x3050f6),document['getElementById'](_0x494435(0xe5f))[_0x494435(0xa75)]('change',_0x5067db),document[_0x494435(0x479)](_0x494435(0xccf))[_0x494435(0xa75)](_0x494435(0xd2f),_0x25d1b3),document[_0x494435(0x479)]('delete-theme-preset-btn')[_0x494435(0xa75)](_0x494435(0xd2f),_0x2a9b6a),document['getElementById'](_0x494435(0xdd1))[_0x494435(0xa75)](_0x494435(0xd2f),_0x191e83),document[_0x494435(0x479)](_0x494435(0xe70))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x3c27ba=_0x494435;document['getElementById']('sticker-category-manager-modal')[_0x3c27ba(0x9cd)][_0x3c27ba(0x8b6)](_0x3c27ba(0x45a)),_0x46e430();}),document[_0x494435(0x479)](_0x494435(0x115c))[_0x494435(0xa75)](_0x494435(0xd2f),_0x6bacea),document[_0x494435(0x479)](_0x494435(0xbe4))[_0x494435(0xa75)]('click',_0x13b302=>{const _0x9dae4a=_0x494435;if(_0x13b302[_0x9dae4a(0xfa2)][_0x9dae4a(0x9cd)]['contains'](_0x9dae4a(0x970))){const _0x5462db=parseInt(_0x13b302[_0x9dae4a(0xfa2)]['dataset']['id']);_0x2566c6(_0x5462db);}}),document[_0x494435(0x479)](_0x494435(0x1101))[_0x494435(0xa75)](_0x494435(0xd2f),_0x11c9fd=>{const _0x5af718=_0x494435;if(_0x11c9fd[_0x5af718(0xfa2)]['classList']['contains'](_0x5af718(0x711))){const _0x525400=_0x11c9fd[_0x5af718(0xfa2)][_0x5af718(0x13d4)]['categoryId'],_0x14c231=_0x525400!==_0x5af718(0xf78)&&_0x525400!==_0x5af718(0x331)?parseInt(_0x525400):_0x525400;_0x27fdb3(_0x14c231);}}),document[_0x494435(0x479)](_0x494435(0x457))[_0x494435(0xa75)](_0x494435(0x1150),_0x268871),document['getElementById']('export-single-chat-btn')[_0x494435(0xa75)]('click',_0x36b53e),document[_0x494435(0x479)](_0x494435(0x295))['addEventListener']('click',()=>{const _0x27774c=_0x494435;document[_0x27774c(0x479)](_0x27774c(0x10ed))[_0x27774c(0xd2f)]();}),document[_0x494435(0x479)](_0x494435(0x10ed))['addEventListener'](_0x494435(0x1150),_0x30f4cc=>{const _0x174e8f=_0x494435,_0xae76ac=_0x30f4cc[_0x174e8f(0xfa2)][_0x174e8f(0xe63)][0x0];_0xae76ac&&_0x23c74a(_0xae76ac),_0x30f4cc[_0x174e8f(0xfa2)][_0x174e8f(0x4e0)]=null;}),document['getElementById'](_0x494435(0xfd0))['addEventListener'](_0x494435(0xd2f),()=>_0x85698d()),document['getElementById'](_0x494435(0x7ba))[_0x494435(0xa75)](_0x494435(0xd2f),()=>openDiaryEditor()),document[_0x494435(0x479)](_0x494435(0x9f7))['addEventListener'](_0x494435(0xd2f),_0xbb2f3b),document[_0x494435(0x479)](_0x494435(0xb14))['addEventListener'](_0x494435(0xd2f),_0x43f766),document[_0x494435(0x479)](_0x494435(0xc1b))[_0x494435(0xa75)](_0x494435(0xd2f),_0x1cab63),document[_0x494435(0x479)](_0x494435(0xd18))['addEventListener'](_0x494435(0xd2f),async()=>{const _0x3801d5=_0x494435;_0x1519c8(_0x3801d5(0x187),_0x3801d5(0x840));try{await Promise[_0x3801d5(0xf78)]([_0x5683e4(),_0x2d113a()]),console[_0x3801d5(0x90f)](_0x3801d5(0x12a3));}catch(_0x2bc151){console['error']('在同时执行两个函数时出错:',_0x2bc151),await _0x1519c8(_0x3801d5(0xaab),_0x3801d5(0x2ff)+_0x2bc151[_0x3801d5(0x757)]);}}),document[_0x494435(0x479)](_0x494435(0xf73))[_0x494435(0xa75)]('click',_0x592d73=>{const _0x419b04=_0x494435,_0x44a5d0=_0x592d73[_0x419b04(0xfa2)][_0x419b04(0x869)](_0x419b04(0x567));if(_0x44a5d0&&_0x44a5d0[_0x419b04(0x13d4)][_0x419b04(0x827)]){const _0x56767d=parseInt(_0x44a5d0[_0x419b04(0x13d4)][_0x419b04(0x827)]);!isNaN(_0x56767d)&&_0x41dc87(_0x56767d);}}),document['getElementById'](_0x494435(0x136a))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x581918=_0x494435;_0x1c532a(_0x581918(0x288));});const _0x162eb0=document[_0x494435(0x479)](_0x494435(0x5d2)),_0x4f4e2d=()=>{const _0x44181c=_0x494435;if(_0x5edca3!==_0x44181c(0x1343))return;if(_0x162eb0[_0x44181c(0x2b3)]<0x1&&!_0x4a165d){const _0xec0bb9=_0x505390[_0x44181c(0x1027)][_0x509091]?.[_0x44181c(0x7d3)][_0x44181c(0x990)]||0x0;_0xec0bb9>_0x55f419&&_0x57b7b0();}};_0x162eb0[_0x494435(0xa75)](_0x494435(0xe93),_0x4f4e2d),document['getElementById'](_0x494435(0xee1))[_0x494435(0xa75)]('click',()=>{const _0x22d4a5=_0x494435;alert(_0x22d4a5(0x11d7));}),document[_0x494435(0x479)](_0x494435(0x475))[_0x494435(0xa75)](_0x494435(0xd2f),_0x249031),document[_0x494435(0x479)](_0x494435(0x8b2))['addEventListener'](_0x494435(0xd2f),_0x5af8b2=>{const _0x5e1f6b=_0x494435,_0x3dd31f=_0x5af8b2[_0x5e1f6b(0xfa2)][_0x5e1f6b(0x869)](_0x5e1f6b(0xc15));if(_0x3dd31f&&_0x3dd31f[_0x5e1f6b(0x13d4)][_0x5e1f6b(0x78b)]){const _0x3dbafb=_0x3dd31f[_0x5e1f6b(0x13d4)]['description'];_0x1519c8(_0x5e1f6b(0xa74),_0x3dbafb['replace'](/\n/g,_0x5e1f6b(0x1043)));}}),document[_0x494435(0x479)](_0x494435(0x1220))['addEventListener'](_0x494435(0xd2f),_0x5b18de),document[_0x494435(0x479)](_0x494435(0x31f))[_0x494435(0xa75)](_0x494435(0xd2f),_0x2176fb),document['getElementById'](_0x494435(0x82c))[_0x494435(0xa75)](_0x494435(0xd2f),_0x58d55e=>{const _0x4a33a2=_0x494435,_0x4f0b13=_0x58d55e[_0x4a33a2(0xfa2)][_0x4a33a2(0x869)](_0x4a33a2(0x719));if(_0x4f0b13&&_0x4f0b13[_0x4a33a2(0x13d4)][_0x4a33a2(0xaac)]){const _0xf97882=_0x4f0b13['dataset'][_0x4a33a2(0xaac)];_0x1519c8(_0x4a33a2(0x9d0),_0xf97882['replace'](/\n/g,'<br>'));}}),window[_0x494435(0x12de)]=_0x366d5d,document[_0x494435(0x479)](_0x494435(0x1033))[_0x494435(0xa75)](_0x494435(0xd2f),_0x1de531),document[_0x494435(0x479)](_0x494435(0x497))[_0x494435(0xa75)](_0x494435(0xd2f),()=>_0x1c532a(_0x494435(0x9d2))),document[_0x494435(0x479)](_0x494435(0x12db))[_0x494435(0xa75)](_0x494435(0xd2f),_0x3969ed),document[_0x494435(0x479)](_0x494435(0x7ba))['addEventListener'](_0x494435(0xd2f),_0x244f25),document[_0x494435(0x479)](_0x494435(0xf21))[_0x494435(0xa75)](_0x494435(0xd2f),()=>_0x1c532a(_0x494435(0xd8c))),document[_0x494435(0x479)](_0x494435(0x995))[_0x494435(0xa75)](_0x494435(0xd2f),_0x4e20ea),document['getElementById']('regenerate-char-usage-btn')[_0x494435(0xa75)]('click',_0x576f1c),document[_0x494435(0x479)]('regenerate-char-music-btn')[_0x494435(0xa75)](_0x494435(0xd2f),_0x43936d),document[_0x494435(0x479)](_0x494435(0x65b))['addEventListener'](_0x494435(0xd2f),_0xd33c39),document[_0x494435(0x479)](_0x494435(0x1e7))[_0x494435(0xa75)](_0x494435(0xd2f),_0x3a2488),document[_0x494435(0x479)](_0x494435(0x1e7))[_0x494435(0xa75)]('click',_0x3a2488),document[_0x494435(0x479)](_0x494435(0x572))[_0x494435(0xa75)](_0x494435(0xd2f),()=>_0x731d5(_0x494435(0x9f8))),document[_0x494435(0x479)](_0x494435(0xd10))[_0x494435(0xa75)](_0x494435(0xd2f),_0x15c09f),document[_0x494435(0x479)](_0x494435(0xb04))['addEventListener'](_0x494435(0xd2f),_0x189087),document[_0x494435(0x479)]('cphone-wallpaper-upload-input')[_0x494435(0xa75)]('change',async _0x304d40=>{const _0x1e9267=_0x494435,_0x421c26=_0x304d40['target'][_0x1e9267(0xe63)][0x0];if(_0x421c26){const _0x5862c9=await new Promise(_0x90fb2b=>{const _0x5c8931=_0x1e9267,_0x2e1509=new FileReader();_0x2e1509[_0x5c8931(0x502)]=()=>_0x90fb2b(_0x2e1509[_0x5c8931(0x97e)]),_0x2e1509[_0x5c8931(0x83c)](_0x421c26);});_0x505390['globalSettings'][_0x1e9267(0x77b)]=_0x5862c9,_0x2884ff();}}),document[_0x494435(0x479)](_0x494435(0x262))['addEventListener']('click',_0x59b963=>{const _0x440054=_0x494435;if(_0x59b963['target'][_0x440054(0x9cd)][_0x440054(0x658)]('change-icon-btn')){const _0x43b1bb=_0x59b963[_0x440054(0xfa2)][_0x440054(0x869)](_0x440054(0xff3)),_0x28d423=_0x43b1bb[_0x440054(0x13d4)][_0x440054(0x23b)];_0x28d423&&_0x14a5e4(_0x28d423,_0x440054(0x728),_0x43b1bb);}}),document[_0x494435(0x479)]('import-appearance-btn')[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x1e1f88=_0x494435;document[_0x1e1f88(0x479)](_0x1e1f88(0xca8))[_0x1e1f88(0xd2f)]();}),document[_0x494435(0x479)]('import-appearance-input')[_0x494435(0xa75)](_0x494435(0x1150),_0x371cfc=>{const _0x29676d=_0x494435,_0x486d62=_0x371cfc[_0x29676d(0xfa2)]['files'][0x0];_0x486d62&&_0x5464a7(_0x486d62),_0x371cfc[_0x29676d(0xfa2)]['value']=null;}),document['addEventListener']('visibilitychange',()=>{const _0x3dcf58=_0x494435;document[_0x3dcf58(0xfbd)]===_0x3dcf58(0x6d8)&&(localStorage[_0x3dcf58(0x3f0)]('ephoneLastActiveTimestamp',Date[_0x3dcf58(0x12d6)]()),console[_0x3dcf58(0x90f)](_0x3dcf58(0x9e8)));}),document[_0x494435(0x479)]('export-world-book-btn')['addEventListener'](_0x494435(0xd2f),_0x56f7a0),document[_0x494435(0x479)]('import-world-book-btn')[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x4ea20d=_0x494435;document[_0x4ea20d(0x479)](_0x4ea20d(0xe5d))[_0x4ea20d(0xd2f)]();}),document['getElementById'](_0x494435(0xe5d))['addEventListener']('change',_0x54c977=>{const _0x16cca9=_0x494435,_0x56754a=_0x54c977[_0x16cca9(0xfa2)][_0x16cca9(0xe63)][0x0];_0x56754a&&_0x28a22a(_0x56754a),_0x54c977[_0x16cca9(0xfa2)][_0x16cca9(0x4e0)]=null;}),document['getElementById'](_0x494435(0xbfc))['addEventListener'](_0x494435(0x1150),async _0x4fffa6=>{const _0x560cbb=_0x494435,_0x455588=_0x4fffa6['target']['checked'];_0x505390['globalSettings'][_0x560cbb(0x105c)]=_0x455588,await _0xb81d4e['globalSettings'][_0x560cbb(0x5d0)](_0x505390[_0x560cbb(0x888)]);const _0x5f199d=document['querySelector'](_0x560cbb(0x8ee));if(_0x5f199d)switch(_0x5f199d['id']){case'chat-interface-screen':_0x474d6b(_0x505390[_0x560cbb(0x233)]);break;case'chat-list-screen':if(document[_0x560cbb(0x479)](_0x560cbb(0xc8d))[_0x560cbb(0x9cd)][_0x560cbb(0x658)](_0x560cbb(0x5a9)))_0x2eb20b();if(document[_0x560cbb(0x479)](_0x560cbb(0x980))['classList'][_0x560cbb(0x658)](_0x560cbb(0x5a9)))_0xafbc68();break;case _0x560cbb(0x9f8):_0x3ea0a9();break;case _0x560cbb(0x1aa):_0xe1098e(_0x2355c5);break;case _0x560cbb(0x13b2):const _0x74ac8b=document['querySelector']('.char-screen.active');if(_0x74ac8b)switch(_0x74ac8b['id']){case _0x560cbb(0x124b):_0x1af5d9();break;case _0x560cbb(0x112e):_0x29fa6a();break;case'char-browser-article-screen':const _0x3f20c9=_0x505390[_0x560cbb(0x1027)][_0x509091],_0x455730=_0x3f20c9[_0x560cbb(0xe2a)]||[],_0x1501ca=_0x455730[_0x560cbb(0x990)]>0x0?_0x455730[_0x560cbb(0x990)]-0x1:0x0;_0x251f96(_0x455730[_0x1501ca]);break;case _0x560cbb(0x3c7):_0x50569b();break;case _0x560cbb(0x288):_0x699e6f();break;case _0x560cbb(0x214):const _0x4edffe=document['querySelector'](_0x560cbb(0xbad))?.[_0x560cbb(0x13d4)][_0x560cbb(0x827)]||0x0;_0x41dc87(parseInt(_0x4edffe));break;}break;}_0x1519c8(_0x560cbb(0x595),_0x560cbb(0xf0e)+(_0x455588?'开启':'关闭')+'。');}),document[_0x494435(0x479)](_0x494435(0xd56))[_0x494435(0xa75)](_0x494435(0xd2f),_0x43813a),document[_0x494435(0x479)]('search-history-back-btn')['addEventListener']('click',()=>{const _0x26696a=_0x494435;_0x731d5(_0x26696a(0x67a));}),document['getElementById'](_0x494435(0xb80))[_0x494435(0xa75)]('click',_0x205c09),document[_0x494435(0x479)](_0x494435(0x4d4))[_0x494435(0xa75)](_0x494435(0xd2f),_0x3f4678),document[_0x494435(0x479)](_0x494435(0x1017))[_0x494435(0xa75)](_0x494435(0xd2f),_0x490708),document[_0x494435(0x479)](_0x494435(0x2a6))[_0x494435(0xa75)](_0x494435(0xd2f),_0x2f4385),document[_0x494435(0x8bc)]('#avatar-frame-modal\x20.modal-body')[_0x494435(0xa75)](_0x494435(0xd2f),_0x55b544=>{const _0x122bf2=_0x494435;if(_0x55b544[_0x122bf2(0xfa2)][_0x122bf2(0x9cd)][_0x122bf2(0x658)](_0x122bf2(0xbbd))){const _0x129197=parseInt(_0x55b544[_0x122bf2(0xfa2)][_0x122bf2(0x13d4)]['id']);!isNaN(_0x129197)&&_0x23f822(_0x129197);}}),_0x502741(),window[_0x494435(0xa8e)]=_0x36558b,document['getElementById'](_0x494435(0x197))[_0x494435(0xa75)](_0x494435(0xd2f),async()=>{const _0x49fb6e=_0x494435,_0x4f82d2=await _0x9a2c09(_0x49fb6e(0xd81),'请输入预设名称');if(_0x4f82d2&&_0x4f82d2[_0x49fb6e(0x9c1)]()){const _0x5430e4={'id':_0x49fb6e(0x75f)+Date['now'](),'name':_0x4f82d2[_0x49fb6e(0x9c1)](),'content':[]};await _0xb81d4e[_0x49fb6e(0xaa0)][_0x49fb6e(0x807)](_0x5430e4),await _0x26c096(),_0x496dc9(_0x5430e4['id']);}}),document[_0x494435(0x479)](_0x494435(0x105b))[_0x494435(0xa75)](_0x494435(0xd2f),_0x9f4091),document['getElementById'](_0x494435(0x11ba))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x4f6103=_0x494435,_0x24788c=document[_0x4f6103(0x479)]('preset-entries-container');_0x24788c['querySelector']('p')&&(_0x24788c[_0x4f6103(0x3de)]='');const _0x28b268=_0x503f27();_0x24788c[_0x4f6103(0x9f4)](_0x28b268),_0x28b268[_0x4f6103(0x8bc)]('.entry-content-textarea')[_0x4f6103(0xc07)]();}),document[_0x494435(0x479)](_0x494435(0xf29))[_0x494435(0xa75)]('click',async()=>{const _0x4634d3=_0x494435;if(!_0x2c61d3)return;const _0x325e20=await _0xb81d4e[_0x4634d3(0xaa0)]['get'](_0x2c61d3);if(!_0x325e20)return;const _0x751658=document['getElementById']('preset-name-input')['value'][_0x4634d3(0x9c1)]();if(!_0x751658){alert(_0x4634d3(0xff1));return;}_0x325e20['name']=_0x751658,_0x325e20[_0x4634d3(0x470)]=parseInt(document[_0x4634d3(0x479)]('preset-category-select')[_0x4634d3(0x4e0)])||null;const _0x4dd384=document[_0x4634d3(0x479)](_0x4634d3(0x5a0)),_0x26ec89=_0x4dd384[_0x4634d3(0x99e)]('.message-editor-block'),_0x2bbd70=[];_0x26ec89[_0x4634d3(0x12be)](_0x54e0f0=>{const _0x5f2c9d=_0x4634d3,_0x57ad54=_0x54e0f0[_0x5f2c9d(0x8bc)](_0x5f2c9d(0x389))[_0x5f2c9d(0x4e0)][_0x5f2c9d(0x9c1)]();_0x57ad54&&_0x2bbd70[_0x5f2c9d(0x1a0)]({'comment':_0x54e0f0[_0x5f2c9d(0x8bc)](_0x5f2c9d(0x6c7))[_0x5f2c9d(0x4e0)]['trim'](),'keys':(_0x54e0f0[_0x5f2c9d(0x8bc)]('.entry-keys-input')[_0x5f2c9d(0x4e0)]['trim']()||'')[_0x5f2c9d(0x53e)](',')[_0x5f2c9d(0x2e1)](_0x5c9bf6=>_0x5c9bf6[_0x5f2c9d(0x9c1)]())[_0x5f2c9d(0x85d)](Boolean),'content':_0x57ad54,'enabled':_0x54e0f0[_0x5f2c9d(0x8bc)](_0x5f2c9d(0x1195))['checked']});}),_0x325e20[_0x4634d3(0xac4)]=_0x2bbd70,await _0xb81d4e['presets'][_0x4634d3(0x5d0)](_0x325e20),_0x2c61d3=null,_0x731d5(_0x4634d3(0xc49)),await _0x26c096();}),document[_0x494435(0x479)]('import-preset-btn')[_0x494435(0xa75)]('click',()=>{const _0x26d2d2=_0x494435;document[_0x26d2d2(0x479)](_0x26d2d2(0x779))['click']();}),document['getElementById'](_0x494435(0x779))['addEventListener'](_0x494435(0x1150),_0x35d928),document['getElementById'](_0x494435(0x514))['addEventListener'](_0x494435(0xd2f),_0x38b1db),document[_0x494435(0x479)](_0x494435(0x72f))[_0x494435(0xa75)](_0x494435(0xd2f),_0x3be7e1),document[_0x494435(0x479)]('cancel-clear-wizard-btn-step1')[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x2e1c86=_0x494435;document[_0x2e1c86(0x479)](_0x2e1c86(0x1210))[_0x2e1c86(0x9cd)][_0x2e1c86(0x8b6)](_0x2e1c86(0x45a));}),document[_0x494435(0x479)]('go-to-clear-step2-btn')[_0x494435(0xa75)](_0x494435(0xd2f),_0xddbc58),document[_0x494435(0x479)](_0x494435(0x1187))[_0x494435(0xa75)](_0x494435(0xd2f),_0x353c55),document[_0x494435(0x479)]('cancel-clear-wizard-btn-step2')[_0x494435(0xa75)]('click',()=>{const _0x1a7215=_0x494435;document[_0x1a7215(0x479)](_0x1a7215(0x1210))[_0x1a7215(0x9cd)][_0x1a7215(0x8b6)](_0x1a7215(0x45a));}),document[_0x494435(0x479)]('confirm-final-clear-btn')[_0x494435(0xa75)](_0x494435(0xd2f),_0x2c263d),document[_0x494435(0x479)]('data-clear-wizard-modal')[_0x494435(0xa75)](_0x494435(0xd2f),_0x5ed0f3=>{const _0x287568=_0x494435,_0x37db3f=_0x5ed0f3['target'][_0x287568(0x869)](_0x287568(0x776));_0x37db3f&&(_0x5ed0f3[_0x287568(0x748)](),_0x37db3f[_0x287568(0x9cd)]['toggle'](_0x287568(0x10dc)));}),document[_0x494435(0x479)](_0x494435(0x1210))['addEventListener'](_0x494435(0x1150),_0x1d1d1c=>{const _0x5ec36a=_0x494435;if(_0x1d1d1c[_0x5ec36a(0xfa2)]['id']===_0x5ec36a(0xfa0)){const _0x169509=_0x1d1d1c[_0x5ec36a(0xfa2)][_0x5ec36a(0xf7b)];document[_0x5ec36a(0x99e)](_0x5ec36a(0x4dd))[_0x5ec36a(0x12be)](_0x59fc34=>{const _0x199867=_0x5ec36a;_0x59fc34[_0x199867(0x9cd)][_0x199867(0x2bf)]('selected',_0x169509);});}else{if(_0x1d1d1c[_0x5ec36a(0xfa2)]['id']===_0x5ec36a(0x250)){const _0x2df6fd=_0x1d1d1c['target'][_0x5ec36a(0xf7b)];document['querySelectorAll'](_0x5ec36a(0xc05))[_0x5ec36a(0x12be)](_0x4033e2=>{const _0x3e686d=_0x5ec36a;_0x4033e2[_0x3e686d(0x9cd)][_0x3e686d(0x2bf)](_0x3e686d(0x10dc),_0x2df6fd);});}}}),document[_0x494435(0x479)]('compress-images-btn')['addEventListener'](_0x494435(0xd2f),_0x54f3cf),document['getElementById'](_0x494435(0x610))[_0x494435(0xa75)](_0x494435(0xd2f),_0x472e40),document[_0x494435(0x479)](_0x494435(0x1285))[_0x494435(0xa75)](_0x494435(0xd2f),_0x5b37d1),document[_0x494435(0x479)]('npc-list-back-btn')[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x4484cd=_0x494435;_0x104a0f(_0x4484cd(0x770));}),document[_0x494435(0x479)]('add-npc-btn')[_0x494435(0xa75)]('click',()=>_0x2a76b9(null)),document['getElementById'](_0x494435(0xcd5))[_0x494435(0xa75)](_0x494435(0xd2f),_0x37cfc8),document[_0x494435(0x479)](_0x494435(0x11f1))['addEventListener'](_0x494435(0xd2f),()=>{const _0x3d7e3b=_0x494435;document[_0x3d7e3b(0x479)](_0x3d7e3b(0x29b))[_0x3d7e3b(0x9cd)][_0x3d7e3b(0x8b6)]('visible');}),document[_0x494435(0x479)](_0x494435(0xccb))[_0x494435(0xa75)](_0x494435(0x1150),_0x2af309=>{const _0xd2bb3a=_0x494435,_0x13d0bc=_0x2af309[_0xd2bb3a(0xfa2)][_0xd2bb3a(0xe63)][0x0];if(_0x13d0bc){const _0x48bb75=new FileReader();_0x48bb75[_0xd2bb3a(0x502)]=_0x3cdf02=>{const _0x3eb01d=_0xd2bb3a;document[_0x3eb01d(0x479)](_0x3eb01d(0x9d5))[_0x3eb01d(0xa9c)]=_0x3cdf02[_0x3eb01d(0xfa2)][_0x3eb01d(0x97e)];},_0x48bb75[_0xd2bb3a(0x83c)](_0x13d0bc);}}),document[_0x494435(0x479)](_0x494435(0x11ca))[_0x494435(0xa75)](_0x494435(0xd2f),_0x2d1f52=>{const _0x11558e=_0x494435;if(_0x2d1f52[_0x11558e(0xfa2)]['id']==='spectator-reroll-btn')_0x4e4289();else _0x2d1f52[_0x11558e(0xfa2)]['id']===_0x11558e(0x430)&&_0x196146();}),_0x33282f(document[_0x494435(0x479)](_0x494435(0xd28)),()=>{const _0x1cc053=_0x494435;_0x304e8d[_0x1cc053(0x12a5)]>-0x1&&_0x5744b4(_0x304e8d[_0x1cc053(0x12a5)]);}),document['getElementById'](_0x494435(0xffc))[_0x494435(0xa75)](_0x494435(0xd2f),_0x2553ab),document['getElementById'](_0x494435(0x718))[_0x494435(0xa75)](_0x494435(0xd2f),_0x3737ca),document['getElementById'](_0x494435(0xbff))['addEventListener'](_0x494435(0xd2f),()=>{const _0x249705=_0x494435;document['getElementById'](_0x249705(0x1386))[_0x249705(0x9cd)]['remove'](_0x249705(0x45a));}),document[_0x494435(0x479)](_0x494435(0x10f1))['addEventListener']('input',_0xcf1ad6=>{const _0x307131=_0x494435,_0x13a8f4=_0xcf1ad6[_0x307131(0xfa2)][_0x307131(0x4e0)][_0x307131(0x1f8)](),_0x4c1cff=document['getElementById'](_0x307131(0xda7));for(const _0x127851 of _0x4c1cff['options']){const _0x48a90d=_0x127851[_0x307131(0x97b)][_0x307131(0x1f8)]();_0x48a90d[_0x307131(0x44f)](_0x13a8f4)?_0x127851[_0x307131(0x10dd)]['display']='':_0x127851[_0x307131(0x10dd)]['display']=_0x307131(0xff8);}}),window[_0x494435(0x46e)]=_0x1e4cd5,document['getElementById'](_0x494435(0x6cd))[_0x494435(0xa75)](_0x494435(0xd2f),()=>_0x1e4cd5(_0x494435(0x1224))),document['getElementById'](_0x494435(0xc9e))[_0x494435(0xa75)]('click',()=>{const _0x5e2e9f=_0x494435;document[_0x5e2e9f(0x479)](_0x5e2e9f(0x1a3))[_0x5e2e9f(0x9cd)][_0x5e2e9f(0x8b6)]('visible');}),document[_0x494435(0x479)](_0x494435(0x4f1))[_0x494435(0xa75)](_0x494435(0xd2f),_0x4b25ad),document[_0x494435(0x479)]('werewolf-role-confirm-btn')['addEventListener'](_0x494435(0xd2f),()=>{const _0x310119=_0x494435;document['getElementById']('werewolf-role-modal')[_0x310119(0x9cd)][_0x310119(0x8b6)](_0x310119(0x45a)),_0x1a4323();}),document[_0x494435(0x479)](_0x494435(0x94a))['addEventListener'](_0x494435(0xd2f),async()=>{const _0x11ff27=_0x494435,_0x45d100=await _0x1a9e79('退出游戏','确定要退出当前这局狼人杀吗？游戏进度将不会被保存。',{'confirmButtonClass':'btn-danger'});_0x45d100&&(_0x511f5d[_0x11ff27(0x4c3)]=![],_0x731d5(_0x511f5d[_0x11ff27(0xd4e)]?_0x11ff27(0xdeb):'home-screen'));}),document[_0x494435(0x479)](_0x494435(0x7c1))['addEventListener'](_0x494435(0xd2f),()=>{const _0x3427b5=_0x494435;document[_0x3427b5(0x479)](_0x3427b5(0xe46))['classList']['remove'](_0x3427b5(0x45a)),_0x731d5(_0x511f5d[_0x3427b5(0xd4e)]?_0x3427b5(0xe34):_0x3427b5(0x45f));}),document[_0x494435(0x479)](_0x494435(0xc63))[_0x494435(0xa75)]('click',()=>{const _0x2a5f94=_0x494435;document[_0x2a5f94(0x479)](_0x2a5f94(0xc40))[_0x2a5f94(0x9cd)][_0x2a5f94(0x8b6)](_0x2a5f94(0x45a));}),document[_0x494435(0x479)](_0x494435(0xc9e))[_0x494435(0xa75)]('click',()=>{const _0x526c11=_0x494435;document[_0x526c11(0x479)](_0x526c11(0x1a3))['classList']['remove'](_0x526c11(0x45a));}),document[_0x494435(0x479)](_0x494435(0x733))['addEventListener']('click',_0x196341),document[_0x494435(0x479)](_0x494435(0x3a2))[_0x494435(0xa75)](_0x494435(0xd2f),_0x157816),document[_0x494435(0x479)]('check-and-fix-data-btn')[_0x494435(0xa75)](_0x494435(0xd2f),_0x2ef0d4),document[_0x494435(0x479)]('delete-world-books-btn')[_0x494435(0xa75)](_0x494435(0xd2f),_0x3da604),document[_0x494435(0x479)](_0x494435(0x893))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x123ad7=_0x494435;document['getElementById'](_0x123ad7(0xcd6))['classList']['remove'](_0x123ad7(0x45a));}),document[_0x494435(0x479)](_0x494435(0xba2))[_0x494435(0xa75)]('click',_0x272208),document[_0x494435(0x479)](_0x494435(0xcd6))[_0x494435(0xa75)](_0x494435(0xd2f),_0x1605bc=>{const _0x277a75=_0x494435,_0xeaa4a3=_0x1605bc[_0x277a75(0xfa2)][_0x277a75(0x869)](_0x277a75(0x776));_0xeaa4a3&&_0xeaa4a3['classList']['toggle'](_0x277a75(0x10dc));if(_0x1605bc[_0x277a75(0xfa2)]['id']==='select-all-world-books-for-clear'){const _0x54e09d=_0x1605bc[_0x277a75(0xfa2)]['checked'];document[_0x277a75(0x99e)](_0x277a75(0x7f5))[_0x277a75(0x12be)](_0x546000=>{const _0x1e15fb=_0x277a75;_0x546000[_0x1e15fb(0x9cd)][_0x1e15fb(0x2bf)](_0x1e15fb(0x10dc),_0x54e09d);});}}),document[_0x494435(0x479)](_0x494435(0x987))[_0x494435(0xa75)]('input',()=>{_0x46e430(![]);}),document['getElementById']('sticker-category-tabs')['addEventListener']('click',_0x2d63a6=>{const _0x1af751=_0x494435;if(_0x2d63a6[_0x1af751(0xfa2)]['classList'][_0x1af751(0x658)](_0x1af751(0x711))){const _0x4fd77e=_0x2d63a6[_0x1af751(0xfa2)][_0x1af751(0x13d4)]['categoryId'],_0x2141ff=_0x4fd77e!==_0x1af751(0xf78)&&_0x4fd77e!=='uncategorized'?parseInt(_0x4fd77e):_0x4fd77e;document['getElementById']('sticker-search-input')[_0x1af751(0x4e0)]='',_0x27fdb3(_0x2141ff);}});const _0x1dce08=document[_0x494435(0x479)](_0x494435(0x659));_0x1dce08[_0x494435(0xa75)]('scroll',()=>{const _0x4360d3=_0x494435;if(_0x1dce08[_0x4360d3(0x2b3)]<0x1&&!_0x5c1afa){const _0x4dd762=_0x505390[_0x4360d3(0x1027)][_0x505390[_0x4360d3(0x233)]]?.[_0x4360d3(0x7d3)][_0x4360d3(0x990)]||0x0;_0x4dd762>_0x1e729c&&_0x299b9f();}});const _0x32c04e=document[_0x494435(0x479)]('thoughts-history-list');_0x32c04e[_0x494435(0xa75)](_0x494435(0xe93),()=>{const _0x4cf609=_0x494435,{scrollTop:_0x112dbb,scrollHeight:_0x154c2b,clientHeight:_0x2ea300}=_0x32c04e;if(_0x154c2b-_0x112dbb<=_0x2ea300+0x32&&!_0x393522){const _0x13f7a7=_0x505390[_0x4cf609(0x1027)][_0x505390[_0x4cf609(0x233)]]?.[_0x4cf609(0x57e)][_0x4cf609(0x990)]||0x0;_0x13f7a7>_0xd87e3c&&_0x44d3b7();}});const _0x58047c=document[_0x494435(0x8bc)](_0x494435(0xde4));_0x58047c['addEventListener']('scroll',()=>{const _0x546743=_0x494435,{scrollTop:_0x4d0443,scrollHeight:_0x52c5bd,clientHeight:_0x14cf80}=_0x58047c;_0x52c5bd-_0x4d0443<=_0x14cf80+0x64&&!_0xfa7cf0&&(_0x5a98bc[_0x546743(0x990)]>_0xf8ae5e&&_0x163d7a());}),document[_0x494435(0x479)](_0x494435(0x1179))[_0x494435(0xa75)](_0x494435(0xd2f),_0x3a3b09);const _0x572969=document[_0x494435(0x479)]('reading-restore-btn');_0x58c937(_0x572969,_0x572969),document['getElementById']('close-reading-btn')['addEventListener'](_0x494435(0xd2f),_0x1cbcba),document[_0x494435(0x479)](_0x494435(0x653))[_0x494435(0xa75)](_0x494435(0xd2f),_0x2a7b44),document['getElementById'](_0x494435(0x531))[_0x494435(0xa75)](_0x494435(0xd2f),_0x408d73),document[_0x494435(0x479)]('prev-page-btn')['addEventListener'](_0x494435(0xd2f),_0x126658),document[_0x494435(0x479)](_0x494435(0x1354))[_0x494435(0xa75)](_0x494435(0x1150),_0x5107bf),document[_0x494435(0x479)]('minimize-reading-btn')[_0x494435(0xa75)](_0x494435(0xd2f),_0x1cefc0),document['getElementById'](_0x494435(0x192))[_0x494435(0xa75)](_0x494435(0xd2f),_0x3a597c),_0x58c937(document[_0x494435(0x479)](_0x494435(0x10cb)),document[_0x494435(0x8bc)](_0x494435(0x8d5))),document[_0x494435(0x479)](_0x494435(0x653))[_0x494435(0xa75)](_0x494435(0xd2f),_0x2a7b44),document[_0x494435(0x479)](_0x494435(0xb9d))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0xd30c89=_0x494435;document['getElementById'](_0xd30c89(0xf2d))[_0xd30c89(0x9cd)][_0xd30c89(0x8b6)](_0xd30c89(0x45a));}),document[_0x494435(0x479)](_0x494435(0x316))[_0x494435(0xa75)](_0x494435(0xd2f),_0x5e5956),document[_0x494435(0x479)]('reading-library-list')[_0x494435(0xa75)](_0x494435(0xd2f),_0x4ffc32=>{const _0x4c92a0=_0x494435,_0x25f484=_0x4ffc32['target'];if(_0x25f484[_0x4c92a0(0x9cd)][_0x4c92a0(0x658)]('group-name')){const _0xb25166=parseInt(_0x25f484[_0x4c92a0(0x13d4)][_0x4c92a0(0x1124)]);_0xa9ed10(_0xb25166);}else{if(_0x25f484[_0x4c92a0(0x9cd)]['contains'](_0x4c92a0(0x970))){const _0x3e350b=parseInt(_0x25f484[_0x4c92a0(0x13d4)][_0x4c92a0(0x1124)]);_0x6b53a0(_0x3e350b);}}}),document['getElementById'](_0x494435(0x11a5))[_0x494435(0xa75)](_0x494435(0xd2f),_0x5cc7b8),document['getElementById'](_0x494435(0x5ec))['addEventListener'](_0x494435(0xa01),_0xb042c6=>{const _0x1b00cb=_0x494435;_0x5eeb7f(_0xb042c6[_0x1b00cb(0xfa2)][_0x1b00cb(0x4e0)]);});const _0x211bcf=_0x153d21(_0x3cb1bd,0x12c);document[_0x494435(0x479)](_0x494435(0x7af))[_0x494435(0xa75)](_0x494435(0xe93),_0x211bcf),document['getElementById'](_0x494435(0x1127))[_0x494435(0xa75)](_0x494435(0xa01),_0x55437a=>{const _0x3369d3=_0x494435;document[_0x3369d3(0x479)]('api-temperature-value')['textContent']=_0x55437a[_0x3369d3(0xfa2)]['value'];});const _0x2c8e83=document[_0x494435(0x479)](_0x494435(0x770));_0x2c8e83[_0x494435(0xa75)](_0x494435(0xe93),()=>{const {scrollTop:_0x151adf,scrollHeight:_0x320ff,clientHeight:_0x142654}=_0x2c8e83;_0x320ff-_0x151adf<=_0x142654+0x96&&!_0xc050fd&&_0x598558();}),document[_0x494435(0x479)]('manage-product-categories-btn')[_0x494435(0xa75)](_0x494435(0xd2f),_0x7e784b),document[_0x494435(0x479)]('close-product-category-manager-btn')[_0x494435(0xa75)]('click',()=>{const _0x2ff331=_0x494435;document[_0x2ff331(0x479)]('product-category-manager-modal')['classList'][_0x2ff331(0x8b6)]('visible'),_0x4386ae(_0xcb90ce);}),document[_0x494435(0x479)](_0x494435(0x1c2))[_0x494435(0xa75)](_0x494435(0xd2f),_0x368475),document[_0x494435(0x479)]('existing-product-categories-list')['addEventListener'](_0x494435(0xd2f),_0x131a2f=>{const _0x436f48=_0x494435;_0x131a2f['target'][_0x436f48(0x9cd)][_0x436f48(0x658)](_0x436f48(0x970))&&_0x378ad1(parseInt(_0x131a2f[_0x436f48(0xfa2)][_0x436f48(0x13d4)]['id']));}),document[_0x494435(0x479)](_0x494435(0x425))[_0x494435(0xa75)]('click',()=>_0x195912()),document[_0x494435(0x479)](_0x494435(0x474))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x42e171=_0x494435;document[_0x42e171(0x479)]('variation-selection-modal')[_0x42e171(0x9cd)]['remove'](_0x42e171(0x45a));}),document['getElementById'](_0x494435(0xc6e))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x4ec911=_0x494435,_0x20d18d=document['getElementById']('variation-quantity-display');let _0xba5a6f=parseInt(_0x20d18d[_0x4ec911(0x97b)]);if(_0xba5a6f>0x1)_0x20d18d[_0x4ec911(0x97b)]=_0xba5a6f-0x1;}),document[_0x494435(0x479)](_0x494435(0x76f))['addEventListener']('click',()=>{const _0x379b30=_0x494435,_0x259bc2=document[_0x379b30(0x479)]('variation-quantity-display');_0x259bc2[_0x379b30(0x97b)]=parseInt(_0x259bc2['textContent'])+0x1;}),document[_0x494435(0x479)]('product-category-tabs')[_0x494435(0xa75)](_0x494435(0xd2f),_0x1d2a4a=>{const _0x1c33c0=_0x494435;if(_0x1d2a4a[_0x1c33c0(0xfa2)][_0x1c33c0(0x9cd)][_0x1c33c0(0x658)]('product-category-tab')){const _0x1b2755=_0x1d2a4a['target'][_0x1c33c0(0x13d4)]['categoryId']===_0x1c33c0(0xf78)?_0x1c33c0(0xf78):parseInt(_0x1d2a4a[_0x1c33c0(0xfa2)][_0x1c33c0(0x13d4)][_0x1c33c0(0x470)]);_0x400b0c(_0x1b2755);}}),document[_0x494435(0x479)]('generate-shopping-items-btn')[_0x494435(0xa75)](_0x494435(0xd2f),_0x4235dc),document[_0x494435(0x479)](_0x494435(0xc4b))[_0x494435(0xa75)](_0x494435(0xd2f),_0x3f56d3),document[_0x494435(0x479)]('save-shopping-settings-btn')[_0x494435(0xa75)](_0x494435(0xd2f),_0xa122aa),document[_0x494435(0x479)](_0x494435(0xec8))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x4bd9bf=_0x494435;document[_0x4bd9bf(0x479)](_0x4bd9bf(0x11a9))[_0x4bd9bf(0x9cd)][_0x4bd9bf(0x8b6)](_0x4bd9bf(0x45a));}),document['getElementById'](_0x494435(0x50e))[_0x494435(0xa75)]('change',_0x5109a8=>{const _0x16f027=_0x494435,_0x23c7b6=_0x5109a8[_0x16f027(0xfa2)]['checked'],_0x45185f=document[_0x16f027(0x99e)](_0x16f027(0x13a5));_0x45185f[_0x16f027(0x12be)](_0x51a61b=>{const _0x428545=_0x16f027,_0x2ad33e=parseInt(_0x51a61b[_0x428545(0x13d4)]['id']);_0x51a61b[_0x428545(0x9cd)]['toggle'](_0x428545(0x10dc),_0x23c7b6),_0x23c7b6?_0x1bb9d3[_0x428545(0x807)](_0x2ad33e):_0x1bb9d3[_0x428545(0x1ea)](_0x2ad33e);}),document[_0x16f027(0x479)]('delete-selected-products-btn')['textContent']=_0x16f027(0x110b)+_0x1bb9d3['size']+')';}),document['getElementById'](_0x494435(0x1157))[_0x494435(0xa75)](_0x494435(0xd2f),async()=>{const _0x360a5c=_0x494435;if(_0x1bb9d3[_0x360a5c(0xa7a)]===0x0){alert(_0x360a5c(0xf96));return;}const _0x2bef24=await _0x1a9e79(_0x360a5c(0x587),_0x360a5c(0xf25)+_0x1bb9d3[_0x360a5c(0xa7a)]+'\x20个商品吗？此操作不可恢复。',{'confirmButtonClass':_0x360a5c(0x95a)});_0x2bef24&&(await _0xb81d4e[_0x360a5c(0x13c1)][_0x360a5c(0x12f5)]([..._0x1bb9d3]),document[_0x360a5c(0x479)]('manage-products-btn')[_0x360a5c(0xd2f)](),await _0x4fdfe7(),await _0x1519c8('成功',_0x360a5c(0x1f5)));}),document[_0x494435(0x479)](_0x494435(0x9c6))[_0x494435(0xa75)](_0x494435(0x1150),_0xd3d814),document['getElementById'](_0x494435(0x955))[_0x494435(0xa75)](_0x494435(0xd2f),_0x5e32b6),document[_0x494435(0x479)]('delete-appearance-preset-btn')[_0x494435(0xa75)]('click',_0xb73418),document[_0x494435(0x479)]('novelai-switch')[_0x494435(0xa75)](_0x494435(0x1150),_0x2f2a0a=>{const _0x14ff6e=_0x494435,_0x5942d2=document[_0x14ff6e(0x479)](_0x14ff6e(0x2b6));_0x5942d2[_0x14ff6e(0x10dd)]['display']=_0x2f2a0a[_0x14ff6e(0xfa2)][_0x14ff6e(0xf7b)]?_0x14ff6e(0xee3):_0x14ff6e(0xff8);}),document[_0x494435(0x479)]('novelai-key-toggle')['addEventListener'](_0x494435(0xd2f),function(){const _0x4e2b7a=_0x494435,_0x6b7507=document['getElementById']('novelai-api-key');_0x6b7507['type']===_0x4e2b7a(0xb7d)?(_0x6b7507['type']=_0x4e2b7a(0x56d),this['textContent']='😌'):(_0x6b7507[_0x4e2b7a(0x858)]=_0x4e2b7a(0xb7d),this['textContent']='🧐');}),document['getElementById'](_0x494435(0x1a1))[_0x494435(0xa75)]('click',()=>{const _0x35b12d=_0x494435;_0x5efd56(),document[_0x35b12d(0x479)](_0x35b12d(0x138a))[_0x35b12d(0x10dd)][_0x35b12d(0x678)]=_0x35b12d(0x899);}),document[_0x494435(0x479)](_0x494435(0xff0))['addEventListener'](_0x494435(0x1150),_0x4d969b=>{const _0x1cc65f=_0x494435,_0x3c6e1b=document[_0x1cc65f(0x479)](_0x1cc65f(0x100d));_0x4d969b[_0x1cc65f(0xfa2)][_0x1cc65f(0x4e0)]===_0x1cc65f(0x13f7)?_0x3c6e1b[_0x1cc65f(0x10dd)][_0x1cc65f(0x678)]=_0x1cc65f(0xee3):_0x3c6e1b[_0x1cc65f(0x10dd)][_0x1cc65f(0x678)]=_0x1cc65f(0xff8);}),document[_0x494435(0x479)]('close-novelai-settings')[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x17d537=_0x494435;document['getElementById'](_0x17d537(0x138a))[_0x17d537(0x10dd)][_0x17d537(0x678)]=_0x17d537(0xff8);}),document['getElementById']('save-nai-settings-btn')[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x2c6388=_0x494435;_0x59c1ac(),document['getElementById'](_0x2c6388(0x138a))[_0x2c6388(0x10dd)]['display']='none',alert(_0x2c6388(0x122f));}),document[_0x494435(0x479)](_0x494435(0xc5e))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x11af5a=_0x494435;confirm(_0x11af5a(0x882))&&_0x55aca3();}),document[_0x494435(0x479)](_0x494435(0x941))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x1eac39=_0x494435,_0x30451c=document[_0x1eac39(0x479)](_0x1eac39(0x6b2))[_0x1eac39(0x4e0)][_0x1eac39(0x9c1)]();if(!_0x30451c){alert(_0x1eac39(0x480));return;}document[_0x1eac39(0x479)](_0x1eac39(0x7c3))[_0x1eac39(0x10dd)][_0x1eac39(0x678)]=_0x1eac39(0x899),document[_0x1eac39(0x479)](_0x1eac39(0xb93))[_0x1eac39(0x10dd)][_0x1eac39(0x678)]=_0x1eac39(0xff8),document['getElementById'](_0x1eac39(0xbe3))[_0x1eac39(0x10dd)][_0x1eac39(0x678)]='none';}),document[_0x494435(0x479)]('close-novelai-test')['addEventListener']('click',()=>{const _0x2b644f=_0x494435;document['getElementById']('novelai-test-modal')[_0x2b644f(0x10dd)][_0x2b644f(0x678)]=_0x2b644f(0xff8);}),document[_0x494435(0x479)]('close-nai-test-btn')[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0xc80585=_0x494435;document[_0xc80585(0x479)](_0xc80585(0x7c3))[_0xc80585(0x10dd)][_0xc80585(0x678)]='none';}),document[_0x494435(0x479)](_0x494435(0x12ac))[_0x494435(0xa75)](_0x494435(0xd2f),async()=>{await _0x36e03d();}),document['getElementById']('nai-download-btn')[_0x494435(0xa75)]('click',()=>{const _0x374f23=_0x494435,_0x5e6a9f=document[_0x374f23(0x479)](_0x374f23(0x8f1)),_0x4f08ae=document[_0x374f23(0xbd5)]('a');_0x4f08ae[_0x374f23(0x2fa)]=_0x5e6a9f[_0x374f23(0xa9c)],_0x4f08ae[_0x374f23(0x11d0)]=_0x374f23(0x1257)+Date[_0x374f23(0x12d6)]()+_0x374f23(0x1200),_0x4f08ae[_0x374f23(0xd2f)]();}),document[_0x494435(0x479)](_0x494435(0x532))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x5c7500=_0x494435;if(!_0x505390[_0x5c7500(0x233)])return;const _0x57547d=_0x505390['chats'][_0x505390[_0x5c7500(0x233)]],_0x420de3=_0x57547d['settings']['naiSettings']||{'promptSource':_0x5c7500(0xbaa),'characterPositivePrompt':'','characterNegativePrompt':''};document[_0x5c7500(0x479)](_0x5c7500(0x459))[_0x5c7500(0x4e0)]=_0x420de3[_0x5c7500(0x69c)]||'',document[_0x5c7500(0x479)](_0x5c7500(0x13c3))[_0x5c7500(0x4e0)]=_0x420de3[_0x5c7500(0x327)]||'',document[_0x5c7500(0x479)](_0x5c7500(0x36d))[_0x5c7500(0x10dd)]['display']=_0x5c7500(0x899);}),document[_0x494435(0x479)]('close-character-nai-prompts')[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x53b91d=_0x494435;document[_0x53b91d(0x479)](_0x53b91d(0x36d))['style'][_0x53b91d(0x678)]='none';}),document[_0x494435(0x479)](_0x494435(0x2ea))['addEventListener']('click',async()=>{const _0xef2884=_0x494435;if(!_0x505390[_0xef2884(0x233)])return;const _0x247842=_0x505390[_0xef2884(0x1027)][_0x505390[_0xef2884(0x233)]];!_0x247842[_0xef2884(0x18a)][_0xef2884(0x12bf)]&&(_0x247842[_0xef2884(0x18a)][_0xef2884(0x12bf)]={'promptSource':_0xef2884(0xbaa)}),_0x247842[_0xef2884(0x18a)][_0xef2884(0x12bf)][_0xef2884(0x69c)]=document[_0xef2884(0x479)](_0xef2884(0x459))['value'][_0xef2884(0x9c1)](),_0x247842['settings'][_0xef2884(0x12bf)][_0xef2884(0x327)]=document[_0xef2884(0x479)](_0xef2884(0x13c3))[_0xef2884(0x4e0)][_0xef2884(0x9c1)](),console[_0xef2884(0x90f)](_0xef2884(0xf53)),console[_0xef2884(0x90f)](_0xef2884(0xd6a),_0x247842[_0xef2884(0x18a)]['naiSettings'][_0xef2884(0x69c)]),console[_0xef2884(0x90f)](_0xef2884(0x55c),_0x247842[_0xef2884(0x18a)][_0xef2884(0x12bf)][_0xef2884(0x327)]),console[_0xef2884(0x90f)](_0xef2884(0xbc0),_0x247842['settings'][_0xef2884(0x12bf)][_0xef2884(0x139f)]),await _0xb81d4e[_0xef2884(0x1027)][_0xef2884(0x5d0)](_0x247842),document[_0xef2884(0x479)](_0xef2884(0x36d))['style'][_0xef2884(0x678)]='none',alert(_0xef2884(0xbb5));}),document[_0x494435(0x479)](_0x494435(0x9a8))[_0x494435(0xa75)]('click',()=>{const _0x636ef5=_0x494435;confirm('确定要清空当前角色的NAI提示词配置吗？')&&(document[_0x636ef5(0x479)]('character-nai-positive')[_0x636ef5(0x4e0)]='',document[_0x636ef5(0x479)](_0x636ef5(0x13c3))['value']='');}),document['getElementById'](_0x494435(0xbcd))['addEventListener'](_0x494435(0xd2f),()=>{const _0x52e324=_0x494435;if(!_0x505390[_0x52e324(0x233)])return;const _0xc32fbd=_0x505390[_0x52e324(0x1027)][_0x505390[_0x52e324(0x233)]],_0x16bf56=_0xc32fbd[_0x52e324(0x18a)][_0x52e324(0x12bf)]||{'promptSource':_0x52e324(0xbaa),'characterPositivePrompt':'','characterNegativePrompt':''};document[_0x52e324(0x479)](_0x52e324(0x459))['value']=_0x16bf56[_0x52e324(0x69c)]||'',document[_0x52e324(0x479)]('character-nai-negative')[_0x52e324(0x4e0)]=_0x16bf56[_0x52e324(0x327)]||'',document[_0x52e324(0x479)]('character-nai-prompts-modal')[_0x52e324(0x10dd)][_0x52e324(0x678)]=_0x52e324(0x899);}),document[_0x494435(0x479)](_0x494435(0x122b))[_0x494435(0xa75)](_0x494435(0xd2f),_0x135357),document['getElementById']('select-all-frames-checkbox')[_0x494435(0xa75)](_0x494435(0x1150),_0x40cae5),document[_0x494435(0x479)](_0x494435(0x36a))[_0x494435(0xa75)](_0x494435(0xd2f),_0x455b20),document[_0x494435(0x479)](_0x494435(0x118b))[_0x494435(0xa75)](_0x494435(0xd2f),_0x2b1a05),document[_0x494435(0x479)](_0x494435(0xda5))[_0x494435(0xa75)](_0x494435(0xd2f),()=>{const _0x46301e=_0x494435;_0x1c532a(_0x46301e(0x112e));}),document['getElementById'](_0x494435(0xd4d))[_0x494435(0xa75)](_0x494435(0xd2f),_0x2f79d9=>{const _0x45c2be=_0x494435,_0x37739f=_0x2f79d9[_0x45c2be(0xfa2)][_0x45c2be(0x869)](_0x45c2be(0x13c5));if(_0x37739f){const _0x1a637a=_0x37739f[_0x45c2be(0x8bc)](_0x45c2be(0x48e));_0x1a637a&&_0x2f79d9[_0x45c2be(0xfa2)]!==_0x1a637a&&(_0x1a637a[_0x45c2be(0xf7b)]=!_0x1a637a[_0x45c2be(0xf7b)]);}});const _0x1aaaf4=document[_0x494435(0x479)](_0x494435(0x1101));_0x33282f(_0x1aaaf4,_0xa3e29e=>{const _0x4c8265=_0x494435,_0x1386e7=_0xa3e29e[_0x4c8265(0xfa2)][_0x4c8265(0x869)](_0x4c8265(0x246));if(_0x1386e7){_0xa3e29e[_0x4c8265(0xd58)]();const _0x2703ad=_0x1386e7[_0x4c8265(0x13d4)][_0x4c8265(0x470)];if(_0x2703ad===_0x4c8265(0xf78)){_0x1519c8('提示','“全部”分类无法被绑定。');return;}const _0x261c1b=_0x2703ad===_0x4c8265(0x331)?'uncategorized':parseInt(_0x2703ad);_0x457fdf(_0x261c1b);}}),_0x408380(),_0x731d5(_0x494435(0x45f));}_0x2221dc();});
